var sse=Object.defineProperty;var rse=(s,e,t)=>e in s?sse(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Ui=(s,e,t)=>rse(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();function fG(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var lI={exports:{}},Hb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IV;function ose(){if(IV)return Hb;IV=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,n,r){var o=null;if(r!==void 0&&(o=""+r),n.key!==void 0&&(o=""+n.key),"key"in n){r={};for(var a in n)a!=="key"&&(r[a]=n[a])}else r=n;return n=r.ref,{$$typeof:s,type:i,key:o,ref:n!==void 0?n:null,props:r}}return Hb.Fragment=e,Hb.jsx=t,Hb.jsxs=t,Hb}var RV;function ase(){return RV||(RV=1,lI.exports=ose()),lI.exports}var z=ase(),cI={exports:{}},yt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AV;function lse(){if(AV)return yt;AV=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.for("react.activity"),g=Symbol.iterator;function p(V){return V===null||typeof V!="object"?null:(V=g&&V[g]||V["@@iterator"],typeof V=="function"?V:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,v={};function x(V,ce,oe){this.props=V,this.context=ce,this.refs=v,this.updater=oe||_}x.prototype.isReactComponent={},x.prototype.setState=function(V,ce){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ce,"setState")},x.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function S(){}S.prototype=x.prototype;function k(V,ce,oe){this.props=V,this.context=ce,this.refs=v,this.updater=oe||_}var E=k.prototype=new S;E.constructor=k,C(E,x.prototype),E.isPureReactComponent=!0;var T=Array.isArray;function R(){}var N={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function O(V,ce,oe){var Se=oe.ref;return{$$typeof:s,type:V,key:ce,ref:Se!==void 0?Se:null,props:oe}}function W(V,ce){return O(V.type,ce,V.props)}function j(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function F(V){var ce={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(oe){return ce[oe]})}var q=/\/+/g;function Z(V,ce){return typeof V=="object"&&V!==null&&V.key!=null?F(""+V.key):ce.toString(36)}function K(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(R,R):(V.status="pending",V.then(function(ce){V.status==="pending"&&(V.status="fulfilled",V.value=ce)},function(ce){V.status==="pending"&&(V.status="rejected",V.reason=ce)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function U(V,ce,oe,Se,me){var Oe=typeof V;(Oe==="undefined"||Oe==="boolean")&&(V=null);var it=!1;if(V===null)it=!0;else switch(Oe){case"bigint":case"string":case"number":it=!0;break;case"object":switch(V.$$typeof){case s:case e:it=!0;break;case u:return it=V._init,U(it(V._payload),ce,oe,Se,me)}}if(it)return me=me(V),it=Se===""?"."+Z(V,0):Se,T(me)?(oe="",it!=null&&(oe=it.replace(q,"$&/")+"/"),U(me,ce,oe,"",function(xs){return xs})):me!=null&&(j(me)&&(me=W(me,oe+(me.key==null||V&&V.key===me.key?"":(""+me.key).replace(q,"$&/")+"/")+it)),ce.push(me)),1;it=0;var Xe=Se===""?".":Se+":";if(T(V))for(var lt=0;lt<V.length;lt++)Se=V[lt],Oe=Xe+Z(Se,lt),it+=U(Se,ce,oe,Oe,me);else if(lt=p(V),typeof lt=="function")for(V=lt.call(V),lt=0;!(Se=V.next()).done;)Se=Se.value,Oe=Xe+Z(Se,lt++),it+=U(Se,ce,oe,Oe,me);else if(Oe==="object"){if(typeof V.then=="function")return U(K(V),ce,oe,Se,me);throw ce=String(V),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return it}function G(V,ce,oe){if(V==null)return V;var Se=[],me=0;return U(V,Se,"","",function(Oe){return ce.call(oe,Oe,me++)}),Se}function Q(V){if(V._status===-1){var ce=V._result;ce=ce(),ce.then(function(oe){(V._status===0||V._status===-1)&&(V._status=1,V._result=oe)},function(oe){(V._status===0||V._status===-1)&&(V._status=2,V._result=oe)}),V._status===-1&&(V._status=0,V._result=ce)}if(V._status===1)return V._result.default;throw V._result}var le=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},ve={map:G,forEach:function(V,ce,oe){G(V,function(){ce.apply(this,arguments)},oe)},count:function(V){var ce=0;return G(V,function(){ce++}),ce},toArray:function(V){return G(V,function(ce){return ce})||[]},only:function(V){if(!j(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return yt.Activity=d,yt.Children=ve,yt.Component=x,yt.Fragment=t,yt.Profiler=n,yt.PureComponent=k,yt.StrictMode=i,yt.Suspense=l,yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,yt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return N.H.useMemoCache(V)}},yt.cache=function(V){return function(){return V.apply(null,arguments)}},yt.cacheSignal=function(){return null},yt.cloneElement=function(V,ce,oe){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Se=C({},V.props),me=V.key;if(ce!=null)for(Oe in ce.key!==void 0&&(me=""+ce.key),ce)!A.call(ce,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&ce.ref===void 0||(Se[Oe]=ce[Oe]);var Oe=arguments.length-2;if(Oe===1)Se.children=oe;else if(1<Oe){for(var it=Array(Oe),Xe=0;Xe<Oe;Xe++)it[Xe]=arguments[Xe+2];Se.children=it}return O(V.type,me,Se)},yt.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:r,_context:V},V},yt.createElement=function(V,ce,oe){var Se,me={},Oe=null;if(ce!=null)for(Se in ce.key!==void 0&&(Oe=""+ce.key),ce)A.call(ce,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(me[Se]=ce[Se]);var it=arguments.length-2;if(it===1)me.children=oe;else if(1<it){for(var Xe=Array(it),lt=0;lt<it;lt++)Xe[lt]=arguments[lt+2];me.children=Xe}if(V&&V.defaultProps)for(Se in it=V.defaultProps,it)me[Se]===void 0&&(me[Se]=it[Se]);return O(V,Oe,me)},yt.createRef=function(){return{current:null}},yt.forwardRef=function(V){return{$$typeof:a,render:V}},yt.isValidElement=j,yt.lazy=function(V){return{$$typeof:u,_payload:{_status:-1,_result:V},_init:Q}},yt.memo=function(V,ce){return{$$typeof:c,type:V,compare:ce===void 0?null:ce}},yt.startTransition=function(V){var ce=N.T,oe={};N.T=oe;try{var Se=V(),me=N.S;me!==null&&me(oe,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(R,le)}catch(Oe){le(Oe)}finally{ce!==null&&oe.types!==null&&(ce.types=oe.types),N.T=ce}},yt.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},yt.use=function(V){return N.H.use(V)},yt.useActionState=function(V,ce,oe){return N.H.useActionState(V,ce,oe)},yt.useCallback=function(V,ce){return N.H.useCallback(V,ce)},yt.useContext=function(V){return N.H.useContext(V)},yt.useDebugValue=function(){},yt.useDeferredValue=function(V,ce){return N.H.useDeferredValue(V,ce)},yt.useEffect=function(V,ce){return N.H.useEffect(V,ce)},yt.useEffectEvent=function(V){return N.H.useEffectEvent(V)},yt.useId=function(){return N.H.useId()},yt.useImperativeHandle=function(V,ce,oe){return N.H.useImperativeHandle(V,ce,oe)},yt.useInsertionEffect=function(V,ce){return N.H.useInsertionEffect(V,ce)},yt.useLayoutEffect=function(V,ce){return N.H.useLayoutEffect(V,ce)},yt.useMemo=function(V,ce){return N.H.useMemo(V,ce)},yt.useOptimistic=function(V,ce){return N.H.useOptimistic(V,ce)},yt.useReducer=function(V,ce,oe){return N.H.useReducer(V,ce,oe)},yt.useRef=function(V){return N.H.useRef(V)},yt.useState=function(V){return N.H.useState(V)},yt.useSyncExternalStore=function(V,ce,oe){return N.H.useSyncExternalStore(V,ce,oe)},yt.useTransition=function(){return N.H.useTransition()},yt.version="19.2.1",yt}var MV;function eP(){return MV||(MV=1,cI.exports=lse()),cI.exports}var _e=eP();const ju=fG(_e);var hI={exports:{}},zb={},uI={exports:{}},dI={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OV;function cse(){return OV||(OV=1,(function(s){function e(U,G){var Q=U.length;U.push(G);e:for(;0<Q;){var le=Q-1>>>1,ve=U[le];if(0<n(ve,G))U[le]=G,U[Q]=ve,Q=le;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var G=U[0],Q=U.pop();if(Q!==G){U[0]=Q;e:for(var le=0,ve=U.length,V=ve>>>1;le<V;){var ce=2*(le+1)-1,oe=U[ce],Se=ce+1,me=U[Se];if(0>n(oe,Q))Se<ve&&0>n(me,oe)?(U[le]=me,U[Se]=Q,le=Se):(U[le]=oe,U[ce]=Q,le=ce);else if(Se<ve&&0>n(me,Q))U[le]=me,U[Se]=Q,le=Se;else break e}}return G}function n(U,G){var Q=U.sortIndex-G.sortIndex;return Q!==0?Q:U.id-G.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();s.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,g=3,p=!1,_=!1,C=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function E(U){for(var G=t(c);G!==null;){if(G.callback===null)i(c);else if(G.startTime<=U)i(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=t(c)}}function T(U){if(C=!1,E(U),!_)if(t(l)!==null)_=!0,R||(R=!0,F());else{var G=t(c);G!==null&&K(T,G.startTime-U)}}var R=!1,N=-1,A=5,O=-1;function W(){return v?!0:!(s.unstable_now()-O<A)}function j(){if(v=!1,R){var U=s.unstable_now();O=U;var G=!0;try{e:{_=!1,C&&(C=!1,S(N),N=-1),p=!0;var Q=g;try{t:{for(E(U),d=t(l);d!==null&&!(d.expirationTime>U&&W());){var le=d.callback;if(typeof le=="function"){d.callback=null,g=d.priorityLevel;var ve=le(d.expirationTime<=U);if(U=s.unstable_now(),typeof ve=="function"){d.callback=ve,E(U),G=!0;break t}d===t(l)&&i(l),E(U)}else i(l);d=t(l)}if(d!==null)G=!0;else{var V=t(c);V!==null&&K(T,V.startTime-U),G=!1}}break e}finally{d=null,g=Q,p=!1}G=void 0}}finally{G?F():R=!1}}}var F;if(typeof k=="function")F=function(){k(j)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Z=q.port2;q.port1.onmessage=j,F=function(){Z.postMessage(null)}}else F=function(){x(j,0)};function K(U,G){N=x(function(){U(s.unstable_now())},G)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(U){U.callback=null},s.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<U?Math.floor(1e3/U):5},s.unstable_getCurrentPriorityLevel=function(){return g},s.unstable_next=function(U){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var Q=g;g=G;try{return U()}finally{g=Q}},s.unstable_requestPaint=function(){v=!0},s.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Q=g;g=U;try{return G()}finally{g=Q}},s.unstable_scheduleCallback=function(U,G,Q){var le=s.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?le+Q:le):Q=le,U){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=Q+ve,U={id:u++,callback:G,priorityLevel:U,startTime:Q,expirationTime:ve,sortIndex:-1},Q>le?(U.sortIndex=Q,e(c,U),t(l)===null&&U===t(c)&&(C?(S(N),N=-1):C=!0,K(T,Q-le))):(U.sortIndex=ve,e(l,U),_||p||(_=!0,R||(R=!0,F()))),U},s.unstable_shouldYield=W,s.unstable_wrapCallback=function(U){var G=g;return function(){var Q=g;g=G;try{return U.apply(this,arguments)}finally{g=Q}}}})(dI)),dI}var PV;function hse(){return PV||(PV=1,uI.exports=cse()),uI.exports}var fI={exports:{}},Zs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FV;function use(){if(FV)return Zs;FV=1;var s=eP();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},n=Symbol.for("react.portal");function r(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var o=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Zs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Zs.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return r(l,c,null,u)},Zs.flushSync=function(l){var c=o.T,u=i.p;try{if(o.T=null,i.p=2,l)return l()}finally{o.T=c,i.p=u,i.d.f()}},Zs.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(l,c))},Zs.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},Zs.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=a(u,c.crossOrigin),g=typeof c.integrity=="string"?c.integrity:void 0,p=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?i.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:g,fetchPriority:p}):u==="script"&&i.d.X(l,{crossOrigin:d,integrity:g,fetchPriority:p,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Zs.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=a(c.as,c.crossOrigin);i.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(l)},Zs.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=a(u,c.crossOrigin);i.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Zs.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=a(c.as,c.crossOrigin);i.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(l)},Zs.requestFormReset=function(l){i.d.r(l)},Zs.unstable_batchedUpdates=function(l,c){return l(c)},Zs.useFormState=function(l,c,u){return o.H.useFormState(l,c,u)},Zs.useFormStatus=function(){return o.H.useHostTransitionStatus()},Zs.version="19.2.1",Zs}var BV;function dse(){if(BV)return fI.exports;BV=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),fI.exports=use(),fI.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VV;function fse(){if(VV)return zb;VV=1;var s=hse(),e=eP(),t=dse();function i(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function r(h){var f=h,m=h;if(h.alternate)for(;f.return;)f=f.return;else{h=f;do f=h,(f.flags&4098)!==0&&(m=f.return),h=f.return;while(h)}return f.tag===3?m:null}function o(h){if(h.tag===13){var f=h.memoizedState;if(f===null&&(h=h.alternate,h!==null&&(f=h.memoizedState)),f!==null)return f.dehydrated}return null}function a(h){if(h.tag===31){var f=h.memoizedState;if(f===null&&(h=h.alternate,h!==null&&(f=h.memoizedState)),f!==null)return f.dehydrated}return null}function l(h){if(r(h)!==h)throw Error(i(188))}function c(h){var f=h.alternate;if(!f){if(f=r(h),f===null)throw Error(i(188));return f!==h?null:h}for(var m=h,b=f;;){var y=m.return;if(y===null)break;var L=y.alternate;if(L===null){if(b=y.return,b!==null){m=b;continue}break}if(y.child===L.child){for(L=y.child;L;){if(L===m)return l(y),h;if(L===b)return l(y),f;L=L.sibling}throw Error(i(188))}if(m.return!==b.return)m=y,b=L;else{for(var I=!1,P=y.child;P;){if(P===m){I=!0,m=y,b=L;break}if(P===b){I=!0,b=y,m=L;break}P=P.sibling}if(!I){for(P=L.child;P;){if(P===m){I=!0,m=L,b=y;break}if(P===b){I=!0,b=L,m=y;break}P=P.sibling}if(!I)throw Error(i(189))}}if(m.alternate!==b)throw Error(i(190))}if(m.tag!==3)throw Error(i(188));return m.stateNode.current===m?h:f}function u(h){var f=h.tag;if(f===5||f===26||f===27||f===6)return h;for(h=h.child;h!==null;){if(f=u(h),f!==null)return f;h=h.sibling}return null}var d=Object.assign,g=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),k=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function F(h){return h===null||typeof h!="object"?null:(h=j&&h[j]||h["@@iterator"],typeof h=="function"?h:null)}var q=Symbol.for("react.client.reference");function Z(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===q?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case C:return"Fragment";case x:return"Profiler";case v:return"StrictMode";case T:return"Suspense";case R:return"SuspenseList";case O:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case _:return"Portal";case k:return h.displayName||"Context";case S:return(h._context.displayName||"Context")+".Consumer";case E:var f=h.render;return h=h.displayName,h||(h=f.displayName||f.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case N:return f=h.displayName||null,f!==null?f:Z(h.type)||"Memo";case A:f=h._payload,h=h._init;try{return Z(h(f))}catch{}}return null}var K=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},le=[],ve=-1;function V(h){return{current:h}}function ce(h){0>ve||(h.current=le[ve],le[ve]=null,ve--)}function oe(h,f){ve++,le[ve]=h.current,h.current=f}var Se=V(null),me=V(null),Oe=V(null),it=V(null);function Xe(h,f){switch(oe(Oe,f),oe(me,h),oe(Se,null),f.nodeType){case 9:case 11:h=(h=f.documentElement)&&(h=h.namespaceURI)?eV(h):0;break;default:if(h=f.tagName,f=f.namespaceURI)f=eV(f),h=tV(f,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}ce(Se),oe(Se,h)}function lt(){ce(Se),ce(me),ce(Oe)}function xs(h){h.memoizedState!==null&&oe(it,h);var f=Se.current,m=tV(f,h.type);f!==m&&(oe(me,h),oe(Se,m))}function nl(h){me.current===h&&(ce(Se),ce(me)),it.current===h&&(ce(it),Fb._currentValue=Q)}var zi,Rr;function fr(h){if(zi===void 0)try{throw Error()}catch(m){var f=m.stack.trim().match(/\n( *(at )?)/);zi=f&&f[1]||"",Rr=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zi+h+Rr}var Dd=!1;function Td(h,f){if(!h||Dd)return"";Dd=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(f){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var de=fe}Reflect.construct(h,[],ye)}else{try{ye.call()}catch(fe){de=fe}h.call(ye.prototype)}}else{try{throw Error()}catch(fe){de=fe}(ye=h())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&de&&typeof fe.stack=="string")return[fe.stack,de.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=b.DetermineComponentFrameRoot(),I=L[0],P=L[1];if(I&&P){var X=I.split(`
`),ue=P.split(`
`);for(y=b=0;b<X.length&&!X[b].includes("DetermineComponentFrameRoot");)b++;for(;y<ue.length&&!ue[y].includes("DetermineComponentFrameRoot");)y++;if(b===X.length||y===ue.length)for(b=X.length-1,y=ue.length-1;1<=b&&0<=y&&X[b]!==ue[y];)y--;for(;1<=b&&0<=y;b--,y--)if(X[b]!==ue[y]){if(b!==1||y!==1)do if(b--,y--,0>y||X[b]!==ue[y]){var be=`
`+X[b].replace(" at new "," at ");return h.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",h.displayName)),be}while(1<=b&&0<=y);break}}}finally{Dd=!1,Error.prepareStackTrace=m}return(m=h?h.displayName||h.name:"")?fr(m):""}function jh(h,f){switch(h.tag){case 26:case 27:case 5:return fr(h.type);case 16:return fr("Lazy");case 13:return h.child!==f&&f!==null?fr("Suspense Fallback"):fr("Suspense");case 19:return fr("SuspenseList");case 0:case 15:return Td(h.type,!1);case 11:return Td(h.type.render,!1);case 1:return Td(h.type,!0);case 31:return fr("Activity");default:return""}}function Nd(h){try{var f="",m=null;do f+=jh(h,m),m=h,h=h.return;while(h);return f}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var $h=Object.prototype.hasOwnProperty,vm=s.unstable_scheduleCallback,ym=s.unstable_cancelCallback,ZD=s.unstable_shouldYield,K1=s.unstable_requestPaint,ts=s.unstable_now,qh=s.unstable_getCurrentPriorityLevel,cc=s.unstable_ImmediatePriority,Y1=s.unstable_UserBlockingPriority,Id=s.unstable_NormalPriority,sy=s.unstable_LowPriority,Sm=s.unstable_IdlePriority,ry=s.log,xm=s.unstable_setDisableYieldValue,sl=null,on=null;function gr(h){if(typeof ry=="function"&&xm(h),on&&typeof on.setStrictMode=="function")try{on.setStrictMode(sl,h)}catch{}}var Ls=Math.clz32?Math.clz32:Lm,Q1=Math.log,JD=Math.LN2;function Lm(h){return h>>>=0,h===0?32:31-(Q1(h)/JD|0)|0}var hc=256,km=262144,rl=4194304;function uc(h){var f=h&42;if(f!==0)return f;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return h&261888;case 262144:case 524288:case 1048576:case 2097152:return h&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function Em(h,f,m){var b=h.pendingLanes;if(b===0)return 0;var y=0,L=h.suspendedLanes,I=h.pingedLanes;h=h.warmLanes;var P=b&134217727;return P!==0?(b=P&~L,b!==0?y=uc(b):(I&=P,I!==0?y=uc(I):m||(m=P&~h,m!==0&&(y=uc(m))))):(P=b&~L,P!==0?y=uc(P):I!==0?y=uc(I):m||(m=b&~h,m!==0&&(y=uc(m)))),y===0?0:f!==0&&f!==y&&(f&L)===0&&(L=y&-y,m=f&-f,L>=m||L===32&&(m&4194048)!==0)?f:y}function Ji(h,f){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&f)===0}function Gh(h,f){switch(h){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oy(){var h=rl;return rl<<=1,(rl&62914560)===0&&(rl=4194304),h}function Dm(h){for(var f=[],m=0;31>m;m++)f.push(h);return f}function dc(h,f){h.pendingLanes|=f,f!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function ay(h,f,m,b,y,L){var I=h.pendingLanes;h.pendingLanes=m,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=m,h.entangledLanes&=m,h.errorRecoveryDisabledLanes&=m,h.shellSuspendCounter=0;var P=h.entanglements,X=h.expirationTimes,ue=h.hiddenUpdates;for(m=I&~m;0<m;){var be=31-Ls(m),ye=1<<be;P[be]=0,X[be]=-1;var de=ue[be];if(de!==null)for(ue[be]=null,be=0;be<de.length;be++){var fe=de[be];fe!==null&&(fe.lane&=-536870913)}m&=~ye}b!==0&&X1(h,b,0),L!==0&&y===0&&h.tag!==0&&(h.suspendedLanes|=L&~(I&~f))}function X1(h,f,m){h.pendingLanes|=f,h.suspendedLanes&=~f;var b=31-Ls(f);h.entangledLanes|=f,h.entanglements[b]=h.entanglements[b]|1073741824|m&261930}function ly(h,f){var m=h.entangledLanes|=f;for(h=h.entanglements;m;){var b=31-Ls(m),y=1<<b;y&f|h[b]&f&&(h[b]|=f),m&=~y}}function fo(h,f){var m=f&-f;return m=(m&42)!==0?1:Ca(m),(m&(h.suspendedLanes|f))!==0?0:m}function Ca(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function Tm(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function Z1(){var h=G.p;return h!==0?h:(h=window.event,h===void 0?32:xV(h.type))}function Nm(h,f){var m=G.p;try{return G.p=h,f()}finally{G.p=m}}var wa=Math.random().toString(36).slice(2),Ni="__reactFiber$"+wa,ks="__reactProps$"+wa,fc="__reactContainer$"+wa,Im="__reactEvents$"+wa,cy="__reactListeners$"+wa,eT="__reactHandles$"+wa,Ze="__reactResources$"+wa,te="__reactMarker$"+wa;function Te(h){delete h[Ni],delete h[ks],delete h[Im],delete h[cy],delete h[eT]}function ze(h){var f=h[Ni];if(f)return f;for(var m=h.parentNode;m;){if(f=m[fc]||m[Ni]){if(m=f.alternate,f.child!==null||m!==null&&m.child!==null)for(h=lV(h);h!==null;){if(m=h[Ni])return m;h=lV(h)}return f}h=m,m=h.parentNode}return null}function di(h){if(h=h[Ni]||h[fc]){var f=h.tag;if(f===5||f===6||f===13||f===31||f===26||f===27||f===3)return h}return null}function mn(h){var f=h.tag;if(f===5||f===26||f===27||f===6)return h.stateNode;throw Error(i(33))}function Ii(h){var f=h[Ze];return f||(f=h[Ze]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function ni(h){h[te]=!0}var zo=new Set,gc={};function va(h,f){en(h,f),en(h+"Capture",f)}function en(h,f){for(gc[h]=f,h=0;h<f.length;h++)zo.add(f[h])}var hy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),J1={},$9={};function Qte(h){return $h.call($9,h)?!0:$h.call(J1,h)?!1:hy.test(h)?$9[h]=!0:(J1[h]=!0,!1)}function uy(h,f,m){if(Qte(f))if(m===null)h.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":h.removeAttribute(f);return;case"boolean":var b=f.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){h.removeAttribute(f);return}}h.setAttribute(f,""+m)}}function dy(h,f,m){if(m===null)h.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(f);return}h.setAttribute(f,""+m)}}function mc(h,f,m,b){if(b===null)h.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(m);return}h.setAttributeNS(f,m,""+b)}}function Uo(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function q9(h){var f=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Xte(h,f,m){var b=Object.getOwnPropertyDescriptor(h.constructor.prototype,f);if(!h.hasOwnProperty(f)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var y=b.get,L=b.set;return Object.defineProperty(h,f,{configurable:!0,get:function(){return y.call(this)},set:function(I){m=""+I,L.call(this,I)}}),Object.defineProperty(h,f,{enumerable:b.enumerable}),{getValue:function(){return m},setValue:function(I){m=""+I},stopTracking:function(){h._valueTracker=null,delete h[f]}}}}function tT(h){if(!h._valueTracker){var f=q9(h)?"checked":"value";h._valueTracker=Xte(h,f,""+h[f])}}function G9(h){if(!h)return!1;var f=h._valueTracker;if(!f)return!0;var m=f.getValue(),b="";return h&&(b=q9(h)?h.checked?"true":"false":h.value),h=b,h!==m?(f.setValue(h),!0):!1}function fy(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var Zte=/[\n"\\]/g;function jo(h){return h.replace(Zte,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function iT(h,f,m,b,y,L,I,P){h.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?h.type=I:h.removeAttribute("type"),f!=null?I==="number"?(f===0&&h.value===""||h.value!=f)&&(h.value=""+Uo(f)):h.value!==""+Uo(f)&&(h.value=""+Uo(f)):I!=="submit"&&I!=="reset"||h.removeAttribute("value"),f!=null?nT(h,I,Uo(f)):m!=null?nT(h,I,Uo(m)):b!=null&&h.removeAttribute("value"),y==null&&L!=null&&(h.defaultChecked=!!L),y!=null&&(h.checked=y&&typeof y!="function"&&typeof y!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?h.name=""+Uo(P):h.removeAttribute("name")}function K9(h,f,m,b,y,L,I,P){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(h.type=L),f!=null||m!=null){if(!(L!=="submit"&&L!=="reset"||f!=null)){tT(h);return}m=m!=null?""+Uo(m):"",f=f!=null?""+Uo(f):m,P||f===h.value||(h.value=f),h.defaultValue=f}b=b??y,b=typeof b!="function"&&typeof b!="symbol"&&!!b,h.checked=P?h.checked:!!b,h.defaultChecked=!!b,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(h.name=I),tT(h)}function nT(h,f,m){f==="number"&&fy(h.ownerDocument)===h||h.defaultValue===""+m||(h.defaultValue=""+m)}function Rm(h,f,m,b){if(h=h.options,f){f={};for(var y=0;y<m.length;y++)f["$"+m[y]]=!0;for(m=0;m<h.length;m++)y=f.hasOwnProperty("$"+h[m].value),h[m].selected!==y&&(h[m].selected=y),y&&b&&(h[m].defaultSelected=!0)}else{for(m=""+Uo(m),f=null,y=0;y<h.length;y++){if(h[y].value===m){h[y].selected=!0,b&&(h[y].defaultSelected=!0);return}f!==null||h[y].disabled||(f=h[y])}f!==null&&(f.selected=!0)}}function Y9(h,f,m){if(f!=null&&(f=""+Uo(f),f!==h.value&&(h.value=f),m==null)){h.defaultValue!==f&&(h.defaultValue=f);return}h.defaultValue=m!=null?""+Uo(m):""}function Q9(h,f,m,b){if(f==null){if(b!=null){if(m!=null)throw Error(i(92));if(K(b)){if(1<b.length)throw Error(i(93));b=b[0]}m=b}m==null&&(m=""),f=m}m=Uo(f),h.defaultValue=m,b=h.textContent,b===m&&b!==""&&b!==null&&(h.value=b),tT(h)}function Am(h,f){if(f){var m=h.firstChild;if(m&&m===h.lastChild&&m.nodeType===3){m.nodeValue=f;return}}h.textContent=f}var Jte=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function X9(h,f,m){var b=f.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?h.setProperty(f,""):f==="float"?h.cssFloat="":h[f]="":b?h.setProperty(f,m):typeof m!="number"||m===0||Jte.has(f)?f==="float"?h.cssFloat=m:h[f]=(""+m).trim():h[f]=m+"px"}function Z9(h,f,m){if(f!=null&&typeof f!="object")throw Error(i(62));if(h=h.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||f!=null&&f.hasOwnProperty(b)||(b.indexOf("--")===0?h.setProperty(b,""):b==="float"?h.cssFloat="":h[b]="");for(var y in f)b=f[y],f.hasOwnProperty(y)&&m[y]!==b&&X9(h,y,b)}else for(var L in f)f.hasOwnProperty(L)&&X9(h,L,f[L])}function sT(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eie=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tie=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gy(h){return tie.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}function pc(){}var rT=null;function oT(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var Mm=null,Om=null;function J9(h){var f=di(h);if(f&&(h=f.stateNode)){var m=h[ks]||null;e:switch(h=f.stateNode,f.type){case"input":if(iT(h,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),f=m.name,m.type==="radio"&&f!=null){for(m=h;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+jo(""+f)+'"][type="radio"]'),f=0;f<m.length;f++){var b=m[f];if(b!==h&&b.form===h.form){var y=b[ks]||null;if(!y)throw Error(i(90));iT(b,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(f=0;f<m.length;f++)b=m[f],b.form===h.form&&G9(b)}break e;case"textarea":Y9(h,m.value,m.defaultValue);break e;case"select":f=m.value,f!=null&&Rm(h,!!m.multiple,f,!1)}}}var aT=!1;function e8(h,f,m){if(aT)return h(f,m);aT=!0;try{var b=h(f);return b}finally{if(aT=!1,(Mm!==null||Om!==null)&&(tS(),Mm&&(f=Mm,h=Om,Om=Mm=null,J9(f),h)))for(f=0;f<h.length;f++)J9(h[f])}}function eb(h,f){var m=h.stateNode;if(m===null)return null;var b=m[ks]||null;if(b===null)return null;m=b[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(h=h.type,b=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!b;break e;default:h=!1}if(h)return null;if(m&&typeof m!="function")throw Error(i(231,f,typeof m));return m}var _c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lT=!1;if(_c)try{var tb={};Object.defineProperty(tb,"passive",{get:function(){lT=!0}}),window.addEventListener("test",tb,tb),window.removeEventListener("test",tb,tb)}catch{lT=!1}var Kh=null,cT=null,my=null;function t8(){if(my)return my;var h,f=cT,m=f.length,b,y="value"in Kh?Kh.value:Kh.textContent,L=y.length;for(h=0;h<m&&f[h]===y[h];h++);var I=m-h;for(b=1;b<=I&&f[m-b]===y[L-b];b++);return my=y.slice(h,1<b?1-b:void 0)}function py(h){var f=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&f===13&&(h=13)):h=f,h===10&&(h=13),32<=h||h===13?h:0}function _y(){return!0}function i8(){return!1}function Ar(h){function f(m,b,y,L,I){this._reactName=m,this._targetInst=y,this.type=b,this.nativeEvent=L,this.target=I,this.currentTarget=null;for(var P in h)h.hasOwnProperty(P)&&(m=h[P],this[P]=m?m(L):L[P]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?_y:i8,this.isPropagationStopped=i8,this}return d(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=_y)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=_y)},persist:function(){},isPersistent:_y}),f}var Rd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},by=Ar(Rd),ib=d({},Rd,{view:0,detail:0}),iie=Ar(ib),hT,uT,nb,Cy=d({},ib,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fT,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==nb&&(nb&&h.type==="mousemove"?(hT=h.screenX-nb.screenX,uT=h.screenY-nb.screenY):uT=hT=0,nb=h),hT)},movementY:function(h){return"movementY"in h?h.movementY:uT}}),n8=Ar(Cy),nie=d({},Cy,{dataTransfer:0}),sie=Ar(nie),rie=d({},ib,{relatedTarget:0}),dT=Ar(rie),oie=d({},Rd,{animationName:0,elapsedTime:0,pseudoElement:0}),aie=Ar(oie),lie=d({},Rd,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),cie=Ar(lie),hie=d({},Rd,{data:0}),s8=Ar(hie),uie={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},die={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gie(h){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(h):(h=fie[h])?!!f[h]:!1}function fT(){return gie}var mie=d({},ib,{key:function(h){if(h.key){var f=uie[h.key]||h.key;if(f!=="Unidentified")return f}return h.type==="keypress"?(h=py(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?die[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fT,charCode:function(h){return h.type==="keypress"?py(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?py(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),pie=Ar(mie),_ie=d({},Cy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r8=Ar(_ie),bie=d({},ib,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fT}),Cie=Ar(bie),wie=d({},Rd,{propertyName:0,elapsedTime:0,pseudoElement:0}),vie=Ar(wie),yie=d({},Cy,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),Sie=Ar(yie),xie=d({},Rd,{newState:0,oldState:0}),Lie=Ar(xie),kie=[9,13,27,32],gT=_c&&"CompositionEvent"in window,sb=null;_c&&"documentMode"in document&&(sb=document.documentMode);var Eie=_c&&"TextEvent"in window&&!sb,o8=_c&&(!gT||sb&&8<sb&&11>=sb),a8=" ",l8=!1;function c8(h,f){switch(h){case"keyup":return kie.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h8(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var Pm=!1;function Die(h,f){switch(h){case"compositionend":return h8(f);case"keypress":return f.which!==32?null:(l8=!0,a8);case"textInput":return h=f.data,h===a8&&l8?null:h;default:return null}}function Tie(h,f){if(Pm)return h==="compositionend"||!gT&&c8(h,f)?(h=t8(),my=cT=Kh=null,Pm=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return o8&&f.locale!=="ko"?null:f.data;default:return null}}var Nie={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u8(h){var f=h&&h.nodeName&&h.nodeName.toLowerCase();return f==="input"?!!Nie[h.type]:f==="textarea"}function d8(h,f,m,b){Mm?Om?Om.push(b):Om=[b]:Mm=b,f=lS(f,"onChange"),0<f.length&&(m=new by("onChange","change",null,m,b),h.push({event:m,listeners:f}))}var rb=null,ob=null;function Iie(h){KB(h,0)}function wy(h){var f=mn(h);if(G9(f))return h}function f8(h,f){if(h==="change")return f}var g8=!1;if(_c){var mT;if(_c){var pT="oninput"in document;if(!pT){var m8=document.createElement("div");m8.setAttribute("oninput","return;"),pT=typeof m8.oninput=="function"}mT=pT}else mT=!1;g8=mT&&(!document.documentMode||9<document.documentMode)}function p8(){rb&&(rb.detachEvent("onpropertychange",_8),ob=rb=null)}function _8(h){if(h.propertyName==="value"&&wy(ob)){var f=[];d8(f,ob,h,oT(h)),e8(Iie,f)}}function Rie(h,f,m){h==="focusin"?(p8(),rb=f,ob=m,rb.attachEvent("onpropertychange",_8)):h==="focusout"&&p8()}function Aie(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return wy(ob)}function Mie(h,f){if(h==="click")return wy(f)}function Oie(h,f){if(h==="input"||h==="change")return wy(f)}function Pie(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var go=typeof Object.is=="function"?Object.is:Pie;function ab(h,f){if(go(h,f))return!0;if(typeof h!="object"||h===null||typeof f!="object"||f===null)return!1;var m=Object.keys(h),b=Object.keys(f);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var y=m[b];if(!$h.call(f,y)||!go(h[y],f[y]))return!1}return!0}function b8(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function C8(h,f){var m=b8(h);h=0;for(var b;m;){if(m.nodeType===3){if(b=h+m.textContent.length,h<=f&&b>=f)return{node:m,offset:f-h};h=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=b8(m)}}function w8(h,f){return h&&f?h===f?!0:h&&h.nodeType===3?!1:f&&f.nodeType===3?w8(h,f.parentNode):"contains"in h?h.contains(f):h.compareDocumentPosition?!!(h.compareDocumentPosition(f)&16):!1:!1}function v8(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var f=fy(h.document);f instanceof h.HTMLIFrameElement;){try{var m=typeof f.contentWindow.location.href=="string"}catch{m=!1}if(m)h=f.contentWindow;else break;f=fy(h.document)}return f}function _T(h){var f=h&&h.nodeName&&h.nodeName.toLowerCase();return f&&(f==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||f==="textarea"||h.contentEditable==="true")}var Fie=_c&&"documentMode"in document&&11>=document.documentMode,Fm=null,bT=null,lb=null,CT=!1;function y8(h,f,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;CT||Fm==null||Fm!==fy(b)||(b=Fm,"selectionStart"in b&&_T(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),lb&&ab(lb,b)||(lb=b,b=lS(bT,"onSelect"),0<b.length&&(f=new by("onSelect","select",null,f,m),h.push({event:f,listeners:b}),f.target=Fm)))}function Ad(h,f){var m={};return m[h.toLowerCase()]=f.toLowerCase(),m["Webkit"+h]="webkit"+f,m["Moz"+h]="moz"+f,m}var Bm={animationend:Ad("Animation","AnimationEnd"),animationiteration:Ad("Animation","AnimationIteration"),animationstart:Ad("Animation","AnimationStart"),transitionrun:Ad("Transition","TransitionRun"),transitionstart:Ad("Transition","TransitionStart"),transitioncancel:Ad("Transition","TransitionCancel"),transitionend:Ad("Transition","TransitionEnd")},wT={},S8={};_c&&(S8=document.createElement("div").style,"AnimationEvent"in window||(delete Bm.animationend.animation,delete Bm.animationiteration.animation,delete Bm.animationstart.animation),"TransitionEvent"in window||delete Bm.transitionend.transition);function Md(h){if(wT[h])return wT[h];if(!Bm[h])return h;var f=Bm[h],m;for(m in f)if(f.hasOwnProperty(m)&&m in S8)return wT[h]=f[m];return h}var x8=Md("animationend"),L8=Md("animationiteration"),k8=Md("animationstart"),Bie=Md("transitionrun"),Vie=Md("transitionstart"),Wie=Md("transitioncancel"),E8=Md("transitionend"),D8=new Map,vT="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");vT.push("scrollEnd");function ya(h,f){D8.set(h,f),va(f,[h])}var vy=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)},$o=[],Vm=0,yT=0;function yy(){for(var h=Vm,f=yT=Vm=0;f<h;){var m=$o[f];$o[f++]=null;var b=$o[f];$o[f++]=null;var y=$o[f];$o[f++]=null;var L=$o[f];if($o[f++]=null,b!==null&&y!==null){var I=b.pending;I===null?y.next=y:(y.next=I.next,I.next=y),b.pending=y}L!==0&&T8(m,y,L)}}function Sy(h,f,m,b){$o[Vm++]=h,$o[Vm++]=f,$o[Vm++]=m,$o[Vm++]=b,yT|=b,h.lanes|=b,h=h.alternate,h!==null&&(h.lanes|=b)}function ST(h,f,m,b){return Sy(h,f,m,b),xy(h)}function Od(h,f){return Sy(h,null,null,f),xy(h)}function T8(h,f,m){h.lanes|=m;var b=h.alternate;b!==null&&(b.lanes|=m);for(var y=!1,L=h.return;L!==null;)L.childLanes|=m,b=L.alternate,b!==null&&(b.childLanes|=m),L.tag===22&&(h=L.stateNode,h===null||h._visibility&1||(y=!0)),h=L,L=L.return;return h.tag===3?(L=h.stateNode,y&&f!==null&&(y=31-Ls(m),h=L.hiddenUpdates,b=h[y],b===null?h[y]=[f]:b.push(f),f.lane=m|536870912),L):null}function xy(h){if(50<Nb)throw Nb=0,RN=null,Error(i(185));for(var f=h.return;f!==null;)h=f,f=h.return;return h.tag===3?h.stateNode:null}var Wm={};function Hie(h,f,m,b){this.tag=h,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mo(h,f,m,b){return new Hie(h,f,m,b)}function xT(h){return h=h.prototype,!(!h||!h.isReactComponent)}function bc(h,f){var m=h.alternate;return m===null?(m=mo(h.tag,f,h.key,h.mode),m.elementType=h.elementType,m.type=h.type,m.stateNode=h.stateNode,m.alternate=h,h.alternate=m):(m.pendingProps=f,m.type=h.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=h.flags&65011712,m.childLanes=h.childLanes,m.lanes=h.lanes,m.child=h.child,m.memoizedProps=h.memoizedProps,m.memoizedState=h.memoizedState,m.updateQueue=h.updateQueue,f=h.dependencies,m.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},m.sibling=h.sibling,m.index=h.index,m.ref=h.ref,m.refCleanup=h.refCleanup,m}function N8(h,f){h.flags&=65011714;var m=h.alternate;return m===null?(h.childLanes=0,h.lanes=f,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=m.childLanes,h.lanes=m.lanes,h.child=m.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=m.memoizedProps,h.memoizedState=m.memoizedState,h.updateQueue=m.updateQueue,h.type=m.type,f=m.dependencies,h.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),h}function Ly(h,f,m,b,y,L){var I=0;if(b=h,typeof h=="function")xT(h)&&(I=1);else if(typeof h=="string")I=qne(h,m,Se.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case O:return h=mo(31,m,f,y),h.elementType=O,h.lanes=L,h;case C:return Pd(m.children,y,L,f);case v:I=8,y|=24;break;case x:return h=mo(12,m,f,y|2),h.elementType=x,h.lanes=L,h;case T:return h=mo(13,m,f,y),h.elementType=T,h.lanes=L,h;case R:return h=mo(19,m,f,y),h.elementType=R,h.lanes=L,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case k:I=10;break e;case S:I=9;break e;case E:I=11;break e;case N:I=14;break e;case A:I=16,b=null;break e}I=29,m=Error(i(130,h===null?"null":typeof h,"")),b=null}return f=mo(I,m,f,y),f.elementType=h,f.type=b,f.lanes=L,f}function Pd(h,f,m,b){return h=mo(7,h,b,f),h.lanes=m,h}function LT(h,f,m){return h=mo(6,h,null,f),h.lanes=m,h}function I8(h){var f=mo(18,null,null,0);return f.stateNode=h,f}function kT(h,f,m){return f=mo(4,h.children!==null?h.children:[],h.key,f),f.lanes=m,f.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},f}var R8=new WeakMap;function qo(h,f){if(typeof h=="object"&&h!==null){var m=R8.get(h);return m!==void 0?m:(f={value:h,source:f,stack:Nd(f)},R8.set(h,f),f)}return{value:h,source:f,stack:Nd(f)}}var Hm=[],zm=0,ky=null,cb=0,Go=[],Ko=0,Yh=null,ol=1,al="";function Cc(h,f){Hm[zm++]=cb,Hm[zm++]=ky,ky=h,cb=f}function A8(h,f,m){Go[Ko++]=ol,Go[Ko++]=al,Go[Ko++]=Yh,Yh=h;var b=ol;h=al;var y=32-Ls(b)-1;b&=~(1<<y),m+=1;var L=32-Ls(f)+y;if(30<L){var I=y-y%5;L=(b&(1<<I)-1).toString(32),b>>=I,y-=I,ol=1<<32-Ls(f)+y|m<<y|b,al=L+h}else ol=1<<L|m<<y|b,al=h}function ET(h){h.return!==null&&(Cc(h,1),A8(h,1,0))}function DT(h){for(;h===ky;)ky=Hm[--zm],Hm[zm]=null,cb=Hm[--zm],Hm[zm]=null;for(;h===Yh;)Yh=Go[--Ko],Go[Ko]=null,al=Go[--Ko],Go[Ko]=null,ol=Go[--Ko],Go[Ko]=null}function M8(h,f){Go[Ko++]=ol,Go[Ko++]=al,Go[Ko++]=Yh,ol=f.id,al=f.overflow,Yh=h}var Es=null,Ki=null,Kt=!1,Qh=null,Yo=!1,TT=Error(i(519));function Xh(h){var f=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hb(qo(f,h)),TT}function O8(h){var f=h.stateNode,m=h.type,b=h.memoizedProps;switch(f[Ni]=h,f[ks]=b,m){case"dialog":Wt("cancel",f),Wt("close",f);break;case"iframe":case"object":case"embed":Wt("load",f);break;case"video":case"audio":for(m=0;m<Rb.length;m++)Wt(Rb[m],f);break;case"source":Wt("error",f);break;case"img":case"image":case"link":Wt("error",f),Wt("load",f);break;case"details":Wt("toggle",f);break;case"input":Wt("invalid",f),K9(f,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":Wt("invalid",f);break;case"textarea":Wt("invalid",f),Q9(f,b.value,b.defaultValue,b.children)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||f.textContent===""+m||b.suppressHydrationWarning===!0||ZB(f.textContent,m)?(b.popover!=null&&(Wt("beforetoggle",f),Wt("toggle",f)),b.onScroll!=null&&Wt("scroll",f),b.onScrollEnd!=null&&Wt("scrollend",f),b.onClick!=null&&(f.onclick=pc),f=!0):f=!1,f||Xh(h,!0)}function P8(h){for(Es=h.return;Es;)switch(Es.tag){case 5:case 31:case 13:Yo=!1;return;case 27:case 3:Yo=!0;return;default:Es=Es.return}}function Um(h){if(h!==Es)return!1;if(!Kt)return P8(h),Kt=!0,!1;var f=h.tag,m;if((m=f!==3&&f!==27)&&((m=f===5)&&(m=h.type,m=!(m!=="form"&&m!=="button")||GN(h.type,h.memoizedProps)),m=!m),m&&Ki&&Xh(h),P8(h),f===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));Ki=aV(h)}else if(f===31){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));Ki=aV(h)}else f===27?(f=Ki,uu(h.type)?(h=ZN,ZN=null,Ki=h):Ki=f):Ki=Es?Xo(h.stateNode.nextSibling):null;return!0}function Fd(){Ki=Es=null,Kt=!1}function NT(){var h=Qh;return h!==null&&(Fr===null?Fr=h:Fr.push.apply(Fr,h),Qh=null),h}function hb(h){Qh===null?Qh=[h]:Qh.push(h)}var IT=V(null),Bd=null,wc=null;function Zh(h,f,m){oe(IT,f._currentValue),f._currentValue=m}function vc(h){h._currentValue=IT.current,ce(IT)}function RT(h,f,m){for(;h!==null;){var b=h.alternate;if((h.childLanes&f)!==f?(h.childLanes|=f,b!==null&&(b.childLanes|=f)):b!==null&&(b.childLanes&f)!==f&&(b.childLanes|=f),h===m)break;h=h.return}}function AT(h,f,m,b){var y=h.child;for(y!==null&&(y.return=h);y!==null;){var L=y.dependencies;if(L!==null){var I=y.child;L=L.firstContext;e:for(;L!==null;){var P=L;L=y;for(var X=0;X<f.length;X++)if(P.context===f[X]){L.lanes|=m,P=L.alternate,P!==null&&(P.lanes|=m),RT(L.return,m,h),b||(I=null);break e}L=P.next}}else if(y.tag===18){if(I=y.return,I===null)throw Error(i(341));I.lanes|=m,L=I.alternate,L!==null&&(L.lanes|=m),RT(I,m,h),I=null}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===h){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}}function jm(h,f,m,b){h=null;for(var y=f,L=!1;y!==null;){if(!L){if((y.flags&524288)!==0)L=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var I=y.alternate;if(I===null)throw Error(i(387));if(I=I.memoizedProps,I!==null){var P=y.type;go(y.pendingProps.value,I.value)||(h!==null?h.push(P):h=[P])}}else if(y===it.current){if(I=y.alternate,I===null)throw Error(i(387));I.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(h!==null?h.push(Fb):h=[Fb])}y=y.return}h!==null&&AT(f,h,m,b),f.flags|=262144}function Ey(h){for(h=h.firstContext;h!==null;){if(!go(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function Vd(h){Bd=h,wc=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function Ds(h){return F8(Bd,h)}function Dy(h,f){return Bd===null&&Vd(h),F8(h,f)}function F8(h,f){var m=f._currentValue;if(f={context:f,memoizedValue:m,next:null},wc===null){if(h===null)throw Error(i(308));wc=f,h.dependencies={lanes:0,firstContext:f},h.flags|=524288}else wc=wc.next=f;return m}var zie=typeof AbortController<"u"?AbortController:function(){var h=[],f=this.signal={aborted:!1,addEventListener:function(m,b){h.push(b)}};this.abort=function(){f.aborted=!0,h.forEach(function(m){return m()})}},Uie=s.unstable_scheduleCallback,jie=s.unstable_NormalPriority,Vn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function MT(){return{controller:new zie,data:new Map,refCount:0}}function ub(h){h.refCount--,h.refCount===0&&Uie(jie,function(){h.controller.abort()})}var db=null,OT=0,$m=0,qm=null;function $ie(h,f){if(db===null){var m=db=[];OT=0,$m=BN(),qm={status:"pending",value:void 0,then:function(b){m.push(b)}}}return OT++,f.then(B8,B8),f}function B8(){if(--OT===0&&db!==null){qm!==null&&(qm.status="fulfilled");var h=db;db=null,$m=0,qm=null;for(var f=0;f<h.length;f++)(0,h[f])()}}function qie(h,f){var m=[],b={status:"pending",value:null,reason:null,then:function(y){m.push(y)}};return h.then(function(){b.status="fulfilled",b.value=f;for(var y=0;y<m.length;y++)(0,m[y])(f)},function(y){for(b.status="rejected",b.reason=y,y=0;y<m.length;y++)(0,m[y])(void 0)}),b}var V8=U.S;U.S=function(h,f){yB=ts(),typeof f=="object"&&f!==null&&typeof f.then=="function"&&$ie(h,f),V8!==null&&V8(h,f)};var Wd=V(null);function PT(){var h=Wd.current;return h!==null?h:Ri.pooledCache}function Ty(h,f){f===null?oe(Wd,Wd.current):oe(Wd,f.pool)}function W8(){var h=PT();return h===null?null:{parent:Vn._currentValue,pool:h}}var Gm=Error(i(460)),FT=Error(i(474)),Ny=Error(i(542)),Iy={then:function(){}};function H8(h){return h=h.status,h==="fulfilled"||h==="rejected"}function z8(h,f,m){switch(m=h[m],m===void 0?h.push(f):m!==f&&(f.then(pc,pc),f=m),f.status){case"fulfilled":return f.value;case"rejected":throw h=f.reason,j8(h),h;default:if(typeof f.status=="string")f.then(pc,pc);else{if(h=Ri,h!==null&&100<h.shellSuspendCounter)throw Error(i(482));h=f,h.status="pending",h.then(function(b){if(f.status==="pending"){var y=f;y.status="fulfilled",y.value=b}},function(b){if(f.status==="pending"){var y=f;y.status="rejected",y.reason=b}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw h=f.reason,j8(h),h}throw zd=f,Gm}}function Hd(h){try{var f=h._init;return f(h._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(zd=m,Gm):m}}var zd=null;function U8(){if(zd===null)throw Error(i(459));var h=zd;return zd=null,h}function j8(h){if(h===Gm||h===Ny)throw Error(i(483))}var Km=null,fb=0;function Ry(h){var f=fb;return fb+=1,Km===null&&(Km=[]),z8(Km,h,f)}function gb(h,f){f=f.props.ref,h.ref=f!==void 0?f:null}function Ay(h,f){throw f.$$typeof===g?Error(i(525)):(h=Object.prototype.toString.call(f),Error(i(31,h==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":h)))}function $8(h){function f(se,ee){if(h){var he=se.deletions;he===null?(se.deletions=[ee],se.flags|=16):he.push(ee)}}function m(se,ee){if(!h)return null;for(;ee!==null;)f(se,ee),ee=ee.sibling;return null}function b(se){for(var ee=new Map;se!==null;)se.key!==null?ee.set(se.key,se):ee.set(se.index,se),se=se.sibling;return ee}function y(se,ee){return se=bc(se,ee),se.index=0,se.sibling=null,se}function L(se,ee,he){return se.index=he,h?(he=se.alternate,he!==null?(he=he.index,he<ee?(se.flags|=67108866,ee):he):(se.flags|=67108866,ee)):(se.flags|=1048576,ee)}function I(se){return h&&se.alternate===null&&(se.flags|=67108866),se}function P(se,ee,he,we){return ee===null||ee.tag!==6?(ee=LT(he,se.mode,we),ee.return=se,ee):(ee=y(ee,he),ee.return=se,ee)}function X(se,ee,he,we){var et=he.type;return et===C?be(se,ee,he.props.children,we,he.key):ee!==null&&(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===A&&Hd(et)===ee.type)?(ee=y(ee,he.props),gb(ee,he),ee.return=se,ee):(ee=Ly(he.type,he.key,he.props,null,se.mode,we),gb(ee,he),ee.return=se,ee)}function ue(se,ee,he,we){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==he.containerInfo||ee.stateNode.implementation!==he.implementation?(ee=kT(he,se.mode,we),ee.return=se,ee):(ee=y(ee,he.children||[]),ee.return=se,ee)}function be(se,ee,he,we,et){return ee===null||ee.tag!==7?(ee=Pd(he,se.mode,we,et),ee.return=se,ee):(ee=y(ee,he),ee.return=se,ee)}function ye(se,ee,he){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=LT(""+ee,se.mode,he),ee.return=se,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case p:return he=Ly(ee.type,ee.key,ee.props,null,se.mode,he),gb(he,ee),he.return=se,he;case _:return ee=kT(ee,se.mode,he),ee.return=se,ee;case A:return ee=Hd(ee),ye(se,ee,he)}if(K(ee)||F(ee))return ee=Pd(ee,se.mode,he,null),ee.return=se,ee;if(typeof ee.then=="function")return ye(se,Ry(ee),he);if(ee.$$typeof===k)return ye(se,Dy(se,ee),he);Ay(se,ee)}return null}function de(se,ee,he,we){var et=ee!==null?ee.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return et!==null?null:P(se,ee,""+he,we);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case p:return he.key===et?X(se,ee,he,we):null;case _:return he.key===et?ue(se,ee,he,we):null;case A:return he=Hd(he),de(se,ee,he,we)}if(K(he)||F(he))return et!==null?null:be(se,ee,he,we,null);if(typeof he.then=="function")return de(se,ee,Ry(he),we);if(he.$$typeof===k)return de(se,ee,Dy(se,he),we);Ay(se,he)}return null}function fe(se,ee,he,we,et){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return se=se.get(he)||null,P(ee,se,""+we,et);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case p:return se=se.get(we.key===null?he:we.key)||null,X(ee,se,we,et);case _:return se=se.get(we.key===null?he:we.key)||null,ue(ee,se,we,et);case A:return we=Hd(we),fe(se,ee,he,we,et)}if(K(we)||F(we))return se=se.get(he)||null,be(ee,se,we,et,null);if(typeof we.then=="function")return fe(se,ee,he,Ry(we),et);if(we.$$typeof===k)return fe(se,ee,he,Dy(ee,we),et);Ay(ee,we)}return null}function $e(se,ee,he,we){for(var et=null,li=null,Ye=ee,Tt=ee=0,Gt=null;Ye!==null&&Tt<he.length;Tt++){Ye.index>Tt?(Gt=Ye,Ye=null):Gt=Ye.sibling;var ci=de(se,Ye,he[Tt],we);if(ci===null){Ye===null&&(Ye=Gt);break}h&&Ye&&ci.alternate===null&&f(se,Ye),ee=L(ci,ee,Tt),li===null?et=ci:li.sibling=ci,li=ci,Ye=Gt}if(Tt===he.length)return m(se,Ye),Kt&&Cc(se,Tt),et;if(Ye===null){for(;Tt<he.length;Tt++)Ye=ye(se,he[Tt],we),Ye!==null&&(ee=L(Ye,ee,Tt),li===null?et=Ye:li.sibling=Ye,li=Ye);return Kt&&Cc(se,Tt),et}for(Ye=b(Ye);Tt<he.length;Tt++)Gt=fe(Ye,se,Tt,he[Tt],we),Gt!==null&&(h&&Gt.alternate!==null&&Ye.delete(Gt.key===null?Tt:Gt.key),ee=L(Gt,ee,Tt),li===null?et=Gt:li.sibling=Gt,li=Gt);return h&&Ye.forEach(function(pu){return f(se,pu)}),Kt&&Cc(se,Tt),et}function ot(se,ee,he,we){if(he==null)throw Error(i(151));for(var et=null,li=null,Ye=ee,Tt=ee=0,Gt=null,ci=he.next();Ye!==null&&!ci.done;Tt++,ci=he.next()){Ye.index>Tt?(Gt=Ye,Ye=null):Gt=Ye.sibling;var pu=de(se,Ye,ci.value,we);if(pu===null){Ye===null&&(Ye=Gt);break}h&&Ye&&pu.alternate===null&&f(se,Ye),ee=L(pu,ee,Tt),li===null?et=pu:li.sibling=pu,li=pu,Ye=Gt}if(ci.done)return m(se,Ye),Kt&&Cc(se,Tt),et;if(Ye===null){for(;!ci.done;Tt++,ci=he.next())ci=ye(se,ci.value,we),ci!==null&&(ee=L(ci,ee,Tt),li===null?et=ci:li.sibling=ci,li=ci);return Kt&&Cc(se,Tt),et}for(Ye=b(Ye);!ci.done;Tt++,ci=he.next())ci=fe(Ye,se,Tt,ci.value,we),ci!==null&&(h&&ci.alternate!==null&&Ye.delete(ci.key===null?Tt:ci.key),ee=L(ci,ee,Tt),li===null?et=ci:li.sibling=ci,li=ci);return h&&Ye.forEach(function(nse){return f(se,nse)}),Kt&&Cc(se,Tt),et}function ki(se,ee,he,we){if(typeof he=="object"&&he!==null&&he.type===C&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case p:e:{for(var et=he.key;ee!==null;){if(ee.key===et){if(et=he.type,et===C){if(ee.tag===7){m(se,ee.sibling),we=y(ee,he.props.children),we.return=se,se=we;break e}}else if(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===A&&Hd(et)===ee.type){m(se,ee.sibling),we=y(ee,he.props),gb(we,he),we.return=se,se=we;break e}m(se,ee);break}else f(se,ee);ee=ee.sibling}he.type===C?(we=Pd(he.props.children,se.mode,we,he.key),we.return=se,se=we):(we=Ly(he.type,he.key,he.props,null,se.mode,we),gb(we,he),we.return=se,se=we)}return I(se);case _:e:{for(et=he.key;ee!==null;){if(ee.key===et)if(ee.tag===4&&ee.stateNode.containerInfo===he.containerInfo&&ee.stateNode.implementation===he.implementation){m(se,ee.sibling),we=y(ee,he.children||[]),we.return=se,se=we;break e}else{m(se,ee);break}else f(se,ee);ee=ee.sibling}we=kT(he,se.mode,we),we.return=se,se=we}return I(se);case A:return he=Hd(he),ki(se,ee,he,we)}if(K(he))return $e(se,ee,he,we);if(F(he)){if(et=F(he),typeof et!="function")throw Error(i(150));return he=et.call(he),ot(se,ee,he,we)}if(typeof he.then=="function")return ki(se,ee,Ry(he),we);if(he.$$typeof===k)return ki(se,ee,Dy(se,he),we);Ay(se,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ee!==null&&ee.tag===6?(m(se,ee.sibling),we=y(ee,he),we.return=se,se=we):(m(se,ee),we=LT(he,se.mode,we),we.return=se,se=we),I(se)):m(se,ee)}return function(se,ee,he,we){try{fb=0;var et=ki(se,ee,he,we);return Km=null,et}catch(Ye){if(Ye===Gm||Ye===Ny)throw Ye;var li=mo(29,Ye,null,se.mode);return li.lanes=we,li.return=se,li}finally{}}}var Ud=$8(!0),q8=$8(!1),Jh=!1;function BT(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function VT(h,f){h=h.updateQueue,f.updateQueue===h&&(f.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function eu(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function tu(h,f,m){var b=h.updateQueue;if(b===null)return null;if(b=b.shared,(fi&2)!==0){var y=b.pending;return y===null?f.next=f:(f.next=y.next,y.next=f),b.pending=f,f=xy(h),T8(h,null,m),f}return Sy(h,b,f,m),xy(h)}function mb(h,f,m){if(f=f.updateQueue,f!==null&&(f=f.shared,(m&4194048)!==0)){var b=f.lanes;b&=h.pendingLanes,m|=b,f.lanes=m,ly(h,m)}}function WT(h,f){var m=h.updateQueue,b=h.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var y=null,L=null;if(m=m.firstBaseUpdate,m!==null){do{var I={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};L===null?y=L=I:L=L.next=I,m=m.next}while(m!==null);L===null?y=L=f:L=L.next=f}else y=L=f;m={baseState:b.baseState,firstBaseUpdate:y,lastBaseUpdate:L,shared:b.shared,callbacks:b.callbacks},h.updateQueue=m;return}h=m.lastBaseUpdate,h===null?m.firstBaseUpdate=f:h.next=f,m.lastBaseUpdate=f}var HT=!1;function pb(){if(HT){var h=qm;if(h!==null)throw h}}function _b(h,f,m,b){HT=!1;var y=h.updateQueue;Jh=!1;var L=y.firstBaseUpdate,I=y.lastBaseUpdate,P=y.shared.pending;if(P!==null){y.shared.pending=null;var X=P,ue=X.next;X.next=null,I===null?L=ue:I.next=ue,I=X;var be=h.alternate;be!==null&&(be=be.updateQueue,P=be.lastBaseUpdate,P!==I&&(P===null?be.firstBaseUpdate=ue:P.next=ue,be.lastBaseUpdate=X))}if(L!==null){var ye=y.baseState;I=0,be=ue=X=null,P=L;do{var de=P.lane&-536870913,fe=de!==P.lane;if(fe?(qt&de)===de:(b&de)===de){de!==0&&de===$m&&(HT=!0),be!==null&&(be=be.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var $e=h,ot=P;de=f;var ki=m;switch(ot.tag){case 1:if($e=ot.payload,typeof $e=="function"){ye=$e.call(ki,ye,de);break e}ye=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=ot.payload,de=typeof $e=="function"?$e.call(ki,ye,de):$e,de==null)break e;ye=d({},ye,de);break e;case 2:Jh=!0}}de=P.callback,de!==null&&(h.flags|=64,fe&&(h.flags|=8192),fe=y.callbacks,fe===null?y.callbacks=[de]:fe.push(de))}else fe={lane:de,tag:P.tag,payload:P.payload,callback:P.callback,next:null},be===null?(ue=be=fe,X=ye):be=be.next=fe,I|=de;if(P=P.next,P===null){if(P=y.shared.pending,P===null)break;fe=P,P=fe.next,fe.next=null,y.lastBaseUpdate=fe,y.shared.pending=null}}while(!0);be===null&&(X=ye),y.baseState=X,y.firstBaseUpdate=ue,y.lastBaseUpdate=be,L===null&&(y.shared.lanes=0),ou|=I,h.lanes=I,h.memoizedState=ye}}function G8(h,f){if(typeof h!="function")throw Error(i(191,h));h.call(f)}function K8(h,f){var m=h.callbacks;if(m!==null)for(h.callbacks=null,h=0;h<m.length;h++)G8(m[h],f)}var Ym=V(null),My=V(0);function Y8(h,f){h=Nc,oe(My,h),oe(Ym,f),Nc=h|f.baseLanes}function zT(){oe(My,Nc),oe(Ym,Ym.current)}function UT(){Nc=My.current,ce(Ym),ce(My)}var po=V(null),Qo=null;function iu(h){var f=h.alternate;oe(Dn,Dn.current&1),oe(po,h),Qo===null&&(f===null||Ym.current!==null||f.memoizedState!==null)&&(Qo=h)}function jT(h){oe(Dn,Dn.current),oe(po,h),Qo===null&&(Qo=h)}function Q8(h){h.tag===22?(oe(Dn,Dn.current),oe(po,h),Qo===null&&(Qo=h)):nu()}function nu(){oe(Dn,Dn.current),oe(po,po.current)}function _o(h){ce(po),Qo===h&&(Qo=null),ce(Dn)}var Dn=V(0);function Oy(h){for(var f=h;f!==null;){if(f.tag===13){var m=f.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||QN(m)||XN(m)))return f}else if(f.tag===19&&(f.memoizedProps.revealOrder==="forwards"||f.memoizedProps.revealOrder==="backwards"||f.memoizedProps.revealOrder==="unstable_legacy-backwards"||f.memoizedProps.revealOrder==="together")){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var yc=0,xt=null,xi=null,Wn=null,Py=!1,Qm=!1,jd=!1,Fy=0,bb=0,Xm=null,Gie=0;function pn(){throw Error(i(321))}function $T(h,f){if(f===null)return!1;for(var m=0;m<f.length&&m<h.length;m++)if(!go(h[m],f[m]))return!1;return!0}function qT(h,f,m,b,y,L){return yc=L,xt=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,U.H=h===null||h.memoizedState===null?AF:aN,jd=!1,L=m(b,y),jd=!1,Qm&&(L=Z8(f,m,b,y)),X8(h),L}function X8(h){U.H=vb;var f=xi!==null&&xi.next!==null;if(yc=0,Wn=xi=xt=null,Py=!1,bb=0,Xm=null,f)throw Error(i(300));h===null||Hn||(h=h.dependencies,h!==null&&Ey(h)&&(Hn=!0))}function Z8(h,f,m,b){xt=h;var y=0;do{if(Qm&&(Xm=null),bb=0,Qm=!1,25<=y)throw Error(i(301));if(y+=1,Wn=xi=null,h.updateQueue!=null){var L=h.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}U.H=MF,L=f(m,b)}while(Qm);return L}function Kie(){var h=U.H,f=h.useState()[0];return f=typeof f.then=="function"?Cb(f):f,h=h.useState()[0],(xi!==null?xi.memoizedState:null)!==h&&(xt.flags|=1024),f}function GT(){var h=Fy!==0;return Fy=0,h}function KT(h,f,m){f.updateQueue=h.updateQueue,f.flags&=-2053,h.lanes&=~m}function YT(h){if(Py){for(h=h.memoizedState;h!==null;){var f=h.queue;f!==null&&(f.pending=null),h=h.next}Py=!1}yc=0,Wn=xi=xt=null,Qm=!1,bb=Fy=0,Xm=null}function mr(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?xt.memoizedState=Wn=h:Wn=Wn.next=h,Wn}function Tn(){if(xi===null){var h=xt.alternate;h=h!==null?h.memoizedState:null}else h=xi.next;var f=Wn===null?xt.memoizedState:Wn.next;if(f!==null)Wn=f,xi=h;else{if(h===null)throw xt.alternate===null?Error(i(467)):Error(i(310));xi=h,h={memoizedState:xi.memoizedState,baseState:xi.baseState,baseQueue:xi.baseQueue,queue:xi.queue,next:null},Wn===null?xt.memoizedState=Wn=h:Wn=Wn.next=h}return Wn}function By(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cb(h){var f=bb;return bb+=1,Xm===null&&(Xm=[]),h=z8(Xm,h,f),f=xt,(Wn===null?f.memoizedState:Wn.next)===null&&(f=f.alternate,U.H=f===null||f.memoizedState===null?AF:aN),h}function Vy(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Cb(h);if(h.$$typeof===k)return Ds(h)}throw Error(i(438,String(h)))}function QT(h){var f=null,m=xt.updateQueue;if(m!==null&&(f=m.memoCache),f==null){var b=xt.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(f={data:b.data.map(function(y){return y.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),m===null&&(m=By(),xt.updateQueue=m),m.memoCache=f,m=f.data[f.index],m===void 0)for(m=f.data[f.index]=Array(h),b=0;b<h;b++)m[b]=W;return f.index++,m}function Sc(h,f){return typeof f=="function"?f(h):f}function Wy(h){var f=Tn();return XT(f,xi,h)}function XT(h,f,m){var b=h.queue;if(b===null)throw Error(i(311));b.lastRenderedReducer=m;var y=h.baseQueue,L=b.pending;if(L!==null){if(y!==null){var I=y.next;y.next=L.next,L.next=I}f.baseQueue=y=L,b.pending=null}if(L=h.baseState,y===null)h.memoizedState=L;else{f=y.next;var P=I=null,X=null,ue=f,be=!1;do{var ye=ue.lane&-536870913;if(ye!==ue.lane?(qt&ye)===ye:(yc&ye)===ye){var de=ue.revertLane;if(de===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ye===$m&&(be=!0);else if((yc&de)===de){ue=ue.next,de===$m&&(be=!0);continue}else ye={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(P=X=ye,I=L):X=X.next=ye,xt.lanes|=de,ou|=de;ye=ue.action,jd&&m(L,ye),L=ue.hasEagerState?ue.eagerState:m(L,ye)}else de={lane:ye,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(P=X=de,I=L):X=X.next=de,xt.lanes|=ye,ou|=ye;ue=ue.next}while(ue!==null&&ue!==f);if(X===null?I=L:X.next=P,!go(L,h.memoizedState)&&(Hn=!0,be&&(m=qm,m!==null)))throw m;h.memoizedState=L,h.baseState=I,h.baseQueue=X,b.lastRenderedState=L}return y===null&&(b.lanes=0),[h.memoizedState,b.dispatch]}function ZT(h){var f=Tn(),m=f.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=h;var b=m.dispatch,y=m.pending,L=f.memoizedState;if(y!==null){m.pending=null;var I=y=y.next;do L=h(L,I.action),I=I.next;while(I!==y);go(L,f.memoizedState)||(Hn=!0),f.memoizedState=L,f.baseQueue===null&&(f.baseState=L),m.lastRenderedState=L}return[L,b]}function J8(h,f,m){var b=xt,y=Tn(),L=Kt;if(L){if(m===void 0)throw Error(i(407));m=m()}else m=f();var I=!go((xi||y).memoizedState,m);if(I&&(y.memoizedState=m,Hn=!0),y=y.queue,tN(iF.bind(null,b,y,h),[h]),y.getSnapshot!==f||I||Wn!==null&&Wn.memoizedState.tag&1){if(b.flags|=2048,Zm(9,{destroy:void 0},tF.bind(null,b,y,m,f),null),Ri===null)throw Error(i(349));L||(yc&127)!==0||eF(b,f,m)}return m}function eF(h,f,m){h.flags|=16384,h={getSnapshot:f,value:m},f=xt.updateQueue,f===null?(f=By(),xt.updateQueue=f,f.stores=[h]):(m=f.stores,m===null?f.stores=[h]:m.push(h))}function tF(h,f,m,b){f.value=m,f.getSnapshot=b,nF(f)&&sF(h)}function iF(h,f,m){return m(function(){nF(f)&&sF(h)})}function nF(h){var f=h.getSnapshot;h=h.value;try{var m=f();return!go(h,m)}catch{return!0}}function sF(h){var f=Od(h,2);f!==null&&Br(f,h,2)}function JT(h){var f=mr();if(typeof h=="function"){var m=h;if(h=m(),jd){gr(!0);try{m()}finally{gr(!1)}}}return f.memoizedState=f.baseState=h,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:h},f}function rF(h,f,m,b){return h.baseState=m,XT(h,xi,typeof b=="function"?b:Sc)}function Yie(h,f,m,b,y){if(Uy(h))throw Error(i(485));if(h=f.action,h!==null){var L={payload:y,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){L.listeners.push(I)}};U.T!==null?m(!0):L.isTransition=!1,b(L),m=f.pending,m===null?(L.next=f.pending=L,oF(f,L)):(L.next=m.next,f.pending=m.next=L)}}function oF(h,f){var m=f.action,b=f.payload,y=h.state;if(f.isTransition){var L=U.T,I={};U.T=I;try{var P=m(y,b),X=U.S;X!==null&&X(I,P),aF(h,f,P)}catch(ue){eN(h,f,ue)}finally{L!==null&&I.types!==null&&(L.types=I.types),U.T=L}}else try{L=m(y,b),aF(h,f,L)}catch(ue){eN(h,f,ue)}}function aF(h,f,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){lF(h,f,b)},function(b){return eN(h,f,b)}):lF(h,f,m)}function lF(h,f,m){f.status="fulfilled",f.value=m,cF(f),h.state=m,f=h.pending,f!==null&&(m=f.next,m===f?h.pending=null:(m=m.next,f.next=m,oF(h,m)))}function eN(h,f,m){var b=h.pending;if(h.pending=null,b!==null){b=b.next;do f.status="rejected",f.reason=m,cF(f),f=f.next;while(f!==b)}h.action=null}function cF(h){h=h.listeners;for(var f=0;f<h.length;f++)(0,h[f])()}function hF(h,f){return f}function uF(h,f){if(Kt){var m=Ri.formState;if(m!==null){e:{var b=xt;if(Kt){if(Ki){t:{for(var y=Ki,L=Yo;y.nodeType!==8;){if(!L){y=null;break t}if(y=Xo(y.nextSibling),y===null){y=null;break t}}L=y.data,y=L==="F!"||L==="F"?y:null}if(y){Ki=Xo(y.nextSibling),b=y.data==="F!";break e}}Xh(b)}b=!1}b&&(f=m[0])}}return m=mr(),m.memoizedState=m.baseState=f,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hF,lastRenderedState:f},m.queue=b,m=NF.bind(null,xt,b),b.dispatch=m,b=JT(!1),L=oN.bind(null,xt,!1,b.queue),b=mr(),y={state:f,dispatch:null,action:h,pending:null},b.queue=y,m=Yie.bind(null,xt,y,L,m),y.dispatch=m,b.memoizedState=h,[f,m,!1]}function dF(h){var f=Tn();return fF(f,xi,h)}function fF(h,f,m){if(f=XT(h,f,hF)[0],h=Wy(Sc)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var b=Cb(f)}catch(I){throw I===Gm?Ny:I}else b=f;f=Tn();var y=f.queue,L=y.dispatch;return m!==f.memoizedState&&(xt.flags|=2048,Zm(9,{destroy:void 0},Qie.bind(null,y,m),null)),[b,L,h]}function Qie(h,f){h.action=f}function gF(h){var f=Tn(),m=xi;if(m!==null)return fF(f,m,h);Tn(),f=f.memoizedState,m=Tn();var b=m.queue.dispatch;return m.memoizedState=h,[f,b,!1]}function Zm(h,f,m,b){return h={tag:h,create:m,deps:b,inst:f,next:null},f=xt.updateQueue,f===null&&(f=By(),xt.updateQueue=f),m=f.lastEffect,m===null?f.lastEffect=h.next=h:(b=m.next,m.next=h,h.next=b,f.lastEffect=h),h}function mF(){return Tn().memoizedState}function Hy(h,f,m,b){var y=mr();xt.flags|=h,y.memoizedState=Zm(1|f,{destroy:void 0},m,b===void 0?null:b)}function zy(h,f,m,b){var y=Tn();b=b===void 0?null:b;var L=y.memoizedState.inst;xi!==null&&b!==null&&$T(b,xi.memoizedState.deps)?y.memoizedState=Zm(f,L,m,b):(xt.flags|=h,y.memoizedState=Zm(1|f,L,m,b))}function pF(h,f){Hy(8390656,8,h,f)}function tN(h,f){zy(2048,8,h,f)}function Xie(h){xt.flags|=4;var f=xt.updateQueue;if(f===null)f=By(),xt.updateQueue=f,f.events=[h];else{var m=f.events;m===null?f.events=[h]:m.push(h)}}function _F(h){var f=Tn().memoizedState;return Xie({ref:f,nextImpl:h}),function(){if((fi&2)!==0)throw Error(i(440));return f.impl.apply(void 0,arguments)}}function bF(h,f){return zy(4,2,h,f)}function CF(h,f){return zy(4,4,h,f)}function wF(h,f){if(typeof f=="function"){h=h();var m=f(h);return function(){typeof m=="function"?m():f(null)}}if(f!=null)return h=h(),f.current=h,function(){f.current=null}}function vF(h,f,m){m=m!=null?m.concat([h]):null,zy(4,4,wF.bind(null,f,h),m)}function iN(){}function yF(h,f){var m=Tn();f=f===void 0?null:f;var b=m.memoizedState;return f!==null&&$T(f,b[1])?b[0]:(m.memoizedState=[h,f],h)}function SF(h,f){var m=Tn();f=f===void 0?null:f;var b=m.memoizedState;if(f!==null&&$T(f,b[1]))return b[0];if(b=h(),jd){gr(!0);try{h()}finally{gr(!1)}}return m.memoizedState=[b,f],b}function nN(h,f,m){return m===void 0||(yc&1073741824)!==0&&(qt&261930)===0?h.memoizedState=f:(h.memoizedState=m,h=xB(),xt.lanes|=h,ou|=h,m)}function xF(h,f,m,b){return go(m,f)?m:Ym.current!==null?(h=nN(h,m,b),go(h,f)||(Hn=!0),h):(yc&42)===0||(yc&1073741824)!==0&&(qt&261930)===0?(Hn=!0,h.memoizedState=m):(h=xB(),xt.lanes|=h,ou|=h,f)}function LF(h,f,m,b,y){var L=G.p;G.p=L!==0&&8>L?L:8;var I=U.T,P={};U.T=P,oN(h,!1,f,m);try{var X=y(),ue=U.S;if(ue!==null&&ue(P,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var be=qie(X,b);wb(h,f,be,wo(h))}else wb(h,f,b,wo(h))}catch(ye){wb(h,f,{then:function(){},status:"rejected",reason:ye},wo())}finally{G.p=L,I!==null&&P.types!==null&&(I.types=P.types),U.T=I}}function Zie(){}function sN(h,f,m,b){if(h.tag!==5)throw Error(i(476));var y=kF(h).queue;LF(h,y,f,Q,m===null?Zie:function(){return EF(h),m(b)})}function kF(h){var f=h.memoizedState;if(f!==null)return f;f={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:Q},next:null};var m={};return f.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:m},next:null},h.memoizedState=f,h=h.alternate,h!==null&&(h.memoizedState=f),f}function EF(h){var f=kF(h);f.next===null&&(f=h.alternate.memoizedState),wb(h,f.next.queue,{},wo())}function rN(){return Ds(Fb)}function DF(){return Tn().memoizedState}function TF(){return Tn().memoizedState}function Jie(h){for(var f=h.return;f!==null;){switch(f.tag){case 24:case 3:var m=wo();h=eu(m);var b=tu(f,h,m);b!==null&&(Br(b,f,m),mb(b,f,m)),f={cache:MT()},h.payload=f;return}f=f.return}}function ene(h,f,m){var b=wo();m={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Uy(h)?IF(f,m):(m=ST(h,f,m,b),m!==null&&(Br(m,h,b),RF(m,f,b)))}function NF(h,f,m){var b=wo();wb(h,f,m,b)}function wb(h,f,m,b){var y={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Uy(h))IF(f,y);else{var L=h.alternate;if(h.lanes===0&&(L===null||L.lanes===0)&&(L=f.lastRenderedReducer,L!==null))try{var I=f.lastRenderedState,P=L(I,m);if(y.hasEagerState=!0,y.eagerState=P,go(P,I))return Sy(h,f,y,0),Ri===null&&yy(),!1}catch{}finally{}if(m=ST(h,f,y,b),m!==null)return Br(m,h,b),RF(m,f,b),!0}return!1}function oN(h,f,m,b){if(b={lane:2,revertLane:BN(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Uy(h)){if(f)throw Error(i(479))}else f=ST(h,m,b,2),f!==null&&Br(f,h,2)}function Uy(h){var f=h.alternate;return h===xt||f!==null&&f===xt}function IF(h,f){Qm=Py=!0;var m=h.pending;m===null?f.next=f:(f.next=m.next,m.next=f),h.pending=f}function RF(h,f,m){if((m&4194048)!==0){var b=f.lanes;b&=h.pendingLanes,m|=b,f.lanes=m,ly(h,m)}}var vb={readContext:Ds,use:Vy,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useLayoutEffect:pn,useInsertionEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useSyncExternalStore:pn,useId:pn,useHostTransitionStatus:pn,useFormState:pn,useActionState:pn,useOptimistic:pn,useMemoCache:pn,useCacheRefresh:pn};vb.useEffectEvent=pn;var AF={readContext:Ds,use:Vy,useCallback:function(h,f){return mr().memoizedState=[h,f===void 0?null:f],h},useContext:Ds,useEffect:pF,useImperativeHandle:function(h,f,m){m=m!=null?m.concat([h]):null,Hy(4194308,4,wF.bind(null,f,h),m)},useLayoutEffect:function(h,f){return Hy(4194308,4,h,f)},useInsertionEffect:function(h,f){Hy(4,2,h,f)},useMemo:function(h,f){var m=mr();f=f===void 0?null:f;var b=h();if(jd){gr(!0);try{h()}finally{gr(!1)}}return m.memoizedState=[b,f],b},useReducer:function(h,f,m){var b=mr();if(m!==void 0){var y=m(f);if(jd){gr(!0);try{m(f)}finally{gr(!1)}}}else y=f;return b.memoizedState=b.baseState=y,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:y},b.queue=h,h=h.dispatch=ene.bind(null,xt,h),[b.memoizedState,h]},useRef:function(h){var f=mr();return h={current:h},f.memoizedState=h},useState:function(h){h=JT(h);var f=h.queue,m=NF.bind(null,xt,f);return f.dispatch=m,[h.memoizedState,m]},useDebugValue:iN,useDeferredValue:function(h,f){var m=mr();return nN(m,h,f)},useTransition:function(){var h=JT(!1);return h=LF.bind(null,xt,h.queue,!0,!1),mr().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,f,m){var b=xt,y=mr();if(Kt){if(m===void 0)throw Error(i(407));m=m()}else{if(m=f(),Ri===null)throw Error(i(349));(qt&127)!==0||eF(b,f,m)}y.memoizedState=m;var L={value:m,getSnapshot:f};return y.queue=L,pF(iF.bind(null,b,L,h),[h]),b.flags|=2048,Zm(9,{destroy:void 0},tF.bind(null,b,L,m,f),null),m},useId:function(){var h=mr(),f=Ri.identifierPrefix;if(Kt){var m=al,b=ol;m=(b&~(1<<32-Ls(b)-1)).toString(32)+m,f="_"+f+"R_"+m,m=Fy++,0<m&&(f+="H"+m.toString(32)),f+="_"}else m=Gie++,f="_"+f+"r_"+m.toString(32)+"_";return h.memoizedState=f},useHostTransitionStatus:rN,useFormState:uF,useActionState:uF,useOptimistic:function(h){var f=mr();f.memoizedState=f.baseState=h;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=m,f=oN.bind(null,xt,!0,m),m.dispatch=f,[h,f]},useMemoCache:QT,useCacheRefresh:function(){return mr().memoizedState=Jie.bind(null,xt)},useEffectEvent:function(h){var f=mr(),m={impl:h};return f.memoizedState=m,function(){if((fi&2)!==0)throw Error(i(440));return m.impl.apply(void 0,arguments)}}},aN={readContext:Ds,use:Vy,useCallback:yF,useContext:Ds,useEffect:tN,useImperativeHandle:vF,useInsertionEffect:bF,useLayoutEffect:CF,useMemo:SF,useReducer:Wy,useRef:mF,useState:function(){return Wy(Sc)},useDebugValue:iN,useDeferredValue:function(h,f){var m=Tn();return xF(m,xi.memoizedState,h,f)},useTransition:function(){var h=Wy(Sc)[0],f=Tn().memoizedState;return[typeof h=="boolean"?h:Cb(h),f]},useSyncExternalStore:J8,useId:DF,useHostTransitionStatus:rN,useFormState:dF,useActionState:dF,useOptimistic:function(h,f){var m=Tn();return rF(m,xi,h,f)},useMemoCache:QT,useCacheRefresh:TF};aN.useEffectEvent=_F;var MF={readContext:Ds,use:Vy,useCallback:yF,useContext:Ds,useEffect:tN,useImperativeHandle:vF,useInsertionEffect:bF,useLayoutEffect:CF,useMemo:SF,useReducer:ZT,useRef:mF,useState:function(){return ZT(Sc)},useDebugValue:iN,useDeferredValue:function(h,f){var m=Tn();return xi===null?nN(m,h,f):xF(m,xi.memoizedState,h,f)},useTransition:function(){var h=ZT(Sc)[0],f=Tn().memoizedState;return[typeof h=="boolean"?h:Cb(h),f]},useSyncExternalStore:J8,useId:DF,useHostTransitionStatus:rN,useFormState:gF,useActionState:gF,useOptimistic:function(h,f){var m=Tn();return xi!==null?rF(m,xi,h,f):(m.baseState=h,[h,m.queue.dispatch])},useMemoCache:QT,useCacheRefresh:TF};MF.useEffectEvent=_F;function lN(h,f,m,b){f=h.memoizedState,m=m(b,f),m=m==null?f:d({},f,m),h.memoizedState=m,h.lanes===0&&(h.updateQueue.baseState=m)}var cN={enqueueSetState:function(h,f,m){h=h._reactInternals;var b=wo(),y=eu(b);y.payload=f,m!=null&&(y.callback=m),f=tu(h,y,b),f!==null&&(Br(f,h,b),mb(f,h,b))},enqueueReplaceState:function(h,f,m){h=h._reactInternals;var b=wo(),y=eu(b);y.tag=1,y.payload=f,m!=null&&(y.callback=m),f=tu(h,y,b),f!==null&&(Br(f,h,b),mb(f,h,b))},enqueueForceUpdate:function(h,f){h=h._reactInternals;var m=wo(),b=eu(m);b.tag=2,f!=null&&(b.callback=f),f=tu(h,b,m),f!==null&&(Br(f,h,m),mb(f,h,m))}};function OF(h,f,m,b,y,L,I){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(b,L,I):f.prototype&&f.prototype.isPureReactComponent?!ab(m,b)||!ab(y,L):!0}function PF(h,f,m,b){h=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(m,b),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(m,b),f.state!==h&&cN.enqueueReplaceState(f,f.state,null)}function $d(h,f){var m=f;if("ref"in f){m={};for(var b in f)b!=="ref"&&(m[b]=f[b])}if(h=h.defaultProps){m===f&&(m=d({},m));for(var y in h)m[y]===void 0&&(m[y]=h[y])}return m}function FF(h){vy(h)}function BF(h){console.error(h)}function VF(h){vy(h)}function jy(h,f){try{var m=h.onUncaughtError;m(f.value,{componentStack:f.stack})}catch(b){setTimeout(function(){throw b})}}function WF(h,f,m){try{var b=h.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function hN(h,f,m){return m=eu(m),m.tag=3,m.payload={element:null},m.callback=function(){jy(h,f)},m}function HF(h){return h=eu(h),h.tag=3,h}function zF(h,f,m,b){var y=m.type.getDerivedStateFromError;if(typeof y=="function"){var L=b.value;h.payload=function(){return y(L)},h.callback=function(){WF(f,m,b)}}var I=m.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(h.callback=function(){WF(f,m,b),typeof y!="function"&&(au===null?au=new Set([this]):au.add(this));var P=b.stack;this.componentDidCatch(b.value,{componentStack:P!==null?P:""})})}function tne(h,f,m,b,y){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(f=m.alternate,f!==null&&jm(f,m,y,!0),m=po.current,m!==null){switch(m.tag){case 31:case 13:return Qo===null?iS():m.alternate===null&&_n===0&&(_n=3),m.flags&=-257,m.flags|=65536,m.lanes=y,b===Iy?m.flags|=16384:(f=m.updateQueue,f===null?m.updateQueue=new Set([b]):f.add(b),ON(h,b,y)),!1;case 22:return m.flags|=65536,b===Iy?m.flags|=16384:(f=m.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=f):(m=f.retryQueue,m===null?f.retryQueue=new Set([b]):m.add(b)),ON(h,b,y)),!1}throw Error(i(435,m.tag))}return ON(h,b,y),iS(),!1}if(Kt)return f=po.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=y,b!==TT&&(h=Error(i(422),{cause:b}),hb(qo(h,m)))):(b!==TT&&(f=Error(i(423),{cause:b}),hb(qo(f,m))),h=h.current.alternate,h.flags|=65536,y&=-y,h.lanes|=y,b=qo(b,m),y=hN(h.stateNode,b,y),WT(h,y),_n!==4&&(_n=2)),!1;var L=Error(i(520),{cause:b});if(L=qo(L,m),Tb===null?Tb=[L]:Tb.push(L),_n!==4&&(_n=2),f===null)return!0;b=qo(b,m),m=f;do{switch(m.tag){case 3:return m.flags|=65536,h=y&-y,m.lanes|=h,h=hN(m.stateNode,b,h),WT(m,h),!1;case 1:if(f=m.type,L=m.stateNode,(m.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(au===null||!au.has(L))))return m.flags|=65536,y&=-y,m.lanes|=y,y=HF(y),zF(y,h,m,b),WT(m,y),!1}m=m.return}while(m!==null);return!1}var uN=Error(i(461)),Hn=!1;function Ts(h,f,m,b){f.child=h===null?q8(f,null,m,b):Ud(f,h.child,m,b)}function UF(h,f,m,b,y){m=m.render;var L=f.ref;if("ref"in b){var I={};for(var P in b)P!=="ref"&&(I[P]=b[P])}else I=b;return Vd(f),b=qT(h,f,m,I,L,y),P=GT(),h!==null&&!Hn?(KT(h,f,y),xc(h,f,y)):(Kt&&P&&ET(f),f.flags|=1,Ts(h,f,b,y),f.child)}function jF(h,f,m,b,y){if(h===null){var L=m.type;return typeof L=="function"&&!xT(L)&&L.defaultProps===void 0&&m.compare===null?(f.tag=15,f.type=L,$F(h,f,L,b,y)):(h=Ly(m.type,null,b,f,f.mode,y),h.ref=f.ref,h.return=f,f.child=h)}if(L=h.child,!CN(h,y)){var I=L.memoizedProps;if(m=m.compare,m=m!==null?m:ab,m(I,b)&&h.ref===f.ref)return xc(h,f,y)}return f.flags|=1,h=bc(L,b),h.ref=f.ref,h.return=f,f.child=h}function $F(h,f,m,b,y){if(h!==null){var L=h.memoizedProps;if(ab(L,b)&&h.ref===f.ref)if(Hn=!1,f.pendingProps=b=L,CN(h,y))(h.flags&131072)!==0&&(Hn=!0);else return f.lanes=h.lanes,xc(h,f,y)}return dN(h,f,m,b,y)}function qF(h,f,m,b){var y=b.children,L=h!==null?h.memoizedState:null;if(h===null&&f.stateNode===null&&(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((f.flags&128)!==0){if(L=L!==null?L.baseLanes|m:m,h!==null){for(b=f.child=h.child,y=0;b!==null;)y=y|b.lanes|b.childLanes,b=b.sibling;b=y&~L}else b=0,f.child=null;return GF(h,f,L,m,b)}if((m&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},h!==null&&Ty(f,L!==null?L.cachePool:null),L!==null?Y8(f,L):zT(),Q8(f);else return b=f.lanes=536870912,GF(h,f,L!==null?L.baseLanes|m:m,m,b)}else L!==null?(Ty(f,L.cachePool),Y8(f,L),nu(),f.memoizedState=null):(h!==null&&Ty(f,null),zT(),nu());return Ts(h,f,y,m),f.child}function yb(h,f){return h!==null&&h.tag===22||f.stateNode!==null||(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.sibling}function GF(h,f,m,b,y){var L=PT();return L=L===null?null:{parent:Vn._currentValue,pool:L},f.memoizedState={baseLanes:m,cachePool:L},h!==null&&Ty(f,null),zT(),Q8(f),h!==null&&jm(h,f,b,!0),f.childLanes=y,null}function $y(h,f){return f=Gy({mode:f.mode,children:f.children},h.mode),f.ref=h.ref,h.child=f,f.return=h,f}function KF(h,f,m){return Ud(f,h.child,null,m),h=$y(f,f.pendingProps),h.flags|=2,_o(f),f.memoizedState=null,h}function ine(h,f,m){var b=f.pendingProps,y=(f.flags&128)!==0;if(f.flags&=-129,h===null){if(Kt){if(b.mode==="hidden")return h=$y(f,b),f.lanes=536870912,yb(null,h);if(jT(f),(h=Ki)?(h=oV(h,Yo),h=h!==null&&h.data==="&"?h:null,h!==null&&(f.memoizedState={dehydrated:h,treeContext:Yh!==null?{id:ol,overflow:al}:null,retryLane:536870912,hydrationErrors:null},m=I8(h),m.return=f,f.child=m,Es=f,Ki=null)):h=null,h===null)throw Xh(f);return f.lanes=536870912,null}return $y(f,b)}var L=h.memoizedState;if(L!==null){var I=L.dehydrated;if(jT(f),y)if(f.flags&256)f.flags&=-257,f=KF(h,f,m);else if(f.memoizedState!==null)f.child=h.child,f.flags|=128,f=null;else throw Error(i(558));else if(Hn||jm(h,f,m,!1),y=(m&h.childLanes)!==0,Hn||y){if(b=Ri,b!==null&&(I=fo(b,m),I!==0&&I!==L.retryLane))throw L.retryLane=I,Od(h,I),Br(b,h,I),uN;iS(),f=KF(h,f,m)}else h=L.treeContext,Ki=Xo(I.nextSibling),Es=f,Kt=!0,Qh=null,Yo=!1,h!==null&&M8(f,h),f=$y(f,b),f.flags|=4096;return f}return h=bc(h.child,{mode:b.mode,children:b.children}),h.ref=f.ref,f.child=h,h.return=f,h}function qy(h,f){var m=f.ref;if(m===null)h!==null&&h.ref!==null&&(f.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(i(284));(h===null||h.ref!==m)&&(f.flags|=4194816)}}function dN(h,f,m,b,y){return Vd(f),m=qT(h,f,m,b,void 0,y),b=GT(),h!==null&&!Hn?(KT(h,f,y),xc(h,f,y)):(Kt&&b&&ET(f),f.flags|=1,Ts(h,f,m,y),f.child)}function YF(h,f,m,b,y,L){return Vd(f),f.updateQueue=null,m=Z8(f,b,m,y),X8(h),b=GT(),h!==null&&!Hn?(KT(h,f,L),xc(h,f,L)):(Kt&&b&&ET(f),f.flags|=1,Ts(h,f,m,L),f.child)}function QF(h,f,m,b,y){if(Vd(f),f.stateNode===null){var L=Wm,I=m.contextType;typeof I=="object"&&I!==null&&(L=Ds(I)),L=new m(b,L),f.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=cN,f.stateNode=L,L._reactInternals=f,L=f.stateNode,L.props=b,L.state=f.memoizedState,L.refs={},BT(f),I=m.contextType,L.context=typeof I=="object"&&I!==null?Ds(I):Wm,L.state=f.memoizedState,I=m.getDerivedStateFromProps,typeof I=="function"&&(lN(f,m,I,b),L.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(I=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),I!==L.state&&cN.enqueueReplaceState(L,L.state,null),_b(f,b,L,y),pb(),L.state=f.memoizedState),typeof L.componentDidMount=="function"&&(f.flags|=4194308),b=!0}else if(h===null){L=f.stateNode;var P=f.memoizedProps,X=$d(m,P);L.props=X;var ue=L.context,be=m.contextType;I=Wm,typeof be=="object"&&be!==null&&(I=Ds(be));var ye=m.getDerivedStateFromProps;be=typeof ye=="function"||typeof L.getSnapshotBeforeUpdate=="function",P=f.pendingProps!==P,be||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(P||ue!==I)&&PF(f,L,b,I),Jh=!1;var de=f.memoizedState;L.state=de,_b(f,b,L,y),pb(),ue=f.memoizedState,P||de!==ue||Jh?(typeof ye=="function"&&(lN(f,m,ye,b),ue=f.memoizedState),(X=Jh||OF(f,m,X,b,de,ue,I))?(be||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(f.flags|=4194308)):(typeof L.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=b,f.memoizedState=ue),L.props=b,L.state=ue,L.context=I,b=X):(typeof L.componentDidMount=="function"&&(f.flags|=4194308),b=!1)}else{L=f.stateNode,VT(h,f),I=f.memoizedProps,be=$d(m,I),L.props=be,ye=f.pendingProps,de=L.context,ue=m.contextType,X=Wm,typeof ue=="object"&&ue!==null&&(X=Ds(ue)),P=m.getDerivedStateFromProps,(ue=typeof P=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(I!==ye||de!==X)&&PF(f,L,b,X),Jh=!1,de=f.memoizedState,L.state=de,_b(f,b,L,y),pb();var fe=f.memoizedState;I!==ye||de!==fe||Jh||h!==null&&h.dependencies!==null&&Ey(h.dependencies)?(typeof P=="function"&&(lN(f,m,P,b),fe=f.memoizedState),(be=Jh||OF(f,m,be,b,de,fe,X)||h!==null&&h.dependencies!==null&&Ey(h.dependencies))?(ue||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(b,fe,X),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(b,fe,X)),typeof L.componentDidUpdate=="function"&&(f.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof L.componentDidUpdate!="function"||I===h.memoizedProps&&de===h.memoizedState||(f.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||I===h.memoizedProps&&de===h.memoizedState||(f.flags|=1024),f.memoizedProps=b,f.memoizedState=fe),L.props=b,L.state=fe,L.context=X,b=be):(typeof L.componentDidUpdate!="function"||I===h.memoizedProps&&de===h.memoizedState||(f.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||I===h.memoizedProps&&de===h.memoizedState||(f.flags|=1024),b=!1)}return L=b,qy(h,f),b=(f.flags&128)!==0,L||b?(L=f.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:L.render(),f.flags|=1,h!==null&&b?(f.child=Ud(f,h.child,null,y),f.child=Ud(f,null,m,y)):Ts(h,f,m,y),f.memoizedState=L.state,h=f.child):h=xc(h,f,y),h}function XF(h,f,m,b){return Fd(),f.flags|=256,Ts(h,f,m,b),f.child}var fN={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gN(h){return{baseLanes:h,cachePool:W8()}}function mN(h,f,m){return h=h!==null?h.childLanes&~m:0,f&&(h|=Co),h}function ZF(h,f,m){var b=f.pendingProps,y=!1,L=(f.flags&128)!==0,I;if((I=L)||(I=h!==null&&h.memoizedState===null?!1:(Dn.current&2)!==0),I&&(y=!0,f.flags&=-129),I=(f.flags&32)!==0,f.flags&=-33,h===null){if(Kt){if(y?iu(f):nu(),(h=Ki)?(h=oV(h,Yo),h=h!==null&&h.data!=="&"?h:null,h!==null&&(f.memoizedState={dehydrated:h,treeContext:Yh!==null?{id:ol,overflow:al}:null,retryLane:536870912,hydrationErrors:null},m=I8(h),m.return=f,f.child=m,Es=f,Ki=null)):h=null,h===null)throw Xh(f);return XN(h)?f.lanes=32:f.lanes=536870912,null}var P=b.children;return b=b.fallback,y?(nu(),y=f.mode,P=Gy({mode:"hidden",children:P},y),b=Pd(b,y,m,null),P.return=f,b.return=f,P.sibling=b,f.child=P,b=f.child,b.memoizedState=gN(m),b.childLanes=mN(h,I,m),f.memoizedState=fN,yb(null,b)):(iu(f),pN(f,P))}var X=h.memoizedState;if(X!==null&&(P=X.dehydrated,P!==null)){if(L)f.flags&256?(iu(f),f.flags&=-257,f=_N(h,f,m)):f.memoizedState!==null?(nu(),f.child=h.child,f.flags|=128,f=null):(nu(),P=b.fallback,y=f.mode,b=Gy({mode:"visible",children:b.children},y),P=Pd(P,y,m,null),P.flags|=2,b.return=f,P.return=f,b.sibling=P,f.child=b,Ud(f,h.child,null,m),b=f.child,b.memoizedState=gN(m),b.childLanes=mN(h,I,m),f.memoizedState=fN,f=yb(null,b));else if(iu(f),XN(P)){if(I=P.nextSibling&&P.nextSibling.dataset,I)var ue=I.dgst;I=ue,b=Error(i(419)),b.stack="",b.digest=I,hb({value:b,source:null,stack:null}),f=_N(h,f,m)}else if(Hn||jm(h,f,m,!1),I=(m&h.childLanes)!==0,Hn||I){if(I=Ri,I!==null&&(b=fo(I,m),b!==0&&b!==X.retryLane))throw X.retryLane=b,Od(h,b),Br(I,h,b),uN;QN(P)||iS(),f=_N(h,f,m)}else QN(P)?(f.flags|=192,f.child=h.child,f=null):(h=X.treeContext,Ki=Xo(P.nextSibling),Es=f,Kt=!0,Qh=null,Yo=!1,h!==null&&M8(f,h),f=pN(f,b.children),f.flags|=4096);return f}return y?(nu(),P=b.fallback,y=f.mode,X=h.child,ue=X.sibling,b=bc(X,{mode:"hidden",children:b.children}),b.subtreeFlags=X.subtreeFlags&65011712,ue!==null?P=bc(ue,P):(P=Pd(P,y,m,null),P.flags|=2),P.return=f,b.return=f,b.sibling=P,f.child=b,yb(null,b),b=f.child,P=h.child.memoizedState,P===null?P=gN(m):(y=P.cachePool,y!==null?(X=Vn._currentValue,y=y.parent!==X?{parent:X,pool:X}:y):y=W8(),P={baseLanes:P.baseLanes|m,cachePool:y}),b.memoizedState=P,b.childLanes=mN(h,I,m),f.memoizedState=fN,yb(h.child,b)):(iu(f),m=h.child,h=m.sibling,m=bc(m,{mode:"visible",children:b.children}),m.return=f,m.sibling=null,h!==null&&(I=f.deletions,I===null?(f.deletions=[h],f.flags|=16):I.push(h)),f.child=m,f.memoizedState=null,m)}function pN(h,f){return f=Gy({mode:"visible",children:f},h.mode),f.return=h,h.child=f}function Gy(h,f){return h=mo(22,h,null,f),h.lanes=0,h}function _N(h,f,m){return Ud(f,h.child,null,m),h=pN(f,f.pendingProps.children),h.flags|=2,f.memoizedState=null,h}function JF(h,f,m){h.lanes|=f;var b=h.alternate;b!==null&&(b.lanes|=f),RT(h.return,f,m)}function bN(h,f,m,b,y,L){var I=h.memoizedState;I===null?h.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:y,treeForkCount:L}:(I.isBackwards=f,I.rendering=null,I.renderingStartTime=0,I.last=b,I.tail=m,I.tailMode=y,I.treeForkCount=L)}function eB(h,f,m){var b=f.pendingProps,y=b.revealOrder,L=b.tail;b=b.children;var I=Dn.current,P=(I&2)!==0;if(P?(I=I&1|2,f.flags|=128):I&=1,oe(Dn,I),Ts(h,f,b,m),b=Kt?cb:0,!P&&h!==null&&(h.flags&128)!==0)e:for(h=f.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&JF(h,m,f);else if(h.tag===19)JF(h,m,f);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===f)break e;for(;h.sibling===null;){if(h.return===null||h.return===f)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}switch(y){case"forwards":for(m=f.child,y=null;m!==null;)h=m.alternate,h!==null&&Oy(h)===null&&(y=m),m=m.sibling;m=y,m===null?(y=f.child,f.child=null):(y=m.sibling,m.sibling=null),bN(f,!1,y,m,L,b);break;case"backwards":case"unstable_legacy-backwards":for(m=null,y=f.child,f.child=null;y!==null;){if(h=y.alternate,h!==null&&Oy(h)===null){f.child=y;break}h=y.sibling,y.sibling=m,m=y,y=h}bN(f,!0,m,null,L,b);break;case"together":bN(f,!1,null,null,void 0,b);break;default:f.memoizedState=null}return f.child}function xc(h,f,m){if(h!==null&&(f.dependencies=h.dependencies),ou|=f.lanes,(m&f.childLanes)===0)if(h!==null){if(jm(h,f,m,!1),(m&f.childLanes)===0)return null}else return null;if(h!==null&&f.child!==h.child)throw Error(i(153));if(f.child!==null){for(h=f.child,m=bc(h,h.pendingProps),f.child=m,m.return=f;h.sibling!==null;)h=h.sibling,m=m.sibling=bc(h,h.pendingProps),m.return=f;m.sibling=null}return f.child}function CN(h,f){return(h.lanes&f)!==0?!0:(h=h.dependencies,!!(h!==null&&Ey(h)))}function nne(h,f,m){switch(f.tag){case 3:Xe(f,f.stateNode.containerInfo),Zh(f,Vn,h.memoizedState.cache),Fd();break;case 27:case 5:xs(f);break;case 4:Xe(f,f.stateNode.containerInfo);break;case 10:Zh(f,f.type,f.memoizedProps.value);break;case 31:if(f.memoizedState!==null)return f.flags|=128,jT(f),null;break;case 13:var b=f.memoizedState;if(b!==null)return b.dehydrated!==null?(iu(f),f.flags|=128,null):(m&f.child.childLanes)!==0?ZF(h,f,m):(iu(f),h=xc(h,f,m),h!==null?h.sibling:null);iu(f);break;case 19:var y=(h.flags&128)!==0;if(b=(m&f.childLanes)!==0,b||(jm(h,f,m,!1),b=(m&f.childLanes)!==0),y){if(b)return eB(h,f,m);f.flags|=128}if(y=f.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),oe(Dn,Dn.current),b)break;return null;case 22:return f.lanes=0,qF(h,f,m,f.pendingProps);case 24:Zh(f,Vn,h.memoizedState.cache)}return xc(h,f,m)}function tB(h,f,m){if(h!==null)if(h.memoizedProps!==f.pendingProps)Hn=!0;else{if(!CN(h,m)&&(f.flags&128)===0)return Hn=!1,nne(h,f,m);Hn=(h.flags&131072)!==0}else Hn=!1,Kt&&(f.flags&1048576)!==0&&A8(f,cb,f.index);switch(f.lanes=0,f.tag){case 16:e:{var b=f.pendingProps;if(h=Hd(f.elementType),f.type=h,typeof h=="function")xT(h)?(b=$d(h,b),f.tag=1,f=QF(null,f,h,b,m)):(f.tag=0,f=dN(null,f,h,b,m));else{if(h!=null){var y=h.$$typeof;if(y===E){f.tag=11,f=UF(null,f,h,b,m);break e}else if(y===N){f.tag=14,f=jF(null,f,h,b,m);break e}}throw f=Z(h)||h,Error(i(306,f,""))}}return f;case 0:return dN(h,f,f.type,f.pendingProps,m);case 1:return b=f.type,y=$d(b,f.pendingProps),QF(h,f,b,y,m);case 3:e:{if(Xe(f,f.stateNode.containerInfo),h===null)throw Error(i(387));b=f.pendingProps;var L=f.memoizedState;y=L.element,VT(h,f),_b(f,b,null,m);var I=f.memoizedState;if(b=I.cache,Zh(f,Vn,b),b!==L.cache&&AT(f,[Vn],m,!0),pb(),b=I.element,L.isDehydrated)if(L={element:b,isDehydrated:!1,cache:I.cache},f.updateQueue.baseState=L,f.memoizedState=L,f.flags&256){f=XF(h,f,b,m);break e}else if(b!==y){y=qo(Error(i(424)),f),hb(y),f=XF(h,f,b,m);break e}else{switch(h=f.stateNode.containerInfo,h.nodeType){case 9:h=h.body;break;default:h=h.nodeName==="HTML"?h.ownerDocument.body:h}for(Ki=Xo(h.firstChild),Es=f,Kt=!0,Qh=null,Yo=!0,m=q8(f,null,b,m),f.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(Fd(),b===y){f=xc(h,f,m);break e}Ts(h,f,b,m)}f=f.child}return f;case 26:return qy(h,f),h===null?(m=dV(f.type,null,f.pendingProps,null))?f.memoizedState=m:Kt||(m=f.type,h=f.pendingProps,b=cS(Oe.current).createElement(m),b[Ni]=f,b[ks]=h,Ns(b,m,h),ni(b),f.stateNode=b):f.memoizedState=dV(f.type,h.memoizedProps,f.pendingProps,h.memoizedState),null;case 27:return xs(f),h===null&&Kt&&(b=f.stateNode=cV(f.type,f.pendingProps,Oe.current),Es=f,Yo=!0,y=Ki,uu(f.type)?(ZN=y,Ki=Xo(b.firstChild)):Ki=y),Ts(h,f,f.pendingProps.children,m),qy(h,f),h===null&&(f.flags|=4194304),f.child;case 5:return h===null&&Kt&&((y=b=Ki)&&(b=Ane(b,f.type,f.pendingProps,Yo),b!==null?(f.stateNode=b,Es=f,Ki=Xo(b.firstChild),Yo=!1,y=!0):y=!1),y||Xh(f)),xs(f),y=f.type,L=f.pendingProps,I=h!==null?h.memoizedProps:null,b=L.children,GN(y,L)?b=null:I!==null&&GN(y,I)&&(f.flags|=32),f.memoizedState!==null&&(y=qT(h,f,Kie,null,null,m),Fb._currentValue=y),qy(h,f),Ts(h,f,b,m),f.child;case 6:return h===null&&Kt&&((h=m=Ki)&&(m=Mne(m,f.pendingProps,Yo),m!==null?(f.stateNode=m,Es=f,Ki=null,h=!0):h=!1),h||Xh(f)),null;case 13:return ZF(h,f,m);case 4:return Xe(f,f.stateNode.containerInfo),b=f.pendingProps,h===null?f.child=Ud(f,null,b,m):Ts(h,f,b,m),f.child;case 11:return UF(h,f,f.type,f.pendingProps,m);case 7:return Ts(h,f,f.pendingProps,m),f.child;case 8:return Ts(h,f,f.pendingProps.children,m),f.child;case 12:return Ts(h,f,f.pendingProps.children,m),f.child;case 10:return b=f.pendingProps,Zh(f,f.type,b.value),Ts(h,f,b.children,m),f.child;case 9:return y=f.type._context,b=f.pendingProps.children,Vd(f),y=Ds(y),b=b(y),f.flags|=1,Ts(h,f,b,m),f.child;case 14:return jF(h,f,f.type,f.pendingProps,m);case 15:return $F(h,f,f.type,f.pendingProps,m);case 19:return eB(h,f,m);case 31:return ine(h,f,m);case 22:return qF(h,f,m,f.pendingProps);case 24:return Vd(f),b=Ds(Vn),h===null?(y=PT(),y===null&&(y=Ri,L=MT(),y.pooledCache=L,L.refCount++,L!==null&&(y.pooledCacheLanes|=m),y=L),f.memoizedState={parent:b,cache:y},BT(f),Zh(f,Vn,y)):((h.lanes&m)!==0&&(VT(h,f),_b(f,null,null,m),pb()),y=h.memoizedState,L=f.memoizedState,y.parent!==b?(y={parent:b,cache:b},f.memoizedState=y,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=y),Zh(f,Vn,b)):(b=L.cache,Zh(f,Vn,b),b!==y.cache&&AT(f,[Vn],m,!0))),Ts(h,f,f.pendingProps.children,m),f.child;case 29:throw f.pendingProps}throw Error(i(156,f.tag))}function Lc(h){h.flags|=4}function wN(h,f,m,b,y){if((f=(h.mode&32)!==0)&&(f=!1),f){if(h.flags|=16777216,(y&335544128)===y)if(h.stateNode.complete)h.flags|=8192;else if(DB())h.flags|=8192;else throw zd=Iy,FT}else h.flags&=-16777217}function iB(h,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)h.flags&=-16777217;else if(h.flags|=16777216,!_V(f))if(DB())h.flags|=8192;else throw zd=Iy,FT}function Ky(h,f){f!==null&&(h.flags|=4),h.flags&16384&&(f=h.tag!==22?oy():536870912,h.lanes|=f,ip|=f)}function Sb(h,f){if(!Kt)switch(h.tailMode){case"hidden":f=h.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?h.tail=null:m.sibling=null;break;case"collapsed":m=h.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?f||h.tail===null?h.tail=null:h.tail.sibling=null:b.sibling=null}}function Yi(h){var f=h.alternate!==null&&h.alternate.child===h.child,m=0,b=0;if(f)for(var y=h.child;y!==null;)m|=y.lanes|y.childLanes,b|=y.subtreeFlags&65011712,b|=y.flags&65011712,y.return=h,y=y.sibling;else for(y=h.child;y!==null;)m|=y.lanes|y.childLanes,b|=y.subtreeFlags,b|=y.flags,y.return=h,y=y.sibling;return h.subtreeFlags|=b,h.childLanes=m,f}function sne(h,f,m){var b=f.pendingProps;switch(DT(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yi(f),null;case 1:return Yi(f),null;case 3:return m=f.stateNode,b=null,h!==null&&(b=h.memoizedState.cache),f.memoizedState.cache!==b&&(f.flags|=2048),vc(Vn),lt(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(h===null||h.child===null)&&(Um(f)?Lc(f):h===null||h.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,NT())),Yi(f),null;case 26:var y=f.type,L=f.memoizedState;return h===null?(Lc(f),L!==null?(Yi(f),iB(f,L)):(Yi(f),wN(f,y,null,b,m))):L?L!==h.memoizedState?(Lc(f),Yi(f),iB(f,L)):(Yi(f),f.flags&=-16777217):(h=h.memoizedProps,h!==b&&Lc(f),Yi(f),wN(f,y,h,b,m)),null;case 27:if(nl(f),m=Oe.current,y=f.type,h!==null&&f.stateNode!=null)h.memoizedProps!==b&&Lc(f);else{if(!b){if(f.stateNode===null)throw Error(i(166));return Yi(f),null}h=Se.current,Um(f)?O8(f):(h=cV(y,b,m),f.stateNode=h,Lc(f))}return Yi(f),null;case 5:if(nl(f),y=f.type,h!==null&&f.stateNode!=null)h.memoizedProps!==b&&Lc(f);else{if(!b){if(f.stateNode===null)throw Error(i(166));return Yi(f),null}if(L=Se.current,Um(f))O8(f);else{var I=cS(Oe.current);switch(L){case 1:L=I.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:L=I.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":L=I.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":L=I.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":L=I.createElement("div"),L.innerHTML="<script><\/script>",L=L.removeChild(L.firstChild);break;case"select":L=typeof b.is=="string"?I.createElement("select",{is:b.is}):I.createElement("select"),b.multiple?L.multiple=!0:b.size&&(L.size=b.size);break;default:L=typeof b.is=="string"?I.createElement(y,{is:b.is}):I.createElement(y)}}L[Ni]=f,L[ks]=b;e:for(I=f.child;I!==null;){if(I.tag===5||I.tag===6)L.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===f)break e;for(;I.sibling===null;){if(I.return===null||I.return===f)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}f.stateNode=L;e:switch(Ns(L,y,b),y){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&Lc(f)}}return Yi(f),wN(f,f.type,h===null?null:h.memoizedProps,f.pendingProps,m),null;case 6:if(h&&f.stateNode!=null)h.memoizedProps!==b&&Lc(f);else{if(typeof b!="string"&&f.stateNode===null)throw Error(i(166));if(h=Oe.current,Um(f)){if(h=f.stateNode,m=f.memoizedProps,b=null,y=Es,y!==null)switch(y.tag){case 27:case 5:b=y.memoizedProps}h[Ni]=f,h=!!(h.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||ZB(h.nodeValue,m)),h||Xh(f,!0)}else h=cS(h).createTextNode(b),h[Ni]=f,f.stateNode=h}return Yi(f),null;case 31:if(m=f.memoizedState,h===null||h.memoizedState!==null){if(b=Um(f),m!==null){if(h===null){if(!b)throw Error(i(318));if(h=f.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(557));h[Ni]=f}else Fd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Yi(f),h=!1}else m=NT(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=m),h=!0;if(!h)return f.flags&256?(_o(f),f):(_o(f),null);if((f.flags&128)!==0)throw Error(i(558))}return Yi(f),null;case 13:if(b=f.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(y=Um(f),b!==null&&b.dehydrated!==null){if(h===null){if(!y)throw Error(i(318));if(y=f.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[Ni]=f}else Fd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Yi(f),y=!1}else y=NT(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=y),y=!0;if(!y)return f.flags&256?(_o(f),f):(_o(f),null)}return _o(f),(f.flags&128)!==0?(f.lanes=m,f):(m=b!==null,h=h!==null&&h.memoizedState!==null,m&&(b=f.child,y=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(y=b.alternate.memoizedState.cachePool.pool),L=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(L=b.memoizedState.cachePool.pool),L!==y&&(b.flags|=2048)),m!==h&&m&&(f.child.flags|=8192),Ky(f,f.updateQueue),Yi(f),null);case 4:return lt(),h===null&&zN(f.stateNode.containerInfo),Yi(f),null;case 10:return vc(f.type),Yi(f),null;case 19:if(ce(Dn),b=f.memoizedState,b===null)return Yi(f),null;if(y=(f.flags&128)!==0,L=b.rendering,L===null)if(y)Sb(b,!1);else{if(_n!==0||h!==null&&(h.flags&128)!==0)for(h=f.child;h!==null;){if(L=Oy(h),L!==null){for(f.flags|=128,Sb(b,!1),h=L.updateQueue,f.updateQueue=h,Ky(f,h),f.subtreeFlags=0,h=m,m=f.child;m!==null;)N8(m,h),m=m.sibling;return oe(Dn,Dn.current&1|2),Kt&&Cc(f,b.treeForkCount),f.child}h=h.sibling}b.tail!==null&&ts()>Jy&&(f.flags|=128,y=!0,Sb(b,!1),f.lanes=4194304)}else{if(!y)if(h=Oy(L),h!==null){if(f.flags|=128,y=!0,h=h.updateQueue,f.updateQueue=h,Ky(f,h),Sb(b,!0),b.tail===null&&b.tailMode==="hidden"&&!L.alternate&&!Kt)return Yi(f),null}else 2*ts()-b.renderingStartTime>Jy&&m!==536870912&&(f.flags|=128,y=!0,Sb(b,!1),f.lanes=4194304);b.isBackwards?(L.sibling=f.child,f.child=L):(h=b.last,h!==null?h.sibling=L:f.child=L,b.last=L)}return b.tail!==null?(h=b.tail,b.rendering=h,b.tail=h.sibling,b.renderingStartTime=ts(),h.sibling=null,m=Dn.current,oe(Dn,y?m&1|2:m&1),Kt&&Cc(f,b.treeForkCount),h):(Yi(f),null);case 22:case 23:return _o(f),UT(),b=f.memoizedState!==null,h!==null?h.memoizedState!==null!==b&&(f.flags|=8192):b&&(f.flags|=8192),b?(m&536870912)!==0&&(f.flags&128)===0&&(Yi(f),f.subtreeFlags&6&&(f.flags|=8192)):Yi(f),m=f.updateQueue,m!==null&&Ky(f,m.retryQueue),m=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(m=h.memoizedState.cachePool.pool),b=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==m&&(f.flags|=2048),h!==null&&ce(Wd),null;case 24:return m=null,h!==null&&(m=h.memoizedState.cache),f.memoizedState.cache!==m&&(f.flags|=2048),vc(Vn),Yi(f),null;case 25:return null;case 30:return null}throw Error(i(156,f.tag))}function rne(h,f){switch(DT(f),f.tag){case 1:return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 3:return vc(Vn),lt(),h=f.flags,(h&65536)!==0&&(h&128)===0?(f.flags=h&-65537|128,f):null;case 26:case 27:case 5:return nl(f),null;case 31:if(f.memoizedState!==null){if(_o(f),f.alternate===null)throw Error(i(340));Fd()}return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 13:if(_o(f),h=f.memoizedState,h!==null&&h.dehydrated!==null){if(f.alternate===null)throw Error(i(340));Fd()}return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 19:return ce(Dn),null;case 4:return lt(),null;case 10:return vc(f.type),null;case 22:case 23:return _o(f),UT(),h!==null&&ce(Wd),h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 24:return vc(Vn),null;case 25:return null;default:return null}}function nB(h,f){switch(DT(f),f.tag){case 3:vc(Vn),lt();break;case 26:case 27:case 5:nl(f);break;case 4:lt();break;case 31:f.memoizedState!==null&&_o(f);break;case 13:_o(f);break;case 19:ce(Dn);break;case 10:vc(f.type);break;case 22:case 23:_o(f),UT(),h!==null&&ce(Wd);break;case 24:vc(Vn)}}function xb(h,f){try{var m=f.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var y=b.next;m=y;do{if((m.tag&h)===h){b=void 0;var L=m.create,I=m.inst;b=L(),I.destroy=b}m=m.next}while(m!==y)}}catch(P){Ci(f,f.return,P)}}function su(h,f,m){try{var b=f.updateQueue,y=b!==null?b.lastEffect:null;if(y!==null){var L=y.next;b=L;do{if((b.tag&h)===h){var I=b.inst,P=I.destroy;if(P!==void 0){I.destroy=void 0,y=f;var X=m,ue=P;try{ue()}catch(be){Ci(y,X,be)}}}b=b.next}while(b!==L)}}catch(be){Ci(f,f.return,be)}}function sB(h){var f=h.updateQueue;if(f!==null){var m=h.stateNode;try{K8(f,m)}catch(b){Ci(h,h.return,b)}}}function rB(h,f,m){m.props=$d(h.type,h.memoizedProps),m.state=h.memoizedState;try{m.componentWillUnmount()}catch(b){Ci(h,f,b)}}function Lb(h,f){try{var m=h.ref;if(m!==null){switch(h.tag){case 26:case 27:case 5:var b=h.stateNode;break;case 30:b=h.stateNode;break;default:b=h.stateNode}typeof m=="function"?h.refCleanup=m(b):m.current=b}}catch(y){Ci(h,f,y)}}function ll(h,f){var m=h.ref,b=h.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(y){Ci(h,f,y)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(y){Ci(h,f,y)}else m.current=null}function oB(h){var f=h.type,m=h.memoizedProps,b=h.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(y){Ci(h,h.return,y)}}function vN(h,f,m){try{var b=h.stateNode;Ene(b,h.type,m,f),b[ks]=f}catch(y){Ci(h,h.return,y)}}function aB(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27&&uu(h.type)||h.tag===4}function yN(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||aB(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.tag===27&&uu(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function SN(h,f,m){var b=h.tag;if(b===5||b===6)h=h.stateNode,f?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(h,f):(f=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,f.appendChild(h),m=m._reactRootContainer,m!=null||f.onclick!==null||(f.onclick=pc));else if(b!==4&&(b===27&&uu(h.type)&&(m=h.stateNode,f=null),h=h.child,h!==null))for(SN(h,f,m),h=h.sibling;h!==null;)SN(h,f,m),h=h.sibling}function Yy(h,f,m){var b=h.tag;if(b===5||b===6)h=h.stateNode,f?m.insertBefore(h,f):m.appendChild(h);else if(b!==4&&(b===27&&uu(h.type)&&(m=h.stateNode),h=h.child,h!==null))for(Yy(h,f,m),h=h.sibling;h!==null;)Yy(h,f,m),h=h.sibling}function lB(h){var f=h.stateNode,m=h.memoizedProps;try{for(var b=h.type,y=f.attributes;y.length;)f.removeAttributeNode(y[0]);Ns(f,b,m),f[Ni]=h,f[ks]=m}catch(L){Ci(h,h.return,L)}}var kc=!1,zn=!1,xN=!1,cB=typeof WeakSet=="function"?WeakSet:Set,ds=null;function one(h,f){if(h=h.containerInfo,$N=pS,h=v8(h),_T(h)){if("selectionStart"in h)var m={start:h.selectionStart,end:h.selectionEnd};else e:{m=(m=h.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var y=b.anchorOffset,L=b.focusNode;b=b.focusOffset;try{m.nodeType,L.nodeType}catch{m=null;break e}var I=0,P=-1,X=-1,ue=0,be=0,ye=h,de=null;t:for(;;){for(var fe;ye!==m||y!==0&&ye.nodeType!==3||(P=I+y),ye!==L||b!==0&&ye.nodeType!==3||(X=I+b),ye.nodeType===3&&(I+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)de=ye,ye=fe;for(;;){if(ye===h)break t;if(de===m&&++ue===y&&(P=I),de===L&&++be===b&&(X=I),(fe=ye.nextSibling)!==null)break;ye=de,de=ye.parentNode}ye=fe}m=P===-1||X===-1?null:{start:P,end:X}}else m=null}m=m||{start:0,end:0}}else m=null;for(qN={focusedElem:h,selectionRange:m},pS=!1,ds=f;ds!==null;)if(f=ds,h=f.child,(f.subtreeFlags&1028)!==0&&h!==null)h.return=f,ds=h;else for(;ds!==null;){switch(f=ds,L=f.alternate,h=f.flags,f.tag){case 0:if((h&4)!==0&&(h=f.updateQueue,h=h!==null?h.events:null,h!==null))for(m=0;m<h.length;m++)y=h[m],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((h&1024)!==0&&L!==null){h=void 0,m=f,y=L.memoizedProps,L=L.memoizedState,b=m.stateNode;try{var $e=$d(m.type,y);h=b.getSnapshotBeforeUpdate($e,L),b.__reactInternalSnapshotBeforeUpdate=h}catch(ot){Ci(m,m.return,ot)}}break;case 3:if((h&1024)!==0){if(h=f.stateNode.containerInfo,m=h.nodeType,m===9)YN(h);else if(m===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":YN(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(i(163))}if(h=f.sibling,h!==null){h.return=f.return,ds=h;break}ds=f.return}}function hB(h,f,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:Dc(h,m),b&4&&xb(5,m);break;case 1:if(Dc(h,m),b&4)if(h=m.stateNode,f===null)try{h.componentDidMount()}catch(I){Ci(m,m.return,I)}else{var y=$d(m.type,f.memoizedProps);f=f.memoizedState;try{h.componentDidUpdate(y,f,h.__reactInternalSnapshotBeforeUpdate)}catch(I){Ci(m,m.return,I)}}b&64&&sB(m),b&512&&Lb(m,m.return);break;case 3:if(Dc(h,m),b&64&&(h=m.updateQueue,h!==null)){if(f=null,m.child!==null)switch(m.child.tag){case 27:case 5:f=m.child.stateNode;break;case 1:f=m.child.stateNode}try{K8(h,f)}catch(I){Ci(m,m.return,I)}}break;case 27:f===null&&b&4&&lB(m);case 26:case 5:Dc(h,m),f===null&&b&4&&oB(m),b&512&&Lb(m,m.return);break;case 12:Dc(h,m);break;case 31:Dc(h,m),b&4&&fB(h,m);break;case 13:Dc(h,m),b&4&&gB(h,m),b&64&&(h=m.memoizedState,h!==null&&(h=h.dehydrated,h!==null&&(m=mne.bind(null,m),One(h,m))));break;case 22:if(b=m.memoizedState!==null||kc,!b){f=f!==null&&f.memoizedState!==null||zn,y=kc;var L=zn;kc=b,(zn=f)&&!L?Tc(h,m,(m.subtreeFlags&8772)!==0):Dc(h,m),kc=y,zn=L}break;case 30:break;default:Dc(h,m)}}function uB(h){var f=h.alternate;f!==null&&(h.alternate=null,uB(f)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(f=h.stateNode,f!==null&&Te(f)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var tn=null,Mr=!1;function Ec(h,f,m){for(m=m.child;m!==null;)dB(h,f,m),m=m.sibling}function dB(h,f,m){if(on&&typeof on.onCommitFiberUnmount=="function")try{on.onCommitFiberUnmount(sl,m)}catch{}switch(m.tag){case 26:zn||ll(m,f),Ec(h,f,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:zn||ll(m,f);var b=tn,y=Mr;uu(m.type)&&(tn=m.stateNode,Mr=!1),Ec(h,f,m),Mb(m.stateNode),tn=b,Mr=y;break;case 5:zn||ll(m,f);case 6:if(b=tn,y=Mr,tn=null,Ec(h,f,m),tn=b,Mr=y,tn!==null)if(Mr)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(m.stateNode)}catch(L){Ci(m,f,L)}else try{tn.removeChild(m.stateNode)}catch(L){Ci(m,f,L)}break;case 18:tn!==null&&(Mr?(h=tn,sV(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,m.stateNode),hp(h)):sV(tn,m.stateNode));break;case 4:b=tn,y=Mr,tn=m.stateNode.containerInfo,Mr=!0,Ec(h,f,m),tn=b,Mr=y;break;case 0:case 11:case 14:case 15:su(2,m,f),zn||su(4,m,f),Ec(h,f,m);break;case 1:zn||(ll(m,f),b=m.stateNode,typeof b.componentWillUnmount=="function"&&rB(m,f,b)),Ec(h,f,m);break;case 21:Ec(h,f,m);break;case 22:zn=(b=zn)||m.memoizedState!==null,Ec(h,f,m),zn=b;break;default:Ec(h,f,m)}}function fB(h,f){if(f.memoizedState===null&&(h=f.alternate,h!==null&&(h=h.memoizedState,h!==null))){h=h.dehydrated;try{hp(h)}catch(m){Ci(f,f.return,m)}}}function gB(h,f){if(f.memoizedState===null&&(h=f.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{hp(h)}catch(m){Ci(f,f.return,m)}}function ane(h){switch(h.tag){case 31:case 13:case 19:var f=h.stateNode;return f===null&&(f=h.stateNode=new cB),f;case 22:return h=h.stateNode,f=h._retryCache,f===null&&(f=h._retryCache=new cB),f;default:throw Error(i(435,h.tag))}}function Qy(h,f){var m=ane(h);f.forEach(function(b){if(!m.has(b)){m.add(b);var y=pne.bind(null,h,b);b.then(y,y)}})}function Or(h,f){var m=f.deletions;if(m!==null)for(var b=0;b<m.length;b++){var y=m[b],L=h,I=f,P=I;e:for(;P!==null;){switch(P.tag){case 27:if(uu(P.type)){tn=P.stateNode,Mr=!1;break e}break;case 5:tn=P.stateNode,Mr=!1;break e;case 3:case 4:tn=P.stateNode.containerInfo,Mr=!0;break e}P=P.return}if(tn===null)throw Error(i(160));dB(L,I,y),tn=null,Mr=!1,L=y.alternate,L!==null&&(L.return=null),y.return=null}if(f.subtreeFlags&13886)for(f=f.child;f!==null;)mB(f,h),f=f.sibling}var Sa=null;function mB(h,f){var m=h.alternate,b=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Or(f,h),Pr(h),b&4&&(su(3,h,h.return),xb(3,h),su(5,h,h.return));break;case 1:Or(f,h),Pr(h),b&512&&(zn||m===null||ll(m,m.return)),b&64&&kc&&(h=h.updateQueue,h!==null&&(b=h.callbacks,b!==null&&(m=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var y=Sa;if(Or(f,h),Pr(h),b&512&&(zn||m===null||ll(m,m.return)),b&4){var L=m!==null?m.memoizedState:null;if(b=h.memoizedState,m===null)if(b===null)if(h.stateNode===null){e:{b=h.type,m=h.memoizedProps,y=y.ownerDocument||y;t:switch(b){case"title":L=y.getElementsByTagName("title")[0],(!L||L[te]||L[Ni]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=y.createElement(b),y.head.insertBefore(L,y.querySelector("head > title"))),Ns(L,b,m),L[Ni]=h,ni(L),b=L;break e;case"link":var I=mV("link","href",y).get(b+(m.href||""));if(I){for(var P=0;P<I.length;P++)if(L=I[P],L.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&L.getAttribute("rel")===(m.rel==null?null:m.rel)&&L.getAttribute("title")===(m.title==null?null:m.title)&&L.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){I.splice(P,1);break t}}L=y.createElement(b),Ns(L,b,m),y.head.appendChild(L);break;case"meta":if(I=mV("meta","content",y).get(b+(m.content||""))){for(P=0;P<I.length;P++)if(L=I[P],L.getAttribute("content")===(m.content==null?null:""+m.content)&&L.getAttribute("name")===(m.name==null?null:m.name)&&L.getAttribute("property")===(m.property==null?null:m.property)&&L.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&L.getAttribute("charset")===(m.charSet==null?null:m.charSet)){I.splice(P,1);break t}}L=y.createElement(b),Ns(L,b,m),y.head.appendChild(L);break;default:throw Error(i(468,b))}L[Ni]=h,ni(L),b=L}h.stateNode=b}else pV(y,h.type,h.stateNode);else h.stateNode=gV(y,b,h.memoizedProps);else L!==b?(L===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):L.count--,b===null?pV(y,h.type,h.stateNode):gV(y,b,h.memoizedProps)):b===null&&h.stateNode!==null&&vN(h,h.memoizedProps,m.memoizedProps)}break;case 27:Or(f,h),Pr(h),b&512&&(zn||m===null||ll(m,m.return)),m!==null&&b&4&&vN(h,h.memoizedProps,m.memoizedProps);break;case 5:if(Or(f,h),Pr(h),b&512&&(zn||m===null||ll(m,m.return)),h.flags&32){y=h.stateNode;try{Am(y,"")}catch($e){Ci(h,h.return,$e)}}b&4&&h.stateNode!=null&&(y=h.memoizedProps,vN(h,y,m!==null?m.memoizedProps:y)),b&1024&&(xN=!0);break;case 6:if(Or(f,h),Pr(h),b&4){if(h.stateNode===null)throw Error(i(162));b=h.memoizedProps,m=h.stateNode;try{m.nodeValue=b}catch($e){Ci(h,h.return,$e)}}break;case 3:if(dS=null,y=Sa,Sa=hS(f.containerInfo),Or(f,h),Sa=y,Pr(h),b&4&&m!==null&&m.memoizedState.isDehydrated)try{hp(f.containerInfo)}catch($e){Ci(h,h.return,$e)}xN&&(xN=!1,pB(h));break;case 4:b=Sa,Sa=hS(h.stateNode.containerInfo),Or(f,h),Pr(h),Sa=b;break;case 12:Or(f,h),Pr(h);break;case 31:Or(f,h),Pr(h),b&4&&(b=h.updateQueue,b!==null&&(h.updateQueue=null,Qy(h,b)));break;case 13:Or(f,h),Pr(h),h.child.flags&8192&&h.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(Zy=ts()),b&4&&(b=h.updateQueue,b!==null&&(h.updateQueue=null,Qy(h,b)));break;case 22:y=h.memoizedState!==null;var X=m!==null&&m.memoizedState!==null,ue=kc,be=zn;if(kc=ue||y,zn=be||X,Or(f,h),zn=be,kc=ue,Pr(h),b&8192)e:for(f=h.stateNode,f._visibility=y?f._visibility&-2:f._visibility|1,y&&(m===null||X||kc||zn||qd(h)),m=null,f=h;;){if(f.tag===5||f.tag===26){if(m===null){X=m=f;try{if(L=X.stateNode,y)I=L.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{P=X.stateNode;var ye=X.memoizedProps.style,de=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;P.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch($e){Ci(X,X.return,$e)}}}else if(f.tag===6){if(m===null){X=f;try{X.stateNode.nodeValue=y?"":X.memoizedProps}catch($e){Ci(X,X.return,$e)}}}else if(f.tag===18){if(m===null){X=f;try{var fe=X.stateNode;y?rV(fe,!0):rV(X.stateNode,!1)}catch($e){Ci(X,X.return,$e)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===h)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break e;for(;f.sibling===null;){if(f.return===null||f.return===h)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}b&4&&(b=h.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,Qy(h,m))));break;case 19:Or(f,h),Pr(h),b&4&&(b=h.updateQueue,b!==null&&(h.updateQueue=null,Qy(h,b)));break;case 30:break;case 21:break;default:Or(f,h),Pr(h)}}function Pr(h){var f=h.flags;if(f&2){try{for(var m,b=h.return;b!==null;){if(aB(b)){m=b;break}b=b.return}if(m==null)throw Error(i(160));switch(m.tag){case 27:var y=m.stateNode,L=yN(h);Yy(h,L,y);break;case 5:var I=m.stateNode;m.flags&32&&(Am(I,""),m.flags&=-33);var P=yN(h);Yy(h,P,I);break;case 3:case 4:var X=m.stateNode.containerInfo,ue=yN(h);SN(h,ue,X);break;default:throw Error(i(161))}}catch(be){Ci(h,h.return,be)}h.flags&=-3}f&4096&&(h.flags&=-4097)}function pB(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var f=h;pB(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),h=h.sibling}}function Dc(h,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)hB(h,f.alternate,f),f=f.sibling}function qd(h){for(h=h.child;h!==null;){var f=h;switch(f.tag){case 0:case 11:case 14:case 15:su(4,f,f.return),qd(f);break;case 1:ll(f,f.return);var m=f.stateNode;typeof m.componentWillUnmount=="function"&&rB(f,f.return,m),qd(f);break;case 27:Mb(f.stateNode);case 26:case 5:ll(f,f.return),qd(f);break;case 22:f.memoizedState===null&&qd(f);break;case 30:qd(f);break;default:qd(f)}h=h.sibling}}function Tc(h,f,m){for(m=m&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var b=f.alternate,y=h,L=f,I=L.flags;switch(L.tag){case 0:case 11:case 15:Tc(y,L,m),xb(4,L);break;case 1:if(Tc(y,L,m),b=L,y=b.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ue){Ci(b,b.return,ue)}if(b=L,y=b.updateQueue,y!==null){var P=b.stateNode;try{var X=y.shared.hiddenCallbacks;if(X!==null)for(y.shared.hiddenCallbacks=null,y=0;y<X.length;y++)G8(X[y],P)}catch(ue){Ci(b,b.return,ue)}}m&&I&64&&sB(L),Lb(L,L.return);break;case 27:lB(L);case 26:case 5:Tc(y,L,m),m&&b===null&&I&4&&oB(L),Lb(L,L.return);break;case 12:Tc(y,L,m);break;case 31:Tc(y,L,m),m&&I&4&&fB(y,L);break;case 13:Tc(y,L,m),m&&I&4&&gB(y,L);break;case 22:L.memoizedState===null&&Tc(y,L,m),Lb(L,L.return);break;case 30:break;default:Tc(y,L,m)}f=f.sibling}}function LN(h,f){var m=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(m=h.memoizedState.cachePool.pool),h=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(h=f.memoizedState.cachePool.pool),h!==m&&(h!=null&&h.refCount++,m!=null&&ub(m))}function kN(h,f){h=null,f.alternate!==null&&(h=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==h&&(f.refCount++,h!=null&&ub(h))}function xa(h,f,m,b){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)_B(h,f,m,b),f=f.sibling}function _B(h,f,m,b){var y=f.flags;switch(f.tag){case 0:case 11:case 15:xa(h,f,m,b),y&2048&&xb(9,f);break;case 1:xa(h,f,m,b);break;case 3:xa(h,f,m,b),y&2048&&(h=null,f.alternate!==null&&(h=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==h&&(f.refCount++,h!=null&&ub(h)));break;case 12:if(y&2048){xa(h,f,m,b),h=f.stateNode;try{var L=f.memoizedProps,I=L.id,P=L.onPostCommit;typeof P=="function"&&P(I,f.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(X){Ci(f,f.return,X)}}else xa(h,f,m,b);break;case 31:xa(h,f,m,b);break;case 13:xa(h,f,m,b);break;case 23:break;case 22:L=f.stateNode,I=f.alternate,f.memoizedState!==null?L._visibility&2?xa(h,f,m,b):kb(h,f):L._visibility&2?xa(h,f,m,b):(L._visibility|=2,Jm(h,f,m,b,(f.subtreeFlags&10256)!==0||!1)),y&2048&&LN(I,f);break;case 24:xa(h,f,m,b),y&2048&&kN(f.alternate,f);break;default:xa(h,f,m,b)}}function Jm(h,f,m,b,y){for(y=y&&((f.subtreeFlags&10256)!==0||!1),f=f.child;f!==null;){var L=h,I=f,P=m,X=b,ue=I.flags;switch(I.tag){case 0:case 11:case 15:Jm(L,I,P,X,y),xb(8,I);break;case 23:break;case 22:var be=I.stateNode;I.memoizedState!==null?be._visibility&2?Jm(L,I,P,X,y):kb(L,I):(be._visibility|=2,Jm(L,I,P,X,y)),y&&ue&2048&&LN(I.alternate,I);break;case 24:Jm(L,I,P,X,y),y&&ue&2048&&kN(I.alternate,I);break;default:Jm(L,I,P,X,y)}f=f.sibling}}function kb(h,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var m=h,b=f,y=b.flags;switch(b.tag){case 22:kb(m,b),y&2048&&LN(b.alternate,b);break;case 24:kb(m,b),y&2048&&kN(b.alternate,b);break;default:kb(m,b)}f=f.sibling}}var Eb=8192;function ep(h,f,m){if(h.subtreeFlags&Eb)for(h=h.child;h!==null;)bB(h,f,m),h=h.sibling}function bB(h,f,m){switch(h.tag){case 26:ep(h,f,m),h.flags&Eb&&h.memoizedState!==null&&Gne(m,Sa,h.memoizedState,h.memoizedProps);break;case 5:ep(h,f,m);break;case 3:case 4:var b=Sa;Sa=hS(h.stateNode.containerInfo),ep(h,f,m),Sa=b;break;case 22:h.memoizedState===null&&(b=h.alternate,b!==null&&b.memoizedState!==null?(b=Eb,Eb=16777216,ep(h,f,m),Eb=b):ep(h,f,m));break;default:ep(h,f,m)}}function CB(h){var f=h.alternate;if(f!==null&&(h=f.child,h!==null)){f.child=null;do f=h.sibling,h.sibling=null,h=f;while(h!==null)}}function Db(h){var f=h.deletions;if((h.flags&16)!==0){if(f!==null)for(var m=0;m<f.length;m++){var b=f[m];ds=b,vB(b,h)}CB(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)wB(h),h=h.sibling}function wB(h){switch(h.tag){case 0:case 11:case 15:Db(h),h.flags&2048&&su(9,h,h.return);break;case 3:Db(h);break;case 12:Db(h);break;case 22:var f=h.stateNode;h.memoizedState!==null&&f._visibility&2&&(h.return===null||h.return.tag!==13)?(f._visibility&=-3,Xy(h)):Db(h);break;default:Db(h)}}function Xy(h){var f=h.deletions;if((h.flags&16)!==0){if(f!==null)for(var m=0;m<f.length;m++){var b=f[m];ds=b,vB(b,h)}CB(h)}for(h=h.child;h!==null;){switch(f=h,f.tag){case 0:case 11:case 15:su(8,f,f.return),Xy(f);break;case 22:m=f.stateNode,m._visibility&2&&(m._visibility&=-3,Xy(f));break;default:Xy(f)}h=h.sibling}}function vB(h,f){for(;ds!==null;){var m=ds;switch(m.tag){case 0:case 11:case 15:su(8,m,f);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:ub(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,ds=b;else e:for(m=h;ds!==null;){b=ds;var y=b.sibling,L=b.return;if(uB(b),b===m){ds=null;break e}if(y!==null){y.return=L,ds=y;break e}ds=L}}}var lne={getCacheForType:function(h){var f=Ds(Vn),m=f.data.get(h);return m===void 0&&(m=h(),f.data.set(h,m)),m},cacheSignal:function(){return Ds(Vn).controller.signal}},cne=typeof WeakMap=="function"?WeakMap:Map,fi=0,Ri=null,Vt=null,qt=0,bi=0,bo=null,ru=!1,tp=!1,EN=!1,Nc=0,_n=0,ou=0,Gd=0,DN=0,Co=0,ip=0,Tb=null,Fr=null,TN=!1,Zy=0,yB=0,Jy=1/0,eS=null,au=null,is=0,lu=null,np=null,Ic=0,NN=0,IN=null,SB=null,Nb=0,RN=null;function wo(){return(fi&2)!==0&&qt!==0?qt&-qt:U.T!==null?BN():Z1()}function xB(){if(Co===0)if((qt&536870912)===0||Kt){var h=km;km<<=1,(km&3932160)===0&&(km=262144),Co=h}else Co=536870912;return h=po.current,h!==null&&(h.flags|=32),Co}function Br(h,f,m){(h===Ri&&(bi===2||bi===9)||h.cancelPendingCommit!==null)&&(sp(h,0),cu(h,qt,Co,!1)),dc(h,m),((fi&2)===0||h!==Ri)&&(h===Ri&&((fi&2)===0&&(Gd|=m),_n===4&&cu(h,qt,Co,!1)),cl(h))}function LB(h,f,m){if((fi&6)!==0)throw Error(i(327));var b=!m&&(f&127)===0&&(f&h.expiredLanes)===0||Ji(h,f),y=b?dne(h,f):MN(h,f,!0),L=b;do{if(y===0){tp&&!b&&cu(h,f,0,!1);break}else{if(m=h.current.alternate,L&&!hne(m)){y=MN(h,f,!1),L=!1;continue}if(y===2){if(L=f,h.errorRecoveryDisabledLanes&L)var I=0;else I=h.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){f=I;e:{var P=h;y=Tb;var X=P.current.memoizedState.isDehydrated;if(X&&(sp(P,I).flags|=256),I=MN(P,I,!1),I!==2){if(EN&&!X){P.errorRecoveryDisabledLanes|=L,Gd|=L,y=4;break e}L=Fr,Fr=y,L!==null&&(Fr===null?Fr=L:Fr.push.apply(Fr,L))}y=I}if(L=!1,y!==2)continue}}if(y===1){sp(h,0),cu(h,f,0,!0);break}e:{switch(b=h,L=y,L){case 0:case 1:throw Error(i(345));case 4:if((f&4194048)!==f)break;case 6:cu(b,f,Co,!ru);break e;case 2:Fr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((f&62914560)===f&&(y=Zy+300-ts(),10<y)){if(cu(b,f,Co,!ru),Em(b,0,!0)!==0)break e;Ic=f,b.timeoutHandle=iV(kB.bind(null,b,m,Fr,eS,TN,f,Co,Gd,ip,ru,L,"Throttled",-0,0),y);break e}kB(b,m,Fr,eS,TN,f,Co,Gd,ip,ru,L,null,-0,0)}}break}while(!0);cl(h)}function kB(h,f,m,b,y,L,I,P,X,ue,be,ye,de,fe){if(h.timeoutHandle=-1,ye=f.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pc},bB(f,L,ye);var $e=(L&62914560)===L?Zy-ts():(L&4194048)===L?yB-ts():0;if($e=Kne(ye,$e),$e!==null){Ic=L,h.cancelPendingCommit=$e(MB.bind(null,h,f,L,m,b,y,I,P,X,be,ye,null,de,fe)),cu(h,L,I,!ue);return}}MB(h,f,L,m,b,y,I,P,X)}function hne(h){for(var f=h;;){var m=f.tag;if((m===0||m===11||m===15)&&f.flags&16384&&(m=f.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var y=m[b],L=y.getSnapshot;y=y.value;try{if(!go(L(),y))return!1}catch{return!1}}if(m=f.child,f.subtreeFlags&16384&&m!==null)m.return=f,f=m;else{if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function cu(h,f,m,b){f&=~DN,f&=~Gd,h.suspendedLanes|=f,h.pingedLanes&=~f,b&&(h.warmLanes|=f),b=h.expirationTimes;for(var y=f;0<y;){var L=31-Ls(y),I=1<<L;b[L]=-1,y&=~I}m!==0&&X1(h,m,f)}function tS(){return(fi&6)===0?(Ib(0),!1):!0}function AN(){if(Vt!==null){if(bi===0)var h=Vt.return;else h=Vt,wc=Bd=null,YT(h),Km=null,fb=0,h=Vt;for(;h!==null;)nB(h.alternate,h),h=h.return;Vt=null}}function sp(h,f){var m=h.timeoutHandle;m!==-1&&(h.timeoutHandle=-1,Nne(m)),m=h.cancelPendingCommit,m!==null&&(h.cancelPendingCommit=null,m()),Ic=0,AN(),Ri=h,Vt=m=bc(h.current,null),qt=f,bi=0,bo=null,ru=!1,tp=Ji(h,f),EN=!1,ip=Co=DN=Gd=ou=_n=0,Fr=Tb=null,TN=!1,(f&8)!==0&&(f|=f&32);var b=h.entangledLanes;if(b!==0)for(h=h.entanglements,b&=f;0<b;){var y=31-Ls(b),L=1<<y;f|=h[y],b&=~L}return Nc=f,yy(),m}function EB(h,f){xt=null,U.H=vb,f===Gm||f===Ny?(f=U8(),bi=3):f===FT?(f=U8(),bi=4):bi=f===uN?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,bo=f,Vt===null&&(_n=1,jy(h,qo(f,h.current)))}function DB(){var h=po.current;return h===null?!0:(qt&4194048)===qt?Qo===null:(qt&62914560)===qt||(qt&536870912)!==0?h===Qo:!1}function TB(){var h=U.H;return U.H=vb,h===null?vb:h}function NB(){var h=U.A;return U.A=lne,h}function iS(){_n=4,ru||(qt&4194048)!==qt&&po.current!==null||(tp=!0),(ou&134217727)===0&&(Gd&134217727)===0||Ri===null||cu(Ri,qt,Co,!1)}function MN(h,f,m){var b=fi;fi|=2;var y=TB(),L=NB();(Ri!==h||qt!==f)&&(eS=null,sp(h,f)),f=!1;var I=_n;e:do try{if(bi!==0&&Vt!==null){var P=Vt,X=bo;switch(bi){case 8:AN(),I=6;break e;case 3:case 2:case 9:case 6:po.current===null&&(f=!0);var ue=bi;if(bi=0,bo=null,rp(h,P,X,ue),m&&tp){I=0;break e}break;default:ue=bi,bi=0,bo=null,rp(h,P,X,ue)}}une(),I=_n;break}catch(be){EB(h,be)}while(!0);return f&&h.shellSuspendCounter++,wc=Bd=null,fi=b,U.H=y,U.A=L,Vt===null&&(Ri=null,qt=0,yy()),I}function une(){for(;Vt!==null;)IB(Vt)}function dne(h,f){var m=fi;fi|=2;var b=TB(),y=NB();Ri!==h||qt!==f?(eS=null,Jy=ts()+500,sp(h,f)):tp=Ji(h,f);e:do try{if(bi!==0&&Vt!==null){f=Vt;var L=bo;t:switch(bi){case 1:bi=0,bo=null,rp(h,f,L,1);break;case 2:case 9:if(H8(L)){bi=0,bo=null,RB(f);break}f=function(){bi!==2&&bi!==9||Ri!==h||(bi=7),cl(h)},L.then(f,f);break e;case 3:bi=7;break e;case 4:bi=5;break e;case 7:H8(L)?(bi=0,bo=null,RB(f)):(bi=0,bo=null,rp(h,f,L,7));break;case 5:var I=null;switch(Vt.tag){case 26:I=Vt.memoizedState;case 5:case 27:var P=Vt;if(I?_V(I):P.stateNode.complete){bi=0,bo=null;var X=P.sibling;if(X!==null)Vt=X;else{var ue=P.return;ue!==null?(Vt=ue,nS(ue)):Vt=null}break t}}bi=0,bo=null,rp(h,f,L,5);break;case 6:bi=0,bo=null,rp(h,f,L,6);break;case 8:AN(),_n=6;break e;default:throw Error(i(462))}}fne();break}catch(be){EB(h,be)}while(!0);return wc=Bd=null,U.H=b,U.A=y,fi=m,Vt!==null?0:(Ri=null,qt=0,yy(),_n)}function fne(){for(;Vt!==null&&!ZD();)IB(Vt)}function IB(h){var f=tB(h.alternate,h,Nc);h.memoizedProps=h.pendingProps,f===null?nS(h):Vt=f}function RB(h){var f=h,m=f.alternate;switch(f.tag){case 15:case 0:f=YF(m,f,f.pendingProps,f.type,void 0,qt);break;case 11:f=YF(m,f,f.pendingProps,f.type.render,f.ref,qt);break;case 5:YT(f);default:nB(m,f),f=Vt=N8(f,Nc),f=tB(m,f,Nc)}h.memoizedProps=h.pendingProps,f===null?nS(h):Vt=f}function rp(h,f,m,b){wc=Bd=null,YT(f),Km=null,fb=0;var y=f.return;try{if(tne(h,y,f,m,qt)){_n=1,jy(h,qo(m,h.current)),Vt=null;return}}catch(L){if(y!==null)throw Vt=y,L;_n=1,jy(h,qo(m,h.current)),Vt=null;return}f.flags&32768?(Kt||b===1?h=!0:tp||(qt&536870912)!==0?h=!1:(ru=h=!0,(b===2||b===9||b===3||b===6)&&(b=po.current,b!==null&&b.tag===13&&(b.flags|=16384))),AB(f,h)):nS(f)}function nS(h){var f=h;do{if((f.flags&32768)!==0){AB(f,ru);return}h=f.return;var m=sne(f.alternate,f,Nc);if(m!==null){Vt=m;return}if(f=f.sibling,f!==null){Vt=f;return}Vt=f=h}while(f!==null);_n===0&&(_n=5)}function AB(h,f){do{var m=rne(h.alternate,h);if(m!==null){m.flags&=32767,Vt=m;return}if(m=h.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!f&&(h=h.sibling,h!==null)){Vt=h;return}Vt=h=m}while(h!==null);_n=6,Vt=null}function MB(h,f,m,b,y,L,I,P,X){h.cancelPendingCommit=null;do sS();while(is!==0);if((fi&6)!==0)throw Error(i(327));if(f!==null){if(f===h.current)throw Error(i(177));if(L=f.lanes|f.childLanes,L|=yT,ay(h,m,L,I,P,X),h===Ri&&(Vt=Ri=null,qt=0),np=f,lu=h,Ic=m,NN=L,IN=y,SB=b,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,_ne(Id,function(){return VB(),null})):(h.callbackNode=null,h.callbackPriority=0),b=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||b){b=U.T,U.T=null,y=G.p,G.p=2,I=fi,fi|=4;try{one(h,f,m)}finally{fi=I,G.p=y,U.T=b}}is=1,OB(),PB(),FB()}}function OB(){if(is===1){is=0;var h=lu,f=np,m=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||m){m=U.T,U.T=null;var b=G.p;G.p=2;var y=fi;fi|=4;try{mB(f,h);var L=qN,I=v8(h.containerInfo),P=L.focusedElem,X=L.selectionRange;if(I!==P&&P&&P.ownerDocument&&w8(P.ownerDocument.documentElement,P)){if(X!==null&&_T(P)){var ue=X.start,be=X.end;if(be===void 0&&(be=ue),"selectionStart"in P)P.selectionStart=ue,P.selectionEnd=Math.min(be,P.value.length);else{var ye=P.ownerDocument||document,de=ye&&ye.defaultView||window;if(de.getSelection){var fe=de.getSelection(),$e=P.textContent.length,ot=Math.min(X.start,$e),ki=X.end===void 0?ot:Math.min(X.end,$e);!fe.extend&&ot>ki&&(I=ki,ki=ot,ot=I);var se=C8(P,ot),ee=C8(P,ki);if(se&&ee&&(fe.rangeCount!==1||fe.anchorNode!==se.node||fe.anchorOffset!==se.offset||fe.focusNode!==ee.node||fe.focusOffset!==ee.offset)){var he=ye.createRange();he.setStart(se.node,se.offset),fe.removeAllRanges(),ot>ki?(fe.addRange(he),fe.extend(ee.node,ee.offset)):(he.setEnd(ee.node,ee.offset),fe.addRange(he))}}}}for(ye=[],fe=P;fe=fe.parentNode;)fe.nodeType===1&&ye.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<ye.length;P++){var we=ye[P];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}pS=!!$N,qN=$N=null}finally{fi=y,G.p=b,U.T=m}}h.current=f,is=2}}function PB(){if(is===2){is=0;var h=lu,f=np,m=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||m){m=U.T,U.T=null;var b=G.p;G.p=2;var y=fi;fi|=4;try{hB(h,f.alternate,f)}finally{fi=y,G.p=b,U.T=m}}is=3}}function FB(){if(is===4||is===3){is=0,K1();var h=lu,f=np,m=Ic,b=SB;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?is=5:(is=0,np=lu=null,BB(h,h.pendingLanes));var y=h.pendingLanes;if(y===0&&(au=null),Tm(m),f=f.stateNode,on&&typeof on.onCommitFiberRoot=="function")try{on.onCommitFiberRoot(sl,f,void 0,(f.current.flags&128)===128)}catch{}if(b!==null){f=U.T,y=G.p,G.p=2,U.T=null;try{for(var L=h.onRecoverableError,I=0;I<b.length;I++){var P=b[I];L(P.value,{componentStack:P.stack})}}finally{U.T=f,G.p=y}}(Ic&3)!==0&&sS(),cl(h),y=h.pendingLanes,(m&261930)!==0&&(y&42)!==0?h===RN?Nb++:(Nb=0,RN=h):Nb=0,Ib(0)}}function BB(h,f){(h.pooledCacheLanes&=f)===0&&(f=h.pooledCache,f!=null&&(h.pooledCache=null,ub(f)))}function sS(){return OB(),PB(),FB(),VB()}function VB(){if(is!==5)return!1;var h=lu,f=NN;NN=0;var m=Tm(Ic),b=U.T,y=G.p;try{G.p=32>m?32:m,U.T=null,m=IN,IN=null;var L=lu,I=Ic;if(is=0,np=lu=null,Ic=0,(fi&6)!==0)throw Error(i(331));var P=fi;if(fi|=4,wB(L.current),_B(L,L.current,I,m),fi=P,Ib(0,!1),on&&typeof on.onPostCommitFiberRoot=="function")try{on.onPostCommitFiberRoot(sl,L)}catch{}return!0}finally{G.p=y,U.T=b,BB(h,f)}}function WB(h,f,m){f=qo(m,f),f=hN(h.stateNode,f,2),h=tu(h,f,2),h!==null&&(dc(h,2),cl(h))}function Ci(h,f,m){if(h.tag===3)WB(h,h,m);else for(;f!==null;){if(f.tag===3){WB(f,h,m);break}else if(f.tag===1){var b=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(au===null||!au.has(b))){h=qo(m,h),m=HF(2),b=tu(f,m,2),b!==null&&(zF(m,b,f,h),dc(b,2),cl(b));break}}f=f.return}}function ON(h,f,m){var b=h.pingCache;if(b===null){b=h.pingCache=new cne;var y=new Set;b.set(f,y)}else y=b.get(f),y===void 0&&(y=new Set,b.set(f,y));y.has(m)||(EN=!0,y.add(m),h=gne.bind(null,h,f,m),f.then(h,h))}function gne(h,f,m){var b=h.pingCache;b!==null&&b.delete(f),h.pingedLanes|=h.suspendedLanes&m,h.warmLanes&=~m,Ri===h&&(qt&m)===m&&(_n===4||_n===3&&(qt&62914560)===qt&&300>ts()-Zy?(fi&2)===0&&sp(h,0):DN|=m,ip===qt&&(ip=0)),cl(h)}function HB(h,f){f===0&&(f=oy()),h=Od(h,f),h!==null&&(dc(h,f),cl(h))}function mne(h){var f=h.memoizedState,m=0;f!==null&&(m=f.retryLane),HB(h,m)}function pne(h,f){var m=0;switch(h.tag){case 31:case 13:var b=h.stateNode,y=h.memoizedState;y!==null&&(m=y.retryLane);break;case 19:b=h.stateNode;break;case 22:b=h.stateNode._retryCache;break;default:throw Error(i(314))}b!==null&&b.delete(f),HB(h,m)}function _ne(h,f){return vm(h,f)}var rS=null,op=null,PN=!1,oS=!1,FN=!1,hu=0;function cl(h){h!==op&&h.next===null&&(op===null?rS=op=h:op=op.next=h),oS=!0,PN||(PN=!0,Cne())}function Ib(h,f){if(!FN&&oS){FN=!0;do for(var m=!1,b=rS;b!==null;){if(h!==0){var y=b.pendingLanes;if(y===0)var L=0;else{var I=b.suspendedLanes,P=b.pingedLanes;L=(1<<31-Ls(42|h)+1)-1,L&=y&~(I&~P),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(m=!0,$B(b,L))}else L=qt,L=Em(b,b===Ri?L:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(L&3)===0||Ji(b,L)||(m=!0,$B(b,L));b=b.next}while(m);FN=!1}}function bne(){zB()}function zB(){oS=PN=!1;var h=0;hu!==0&&Tne()&&(h=hu);for(var f=ts(),m=null,b=rS;b!==null;){var y=b.next,L=UB(b,f);L===0?(b.next=null,m===null?rS=y:m.next=y,y===null&&(op=m)):(m=b,(h!==0||(L&3)!==0)&&(oS=!0)),b=y}is!==0&&is!==5||Ib(h),hu!==0&&(hu=0)}function UB(h,f){for(var m=h.suspendedLanes,b=h.pingedLanes,y=h.expirationTimes,L=h.pendingLanes&-62914561;0<L;){var I=31-Ls(L),P=1<<I,X=y[I];X===-1?((P&m)===0||(P&b)!==0)&&(y[I]=Gh(P,f)):X<=f&&(h.expiredLanes|=P),L&=~P}if(f=Ri,m=qt,m=Em(h,h===f?m:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),b=h.callbackNode,m===0||h===f&&(bi===2||bi===9)||h.cancelPendingCommit!==null)return b!==null&&b!==null&&ym(b),h.callbackNode=null,h.callbackPriority=0;if((m&3)===0||Ji(h,m)){if(f=m&-m,f===h.callbackPriority)return f;switch(b!==null&&ym(b),Tm(m)){case 2:case 8:m=Y1;break;case 32:m=Id;break;case 268435456:m=Sm;break;default:m=Id}return b=jB.bind(null,h),m=vm(m,b),h.callbackPriority=f,h.callbackNode=m,f}return b!==null&&b!==null&&ym(b),h.callbackPriority=2,h.callbackNode=null,2}function jB(h,f){if(is!==0&&is!==5)return h.callbackNode=null,h.callbackPriority=0,null;var m=h.callbackNode;if(sS()&&h.callbackNode!==m)return null;var b=qt;return b=Em(h,h===Ri?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),b===0?null:(LB(h,b,f),UB(h,ts()),h.callbackNode!=null&&h.callbackNode===m?jB.bind(null,h):null)}function $B(h,f){if(sS())return null;LB(h,f,!0)}function Cne(){Ine(function(){(fi&6)!==0?vm(cc,bne):zB()})}function BN(){if(hu===0){var h=$m;h===0&&(h=hc,hc<<=1,(hc&261888)===0&&(hc=256)),hu=h}return hu}function qB(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:gy(""+h)}function GB(h,f){var m=f.ownerDocument.createElement("input");return m.name=f.name,m.value=f.value,h.id&&m.setAttribute("form",h.id),f.parentNode.insertBefore(m,f),h=new FormData(h),m.parentNode.removeChild(m),h}function wne(h,f,m,b,y){if(f==="submit"&&m&&m.stateNode===y){var L=qB((y[ks]||null).action),I=b.submitter;I&&(f=(f=I[ks]||null)?qB(f.formAction):I.getAttribute("formAction"),f!==null&&(L=f,I=null));var P=new by("action","action",null,b,y);h.push({event:P,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(hu!==0){var X=I?GB(y,I):new FormData(y);sN(m,{pending:!0,data:X,method:y.method,action:L},null,X)}}else typeof L=="function"&&(P.preventDefault(),X=I?GB(y,I):new FormData(y),sN(m,{pending:!0,data:X,method:y.method,action:L},L,X))},currentTarget:y}]})}}for(var VN=0;VN<vT.length;VN++){var WN=vT[VN],vne=WN.toLowerCase(),yne=WN[0].toUpperCase()+WN.slice(1);ya(vne,"on"+yne)}ya(x8,"onAnimationEnd"),ya(L8,"onAnimationIteration"),ya(k8,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(Bie,"onTransitionRun"),ya(Vie,"onTransitionStart"),ya(Wie,"onTransitionCancel"),ya(E8,"onTransitionEnd"),en("onMouseEnter",["mouseout","mouseover"]),en("onMouseLeave",["mouseout","mouseover"]),en("onPointerEnter",["pointerout","pointerover"]),en("onPointerLeave",["pointerout","pointerover"]),va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),va("onBeforeInput",["compositionend","keypress","textInput","paste"]),va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sne=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rb));function KB(h,f){f=(f&4)!==0;for(var m=0;m<h.length;m++){var b=h[m],y=b.event;b=b.listeners;e:{var L=void 0;if(f)for(var I=b.length-1;0<=I;I--){var P=b[I],X=P.instance,ue=P.currentTarget;if(P=P.listener,X!==L&&y.isPropagationStopped())break e;L=P,y.currentTarget=ue;try{L(y)}catch(be){vy(be)}y.currentTarget=null,L=X}else for(I=0;I<b.length;I++){if(P=b[I],X=P.instance,ue=P.currentTarget,P=P.listener,X!==L&&y.isPropagationStopped())break e;L=P,y.currentTarget=ue;try{L(y)}catch(be){vy(be)}y.currentTarget=null,L=X}}}}function Wt(h,f){var m=f[Im];m===void 0&&(m=f[Im]=new Set);var b=h+"__bubble";m.has(b)||(YB(f,h,2,!1),m.add(b))}function HN(h,f,m){var b=0;f&&(b|=4),YB(m,h,b,f)}var aS="_reactListening"+Math.random().toString(36).slice(2);function zN(h){if(!h[aS]){h[aS]=!0,zo.forEach(function(m){m!=="selectionchange"&&(Sne.has(m)||HN(m,!1,h),HN(m,!0,h))});var f=h.nodeType===9?h:h.ownerDocument;f===null||f[aS]||(f[aS]=!0,HN("selectionchange",!1,f))}}function YB(h,f,m,b){switch(xV(f)){case 2:var y=Xne;break;case 8:y=Zne;break;default:y=nI}m=y.bind(null,f,m,h),y=void 0,!lT||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(y=!0),b?y!==void 0?h.addEventListener(f,m,{capture:!0,passive:y}):h.addEventListener(f,m,!0):y!==void 0?h.addEventListener(f,m,{passive:y}):h.addEventListener(f,m,!1)}function UN(h,f,m,b,y){var L=b;if((f&1)===0&&(f&2)===0&&b!==null)e:for(;;){if(b===null)return;var I=b.tag;if(I===3||I===4){var P=b.stateNode.containerInfo;if(P===y)break;if(I===4)for(I=b.return;I!==null;){var X=I.tag;if((X===3||X===4)&&I.stateNode.containerInfo===y)return;I=I.return}for(;P!==null;){if(I=ze(P),I===null)return;if(X=I.tag,X===5||X===6||X===26||X===27){b=L=I;continue e}P=P.parentNode}}b=b.return}e8(function(){var ue=L,be=oT(m),ye=[];e:{var de=D8.get(h);if(de!==void 0){var fe=by,$e=h;switch(h){case"keypress":if(py(m)===0)break e;case"keydown":case"keyup":fe=pie;break;case"focusin":$e="focus",fe=dT;break;case"focusout":$e="blur",fe=dT;break;case"beforeblur":case"afterblur":fe=dT;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=n8;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=sie;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=Cie;break;case x8:case L8:case k8:fe=aie;break;case E8:fe=vie;break;case"scroll":case"scrollend":fe=iie;break;case"wheel":fe=Sie;break;case"copy":case"cut":case"paste":fe=cie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=r8;break;case"toggle":case"beforetoggle":fe=Lie}var ot=(f&4)!==0,ki=!ot&&(h==="scroll"||h==="scrollend"),se=ot?de!==null?de+"Capture":null:de;ot=[];for(var ee=ue,he;ee!==null;){var we=ee;if(he=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||he===null||se===null||(we=eb(ee,se),we!=null&&ot.push(Ab(ee,we,he))),ki)break;ee=ee.return}0<ot.length&&(de=new fe(de,$e,null,m,be),ye.push({event:de,listeners:ot}))}}if((f&7)===0){e:{if(de=h==="mouseover"||h==="pointerover",fe=h==="mouseout"||h==="pointerout",de&&m!==rT&&($e=m.relatedTarget||m.fromElement)&&(ze($e)||$e[fc]))break e;if((fe||de)&&(de=be.window===be?be:(de=be.ownerDocument)?de.defaultView||de.parentWindow:window,fe?($e=m.relatedTarget||m.toElement,fe=ue,$e=$e?ze($e):null,$e!==null&&(ki=r($e),ot=$e.tag,$e!==ki||ot!==5&&ot!==27&&ot!==6)&&($e=null)):(fe=null,$e=ue),fe!==$e)){if(ot=n8,we="onMouseLeave",se="onMouseEnter",ee="mouse",(h==="pointerout"||h==="pointerover")&&(ot=r8,we="onPointerLeave",se="onPointerEnter",ee="pointer"),ki=fe==null?de:mn(fe),he=$e==null?de:mn($e),de=new ot(we,ee+"leave",fe,m,be),de.target=ki,de.relatedTarget=he,we=null,ze(be)===ue&&(ot=new ot(se,ee+"enter",$e,m,be),ot.target=he,ot.relatedTarget=ki,we=ot),ki=we,fe&&$e)t:{for(ot=xne,se=fe,ee=$e,he=0,we=se;we;we=ot(we))he++;we=0;for(var et=ee;et;et=ot(et))we++;for(;0<he-we;)se=ot(se),he--;for(;0<we-he;)ee=ot(ee),we--;for(;he--;){if(se===ee||ee!==null&&se===ee.alternate){ot=se;break t}se=ot(se),ee=ot(ee)}ot=null}else ot=null;fe!==null&&QB(ye,de,fe,ot,!1),$e!==null&&ki!==null&&QB(ye,ki,$e,ot,!0)}}e:{if(de=ue?mn(ue):window,fe=de.nodeName&&de.nodeName.toLowerCase(),fe==="select"||fe==="input"&&de.type==="file")var li=f8;else if(u8(de))if(g8)li=Oie;else{li=Aie;var Ye=Rie}else fe=de.nodeName,!fe||fe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ue&&sT(ue.elementType)&&(li=f8):li=Mie;if(li&&(li=li(h,ue))){d8(ye,li,m,be);break e}Ye&&Ye(h,de,ue),h==="focusout"&&ue&&de.type==="number"&&ue.memoizedProps.value!=null&&nT(de,"number",de.value)}switch(Ye=ue?mn(ue):window,h){case"focusin":(u8(Ye)||Ye.contentEditable==="true")&&(Fm=Ye,bT=ue,lb=null);break;case"focusout":lb=bT=Fm=null;break;case"mousedown":CT=!0;break;case"contextmenu":case"mouseup":case"dragend":CT=!1,y8(ye,m,be);break;case"selectionchange":if(Fie)break;case"keydown":case"keyup":y8(ye,m,be)}var Tt;if(gT)e:{switch(h){case"compositionstart":var Gt="onCompositionStart";break e;case"compositionend":Gt="onCompositionEnd";break e;case"compositionupdate":Gt="onCompositionUpdate";break e}Gt=void 0}else Pm?c8(h,m)&&(Gt="onCompositionEnd"):h==="keydown"&&m.keyCode===229&&(Gt="onCompositionStart");Gt&&(o8&&m.locale!=="ko"&&(Pm||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&Pm&&(Tt=t8()):(Kh=be,cT="value"in Kh?Kh.value:Kh.textContent,Pm=!0)),Ye=lS(ue,Gt),0<Ye.length&&(Gt=new s8(Gt,h,null,m,be),ye.push({event:Gt,listeners:Ye}),Tt?Gt.data=Tt:(Tt=h8(m),Tt!==null&&(Gt.data=Tt)))),(Tt=Eie?Die(h,m):Tie(h,m))&&(Gt=lS(ue,"onBeforeInput"),0<Gt.length&&(Ye=new s8("onBeforeInput","beforeinput",null,m,be),ye.push({event:Ye,listeners:Gt}),Ye.data=Tt)),wne(ye,h,ue,m,be)}KB(ye,f)})}function Ab(h,f,m){return{instance:h,listener:f,currentTarget:m}}function lS(h,f){for(var m=f+"Capture",b=[];h!==null;){var y=h,L=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||L===null||(y=eb(h,m),y!=null&&b.unshift(Ab(h,y,L)),y=eb(h,f),y!=null&&b.push(Ab(h,y,L))),h.tag===3)return b;h=h.return}return[]}function xne(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function QB(h,f,m,b,y){for(var L=f._reactName,I=[];m!==null&&m!==b;){var P=m,X=P.alternate,ue=P.stateNode;if(P=P.tag,X!==null&&X===b)break;P!==5&&P!==26&&P!==27||ue===null||(X=ue,y?(ue=eb(m,L),ue!=null&&I.unshift(Ab(m,ue,X))):y||(ue=eb(m,L),ue!=null&&I.push(Ab(m,ue,X)))),m=m.return}I.length!==0&&h.push({event:f,listeners:I})}var Lne=/\r\n?/g,kne=/\u0000|\uFFFD/g;function XB(h){return(typeof h=="string"?h:""+h).replace(Lne,`
`).replace(kne,"")}function ZB(h,f){return f=XB(f),XB(h)===f}function Li(h,f,m,b,y,L){switch(m){case"children":typeof b=="string"?f==="body"||f==="textarea"&&b===""||Am(h,b):(typeof b=="number"||typeof b=="bigint")&&f!=="body"&&Am(h,""+b);break;case"className":dy(h,"class",b);break;case"tabIndex":dy(h,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":dy(h,m,b);break;case"style":Z9(h,b,L);break;case"data":if(f!=="object"){dy(h,"data",b);break}case"src":case"href":if(b===""&&(f!=="a"||m!=="href")){h.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){h.removeAttribute(m);break}b=gy(""+b),h.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){h.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(m==="formAction"?(f!=="input"&&Li(h,f,"name",y.name,y,null),Li(h,f,"formEncType",y.formEncType,y,null),Li(h,f,"formMethod",y.formMethod,y,null),Li(h,f,"formTarget",y.formTarget,y,null)):(Li(h,f,"encType",y.encType,y,null),Li(h,f,"method",y.method,y,null),Li(h,f,"target",y.target,y,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){h.removeAttribute(m);break}b=gy(""+b),h.setAttribute(m,b);break;case"onClick":b!=null&&(h.onclick=pc);break;case"onScroll":b!=null&&Wt("scroll",h);break;case"onScrollEnd":b!=null&&Wt("scrollend",h);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(i(61));if(m=b.__html,m!=null){if(y.children!=null)throw Error(i(60));h.innerHTML=m}}break;case"multiple":h.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":h.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){h.removeAttribute("xlink:href");break}m=gy(""+b),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?h.setAttribute(m,""+b):h.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?h.setAttribute(m,""):h.removeAttribute(m);break;case"capture":case"download":b===!0?h.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?h.setAttribute(m,b):h.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?h.setAttribute(m,b):h.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?h.removeAttribute(m):h.setAttribute(m,b);break;case"popover":Wt("beforetoggle",h),Wt("toggle",h),uy(h,"popover",b);break;case"xlinkActuate":mc(h,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":mc(h,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":mc(h,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":mc(h,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":mc(h,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":mc(h,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":mc(h,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":mc(h,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":mc(h,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":uy(h,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=eie.get(m)||m,uy(h,m,b))}}function jN(h,f,m,b,y,L){switch(m){case"style":Z9(h,b,L);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(i(61));if(m=b.__html,m!=null){if(y.children!=null)throw Error(i(60));h.innerHTML=m}}break;case"children":typeof b=="string"?Am(h,b):(typeof b=="number"||typeof b=="bigint")&&Am(h,""+b);break;case"onScroll":b!=null&&Wt("scroll",h);break;case"onScrollEnd":b!=null&&Wt("scrollend",h);break;case"onClick":b!=null&&(h.onclick=pc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gc.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(y=m.endsWith("Capture"),f=m.slice(2,y?m.length-7:void 0),L=h[ks]||null,L=L!=null?L[m]:null,typeof L=="function"&&h.removeEventListener(f,L,y),typeof b=="function")){typeof L!="function"&&L!==null&&(m in h?h[m]=null:h.hasAttribute(m)&&h.removeAttribute(m)),h.addEventListener(f,b,y);break e}m in h?h[m]=b:b===!0?h.setAttribute(m,""):uy(h,m,b)}}}function Ns(h,f,m){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wt("error",h),Wt("load",h);var b=!1,y=!1,L;for(L in m)if(m.hasOwnProperty(L)){var I=m[L];if(I!=null)switch(L){case"src":b=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,f));default:Li(h,f,L,I,m,null)}}y&&Li(h,f,"srcSet",m.srcSet,m,null),b&&Li(h,f,"src",m.src,m,null);return;case"input":Wt("invalid",h);var P=L=I=y=null,X=null,ue=null;for(b in m)if(m.hasOwnProperty(b)){var be=m[b];if(be!=null)switch(b){case"name":y=be;break;case"type":I=be;break;case"checked":X=be;break;case"defaultChecked":ue=be;break;case"value":L=be;break;case"defaultValue":P=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(i(137,f));break;default:Li(h,f,b,be,m,null)}}K9(h,L,P,X,ue,I,y,!1);return;case"select":Wt("invalid",h),b=I=L=null;for(y in m)if(m.hasOwnProperty(y)&&(P=m[y],P!=null))switch(y){case"value":L=P;break;case"defaultValue":I=P;break;case"multiple":b=P;default:Li(h,f,y,P,m,null)}f=L,m=I,h.multiple=!!b,f!=null?Rm(h,!!b,f,!1):m!=null&&Rm(h,!!b,m,!0);return;case"textarea":Wt("invalid",h),L=y=b=null;for(I in m)if(m.hasOwnProperty(I)&&(P=m[I],P!=null))switch(I){case"value":b=P;break;case"defaultValue":y=P;break;case"children":L=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(i(91));break;default:Li(h,f,I,P,m,null)}Q9(h,b,y,L);return;case"option":for(X in m)if(m.hasOwnProperty(X)&&(b=m[X],b!=null))switch(X){case"selected":h.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:Li(h,f,X,b,m,null)}return;case"dialog":Wt("beforetoggle",h),Wt("toggle",h),Wt("cancel",h),Wt("close",h);break;case"iframe":case"object":Wt("load",h);break;case"video":case"audio":for(b=0;b<Rb.length;b++)Wt(Rb[b],h);break;case"image":Wt("error",h),Wt("load",h);break;case"details":Wt("toggle",h);break;case"embed":case"source":case"link":Wt("error",h),Wt("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in m)if(m.hasOwnProperty(ue)&&(b=m[ue],b!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,f));default:Li(h,f,ue,b,m,null)}return;default:if(sT(f)){for(be in m)m.hasOwnProperty(be)&&(b=m[be],b!==void 0&&jN(h,f,be,b,m,void 0));return}}for(P in m)m.hasOwnProperty(P)&&(b=m[P],b!=null&&Li(h,f,P,b,m,null))}function Ene(h,f,m,b){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,L=null,I=null,P=null,X=null,ue=null,be=null;for(fe in m){var ye=m[fe];if(m.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":X=ye;default:b.hasOwnProperty(fe)||Li(h,f,fe,null,b,ye)}}for(var de in b){var fe=b[de];if(ye=m[de],b.hasOwnProperty(de)&&(fe!=null||ye!=null))switch(de){case"type":L=fe;break;case"name":y=fe;break;case"checked":ue=fe;break;case"defaultChecked":be=fe;break;case"value":I=fe;break;case"defaultValue":P=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,f));break;default:fe!==ye&&Li(h,f,de,fe,b,ye)}}iT(h,I,P,X,ue,be,L,y);return;case"select":fe=I=P=de=null;for(L in m)if(X=m[L],m.hasOwnProperty(L)&&X!=null)switch(L){case"value":break;case"multiple":fe=X;default:b.hasOwnProperty(L)||Li(h,f,L,null,b,X)}for(y in b)if(L=b[y],X=m[y],b.hasOwnProperty(y)&&(L!=null||X!=null))switch(y){case"value":de=L;break;case"defaultValue":P=L;break;case"multiple":I=L;default:L!==X&&Li(h,f,y,L,b,X)}f=P,m=I,b=fe,de!=null?Rm(h,!!m,de,!1):!!b!=!!m&&(f!=null?Rm(h,!!m,f,!0):Rm(h,!!m,m?[]:"",!1));return;case"textarea":fe=de=null;for(P in m)if(y=m[P],m.hasOwnProperty(P)&&y!=null&&!b.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:Li(h,f,P,null,b,y)}for(I in b)if(y=b[I],L=m[I],b.hasOwnProperty(I)&&(y!=null||L!=null))switch(I){case"value":de=y;break;case"defaultValue":fe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==L&&Li(h,f,I,y,b,L)}Y9(h,de,fe);return;case"option":for(var $e in m)if(de=m[$e],m.hasOwnProperty($e)&&de!=null&&!b.hasOwnProperty($e))switch($e){case"selected":h.selected=!1;break;default:Li(h,f,$e,null,b,de)}for(X in b)if(de=b[X],fe=m[X],b.hasOwnProperty(X)&&de!==fe&&(de!=null||fe!=null))switch(X){case"selected":h.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:Li(h,f,X,de,b,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in m)de=m[ot],m.hasOwnProperty(ot)&&de!=null&&!b.hasOwnProperty(ot)&&Li(h,f,ot,null,b,de);for(ue in b)if(de=b[ue],fe=m[ue],b.hasOwnProperty(ue)&&de!==fe&&(de!=null||fe!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,f));break;default:Li(h,f,ue,de,b,fe)}return;default:if(sT(f)){for(var ki in m)de=m[ki],m.hasOwnProperty(ki)&&de!==void 0&&!b.hasOwnProperty(ki)&&jN(h,f,ki,void 0,b,de);for(be in b)de=b[be],fe=m[be],!b.hasOwnProperty(be)||de===fe||de===void 0&&fe===void 0||jN(h,f,be,de,b,fe);return}}for(var se in m)de=m[se],m.hasOwnProperty(se)&&de!=null&&!b.hasOwnProperty(se)&&Li(h,f,se,null,b,de);for(ye in b)de=b[ye],fe=m[ye],!b.hasOwnProperty(ye)||de===fe||de==null&&fe==null||Li(h,f,ye,de,b,fe)}function JB(h){switch(h){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Dne(){if(typeof performance.getEntriesByType=="function"){for(var h=0,f=0,m=performance.getEntriesByType("resource"),b=0;b<m.length;b++){var y=m[b],L=y.transferSize,I=y.initiatorType,P=y.duration;if(L&&P&&JB(I)){for(I=0,P=y.responseEnd,b+=1;b<m.length;b++){var X=m[b],ue=X.startTime;if(ue>P)break;var be=X.transferSize,ye=X.initiatorType;be&&JB(ye)&&(X=X.responseEnd,I+=be*(X<P?1:(P-ue)/(X-ue)))}if(--b,f+=8*(L+I)/(y.duration/1e3),h++,10<h)break}}if(0<h)return f/h/1e6}return navigator.connection&&(h=navigator.connection.downlink,typeof h=="number")?h:5}var $N=null,qN=null;function cS(h){return h.nodeType===9?h:h.ownerDocument}function eV(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tV(h,f){if(h===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&f==="foreignObject"?0:h}function GN(h,f){return h==="textarea"||h==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var KN=null;function Tne(){var h=window.event;return h&&h.type==="popstate"?h===KN?!1:(KN=h,!0):(KN=null,!1)}var iV=typeof setTimeout=="function"?setTimeout:void 0,Nne=typeof clearTimeout=="function"?clearTimeout:void 0,nV=typeof Promise=="function"?Promise:void 0,Ine=typeof queueMicrotask=="function"?queueMicrotask:typeof nV<"u"?function(h){return nV.resolve(null).then(h).catch(Rne)}:iV;function Rne(h){setTimeout(function(){throw h})}function uu(h){return h==="head"}function sV(h,f){var m=f,b=0;do{var y=m.nextSibling;if(h.removeChild(m),y&&y.nodeType===8)if(m=y.data,m==="/$"||m==="/&"){if(b===0){h.removeChild(y),hp(f);return}b--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")b++;else if(m==="html")Mb(h.ownerDocument.documentElement);else if(m==="head"){m=h.ownerDocument.head,Mb(m);for(var L=m.firstChild;L;){var I=L.nextSibling,P=L.nodeName;L[te]||P==="SCRIPT"||P==="STYLE"||P==="LINK"&&L.rel.toLowerCase()==="stylesheet"||m.removeChild(L),L=I}}else m==="body"&&Mb(h.ownerDocument.body);m=y}while(m);hp(f)}function rV(h,f){var m=h;h=0;do{var b=m.nextSibling;if(m.nodeType===1?f?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(f?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),b&&b.nodeType===8)if(m=b.data,m==="/$"){if(h===0)break;h--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||h++;m=b}while(m)}function YN(h){var f=h.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var m=f;switch(f=f.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":YN(m),Te(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}h.removeChild(m)}}function Ane(h,f,m,b){for(;h.nodeType===1;){var y=m;if(h.nodeName.toLowerCase()!==f.toLowerCase()){if(!b&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(b){if(!h[te])switch(f){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(L=h.getAttribute("rel"),L==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(L!==y.rel||h.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||h.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||h.getAttribute("title")!==(y.title==null?null:y.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(L=h.getAttribute("src"),(L!==(y.src==null?null:y.src)||h.getAttribute("type")!==(y.type==null?null:y.type)||h.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&L&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(f==="input"&&h.type==="hidden"){var L=y.name==null?null:""+y.name;if(y.type==="hidden"&&h.getAttribute("name")===L)return h}else return h;if(h=Xo(h.nextSibling),h===null)break}return null}function Mne(h,f,m){if(f==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!m||(h=Xo(h.nextSibling),h===null))return null;return h}function oV(h,f){for(;h.nodeType!==8;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!f||(h=Xo(h.nextSibling),h===null))return null;return h}function QN(h){return h.data==="$?"||h.data==="$~"}function XN(h){return h.data==="$!"||h.data==="$?"&&h.ownerDocument.readyState!=="loading"}function One(h,f){var m=h.ownerDocument;if(h.data==="$~")h._reactRetry=f;else if(h.data!=="$?"||m.readyState!=="loading")f();else{var b=function(){f(),m.removeEventListener("DOMContentLoaded",b)};m.addEventListener("DOMContentLoaded",b),h._reactRetry=b}}function Xo(h){for(;h!=null;h=h.nextSibling){var f=h.nodeType;if(f===1||f===3)break;if(f===8){if(f=h.data,f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"||f==="F!"||f==="F")break;if(f==="/$"||f==="/&")return null}}return h}var ZN=null;function aV(h){h=h.nextSibling;for(var f=0;h;){if(h.nodeType===8){var m=h.data;if(m==="/$"||m==="/&"){if(f===0)return Xo(h.nextSibling);f--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||f++}h=h.nextSibling}return null}function lV(h){h=h.previousSibling;for(var f=0;h;){if(h.nodeType===8){var m=h.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(f===0)return h;f--}else m!=="/$"&&m!=="/&"||f++}h=h.previousSibling}return null}function cV(h,f,m){switch(f=cS(m),h){case"html":if(h=f.documentElement,!h)throw Error(i(452));return h;case"head":if(h=f.head,!h)throw Error(i(453));return h;case"body":if(h=f.body,!h)throw Error(i(454));return h;default:throw Error(i(451))}}function Mb(h){for(var f=h.attributes;f.length;)h.removeAttributeNode(f[0]);Te(h)}var Zo=new Map,hV=new Set;function hS(h){return typeof h.getRootNode=="function"?h.getRootNode():h.nodeType===9?h:h.ownerDocument}var Rc=G.d;G.d={f:Pne,r:Fne,D:Bne,C:Vne,L:Wne,m:Hne,X:Une,S:zne,M:jne};function Pne(){var h=Rc.f(),f=tS();return h||f}function Fne(h){var f=di(h);f!==null&&f.tag===5&&f.type==="form"?EF(f):Rc.r(h)}var ap=typeof document>"u"?null:document;function uV(h,f,m){var b=ap;if(b&&typeof f=="string"&&f){var y=jo(f);y='link[rel="'+h+'"][href="'+y+'"]',typeof m=="string"&&(y+='[crossorigin="'+m+'"]'),hV.has(y)||(hV.add(y),h={rel:h,crossOrigin:m,href:f},b.querySelector(y)===null&&(f=b.createElement("link"),Ns(f,"link",h),ni(f),b.head.appendChild(f)))}}function Bne(h){Rc.D(h),uV("dns-prefetch",h,null)}function Vne(h,f){Rc.C(h,f),uV("preconnect",h,f)}function Wne(h,f,m){Rc.L(h,f,m);var b=ap;if(b&&h&&f){var y='link[rel="preload"][as="'+jo(f)+'"]';f==="image"&&m&&m.imageSrcSet?(y+='[imagesrcset="'+jo(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(y+='[imagesizes="'+jo(m.imageSizes)+'"]')):y+='[href="'+jo(h)+'"]';var L=y;switch(f){case"style":L=lp(h);break;case"script":L=cp(h)}Zo.has(L)||(h=d({rel:"preload",href:f==="image"&&m&&m.imageSrcSet?void 0:h,as:f},m),Zo.set(L,h),b.querySelector(y)!==null||f==="style"&&b.querySelector(Ob(L))||f==="script"&&b.querySelector(Pb(L))||(f=b.createElement("link"),Ns(f,"link",h),ni(f),b.head.appendChild(f)))}}function Hne(h,f){Rc.m(h,f);var m=ap;if(m&&h){var b=f&&typeof f.as=="string"?f.as:"script",y='link[rel="modulepreload"][as="'+jo(b)+'"][href="'+jo(h)+'"]',L=y;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=cp(h)}if(!Zo.has(L)&&(h=d({rel:"modulepreload",href:h},f),Zo.set(L,h),m.querySelector(y)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(Pb(L)))return}b=m.createElement("link"),Ns(b,"link",h),ni(b),m.head.appendChild(b)}}}function zne(h,f,m){Rc.S(h,f,m);var b=ap;if(b&&h){var y=Ii(b).hoistableStyles,L=lp(h);f=f||"default";var I=y.get(L);if(!I){var P={loading:0,preload:null};if(I=b.querySelector(Ob(L)))P.loading=5;else{h=d({rel:"stylesheet",href:h,"data-precedence":f},m),(m=Zo.get(L))&&JN(h,m);var X=I=b.createElement("link");ni(X),Ns(X,"link",h),X._p=new Promise(function(ue,be){X.onload=ue,X.onerror=be}),X.addEventListener("load",function(){P.loading|=1}),X.addEventListener("error",function(){P.loading|=2}),P.loading|=4,uS(I,f,b)}I={type:"stylesheet",instance:I,count:1,state:P},y.set(L,I)}}}function Une(h,f){Rc.X(h,f);var m=ap;if(m&&h){var b=Ii(m).hoistableScripts,y=cp(h),L=b.get(y);L||(L=m.querySelector(Pb(y)),L||(h=d({src:h,async:!0},f),(f=Zo.get(y))&&eI(h,f),L=m.createElement("script"),ni(L),Ns(L,"link",h),m.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},b.set(y,L))}}function jne(h,f){Rc.M(h,f);var m=ap;if(m&&h){var b=Ii(m).hoistableScripts,y=cp(h),L=b.get(y);L||(L=m.querySelector(Pb(y)),L||(h=d({src:h,async:!0,type:"module"},f),(f=Zo.get(y))&&eI(h,f),L=m.createElement("script"),ni(L),Ns(L,"link",h),m.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},b.set(y,L))}}function dV(h,f,m,b){var y=(y=Oe.current)?hS(y):null;if(!y)throw Error(i(446));switch(h){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(f=lp(m.href),m=Ii(y).hoistableStyles,b=m.get(f),b||(b={type:"style",instance:null,count:0,state:null},m.set(f,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){h=lp(m.href);var L=Ii(y).hoistableStyles,I=L.get(h);if(I||(y=y.ownerDocument||y,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(h,I),(L=y.querySelector(Ob(h)))&&!L._p&&(I.instance=L,I.state.loading=5),Zo.has(h)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Zo.set(h,m),L||$ne(y,h,m,I.state))),f&&b===null)throw Error(i(528,""));return I}if(f&&b!==null)throw Error(i(529,""));return null;case"script":return f=m.async,m=m.src,typeof m=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=cp(m),m=Ii(y).hoistableScripts,b=m.get(f),b||(b={type:"script",instance:null,count:0,state:null},m.set(f,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,h))}}function lp(h){return'href="'+jo(h)+'"'}function Ob(h){return'link[rel="stylesheet"]['+h+"]"}function fV(h){return d({},h,{"data-precedence":h.precedence,precedence:null})}function $ne(h,f,m,b){h.querySelector('link[rel="preload"][as="style"]['+f+"]")?b.loading=1:(f=h.createElement("link"),b.preload=f,f.addEventListener("load",function(){return b.loading|=1}),f.addEventListener("error",function(){return b.loading|=2}),Ns(f,"link",m),ni(f),h.head.appendChild(f))}function cp(h){return'[src="'+jo(h)+'"]'}function Pb(h){return"script[async]"+h}function gV(h,f,m){if(f.count++,f.instance===null)switch(f.type){case"style":var b=h.querySelector('style[data-href~="'+jo(m.href)+'"]');if(b)return f.instance=b,ni(b),b;var y=d({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(h.ownerDocument||h).createElement("style"),ni(b),Ns(b,"style",y),uS(b,m.precedence,h),f.instance=b;case"stylesheet":y=lp(m.href);var L=h.querySelector(Ob(y));if(L)return f.state.loading|=4,f.instance=L,ni(L),L;b=fV(m),(y=Zo.get(y))&&JN(b,y),L=(h.ownerDocument||h).createElement("link"),ni(L);var I=L;return I._p=new Promise(function(P,X){I.onload=P,I.onerror=X}),Ns(L,"link",b),f.state.loading|=4,uS(L,m.precedence,h),f.instance=L;case"script":return L=cp(m.src),(y=h.querySelector(Pb(L)))?(f.instance=y,ni(y),y):(b=m,(y=Zo.get(L))&&(b=d({},m),eI(b,y)),h=h.ownerDocument||h,y=h.createElement("script"),ni(y),Ns(y,"link",b),h.head.appendChild(y),f.instance=y);case"void":return null;default:throw Error(i(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(b=f.instance,f.state.loading|=4,uS(b,m.precedence,h));return f.instance}function uS(h,f,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=b.length?b[b.length-1]:null,L=y,I=0;I<b.length;I++){var P=b[I];if(P.dataset.precedence===f)L=P;else if(L!==y)break}L?L.parentNode.insertBefore(h,L.nextSibling):(f=m.nodeType===9?m.head:m,f.insertBefore(h,f.firstChild))}function JN(h,f){h.crossOrigin==null&&(h.crossOrigin=f.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=f.referrerPolicy),h.title==null&&(h.title=f.title)}function eI(h,f){h.crossOrigin==null&&(h.crossOrigin=f.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=f.referrerPolicy),h.integrity==null&&(h.integrity=f.integrity)}var dS=null;function mV(h,f,m){if(dS===null){var b=new Map,y=dS=new Map;y.set(m,b)}else y=dS,b=y.get(m),b||(b=new Map,y.set(m,b));if(b.has(h))return b;for(b.set(h,null),m=m.getElementsByTagName(h),y=0;y<m.length;y++){var L=m[y];if(!(L[te]||L[Ni]||h==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var I=L.getAttribute(f)||"";I=h+I;var P=b.get(I);P?P.push(L):b.set(I,[L])}}return b}function pV(h,f,m){h=h.ownerDocument||h,h.head.insertBefore(m,f==="title"?h.querySelector("head > title"):null)}function qne(h,f,m){if(m===1||f.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return h=f.disabled,typeof f.precedence=="string"&&h==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function _V(h){return!(h.type==="stylesheet"&&(h.state.loading&3)===0)}function Gne(h,f,m,b){if(m.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var y=lp(b.href),L=f.querySelector(Ob(y));if(L){f=L._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(h.count++,h=fS.bind(h),f.then(h,h)),m.state.loading|=4,m.instance=L,ni(L);return}L=f.ownerDocument||f,b=fV(b),(y=Zo.get(y))&&JN(b,y),L=L.createElement("link"),ni(L);var I=L;I._p=new Promise(function(P,X){I.onload=P,I.onerror=X}),Ns(L,"link",b),m.instance=L}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(m,f),(f=m.state.preload)&&(m.state.loading&3)===0&&(h.count++,m=fS.bind(h),f.addEventListener("load",m),f.addEventListener("error",m))}}var tI=0;function Kne(h,f){return h.stylesheets&&h.count===0&&mS(h,h.stylesheets),0<h.count||0<h.imgCount?function(m){var b=setTimeout(function(){if(h.stylesheets&&mS(h,h.stylesheets),h.unsuspend){var L=h.unsuspend;h.unsuspend=null,L()}},6e4+f);0<h.imgBytes&&tI===0&&(tI=62500*Dne());var y=setTimeout(function(){if(h.waitingForImages=!1,h.count===0&&(h.stylesheets&&mS(h,h.stylesheets),h.unsuspend)){var L=h.unsuspend;h.unsuspend=null,L()}},(h.imgBytes>tI?50:800)+f);return h.unsuspend=m,function(){h.unsuspend=null,clearTimeout(b),clearTimeout(y)}}:null}function fS(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)mS(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var gS=null;function mS(h,f){h.stylesheets=null,h.unsuspend!==null&&(h.count++,gS=new Map,f.forEach(Yne,h),gS=null,fS.call(h))}function Yne(h,f){if(!(f.state.loading&4)){var m=gS.get(h);if(m)var b=m.get(null);else{m=new Map,gS.set(h,m);for(var y=h.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<y.length;L++){var I=y[L];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(m.set(I.dataset.precedence,I),b=I)}b&&m.set(null,b)}y=f.instance,I=y.getAttribute("data-precedence"),L=m.get(I)||b,L===b&&m.set(null,y),m.set(I,y),this.count++,b=fS.bind(this),y.addEventListener("load",b),y.addEventListener("error",b),L?L.parentNode.insertBefore(y,L.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(y,h.firstChild)),f.state.loading|=4}}var Fb={$$typeof:k,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function Qne(h,f,m,b,y,L,I,P,X){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Dm(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dm(0),this.hiddenUpdates=Dm(null),this.identifierPrefix=b,this.onUncaughtError=y,this.onCaughtError=L,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function bV(h,f,m,b,y,L,I,P,X,ue,be,ye){return h=new Qne(h,f,m,I,X,ue,be,ye,P),f=1,L===!0&&(f|=24),L=mo(3,null,null,f),h.current=L,L.stateNode=h,f=MT(),f.refCount++,h.pooledCache=f,f.refCount++,L.memoizedState={element:b,isDehydrated:m,cache:f},BT(L),h}function CV(h){return h?(h=Wm,h):Wm}function wV(h,f,m,b,y,L){y=CV(y),b.context===null?b.context=y:b.pendingContext=y,b=eu(f),b.payload={element:m},L=L===void 0?null:L,L!==null&&(b.callback=L),m=tu(h,b,f),m!==null&&(Br(m,h,f),mb(m,h,f))}function vV(h,f){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var m=h.retryLane;h.retryLane=m!==0&&m<f?m:f}}function iI(h,f){vV(h,f),(h=h.alternate)&&vV(h,f)}function yV(h){if(h.tag===13||h.tag===31){var f=Od(h,67108864);f!==null&&Br(f,h,67108864),iI(h,67108864)}}function SV(h){if(h.tag===13||h.tag===31){var f=wo();f=Ca(f);var m=Od(h,f);m!==null&&Br(m,h,f),iI(h,f)}}var pS=!0;function Xne(h,f,m,b){var y=U.T;U.T=null;var L=G.p;try{G.p=2,nI(h,f,m,b)}finally{G.p=L,U.T=y}}function Zne(h,f,m,b){var y=U.T;U.T=null;var L=G.p;try{G.p=8,nI(h,f,m,b)}finally{G.p=L,U.T=y}}function nI(h,f,m,b){if(pS){var y=sI(b);if(y===null)UN(h,f,b,_S,m),LV(h,b);else if(ese(y,h,f,m,b))b.stopPropagation();else if(LV(h,b),f&4&&-1<Jne.indexOf(h)){for(;y!==null;){var L=di(y);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var I=uc(L.pendingLanes);if(I!==0){var P=L;for(P.pendingLanes|=2,P.entangledLanes|=2;I;){var X=1<<31-Ls(I);P.entanglements[1]|=X,I&=~X}cl(L),(fi&6)===0&&(Jy=ts()+500,Ib(0))}}break;case 31:case 13:P=Od(L,2),P!==null&&Br(P,L,2),tS(),iI(L,2)}if(L=sI(b),L===null&&UN(h,f,b,_S,m),L===y)break;y=L}y!==null&&b.stopPropagation()}else UN(h,f,b,null,m)}}function sI(h){return h=oT(h),rI(h)}var _S=null;function rI(h){if(_S=null,h=ze(h),h!==null){var f=r(h);if(f===null)h=null;else{var m=f.tag;if(m===13){if(h=o(f),h!==null)return h;h=null}else if(m===31){if(h=a(f),h!==null)return h;h=null}else if(m===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;h=null}else f!==h&&(h=null)}}return _S=h,null}function xV(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(qh()){case cc:return 2;case Y1:return 8;case Id:case sy:return 32;case Sm:return 268435456;default:return 32}default:return 32}}var oI=!1,du=null,fu=null,gu=null,Bb=new Map,Vb=new Map,mu=[],Jne="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function LV(h,f){switch(h){case"focusin":case"focusout":du=null;break;case"dragenter":case"dragleave":fu=null;break;case"mouseover":case"mouseout":gu=null;break;case"pointerover":case"pointerout":Bb.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vb.delete(f.pointerId)}}function Wb(h,f,m,b,y,L){return h===null||h.nativeEvent!==L?(h={blockedOn:f,domEventName:m,eventSystemFlags:b,nativeEvent:L,targetContainers:[y]},f!==null&&(f=di(f),f!==null&&yV(f)),h):(h.eventSystemFlags|=b,f=h.targetContainers,y!==null&&f.indexOf(y)===-1&&f.push(y),h)}function ese(h,f,m,b,y){switch(f){case"focusin":return du=Wb(du,h,f,m,b,y),!0;case"dragenter":return fu=Wb(fu,h,f,m,b,y),!0;case"mouseover":return gu=Wb(gu,h,f,m,b,y),!0;case"pointerover":var L=y.pointerId;return Bb.set(L,Wb(Bb.get(L)||null,h,f,m,b,y)),!0;case"gotpointercapture":return L=y.pointerId,Vb.set(L,Wb(Vb.get(L)||null,h,f,m,b,y)),!0}return!1}function kV(h){var f=ze(h.target);if(f!==null){var m=r(f);if(m!==null){if(f=m.tag,f===13){if(f=o(m),f!==null){h.blockedOn=f,Nm(h.priority,function(){SV(m)});return}}else if(f===31){if(f=a(m),f!==null){h.blockedOn=f,Nm(h.priority,function(){SV(m)});return}}else if(f===3&&m.stateNode.current.memoizedState.isDehydrated){h.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}h.blockedOn=null}function bS(h){if(h.blockedOn!==null)return!1;for(var f=h.targetContainers;0<f.length;){var m=sI(h.nativeEvent);if(m===null){m=h.nativeEvent;var b=new m.constructor(m.type,m);rT=b,m.target.dispatchEvent(b),rT=null}else return f=di(m),f!==null&&yV(f),h.blockedOn=m,!1;f.shift()}return!0}function EV(h,f,m){bS(h)&&m.delete(f)}function tse(){oI=!1,du!==null&&bS(du)&&(du=null),fu!==null&&bS(fu)&&(fu=null),gu!==null&&bS(gu)&&(gu=null),Bb.forEach(EV),Vb.forEach(EV)}function CS(h,f){h.blockedOn===f&&(h.blockedOn=null,oI||(oI=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,tse)))}var wS=null;function DV(h){wS!==h&&(wS=h,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){wS===h&&(wS=null);for(var f=0;f<h.length;f+=3){var m=h[f],b=h[f+1],y=h[f+2];if(typeof b!="function"){if(rI(b||m)===null)continue;break}var L=di(m);L!==null&&(h.splice(f,3),f-=3,sN(L,{pending:!0,data:y,method:m.method,action:b},b,y))}}))}function hp(h){function f(X){return CS(X,h)}du!==null&&CS(du,h),fu!==null&&CS(fu,h),gu!==null&&CS(gu,h),Bb.forEach(f),Vb.forEach(f);for(var m=0;m<mu.length;m++){var b=mu[m];b.blockedOn===h&&(b.blockedOn=null)}for(;0<mu.length&&(m=mu[0],m.blockedOn===null);)kV(m),m.blockedOn===null&&mu.shift();if(m=(h.ownerDocument||h).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var y=m[b],L=m[b+1],I=y[ks]||null;if(typeof L=="function")I||DV(m);else if(I){var P=null;if(L&&L.hasAttribute("formAction")){if(y=L,I=L[ks]||null)P=I.formAction;else if(rI(y)!==null)continue}else P=I.action;typeof P=="function"?m[b+1]=P:(m.splice(b,3),b-=3),DV(m)}}}function TV(){function h(L){L.canIntercept&&L.info==="react-transition"&&L.intercept({handler:function(){return new Promise(function(I){return y=I})},focusReset:"manual",scroll:"manual"})}function f(){y!==null&&(y(),y=null),b||setTimeout(m,20)}function m(){if(!b&&!navigation.transition){var L=navigation.currentEntry;L&&L.url!=null&&navigation.navigate(L.url,{state:L.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,y=null;return navigation.addEventListener("navigate",h),navigation.addEventListener("navigatesuccess",f),navigation.addEventListener("navigateerror",f),setTimeout(m,100),function(){b=!0,navigation.removeEventListener("navigate",h),navigation.removeEventListener("navigatesuccess",f),navigation.removeEventListener("navigateerror",f),y!==null&&(y(),y=null)}}}function aI(h){this._internalRoot=h}vS.prototype.render=aI.prototype.render=function(h){var f=this._internalRoot;if(f===null)throw Error(i(409));var m=f.current,b=wo();wV(m,b,h,f,null,null)},vS.prototype.unmount=aI.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var f=h.containerInfo;wV(h.current,2,null,h,null,null),tS(),f[fc]=null}};function vS(h){this._internalRoot=h}vS.prototype.unstable_scheduleHydration=function(h){if(h){var f=Z1();h={blockedOn:null,target:h,priority:f};for(var m=0;m<mu.length&&f!==0&&f<mu[m].priority;m++);mu.splice(m,0,h),m===0&&kV(h)}};var NV=e.version;if(NV!=="19.2.1")throw Error(i(527,NV,"19.2.1"));G.findDOMNode=function(h){var f=h._reactInternals;if(f===void 0)throw typeof h.render=="function"?Error(i(188)):(h=Object.keys(h).join(","),Error(i(268,h)));return h=c(f),h=h!==null?u(h):null,h=h===null?null:h.stateNode,h};var ise={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yS.isDisabled&&yS.supportsFiber)try{sl=yS.inject(ise),on=yS}catch{}}return zb.createRoot=function(h,f){if(!n(h))throw Error(i(299));var m=!1,b="",y=FF,L=BF,I=VF;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onUncaughtError!==void 0&&(y=f.onUncaughtError),f.onCaughtError!==void 0&&(L=f.onCaughtError),f.onRecoverableError!==void 0&&(I=f.onRecoverableError)),f=bV(h,1,!1,null,null,m,b,null,y,L,I,TV),h[fc]=f.current,zN(h),new aI(f)},zb.hydrateRoot=function(h,f,m){if(!n(h))throw Error(i(299));var b=!1,y="",L=FF,I=BF,P=VF,X=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(y=m.identifierPrefix),m.onUncaughtError!==void 0&&(L=m.onUncaughtError),m.onCaughtError!==void 0&&(I=m.onCaughtError),m.onRecoverableError!==void 0&&(P=m.onRecoverableError),m.formState!==void 0&&(X=m.formState)),f=bV(h,1,!0,f,m??null,b,y,X,L,I,P,TV),f.context=CV(null),m=f.current,b=wo(),b=Ca(b),y=eu(b),y.callback=null,tu(m,y,b),m=b,f.current.lanes=m,dc(f,m),cl(f),h[fc]=f.current,zN(h),new vS(f)},zb.version="19.2.1",zb}var WV;function gse(){if(WV)return hI.exports;WV=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),hI.exports=fse(),hI.exports}var mse=gse();const pse=fG(mse),_se=()=>{};var HV={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gG={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me=function(s,e){if(!s)throw E1(e)},E1=function(s){return new Error("Firebase Database ("+gG.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mG=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let n=s.charCodeAt(i);n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):(n&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e},bse=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const n=s[t++];if(n<128)e[i++]=String.fromCharCode(n);else if(n>191&&n<224){const r=s[t++];e[i++]=String.fromCharCode((n&31)<<6|r&63)}else if(n>239&&n<365){const r=s[t++],o=s[t++],a=s[t++],l=((n&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=s[t++],o=s[t++];e[i++]=String.fromCharCode((n&15)<<12|(r&63)<<6|o&63)}}return e.join("")},tP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<s.length;n+=3){const r=s[n],o=n+1<s.length,a=o?s[n+1]:0,l=n+2<s.length,c=l?s[n+2]:0,u=r>>2,d=(r&3)<<4|a>>4;let g=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(g=64)),i.push(t[u],t[d],t[g],t[p])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(mG(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):bse(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<s.length;){const r=t[s.charAt(n++)],a=n<s.length?t[s.charAt(n)]:0;++n;const c=n<s.length?t[s.charAt(n)]:64;++n;const d=n<s.length?t[s.charAt(n)]:64;if(++n,r==null||a==null||c==null||d==null)throw new Cse;const g=r<<2|a>>4;if(i.push(g),c!==64){const p=a<<4&240|c>>2;if(i.push(p),d!==64){const _=c<<6&192|d;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Cse extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pG=function(s){const e=mG(s);return tP.encodeByteArray(e,!0)},aL=function(s){return pG(s).replace(/\./g,"")},gA=function(s){try{return tP.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wse(s){return _G(void 0,s)}function _G(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!vse(t)||(s[t]=_G(s[t],e[t]));return s}function vse(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yse(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sse=()=>yse().__FIREBASE_DEFAULTS__,xse=()=>{if(typeof process>"u"||typeof HV>"u")return;const s=HV.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Lse=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&gA(s[1]);return e&&JSON.parse(e)},bG=()=>{try{return _se()||Sse()||xse()||Lse()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},kse=s=>{var e,t;return(t=(e=bG())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},Ese=s=>{const e=kse(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},CG=()=>{var s;return(s=bG())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iP(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Dse(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tse(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",n=s.iat||0,r=s.sub||s.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...s};return[aL(JSON.stringify(t)),aL(JSON.stringify(o)),""].join(".")}const N0={};function Nse(){const s={prod:[],emulator:[]};for(const e of Object.keys(N0))N0[e]?s.emulator.push(e):s.prod.push(e);return s}function Ise(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let zV=!1;function Rse(s,e){if(typeof window>"u"||typeof document>"u"||!iP(window.location.host)||N0[s]===e||N0[s]||zV)return;N0[s]=e;function t(g){return`__firebase__banner__${g}`}const i="__firebase__banner",r=Nse().prod.length>0;function o(){const g=document.getElementById(i);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,p){g.setAttribute("width","24"),g.setAttribute("id",p),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function c(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{zV=!0,o()},g}function u(g,p){g.setAttribute("id",p),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function d(){const g=Ise(i),p=t("text"),_=document.getElementById(p)||document.createElement("span"),C=t("learnmore"),v=document.getElementById(C)||document.createElement("a"),x=t("preprendIcon"),S=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const k=g.element;a(k),u(v,C);const E=c();l(S,x),k.append(S,_,v,E),document.body.appendChild(k)}r?(_.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ase(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wG(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ase())}function Mse(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ose(){return gG.NODE_ADMIN===!0}function Pse(){try{return typeof indexedDB=="object"}catch{return!1}}function Fse(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},n.onupgradeneeded=()=>{t=!1},n.onerror=()=>{var r;e(((r=n.error)==null?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bse="FirebaseError";class fv extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Bse,Object.setPrototypeOf(this,fv.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vG.prototype.create)}}class vG{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},n=`${this.service}/${e}`,r=this.errors[e],o=r?Vse(r,i):"Error",a=`${this.serviceName}: ${o} (${n}).`;return new fv(n,a,i)}}function Vse(s,e){return s.replace(Wse,(t,i)=>{const n=e[i];return n!=null?String(n):`<${i}?>`})}const Wse=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(s){return JSON.parse(s)}function ss(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yG=function(s){let e={},t={},i={},n="";try{const r=s.split(".");e=VC(gA(r[0])||""),t=VC(gA(r[1])||""),n=r[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:n}},Hse=function(s){const e=yG(s),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},zse=function(s){const e=yG(s).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function G_(s,e){if(Object.prototype.hasOwnProperty.call(s,e))return s[e]}function mA(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function lL(s,e,t){const i={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i[n]=e.call(t,s[n],n,s));return i}function cL(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const n of t){if(!i.includes(n))return!1;const r=s[n],o=e[n];if(UV(r)&&UV(o)){if(!cL(r,o))return!1}else if(r!==o)return!1}for(const n of i)if(!t.includes(n))return!1;return!0}function UV(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Use(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(n=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jse{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const g=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(g<<1|g>>>31)&4294967295}let n=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=a^r&(o^a),u=1518500249):(c=r^o^a,u=1859775393):d<60?(c=r&o|a&(r|o),u=2400959708):(c=r^o^a,u=3395469782);const g=(n<<5|n>>>27)+c+l+u+i[d]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=n,n=g}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let n=0;const r=this.buf_;let o=this.inbuf_;for(;n<t;){if(o===0)for(;n<=i;)this.compress_(e,n),n+=this.blockSize;if(typeof e=="string"){for(;n<t;)if(r[o]=e.charCodeAt(n),++o,++n,o===this.blockSize){this.compress_(r),o=0;break}}else for(;n<t;)if(r[o]=e[n],++o,++n,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let n=this.blockSize-1;n>=56;n--)this.buf_[n]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let n=0;n<5;n++)for(let r=24;r>=0;r-=8)e[i]=this.chain_[n]>>r&255,++i;return e}}function K_(s,e){return`${s} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $se=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let n=s.charCodeAt(i);if(n>=55296&&n<=56319){const r=n-55296;i++,Me(i<s.length,"Surrogate pair missing trail surrogate.");const o=s.charCodeAt(i)-56320;n=65536+(r<<10)+o}n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):n<65536?(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e},L2=function(s){let e=0;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(s){return s&&s._delegate?s._delegate:s}class WC{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qse{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new rh;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(n){if(i)return null;throw n}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Kse(e))try{this.getOrInitializeService({instanceIdentifier:sf})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:n});i.resolve(r)}catch{}}}}clearInstance(e=sf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sf){return this.instances.has(e)}getOptions(e=sf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(n)}return n}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),n=this.onInitCallbacks.get(i)??new Set;n.add(e),this.onInitCallbacks.set(i,n);const r=this.instances.get(i);return r&&e(r,i),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const n of i)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Gse(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=sf){return this.component?this.component.multipleInstances?e:sf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Gse(s){return s===sf?void 0:s}function Kse(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yse{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new qse(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ji;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(ji||(ji={}));const Qse={debug:ji.DEBUG,verbose:ji.VERBOSE,info:ji.INFO,warn:ji.WARN,error:ji.ERROR,silent:ji.SILENT},Xse=ji.INFO,Zse={[ji.DEBUG]:"log",[ji.VERBOSE]:"log",[ji.INFO]:"info",[ji.WARN]:"warn",[ji.ERROR]:"error"},Jse=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),n=Zse[e];if(n)console[n](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class SG{constructor(e){this.name=e,this._logLevel=Xse,this._logHandler=Jse,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ji))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Qse[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ji.DEBUG,...e),this._logHandler(this,ji.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ji.VERBOSE,...e),this._logHandler(this,ji.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ji.INFO,...e),this._logHandler(this,ji.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ji.WARN,...e),this._logHandler(this,ji.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ji.ERROR,...e),this._logHandler(this,ji.ERROR,...e)}}const ere=(s,e)=>e.some(t=>s instanceof t);let jV,$V;function tre(){return jV||(jV=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ire(){return $V||($V=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xG=new WeakMap,pA=new WeakMap,LG=new WeakMap,gI=new WeakMap,nP=new WeakMap;function nre(s){const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("success",r),s.removeEventListener("error",o)},r=()=>{t($u(s.result)),n()},o=()=>{i(s.error),n()};s.addEventListener("success",r),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&xG.set(t,s)}).catch(()=>{}),nP.set(e,s),e}function sre(s){if(pA.has(s))return;const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("complete",r),s.removeEventListener("error",o),s.removeEventListener("abort",o)},r=()=>{t(),n()},o=()=>{i(s.error||new DOMException("AbortError","AbortError")),n()};s.addEventListener("complete",r),s.addEventListener("error",o),s.addEventListener("abort",o)});pA.set(s,e)}let _A={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return pA.get(s);if(e==="objectStoreNames")return s.objectStoreNames||LG.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $u(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function rre(s){_A=s(_A)}function ore(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(mI(this),e,...t);return LG.set(i,e.sort?e.sort():[e]),$u(i)}:ire().includes(s)?function(...e){return s.apply(mI(this),e),$u(xG.get(this))}:function(...e){return $u(s.apply(mI(this),e))}}function are(s){return typeof s=="function"?ore(s):(s instanceof IDBTransaction&&sre(s),ere(s,tre())?new Proxy(s,_A):s)}function $u(s){if(s instanceof IDBRequest)return nre(s);if(gI.has(s))return gI.get(s);const e=are(s);return e!==s&&(gI.set(s,e),nP.set(e,s)),e}const mI=s=>nP.get(s);function lre(s,e,{blocked:t,upgrade:i,blocking:n,terminated:r}={}){const o=indexedDB.open(s,e),a=$u(o);return i&&o.addEventListener("upgradeneeded",l=>{i($u(o.result),l.oldVersion,l.newVersion,$u(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),n&&l.addEventListener("versionchange",c=>n(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const cre=["get","getKey","getAll","getAllKeys","count"],hre=["put","add","delete","clear"],pI=new Map;function qV(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(pI.get(e))return pI.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,n=hre.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(n||cre.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,n?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),n&&l.done]))[0]};return pI.set(e,r),r}rre(s=>({...s,get:(e,t,i)=>qV(e,t)||s.get(e,t,i),has:(e,t)=>!!qV(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ure{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dre(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function dre(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bA="@firebase/app",GV="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh=new SG("@firebase/app"),fre="@firebase/app-compat",gre="@firebase/analytics-compat",mre="@firebase/analytics",pre="@firebase/app-check-compat",_re="@firebase/app-check",bre="@firebase/auth",Cre="@firebase/auth-compat",wre="@firebase/database",vre="@firebase/data-connect",yre="@firebase/database-compat",Sre="@firebase/functions",xre="@firebase/functions-compat",Lre="@firebase/installations",kre="@firebase/installations-compat",Ere="@firebase/messaging",Dre="@firebase/messaging-compat",Tre="@firebase/performance",Nre="@firebase/performance-compat",Ire="@firebase/remote-config",Rre="@firebase/remote-config-compat",Are="@firebase/storage",Mre="@firebase/storage-compat",Ore="@firebase/firestore",Pre="@firebase/ai",Fre="@firebase/firestore-compat",Bre="firebase",Vre="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA="[DEFAULT]",Wre={[bA]:"fire-core",[fre]:"fire-core-compat",[mre]:"fire-analytics",[gre]:"fire-analytics-compat",[_re]:"fire-app-check",[pre]:"fire-app-check-compat",[bre]:"fire-auth",[Cre]:"fire-auth-compat",[wre]:"fire-rtdb",[vre]:"fire-data-connect",[yre]:"fire-rtdb-compat",[Sre]:"fire-fn",[xre]:"fire-fn-compat",[Lre]:"fire-iid",[kre]:"fire-iid-compat",[Ere]:"fire-fcm",[Dre]:"fire-fcm-compat",[Tre]:"fire-perf",[Nre]:"fire-perf-compat",[Ire]:"fire-rc",[Rre]:"fire-rc-compat",[Are]:"fire-gcs",[Mre]:"fire-gcs-compat",[Ore]:"fire-fst",[Fre]:"fire-fst-compat",[Pre]:"fire-vertex","fire-js":"fire-js",[Bre]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hL=new Map,Hre=new Map,wA=new Map;function KV(s,e){try{s.container.addComponent(e)}catch(t){Nh.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function uL(s){const e=s.name;if(wA.has(e))return Nh.debug(`There were multiple attempts to register component ${e}.`),!1;wA.set(e,s);for(const t of hL.values())KV(t,s);for(const t of Hre.values())KV(t,s);return!0}function zre(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Ure(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jre={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qu=new vG("app","Firebase",jre);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $re{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new WC("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qre=Vre;function kG(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:CA,automaticDataCollectionEnabled:!0,...e},n=i.name;if(typeof n!="string"||!n)throw qu.create("bad-app-name",{appName:String(n)});if(t||(t=CG()),!t)throw qu.create("no-options");const r=hL.get(n);if(r){if(cL(t,r.options)&&cL(i,r.config))return r;throw qu.create("duplicate-app",{appName:n})}const o=new Yse(n);for(const l of wA.values())o.addComponent(l);const a=new $re(t,i,o);return hL.set(n,a),a}function Gre(s=CA){const e=hL.get(s);if(!e&&s===CA&&CG())return kG();if(!e)throw qu.create("no-app",{appName:s});return e}function f_(s,e,t){let i=Wre[s]??s;t&&(i+=`-${t}`);const n=i.match(/\s|\//),r=e.match(/\s|\//);if(n||r){const o=[`Unable to register library "${i}" with version "${e}":`];n&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nh.warn(o.join(" "));return}uL(new WC(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kre="firebase-heartbeat-database",Yre=1,HC="firebase-heartbeat-store";let _I=null;function EG(){return _I||(_I=lre(Kre,Yre,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(HC)}catch(t){console.warn(t)}}}}).catch(s=>{throw qu.create("idb-open",{originalErrorMessage:s.message})})),_I}async function Qre(s){try{const t=(await EG()).transaction(HC),i=await t.objectStore(HC).get(DG(s));return await t.done,i}catch(e){if(e instanceof fv)Nh.warn(e.message);else{const t=qu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Nh.warn(t.message)}}}async function YV(s,e){try{const i=(await EG()).transaction(HC,"readwrite");await i.objectStore(HC).put(e,DG(s)),await i.done}catch(t){if(t instanceof fv)Nh.warn(t.message);else{const i=qu.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Nh.warn(i.message)}}}function DG(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xre=1024,Zre=30;class Jre{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new toe(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=QV();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>Zre){const o=ioe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Nh.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=QV(),{heartbeatsToSend:i,unsentEntries:n}=eoe(this._heartbeatsCache.heartbeats),r=aL(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return Nh.warn(t),""}}}function QV(){return new Date().toISOString().substring(0,10)}function eoe(s,e=Xre){const t=[];let i=s.slice();for(const n of s){const r=t.find(o=>o.agent===n.agent);if(r){if(r.dates.push(n.date),XV(t)>e){r.dates.pop();break}}else if(t.push({agent:n.agent,dates:[n.date]}),XV(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class toe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Pse()?Fse().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Qre(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return YV(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return YV(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function XV(s){return aL(JSON.stringify({version:2,heartbeats:s})).length}function ioe(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function noe(s){uL(new WC("platform-logger",e=>new ure(e),"PRIVATE")),uL(new WC("heartbeat",e=>new Jre(e),"PRIVATE")),f_(bA,GV,s),f_(bA,GV,"esm2020"),f_("fire-js","")}noe("");var ZV={};const JV="@firebase/database",eW="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TG="";function soe(s){TG=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class roe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ss(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:VC(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ooe{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return nc(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NG=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const e=window[s];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new roe(e)}}catch{}return new ooe},Vf=NG("localStorage"),aoe=NG("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_=new SG("@firebase/database"),loe=(function(){let s=1;return function(){return s++}})(),IG=function(s){const e=$se(s),t=new jse;t.update(e);const i=t.digest();return tP.encodeByteArray(i)},gv=function(...s){let e="";for(let t=0;t<s.length;t++){const i=s[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=gv.apply(null,i):typeof i=="object"?e+=ss(i):e+=i,e+=" "}return e};let I0=null,tW=!0;const coe=function(s,e){Me(!0,"Can't turn on custom loggers persistently."),g_.logLevel=ji.VERBOSE,I0=g_.log.bind(g_)},Ps=function(...s){if(tW===!0&&(tW=!1,I0===null&&aoe.get("logging_enabled")===!0&&coe()),I0){const e=gv.apply(null,s);I0(e)}},mv=function(s){return function(...e){Ps(s,...e)}},vA=function(...s){const e="FIREBASE INTERNAL ERROR: "+gv(...s);g_.error(e)},Ih=function(...s){const e=`FIREBASE FATAL ERROR: ${gv(...s)}`;throw g_.error(e),new Error(e)},ro=function(...s){const e="FIREBASE WARNING: "+gv(...s);g_.warn(e)},hoe=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ro("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},k2=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},uoe=function(s){if(document.readyState==="complete")s();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Y_="[MIN_NAME]",kg="[MAX_NAME]",Jg=function(s,e){if(s===e)return 0;if(s===Y_||e===kg)return-1;if(e===Y_||s===kg)return 1;{const t=iW(s),i=iW(e);return t!==null?i!==null?t-i===0?s.length-e.length:t-i:-1:i!==null?1:s<e?-1:1}},doe=function(s,e){return s===e?0:s<e?-1:1},Ub=function(s,e){if(e&&s in e)return e[s];throw new Error("Missing required key ("+s+") in object: "+ss(e))},sP=function(s){if(typeof s!="object"||s===null)return ss(s);const e=[];for(const i in s)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=ss(e[i]),t+=":",t+=sP(s[e[i]]);return t+="}",t},RG=function(s,e){const t=s.length;if(t<=e)return[s];const i=[];for(let n=0;n<t;n+=e)n+e>t?i.push(s.substring(n,t)):i.push(s.substring(n,n+e));return i};function lr(s,e){for(const t in s)s.hasOwnProperty(t)&&e(t,s[t])}const AG=function(s){Me(!k2(s),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let n,r,o,a,l;s===0?(r=0,o=0,n=1/s===-1/0?1:0):(n=s<0,s=Math.abs(s),s>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(s)/Math.LN2),i),r=a+i,o=Math.round(s*Math.pow(2,t-a)-Math.pow(2,t))):(r=0,o=Math.round(s/Math.pow(2,1-i-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(n?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let g=parseInt(u.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),d=d+g}return d.toLowerCase()},foe=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},goe=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function moe(s,e){let t="Unknown Error";s==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?t="Client doesn't have permission to access the desired data.":s==="unavailable"&&(t="The service is unavailable");const i=new Error(s+" at "+e._path.toString()+": "+t);return i.code=s.toUpperCase(),i}const poe=new RegExp("^-?(0*)\\d{1,10}$"),_oe=-2147483648,boe=2147483647,iW=function(s){if(poe.test(s)){const e=Number(s);if(e>=_oe&&e<=boe)return e}return null},D1=function(s){try{s()}catch(e){setTimeout(()=>{const t=e.stack||"";throw ro("Exception was thrown by user callback.",t),e},Math.floor(0))}},Coe=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},R0=function(s,e){const t=setTimeout(s,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class woe{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Ure(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){ro(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class voe{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(n=>this.auth_=n)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Ps("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ro(e)}}class Dx{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Dx.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="5",MG="v",OG="s",PG="r",FG="f",BG=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,VG="ls",WG="p",yA="ac",HG="websocket",zG="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UG{constructor(e,t,i,n,r=!1,o="",a=!1,l=!1,c=null){this.secure=t,this.namespace=i,this.webSocketOnly=n,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vf.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vf.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function yoe(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function jG(s,e,t){Me(typeof e=="string","typeof type must == string"),Me(typeof t=="object","typeof params must == object");let i;if(e===HG)i=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(e===zG)i=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);yoe(s)&&(t.ns=s.namespace);const n=[];return lr(t,(r,o)=>{n.push(r+"="+o)}),i+n.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Soe{constructor(){this.counters_={}}incrementCounter(e,t=1){nc(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return wse(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI={},CI={};function oP(s){const e=s.toString();return bI[e]||(bI[e]=new Soe),bI[e]}function xoe(s,e){const t=s.toString();return CI[t]||(CI[t]=e()),CI[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Loe{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let n=0;n<i.length;++n)i[n]&&D1(()=>{this.onMessage_(i[n])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nW="start",koe="close",Eoe="pLPCommand",Doe="pRTLPCB",$G="id",qG="pw",GG="ser",Toe="cb",Noe="seg",Ioe="ts",Roe="d",Aoe="dframe",KG=1870,YG=30,Moe=KG-YG,Ooe=25e3,Poe=3e4;class Ap{constructor(e,t,i,n,r,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=n,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=mv(e),this.stats_=oP(t),this.urlFn=l=>(this.appCheckToken&&(l[yA]=this.appCheckToken),jG(t,zG,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Loe(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Poe)),uoe(()=>{if(this.isClosed_)return;this.scriptTagHolder=new aP((...r)=>{const[o,a,l,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===nW)this.id=a,this.password=l;else if(o===koe)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[nW]="t",i[GG]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Toe]=this.scriptTagHolder.uniqueCallbackIdentifier),i[MG]=rP,this.transportSessionId&&(i[OG]=this.transportSessionId),this.lastSessionId&&(i[VG]=this.lastSessionId),this.applicationId&&(i[WG]=this.applicationId),this.appCheckToken&&(i[yA]=this.appCheckToken),typeof location<"u"&&location.hostname&&BG.test(location.hostname)&&(i[PG]=FG);const n=this.urlFn(i);this.log_("Connecting via long-poll to "+n),this.scriptTagHolder.addTag(n,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ap.forceAllow_=!0}static forceDisallow(){Ap.forceDisallow_=!0}static isAvailable(){return Ap.forceAllow_?!0:!Ap.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!foe()&&!goe()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ss(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=pG(t),n=RG(i,Moe);for(let r=0;r<n.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Aoe]="t",i[$G]=e,i[qG]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ss(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class aP{constructor(e,t,i,n){this.onDisconnect=i,this.urlFn=n,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=loe(),window[Eoe+this.uniqueCallbackIdentifier]=e,window[Doe+this.uniqueCallbackIdentifier]=t,this.myIFrame=aP.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ps("frame writing exception"),a.stack&&Ps(a.stack),Ps(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ps("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[$G]=this.myID,e[qG]=this.myPW,e[GG]=this.currentSerial;let t=this.urlFn(e),i="",n=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+YG+i.length<=KG;){const o=this.pendingSegs.shift();i=i+"&"+Noe+n+"="+o.seg+"&"+Ioe+n+"="+o.ts+"&"+Roe+n+"="+o.d,n++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},n=setTimeout(i,Math.floor(Ooe)),r=()=>{clearTimeout(n),i()};this.addTag(e,r)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const n=i.readyState;(!n||n==="loaded"||n==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Ps("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Foe=16384,Boe=45e3;let dL=null;typeof MozWebSocket<"u"?dL=MozWebSocket:typeof WebSocket<"u"&&(dL=WebSocket);class Va{constructor(e,t,i,n,r,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=n,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=mv(this.connId),this.stats_=oP(t),this.connURL=Va.connectionURL_(t,o,a,n,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,n,r){const o={};return o[MG]=rP,typeof location<"u"&&location.hostname&&BG.test(location.hostname)&&(o[PG]=FG),t&&(o[OG]=t),i&&(o[VG]=i),n&&(o[yA]=n),r&&(o[WG]=r),jG(e,HG,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vf.set("previous_websocket_failure",!0);try{let i;Ose(),this.mySock=new dL(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const n=i.message||i.data;n&&this.log_(n),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const n=i.message||i.data;n&&this.log_(n),this.onClosed_()}}start(){}static forceDisallow(){Va.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&dL!==null&&!Va.forceDisallow_}static previouslyFailed(){return Vf.isInMemoryStorage||Vf.get("previous_websocket_failure")===!0}markConnectionHealthy(){Vf.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=VC(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Me(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=ss(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=RG(t,Foe);i.length>1&&this.sendString_(String(i.length));for(let n=0;n<i.length;n++)this.sendString_(i[n])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Boe))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Va.responsesRequiredToBeHealthy=2;Va.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{static get ALL_TRANSPORTS(){return[Ap,Va]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Va&&Va.isAvailable();let i=t&&!Va.previouslyFailed();if(e.webSocketOnly&&(t||ro("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Va];else{const n=this.transports_=[];for(const r of zC.ALL_TRANSPORTS)r&&r.isAvailable()&&n.push(r);zC.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}zC.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Voe=6e4,Woe=5e3,Hoe=10*1024,zoe=100*1024,wI="t",sW="d",Uoe="s",rW="r",joe="e",oW="o",aW="a",lW="n",cW="p",$oe="h";class qoe{constructor(e,t,i,n,r,o,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=n,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=mv("c:"+this.id+":"),this.transportManager_=new zC(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const n=e.healthyTimeout||0;n>0&&(this.healthyTimeout_=R0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>zoe?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Hoe?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(n)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(wI in e){const t=e[wI];t===aW?this.upgradeIfSecondaryHealthy_():t===rW?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===oW&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ub("t",e),i=Ub("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:cW,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:aW,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:lW,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ub("t",e),i=Ub("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ub(wI,e);if(sW in e){const i=e[sW];if(t===$oe){const n={...i};this.repoInfo_.isUsingEmulator&&(n.h=this.repoInfo_.host),this.onHandshake_(n)}else if(t===lW){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Uoe?this.onConnectionShutdown_(i):t===rW?this.onReset_(i):t===joe?vA("Server Error: "+i):t===oW?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vA("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.host=n,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),rP!==i&&ro("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),R0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Voe))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):R0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Woe))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:cW,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vf.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QG{put(e,t,i,n){}merge(e,t,i,n){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XG{constructor(e){this.allowedEvents_=e,this.listeners_={},Me(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let n=0;n<i.length;n++)i[n].callback.apply(i[n].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const n=this.getInitialEvent(e);n&&t.apply(i,n)}off(e,t,i){this.validateEventType_(e);const n=this.listeners_[e]||[];for(let r=0;r<n.length;r++)if(n[r].callback===t&&(!i||i===n[r].context)){n.splice(r,1);return}}validateEventType_(e){Me(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL extends XG{static getInstance(){return new fL}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!wG()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Me(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hW=32,uW=768;class yi{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[i]=this.pieces_[n],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function hi(){return new yi("")}function Mt(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function sd(s){return s.pieces_.length-s.pieceNum_}function Pi(s){let e=s.pieceNum_;return e<s.pieces_.length&&e++,new yi(s.pieces_,e)}function lP(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function Goe(s){let e="";for(let t=s.pieceNum_;t<s.pieces_.length;t++)s.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(s.pieces_[t])));return e||"/"}function UC(s,e=0){return s.pieces_.slice(s.pieceNum_+e)}function ZG(s){if(s.pieceNum_>=s.pieces_.length)return null;const e=[];for(let t=s.pieceNum_;t<s.pieces_.length-1;t++)e.push(s.pieces_[t]);return new yi(e,0)}function Mn(s,e){const t=[];for(let i=s.pieceNum_;i<s.pieces_.length;i++)t.push(s.pieces_[i]);if(e instanceof yi)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let n=0;n<i.length;n++)i[n].length>0&&t.push(i[n])}return new yi(t,0)}function Ot(s){return s.pieceNum_>=s.pieces_.length}function yr(s,e){const t=Mt(s),i=Mt(e);if(t===null)return e;if(t===i)return yr(Pi(s),Pi(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+s+")")}function Koe(s,e){const t=UC(s,0),i=UC(e,0);for(let n=0;n<t.length&&n<i.length;n++){const r=Jg(t[n],i[n]);if(r!==0)return r}return t.length===i.length?0:t.length<i.length?-1:1}function cP(s,e){if(sd(s)!==sd(e))return!1;for(let t=s.pieceNum_,i=e.pieceNum_;t<=s.pieces_.length;t++,i++)if(s.pieces_[t]!==e.pieces_[i])return!1;return!0}function la(s,e){let t=s.pieceNum_,i=e.pieceNum_;if(sd(s)>sd(e))return!1;for(;t<s.pieces_.length;){if(s.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class Yoe{constructor(e,t){this.errorPrefix_=t,this.parts_=UC(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=L2(this.parts_[i]);JG(this)}}function Qoe(s,e){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(e),s.byteLength_+=L2(e),JG(s)}function Xoe(s){const e=s.parts_.pop();s.byteLength_-=L2(e),s.parts_.length>0&&(s.byteLength_-=1)}function JG(s){if(s.byteLength_>uW)throw new Error(s.errorPrefix_+"has a key path longer than "+uW+" bytes ("+s.byteLength_+").");if(s.parts_.length>hW)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+hW+") or object contains a cycle "+rf(s))}function rf(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP extends XG{static getInstance(){return new hP}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return Me(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb=1e3,Zoe=300*1e3,dW=30*1e3,Joe=1.3,eae=3e4,tae="server_kill",fW=3;class vh extends QG{constructor(e,t,i,n,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=n,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=vh.nextPersistentConnectionId_++,this.log_=mv("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=jb,this.maxReconnectDelay_=Zoe,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");hP.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&fL.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const n=++this.requestNumber_,r={r:n,a:e,b:t};this.log_(ss(r)),Me(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[n]=i)}get(e){this.initConnection_();const t=new rh,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,i,n){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),Me(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Me(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:n,hashFn:t,query:e,tag:i};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),n=t._queryIdentifier;this.log_("Listen on "+i+" for "+n);const r={p:i},o="q";e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;vh.warnOnListenWarnings_(l,t),(this.listens.get(i)&&this.listens.get(i).get(n))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,n),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&nc(e,"w")){const i=G_(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const n='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString();ro(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${n} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||zse(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=dW)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Hse(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,n=>{const r=n.s,o=n.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),n=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+n),Me(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,n)&&this.connected_&&this.sendUnlisten_(i,n,e._queryObject,t)}sendUnlisten_(e,t,i,n){this.log_("Unlisten on "+e+" for "+t);const r={p:e},o="n";n&&(r.q=i,r.t=n),this.sendRequest(o,r)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,n){const r={p:t,d:i};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{n&&setTimeout(()=>{n(o.s,o.d)},Math.floor(0))})}put(e,t,i,n){this.putInternal("p",e,t,i,n)}merge(e,t,i,n){this.putInternal("m",e,t,i,n)}putInternal(e,t,i,n,r){this.initConnection_();const o={p:t,d:i};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:n}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,n=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,r=>{this.log_(t+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),n&&n(r.s,r.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const r=i.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ss(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):vA("Unrecognized action received from server: "+ss(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Me(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=jb,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=jb,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>eae&&(this.reconnectDelay_=jb),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Joe)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),n=this.id+":"+vh.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},c=function(d){Me(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,g]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ps("getToken() completed but was canceled"):(Ps("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=g&&g.token,a=new qoe(n,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,p=>{ro(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(tae)},r))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&ro(d),l())}}}interrupt(e){Ps("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ps("Resuming connection for reason: "+e),delete this.interruptReasons_[e],mA(this.interruptReasons_)&&(this.reconnectDelay_=jb,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(r=>sP(r)).join("$"):i="default";const n=this.removeListen_(e,i);n&&n.onComplete&&n.onComplete("permission_denied")}removeListen_(e,t){const i=new yi(e).toString();let n;if(this.listens.has(i)){const r=this.listens.get(i);n=r.get(t),r.delete(t),r.size===0&&this.listens.delete(i)}else n=void 0;return n}onAuthRevoked_(e,t){Ps("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=fW&&(this.reconnectDelay_=dW,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Ps("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=fW&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+TG.replace(/\./g,"-")]=1,wG()?e["framework.cordova"]=1:Mse()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=fL.getInstance().currentlyOnline();return mA(this.interruptReasons_)&&e}}vh.nextPersistentConnectionId_=0;vh.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ft(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Ft(Y_,e),n=new Ft(Y_,t);return this.compare(i,n)!==0}minPost(){return Ft.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SS;class eK extends E2{static get __EMPTY_NODE(){return SS}static set __EMPTY_NODE(e){SS=e}compare(e,t){return Jg(e.name,t.name)}isDefinedOn(e){throw E1("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ft.MIN}maxPost(){return new Ft(kg,SS)}makePost(e,t){return Me(typeof e=="string","KeyIndex indexValue must always be a string."),new Ft(e,SS)}toString(){return".key"}}const m_=new eK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,t,i,n,r=null){this.isReverse_=n,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,n&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class vs{constructor(e,t,i,n,r){this.key=e,this.value=t,this.color=i??vs.RED,this.left=n??eo.EMPTY_NODE,this.right=r??eo.EMPTY_NODE}copy(e,t,i,n,r){return new vs(e??this.key,t??this.value,i??this.color,n??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let n=this;const r=i(e,n.key);return r<0?n=n.copy(null,null,null,n.left.insert(e,t,i),null):r===0?n=n.copy(null,t,null,null,null):n=n.copy(null,null,null,null,n.right.insert(e,t,i)),n.fixUp_()}removeMin_(){if(this.left.isEmpty())return eo.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,n;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return eo.EMPTY_NODE;n=i.right.min_(),i=i.copy(n.key,n.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,vs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,vs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}vs.RED=!0;vs.BLACK=!1;class iae{copy(e,t,i,n,r){return this}insert(e,t,i){return new vs(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class eo{constructor(e,t=eo.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new eo(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,vs.BLACK,null,null))}remove(e){return new eo(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,vs.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,n=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return n?n.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(n=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new xS(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new xS(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new xS(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new xS(this.root_,null,this.comparator_,!0,e)}}eo.EMPTY_NODE=new iae;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nae(s,e){return Jg(s.name,e.name)}function uP(s,e){return Jg(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SA;function sae(s){SA=s}const tK=function(s){return typeof s=="number"?"number:"+AG(s):"string:"+s},iK=function(s){if(s.isLeafNode()){const e=s.val();Me(typeof e=="string"||typeof e=="number"||typeof e=="object"&&nc(e,".sv"),"Priority must be a string or number.")}else Me(s===SA||s.isEmpty(),"priority of unexpected type.");Me(s===SA||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gW;class bs{static set __childrenNodeConstructor(e){gW=e}static get __childrenNodeConstructor(){return gW}constructor(e,t=bs.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Me(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),iK(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new bs(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:bs.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ot(e)?this:Mt(e)===".priority"?this.priorityNode_:bs.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:bs.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Mt(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(Me(i!==".priority"||sd(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,bs.__childrenNodeConstructor.EMPTY_NODE.updateChild(Pi(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+tK(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=AG(this.value_):e+=this.value_,this.lazyHash_=IG(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===bs.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof bs.__childrenNodeConstructor?-1:(Me(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,n=bs.VALUE_TYPE_ORDER.indexOf(t),r=bs.VALUE_TYPE_ORDER.indexOf(i);return Me(n>=0,"Unknown leaf type: "+t),Me(r>=0,"Unknown leaf type: "+i),n===r?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-n}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}bs.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nK,sK;function rae(s){nK=s}function oae(s){sK=s}class aae extends E2{compare(e,t){const i=e.node.getPriority(),n=t.node.getPriority(),r=i.compareTo(n);return r===0?Jg(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ft.MIN}maxPost(){return new Ft(kg,new bs("[PRIORITY-POST]",sK))}makePost(e,t){const i=nK(e);return new Ft(t,new bs("[PRIORITY-POST]",i))}toString(){return".priority"}}const un=new aae;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lae=Math.log(2);class cae{constructor(e){const t=r=>parseInt(Math.log(r)/lae,10),i=r=>parseInt(Array(r+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const n=i(this.count);this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const gL=function(s,e,t,i){s.sort(e);const n=function(l,c){const u=c-l;let d,g;if(u===0)return null;if(u===1)return d=s[l],g=t?t(d):d,new vs(g,d.node,vs.BLACK,null,null);{const p=parseInt(u/2,10)+l,_=n(l,p),C=n(p+1,c);return d=s[p],g=t?t(d):d,new vs(g,d.node,vs.BLACK,_,C)}},r=function(l){let c=null,u=null,d=s.length;const g=function(_,C){const v=d-_,x=d;d-=_;const S=n(v+1,x),k=s[v],E=t?t(k):k;p(new vs(E,k.node,C,null,S))},p=function(_){c?(c.left=_,c=_):(u=_,c=_)};for(let _=0;_<l.count;++_){const C=l.nextBitIsOne(),v=Math.pow(2,l.count-(_+1));C?g(v,vs.BLACK):(g(v,vs.BLACK),g(v,vs.RED))}return u},o=new cae(s.length),a=r(o);return new eo(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vI;const up={};class fh{static get Default(){return Me(up&&un,"ChildrenNode.ts has not been loaded"),vI=vI||new fh({".priority":up},{".priority":un}),vI}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=G_(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof eo?t:null}hasIndex(e){return nc(this.indexSet_,e.toString())}addIndex(e,t){Me(e!==m_,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let n=!1;const r=t.getIterator(Ft.Wrap);let o=r.getNext();for(;o;)n=n||e.isDefinedOn(o.node),i.push(o),o=r.getNext();let a;n?a=gL(i,e.getCompare()):a=up;const l=e.toString(),c={...this.indexSet_};c[l]=e;const u={...this.indexes_};return u[l]=a,new fh(u,c)}addToIndexes(e,t){const i=lL(this.indexes_,(n,r)=>{const o=G_(this.indexSet_,r);if(Me(o,"Missing index implementation for "+r),n===up)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(Ft.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),gL(a,o.getCompare())}else return up;else{const a=t.get(e.name);let l=n;return a&&(l=l.remove(new Ft(e.name,a))),l.insert(e,e.node)}});return new fh(i,this.indexSet_)}removeFromIndexes(e,t){const i=lL(this.indexes_,n=>{if(n===up)return n;{const r=t.get(e.name);return r?n.remove(new Ft(e.name,r)):n}});return new fh(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $b;class dt{static get EMPTY_NODE(){return $b||($b=new dt(new eo(uP),null,fh.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&iK(this.priorityNode_),this.children_.isEmpty()&&Me(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$b}updatePriority(e){return this.children_.isEmpty()?this:new dt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?$b:t}}getChild(e){const t=Mt(e);return t===null?this:this.getImmediateChild(t).getChild(Pi(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(Me(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new Ft(e,t);let n,r;t.isEmpty()?(n=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(i,this.children_)):(n=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(i,this.children_));const o=n.isEmpty()?$b:this.priorityNode_;return new dt(n,o,r)}}updateChild(e,t){const i=Mt(e);if(i===null)return t;{Me(Mt(e)!==".priority"||sd(e)===1,".priority must be the last token in a path");const n=this.getImmediateChild(i).updateChild(Pi(e),t);return this.updateImmediateChild(i,n)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,n=0,r=!0;if(this.forEachChild(un,(o,a)=>{t[o]=a.val(e),i++,r&&dt.INTEGER_REGEXP_.test(o)?n=Math.max(n,Number(o)):r=!1}),!e&&r&&n<2*i){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+tK(this.getPriority().val())+":"),this.forEachChild(un,(t,i)=>{const n=i.hash();n!==""&&(e+=":"+t+":"+n)}),this.lazyHash_=e===""?"":IG(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const n=this.resolveIndex_(i);if(n){const r=n.getPredecessorKey(new Ft(e,t));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ft(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ft(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(n=>t(n.name,n.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,n=>n);{const n=this.children_.getIteratorFrom(e.name,Ft.Wrap);let r=n.peek();for(;r!=null&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,n=>n);{const n=this.children_.getReverseIteratorFrom(e.name,Ft.Wrap);let r=n.peek();for(;r!=null&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pv?-1:0}withIndex(e){if(e===m_||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new dt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===m_||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(un),n=t.getIterator(un);let r=i.getNext(),o=n.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=i.getNext(),o=n.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===m_?null:this.indexMap_.get(e.toString())}}dt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class hae extends dt{constructor(){super(new eo(uP),dt.EMPTY_NODE,fh.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return dt.EMPTY_NODE}isEmpty(){return!1}}const pv=new hae;Object.defineProperties(Ft,{MIN:{value:new Ft(Y_,dt.EMPTY_NODE)},MAX:{value:new Ft(kg,pv)}});eK.__EMPTY_NODE=dt.EMPTY_NODE;bs.__childrenNodeConstructor=dt;sae(pv);oae(pv);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uae=!0;function Rn(s,e=null){if(s===null)return dt.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(e=s[".priority"]),Me(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const t=s;return new bs(t,Rn(e))}if(!(s instanceof Array)&&uae){const t=[];let i=!1;if(lr(s,(o,a)=>{if(o.substring(0,1)!=="."){const l=Rn(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new Ft(o,l)))}}),t.length===0)return dt.EMPTY_NODE;const r=gL(t,nae,o=>o.name,uP);if(i){const o=gL(t,un.getCompare());return new dt(r,Rn(e),new fh({".priority":o},{".priority":un}))}else return new dt(r,Rn(e),fh.Default)}else{let t=dt.EMPTY_NODE;return lr(s,(i,n)=>{if(nc(s,i)&&i.substring(0,1)!=="."){const r=Rn(n);(r.isLeafNode()||!r.isEmpty())&&(t=t.updateImmediateChild(i,r))}}),t.updatePriority(Rn(e))}}rae(Rn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dae extends E2{constructor(e){super(),this.indexPath_=e,Me(!Ot(e)&&Mt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),n=this.extractChild(t.node),r=i.compareTo(n);return r===0?Jg(e.name,t.name):r}makePost(e,t){const i=Rn(e),n=dt.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ft(t,n)}maxPost(){const e=dt.EMPTY_NODE.updateChild(this.indexPath_,pv);return new Ft(kg,e)}toString(){return UC(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fae extends E2{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Jg(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ft.MIN}maxPost(){return Ft.MAX}makePost(e,t){const i=Rn(e);return new Ft(t,i)}toString(){return".value"}}const gae=new fae;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rK(s){return{type:"value",snapshotNode:s}}function Q_(s,e){return{type:"child_added",snapshotNode:e,childName:s}}function jC(s,e){return{type:"child_removed",snapshotNode:e,childName:s}}function $C(s,e,t){return{type:"child_changed",snapshotNode:e,childName:s,oldSnap:t}}function mae(s,e){return{type:"child_moved",snapshotNode:e,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e){this.index_=e}updateChild(e,t,i,n,r,o){Me(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(n).equals(i.getChild(n))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(jC(t,a)):Me(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Q_(t,i)):o.trackChildChange($C(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(un,(n,r)=>{t.hasChild(n)||i.trackChildChange(jC(n,r))}),t.isLeafNode()||t.forEachChild(un,(n,r)=>{if(e.hasChild(n)){const o=e.getImmediateChild(n);o.equals(r)||i.trackChildChange($C(n,r,o))}else i.trackChildChange(Q_(n,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?dt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e){this.indexedFilter_=new dP(e.getIndex()),this.index_=e.getIndex(),this.startPost_=qC.getStartPost_(e),this.endPost_=qC.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,n,r,o){return this.matches(new Ft(t,i))||(i=dt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,n,r,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=dt.EMPTY_NODE);let n=t.withIndex(this.index_);n=n.updatePriority(dt.EMPTY_NODE);const r=this;return t.forEachChild(un,(o,a)=>{r.matches(new Ft(o,a))||(n=n.updateImmediateChild(o,dt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pae{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new qC(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,n,r,o){return this.rangedFilter_.matches(new Ft(t,i))||(i=dt.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,n,r,o):this.fullLimitUpdateChild_(e,t,i,r,o)}updateFullNode(e,t,i){let n;if(t.isLeafNode()||t.isEmpty())n=dt.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){n=dt.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))n=n.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{n=t.withIndex(this.index_),n=n.updatePriority(dt.EMPTY_NODE);let r;this.reverse_?r=n.getReverseIterator(this.index_):r=n.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:n=n.updateImmediateChild(a.name,dt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,n,r){let o;if(this.reverse_){const d=this.index_.getCompare();o=(g,p)=>d(p,g)}else o=this.index_.getCompare();const a=e;Me(a.numChildren()===this.limit_,"");const l=new Ft(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const d=a.getImmediateChild(t);let g=n.getChildAfterChild(this.index_,c,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=n.getChildAfterChild(this.index_,g,this.reverse_);const p=g==null?1:o(g,l);if(u&&!i.isEmpty()&&p>=0)return r!=null&&r.trackChildChange($C(t,i,d)),a.updateImmediateChild(t,i);{r!=null&&r.trackChildChange(jC(t,d));const C=a.updateImmediateChild(t,dt.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(r!=null&&r.trackChildChange(Q_(g.name,g.node)),C.updateImmediateChild(g.name,g.node)):C}}else return i.isEmpty()?e:u&&o(c,l)>=0?(r!=null&&(r.trackChildChange(jC(c.name,c.node)),r.trackChildChange(Q_(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,dt.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=un}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Me(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Me(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Y_}hasEnd(){return this.endSet_}getIndexEndValue(){return Me(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Me(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:kg}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Me(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===un}copy(){const e=new fP;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function _ae(s){return s.loadsAllData()?new dP(s.getIndex()):s.hasLimit()?new pae(s):new qC(s)}function mW(s){const e={};if(s.isDefault())return e;let t;if(s.index_===un?t="$priority":s.index_===gae?t="$value":s.index_===m_?t="$key":(Me(s.index_ instanceof dae,"Unrecognized index type!"),t=s.index_.toString()),e.orderBy=ss(t),s.startSet_){const i=s.startAfterSet_?"startAfter":"startAt";e[i]=ss(s.indexStartValue_),s.startNameSet_&&(e[i]+=","+ss(s.indexStartName_))}if(s.endSet_){const i=s.endBeforeSet_?"endBefore":"endAt";e[i]=ss(s.indexEndValue_),s.endNameSet_&&(e[i]+=","+ss(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?e.limitToFirst=s.limit_:e.limitToLast=s.limit_),e}function pW(s){const e={};if(s.startSet_&&(e.sp=s.indexStartValue_,s.startNameSet_&&(e.sn=s.indexStartName_),e.sin=!s.startAfterSet_),s.endSet_&&(e.ep=s.indexEndValue_,s.endNameSet_&&(e.en=s.indexEndName_),e.ein=!s.endBeforeSet_),s.limitSet_){e.l=s.limit_;let t=s.viewFrom_;t===""&&(s.isViewFromLeft()?t="l":t="r"),e.vf=t}return s.index_!==un&&(e.i=s.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL extends QG{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Me(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,n){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=n,this.log_=mv("p:rest:"),this.listens_={}}listen(e,t,i,n){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=mL.getListenId_(e,i),a={};this.listens_[o]=a;const l=mW(e._queryParams);this.restRequest_(r+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(r,d,!1,i),G_(this.listens_,o)===a){let g;c?c===401?g="permission_denied":g="rest_error:"+c:g="ok",n(g,null)}})}unlisten(e,t){const i=mL.getListenId_(e,t);delete this.listens_[i]}get(e){const t=mW(e._queryParams),i=e._path.toString(),n=new rh;return this.restRequest_(i+".json",t,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(i,a,!1,null),n.resolve(a)):n.reject(new Error(a))}),n.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([n,r])=>{n&&n.accessToken&&(t.auth=n.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Use(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=VC(a.responseText)}catch{ro("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&ro("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bae{constructor(){this.rootNode_=dt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(){return{value:null,children:new Map}}function T1(s,e,t){if(Ot(e))s.value=t,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(e,t);else{const i=Mt(e);s.children.has(i)||s.children.set(i,pL());const n=s.children.get(i);e=Pi(e),T1(n,e,t)}}function xA(s,e){if(Ot(e))return s.value=null,s.children.clear(),!0;if(s.value!==null){if(s.value.isLeafNode())return!1;{const t=s.value;return s.value=null,t.forEachChild(un,(i,n)=>{T1(s,new yi(i),n)}),xA(s,e)}}else if(s.children.size>0){const t=Mt(e);return e=Pi(e),s.children.has(t)&&xA(s.children.get(t),e)&&s.children.delete(t),s.children.size===0}else return!0}function LA(s,e,t){s.value!==null?t(e,s.value):Cae(s,(i,n)=>{const r=new yi(e.toString()+"/"+i);LA(n,r,t)})}function Cae(s,e){s.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wae{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&lr(this.last_,(i,n)=>{t[i]=t[i]-n}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _W=10*1e3,vae=30*1e3,yae=300*1e3;class Sae{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new wae(e);const i=_W+(vae-_W)*Math.random();R0(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;lr(e,(n,r)=>{r>0&&nc(this.statsToReport_,n)&&(t[n]=r,i=!0)}),i&&this.server_.reportStats(t),R0(this.reportStats_.bind(this),Math.floor(Math.random()*2*yae))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ha;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ha||(Ha={}));function oK(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function gP(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function mP(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Ha.ACK_USER_WRITE,this.source=oK()}operationForChild(e){if(Ot(this.path)){if(this.affectedTree.value!=null)return Me(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new yi(e));return new _L(hi(),t,this.revert)}}else return Me(Mt(this.path)===e,"operationForChild called for unrelated child."),new _L(Pi(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,t){this.source=e,this.path=t,this.type=Ha.LISTEN_COMPLETE}operationForChild(e){return Ot(this.path)?new GC(this.source,hi()):new GC(this.source,Pi(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Ha.OVERWRITE}operationForChild(e){return Ot(this.path)?new Eg(this.source,hi(),this.snap.getImmediateChild(e)):new Eg(this.source,Pi(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Ha.MERGE}operationForChild(e){if(Ot(this.path)){const t=this.children.subtree(new yi(e));return t.isEmpty()?null:t.value?new Eg(this.source,hi(),t.value):new KC(this.source,hi(),t)}else return Me(Mt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new KC(this.source,Pi(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ot(e))return this.isFullyInitialized()&&!this.filtered_;const t=Mt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xae{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Lae(s,e,t,i){const n=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&s.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(mae(o.childName,o.snapshotNode))}),qb(s,n,"child_removed",e,i,t),qb(s,n,"child_added",e,i,t),qb(s,n,"child_moved",r,i,t),qb(s,n,"child_changed",e,i,t),qb(s,n,"value",e,i,t),n}function qb(s,e,t,i,n,r){const o=i.filter(a=>a.type===t);o.sort((a,l)=>Eae(s,a,l)),o.forEach(a=>{const l=kae(s,a,r);n.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,s.query_))})})}function kae(s,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,s.index_)),e}function Eae(s,e,t){if(e.childName==null||t.childName==null)throw E1("Should only compare child_ events.");const i=new Ft(e.childName,e.snapshotNode),n=new Ft(t.childName,t.snapshotNode);return s.index_.compare(i,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(s,e){return{eventCache:s,serverCache:e}}function A0(s,e,t,i){return D2(new rd(e,t,i),s.serverCache)}function aK(s,e,t,i){return D2(s.eventCache,new rd(e,t,i))}function bL(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function Dg(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yI;const Dae=()=>(yI||(yI=new eo(doe)),yI);class Qi{static fromObject(e){let t=new Qi(null);return lr(e,(i,n)=>{t=t.set(new yi(i),n)}),t}constructor(e,t=Dae()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:hi(),value:this.value};if(Ot(e))return null;{const i=Mt(e),n=this.children.get(i);if(n!==null){const r=n.findRootMostMatchingPathAndValue(Pi(e),t);return r!=null?{path:Mn(new yi(i),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ot(e))return this;{const t=Mt(e),i=this.children.get(t);return i!==null?i.subtree(Pi(e)):new Qi(null)}}set(e,t){if(Ot(e))return new Qi(t,this.children);{const i=Mt(e),r=(this.children.get(i)||new Qi(null)).set(Pi(e),t),o=this.children.insert(i,r);return new Qi(this.value,o)}}remove(e){if(Ot(e))return this.children.isEmpty()?new Qi(null):new Qi(null,this.children);{const t=Mt(e),i=this.children.get(t);if(i){const n=i.remove(Pi(e));let r;return n.isEmpty()?r=this.children.remove(t):r=this.children.insert(t,n),this.value===null&&r.isEmpty()?new Qi(null):new Qi(this.value,r)}else return this}}get(e){if(Ot(e))return this.value;{const t=Mt(e),i=this.children.get(t);return i?i.get(Pi(e)):null}}setTree(e,t){if(Ot(e))return t;{const i=Mt(e),r=(this.children.get(i)||new Qi(null)).setTree(Pi(e),t);let o;return r.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,r),new Qi(this.value,o)}}fold(e){return this.fold_(hi(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((n,r)=>{i[n]=r.fold_(Mn(e,n),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,hi(),t)}findOnPath_(e,t,i){const n=this.value?i(t,this.value):!1;if(n)return n;if(Ot(e))return null;{const r=Mt(e),o=this.children.get(r);return o?o.findOnPath_(Pi(e),Mn(t,r),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,hi(),t)}foreachOnPath_(e,t,i){if(Ot(e))return this;{this.value&&i(t,this.value);const n=Mt(e),r=this.children.get(n);return r?r.foreachOnPath_(Pi(e),Mn(t,n),i):new Qi(null)}}foreach(e){this.foreach_(hi(),e)}foreach_(e,t){this.children.inorderTraversal((i,n)=>{n.foreach_(Mn(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.writeTree_=e}static empty(){return new Ua(new Qi(null))}}function M0(s,e,t){if(Ot(e))return new Ua(new Qi(t));{const i=s.writeTree_.findRootMostValueAndPath(e);if(i!=null){const n=i.path;let r=i.value;const o=yr(n,e);return r=r.updateChild(o,t),new Ua(s.writeTree_.set(n,r))}else{const n=new Qi(t),r=s.writeTree_.setTree(e,n);return new Ua(r)}}}function bW(s,e,t){let i=s;return lr(t,(n,r)=>{i=M0(i,Mn(e,n),r)}),i}function CW(s,e){if(Ot(e))return Ua.empty();{const t=s.writeTree_.setTree(e,new Qi(null));return new Ua(t)}}function kA(s,e){return em(s,e)!=null}function em(s,e){const t=s.writeTree_.findRootMostValueAndPath(e);return t!=null?s.writeTree_.get(t.path).getChild(yr(t.path,e)):null}function wW(s){const e=[],t=s.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(un,(i,n)=>{e.push(new Ft(i,n))}):s.writeTree_.children.inorderTraversal((i,n)=>{n.value!=null&&e.push(new Ft(i,n.value))}),e}function Gu(s,e){if(Ot(e))return s;{const t=em(s,e);return t!=null?new Ua(new Qi(t)):new Ua(s.writeTree_.subtree(e))}}function EA(s){return s.writeTree_.isEmpty()}function X_(s,e){return lK(hi(),s.writeTree_,e)}function lK(s,e,t){if(e.value!=null)return t.updateChild(s,e.value);{let i=null;return e.children.inorderTraversal((n,r)=>{n===".priority"?(Me(r.value!==null,"Priority writes must always be leaf nodes"),i=r.value):t=lK(Mn(s,n),r,t)}),!t.getChild(s).isEmpty()&&i!==null&&(t=t.updateChild(Mn(s,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T2(s,e){return dK(e,s)}function Tae(s,e,t,i,n){Me(i>s.lastWriteId,"Stacking an older write on top of newer ones"),n===void 0&&(n=!0),s.allWrites.push({path:e,snap:t,writeId:i,visible:n}),n&&(s.visibleWrites=M0(s.visibleWrites,e,t)),s.lastWriteId=i}function Nae(s,e){for(let t=0;t<s.allWrites.length;t++){const i=s.allWrites[t];if(i.writeId===e)return i}return null}function Iae(s,e){const t=s.allWrites.findIndex(a=>a.writeId===e);Me(t>=0,"removeWrite called with nonexistent writeId.");const i=s.allWrites[t];s.allWrites.splice(t,1);let n=i.visible,r=!1,o=s.allWrites.length-1;for(;n&&o>=0;){const a=s.allWrites[o];a.visible&&(o>=t&&Rae(a,i.path)?n=!1:la(i.path,a.path)&&(r=!0)),o--}if(n){if(r)return Aae(s),!0;if(i.snap)s.visibleWrites=CW(s.visibleWrites,i.path);else{const a=i.children;lr(a,l=>{s.visibleWrites=CW(s.visibleWrites,Mn(i.path,l))})}return!0}else return!1}function Rae(s,e){if(s.snap)return la(s.path,e);for(const t in s.children)if(s.children.hasOwnProperty(t)&&la(Mn(s.path,t),e))return!0;return!1}function Aae(s){s.visibleWrites=cK(s.allWrites,Mae,hi()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function Mae(s){return s.visible}function cK(s,e,t){let i=Ua.empty();for(let n=0;n<s.length;++n){const r=s[n];if(e(r)){const o=r.path;let a;if(r.snap)la(t,o)?(a=yr(t,o),i=M0(i,a,r.snap)):la(o,t)&&(a=yr(o,t),i=M0(i,hi(),r.snap.getChild(a)));else if(r.children){if(la(t,o))a=yr(t,o),i=bW(i,a,r.children);else if(la(o,t))if(a=yr(o,t),Ot(a))i=bW(i,hi(),r.children);else{const l=G_(r.children,Mt(a));if(l){const c=l.getChild(Pi(a));i=M0(i,hi(),c)}}}else throw E1("WriteRecord should have .snap or .children")}}return i}function hK(s,e,t,i,n){if(!i&&!n){const r=em(s.visibleWrites,e);if(r!=null)return r;{const o=Gu(s.visibleWrites,e);if(EA(o))return t;if(t==null&&!kA(o,hi()))return null;{const a=t||dt.EMPTY_NODE;return X_(o,a)}}}else{const r=Gu(s.visibleWrites,e);if(!n&&EA(r))return t;if(!n&&t==null&&!kA(r,hi()))return null;{const o=function(c){return(c.visible||n)&&(!i||!~i.indexOf(c.writeId))&&(la(c.path,e)||la(e,c.path))},a=cK(s.allWrites,o,e),l=t||dt.EMPTY_NODE;return X_(a,l)}}}function Oae(s,e,t){let i=dt.EMPTY_NODE;const n=em(s.visibleWrites,e);if(n)return n.isLeafNode()||n.forEachChild(un,(r,o)=>{i=i.updateImmediateChild(r,o)}),i;if(t){const r=Gu(s.visibleWrites,e);return t.forEachChild(un,(o,a)=>{const l=X_(Gu(r,new yi(o)),a);i=i.updateImmediateChild(o,l)}),wW(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const r=Gu(s.visibleWrites,e);return wW(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Pae(s,e,t,i,n){Me(i||n,"Either existingEventSnap or existingServerSnap must exist");const r=Mn(e,t);if(kA(s.visibleWrites,r))return null;{const o=Gu(s.visibleWrites,r);return EA(o)?n.getChild(t):X_(o,n.getChild(t))}}function Fae(s,e,t,i){const n=Mn(e,t),r=em(s.visibleWrites,n);if(r!=null)return r;if(i.isCompleteForChild(t)){const o=Gu(s.visibleWrites,n);return X_(o,i.getNode().getImmediateChild(t))}else return null}function Bae(s,e){return em(s.visibleWrites,e)}function Vae(s,e,t,i,n,r,o){let a;const l=Gu(s.visibleWrites,e),c=em(l,hi());if(c!=null)a=c;else if(t!=null)a=X_(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],d=o.getCompare(),g=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let p=g.getNext();for(;p&&u.length<n;)d(p,i)!==0&&u.push(p),p=g.getNext();return u}else return[]}function Wae(){return{visibleWrites:Ua.empty(),allWrites:[],lastWriteId:-1}}function CL(s,e,t,i){return hK(s.writeTree,s.treePath,e,t,i)}function pP(s,e){return Oae(s.writeTree,s.treePath,e)}function vW(s,e,t,i){return Pae(s.writeTree,s.treePath,e,t,i)}function wL(s,e){return Bae(s.writeTree,Mn(s.treePath,e))}function Hae(s,e,t,i,n,r){return Vae(s.writeTree,s.treePath,e,t,i,n,r)}function _P(s,e,t){return Fae(s.writeTree,s.treePath,e,t)}function uK(s,e){return dK(Mn(s.treePath,e),s.writeTree)}function dK(s,e){return{treePath:s,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zae{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;Me(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Me(i!==".priority","Only non-priority child changes can be tracked.");const n=this.changeMap.get(i);if(n){const r=n.type;if(t==="child_added"&&r==="child_removed")this.changeMap.set(i,$C(i,e.snapshotNode,n.snapshotNode));else if(t==="child_removed"&&r==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&r==="child_changed")this.changeMap.set(i,jC(i,n.oldSnap));else if(t==="child_changed"&&r==="child_added")this.changeMap.set(i,Q_(i,e.snapshotNode));else if(t==="child_changed"&&r==="child_changed")this.changeMap.set(i,$C(i,e.snapshotNode,n.oldSnap));else throw E1("Illegal combination of changes: "+e+" occurred after "+n)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uae{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const fK=new Uae;class bP{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new rd(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _P(this.writes_,e,i)}}getChildAfterChild(e,t,i){const n=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Dg(this.viewCache_),r=Hae(this.writes_,n,t,1,i,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jae(s){return{filter:s}}function $ae(s,e){Me(e.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),Me(e.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function qae(s,e,t,i,n){const r=new zae;let o,a;if(t.type===Ha.OVERWRITE){const c=t;c.source.fromUser?o=DA(s,e,c.path,c.snap,i,n,r):(Me(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!Ot(c.path),o=vL(s,e,c.path,c.snap,i,n,a,r))}else if(t.type===Ha.MERGE){const c=t;c.source.fromUser?o=Kae(s,e,c.path,c.children,i,n,r):(Me(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=TA(s,e,c.path,c.children,i,n,a,r))}else if(t.type===Ha.ACK_USER_WRITE){const c=t;c.revert?o=Xae(s,e,c.path,i,n,r):o=Yae(s,e,c.path,c.affectedTree,i,n,r)}else if(t.type===Ha.LISTEN_COMPLETE)o=Qae(s,e,t.path,i,r);else throw E1("Unknown operation type: "+t.type);const l=r.getChanges();return Gae(e,o,l),{viewCache:o,changes:l}}function Gae(s,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const n=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=bL(s);(t.length>0||!s.eventCache.isFullyInitialized()||n&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&t.push(rK(bL(e)))}}function gK(s,e,t,i,n,r){const o=e.eventCache;if(wL(i,t)!=null)return e;{let a,l;if(Ot(t))if(Me(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Dg(e),u=c instanceof dt?c:dt.EMPTY_NODE,d=pP(i,u);a=s.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const c=CL(i,Dg(e));a=s.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=Mt(t);if(c===".priority"){Me(sd(t)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const d=vW(i,t,u,l);d!=null?a=s.filter.updatePriority(u,d):a=o.getNode()}else{const u=Pi(t);let d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const g=vW(i,t,o.getNode(),l);g!=null?d=o.getNode().getImmediateChild(c).updateChild(u,g):d=o.getNode().getImmediateChild(c)}else d=_P(i,c,e.serverCache);d!=null?a=s.filter.updateChild(o.getNode(),c,d,u,n,r):a=o.getNode()}}return A0(e,a,o.isFullyInitialized()||Ot(t),s.filter.filtersNodes())}}function vL(s,e,t,i,n,r,o,a){const l=e.serverCache;let c;const u=o?s.filter:s.filter.getIndexedFilter();if(Ot(t))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(t,i);c=u.updateFullNode(l.getNode(),p,null)}else{const p=Mt(t);if(!l.isCompleteForPath(t)&&sd(t)>1)return e;const _=Pi(t),v=l.getNode().getImmediateChild(p).updateChild(_,i);p===".priority"?c=u.updatePriority(l.getNode(),v):c=u.updateChild(l.getNode(),p,v,_,fK,null)}const d=aK(e,c,l.isFullyInitialized()||Ot(t),u.filtersNodes()),g=new bP(n,d,r);return gK(s,d,t,n,g,a)}function DA(s,e,t,i,n,r,o){const a=e.eventCache;let l,c;const u=new bP(n,e,r);if(Ot(t))c=s.filter.updateFullNode(e.eventCache.getNode(),i,o),l=A0(e,c,!0,s.filter.filtersNodes());else{const d=Mt(t);if(d===".priority")c=s.filter.updatePriority(e.eventCache.getNode(),i),l=A0(e,c,a.isFullyInitialized(),a.isFiltered());else{const g=Pi(t),p=a.getNode().getImmediateChild(d);let _;if(Ot(g))_=i;else{const C=u.getCompleteChild(d);C!=null?lP(g)===".priority"&&C.getChild(ZG(g)).isEmpty()?_=C:_=C.updateChild(g,i):_=dt.EMPTY_NODE}if(p.equals(_))l=e;else{const C=s.filter.updateChild(a.getNode(),d,_,g,u,o);l=A0(e,C,a.isFullyInitialized(),s.filter.filtersNodes())}}}return l}function yW(s,e){return s.eventCache.isCompleteForChild(e)}function Kae(s,e,t,i,n,r,o){let a=e;return i.foreach((l,c)=>{const u=Mn(t,l);yW(e,Mt(u))&&(a=DA(s,a,u,c,n,r,o))}),i.foreach((l,c)=>{const u=Mn(t,l);yW(e,Mt(u))||(a=DA(s,a,u,c,n,r,o))}),a}function SW(s,e,t){return t.foreach((i,n)=>{e=e.updateChild(i,n)}),e}function TA(s,e,t,i,n,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;Ot(t)?c=i:c=new Qi(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,g)=>{if(u.hasChild(d)){const p=e.serverCache.getNode().getImmediateChild(d),_=SW(s,p,g);l=vL(s,l,new yi(d),_,n,r,o,a)}}),c.children.inorderTraversal((d,g)=>{const p=!e.serverCache.isCompleteForChild(d)&&g.value===null;if(!u.hasChild(d)&&!p){const _=e.serverCache.getNode().getImmediateChild(d),C=SW(s,_,g);l=vL(s,l,new yi(d),C,n,r,o,a)}}),l}function Yae(s,e,t,i,n,r,o){if(wL(n,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(Ot(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return vL(s,e,t,l.getNode().getChild(t),n,r,a,o);if(Ot(t)){let c=new Qi(null);return l.getNode().forEachChild(m_,(u,d)=>{c=c.set(new yi(u),d)}),TA(s,e,t,c,n,r,a,o)}else return e}else{let c=new Qi(null);return i.foreach((u,d)=>{const g=Mn(t,u);l.isCompleteForPath(g)&&(c=c.set(u,l.getNode().getChild(g)))}),TA(s,e,t,c,n,r,a,o)}}function Qae(s,e,t,i,n){const r=e.serverCache,o=aK(e,r.getNode(),r.isFullyInitialized()||Ot(t),r.isFiltered());return gK(s,o,t,i,fK,n)}function Xae(s,e,t,i,n,r){let o;if(wL(i,t)!=null)return e;{const a=new bP(i,e,n),l=e.eventCache.getNode();let c;if(Ot(t)||Mt(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=CL(i,Dg(e));else{const d=e.serverCache.getNode();Me(d instanceof dt,"serverChildren would be complete if leaf node"),u=pP(i,d)}u=u,c=s.filter.updateFullNode(l,u,r)}else{const u=Mt(t);let d=_P(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=s.filter.updateChild(l,u,d,Pi(t),a,r):e.eventCache.getNode().hasChild(u)?c=s.filter.updateChild(l,u,dt.EMPTY_NODE,Pi(t),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=CL(i,Dg(e)),o.isLeafNode()&&(c=s.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||wL(i,hi())!=null,A0(e,c,o,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zae=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,n=new dP(i.getIndex()),r=_ae(i);this.processor_=jae(r);const o=t.serverCache,a=t.eventCache,l=n.updateFullNode(dt.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(dt.EMPTY_NODE,a.getNode(),null),u=new rd(l,o.isFullyInitialized(),n.filtersNodes()),d=new rd(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=D2(d,u),this.eventGenerator_=new xae(this.query_)}get query(){return this.query_}};function Jae(s){return s.viewCache_.serverCache.getNode()}function ele(s){return bL(s.viewCache_)}function tle(s,e){const t=Dg(s.viewCache_);return t&&(s.query._queryParams.loadsAllData()||!Ot(e)&&!t.getImmediateChild(Mt(e)).isEmpty())?t.getChild(e):null}function xW(s){return s.eventRegistrations_.length===0}function ile(s,e){s.eventRegistrations_.push(e)}function LW(s,e,t){const i=[];if(t){Me(e==null,"A cancel should cancel all event registrations.");const n=s.query._path;s.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(t,n);o&&i.push(o)})}if(e){let n=[];for(let r=0;r<s.eventRegistrations_.length;++r){const o=s.eventRegistrations_[r];if(!o.matches(e))n.push(o);else if(e.hasAnyCallback()){n=n.concat(s.eventRegistrations_.slice(r+1));break}}s.eventRegistrations_=n}else s.eventRegistrations_=[];return i}function kW(s,e,t,i){e.type===Ha.MERGE&&e.source.queryId!==null&&(Me(Dg(s.viewCache_),"We should always have a full cache before handling merges"),Me(bL(s.viewCache_),"Missing event cache, even though we have a server cache"));const n=s.viewCache_,r=qae(s.processor_,n,e,t,i);return $ae(s.processor_,r.viewCache),Me(r.viewCache.serverCache.isFullyInitialized()||!n.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=r.viewCache,mK(s,r.changes,r.viewCache.eventCache.getNode(),null)}function nle(s,e){const t=s.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(un,(r,o)=>{i.push(Q_(r,o))}),t.isFullyInitialized()&&i.push(rK(t.getNode())),mK(s,i,t.getNode(),e)}function mK(s,e,t,i){const n=i?[i]:s.eventRegistrations_;return Lae(s.eventGenerator_,e,t,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yL;class pK{constructor(){this.views=new Map}}function sle(s){Me(!yL,"__referenceConstructor has already been defined"),yL=s}function rle(){return Me(yL,"Reference.ts has not been loaded"),yL}function ole(s){return s.views.size===0}function CP(s,e,t,i){const n=e.source.queryId;if(n!==null){const r=s.views.get(n);return Me(r!=null,"SyncTree gave us an op for an invalid query."),kW(r,e,t,i)}else{let r=[];for(const o of s.views.values())r=r.concat(kW(o,e,t,i));return r}}function _K(s,e,t,i,n){const r=e._queryIdentifier,o=s.views.get(r);if(!o){let a=CL(t,n?i:null),l=!1;a?l=!0:i instanceof dt?(a=pP(t,i),l=!1):(a=dt.EMPTY_NODE,l=!1);const c=D2(new rd(a,l,!1),new rd(i,n,!1));return new Zae(e,c)}return o}function ale(s,e,t,i,n,r){const o=_K(s,e,i,n,r);return s.views.has(e._queryIdentifier)||s.views.set(e._queryIdentifier,o),ile(o,t),nle(o,t)}function lle(s,e,t,i){const n=e._queryIdentifier,r=[];let o=[];const a=od(s);if(n==="default")for(const[l,c]of s.views.entries())o=o.concat(LW(c,t,i)),xW(c)&&(s.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=s.views.get(n);l&&(o=o.concat(LW(l,t,i)),xW(l)&&(s.views.delete(n),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!od(s)&&r.push(new(rle())(e._repo,e._path)),{removed:r,events:o}}function bK(s){const e=[];for(const t of s.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ku(s,e){let t=null;for(const i of s.views.values())t=t||tle(i,e);return t}function CK(s,e){if(e._queryParams.loadsAllData())return N2(s);{const i=e._queryIdentifier;return s.views.get(i)}}function wK(s,e){return CK(s,e)!=null}function od(s){return N2(s)!=null}function N2(s){for(const e of s.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SL;function cle(s){Me(!SL,"__referenceConstructor has already been defined"),SL=s}function hle(){return Me(SL,"Reference.ts has not been loaded"),SL}let ule=1;class EW{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qi(null),this.pendingWriteTree_=Wae(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function vK(s,e,t,i,n){return Tae(s.pendingWriteTree_,e,t,i,n),n?bv(s,new Eg(oK(),e,t)):[]}function Wf(s,e,t=!1){const i=Nae(s.pendingWriteTree_,e);if(Iae(s.pendingWriteTree_,e)){let r=new Qi(null);return i.snap!=null?r=r.set(hi(),!0):lr(i.children,o=>{r=r.set(new yi(o),!0)}),bv(s,new _L(i.path,r,t))}else return[]}function _v(s,e,t){return bv(s,new Eg(gP(),e,t))}function dle(s,e,t){const i=Qi.fromObject(t);return bv(s,new KC(gP(),e,i))}function fle(s,e){return bv(s,new GC(gP(),e))}function gle(s,e,t){const i=vP(s,t);if(i){const n=yP(i),r=n.path,o=n.queryId,a=yr(r,e),l=new GC(mP(o),a);return SP(s,r,l)}else return[]}function xL(s,e,t,i,n=!1){const r=e._path,o=s.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||wK(o,e))){const l=lle(o,e,t,i);ole(o)&&(s.syncPointTree_=s.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!n){const u=c.findIndex(g=>g._queryParams.loadsAllData())!==-1,d=s.syncPointTree_.findOnPath(r,(g,p)=>od(p));if(u&&!d){const g=s.syncPointTree_.subtree(r);if(!g.isEmpty()){const p=_le(g);for(let _=0;_<p.length;++_){const C=p[_],v=C.query,x=LK(s,C);s.listenProvider_.startListening(O0(v),YC(s,v),x.hashFn,x.onComplete)}}}!d&&c.length>0&&!i&&(u?s.listenProvider_.stopListening(O0(e),null):c.forEach(g=>{const p=s.queryToTagMap.get(I2(g));s.listenProvider_.stopListening(O0(g),p)}))}ble(s,c)}return a}function yK(s,e,t,i){const n=vP(s,i);if(n!=null){const r=yP(n),o=r.path,a=r.queryId,l=yr(o,e),c=new Eg(mP(a),l,t);return SP(s,o,c)}else return[]}function mle(s,e,t,i){const n=vP(s,i);if(n){const r=yP(n),o=r.path,a=r.queryId,l=yr(o,e),c=Qi.fromObject(t),u=new KC(mP(a),l,c);return SP(s,o,u)}else return[]}function NA(s,e,t,i=!1){const n=e._path;let r=null,o=!1;s.syncPointTree_.foreachOnPath(n,(g,p)=>{const _=yr(g,n);r=r||Ku(p,_),o=o||od(p)});let a=s.syncPointTree_.get(n);a?(o=o||od(a),r=r||Ku(a,hi())):(a=new pK,s.syncPointTree_=s.syncPointTree_.set(n,a));let l;r!=null?l=!0:(l=!1,r=dt.EMPTY_NODE,s.syncPointTree_.subtree(n).foreachChild((p,_)=>{const C=Ku(_,hi());C&&(r=r.updateImmediateChild(p,C))}));const c=wK(a,e);if(!c&&!e._queryParams.loadsAllData()){const g=I2(e);Me(!s.queryToTagMap.has(g),"View does not exist, but we have a tag");const p=Cle();s.queryToTagMap.set(g,p),s.tagToQueryMap.set(p,g)}const u=T2(s.pendingWriteTree_,n);let d=ale(a,e,t,u,r,l);if(!c&&!o&&!i){const g=CK(a,e);d=d.concat(wle(s,e,g))}return d}function wP(s,e,t){const n=s.pendingWriteTree_,r=s.syncPointTree_.findOnPath(e,(o,a)=>{const l=yr(o,e),c=Ku(a,l);if(c)return c});return hK(n,e,r,t,!0)}function ple(s,e){const t=e._path;let i=null;s.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=yr(c,t);i=i||Ku(u,d)});let n=s.syncPointTree_.get(t);n?i=i||Ku(n,hi()):(n=new pK,s.syncPointTree_=s.syncPointTree_.set(t,n));const r=i!=null,o=r?new rd(i,!0,!1):null,a=T2(s.pendingWriteTree_,e._path),l=_K(n,e,a,r?o.getNode():dt.EMPTY_NODE,r);return ele(l)}function bv(s,e){return SK(e,s.syncPointTree_,null,T2(s.pendingWriteTree_,hi()))}function SK(s,e,t,i){if(Ot(s.path))return xK(s,e,t,i);{const n=e.get(hi());t==null&&n!=null&&(t=Ku(n,hi()));let r=[];const o=Mt(s.path),a=s.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,u=uK(i,o);r=r.concat(SK(a,l,c,u))}return n&&(r=r.concat(CP(n,s,i,t))),r}}function xK(s,e,t,i){const n=e.get(hi());t==null&&n!=null&&(t=Ku(n,hi()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=uK(i,o),u=s.operationForChild(o);u&&(r=r.concat(xK(u,a,l,c)))}),n&&(r=r.concat(CP(n,s,i,t))),r}function LK(s,e){const t=e.query,i=YC(s,t);return{hashFn:()=>(Jae(e)||dt.EMPTY_NODE).hash(),onComplete:n=>{if(n==="ok")return i?gle(s,t._path,i):fle(s,t._path);{const r=moe(n,t);return xL(s,t,null,r)}}}}function YC(s,e){const t=I2(e);return s.queryToTagMap.get(t)}function I2(s){return s._path.toString()+"$"+s._queryIdentifier}function vP(s,e){return s.tagToQueryMap.get(e)}function yP(s){const e=s.indexOf("$");return Me(e!==-1&&e<s.length-1,"Bad queryKey."),{queryId:s.substr(e+1),path:new yi(s.substr(0,e))}}function SP(s,e,t){const i=s.syncPointTree_.get(e);Me(i,"Missing sync point for query tag that we're tracking");const n=T2(s.pendingWriteTree_,e);return CP(i,t,n,null)}function _le(s){return s.fold((e,t,i)=>{if(t&&od(t))return[N2(t)];{let n=[];return t&&(n=bK(t)),lr(i,(r,o)=>{n=n.concat(o)}),n}})}function O0(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(hle())(s._repo,s._path):s}function ble(s,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const n=I2(i),r=s.queryToTagMap.get(n);s.queryToTagMap.delete(n),s.tagToQueryMap.delete(r)}}}function Cle(){return ule++}function wle(s,e,t){const i=e._path,n=YC(s,e),r=LK(s,t),o=s.listenProvider_.startListening(O0(e),n,r.hashFn,r.onComplete),a=s.syncPointTree_.subtree(i);if(n)Me(!od(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,d)=>{if(!Ot(c)&&u&&od(u))return[N2(u).query];{let g=[];return u&&(g=g.concat(bK(u).map(p=>p.query))),lr(d,(p,_)=>{g=g.concat(_)}),g}});for(let c=0;c<l.length;++c){const u=l[c];s.listenProvider_.stopListening(O0(u),YC(s,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new xP(t)}node(){return this.node_}}class LP{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Mn(this.path_,e);return new LP(this.syncTree_,t)}node(){return wP(this.syncTree_,this.path_)}}const vle=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},DW=function(s,e,t){if(!s||typeof s!="object")return s;if(Me(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return yle(s[".sv"],e,t);if(typeof s[".sv"]=="object")return Sle(s[".sv"],e);Me(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},yle=function(s,e,t){switch(s){case"timestamp":return t.timestamp;default:Me(!1,"Unexpected server value: "+s)}},Sle=function(s,e,t){s.hasOwnProperty("increment")||Me(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const i=s.increment;typeof i!="number"&&Me(!1,"Unexpected increment value: "+i);const n=e.node();if(Me(n!==null&&typeof n<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!n.isLeafNode())return i;const o=n.getValue();return typeof o!="number"?i:o+i},xle=function(s,e,t,i){return kP(e,new LP(t,s),i)},kK=function(s,e,t){return kP(s,new xP(e),t)};function kP(s,e,t){const i=s.getPriority().val(),n=DW(i,e.getImmediateChild(".priority"),t);let r;if(s.isLeafNode()){const o=s,a=DW(o.getValue(),e,t);return a!==o.getValue()||n!==o.getPriority().val()?new bs(a,Rn(n)):s}else{const o=s;return r=o,n!==o.getPriority().val()&&(r=r.updatePriority(new bs(n))),o.forEachChild(un,(a,l)=>{const c=kP(l,e.getImmediateChild(a),t);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function DP(s,e){let t=e instanceof yi?e:new yi(e),i=s,n=Mt(t);for(;n!==null;){const r=G_(i.node.children,n)||{children:{},childCount:0};i=new EP(n,i,r),t=Pi(t),n=Mt(t)}return i}function N1(s){return s.node.value}function EK(s,e){s.node.value=e,IA(s)}function DK(s){return s.node.childCount>0}function Lle(s){return N1(s)===void 0&&!DK(s)}function R2(s,e){lr(s.node.children,(t,i)=>{e(new EP(t,s,i))})}function TK(s,e,t,i){t&&e(s),R2(s,n=>{TK(n,e,!0)})}function kle(s,e,t){let i=s.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Cv(s){return new yi(s.parent===null?s.name:Cv(s.parent)+"/"+s.name)}function IA(s){s.parent!==null&&Ele(s.parent,s.name,s)}function Ele(s,e,t){const i=Lle(t),n=nc(s.node.children,e);i&&n?(delete s.node.children[e],s.node.childCount--,IA(s)):!i&&!n&&(s.node.children[e]=t.node,s.node.childCount++,IA(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dle=/[\[\].#$\/\u0000-\u001F\u007F]/,Tle=/[\[\].#$\u0000-\u001F\u007F]/,SI=10*1024*1024,TP=function(s){return typeof s=="string"&&s.length!==0&&!Dle.test(s)},NK=function(s){return typeof s=="string"&&s.length!==0&&!Tle.test(s)},Nle=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),NK(s)},IK=function(s){return s===null||typeof s=="string"||typeof s=="number"&&!k2(s)||s&&typeof s=="object"&&nc(s,".sv")},RA=function(s,e,t,i){A2(K_(s,"value"),e,t)},A2=function(s,e,t){const i=t instanceof yi?new Yoe(t,s):t;if(e===void 0)throw new Error(s+"contains undefined "+rf(i));if(typeof e=="function")throw new Error(s+"contains a function "+rf(i)+" with contents = "+e.toString());if(k2(e))throw new Error(s+"contains "+e.toString()+" "+rf(i));if(typeof e=="string"&&e.length>SI/3&&L2(e)>SI)throw new Error(s+"contains a string greater than "+SI+" utf8 bytes "+rf(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let n=!1,r=!1;if(lr(e,(o,a)=>{if(o===".value")n=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!TP(o)))throw new Error(s+" contains an invalid key ("+o+") "+rf(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Qoe(i,o),A2(s,a,i),Xoe(i)}),n&&r)throw new Error(s+' contains ".value" child '+rf(i)+" in addition to actual children.")}},Ile=function(s,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const r=UC(i);for(let o=0;o<r.length;o++)if(!(r[o]===".priority"&&o===r.length-1)){if(!TP(r[o]))throw new Error(s+"contains an invalid key ("+r[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Koe);let n=null;for(t=0;t<e.length;t++){if(i=e[t],n!==null&&la(n,i))throw new Error(s+"contains a path "+n.toString()+" that is ancestor of another path "+i.toString());n=i}},Rle=function(s,e,t,i){const n=K_(s,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(n+" must be an object containing the children to replace.");const r=[];lr(e,(o,a)=>{const l=new yi(o);if(A2(n,a,Mn(t,l)),lP(l)===".priority"&&!IK(a))throw new Error(n+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),Ile(n,r)},Ale=function(s,e,t){if(k2(e))throw new Error(K_(s,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!IK(e))throw new Error(K_(s,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},RK=function(s,e,t,i){if(!NK(t))throw new Error(K_(s,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Mle=function(s,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),RK(s,e,t)},Mp=function(s,e){if(Mt(e)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},Ole=function(s,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!TP(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Nle(t))throw new Error(K_(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ple{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function NP(s,e){let t=null;for(let i=0;i<e.length;i++){const n=e[i],r=n.getPath();t!==null&&!cP(r,t.path)&&(s.eventLists_.push(t),t=null),t===null&&(t={events:[],path:r}),t.events.push(n)}t&&s.eventLists_.push(t)}function AK(s,e,t){NP(s,t),MK(s,i=>cP(i,e))}function jl(s,e,t){NP(s,t),MK(s,i=>la(i,e)||la(e,i))}function MK(s,e){s.recursionDepth_++;let t=!0;for(let i=0;i<s.eventLists_.length;i++){const n=s.eventLists_[i];if(n){const r=n.path;e(r)?(Fle(s.eventLists_[i]),s.eventLists_[i]=null):t=!1}}t&&(s.eventLists_=[]),s.recursionDepth_--}function Fle(s){for(let e=0;e<s.events.length;e++){const t=s.events[e];if(t!==null){s.events[e]=null;const i=t.getEventRunner();I0&&Ps("event: "+t.toString()),D1(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ble="repo_interrupt",Vle=25;class Wle{constructor(e,t,i,n){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ple,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pL(),this.transactionQueueTree_=new EP,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Hle(s,e,t){if(s.stats_=oP(s.repoInfo_),s.forceRestClient_||Coe())s.server_=new mL(s.repoInfo_,(i,n,r,o)=>{TW(s,i,n,r,o)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>NW(s,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ss(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}s.persistentConnection_=new vh(s.repoInfo_,e,(i,n,r,o)=>{TW(s,i,n,r,o)},i=>{NW(s,i)},i=>{Ule(s,i)},s.authTokenProvider_,s.appCheckProvider_,t),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(i=>{s.server_.refreshAuthToken(i)}),s.appCheckProvider_.addTokenChangeListener(i=>{s.server_.refreshAppCheckToken(i.token)}),s.statsReporter_=xoe(s.repoInfo_,()=>new Sae(s.stats_,s.server_)),s.infoData_=new bae,s.infoSyncTree_=new EW({startListening:(i,n,r,o)=>{let a=[];const l=s.infoData_.getNode(i._path);return l.isEmpty()||(a=_v(s.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),RP(s,"connected",!1),s.serverSyncTree_=new EW({startListening:(i,n,r,o)=>(s.server_.listen(i,r,n,(a,l)=>{const c=o(a,l);jl(s.eventQueue_,i._path,c)}),[]),stopListening:(i,n)=>{s.server_.unlisten(i,n)}})}function zle(s){const t=s.infoData_.getNode(new yi(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function IP(s){return vle({timestamp:zle(s)})}function TW(s,e,t,i,n){s.dataUpdateCount++;const r=new yi(e);t=s.interceptServerDataCallback_?s.interceptServerDataCallback_(e,t):t;let o=[];if(n)if(i){const l=lL(t,c=>Rn(c));o=mle(s.serverSyncTree_,r,l,n)}else{const l=Rn(t);o=yK(s.serverSyncTree_,r,l,n)}else if(i){const l=lL(t,c=>Rn(c));o=dle(s.serverSyncTree_,r,l)}else{const l=Rn(t);o=_v(s.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=O2(s,r)),jl(s.eventQueue_,a,o)}function NW(s,e){RP(s,"connected",e),e===!1&&qle(s)}function Ule(s,e){lr(e,(t,i)=>{RP(s,t,i)})}function RP(s,e,t){const i=new yi("/.info/"+e),n=Rn(t);s.infoData_.updateSnapshot(i,n);const r=_v(s.infoSyncTree_,i,n);jl(s.eventQueue_,i,r)}function OK(s){return s.nextWriteId_++}function jle(s,e,t){const i=ple(s.serverSyncTree_,e);return i!=null?Promise.resolve(i):s.server_.get(e).then(n=>{const r=Rn(n).withIndex(e._queryParams.getIndex());NA(s.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=_v(s.serverSyncTree_,e._path,r);else{const a=YC(s.serverSyncTree_,e);o=yK(s.serverSyncTree_,e._path,r,a)}return jl(s.eventQueue_,e._path,o),xL(s.serverSyncTree_,e,t,null,!0),r},n=>(M2(s,"get for query "+ss(e)+" failed: "+n),Promise.reject(new Error(n))))}function $le(s,e,t,i,n){M2(s,"set",{path:e.toString(),value:t,priority:i});const r=IP(s),o=Rn(t,i),a=wP(s.serverSyncTree_,e),l=kK(o,a,r),c=OK(s),u=vK(s.serverSyncTree_,e,l,c,!0);NP(s.eventQueue_,u),s.server_.put(e.toString(),o.val(!0),(g,p)=>{const _=g==="ok";_||ro("set at "+e+" failed: "+g);const C=Wf(s.serverSyncTree_,c,!_);jl(s.eventQueue_,e,C),Z_(s,n,g,p)});const d=WK(s,e);O2(s,d),jl(s.eventQueue_,d,[])}function qle(s){M2(s,"onDisconnectEvents");const e=IP(s),t=pL();LA(s.onDisconnect_,hi(),(n,r)=>{const o=xle(n,r,s.serverSyncTree_,e);T1(t,n,o)});let i=[];LA(t,hi(),(n,r)=>{i=i.concat(_v(s.serverSyncTree_,n,r));const o=WK(s,n);O2(s,o)}),s.onDisconnect_=pL(),jl(s.eventQueue_,hi(),i)}function Gle(s,e,t){s.server_.onDisconnectCancel(e.toString(),(i,n)=>{i==="ok"&&xA(s.onDisconnect_,e),Z_(s,t,i,n)})}function IW(s,e,t,i){const n=Rn(t);s.server_.onDisconnectPut(e.toString(),n.val(!0),(r,o)=>{r==="ok"&&T1(s.onDisconnect_,e,n),Z_(s,i,r,o)})}function Kle(s,e,t,i,n){const r=Rn(t,i);s.server_.onDisconnectPut(e.toString(),r.val(!0),(o,a)=>{o==="ok"&&T1(s.onDisconnect_,e,r),Z_(s,n,o,a)})}function Yle(s,e,t,i){if(mA(t)){Ps("onDisconnect().update() called with empty data.  Don't do anything."),Z_(s,i,"ok",void 0);return}s.server_.onDisconnectMerge(e.toString(),t,(n,r)=>{n==="ok"&&lr(t,(o,a)=>{const l=Rn(a);T1(s.onDisconnect_,Mn(e,o),l)}),Z_(s,i,n,r)})}function Qle(s,e,t){let i;Mt(e._path)===".info"?i=NA(s.infoSyncTree_,e,t):i=NA(s.serverSyncTree_,e,t),AK(s.eventQueue_,e._path,i)}function Xle(s,e,t){let i;Mt(e._path)===".info"?i=xL(s.infoSyncTree_,e,t):i=xL(s.serverSyncTree_,e,t),AK(s.eventQueue_,e._path,i)}function Zle(s){s.persistentConnection_&&s.persistentConnection_.interrupt(Ble)}function M2(s,...e){let t="";s.persistentConnection_&&(t=s.persistentConnection_.id+":"),Ps(t,...e)}function Z_(s,e,t,i){e&&D1(()=>{if(t==="ok")e(null);else{const n=(t||"error").toUpperCase();let r=n;i&&(r+=": "+i);const o=new Error(r);o.code=n,e(o)}})}function PK(s,e,t){return wP(s.serverSyncTree_,e,t)||dt.EMPTY_NODE}function AP(s,e=s.transactionQueueTree_){if(e||P2(s,e),N1(e)){const t=BK(s,e);Me(t.length>0,"Sending zero length transaction queue"),t.every(n=>n.status===0)&&Jle(s,Cv(e),t)}else DK(e)&&R2(e,t=>{AP(s,t)})}function Jle(s,e,t){const i=t.map(c=>c.currentWriteId),n=PK(s,e,i);let r=n;const o=n.hash();for(let c=0;c<t.length;c++){const u=t[c];Me(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=yr(e,u.path);r=r.updateChild(d,u.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;s.server_.put(l.toString(),a,c=>{M2(s,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let g=0;g<t.length;g++)t[g].status=2,u=u.concat(Wf(s.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&d.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();P2(s,DP(s.transactionQueueTree_,e)),AP(s,s.transactionQueueTree_),jl(s.eventQueue_,e,u);for(let g=0;g<d.length;g++)D1(d[g])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{ro("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}O2(s,e)}},o)}function O2(s,e){const t=FK(s,e),i=Cv(t),n=BK(s,t);return ece(s,n,i),i}function ece(s,e,t){if(e.length===0)return;const i=[];let n=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=yr(t,l.path);let u=!1,d;if(Me(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,n=n.concat(Wf(s.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Vle)u=!0,d="maxretry",n=n.concat(Wf(s.serverSyncTree_,l.currentWriteId,!0));else{const g=PK(s,l.path,o);l.currentInputSnapshot=g;const p=e[a].update(g.val());if(p!==void 0){A2("transaction failed: Data returned ",p,l.path);let _=Rn(p);typeof p=="object"&&p!=null&&nc(p,".priority")||(_=_.updatePriority(g.getPriority()));const v=l.currentWriteId,x=IP(s),S=kK(_,g,x);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=S,l.currentWriteId=OK(s),o.splice(o.indexOf(v),1),n=n.concat(vK(s.serverSyncTree_,l.path,S,l.currentWriteId,l.applyLocally)),n=n.concat(Wf(s.serverSyncTree_,v,!0))}else u=!0,d="nodata",n=n.concat(Wf(s.serverSyncTree_,l.currentWriteId,!0))}jl(s.eventQueue_,t,n),n=[],u&&(e[a].status=2,(function(g){setTimeout(g,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}P2(s,s.transactionQueueTree_);for(let a=0;a<i.length;a++)D1(i[a]);AP(s,s.transactionQueueTree_)}function FK(s,e){let t,i=s.transactionQueueTree_;for(t=Mt(e);t!==null&&N1(i)===void 0;)i=DP(i,t),e=Pi(e),t=Mt(e);return i}function BK(s,e){const t=[];return VK(s,e,t),t.sort((i,n)=>i.order-n.order),t}function VK(s,e,t){const i=N1(e);if(i)for(let n=0;n<i.length;n++)t.push(i[n]);R2(e,n=>{VK(s,n,t)})}function P2(s,e){const t=N1(e);if(t){let i=0;for(let n=0;n<t.length;n++)t[n].status!==2&&(t[i]=t[n],i++);t.length=i,EK(e,t.length>0?t:void 0)}R2(e,i=>{P2(s,i)})}function WK(s,e){const t=Cv(FK(s,e)),i=DP(s.transactionQueueTree_,e);return kle(i,n=>{xI(s,n)}),xI(s,i),TK(i,n=>{xI(s,n)}),t}function xI(s,e){const t=N1(e);if(t){const i=[];let n=[],r=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(Me(r===o-1,"All SENT items should be at beginning of queue."),r=o,t[o].status=3,t[o].abortReason="set"):(Me(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),n=n.concat(Wf(s.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?EK(e,void 0):t.length=r+1,jl(s.eventQueue_,Cv(e),n);for(let o=0;o<i.length;o++)D1(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tce(s){let e="";const t=s.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let n=t[i];try{n=decodeURIComponent(n.replace(/\+/g," "))}catch{}e+="/"+n}return e}function ice(s){const e={};s.charAt(0)==="?"&&(s=s.substring(1));for(const t of s.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ro(`Invalid query segment '${t}' in query '${s}'`)}return e}const RW=function(s,e){const t=nce(s),i=t.namespace;t.domain==="firebase.com"&&Ih(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Ih("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||hoe();const n=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new UG(t.host,t.secure,i,n,e,"",i!==t.subdomain),path:new yi(t.pathString)}},nce=function(s){let e="",t="",i="",n="",r="",o=!0,a="https",l=443;if(typeof s=="string"){let c=s.indexOf("//");c>=0&&(a=s.substring(0,c-1),s=s.substring(c+2));let u=s.indexOf("/");u===-1&&(u=s.length);let d=s.indexOf("?");d===-1&&(d=s.length),e=s.substring(0,Math.min(u,d)),u<d&&(n=tce(s.substring(u,d)));const g=ice(s.substring(Math.min(s.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{const _=e.indexOf(".");i=e.substring(0,_).toLowerCase(),t=e.substring(_+1),r=i}"ns"in g&&(r=g.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:n,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sce{constructor(e,t,i,n){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=n}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ss(this.snapshot.exportVal())}}class rce{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HK{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Me(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oce{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new rh;return Gle(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Mp("OnDisconnect.remove",this._path);const e=new rh;return IW(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Mp("OnDisconnect.set",this._path),RA("OnDisconnect.set",e,this._path);const t=new rh;return IW(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Mp("OnDisconnect.setWithPriority",this._path),RA("OnDisconnect.setWithPriority",e,this._path),Ale("OnDisconnect.setWithPriority",t);const i=new rh;return Kle(this._repo,this._path,e,t,i.wrapCallback(()=>{})),i.promise}update(e){Mp("OnDisconnect.update",this._path),Rle("OnDisconnect.update",e,this._path);const t=new rh;return Yle(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e,t,i,n){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=n}get key(){return Ot(this._path)?null:lP(this._path)}get ref(){return new Oh(this._repo,this._path)}get _queryIdentifier(){const e=pW(this._queryParams),t=sP(e);return t==="{}"?"default":t}get _queryObject(){return pW(this._queryParams)}isEqual(e){if(e=Zg(e),!(e instanceof MP))return!1;const t=this._repo===e._repo,i=cP(this._path,e._path),n=this._queryIdentifier===e._queryIdentifier;return t&&i&&n}toJSON(){return this.toString()}toString(){return this._repo.toString()+Goe(this._path)}}class Oh extends MP{constructor(e,t){super(e,t,new fP,!1)}get parent(){const e=ZG(this._path);return e===null?null:new Oh(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class QC{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new yi(e),i=AA(this.ref,e);return new QC(this._node.getChild(t),i,un)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,n)=>e(new QC(n,AA(this.ref,i),un)))}hasChild(e){const t=new yi(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function bn(s,e){return s=Zg(s),s._checkNotDeleted("ref"),e!==void 0?AA(s._root,e):s._root}function AA(s,e){return s=Zg(s),Mt(s._path)===null?Mle("child","path",e):RK("child","path",e),new Oh(s._repo,Mn(s._path,e))}function ace(s){return s=Zg(s),new oce(s._repo,s._path)}function AW(s){return Mp("remove",s._path),jr(s,null)}function jr(s,e){s=Zg(s),Mp("set",s._path),RA("set",e,s._path);const t=new rh;return $le(s._repo,s._path,e,null,t.wrapCallback(()=>{})),t.promise}function MW(s){s=Zg(s);const e=new HK(()=>{}),t=new F2(e);return jle(s._repo,s,t).then(i=>new QC(i,new Oh(s._repo,s._path),s._queryParams.getIndex()))}class F2{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new sce("value",this,new QC(e.snapshotNode,new Oh(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new rce(this,e,t):null}matches(e){return e instanceof F2?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function lce(s,e,t,i,n){const r=new HK(t,void 0),o=new F2(r);return Qle(s._repo,s,o),()=>Xle(s._repo,s,o)}function LL(s,e,t,i){return lce(s,"value",e)}sle(Oh);cle(Oh);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cce="FIREBASE_DATABASE_EMULATOR_HOST",MA={};let hce=!1;function uce(s,e,t,i){const n=e.lastIndexOf(":"),r=e.substring(0,n),o=iP(r);s.repoInfo_=new UG(e,o,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(s.authTokenProvider_=i)}function dce(s,e,t,i,n){let r=i||s.options.databaseURL;r===void 0&&(s.options.projectId||Ih("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ps("Using default host for project ",s.options.projectId),r=`${s.options.projectId}-default-rtdb.firebaseio.com`);let o=RW(r,n),a=o.repoInfo,l;typeof process<"u"&&ZV&&(l=ZV[cce]),l?(r=`http://${l}?ns=${a.namespace}`,o=RW(r,n),a=o.repoInfo):o.repoInfo.secure;const c=new voe(s.name,s.options,e);Ole("Invalid Firebase Database URL",o),Ot(o.path)||Ih("Database URL must point to the root of a Firebase Database (not including a child path).");const u=gce(a,s,c,new woe(s,t));return new mce(u,s)}function fce(s,e){const t=MA[e];(!t||t[s.key]!==s)&&Ih(`Database ${e}(${s.repoInfo_}) has already been deleted.`),Zle(s),delete t[s.key]}function gce(s,e,t,i){let n=MA[e.name];n||(n={},MA[e.name]=n);let r=n[s.toURLString()];return r&&Ih("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Wle(s,hce,t,i),n[s.toURLString()]=r,r}class mce{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Hle(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Oh(this._repo,hi())),this._rootInternal}_delete(){return this._rootInternal!==null&&(fce(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ih("Cannot call "+e+" on a deleted database.")}}function pce(s=Gre(),e){const t=zre(s,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=Ese("database");i&&_ce(t,...i)}return t}function _ce(s,e,t,i={}){s=Zg(s),s._checkNotDeleted("useEmulator");const n=`${e}:${t}`,r=s._repoInternal;if(s._instanceStarted){if(n===s._repoInternal.repoInfo_.host&&cL(i,r.repoInfo_.emulatorOptions))return;Ih("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Ih('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Dx(Dx.OWNER);else if(i.mockUserToken){const a=typeof i.mockUserToken=="string"?i.mockUserToken:Tse(i.mockUserToken,s.app.options.projectId);o=new Dx(a)}iP(e)&&(Dse(e),Rse("Database",!0)),uce(r,n,i,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bce(s){soe(qre),uL(new WC("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return dce(i,n,r,t)},"PUBLIC").setMultipleInstances(!0)),f_(JV,eW,s),f_(JV,eW,"esm2020")}vh.prototype.simpleListen=function(s,e){this.sendRequest("q",{p:s},e)};vh.prototype.echo=function(s,e){this.sendRequest("echo",{d:s},e)};bce();var Cce="firebase",wce="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */f_(Cce,wce,"app");const OA={apiKey:"AIzaSyAfOvMVTMhUsz9hMGKK-O_mzTOwJ_M8bBU",authDomain:"python-tutoring.firebaseapp.com",projectId:"python-tutoring",storageBucket:"python-tutoring.firebasestorage.app",messagingSenderId:"425234567508",appId:"1:425234567508:web:e416a082b7701320ec78c1",databaseURL:"https://python-tutoring-default-rtdb.firebaseio.com"},vce=OA.apiKey&&OA.apiKey!=="YOUR_API_KEY";let kt;if(vce)try{const s=kG(OA);kt=pce(s)}catch(s){console.warn("Firebase initialization failed:",s),kt=null}else console.warn("Firebase config missing. Using local-only mode."),kt=null;const yce=({chapters:s,currentChapterId:e,onSelectChapter:t,unlockedMap:i,enforceLocksForStudent:n=!0})=>{const[r,o]=_e.useState(null),[a,l]=_e.useState(!1),c=Object.values(i).filter(Boolean).length,u=Math.round(c/s.length*100);return z.jsxs(z.Fragment,{children:[z.jsxs("div",{className:"w-14 bg-[#252526] text-slate-400 flex flex-col items-center py-4 border-r border-[#3c3c3c] relative z-30",children:[z.jsx("div",{className:"mb-6 w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-xl text-white shadow-lg cursor-pointer hover:scale-105 transition-transform",title:"Python Tutoring",children:""}),z.jsxs("button",{onClick:()=>l(!a),className:`w-10 h-10 rounded-lg flex items-center justify-center mb-2 transition-all relative ${a?"bg-blue-600 text-white":"hover:bg-[#3c3c3c] hover:text-white"}`,title:"Chapters",children:[z.jsx("span",{className:"text-xl",children:""}),z.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[z.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#3c3c3c",strokeWidth:"2"}),z.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#22c55e",strokeWidth:"2",strokeDasharray:`${u} 100`,strokeLinecap:"round",className:"transition-all duration-500"})]})]}),z.jsx("div",{className:"flex-1"}),z.jsx("button",{className:"w-10 h-10 rounded-lg flex items-center justify-center hover:bg-[#3c3c3c] hover:text-white transition-all",title:"Settings",children:z.jsx("span",{className:"text-xl",children:""})}),z.jsx("button",{className:"w-10 h-10 rounded-lg flex items-center justify-center hover:bg-[#3c3c3c] hover:text-white transition-all",title:"Keyboard Shortcuts: Ctrl+Enter to Run",children:z.jsx("span",{className:"text-xl",children:""})})]}),a&&z.jsxs(z.Fragment,{children:[z.jsx("div",{className:"fixed inset-0 bg-black/40 z-20",onClick:()=>l(!1)}),z.jsxs("div",{className:"fixed left-14 top-0 h-full w-80 bg-[#1e1e1e] shadow-2xl border-r border-[#3c3c3c] z-30 animate-slide-in overflow-hidden flex flex-col",children:[z.jsxs("div",{className:"p-5 border-b border-[#3c3c3c] bg-[#252526]",children:[z.jsxs("div",{className:"flex items-center justify-between mb-3",children:[z.jsx("h3",{className:"font-bold text-white text-lg",children:"Curriculum"}),z.jsx("button",{onClick:()=>l(!1),className:"text-slate-500 hover:text-white transition-colors",children:""})]}),z.jsxs("div",{className:"flex items-center gap-3",children:[z.jsx("div",{className:"flex-1 h-2 bg-[#3c3c3c] rounded-full overflow-hidden",children:z.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-green-400 rounded-full transition-all duration-500",style:{width:`${u}%`}})}),z.jsxs("span",{className:"text-xs text-slate-400 font-mono",children:[u,"%"]})]})]}),z.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:s.map((d,g)=>{const p=i[d.id],_=e===d.id,C=!p&&n,v=r===d.id;return z.jsxs("button",{onClick:()=>{if(C){o(d.id),setTimeout(()=>o(null),1500);return}t(d.id),l(!1)},className:`w-full text-left p-4 rounded-xl mb-2 transition-all flex items-start gap-3 group ${_?"bg-blue-600/20 border border-blue-500/30":v?"bg-red-600/20 border border-red-500/50 animate-shake":C?"opacity-60 cursor-not-allowed border border-transparent":"hover:bg-[#2a2a2a] border border-transparent"}`,children:[z.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold flex-shrink-0 ${_?"bg-blue-600 text-white":p?"bg-emerald-600/20 text-emerald-400 border border-emerald-500/30":"bg-[#3c3c3c] text-slate-500"}`,children:p?g+1:""}),z.jsxs("div",{className:"flex-1 min-w-0",children:[z.jsx("div",{className:`font-medium truncate text-sm ${_?"text-white":"text-slate-300"}`,children:d.title}),z.jsxs("div",{className:"text-xs text-slate-500 truncate mt-0.5",children:[d.challenges.length," challenges"]})]}),p&&!_&&z.jsx("span",{className:"text-emerald-500 text-sm",children:""}),v&&z.jsx("span",{className:"text-red-400 text-xs animate-pulse",children:"Locked by teacher"})]},d.id)})}),z.jsx("div",{className:"p-4 border-t border-[#3c3c3c] bg-[#252526]",children:z.jsx("div",{className:"text-xs text-slate-500 text-center",children:"Mr. Stewart's Python Tutoring"})})]})]}),z.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateX(-100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        .animate-slide-in {
          animation: slide-in 0.2s ease-out;
        }
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          20%, 60% { transform: translateX(-4px); }
          40%, 80% { transform: translateX(4px); }
        }
        .animate-shake {
          animation: shake 0.3s ease-out;
        }
      `})]})};function OW(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,i=Array(e);t<e;t++)i[t]=s[t];return i}function Sce(s){if(Array.isArray(s))return s}function xce(s,e,t){return(e=Ice(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Lce(s,e){var t=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(t!=null){var i,n,r,o,a=[],l=!0,c=!1;try{if(r=(t=t.call(s)).next,e!==0)for(;!(l=(i=r.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,n=u}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function kce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PW(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function FW(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?PW(Object(t),!0).forEach(function(i){xce(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):PW(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function Ece(s,e){if(s==null)return{};var t,i,n=Dce(s,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(n[t]=s[t])}return n}function Dce(s,e){if(s==null)return{};var t={};for(var i in s)if({}.hasOwnProperty.call(s,i)){if(e.indexOf(i)!==-1)continue;t[i]=s[i]}return t}function Tce(s,e){return Sce(s)||Lce(s,e)||Rce(s,e)||kce()}function Nce(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Ice(s){var e=Nce(s,"string");return typeof e=="symbol"?e:e+""}function Rce(s,e){if(s){if(typeof s=="string")return OW(s,e);var t={}.toString.call(s).slice(8,-1);return t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set"?Array.from(s):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?OW(s,e):void 0}}function Ace(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function BW(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function VW(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?BW(Object(t),!0).forEach(function(i){Ace(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):BW(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function Mce(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(i){return e.reduceRight(function(n,r){return r(n)},i)}}function b0(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return n.length>=s.length?s.apply(this,n):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function kL(s){return{}.toString.call(s).includes("Object")}function Oce(s){return!Object.keys(s).length}function XC(s){return typeof s=="function"}function Pce(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function Fce(s,e){return kL(e)||Yu("changeType"),Object.keys(e).some(function(t){return!Pce(s,t)})&&Yu("changeField"),e}function Bce(s){XC(s)||Yu("selectorType")}function Vce(s){XC(s)||kL(s)||Yu("handlerType"),kL(s)&&Object.values(s).some(function(e){return!XC(e)})&&Yu("handlersType")}function Wce(s){s||Yu("initialIsRequired"),kL(s)||Yu("initialType"),Oce(s)&&Yu("initialContent")}function Hce(s,e){throw new Error(s[e]||s.default)}var zce={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Yu=b0(Hce)(zce),LS={changes:Fce,selector:Bce,handler:Vce,initial:Wce};function Uce(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};LS.initial(s),LS.handler(e);var t={current:s},i=b0(qce)(t,e),n=b0($ce)(t),r=b0(LS.changes)(s),o=b0(jce)(t);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return LS.selector(c),c(t.current)}function l(c){Mce(i,n,r,o)(c)}return[a,l]}function jce(s,e){return XC(e)?e(s.current):e}function $ce(s,e){return s.current=VW(VW({},s.current),e),e}function qce(s,e,t){return XC(e)?e(s.current):Object.keys(t).forEach(function(i){var n;return(n=e[i])===null||n===void 0?void 0:n.call(e,s.current[i])}),t}var Gce={create:Uce},Kce={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function Yce(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return n.length>=s.length?s.apply(this,n):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function Qce(s){return{}.toString.call(s).includes("Object")}function Xce(s){return s||WW("configIsRequired"),Qce(s)||WW("configType"),s.urls?(Zce(),{paths:{vs:s.urls.monacoBase}}):s}function Zce(){console.warn(zK.deprecation)}function Jce(s,e){throw new Error(s[e]||s.default)}var zK={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},WW=Yce(Jce)(zK),ehe={config:Xce},the=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduceRight(function(r,o){return o(r)},n)}};function UK(s,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&s[t]&&Object.assign(e[t],UK(s[t],e[t]))}),FW(FW({},s),e)}var ihe={type:"cancelation",msg:"operation is manually canceled"};function LI(s){var e=!1,t=new Promise(function(i,n){s.then(function(r){return e?n(ihe):i(r)}),s.catch(n)});return t.cancel=function(){return e=!0},t}var nhe=["monaco"],she=Gce.create({config:Kce,isInitialized:!1,resolve:null,reject:null,monaco:null}),jK=Tce(she,2),wv=jK[0],B2=jK[1];function rhe(s){var e=ehe.config(s),t=e.monaco,i=Ece(e,nhe);B2(function(n){return{config:UK(n.config,i),monaco:t}})}function ohe(){var s=wv(function(e){var t=e.monaco,i=e.isInitialized,n=e.resolve;return{monaco:t,isInitialized:i,resolve:n}});if(!s.isInitialized){if(B2({isInitialized:!0}),s.monaco)return s.resolve(s.monaco),LI(kI);if(window.monaco&&window.monaco.editor)return $K(window.monaco),s.resolve(window.monaco),LI(kI);the(ahe,che)(hhe)}return LI(kI)}function ahe(s){return document.body.appendChild(s)}function lhe(s){var e=document.createElement("script");return s&&(e.src=s),e}function che(s){var e=wv(function(i){var n=i.config,r=i.reject;return{config:n,reject:r}}),t=lhe("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return s()},t.onerror=e.reject,t}function hhe(){var s=wv(function(t){var i=t.config,n=t.resolve,r=t.reject;return{config:i,resolve:n,reject:r}}),e=window.require;e.config(s.config),e(["vs/editor/editor.main"],function(t){var i=t.m||t;$K(i),s.resolve(i)},function(t){s.reject(t)})}function $K(s){wv().monaco||B2({monaco:s})}function uhe(){return wv(function(s){var e=s.monaco;return e})}var kI=new Promise(function(s,e){return B2({resolve:s,reject:e})}),qK={config:rhe,init:ohe,__getMonacoInstance:uhe},dhe={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},EI=dhe,fhe={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},ghe=fhe;function mhe({children:s}){return ju.createElement("div",{style:ghe.container},s)}var phe=mhe,_he=phe;function bhe({width:s,height:e,isEditorReady:t,loading:i,_ref:n,className:r,wrapperProps:o}){return ju.createElement("section",{style:{...EI.wrapper,width:s,height:e},...o},!t&&ju.createElement(_he,null,i),ju.createElement("div",{ref:n,style:{...EI.fullWidth,...!t&&EI.hide},className:r}))}var Che=bhe,GK=_e.memo(Che);function whe(s){_e.useEffect(s,[])}var KK=whe;function vhe(s,e,t=!0){let i=_e.useRef(!0);_e.useEffect(i.current||!t?()=>{i.current=!1}:s,e)}var Eo=vhe;function P0(){}function Op(s,e,t,i){return yhe(s,i)||She(s,e,t,i)}function yhe(s,e){return s.editor.getModel(YK(s,e))}function She(s,e,t,i){return s.editor.createModel(e,t,i?YK(s,i):void 0)}function YK(s,e){return s.Uri.parse(e)}function xhe({original:s,modified:e,language:t,originalLanguage:i,modifiedLanguage:n,originalModelPath:r,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:u="Loading...",options:d={},height:g="100%",width:p="100%",className:_,wrapperProps:C={},beforeMount:v=P0,onMount:x=P0}){let[S,k]=_e.useState(!1),[E,T]=_e.useState(!0),R=_e.useRef(null),N=_e.useRef(null),A=_e.useRef(null),O=_e.useRef(x),W=_e.useRef(v),j=_e.useRef(!1);KK(()=>{let K=qK.init();return K.then(U=>(N.current=U)&&T(!1)).catch(U=>(U==null?void 0:U.type)!=="cancelation"&&console.error("Monaco initialization: error:",U)),()=>R.current?Z():K.cancel()}),Eo(()=>{if(R.current&&N.current){let K=R.current.getOriginalEditor(),U=Op(N.current,s||"",i||t||"text",r||"");U!==K.getModel()&&K.setModel(U)}},[r],S),Eo(()=>{if(R.current&&N.current){let K=R.current.getModifiedEditor(),U=Op(N.current,e||"",n||t||"text",o||"");U!==K.getModel()&&K.setModel(U)}},[o],S),Eo(()=>{let K=R.current.getModifiedEditor();K.getOption(N.current.editor.EditorOption.readOnly)?K.setValue(e||""):e!==K.getValue()&&(K.executeEdits("",[{range:K.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),K.pushUndoStop())},[e],S),Eo(()=>{var K,U;(U=(K=R.current)==null?void 0:K.getModel())==null||U.original.setValue(s||"")},[s],S),Eo(()=>{let{original:K,modified:U}=R.current.getModel();N.current.editor.setModelLanguage(K,i||t||"text"),N.current.editor.setModelLanguage(U,n||t||"text")},[t,i,n],S),Eo(()=>{var K;(K=N.current)==null||K.editor.setTheme(c)},[c],S),Eo(()=>{var K;(K=R.current)==null||K.updateOptions(d)},[d],S);let F=_e.useCallback(()=>{var G;if(!N.current)return;W.current(N.current);let K=Op(N.current,s||"",i||t||"text",r||""),U=Op(N.current,e||"",n||t||"text",o||"");(G=R.current)==null||G.setModel({original:K,modified:U})},[t,e,n,s,i,r,o]),q=_e.useCallback(()=>{var K;!j.current&&A.current&&(R.current=N.current.editor.createDiffEditor(A.current,{automaticLayout:!0,...d}),F(),(K=N.current)==null||K.editor.setTheme(c),k(!0),j.current=!0)},[d,c,F]);_e.useEffect(()=>{S&&O.current(R.current,N.current)},[S]),_e.useEffect(()=>{!E&&!S&&q()},[E,S,q]);function Z(){var U,G,Q,le;let K=(U=R.current)==null?void 0:U.getModel();a||((G=K==null?void 0:K.original)==null||G.dispose()),l||((Q=K==null?void 0:K.modified)==null||Q.dispose()),(le=R.current)==null||le.dispose()}return ju.createElement(GK,{width:p,height:g,isEditorReady:S,loading:u,_ref:A,className:_,wrapperProps:C})}var Lhe=xhe;_e.memo(Lhe);function khe(s){let e=_e.useRef();return _e.useEffect(()=>{e.current=s},[s]),e.current}var Ehe=khe,kS=new Map;function Dhe({defaultValue:s,defaultLanguage:e,defaultPath:t,value:i,language:n,path:r,theme:o="light",line:a,loading:l="Loading...",options:c={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:g=!1,width:p="100%",height:_="100%",className:C,wrapperProps:v={},beforeMount:x=P0,onMount:S=P0,onChange:k,onValidate:E=P0}){let[T,R]=_e.useState(!1),[N,A]=_e.useState(!0),O=_e.useRef(null),W=_e.useRef(null),j=_e.useRef(null),F=_e.useRef(S),q=_e.useRef(x),Z=_e.useRef(),K=_e.useRef(i),U=Ehe(r),G=_e.useRef(!1),Q=_e.useRef(!1);KK(()=>{let V=qK.init();return V.then(ce=>(O.current=ce)&&A(!1)).catch(ce=>(ce==null?void 0:ce.type)!=="cancelation"&&console.error("Monaco initialization: error:",ce)),()=>W.current?ve():V.cancel()}),Eo(()=>{var ce,oe,Se,me;let V=Op(O.current,s||i||"",e||n||"",r||t||"");V!==((ce=W.current)==null?void 0:ce.getModel())&&(d&&kS.set(U,(oe=W.current)==null?void 0:oe.saveViewState()),(Se=W.current)==null||Se.setModel(V),d&&((me=W.current)==null||me.restoreViewState(kS.get(r))))},[r],T),Eo(()=>{var V;(V=W.current)==null||V.updateOptions(c)},[c],T),Eo(()=>{!W.current||i===void 0||(W.current.getOption(O.current.editor.EditorOption.readOnly)?W.current.setValue(i):i!==W.current.getValue()&&(Q.current=!0,W.current.executeEdits("",[{range:W.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),W.current.pushUndoStop(),Q.current=!1))},[i],T),Eo(()=>{var ce,oe;let V=(ce=W.current)==null?void 0:ce.getModel();V&&n&&((oe=O.current)==null||oe.editor.setModelLanguage(V,n))},[n],T),Eo(()=>{var V;a!==void 0&&((V=W.current)==null||V.revealLine(a))},[a],T),Eo(()=>{var V;(V=O.current)==null||V.editor.setTheme(o)},[o],T);let le=_e.useCallback(()=>{var V;if(!(!j.current||!O.current)&&!G.current){q.current(O.current);let ce=r||t,oe=Op(O.current,i||s||"",e||n||"",ce||"");W.current=(V=O.current)==null?void 0:V.editor.create(j.current,{model:oe,automaticLayout:!0,...c},u),d&&W.current.restoreViewState(kS.get(ce)),O.current.editor.setTheme(o),a!==void 0&&W.current.revealLine(a),R(!0),G.current=!0}},[s,e,t,i,n,r,c,u,d,o,a]);_e.useEffect(()=>{T&&F.current(W.current,O.current)},[T]),_e.useEffect(()=>{!N&&!T&&le()},[N,T,le]),K.current=i,_e.useEffect(()=>{var V,ce;T&&k&&((V=Z.current)==null||V.dispose(),Z.current=(ce=W.current)==null?void 0:ce.onDidChangeModelContent(oe=>{Q.current||k(W.current.getValue(),oe)}))},[T,k]),_e.useEffect(()=>{if(T){let V=O.current.editor.onDidChangeMarkers(ce=>{var Se;let oe=(Se=W.current.getModel())==null?void 0:Se.uri;if(oe&&ce.find(me=>me.path===oe.path)){let me=O.current.editor.getModelMarkers({resource:oe});E==null||E(me)}});return()=>{V==null||V.dispose()}}return()=>{}},[T,E]);function ve(){var V,ce;(V=Z.current)==null||V.dispose(),g?d&&kS.set(r,W.current.saveViewState()):(ce=W.current.getModel())==null||ce.dispose(),W.current.dispose()}return ju.createElement(GK,{width:p,height:_,isEditorReady:T,loading:l,_ref:j,className:C,wrapperProps:v})}var The=Dhe,Nhe=_e.memo(The),Ihe=Nhe;const QK=_e.createContext(void 0),OP=()=>{const s=_e.useContext(QK);if(!s)throw new Error("usePython must be used within a PythonProvider");return s},Rhe=({children:s})=>{const[e,t]=_e.useState(null),[i,n]=_e.useState(!0),[r,o]=_e.useState(!1),[a,l]=_e.useState("Initializing Python environment..."),[c,u]=_e.useState([]),[d,g]=_e.useState(!1),[p,_]=_e.useState(null),C=_e.useRef([]);_e.useEffect(()=>{const k=setInterval(()=>{C.current.length>0&&(u(E=>[...E,...C.current]),C.current=[])},50);return()=>clearInterval(k)},[]),_e.useEffect(()=>{(async()=>{try{if(l("Downloading Pyodide (Python 3.11)..."),!window.loadPyodide){const T=document.createElement("script");T.src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js",T.async=!0,document.body.appendChild(T),await new Promise(R=>{T.onload=R})}l("Instantiating WebAssembly...");const E=await window.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.25.0/full/"});E.setStdout({batched:T=>{if(T.startsWith("__TEST_RESULTS__:"))try{const R=T.replace("__TEST_RESULTS__:",""),N=JSON.parse(R);_(N)}catch(R){console.error("Failed to parse test results",R)}else C.current.push(T)}}),E.setStderr({batched:T=>C.current.push(`Error: ${T}`)}),l("Loading standard libraries..."),t(E),o(!0),l("System Ready.")}catch(E){console.error("Failed to load Pyodide:",E),l("Failed to load Python engine. Please refresh.")}finally{n(!1)}})()},[]);const v=_e.useCallback(async(k,E)=>{if(e){g(!0),_(null);try{await new Promise(R=>setTimeout(R,10));let T=k;if(E&&E.length>0){const R=`
import json
import traceback

def __run_tests():
    test_cases = ${JSON.stringify(E)}
    results = []

    for case in test_cases:
        try:
            expected = eval(case['expected']) # Evaluate string "4" to int 4

            # Capture return value
            actual = eval(case['input'])

            passed = actual == expected
            results.append({
                "input": case['input'],
                "expected": str(expected),
                "actual": str(actual),
                "passed": passed
            })
        except Exception as e:
            results.append({
                "input": case['input'],
                "expected": case['expected'],
                "actual": "Error",
                "passed": False,
                "error": str(e)
            })

    print("__TEST_RESULTS__:" + json.dumps(results))

__run_tests()
`;T=k+`
`+R}await e.runPythonAsync(T)}catch(T){C.current.push(T.toString())}finally{g(!1)}}},[e]),x=_e.useCallback(()=>{u([]),C.current=[],_(null)},[]),S=ju.useMemo(()=>({isLoading:i,isReady:r,loadingMessage:a,runCode:v,output:c,clearOutput:x,isRunning:d,testResults:p}),[i,r,a,v,c,x,d,p]);return z.jsx(QK.Provider,{value:S,children:s})},Ahe=()=>{const{output:s,isRunning:e,clearOutput:t,testResults:i}=OP(),n=_e.useRef(null),[r,o]=_e.useState("terminal");_e.useEffect(()=>{i&&o("tests")},[i]),_e.useEffect(()=>{var d;r==="terminal"&&((d=n.current)==null||d.scrollIntoView({behavior:"smooth"}))},[s,r]);const a=d=>d.startsWith("Error:")||d.includes("Traceback")?"text-red-400":d.startsWith(">>>")?"text-blue-400":"text-slate-200",l=(i==null?void 0:i.filter(d=>d.passed).length)||0,c=(i==null?void 0:i.length)||0,u=c>0&&l===c;return z.jsxs("div",{className:"flex flex-col h-full bg-[#0d0d0d] font-mono text-sm",children:[z.jsxs("div",{className:"flex items-center bg-[#1a1a1a] border-b border-[#2a2a2a]",children:[z.jsx("button",{onClick:()=>o("terminal"),className:`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${r==="terminal"?"text-white border-b-2 border-blue-500 bg-[#252526]":"text-slate-500 hover:text-slate-300"}`,children:"Terminal"}),z.jsxs("button",{onClick:()=>o("tests"),className:`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors flex items-center gap-2 ${r==="tests"?"text-white border-b-2 border-emerald-500 bg-[#252526]":"text-slate-500 hover:text-slate-300"}`,children:["Test Cases",i&&z.jsxs("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] ${u?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:[l,"/",c]})]}),z.jsx("div",{className:"flex-1"}),z.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e&&z.jsx("span",{className:"text-xs text-blue-400 animate-pulse",children:"Running..."}),z.jsx("button",{onClick:t,className:"text-xs text-slate-500 hover:text-white px-2 py-1",children:"Clear"})]})]}),z.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:r==="terminal"?z.jsxs("div",{className:"space-y-0.5",children:[s.length===0&&!e&&z.jsx("div",{className:"text-slate-600 italic text-xs",children:"Output will appear here..."}),s.map((d,g)=>z.jsx("div",{className:`${a(d)} whitespace-pre-wrap break-all`,children:d},g)),z.jsx("div",{ref:n})]}):z.jsx("div",{className:"space-y-3",children:i?z.jsxs(z.Fragment,{children:[z.jsxs("div",{className:`p-3 rounded-lg border ${u?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[z.jsx("div",{className:"font-bold text-sm mb-1",children:u?" All Tests Passed!":" Some Tests Failed"}),z.jsxs("div",{className:"text-xs opacity-80",children:["You passed ",l," out of ",c," tests."]})]}),i.map((d,g)=>z.jsxs("div",{className:`p-3 rounded bg-[#1e1e1e] border ${d.passed?"border-emerald-500/20":"border-red-500/20"}`,children:[z.jsxs("div",{className:"flex items-center justify-between mb-2",children:[z.jsxs("span",{className:"font-mono text-xs text-slate-400",children:["Test Case ",g+1]}),z.jsx("span",{className:d.passed?"text-emerald-500":"text-red-500",children:d.passed?"PASSED":"FAILED"})]}),z.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-4 gap-y-1 text-xs font-mono",children:[z.jsx("div",{className:"text-slate-500 text-right",children:"Input:"}),z.jsx("div",{className:"text-slate-300",children:d.input}),z.jsx("div",{className:"text-slate-500 text-right",children:"Expected:"}),z.jsx("div",{className:"text-emerald-400/80",children:d.expected}),z.jsx("div",{className:"text-slate-500 text-right",children:"Actual:"}),z.jsx("div",{className:`${d.passed?"text-emerald-400/80":"text-red-400"}`,children:d.actual}),d.error&&z.jsxs(z.Fragment,{children:[z.jsx("div",{className:"text-red-500 text-right",children:"Error:"}),z.jsx("div",{className:"text-red-400",children:d.error})]})]})]},g))]}):z.jsx("div",{className:"text-slate-600 italic text-xs",children:"Run code to see test results..."})})})]})},XK="python_tutoring_sessions",HW=()=>{const s="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="";for(let t=0;t<6;t++)e+=s.charAt(Math.floor(Math.random()*s.length));return e},Mhe=()=>"user_"+Math.random().toString(36).substring(2,11),ZK=_e.createContext(void 0),JK=()=>{const s=_e.useContext(ZK);if(!s)throw new Error("useSession must be used within a SessionProvider");return s},Ohe=()=>{const s=localStorage.getItem("python_tutoring_participant_id");if(s)return s;const e=Mhe();return localStorage.setItem("python_tutoring_participant_id",e),e},PP=()=>{try{const s=localStorage.getItem(XK);return s?JSON.parse(s):{}}catch{return{}}},eY=s=>{try{localStorage.setItem(XK,JSON.stringify(s))}catch(e){console.error("[Session] Failed to save sessions:",e)}},hl=s=>PP()[s]||null,ul=(s,e)=>{const t=PP();t[s]=e,eY(t)},Phe=s=>{const e=PP();delete e[s],eY(e)},Fhe=({children:s})=>{const[e,t]=_e.useState(null),[i,n]=_e.useState(!1),[r]=_e.useState(Ohe),[o,a]=_e.useState({}),[l,c]=_e.useState(null),[u,d]=_e.useState([]),[g,p]=_e.useState(null),[_,C]=_e.useState({}),[v,x]=_e.useState(!1),[S,k]=_e.useState(""),E=_e.useRef(null),T=e!==null;_e.useEffect(()=>{if(!e)return;if(kt){const Q=bn(kt,`sessions/${e}`),le=LL(Q,ve=>{const V=ve.val();V?(a(V.participants||{}),C(V.unlockedChapters||{}),i&&V.studentCode&&c(V.studentCode),i&&V.studentOutput&&d(V.studentOutput),V.activeChallenge&&p(V.activeChallenge),V.playgroundMode!==void 0&&x(V.playgroundMode),V.playgroundCode!==void 0&&k(V.playgroundCode)):(t(null),n(!1),a({}),C({}))});return()=>le()}const G=()=>{const Q=hl(e);Q?(a(Q.participants||{}),C(Q.unlockedChapters||{}),i&&Q.studentCode&&c(Q.studentCode),i&&Q.studentOutput&&d(Q.studentOutput),Q.activeChallenge&&p(Q.activeChallenge),Q.playgroundMode!==void 0&&x(Q.playgroundMode),Q.playgroundCode!==void 0&&k(Q.playgroundCode)):i||(console.log("[Session] Session ended by teacher"),t(null),a({}),C({}),p(null))};return G(),E.current=window.setInterval(G,500),()=>{E.current&&clearInterval(E.current)}},[e,i]);const R=_e.useCallback(async()=>{const G=HW(),Q={createdAt:Date.now(),teacherId:r,participants:{[r]:{role:"teacher",joinedAt:Date.now()}},unlockedChapters:{"ch1-intro":!0,"ch2-variables":!0,"ch3-math":!0}};if(kt)try{let le=G,ve=0;for(;ve<10&&(await MW(bn(kt,`sessions/${le}`))).exists();)le=HW(),ve++;return await jr(bn(kt,`sessions/${le}`),Q),t(le),n(!0),C(Q.unlockedChapters),console.log("[Session] Created Firebase session:",le),le}catch(le){console.error("[Session] Firebase error:",le)}return ul(G,Q),t(G),n(!0),C(Q.unlockedChapters),a(Q.participants),console.log("[Session] Created local session:",G),G},[r]),N=_e.useCallback(async G=>{const Q=G.toUpperCase().trim();if(kt)try{const ve=bn(kt,`sessions/${Q}`);if((await MW(ve)).exists())return await jr(bn(kt,`sessions/${Q}/participants/${r}`),{role:"student",joinedAt:Date.now()}),t(Q),n(!1),console.log("[Session] Joined Firebase session:",Q),!0}catch(ve){console.error("[Session] Firebase error:",ve)}const le=hl(Q);return le?(le.participants[r]={role:"student",joinedAt:Date.now()},ul(Q,le),t(Q),n(!1),C(le.unlockedChapters),a(le.participants),console.log("[Session] Joined local session:",Q),!0):(console.log("[Session] Session not found:",Q),!1)},[r]),A=_e.useCallback(async()=>{if(e){if(kt)try{i?await AW(bn(kt,`sessions/${e}`)):await AW(bn(kt,`sessions/${e}/participants/${r}`))}catch(G){console.error("[Session] Firebase error:",G)}if(i)Phe(e);else{const G=hl(e);G&&(delete G.participants[r],ul(e,G))}t(null),n(!1),a({}),c(null),d([]),C({}),console.log("[Session] Left session")}},[e,i,r]),O=_e.useCallback((G,Q,le)=>{if(!e)return;const ve={content:G,chapterId:Q,challengeIndex:le,lastUpdated:Date.now()};if(kt)jr(bn(kt,`sessions/${e}/studentCode`),ve).catch(console.error);else{const V=hl(e);V&&(V.studentCode=ve,ul(e,V))}},[e]),W=_e.useCallback(G=>{if(!(!e||i))if(kt)jr(bn(kt,`sessions/${e}/studentOutput`),G).catch(console.error);else{const Q=hl(e);Q&&(Q.studentOutput=G,ul(e,Q))}},[e,i]),j=_e.useCallback((G,Q)=>{if(!e||!i)return;const le={chapterId:G,challengeIndex:Q};if(kt)jr(bn(kt,`sessions/${e}/activeChallenge`),le).catch(console.error);else{const ve=hl(e);ve&&(ve.activeChallenge=le,ul(e,ve),p(le))}},[e,i]),F=_e.useCallback(G=>{if(!(!e||!i))if(console.log("[Session] Unlocking chapter:",G),kt)jr(bn(kt,`sessions/${e}/unlockedChapters/${G}`),!0).catch(console.error);else{const Q=hl(e);Q&&(Q.unlockedChapters[G]=!0,ul(e,Q),C({...Q.unlockedChapters}))}},[e,i]),q=_e.useCallback(G=>{if(!(!e||!i))if(console.log("[Session] Locking chapter:",G),kt)jr(bn(kt,`sessions/${e}/unlockedChapters/${G}`),!1).catch(console.error);else{const Q=hl(e);Q&&(Q.unlockedChapters[G]=!1,ul(e,Q),C({...Q.unlockedChapters}))}},[e,i]),Z=_e.useCallback(G=>{if(!(!e||!i))if(kt)jr(bn(kt,`sessions/${e}/playgroundMode`),G).catch(console.error);else{const Q=hl(e);Q&&(Q.playgroundMode=G,ul(e,Q),x(G))}},[e,i]),K=_e.useCallback(G=>{if(e)if(kt)jr(bn(kt,`sessions/${e}/playgroundCode`),G).catch(console.error);else{const Q=hl(e);Q&&(Q.playgroundCode=G,ul(e,Q),k(G))}},[e]),U={sessionCode:e,isInSession:T,isTeacher:i,participantId:r,participants:o,createSession:R,joinSession:N,leaveSession:A,syncCode:O,syncOutput:W,activeChallenge:g,setActiveChallenge:j,studentCode:l,studentOutput:u,sessionUnlockedChapters:_,unlockChapter:F,lockChapter:q,playgroundMode:v,playgroundCode:S,setPlaygroundMode:Z,syncPlaygroundCode:K};return z.jsx(ZK.Provider,{value:U,children:s})},ja=()=>new Map,PA=s=>{const e=ja();return s.forEach((t,i)=>{e.set(i,t)}),e},bd=(s,e,t)=>{let i=s.get(e);return i===void 0&&s.set(e,i=t()),i},Bhe=(s,e)=>{const t=[];for(const[i,n]of s)t.push(e(n,i));return t},Vhe=(s,e)=>{for(const[t,i]of s)if(e(i,t))return!0;return!1},J_=()=>new Set,DI=s=>s[s.length-1],Whe=(s,e)=>{for(let t=0;t<e.length;t++)s.push(e[t])},Tg=Array.from,Hhe=Array.isArray;class zhe{constructor(){this._observers=ja()}on(e,t){return bd(this._observers,e,J_).add(t),t}once(e,t){const i=(...n)=>{this.off(e,i),t(...n)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return Tg((this._observers.get(e)||ja()).values()).forEach(i=>i(...t))}destroy(){this._observers=ja()}}const ad=Math.floor,Tx=Math.abs,tY=(s,e)=>s<e?s:e,tm=(s,e)=>s>e?s:e,iY=s=>s!==0?s<0:1/s<0,zW=1,UW=2,TI=4,NI=8,ZC=32,yh=64,Fo=128,V2=31,FA=63,tg=127,Uhe=2147483647,nY=Number.MAX_SAFE_INTEGER,jhe=Number.isInteger||(s=>typeof s=="number"&&isFinite(s)&&ad(s)===s),$he=s=>s.toLowerCase(),qhe=/^\s*/g,Ghe=s=>s.replace(qhe,""),Khe=/([A-Z])/g,jW=(s,e)=>Ghe(s.replace(Khe,t=>`${e}${$he(t)}`)),Yhe=s=>{const e=unescape(encodeURIComponent(s)),t=e.length,i=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e.codePointAt(n);return i},JC=typeof TextEncoder<"u"?new TextEncoder:null,Qhe=s=>JC.encode(s),Xhe=JC?Qhe:Yhe;let F0=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});F0&&F0.decode(new Uint8Array).length===1&&(F0=null);class vv{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const W2=()=>new vv,Zhe=s=>{let e=s.cpos;for(let t=0;t<s.bufs.length;t++)e+=s.bufs[t].length;return e},Ml=s=>{const e=new Uint8Array(Zhe(s));let t=0;for(let i=0;i<s.bufs.length;i++){const n=s.bufs[i];e.set(n,t),t+=n.length}return e.set(new Uint8Array(s.cbuf.buffer,0,s.cpos),t),e},Jhe=(s,e)=>{const t=s.cbuf.length;t-s.cpos<e&&(s.bufs.push(new Uint8Array(s.cbuf.buffer,0,s.cpos)),s.cbuf=new Uint8Array(tm(t,e)*2),s.cpos=0)},_s=(s,e)=>{const t=s.cbuf.length;s.cpos===t&&(s.bufs.push(s.cbuf),s.cbuf=new Uint8Array(t*2),s.cpos=0),s.cbuf[s.cpos++]=e},BA=_s,ri=(s,e)=>{for(;e>tg;)_s(s,Fo|tg&e),e=ad(e/128);_s(s,tg&e)},FP=(s,e)=>{const t=iY(e);for(t&&(e=-e),_s(s,(e>FA?Fo:0)|(t?yh:0)|FA&e),e=ad(e/64);e>0;)_s(s,(e>tg?Fo:0)|tg&e),e=ad(e/128)},VA=new Uint8Array(3e4),eue=VA.length/3,tue=(s,e)=>{if(e.length<eue){const t=JC.encodeInto(e,VA).written||0;ri(s,t);for(let i=0;i<t;i++)_s(s,VA[i])}else xo(s,Xhe(e))},iue=(s,e)=>{const t=unescape(encodeURIComponent(e)),i=t.length;ri(s,i);for(let n=0;n<i;n++)_s(s,t.codePointAt(n))},p_=JC&&JC.encodeInto?tue:iue,H2=(s,e)=>{const t=s.cbuf.length,i=s.cpos,n=tY(t-i,e.length),r=e.length-n;s.cbuf.set(e.subarray(0,n),i),s.cpos+=n,r>0&&(s.bufs.push(s.cbuf),s.cbuf=new Uint8Array(tm(t*2,r)),s.cbuf.set(e.subarray(n)),s.cpos=r)},xo=(s,e)=>{ri(s,e.byteLength),H2(s,e)},BP=(s,e)=>{Jhe(s,e);const t=new DataView(s.cbuf.buffer,s.cpos,e);return s.cpos+=e,t},nue=(s,e)=>BP(s,4).setFloat32(0,e,!1),sue=(s,e)=>BP(s,8).setFloat64(0,e,!1),rue=(s,e)=>BP(s,8).setBigInt64(0,e,!1),$W=new DataView(new ArrayBuffer(4)),oue=s=>($W.setFloat32(0,s),$W.getFloat32(0)===s),ew=(s,e)=>{switch(typeof e){case"string":_s(s,119),p_(s,e);break;case"number":jhe(e)&&Tx(e)<=Uhe?(_s(s,125),FP(s,e)):oue(e)?(_s(s,124),nue(s,e)):(_s(s,123),sue(s,e));break;case"bigint":_s(s,122),rue(s,e);break;case"object":if(e===null)_s(s,126);else if(Hhe(e)){_s(s,117),ri(s,e.length);for(let t=0;t<e.length;t++)ew(s,e[t])}else if(e instanceof Uint8Array)_s(s,116),xo(s,e);else{_s(s,118);const t=Object.keys(e);ri(s,t.length);for(let i=0;i<t.length;i++){const n=t[i];p_(s,n),ew(s,e[n])}}break;case"boolean":_s(s,e?120:121);break;default:_s(s,127)}};class qW extends vv{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&ri(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const GW=s=>{s.count>0&&(FP(s.encoder,s.count===1?s.s:-s.s),s.count>1&&ri(s.encoder,s.count-2))};class Nx{constructor(){this.encoder=new vv,this.s=0,this.count=0}write(e){this.s===e?this.count++:(GW(this),this.count=1,this.s=e)}toUint8Array(){return GW(this),Ml(this.encoder)}}const KW=s=>{if(s.count>0){const e=s.diff*2+(s.count===1?0:1);FP(s.encoder,e),s.count>1&&ri(s.encoder,s.count-2)}};class II{constructor(){this.encoder=new vv,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(KW(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return KW(this),Ml(this.encoder)}}class aue{constructor(){this.sarr=[],this.s="",this.lensE=new Nx}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new vv;return this.sarr.push(this.s),this.s="",p_(e,this.sarr.join("")),H2(e,this.lensE.toUint8Array()),Ml(e)}}const ld=s=>new Error(s),Fl=()=>{throw ld("Method unimplemented")},fa=()=>{throw ld("Unexpected case")},sY=ld("Unexpected end of array"),rY=ld("Integer out of Range");class z2{constructor(e){this.arr=e,this.pos=0}}const I1=s=>new z2(s),lue=s=>s.pos!==s.arr.length,cue=(s,e)=>{const t=new Uint8Array(s.arr.buffer,s.pos+s.arr.byteOffset,e);return s.pos+=e,t},Lo=s=>cue(s,Pt(s)),e1=s=>s.arr[s.pos++],Pt=s=>{let e=0,t=1;const i=s.arr.length;for(;s.pos<i;){const n=s.arr[s.pos++];if(e=e+(n&tg)*t,t*=128,n<Fo)return e;if(e>nY)throw rY}throw sY},VP=s=>{let e=s.arr[s.pos++],t=e&FA,i=64;const n=(e&yh)>0?-1:1;if((e&Fo)===0)return n*t;const r=s.arr.length;for(;s.pos<r;){if(e=s.arr[s.pos++],t=t+(e&tg)*i,i*=128,e<Fo)return n*t;if(t>nY)throw rY}throw sY},hue=s=>{let e=Pt(s);if(e===0)return"";{let t=String.fromCodePoint(e1(s));if(--e<100)for(;e--;)t+=String.fromCodePoint(e1(s));else for(;e>0;){const i=e<1e4?e:1e4,n=s.arr.subarray(s.pos,s.pos+i);s.pos+=i,t+=String.fromCodePoint.apply(null,n),e-=i}return decodeURIComponent(escape(t))}},uue=s=>F0.decode(Lo(s)),__=F0?uue:hue,WP=(s,e)=>{const t=new DataView(s.arr.buffer,s.arr.byteOffset+s.pos,e);return s.pos+=e,t},due=s=>WP(s,4).getFloat32(0,!1),fue=s=>WP(s,8).getFloat64(0,!1),gue=s=>WP(s,8).getBigInt64(0,!1),mue=[s=>{},s=>null,VP,due,fue,gue,s=>!1,s=>!0,__,s=>{const e=Pt(s),t={};for(let i=0;i<e;i++){const n=__(s);t[n]=tw(s)}return t},s=>{const e=Pt(s),t=[];for(let i=0;i<e;i++)t.push(tw(s));return t},Lo],tw=s=>mue[127-e1(s)](s);class YW extends z2{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),lue(this)?this.count=Pt(this)+1:this.count=-1),this.count--,this.s}}class Ix extends z2{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=VP(this);const e=iY(this.s);this.count=1,e&&(this.s=-this.s,this.count=Pt(this)+2)}return this.count--,this.s}}class RI extends z2{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=VP(this),t=e&1;this.diff=ad(e/2),this.count=1,t&&(this.count=Pt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class pue{constructor(e){this.decoder=new Ix(e),this.str=__(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const _ue=crypto.getRandomValues.bind(crypto),oY=()=>_ue(new Uint32Array(1))[0],bue="10000000-1000-4000-8000"+-1e11,Cue=()=>bue.replace(/[018]/g,s=>(s^oY()&15>>s/4).toString(16)),QW=s=>new Promise(s);Promise.all.bind(Promise);const XW=s=>s===void 0?null:s;class wue{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let aY=new wue,vue=!0;try{typeof localStorage<"u"&&localStorage&&(aY=localStorage,vue=!1)}catch{}const yue=aY,Sue=Object.assign,xue=Object.keys,Lue=(s,e)=>{for(const t in s)e(s[t],t)},ZW=s=>xue(s).length,kue=s=>{for(const e in s)return!1;return!0},Eue=(s,e)=>{for(const t in s)if(!e(s[t],t))return!1;return!0},Due=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),Tue=(s,e)=>s===e||ZW(s)===ZW(e)&&Eue(s,(t,i)=>(t!==void 0||Due(e,i))&&e[i]===t),Nue=Object.freeze,lY=s=>{for(const e in s){const t=s[e];(typeof t=="object"||typeof t=="function")&&lY(s[e])}return Nue(s)},HP=(s,e,t=0)=>{try{for(;t<s.length;t++)s[t](...e)}finally{t<s.length&&HP(s,e,t+1)}},Iue=s=>s,Rue=(s,e)=>e.includes(s);var cY={};const iw=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let dl;const Aue=()=>{if(dl===void 0)if(iw){dl=ja();const s=process.argv;let e=null;for(let t=0;t<s.length;t++){const i=s[t];i[0]==="-"?(e!==null&&dl.set(e,""),e=i):e!==null&&(dl.set(e,i),e=null)}e!==null&&dl.set(e,"")}else typeof location=="object"?(dl=ja(),(location.search||"?").slice(1).split("&").forEach(s=>{if(s.length!==0){const[e,t]=s.split("=");dl.set(`--${jW(e,"-")}`,t),dl.set(`-${jW(e,"-")}`,t)}})):dl=ja();return dl},WA=s=>Aue().has(s),EL=s=>XW(iw?cY[s.toUpperCase().replaceAll("-","_")]:yue.getItem(s)),hY=s=>WA("--"+s)||EL(s)!==null;hY("production");const Mue=iw&&Rue(cY.FORCE_COLOR,["true","1","2"]),Oue=Mue||!WA("--no-colors")&&!hY("no-color")&&(!iw||process.stdout.isTTY)&&(!iw||WA("--color")||EL("COLORTERM")!==null||(EL("TERM")||"").includes("color")),Pue=s=>new Uint8Array(s),Fue=s=>{const e=Pue(s.byteLength);return e.set(s),e};class Bue{constructor(e,t){this.left=e,this.right=t}}const Ac=(s,e)=>new Bue(s,e);typeof DOMParser<"u"&&new DOMParser;const Vue=s=>Bhe(s,(e,t)=>`${t}:${e};`).join(""),Ph=Symbol,uY=Ph(),dY=Ph(),Wue=Ph(),Hue=Ph(),zue=Ph(),fY=Ph(),Uue=Ph(),zP=Ph(),jue=Ph(),$ue=s=>{var n;s.length===1&&((n=s[0])==null?void 0:n.constructor)===Function&&(s=s[0]());const e=[],t=[];let i=0;for(;i<s.length;i++){const r=s[i];if(r===void 0)break;if(r.constructor===String||r.constructor===Number)e.push(r);else if(r.constructor===Object)break}for(i>0&&t.push(e.join(""));i<s.length;i++){const r=s[i];r instanceof Symbol||t.push(r)}return t},que={[uY]:Ac("font-weight","bold"),[dY]:Ac("font-weight","normal"),[Wue]:Ac("color","blue"),[zue]:Ac("color","green"),[Hue]:Ac("color","grey"),[fY]:Ac("color","red"),[Uue]:Ac("color","purple"),[zP]:Ac("color","orange"),[jue]:Ac("color","black")},Gue=s=>{var o;s.length===1&&((o=s[0])==null?void 0:o.constructor)===Function&&(s=s[0]());const e=[],t=[],i=ja();let n=[],r=0;for(;r<s.length;r++){const a=s[r],l=que[a];if(l!==void 0)i.set(l.left,l.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const c=Vue(i);r>0||c.length>0?(e.push("%c"+a),t.push(c)):e.push(a)}else break}}for(r>0&&(n=t,n.unshift(e.join("")));r<s.length;r++){const a=s[r];a instanceof Symbol||n.push(a)}return n},gY=Oue?Gue:$ue,Kue=(...s)=>{console.log(...gY(s)),mY.forEach(e=>e.print(s))},Yue=(...s)=>{console.warn(...gY(s)),s.unshift(zP),mY.forEach(e=>e.print(s))},mY=J_(),pY=s=>({[Symbol.iterator](){return this},next:s}),Que=(s,e)=>pY(()=>{let t;do t=s.next();while(!t.done&&!e(t.value));return t}),AI=(s,e)=>pY(()=>{const{done:t,value:i}=s.next();return{done:t,value:t?void 0:e(i)}});class UP{constructor(e,t){this.clock=e,this.len=t}}class yv{constructor(){this.clients=new Map}}const _Y=(s,e,t)=>e.clients.forEach((i,n)=>{const r=s.doc.store.clients.get(n);if(r!=null){const o=r[r.length-1],a=o.id.clock+o.length;for(let l=0,c=i[l];l<i.length&&c.clock<a;c=i[++l])DY(s,r,c.clock,c.len,t)}}),Xue=(s,e)=>{let t=0,i=s.length-1;for(;t<=i;){const n=ad((t+i)/2),r=s[n],o=r.clock;if(o<=e){if(e<o+r.len)return n;t=n+1}else i=n-1}return null},bY=(s,e)=>{const t=s.clients.get(e.client);return t!==void 0&&Xue(t,e.clock)!==null},jP=s=>{s.clients.forEach(e=>{e.sort((n,r)=>n.clock-r.clock);let t,i;for(t=1,i=1;t<e.length;t++){const n=e[i-1],r=e[t];n.clock+n.len>=r.clock?n.len=tm(n.len,r.clock+r.len-n.clock):(i<t&&(e[i]=r),i++)}e.length=i})},Zue=s=>{const e=new yv;for(let t=0;t<s.length;t++)s[t].clients.forEach((i,n)=>{if(!e.clients.has(n)){const r=i.slice();for(let o=t+1;o<s.length;o++)Whe(r,s[o].clients.get(n)||[]);e.clients.set(n,r)}});return jP(e),e},DL=(s,e,t,i)=>{bd(s.clients,e,()=>[]).push(new UP(t,i))},Jue=()=>new yv,ede=s=>{const e=Jue();return s.clients.forEach((t,i)=>{const n=[];for(let r=0;r<t.length;r++){const o=t[r];if(o.deleted){const a=o.id.clock;let l=o.length;if(r+1<t.length)for(let c=t[r+1];r+1<t.length&&c.deleted;c=t[++r+1])l+=c.length;n.push(new UP(a,l))}}n.length>0&&e.clients.set(i,n)}),e},R1=(s,e)=>{ri(s.restEncoder,e.clients.size),Tg(e.clients.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{s.resetDsCurVal(),ri(s.restEncoder,t);const n=i.length;ri(s.restEncoder,n);for(let r=0;r<n;r++){const o=i[r];s.writeDsClock(o.clock),s.writeDsLen(o.len)}})},$P=s=>{const e=new yv,t=Pt(s.restDecoder);for(let i=0;i<t;i++){s.resetDsCurVal();const n=Pt(s.restDecoder),r=Pt(s.restDecoder);if(r>0){const o=bd(e.clients,n,()=>[]);for(let a=0;a<r;a++)o.push(new UP(s.readDsClock(),s.readDsLen()))}}return e},JW=(s,e,t)=>{const i=new yv,n=Pt(s.restDecoder);for(let r=0;r<n;r++){s.resetDsCurVal();const o=Pt(s.restDecoder),a=Pt(s.restDecoder),l=t.clients.get(o)||[],c=Zn(t,o);for(let u=0;u<a;u++){const d=s.readDsClock(),g=d+s.readDsLen();if(d<c){c<g&&DL(i,o,c,g-c);let p=$l(l,d),_=l[p];for(!_.deleted&&_.id.clock<d&&(l.splice(p+1,0,FL(e,_,d-_.id.clock)),p++);p<l.length&&(_=l[p++],_.id.clock<g);)_.deleted||(g<_.id.clock+_.length&&l.splice(p,0,FL(e,_,g-_.id.clock)),_.delete(e))}else DL(i,o,d,g-d)}}if(i.clients.size>0){const r=new Ng;return ri(r.restEncoder,0),R1(r,i),r.toUint8Array()}return null},CY=oY;class A1 extends zhe{constructor({guid:e=Cue(),collectionid:t=null,gc:i=!0,gcFilter:n=()=>!0,meta:r=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=i,this.gcFilter=n,this.clientID=CY(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new kY,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=r,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=QW(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>QW(c=>{const u=d=>{(d===void 0||d===!0)&&(this.off("sync",u),c())};this.on("sync",u)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&$i(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Tg(this.subdocs).map(e=>e.guid))}transact(e,t=null){return $i(this,e,t)}get(e,t=zs){const i=bd(this.share,e,()=>{const r=new t;return r._integrate(this,null),r}),n=i.constructor;if(t!==zs&&n!==t)if(n===zs){const r=new t;r._map=i._map,i._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=r}),r._start=i._start;for(let o=r._start;o!==null;o=o.right)o.parent=r;return r._length=i._length,this.share.set(e,r),r._integrate(this,null),r}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,w_)}getText(e=""){return this.get(e,n1)}getMap(e=""){return this.get(e,i1)}getXmlElement(e=""){return this.get(e,s1)}getXmlFragment(e=""){return this.get(e,Ig)}toJSON(){const e={};return this.share.forEach((t,i)=>{e[i]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,Tg(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new A1({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,$i(e.parent.doc,i=>{const n=t.doc;e.deleted||i.subdocsAdded.add(n),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class wY{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Pt(this.restDecoder)}readDsLen(){return Pt(this.restDecoder)}}class vY extends wY{readLeftID(){return Bt(Pt(this.restDecoder),Pt(this.restDecoder))}readRightID(){return Bt(Pt(this.restDecoder),Pt(this.restDecoder))}readClient(){return Pt(this.restDecoder)}readInfo(){return e1(this.restDecoder)}readString(){return __(this.restDecoder)}readParentInfo(){return Pt(this.restDecoder)===1}readTypeRef(){return Pt(this.restDecoder)}readLen(){return Pt(this.restDecoder)}readAny(){return tw(this.restDecoder)}readBuf(){return Fue(Lo(this.restDecoder))}readJSON(){return JSON.parse(__(this.restDecoder))}readKey(){return __(this.restDecoder)}}class tde{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Pt(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Pt(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class t1 extends tde{constructor(e){super(e),this.keys=[],Pt(e),this.keyClockDecoder=new RI(Lo(e)),this.clientDecoder=new Ix(Lo(e)),this.leftClockDecoder=new RI(Lo(e)),this.rightClockDecoder=new RI(Lo(e)),this.infoDecoder=new YW(Lo(e),e1),this.stringDecoder=new pue(Lo(e)),this.parentInfoDecoder=new YW(Lo(e),e1),this.typeRefDecoder=new Ix(Lo(e)),this.lenDecoder=new Ix(Lo(e))}readLeftID(){return new b_(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new b_(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return tw(this.restDecoder)}readBuf(){return Lo(this.restDecoder)}readJSON(){return tw(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class ide{constructor(){this.restEncoder=W2()}toUint8Array(){return Ml(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){ri(this.restEncoder,e)}writeDsLen(e){ri(this.restEncoder,e)}}class Sv extends ide{writeLeftID(e){ri(this.restEncoder,e.client),ri(this.restEncoder,e.clock)}writeRightID(e){ri(this.restEncoder,e.client),ri(this.restEncoder,e.clock)}writeClient(e){ri(this.restEncoder,e)}writeInfo(e){BA(this.restEncoder,e)}writeString(e){p_(this.restEncoder,e)}writeParentInfo(e){ri(this.restEncoder,e?1:0)}writeTypeRef(e){ri(this.restEncoder,e)}writeLen(e){ri(this.restEncoder,e)}writeAny(e){ew(this.restEncoder,e)}writeBuf(e){xo(this.restEncoder,e)}writeJSON(e){p_(this.restEncoder,JSON.stringify(e))}writeKey(e){p_(this.restEncoder,e)}}class nde{constructor(){this.restEncoder=W2(),this.dsCurrVal=0}toUint8Array(){return Ml(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,ri(this.restEncoder,t)}writeDsLen(e){e===0&&fa(),ri(this.restEncoder,e-1),this.dsCurrVal+=e}}class Ng extends nde{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new II,this.clientEncoder=new Nx,this.leftClockEncoder=new II,this.rightClockEncoder=new II,this.infoEncoder=new qW(BA),this.stringEncoder=new aue,this.parentInfoEncoder=new qW(BA),this.typeRefEncoder=new Nx,this.lenEncoder=new Nx}toUint8Array(){const e=W2();return ri(e,0),xo(e,this.keyClockEncoder.toUint8Array()),xo(e,this.clientEncoder.toUint8Array()),xo(e,this.leftClockEncoder.toUint8Array()),xo(e,this.rightClockEncoder.toUint8Array()),xo(e,Ml(this.infoEncoder)),xo(e,this.stringEncoder.toUint8Array()),xo(e,Ml(this.parentInfoEncoder)),xo(e,this.typeRefEncoder.toUint8Array()),xo(e,this.lenEncoder.toUint8Array()),H2(e,Ml(this.restEncoder)),Ml(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){ew(this.restEncoder,e)}writeBuf(e){xo(this.restEncoder,e)}writeJSON(e){ew(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const sde=(s,e,t,i)=>{i=tm(i,e[0].id.clock);const n=$l(e,i);ri(s.restEncoder,e.length-n),s.writeClient(t),ri(s.restEncoder,i);const r=e[n];r.write(s,i-r.id.clock);for(let o=n+1;o<e.length;o++)e[o].write(s,0)},qP=(s,e,t)=>{const i=new Map;t.forEach((n,r)=>{Zn(e,r)>n&&i.set(r,n)}),GP(e).forEach((n,r)=>{t.has(r)||i.set(r,0)}),ri(s.restEncoder,i.size),Tg(i.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{sde(s,e.clients.get(n),n,r)})},rde=(s,e)=>{const t=ja(),i=Pt(s.restDecoder);for(let n=0;n<i;n++){const r=Pt(s.restDecoder),o=new Array(r),a=s.readClient();let l=Pt(s.restDecoder);t.set(a,{i:0,refs:o});for(let c=0;c<r;c++){const u=s.readInfo();switch(V2&u){case 0:{const d=s.readLen();o[c]=new ra(Bt(a,l),d),l+=d;break}case 10:{const d=Pt(s.restDecoder);o[c]=new oa(Bt(a,l),d),l+=d;break}default:{const d=(u&(yh|Fo))===0,g=new Sn(Bt(a,l),null,(u&Fo)===Fo?s.readLeftID():null,null,(u&yh)===yh?s.readRightID():null,d?s.readParentInfo()?e.get(s.readString()):s.readLeftID():null,d&&(u&ZC)===ZC?s.readString():null,GY(s,u));o[c]=g,l+=g.length}}}}return t},ode=(s,e,t)=>{const i=[];let n=Tg(t.keys()).sort((p,_)=>p-_);if(n.length===0)return null;const r=()=>{if(n.length===0)return null;let p=t.get(n[n.length-1]);for(;p.refs.length===p.i;)if(n.pop(),n.length>0)p=t.get(n[n.length-1]);else return null;return p};let o=r();if(o===null)return null;const a=new kY,l=new Map,c=(p,_)=>{const C=l.get(p);(C==null||C>_)&&l.set(p,_)};let u=o.refs[o.i++];const d=new Map,g=()=>{for(const p of i){const _=p.id.client,C=t.get(_);C?(C.i--,a.clients.set(_,C.refs.slice(C.i)),t.delete(_),C.i=0,C.refs=[]):a.clients.set(_,[p]),n=n.filter(v=>v!==_)}i.length=0};for(;;){if(u.constructor!==oa){const _=bd(d,u.id.client,()=>Zn(e,u.id.client))-u.id.clock;if(_<0)i.push(u),c(u.id.client,u.id.clock-1),g();else{const C=u.getMissing(s,e);if(C!==null){i.push(u);const v=t.get(C)||{refs:[],i:0};if(v.refs.length===v.i)c(C,Zn(e,C)),g();else{u=v.refs[v.i++];continue}}else(_===0||_<u.length)&&(u.integrate(s,_),d.set(u.id.client,u.id.clock+u.length))}}if(i.length>0)u=i.pop();else if(o!==null&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=r(),o===null)break;u=o.refs[o.i++]}}if(a.clients.size>0){const p=new Ng;return qP(p,a,new Map),ri(p.restEncoder,0),{missing:l,update:p.toUint8Array()}}return null},ade=(s,e)=>qP(s,e.doc.store,e.beforeState),lde=(s,e,t,i=new t1(s))=>$i(e,n=>{n.local=!1;let r=!1;const o=n.doc,a=o.store,l=rde(i,o),c=ode(n,a,l),u=a.pendingStructs;if(u){for(const[g,p]of u.missing)if(p<Zn(a,g)){r=!0;break}if(c){for(const[g,p]of c.missing){const _=u.missing.get(g);(_==null||_>p)&&u.missing.set(g,p)}u.update=IL([u.update,c.update])}}else a.pendingStructs=c;const d=JW(i,n,a);if(a.pendingDs){const g=new t1(I1(a.pendingDs));Pt(g.restDecoder);const p=JW(g,n,a);d&&p?a.pendingDs=IL([d,p]):a.pendingDs=d||p}else a.pendingDs=d;if(r){const g=a.pendingStructs.update;a.pendingStructs=null,yY(n.doc,g)}},t,!1),yY=(s,e,t,i=t1)=>{const n=I1(e);lde(n,s,t,new i(n))},cde=(s,e,t)=>yY(s,e,t,vY),hde=(s,e,t=new Map)=>{qP(s,e.store,t),R1(s,ede(e.store))},ude=(s,e=new Uint8Array([0]),t=new Ng)=>{const i=SY(e);hde(t,s,i);const n=[t.toUint8Array()];if(s.store.pendingDs&&n.push(s.store.pendingDs),s.store.pendingStructs&&n.push(Ede(s.store.pendingStructs.update,e)),n.length>1){if(t.constructor===Sv)return Lde(n.map((r,o)=>o===0?r:Tde(r)));if(t.constructor===Ng)return IL(n)}return n[0]},dde=(s,e)=>ude(s,e,new Sv),fde=s=>{const e=new Map,t=Pt(s.restDecoder);for(let i=0;i<t;i++){const n=Pt(s.restDecoder),r=Pt(s.restDecoder);e.set(n,r)}return e},SY=s=>fde(new wY(I1(s)));class gde{constructor(){this.l=[]}}const eH=()=>new gde,tH=(s,e)=>s.l.push(e),iH=(s,e)=>{const t=s.l,i=t.length;s.l=t.filter(n=>e!==n),i===s.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},xY=(s,e,t)=>HP(s.l,[e,t]);class b_{constructor(e,t){this.client=e,this.clock=t}}const ES=(s,e)=>s===e||s!==null&&e!==null&&s.client===e.client&&s.clock===e.clock,Bt=(s,e)=>new b_(s,e),LY=s=>{for(const[e,t]of s.doc.share.entries())if(t===s)return e;throw fa()};class mde{constructor(e,t,i,n=0){this.type=e,this.tname=t,this.item=i,this.assoc=n}}class pde{constructor(e,t,i=0){this.type=e,this.index=t,this.assoc=i}}const _de=(s,e,t=0)=>new pde(s,e,t),DS=(s,e,t)=>{let i=null,n=null;return s._item===null?n=LY(s):i=Bt(s._item.id.client,s._item.id.clock),new mde(i,n,e,t)},TL=(s,e,t=0)=>{let i=s._start;if(t<0){if(e===0)return DS(s,null,t);e--}for(;i!==null;){if(!i.deleted&&i.countable){if(i.length>e)return DS(s,Bt(i.id.client,i.id.clock+e),t);e-=i.length}if(i.right===null&&t<0)return DS(s,i.lastId,t);i=i.right}return DS(s,null,t)},bde=(s,e)=>{const t=C_(s,e),i=e.clock-t.id.clock;return{item:t,diff:i}},NL=(s,e,t=!0)=>{const i=e.store,n=s.item,r=s.type,o=s.tname,a=s.assoc;let l=null,c=0;if(n!==null){if(Zn(i,n.client)<=n.clock)return null;const u=t?hH(i,n):bde(i,n),d=u.item;if(!(d instanceof Sn))return null;if(l=d.parent,l._item===null||!l._item.deleted){c=d.deleted||!d.countable?0:u.diff+(a>=0?0:1);let g=d.left;for(;g!==null;)!g.deleted&&g.countable&&(c+=g.length),g=g.left}}else{if(o!==null)l=e.get(o);else if(r!==null){if(Zn(i,r.client)<=r.clock)return null;const{item:u}=t?hH(i,r):{item:C_(i,r)};if(u instanceof Sn&&u.content instanceof sc)l=u.content.type;else return null}else throw fa();a>=0?c=l._length:c=0}return _de(l,c,s.assoc)},Dp=(s,e)=>e===void 0?!s.deleted:e.sv.has(s.id.client)&&(e.sv.get(s.id.client)||0)>s.id.clock&&!bY(e.ds,s.id),HA=(s,e)=>{const t=bd(s.meta,HA,J_),i=s.doc.store;t.has(e)||(e.sv.forEach((n,r)=>{n<Zn(i,r)&&cd(s,Bt(r,n))}),_Y(s,e.ds,n=>{}),t.add(e))};class kY{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const GP=s=>{const e=new Map;return s.clients.forEach((t,i)=>{const n=t[t.length-1];e.set(i,n.id.clock+n.length)}),e},Zn=(s,e)=>{const t=s.clients.get(e);if(t===void 0)return 0;const i=t[t.length-1];return i.id.clock+i.length},EY=(s,e)=>{let t=s.clients.get(e.id.client);if(t===void 0)t=[],s.clients.set(e.id.client,t);else{const i=t[t.length-1];if(i.id.clock+i.length!==e.id.clock)throw fa()}t.push(e)},$l=(s,e)=>{let t=0,i=s.length-1,n=s[i],r=n.id.clock;if(r===e)return i;let o=ad(e/(r+n.length-1)*i);for(;t<=i;){if(n=s[o],r=n.id.clock,r<=e){if(e<r+n.length)return o;t=o+1}else i=o-1;o=ad((t+i)/2)}throw fa()},Cde=(s,e)=>{const t=s.clients.get(e.client);return t[$l(t,e.clock)]},C_=Cde,zA=(s,e,t)=>{const i=$l(e,t),n=e[i];return n.id.clock<t&&n instanceof Sn?(e.splice(i+1,0,FL(s,n,t-n.id.clock)),i+1):i},cd=(s,e)=>{const t=s.doc.store.clients.get(e.client);return t[zA(s,t,e.clock)]},nH=(s,e,t)=>{const i=e.clients.get(t.client),n=$l(i,t.clock),r=i[n];return t.clock!==r.id.clock+r.length-1&&r.constructor!==ra&&i.splice(n+1,0,FL(s,r,t.clock-r.id.clock+1)),r},wde=(s,e,t)=>{const i=s.clients.get(e.id.client);i[$l(i,e.id.clock)]=t},DY=(s,e,t,i,n)=>{if(i===0)return;const r=t+i;let o=zA(s,e,t),a;do a=e[o++],r<a.id.clock+a.length&&zA(s,e,r),n(a);while(o<e.length&&e[o].id.clock<r)};class vde{constructor(e,t,i){this.doc=e,this.deleteSet=new yv,this.beforeState=GP(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const sH=(s,e)=>e.deleteSet.clients.size===0&&!Vhe(e.afterState,(t,i)=>e.beforeState.get(i)!==t)?!1:(jP(e.deleteSet),ade(s,e),R1(s,e.deleteSet),!0),rH=(s,e,t)=>{const i=e._item;(i===null||i.id.clock<(s.beforeState.get(i.id.client)||0)&&!i.deleted)&&bd(s.changed,e,J_).add(t)},Rx=(s,e)=>{let t=s[e],i=s[e-1],n=e;for(;n>0;t=i,i=s[--n-1]){if(i.deleted===t.deleted&&i.constructor===t.constructor&&i.mergeWith(t)){t instanceof Sn&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,i);continue}break}const r=e-n;return r&&s.splice(e+1-r,r),r},yde=(s,e,t)=>{for(const[i,n]of s.clients.entries()){const r=e.clients.get(i);for(let o=n.length-1;o>=0;o--){const a=n[o],l=a.clock+a.len;for(let c=$l(r,a.clock),u=r[c];c<r.length&&u.id.clock<l;u=r[++c]){const d=r[c];if(a.clock+a.len<=d.id.clock)break;d instanceof Sn&&d.deleted&&!d.keep&&t(d)&&d.gc(e,!1)}}}},Sde=(s,e)=>{s.clients.forEach((t,i)=>{const n=e.clients.get(i);for(let r=t.length-1;r>=0;r--){const o=t[r],a=tY(n.length-1,1+$l(n,o.clock+o.len-1));for(let l=a,c=n[l];l>0&&c.id.clock>=o.clock;c=n[l])l-=1+Rx(n,l)}})},TY=(s,e)=>{if(e<s.length){const t=s[e],i=t.doc,n=i.store,r=t.deleteSet,o=t._mergeStructs;try{jP(r),t.afterState=GP(t.doc.store),i.emit("beforeObserverCalls",[t,i]);const a=[];t.changed.forEach((l,c)=>a.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(t,l)})),a.push(()=>{t.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(u=>u.target._item===null||!u.target._item.deleted),l.forEach(u=>{u.currentTarget=c,u._path=null}),l.sort((u,d)=>u.path.length-d.path.length),xY(c._dEH,l,t))})}),a.push(()=>i.emit("afterTransaction",[t,i])),HP(a,[]),t._needFormattingCleanup&&Ude(t)}finally{i.gc&&yde(r,n,i.gcFilter),Sde(r,n),t.afterState.forEach((u,d)=>{const g=t.beforeState.get(d)||0;if(g!==u){const p=n.clients.get(d),_=tm($l(p,g),1);for(let C=p.length-1;C>=_;)C-=1+Rx(p,C)}});for(let u=o.length-1;u>=0;u--){const{client:d,clock:g}=o[u].id,p=n.clients.get(d),_=$l(p,g);_+1<p.length&&Rx(p,_+1)>1||_>0&&Rx(p,_)}if(!t.local&&t.afterState.get(i.clientID)!==t.beforeState.get(i.clientID)&&(Kue(zP,uY,"[yjs] ",dY,fY,"Changed the client-id because another client seems to be using it."),i.clientID=CY()),i.emit("afterTransactionCleanup",[t,i]),i._observers.has("update")){const u=new Sv;sH(u,t)&&i.emit("update",[u.toUint8Array(),t.origin,i,t])}if(i._observers.has("updateV2")){const u=new Ng;sH(u,t)&&i.emit("updateV2",[u.toUint8Array(),t.origin,i,t])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=t;(a.size>0||c.size>0||l.size>0)&&(a.forEach(u=>{u.clientID=i.clientID,u.collectionid==null&&(u.collectionid=i.collectionid),i.subdocs.add(u)}),c.forEach(u=>i.subdocs.delete(u)),i.emit("subdocs",[{loaded:l,added:a,removed:c},i,t]),c.forEach(u=>u.destroy())),s.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,s])):TY(s,e+1)}}},$i=(s,e,t=null,i=!0)=>{const n=s._transactionCleanups;let r=!1,o=null;s._transaction===null&&(r=!0,s._transaction=new vde(s,t,i),n.push(s._transaction),n.length===1&&s.emit("beforeAllTransactions",[s]),s.emit("beforeTransaction",[s._transaction,s]));try{o=e(s._transaction)}finally{if(r){const a=s._transaction===n[0];s._transaction=null,a&&TY(n,0)}}return o};function*xde(s){const e=Pt(s.restDecoder);for(let t=0;t<e;t++){const i=Pt(s.restDecoder),n=s.readClient();let r=Pt(s.restDecoder);for(let o=0;o<i;o++){const a=s.readInfo();if(a===10){const l=Pt(s.restDecoder);yield new oa(Bt(n,r),l),r+=l}else if((V2&a)!==0){const l=(a&(yh|Fo))===0,c=new Sn(Bt(n,r),null,(a&Fo)===Fo?s.readLeftID():null,null,(a&yh)===yh?s.readRightID():null,l?s.readParentInfo()?s.readString():s.readLeftID():null,l&&(a&ZC)===ZC?s.readString():null,GY(s,a));yield c,r+=c.length}else{const l=s.readLen();yield new ra(Bt(n,r),l),r+=l}}}}class KP{constructor(e,t){this.gen=xde(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===oa);return this.curr}}class YP{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const Lde=s=>IL(s,vY,Sv),kde=(s,e)=>{if(s.constructor===ra){const{client:t,clock:i}=s.id;return new ra(Bt(t,i+e),s.length-e)}else if(s.constructor===oa){const{client:t,clock:i}=s.id;return new oa(Bt(t,i+e),s.length-e)}else{const t=s,{client:i,clock:n}=t.id;return new Sn(Bt(i,n+e),null,Bt(i,n+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},IL=(s,e=t1,t=Ng)=>{if(s.length===1)return s[0];const i=s.map(u=>new e(I1(u)));let n=i.map(u=>new KP(u,!0)),r=null;const o=new t,a=new YP(o);for(;n=n.filter(g=>g.curr!==null),n.sort((g,p)=>{if(g.curr.id.client===p.curr.id.client){const _=g.curr.id.clock-p.curr.id.clock;return _===0?g.curr.constructor===p.curr.constructor?0:g.curr.constructor===oa?1:-1:_}else return p.curr.id.client-g.curr.id.client}),n.length!==0;){const u=n[0],d=u.curr.id.client;if(r!==null){let g=u.curr,p=!1;for(;g!==null&&g.id.clock+g.length<=r.struct.id.clock+r.struct.length&&g.id.client>=r.struct.id.client;)g=u.next(),p=!0;if(g===null||g.id.client!==d||p&&g.id.clock>r.struct.id.clock+r.struct.length)continue;if(d!==r.struct.id.client)Eu(a,r.struct,r.offset),r={struct:g,offset:0},u.next();else if(r.struct.id.clock+r.struct.length<g.id.clock)if(r.struct.constructor===oa)r.struct.length=g.id.clock+g.length-r.struct.id.clock;else{Eu(a,r.struct,r.offset);const _=g.id.clock-r.struct.id.clock-r.struct.length;r={struct:new oa(Bt(d,r.struct.id.clock+r.struct.length),_),offset:0}}else{const _=r.struct.id.clock+r.struct.length-g.id.clock;_>0&&(r.struct.constructor===oa?r.struct.length-=_:g=kde(g,_)),r.struct.mergeWith(g)||(Eu(a,r.struct,r.offset),r={struct:g,offset:0},u.next())}}else r={struct:u.curr,offset:0},u.next();for(let g=u.curr;g!==null&&g.id.client===d&&g.id.clock===r.struct.id.clock+r.struct.length&&g.constructor!==oa;g=u.next())Eu(a,r.struct,r.offset),r={struct:g,offset:0}}r!==null&&(Eu(a,r.struct,r.offset),r=null),QP(a);const l=i.map(u=>$P(u)),c=Zue(l);return R1(o,c),o.toUint8Array()},Ede=(s,e,t=t1,i=Ng)=>{const n=SY(e),r=new i,o=new YP(r),a=new t(I1(s)),l=new KP(a,!1);for(;l.curr;){const u=l.curr,d=u.id.client,g=n.get(d)||0;if(l.curr.constructor===oa){l.next();continue}if(u.id.clock+u.length>g)for(Eu(o,u,tm(g-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===d;)Eu(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===d&&l.curr.id.clock+l.curr.length<=g;)l.next()}QP(o);const c=$P(a);return R1(r,c),r.toUint8Array()},NY=s=>{s.written>0&&(s.clientStructs.push({written:s.written,restEncoder:Ml(s.encoder.restEncoder)}),s.encoder.restEncoder=W2(),s.written=0)},Eu=(s,e,t)=>{s.written>0&&s.currClient!==e.id.client&&NY(s),s.written===0&&(s.currClient=e.id.client,s.encoder.writeClient(e.id.client),ri(s.encoder.restEncoder,e.id.clock+t)),e.write(s.encoder,t),s.written++},QP=s=>{NY(s);const e=s.encoder.restEncoder;ri(e,s.clientStructs.length);for(let t=0;t<s.clientStructs.length;t++){const i=s.clientStructs[t];ri(e,i.written),H2(e,i.restEncoder)}},Dde=(s,e,t,i)=>{const n=new t(I1(s)),r=new KP(n,!1),o=new i,a=new YP(o);for(let c=r.curr;c!==null;c=r.next())Eu(a,e(c),0);QP(a);const l=$P(n);return R1(o,l),o.toUint8Array()},Tde=s=>Dde(s,Iue,t1,Sv),oH="You must not compute changes after the event-handler fired.";class U2{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Nde(this.currentTarget,this.target))}deletes(e){return bY(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw ld(oH);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(n=>{if(n!==null){const r=t._map.get(n);let o,a;if(this.adds(r)){let l=r.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(r))if(l!==null&&this.deletes(l))o="delete",a=DI(l.content.getContent());else return;else l!==null&&this.deletes(l)?(o="update",a=DI(l.content.getContent())):(o="add",a=void 0)}else if(this.deletes(r))o="delete",a=DI(r.content.getContent());else return;e.set(n,{action:o,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw ld(oH);const t=this.target,i=J_(),n=J_(),r=[];if(e={added:i,deleted:n,delta:r,keys:this.keys},this.transaction.changed.get(t).has(null)){let a=null;const l=()=>{a&&r.push(a)};for(let c=t._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((a===null||a.delete===void 0)&&(l(),a={delete:0}),a.delete+=c.length,n.add(c)):this.adds(c)?((a===null||a.insert===void 0)&&(l(),a={insert:[]}),a.insert=a.insert.concat(c.content.getContent()),i.add(c)):((a===null||a.retain===void 0)&&(l(),a={retain:0}),a.retain+=c.length);a!==null&&a.retain===void 0&&l()}this._changes=e}return e}}const Nde=(s,e)=>{const t=[];for(;e._item!==null&&e!==s;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let i=0,n=e._item.parent._start;for(;n!==e._item&&n!==null;)!n.deleted&&n.countable&&(i+=n.length),n=n.right;t.unshift(i)}e=e._item.parent}return t},ar=()=>{Yue("Invalid access: Add Yjs type to a document before reading data.")},IY=80;let XP=0;class Ide{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=XP++}}const Rde=s=>{s.timestamp=XP++},RY=(s,e,t)=>{s.p.marker=!1,s.p=e,e.marker=!0,s.index=t,s.timestamp=XP++},Ade=(s,e,t)=>{if(s.length>=IY){const i=s.reduce((n,r)=>n.timestamp<r.timestamp?n:r);return RY(i,e,t),i}else{const i=new Ide(e,t);return s.push(i),i}},j2=(s,e)=>{if(s._start===null||e===0||s._searchMarker===null)return null;const t=s._searchMarker.length===0?null:s._searchMarker.reduce((r,o)=>Tx(e-r.index)<Tx(e-o.index)?r:o);let i=s._start,n=0;for(t!==null&&(i=t.p,n=t.index,Rde(t));i.right!==null&&n<e;){if(!i.deleted&&i.countable){if(e<n+i.length)break;n+=i.length}i=i.right}for(;i.left!==null&&n>e;)i=i.left,!i.deleted&&i.countable&&(n-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(n-=i.length);return t!==null&&Tx(t.index-n)<i.parent.length/IY?(RY(t,i,n),t):Ade(s._searchMarker,i,n)},nw=(s,e,t)=>{for(let i=s.length-1;i>=0;i--){const n=s[i];if(t>0){let r=n.p;for(r.marker=!1;r&&(r.deleted||!r.countable);)r=r.left,r&&!r.deleted&&r.countable&&(n.index-=r.length);if(r===null||r.marker===!0){s.splice(i,1);continue}n.p=r,r.marker=!0}(e<n.index||t>0&&e===n.index)&&(n.index=tm(e,n.index+t))}},$2=(s,e,t)=>{const i=s,n=e.changedParentTypes;for(;bd(n,s,()=>[]).push(t),s._item!==null;)s=s._item.parent;xY(i._eH,t,e)};class zs{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=eH(),this._dEH=eH(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw Fl()}clone(){throw Fl()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){tH(this._eH,e)}observeDeep(e){tH(this._dEH,e)}unobserve(e){iH(this._eH,e)}unobserveDeep(e){iH(this._dEH,e)}toJSON(){}}const AY=(s,e,t)=>{s.doc??ar(),e<0&&(e=s._length+e),t<0&&(t=s._length+t);let i=t-e;const n=[];let r=s._start;for(;r!==null&&i>0;){if(r.countable&&!r.deleted){const o=r.content.getContent();if(o.length<=e)e-=o.length;else{for(let a=e;a<o.length&&i>0;a++)n.push(o[a]),i--;e=0}}r=r.right}return n},MY=s=>{s.doc??ar();const e=[];let t=s._start;for(;t!==null;){if(t.countable&&!t.deleted){const i=t.content.getContent();for(let n=0;n<i.length;n++)e.push(i[n])}t=t.right}return e},sw=(s,e)=>{let t=0,i=s._start;for(s.doc??ar();i!==null;){if(i.countable&&!i.deleted){const n=i.content.getContent();for(let r=0;r<n.length;r++)e(n[r],t++,s)}i=i.right}},OY=(s,e)=>{const t=[];return sw(s,(i,n)=>{t.push(e(i,n,s))}),t},Mde=s=>{let e=s._start,t=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),i=0,e=e.right}const n=t[i++];return t.length<=i&&(t=null),{done:!1,value:n}}}},PY=(s,e)=>{s.doc??ar();const t=j2(s,e);let i=s._start;for(t!==null&&(i=t.p,e-=t.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},RL=(s,e,t,i)=>{let n=t;const r=s.doc,o=r.clientID,a=r.store,l=t===null?e._start:t.right;let c=[];const u=()=>{c.length>0&&(n=new Sn(Bt(o,Zn(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new Rg(c)),n.integrate(s,0),c=[])};i.forEach(d=>{if(d===null)c.push(d);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(d);break;default:switch(u(),d.constructor){case Uint8Array:case ArrayBuffer:n=new Sn(Bt(o,Zn(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new xv(new Uint8Array(d))),n.integrate(s,0);break;case A1:n=new Sn(Bt(o,Zn(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new Lv(d)),n.integrate(s,0);break;default:if(d instanceof zs)n=new Sn(Bt(o,Zn(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new sc(d)),n.integrate(s,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},FY=()=>ld("Length exceeded!"),BY=(s,e,t,i)=>{if(t>e._length)throw FY();if(t===0)return e._searchMarker&&nw(e._searchMarker,t,i.length),RL(s,e,null,i);const n=t,r=j2(e,t);let o=e._start;for(r!==null&&(o=r.p,t-=r.index,t===0&&(o=o.prev,t+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(t<=o.length){t<o.length&&cd(s,Bt(o.id.client,o.id.clock+t));break}t-=o.length}return e._searchMarker&&nw(e._searchMarker,n,i.length),RL(s,e,o,i)},Ode=(s,e,t)=>{let n=(e._searchMarker||[]).reduce((r,o)=>o.index>r.index?o:r,{index:0,p:e._start}).p;if(n)for(;n.right;)n=n.right;return RL(s,e,n,t)},VY=(s,e,t,i)=>{if(i===0)return;const n=t,r=i,o=j2(e,t);let a=e._start;for(o!==null&&(a=o.p,t-=o.index);a!==null&&t>0;a=a.right)!a.deleted&&a.countable&&(t<a.length&&cd(s,Bt(a.id.client,a.id.clock+t)),t-=a.length);for(;i>0&&a!==null;)a.deleted||(i<a.length&&cd(s,Bt(a.id.client,a.id.clock+i)),a.delete(s),i-=a.length),a=a.right;if(i>0)throw FY();e._searchMarker&&nw(e._searchMarker,n,-r+i)},AL=(s,e,t)=>{const i=e._map.get(t);i!==void 0&&i.delete(s)},ZP=(s,e,t,i)=>{const n=e._map.get(t)||null,r=s.doc,o=r.clientID;let a;if(i==null)a=new Rg([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new Rg([i]);break;case Uint8Array:a=new xv(i);break;case A1:a=new Lv(i);break;default:if(i instanceof zs)a=new sc(i);else throw new Error("Unexpected content type")}new Sn(Bt(o,Zn(r.store,o)),n,n&&n.lastId,null,null,e,t,a).integrate(s,0)},JP=(s,e)=>{s.doc??ar();const t=s._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},WY=s=>{const e={};return s.doc??ar(),s._map.forEach((t,i)=>{t.deleted||(e[i]=t.content.getContent()[t.length-1])}),e},HY=(s,e)=>{s.doc??ar();const t=s._map.get(e);return t!==void 0&&!t.deleted},Pde=(s,e)=>{const t={};return s._map.forEach((i,n)=>{let r=i;for(;r!==null&&(!e.sv.has(r.id.client)||r.id.clock>=(e.sv.get(r.id.client)||0));)r=r.left;r!==null&&Dp(r,e)&&(t[n]=r.content.getContent()[r.length-1])}),t},TS=s=>(s.doc??ar(),Que(s._map.entries(),e=>!e[1].deleted));class Fde extends U2{}class w_ extends zs{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new w_;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new w_}clone(){const e=new w_;return e.insert(0,this.toArray().map(t=>t instanceof zs?t.clone():t)),e}get length(){return this.doc??ar(),this._length}_callObserver(e,t){super._callObserver(e,t),$2(this,e,new Fde(this,e))}insert(e,t){this.doc!==null?$i(this.doc,i=>{BY(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?$i(this.doc,t=>{Ode(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?$i(this.doc,i=>{VY(i,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return PY(this,e)}toArray(){return MY(this)}slice(e=0,t=this.length){return AY(this,e,t)}toJSON(){return this.map(e=>e instanceof zs?e.toJSON():e)}map(e){return OY(this,e)}forEach(e){sw(this,e)}[Symbol.iterator](){return Mde(this)}_write(e){e.writeTypeRef(lfe)}}const Bde=s=>new w_;class Vde extends U2{constructor(e,t,i){super(e,t),this.keysChanged=i}}class i1 extends zs{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((i,n)=>{this.set(n,i)}),this._prelimContent=null}_copy(){return new i1}clone(){const e=new i1;return this.forEach((t,i)=>{e.set(i,t instanceof zs?t.clone():t)}),e}_callObserver(e,t){$2(this,e,new Vde(this,e,t))}toJSON(){this.doc??ar();const e={};return this._map.forEach((t,i)=>{if(!t.deleted){const n=t.content.getContent()[t.length-1];e[i]=n instanceof zs?n.toJSON():n}}),e}get size(){return[...TS(this)].length}keys(){return AI(TS(this),e=>e[0])}values(){return AI(TS(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return AI(TS(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??ar(),this._map.forEach((t,i)=>{t.deleted||e(t.content.getContent()[t.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?$i(this.doc,t=>{AL(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?$i(this.doc,i=>{ZP(i,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return JP(this,e)}has(e){return HY(this,e)}clear(){this.doc!==null?$i(this.doc,e=>{this.forEach(function(t,i,n){AL(e,n,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(cfe)}}const Wde=s=>new i1,Mu=(s,e)=>s===e||typeof s=="object"&&typeof e=="object"&&s&&e&&Tue(s,e);class UA{constructor(e,t,i,n){this.left=e,this.right=t,this.index=i,this.currentAttributes=n}forward(){switch(this.right===null&&fa(),this.right.content.constructor){case cs:this.right.deleted||M1(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const aH=(s,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case cs:e.right.deleted||M1(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&cd(s,Bt(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},NS=(s,e,t,i)=>{const n=new Map,r=i?j2(e,t):null;if(r){const o=new UA(r.p.left,r.p,r.index,n);return aH(s,o,t-r.index)}else{const o=new UA(null,e._start,0,n);return aH(s,o,t)}},zY=(s,e,t,i)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===cs&&Mu(i.get(t.right.content.key),t.right.content.value));)t.right.deleted||i.delete(t.right.content.key),t.forward();const n=s.doc,r=n.clientID;i.forEach((o,a)=>{const l=t.left,c=t.right,u=new Sn(Bt(r,Zn(n.store,r)),l,l&&l.lastId,c,c&&c.id,e,null,new cs(a,o));u.integrate(s,0),t.right=u,t.forward()})},M1=(s,e)=>{const{key:t,value:i}=e;i===null?s.delete(t):s.set(t,i)},UY=(s,e)=>{for(;s.right!==null;){if(!(s.right.deleted||s.right.content.constructor===cs&&Mu(e[s.right.content.key]??null,s.right.content.value)))break;s.forward()}},jY=(s,e,t,i)=>{const n=s.doc,r=n.clientID,o=new Map;for(const a in i){const l=i[a],c=t.currentAttributes.get(a)??null;if(!Mu(c,l)){o.set(a,c);const{left:u,right:d}=t;t.right=new Sn(Bt(r,Zn(n.store,r)),u,u&&u.lastId,d,d&&d.id,e,null,new cs(a,l)),t.right.integrate(s,0),t.forward()}}return o},MI=(s,e,t,i,n)=>{t.currentAttributes.forEach((g,p)=>{n[p]===void 0&&(n[p]=null)});const r=s.doc,o=r.clientID;UY(t,n);const a=jY(s,e,t,n),l=i.constructor===String?new ql(i):i instanceof zs?new sc(i):new im(i);let{left:c,right:u,index:d}=t;e._searchMarker&&nw(e._searchMarker,t.index,l.getLength()),u=new Sn(Bt(o,Zn(r.store,o)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(s,0),t.right=u,t.index=d,t.forward(),zY(s,e,t,a)},lH=(s,e,t,i,n)=>{const r=s.doc,o=r.clientID;UY(t,n);const a=jY(s,e,t,n);e:for(;t.right!==null&&(i>0||a.size>0&&(t.right.deleted||t.right.content.constructor===cs));){if(!t.right.deleted)switch(t.right.content.constructor){case cs:{const{key:l,value:c}=t.right.content,u=n[l];if(u!==void 0){if(Mu(u,c))a.delete(l);else{if(i===0)break e;a.set(l,c)}t.right.delete(s)}else t.currentAttributes.set(l,c);break}default:i<t.right.length&&cd(s,Bt(t.right.id.client,t.right.id.clock+i)),i-=t.right.length;break}t.forward()}if(i>0){let l="";for(;i>0;i--)l+=`
`;t.right=new Sn(Bt(o,Zn(r.store,o)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new ql(l)),t.right.integrate(s,0),t.forward()}zY(s,e,t,a)},$Y=(s,e,t,i,n)=>{let r=e;const o=ja();for(;r&&(!r.countable||r.deleted);){if(!r.deleted&&r.content.constructor===cs){const c=r.content;o.set(c.key,c)}r=r.right}let a=0,l=!1;for(;e!==r;){if(t===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case cs:{const{key:u,value:d}=c,g=i.get(u)??null;(o.get(u)!==c||g===d)&&(e.delete(s),a++,!l&&(n.get(u)??null)===d&&g!==d&&(g===null?n.delete(u):n.set(u,g))),!l&&!e.deleted&&M1(n,c);break}}}e=e.right}return a},Hde=(s,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===cs){const i=e.content.key;t.has(i)?e.delete(s):t.add(i)}e=e.left}},zde=s=>{let e=0;return $i(s.doc,t=>{let i=s._start,n=s._start,r=ja();const o=PA(r);for(;n;){if(n.deleted===!1)switch(n.content.constructor){case cs:M1(o,n.content);break;default:e+=$Y(t,i,n,r,o),r=PA(o),i=n;break}n=n.right}}),e},Ude=s=>{const e=new Set,t=s.doc;for(const[i,n]of s.afterState.entries()){const r=s.beforeState.get(i)||0;n!==r&&DY(s,t.store.clients.get(i),r,n,o=>{!o.deleted&&o.content.constructor===cs&&o.constructor!==ra&&e.add(o.parent)})}$i(t,i=>{_Y(s,s.deleteSet,n=>{if(n instanceof ra||!n.parent._hasFormatting||e.has(n.parent))return;const r=n.parent;n.content.constructor===cs?e.add(r):Hde(i,n)});for(const n of e)zde(n)})},cH=(s,e,t)=>{const i=t,n=PA(e.currentAttributes),r=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case sc:case im:case ql:t<e.right.length&&cd(s,Bt(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(s);break}e.forward()}r&&$Y(s,r,e.right,n,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&nw(o._searchMarker,e.index,-i+t),e};class jde extends U2{constructor(e,t,i){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(n=>{n===null?this.childListChanged=!0:this.keysChanged.add(n)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];$i(e,i=>{const n=new Map,r=new Map;let o=this.target._start,a=null;const l={};let c="",u=0,d=0;const g=()=>{if(a!==null){let p=null;switch(a){case"delete":d>0&&(p={delete:d}),d=0;break;case"insert":(typeof c=="object"||c.length>0)&&(p={insert:c},n.size>0&&(p.attributes={},n.forEach((_,C)=>{_!==null&&(p.attributes[C]=_)}))),c="";break;case"retain":u>0&&(p={retain:u},kue(l)||(p.attributes=Sue({},l))),u=0;break}p&&t.push(p),a=null}};for(;o!==null;){switch(o.content.constructor){case sc:case im:this.adds(o)?this.deletes(o)||(g(),a="insert",c=o.content.getContent()[0],g()):this.deletes(o)?(a!=="delete"&&(g(),a="delete"),d+=1):o.deleted||(a!=="retain"&&(g(),a="retain"),u+=1);break;case ql:this.adds(o)?this.deletes(o)||(a!=="insert"&&(g(),a="insert"),c+=o.content.str):this.deletes(o)?(a!=="delete"&&(g(),a="delete"),d+=o.length):o.deleted||(a!=="retain"&&(g(),a="retain"),u+=o.length);break;case cs:{const{key:p,value:_}=o.content;if(this.adds(o)){if(!this.deletes(o)){const C=n.get(p)??null;Mu(C,_)?_!==null&&o.delete(i):(a==="retain"&&g(),Mu(_,r.get(p)??null)?delete l[p]:l[p]=_)}}else if(this.deletes(o)){r.set(p,_);const C=n.get(p)??null;Mu(C,_)||(a==="retain"&&g(),l[p]=C)}else if(!o.deleted){r.set(p,_);const C=l[p];C!==void 0&&(Mu(C,_)?C!==null&&o.delete(i):(a==="retain"&&g(),_===null?delete l[p]:l[p]=_))}o.deleted||(a==="insert"&&g(),M1(n,o.content));break}}o=o.right}for(g();t.length>0;){const p=t[t.length-1];if(p.retain!==void 0&&p.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class n1 extends zs{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??ar(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new n1}clone(){const e=new n1;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const i=new jde(this,e,t);$2(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??ar();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===ql&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?$i(this.doc,i=>{const n=new UA(null,this._start,0,new Map);for(let r=0;r<e.length;r++){const o=e[r];if(o.insert!==void 0){const a=!t&&typeof o.insert=="string"&&r===e.length-1&&n.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&MI(i,this,n,a,o.attributes||{})}else o.retain!==void 0?lH(i,this,n,o.retain,o.attributes||{}):o.delete!==void 0&&cH(i,n,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,i){this.doc??ar();const n=[],r=new Map,o=this.doc;let a="",l=this._start;function c(){if(a.length>0){const d={};let g=!1;r.forEach((_,C)=>{g=!0,d[C]=_});const p={insert:a};g&&(p.attributes=d),n.push(p),a=""}}const u=()=>{for(;l!==null;){if(Dp(l,e)||t!==void 0&&Dp(l,t))switch(l.content.constructor){case ql:{const d=r.get("ychange");e!==void 0&&!Dp(l,e)?(d===void 0||d.user!==l.id.client||d.type!=="removed")&&(c(),r.set("ychange",i?i("removed",l.id):{type:"removed"})):t!==void 0&&!Dp(l,t)?(d===void 0||d.user!==l.id.client||d.type!=="added")&&(c(),r.set("ychange",i?i("added",l.id):{type:"added"})):d!==void 0&&(c(),r.delete("ychange")),a+=l.content.str;break}case sc:case im:{c();const d={insert:l.content.getContent()[0]};if(r.size>0){const g={};d.attributes=g,r.forEach((p,_)=>{g[_]=p})}n.push(d);break}case cs:Dp(l,e)&&(c(),M1(r,l.content));break}l=l.right}c()};return e||t?$i(o,d=>{e&&HA(d,e),t&&HA(d,t),u()},"cleanup"):u(),n}insert(e,t,i){if(t.length<=0)return;const n=this.doc;n!==null?$i(n,r=>{const o=NS(r,this,e,!i);i||(i={},o.currentAttributes.forEach((a,l)=>{i[l]=a})),MI(r,this,o,t,i)}):this._pending.push(()=>this.insert(e,t,i))}insertEmbed(e,t,i){const n=this.doc;n!==null?$i(n,r=>{const o=NS(r,this,e,!i);MI(r,this,o,t,i||{})}):this._pending.push(()=>this.insertEmbed(e,t,i||{}))}delete(e,t){if(t===0)return;const i=this.doc;i!==null?$i(i,n=>{cH(n,NS(n,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,i){if(t===0)return;const n=this.doc;n!==null?$i(n,r=>{const o=NS(r,this,e,!1);o.right!==null&&lH(r,this,o,t,i)}):this._pending.push(()=>this.format(e,t,i))}removeAttribute(e){this.doc!==null?$i(this.doc,t=>{AL(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?$i(this.doc,i=>{ZP(i,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return JP(this,e)}getAttributes(){return WY(this)}_write(e){e.writeTypeRef(hfe)}}const $de=s=>new n1;class OI{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??ar()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===s1||t.constructor===Ig)&&t._start!==null)e=t._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Ig extends zs{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ig}clone(){const e=new Ig;return e.insert(0,this.toArray().map(t=>t instanceof zs?t.clone():t)),e}get length(){return this.doc??ar(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new OI(this,e)}querySelector(e){e=e.toUpperCase();const i=new OI(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),Tg(new OI(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){$2(this,e,new Kde(this,t,e))}toString(){return OY(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},i){const n=e.createDocumentFragment();return i!==void 0&&i._createAssociation(n,this),sw(this,r=>{n.insertBefore(r.toDOM(e,t,i),null)}),n}insert(e,t){this.doc!==null?$i(this.doc,i=>{BY(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)$i(this.doc,i=>{const n=e&&e instanceof zs?e._item:e;RL(i,this,n,t)});else{const i=this._prelimContent,n=e===null?0:i.findIndex(r=>r===e)+1;if(n===0&&e!==null)throw ld("Reference item not found");i.splice(n,0,...t)}}delete(e,t=1){this.doc!==null?$i(this.doc,i=>{VY(i,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return MY(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return PY(this,e)}slice(e=0,t=this.length){return AY(this,e,t)}forEach(e){sw(this,e)}_write(e){e.writeTypeRef(dfe)}}const qde=s=>new Ig;class s1 extends Ig{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((i,n)=>{this.setAttribute(n,i)}),this._prelimAttrs=null}_copy(){return new s1(this.nodeName)}clone(){const e=new s1(this.nodeName),t=this.getAttributes();return Lue(t,(i,n)=>{typeof i=="string"&&e.setAttribute(n,i)}),e.insert(0,this.toArray().map(i=>i instanceof zs?i.clone():i)),e}toString(){const e=this.getAttributes(),t=[],i=[];for(const a in e)i.push(a);i.sort();const n=i.length;for(let a=0;a<n;a++){const l=i[a];t.push(l+'="'+e[l]+'"')}const r=this.nodeName.toLocaleLowerCase(),o=t.length>0?" "+t.join(" "):"";return`<${r}${o}>${super.toString()}</${r}>`}removeAttribute(e){this.doc!==null?$i(this.doc,t=>{AL(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?$i(this.doc,i=>{ZP(i,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return JP(this,e)}hasAttribute(e){return HY(this,e)}getAttributes(e){return e?Pde(this,e):WY(this)}toDOM(e=document,t={},i){const n=e.createElement(this.nodeName),r=this.getAttributes();for(const o in r){const a=r[o];typeof a=="string"&&n.setAttribute(o,a)}return sw(this,o=>{n.appendChild(o.toDOM(e,t,i))}),i!==void 0&&i._createAssociation(n,this),n}_write(e){e.writeTypeRef(ufe),e.writeKey(this.nodeName)}}const Gde=s=>new s1(s.readKey());class Kde extends U2{constructor(e,t,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(n=>{n===null?this.childListChanged=!0:this.attributesChanged.add(n)})}}class ML extends i1{constructor(e){super(),this.hookName=e}_copy(){return new ML(this.hookName)}clone(){const e=new ML(this.hookName);return this.forEach((t,i)=>{e.set(i,t)}),e}toDOM(e=document,t={},i){const n=t[this.hookName];let r;return n!==void 0?r=n.createDom(this):r=document.createElement(this.hookName),r.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(r,this),r}_write(e){e.writeTypeRef(ffe),e.writeKey(this.hookName)}}const Yde=s=>new ML(s.readKey());class OL extends n1{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new OL}clone(){const e=new OL;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,i){const n=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{const t=[];for(const n in e.attributes){const r=[];for(const o in e.attributes[n])r.push({key:o,value:e.attributes[n][o]});r.sort((o,a)=>o.key<a.key?-1:1),t.push({nodeName:n,attrs:r})}t.sort((n,r)=>n.nodeName<r.nodeName?-1:1);let i="";for(let n=0;n<t.length;n++){const r=t[n];i+=`<${r.nodeName}`;for(let o=0;o<r.attrs.length;o++){const a=r.attrs[o];i+=` ${a.key}="${a.value}"`}i+=">"}i+=e.insert;for(let n=t.length-1;n>=0;n--)i+=`</${t[n].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(gfe)}}const Qde=s=>new OL;class e7{constructor(e,t){this.id=e,this.length=t}get deleted(){throw Fl()}mergeWith(e){return!1}write(e,t,i){throw Fl()}integrate(e,t){throw Fl()}}const Xde=0;class ra extends e7{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),EY(e.doc.store,this)}write(e,t){e.writeInfo(Xde),e.writeLen(this.length-t)}getMissing(e,t){return null}}class xv{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new xv(this.content)}splice(e){throw Fl()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const Zde=s=>new xv(s.readBuf());class rw{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new rw(this.len)}splice(e){const t=new rw(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){DL(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const Jde=s=>new rw(s.readLen()),qY=(s,e)=>new A1({guid:s,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Lv{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Lv(qY(this.doc.guid,this.opts))}splice(e){throw Fl()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const efe=s=>new Lv(qY(s.readString(),s.readAny()));class im{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new im(this.embed)}splice(e){throw Fl()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const tfe=s=>new im(s.readJSON());class cs{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new cs(this.key,this.value)}splice(e){throw Fl()}mergeWith(e){return!1}integrate(e,t){const i=t.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const ife=s=>new cs(s.readKey(),s.readJSON());class PL{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new PL(this.arr)}splice(e){const t=new PL(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let n=t;n<i;n++){const r=this.arr[n];e.writeString(r===void 0?"undefined":JSON.stringify(r))}}getRef(){return 2}}const nfe=s=>{const e=s.readLen(),t=[];for(let i=0;i<e;i++){const n=s.readString();n==="undefined"?t.push(void 0):t.push(JSON.parse(n))}return new PL(t)},sfe=EL("node_env")==="development";class Rg{constructor(e){this.arr=e,sfe&&lY(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Rg(this.arr)}splice(e){const t=new Rg(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let n=t;n<i;n++){const r=this.arr[n];e.writeAny(r)}}getRef(){return 8}}const rfe=s=>{const e=s.readLen(),t=[];for(let i=0;i<e;i++)t.push(s.readAny());return new Rg(t)};class ql{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ql(this.str)}splice(e){const t=new ql(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const ofe=s=>new ql(s.readString()),afe=[Bde,Wde,$de,Gde,qde,Yde,Qde],lfe=0,cfe=1,hfe=2,ufe=3,dfe=4,ffe=5,gfe=6;class sc{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new sc(this.type._copy())}splice(e){throw Fl()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const mfe=s=>new sc(afe[s.readTypeRef()](s)),hH=(s,e)=>{let t=e,i=0,n;do i>0&&(t=Bt(t.client,t.clock+i)),n=C_(s,t),i=t.clock-n.id.clock,t=n.redone;while(t!==null&&n instanceof Sn);return{item:n,diff:i}},FL=(s,e,t)=>{const{client:i,clock:n}=e.id,r=new Sn(Bt(i,n+t),e,Bt(i,n+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&r.markDeleted(),e.keep&&(r.keep=!0),e.redone!==null&&(r.redone=Bt(e.redone.client,e.redone.clock+t)),e.right=r,r.right!==null&&(r.right.left=r),s._mergeStructs.push(r),r.parentSub!==null&&r.right===null&&r.parent._map.set(r.parentSub,r),e.length=t,r};class Sn extends e7{constructor(e,t,i,n,r,o,a,l){super(e,l.getLength()),this.origin=i,this.left=t,this.right=n,this.rightOrigin=r,this.parent=o,this.parentSub=a,this.redone=null,this.content=l,this.info=this.content.isCountable()?UW:0}set marker(e){(this.info&NI)>0!==e&&(this.info^=NI)}get marker(){return(this.info&NI)>0}get keep(){return(this.info&zW)>0}set keep(e){this.keep!==e&&(this.info^=zW)}get countable(){return(this.info&UW)>0}get deleted(){return(this.info&TI)>0}set deleted(e){this.deleted!==e&&(this.info^=TI)}markDeleted(){this.info|=TI}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Zn(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Zn(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===b_&&this.id.client!==this.parent.client&&this.parent.clock>=Zn(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=nH(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=cd(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ra||this.right&&this.right.constructor===ra)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Sn?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Sn&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===b_){const i=C_(t,this.parent);i.constructor===ra?this.parent=null:this.parent=i.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=nH(e,e.doc.store,Bt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,n;if(i!==null)n=i.right;else if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start;const r=new Set,o=new Set;for(;n!==null&&n!==this.right;){if(o.add(n),r.add(n),ES(this.origin,n.origin)){if(n.id.client<this.id.client)i=n,r.clear();else if(ES(this.rightOrigin,n.rightOrigin))break}else if(n.origin!==null&&o.has(C_(e.doc.store,n.origin)))r.has(C_(e.doc.store,n.origin))||(i=n,r.clear());else break;n=n.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),EY(e.doc.store,this),this.content.integrate(e,this),rH(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new ra(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Bt(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&ES(e.origin,this.lastId)&&this.right===e&&ES(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),DL(e.deleteSet,this.id.client,this.id.clock,this.length),rH(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw fa();this.content.gc(e),t?wde(e,this,new ra(this.id,this.length)):this.content=new rw(this.length)}write(e,t){const i=t>0?Bt(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,r=this.parentSub,o=this.content.getRef()&V2|(i===null?0:Fo)|(n===null?0:yh)|(r===null?0:ZC);if(e.writeInfo(o),i!==null&&e.writeLeftID(i),n!==null&&e.writeRightID(n),i===null&&n===null){const a=this.parent;if(a._item!==void 0){const l=a._item;if(l===null){const c=LY(a);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===b_?(e.writeParentInfo(!1),e.writeLeftID(a)):fa();r!==null&&e.writeString(r)}this.content.write(e,t)}}const GY=(s,e)=>pfe[e&V2](s),pfe=[()=>{fa()},Jde,nfe,Zde,ofe,tfe,ife,mfe,rfe,efe,()=>{fa()}],_fe=10;class oa extends e7{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){fa()}write(e,t){e.writeInfo(_fe),ri(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const KY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},YY="__ $YJS$ __";KY[YY]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");KY[YY]=!0;function bfe(s){if(s.length===0)throw new Error("Invalid tail call");return[s.slice(0,s.length-1),s[s.length-1]]}function sn(s,e,t=(i,n)=>i===n){if(s===e)return!0;if(!s||!e||s.length!==e.length)return!1;for(let i=0,n=s.length;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function Cfe(s,e){const t=s.length-1;e<t&&(s[e]=s[t]),s.pop()}function wfe(s,e,t){return QY(s.length,i=>t(s[i],e))}function QY(s,e){let t=0,i=s-1;for(;t<=i;){const n=(t+i)/2|0,r=e(n);if(r<0)t=n+1;else if(r>0)i=n-1;else return n}return-(t+1)}function*t7(s,e){let t,i;for(const n of s)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function XY(s,e){for(let t=0;t<=s.length;t++)e(t===0?void 0:s[t-1],t===s.length?void 0:s[t])}function vfe(s,e){for(let t=0;t<s.length;t++)e(t===0?void 0:s[t-1],s[t],t+1===s.length?void 0:s[t+1])}function i7(s){return s.filter(e=>!!e)}function uH(s){let e=0;for(let t=0;t<s.length;t++)s[t]&&(s[e]=s[t],e+=1);s.length=e}function yfe(s){return!Array.isArray(s)||s.length===0}function q2(s){return Array.isArray(s)&&s.length>0}function Ag(s,e=t=>t){const t=new Set;return s.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function Ms(s,e){let t=typeof e=="number"?s:0;typeof e=="number"?t=s:(t=0,e=s);const i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function G2(s,e,t){const i=s.slice(0,e),n=s.slice(e);return i.concat(t,n)}function PI(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.unshift(e))}function IS(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.push(e))}function jA(s,e){for(const t of e)s.push(t)}function Sfe(s,e,t){const i=ZY(s,e),n=s.length,r=t.length;s.length=n+r;for(let o=n-1;o>=i;o--)s[o+r]=s[o];for(let o=0;o<r;o++)s[o+i]=t[o]}function BL(s,e,t,i){const n=ZY(s,e);let r=s.splice(n,t);return r===void 0&&(r=[]),Sfe(s,n,i),r}function ZY(s,e){return e<0?Math.max(e+s.length,0):Math.min(e,s.length)}var ow;(function(s){function e(r){return r<0}s.isLessThan=e;function t(r){return r<=0}s.isLessThanOrEqual=t;function i(r){return r>0}s.isGreaterThan=i;function n(r){return r===0}s.isNeitherLessOrGreaterThan=n,s.greaterThan=1,s.lessThan=-1,s.neitherLessOrGreaterThan=0})(ow||(ow={}));function oo(s,e){return(t,i)=>e(s(t),s(i))}function xfe(...s){return(e,t)=>{for(const i of s){const n=i(e,t);if(!ow.isNeitherLessOrGreaterThan(n))return n}return ow.neitherLessOrGreaterThan}}const Sh=(s,e)=>s-e,Lfe=(s,e)=>Sh(s?1:0,e?1:0);function kfe(s){return(e,t)=>-s(e,t)}class Rh{constructor(e){this.firstIdx=0,this.items=e,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}const e_=class e_{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new e_(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new e_(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||ow.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};e_.empty=new e_(e=>{});let ig=e_;class Efe{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?r1.isErrorNoTelemetry(e)?new r1(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const n7=new Efe;function VL(s){n7.onUnexpectedError(s)}function It(s){kv(s)||n7.onUnexpectedError(s)}function s7(s){kv(s)||n7.onUnexpectedExternalError(s)}function $A(s){if(s instanceof Error){const{name:e,message:t,cause:i}=s,n=s.stacktrace||s.stack;return{$isError:!0,name:e,message:t,stack:n,noTelemetry:r1.isErrorNoTelemetry(s),cause:i?$A(i):void 0,code:s.code}}return s}const WL="Canceled";function kv(s){return s instanceof O1?!0:s instanceof Error&&s.name===WL&&s.message===WL}class O1 extends Error{constructor(){super(WL),this.name=this.message}}function Dfe(){const s=new Error(WL);return s.name=s.message,s}function K2(s){return s?new Error(`Illegal argument: ${s}`):new Error("Illegal argument")}function HL(s){return s?new Error(`Illegal state: ${s}`):new Error("Illegal state")}class Tfe extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class r1 extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof r1)return e;const t=new r1;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class Pe extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,Pe.prototype)}}function FI(s,e){if(!s)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function r7(s,e="Unreachable"){throw new Error(e)}function zL(s,e="unexpected state"){if(!s)throw typeof e=="string"?new Pe(`Assertion Failed: ${e}`):e}function dH(s,e="Soft Assertion Failed"){s||It(new Pe(e))}function Mg(s){if(!s()){debugger;s(),It(new Pe("Assertion Failed"))}}function o7(s,e){let t=0;for(;t<s.length-1;){const i=s[t],n=s[t+1];if(!e(i,n))return!1;t++}return!0}function Pn(s){return typeof s=="string"}function Vs(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&!(s instanceof RegExp)&&!(s instanceof Date)}function Nfe(s){const e=Object.getPrototypeOf(Uint8Array);return typeof s=="object"&&s instanceof e}function nm(s){return typeof s=="number"&&!isNaN(s)}function qA(s){return!!s&&typeof s[Symbol.iterator]=="function"}function GA(s){return s===!0||s===!1}function to(s){return typeof s>"u"}function Io(s){return!Ro(s)}function Ro(s){return to(s)||s===null}function Qu(s,e){if(!s)throw new Error("Unexpected type")}function JY(s){return zL(s!=null,"Argument is `undefined` or `null`."),s}function o1(s){return typeof s=="function"}function Ife(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++)Rfe(s[i],e[i])}function Rfe(s,e){if(Pn(e)){if(typeof s!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(o1(e)){try{if(s instanceof e)return}catch{}if(!Ro(s)&&s.constructor===e||e.length===1&&e.call(void 0,s)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function eh(s){if(!s||typeof s!="object"||s instanceof RegExp)return s;const e=Array.isArray(s)?[]:{};return Object.entries(s).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?eh(i):i}),e}function Afe(s){if(!s||typeof s!="object")return s;const e=[s];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(eQ.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!Nfe(n)&&e.push(n)}}return s}const eQ=Object.prototype.hasOwnProperty;function tQ(s,e){return KA(s,e,new Set)}function KA(s,e,t){if(Ro(s))return s;const i=e(s);if(typeof i<"u")return i;if(Array.isArray(s)){const n=[];for(const r of s)n.push(KA(r,e,t));return n}if(Vs(s)){if(t.has(s))throw new Error("Cannot clone recursive data-structure");t.add(s);const n={};for(const r in s)eQ.call(s,r)&&(n[r]=KA(s[r],e,t));return t.delete(s),n}return s}function xr(s,e){if(s===e)return!0;if(s==null||e===null||e===void 0||typeof s!=typeof e||typeof s!="object"||Array.isArray(s)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(s)){if(s.length!==e.length)return!1;for(t=0;t<s.length;t++)if(!xr(s[t],e[t]))return!1}else{const n=[];for(i in s)n.push(i);n.sort();const r=[];for(i in e)r.push(i);if(r.sort(),!xr(n,r))return!1;for(t=0;t<n.length;t++)if(!xr(s[n[t]],e[n[t]]))return!1}return!0}function iQ(){return globalThis._VSCODE_NLS_MESSAGES}function a7(){return globalThis._VSCODE_NLS_LANGUAGE}const Mfe=a7()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function fH(s,e){let t;return e.length===0?t=s:t=s.replace(/\{(\d+)\}/g,(i,n)=>{const r=n[0],o=e[r];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),Mfe&&(t=""+t.replace(/[aouei]/g,"$&$&")+""),t}function w(s,e,...t){return fH(typeof s=="number"?Ofe(s,e):e,t)}function Ofe(s,e){var i;const t=(i=iQ())==null?void 0:i[s];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${s} !!!`)}return t}const Hf="en";let aw=!1,lw=!1,B0=!1,nQ=!1,l7=!1,c7=!1,sQ=!1,RS,BI=Hf,gH=Hf,Pfe,Ea;const xh=globalThis;let Cs;var cG;typeof xh.vscode<"u"&&typeof xh.vscode.process<"u"?Cs=xh.vscode.process:typeof process<"u"&&typeof((cG=process==null?void 0:process.versions)==null?void 0:cG.node)=="string"&&(Cs=process);var hG;const Ffe=typeof((hG=Cs==null?void 0:Cs.versions)==null?void 0:hG.electron)=="string",Bfe=Ffe&&(Cs==null?void 0:Cs.type)==="renderer";var uG;if(typeof Cs=="object"){aw=Cs.platform==="win32",lw=Cs.platform==="darwin",B0=Cs.platform==="linux",B0&&Cs.env.SNAP&&Cs.env.SNAP_REVISION,Cs.env.CI||Cs.env.BUILD_ARTIFACTSTAGINGDIRECTORY||Cs.env.GITHUB_WORKSPACE,RS=Hf,BI=Hf;const s=Cs.env.VSCODE_NLS_CONFIG;if(s)try{const e=JSON.parse(s);RS=e.userLocale,gH=e.osLocale,BI=e.resolvedLanguage||Hf,Pfe=(uG=e.languagePack)==null?void 0:uG.translationsConfigFile}catch{}nQ=!0}else typeof navigator=="object"&&!Bfe?(Ea=navigator.userAgent,aw=Ea.indexOf("Windows")>=0,lw=Ea.indexOf("Macintosh")>=0,c7=(Ea.indexOf("Macintosh")>=0||Ea.indexOf("iPad")>=0||Ea.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,B0=Ea.indexOf("Linux")>=0,sQ=(Ea==null?void 0:Ea.indexOf("Mobi"))>=0,l7=!0,BI=a7()||Hf,RS=navigator.language.toLowerCase(),gH=RS):console.error("Unable to resolve platform.");let Ax=0;lw?Ax=1:aw?Ax=3:B0&&(Ax=2);const cr=aw,rt=lw,kr=B0,cw=nQ,Fh=l7,Vfe=l7&&typeof xh.importScripts=="function",Wfe=Vfe?xh.origin:void 0,Gl=c7,rQ=sQ,VI=Ax,Kl=Ea,Hfe=typeof xh.postMessage=="function"&&!xh.importScripts,Ev=(()=>{if(Hfe){const s=[];xh.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=s.length;i<n;i++){const r=s[i];if(r.id===t.data.vscodeScheduleAsyncWork){s.splice(i,1),r.callback();return}}});let e=0;return t=>{const i=++e;s.push({id:i,callback:t}),xh.postMessage({vscodeScheduleAsyncWork:i},"*")}}return s=>setTimeout(s)})(),ca=lw||c7?2:aw?1:3;let mH=!0,pH=!1;function zfe(){if(!pH){pH=!0;const s=new Uint8Array(2);s[0]=1,s[1]=2,mH=new Uint16Array(s.buffer)[0]===513}return mH}const h7=!!(Kl&&Kl.indexOf("Chrome")>=0),Ufe=!!(Kl&&Kl.indexOf("Firefox")>=0),jfe=!!(!h7&&Kl&&Kl.indexOf("Safari")>=0),oQ=!!(Kl&&Kl.indexOf("Edg/")>=0),$fe=!!(Kl&&Kl.indexOf("Android")>=0);function hw(s,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=s.apply(t,arguments)),n}}var _t;(function(s){function e(N){return!!N&&typeof N=="object"&&typeof N[Symbol.iterator]=="function"}s.is=e;const t=Object.freeze([]);function i(){return t}s.empty=i;function*n(N){yield N}s.single=n;function r(N){return e(N)?N:n(N)}s.wrap=r;function o(N){return N||t}s.from=o;function*a(N){for(let A=N.length-1;A>=0;A--)yield N[A]}s.reverse=a;function l(N){return!N||N[Symbol.iterator]().next().done===!0}s.isEmpty=l;function c(N){return N[Symbol.iterator]().next().value}s.first=c;function u(N,A){let O=0;for(const W of N)if(A(W,O++))return!0;return!1}s.some=u;function d(N,A){let O=0;for(const W of N)if(!A(W,O++))return!1;return!0}s.every=d;function g(N,A){for(const O of N)if(A(O))return O}s.find=g;function*p(N,A){for(const O of N)A(O)&&(yield O)}s.filter=p;function*_(N,A){let O=0;for(const W of N)yield A(W,O++)}s.map=_;function*C(N,A){let O=0;for(const W of N)yield*A(W,O++)}s.flatMap=C;function*v(...N){for(const A of N)qA(A)?yield*A:yield A}s.concat=v;function x(N,A,O){let W=O;for(const j of N)W=A(W,j);return W}s.reduce=x;function S(N){let A=0;for(const O of N)A++;return A}s.length=S;function*k(N,A,O=N.length){for(A<-N.length&&(A=0),A<0&&(A+=N.length),O<0?O+=N.length:O>N.length&&(O=N.length);A<O;A++)yield N[A]}s.slice=k;function E(N,A=Number.POSITIVE_INFINITY){const O=[];if(A===0)return[O,N];const W=N[Symbol.iterator]();for(let j=0;j<A;j++){const F=W.next();if(F.done)return[O,s.empty()];O.push(F.value)}return[O,{[Symbol.iterator](){return W}}]}s.consume=E;async function T(N){const A=[];for await(const O of N)A.push(O);return A}s.asyncToArray=T;async function R(N){let A=[];for await(const O of N)A=A.concat(O);return A}s.asyncToArrayFlat=R})(_t||(_t={}));function Y2(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&s.dispose.length===0}function Zi(s){if(_t.is(s)){const e=[];for(const t of s)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(s)?[]:s}else if(s)return s.dispose(),s}function Bl(...s){return Fe(()=>Zi(s))}class qfe{constructor(e){this._isDisposed=!1,this._fn=e}dispose(){if(!this._isDisposed){if(!this._fn)throw new Error("Unbound disposable context: Need to use an arrow function to preserve the value of this");this._isDisposed=!0,this._fn()}}}function Fe(s){return new qfe(s)}const AE=class AE{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Zi(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e||e===ne.None)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?AE.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}};AE.DISABLE_DISPOSED_WARNING=!1;let Ee=AE;const W9=class W9{constructor(){this._store=new Ee,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};W9.None=Object.freeze({dispose(){}});let ne=W9;class kn{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}}class Gfe{constructor(e){this.object=e}dispose(){}}class u7{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Zi(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){var n;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(n=this._store.get(e))==null||n.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}var bh;let an=(bh=class{constructor(e){this.element=e,this.next=bh.Undefined,this.prev=bh.Undefined}},bh.Undefined=new bh(void 0),bh);class sr{constructor(){this._first=an.Undefined,this._last=an.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===an.Undefined}clear(){let e=this._first;for(;e!==an.Undefined;){const t=e.next;e.prev=an.Undefined,e.next=an.Undefined,e=t}this._first=an.Undefined,this._last=an.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new an(e);if(this._first===an.Undefined)this._first=i,this._last=i;else if(t){const r=this._last;this._last=i,i.prev=r,r.next=i}else{const r=this._first;this._first=i,i.next=r,r.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==an.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==an.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==an.Undefined&&e.next!==an.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===an.Undefined&&e.next===an.Undefined?(this._first=an.Undefined,this._last=an.Undefined):e.next===an.Undefined?(this._last=this._last.prev,this._last.next=an.Undefined):e.prev===an.Undefined&&(this._first=this._first.next,this._first.prev=an.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==an.Undefined;)yield e.element,e=e.next}}const Kfe=globalThis.performance.now.bind(globalThis.performance);class Ah{static create(e){return new Ah(e)}constructor(e){this._now=e===!1?Date.now:Kfe,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var ge;(function(s){s.None=()=>ne.None;function e(F,q){return g(F,()=>{},0,void 0,!0,void 0,q)}s.defer=e;function t(F){return(q,Z=null,K)=>{let U=!1,G;return G=F(Q=>{if(!U)return G?G.dispose():U=!0,q.call(Z,Q)},null,K),U&&G.dispose(),G}}s.once=t;function i(F,q){return s.once(s.filter(F,q))}s.onceIf=i;function n(F,q,Z){return u((K,U=null,G)=>F(Q=>K.call(U,q(Q)),null,G),Z)}s.map=n;function r(F,q,Z){return u((K,U=null,G)=>F(Q=>{q(Q),K.call(U,Q)},null,G),Z)}s.forEach=r;function o(F,q,Z){return u((K,U=null,G)=>F(Q=>q(Q)&&K.call(U,Q),null,G),Z)}s.filter=o;function a(F){return F}s.signal=a;function l(...F){return(q,Z=null,K)=>{const U=Bl(...F.map(G=>G(Q=>q.call(Z,Q))));return d(U,K)}}s.any=l;function c(F,q,Z,K){let U=Z;return n(F,G=>(U=q(U,G),U),K)}s.reduce=c;function u(F,q){let Z;const K={onWillAddFirstListener(){Z=F(U.fire,U)},onDidRemoveLastListener(){Z==null||Z.dispose()}},U=new $(K);return q==null||q.add(U),U.event}function d(F,q){return q instanceof Array?q.push(F):q&&q.add(F),F}function g(F,q,Z=100,K=!1,U=!1,G,Q){let le,ve,V,ce=0,oe;const Se={leakWarningThreshold:G,onWillAddFirstListener(){le=F(Oe=>{ce++,ve=q(ve,Oe),K&&!V&&(me.fire(ve),ve=void 0),oe=()=>{const it=ve;ve=void 0,V=void 0,(!K||ce>1)&&me.fire(it),ce=0},typeof Z=="number"?(V&&clearTimeout(V),V=setTimeout(oe,Z)):V===void 0&&(V=null,queueMicrotask(oe))})},onWillRemoveListener(){U&&ce>0&&(oe==null||oe())},onDidRemoveLastListener(){oe=void 0,le.dispose()}},me=new $(Se);return Q==null||Q.add(me),me.event}s.debounce=g;function p(F,q=0,Z){return s.debounce(F,(K,U)=>K?(K.push(U),K):[U],q,void 0,!0,void 0,Z)}s.accumulate=p;function _(F,q=(K,U)=>K===U,Z){let K=!0,U;return o(F,G=>{const Q=K||!q(G,U);return K=!1,U=G,Q},Z)}s.latch=_;function C(F,q,Z){return[s.filter(F,q,Z),s.filter(F,K=>!q(K),Z)]}s.split=C;function v(F,q=!1,Z=[],K){let U=Z.slice(),G=F(ve=>{U?U.push(ve):le.fire(ve)});K&&K.add(G);const Q=()=>{U==null||U.forEach(ve=>le.fire(ve)),U=null},le=new $({onWillAddFirstListener(){G||(G=F(ve=>le.fire(ve)),K&&K.add(G))},onDidAddFirstListener(){U&&(q?setTimeout(Q):Q())},onDidRemoveLastListener(){G&&G.dispose(),G=null}});return K&&K.add(le),le.event}s.buffer=v;function x(F,q){return(K,U,G)=>{const Q=q(new k);return F(function(le){const ve=Q.evaluate(le);ve!==S&&K.call(U,ve)},void 0,G)}}s.chain=x;const S=Symbol("HaltChainable");class k{constructor(){this.steps=[]}map(q){return this.steps.push(q),this}forEach(q){return this.steps.push(Z=>(q(Z),Z)),this}filter(q){return this.steps.push(Z=>q(Z)?Z:S),this}reduce(q,Z){let K=Z;return this.steps.push(U=>(K=q(K,U),K)),this}latch(q=(Z,K)=>Z===K){let Z=!0,K;return this.steps.push(U=>{const G=Z||!q(U,K);return Z=!1,K=U,G?U:S}),this}evaluate(q){for(const Z of this.steps)if(q=Z(q),q===S)break;return q}}function E(F,q,Z=K=>K){const K=(...le)=>Q.fire(Z(...le)),U=()=>F.on(q,K),G=()=>F.removeListener(q,K),Q=new $({onWillAddFirstListener:U,onDidRemoveLastListener:G});return Q.event}s.fromNodeEventEmitter=E;function T(F,q,Z=K=>K){const K=(...le)=>Q.fire(Z(...le)),U=()=>F.addEventListener(q,K),G=()=>F.removeEventListener(q,K),Q=new $({onWillAddFirstListener:U,onDidRemoveLastListener:G});return Q.event}s.fromDOMEventEmitter=T;function R(F,q){let Z;const K=new Promise((U,G)=>{const Q=t(F)(U,null,q);Z=()=>Q.dispose()});return K.cancel=Z,K}s.toPromise=R;function N(F,q){return F(Z=>q.fire(Z))}s.forward=N;function A(F,q,Z){return q(Z),F(K=>q(K))}s.runAndSubscribe=A;class O{constructor(q,Z){this._observable=q,this._counter=0,this._hasChanged=!1;const K={onWillAddFirstListener:()=>{q.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{q.removeObserver(this)}};this.emitter=new $(K),Z&&Z.add(this.emitter)}beginUpdate(q){this._counter++}handlePossibleChange(q){}handleChange(q,Z){this._hasChanged=!0}endUpdate(q){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function W(F,q){return new O(F,q).emitter.event}s.fromObservable=W;function j(F){return(q,Z,K)=>{let U=0,G=!1;const Q={beginUpdate(){U++},endUpdate(){U--,U===0&&(F.reportChanges(),G&&(G=!1,q.call(Z)))},handlePossibleChange(){},handleChange(){G=!0}};F.addObserver(Q),F.reportChanges();const le={dispose(){F.removeObserver(Q)}};return K instanceof Ee?K.add(le):Array.isArray(K)&&K.push(le),le}}s.fromObservableLight=j})(ge||(ge={}));const t_=class t_{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${t_._idPool++}`,t_.all.add(this)}start(e){this._stopWatch=new Ah,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};t_.all=new Set,t_._idPool=0;let YA=t_,Yfe=-1;const ME=class ME{constructor(e,t,i=(ME._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[r,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(r);const l=new Qfe(a,r);this._errorHandler(l)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}};ME._idPool=1;let QA=ME;class d7{static create(){const e=new Error;return new d7(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class Qfe extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class Xfe extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}class WI{constructor(e){this.value=e}}const Zfe=2;let $=class{constructor(e){var t,i,n,r;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new QA((e==null?void 0:e.onListenerError)??It,((i=this._options)==null?void 0:i.leakWarningThreshold)??Yfe):void 0,this._perfMon=(n=this._options)!=null&&n._profName?new YA(this._options._profName):void 0,this._deliveryQueue=(r=this._options)==null?void 0:r.deliveryQueue}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(n=this._leakageMon)==null||n.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,l,c,u,d,g,p;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const _=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(_);const C=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],v=new Xfe(`${_}. HINT: Stack shows most frequent listener (${C[1]}-times)`,C[0]);return(((a=this._options)==null?void 0:a.onListenerError)||It)(v),ne.None}if(this._disposed)return ne.None;t&&(e=e.bind(t));const n=new WI(e);let r;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=d7.create(),r=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof WI?(this._deliveryQueue??(this._deliveryQueue=new aQ),this._listeners=[this._listeners,n]):this._listeners.push(n):((c=(l=this._options)==null?void 0:l.onWillAddFirstListener)==null||c.call(l,this),this._listeners=n,(d=(u=this._options)==null?void 0:u.onDidAddFirstListener)==null||d.call(u,this)),(p=(g=this._options)==null?void 0:g.onDidAddListener)==null||p.call(g,this),this._size++;const o=Fe(()=>{r==null||r(),this._removeListener(n)});return i instanceof Ee?i.add(o):Array.isArray(i)&&i.push(o),o}),this._event}_removeListener(e){var r,o,a,l;if((o=(r=this._options)==null?void 0:r.onWillRemoveListener)==null||o.call(r,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(l=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||l.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*Zfe<=t.length){let c=0;for(let u=0;u<t.length;u++)t[u]?t[c++]=t[u]:n&&c<this._deliveryQueue.end&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=c}}_deliver(e,t){var n;if(!e)return;const i=((n=this._options)==null?void 0:n.onListenerError)||It;if(!i){e.value(t);return}try{e.value(t)}catch(r){i(r)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,n,r;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(n=this._perfMon)==null||n.start(this._size),this._listeners)if(this._listeners instanceof WI)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(r=this._perfMon)==null||r.stop()}hasListeners(){return this._size>0}};const Jfe=()=>new aQ;class aQ{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class uw extends ${constructor(e){super(e),this._isPaused=0,this._eventQueue=new sr,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class lQ extends uw{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class ege extends ${constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e==null?void 0:e.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class tge{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new $({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),Fe(hw(()=>{this.hasListeners&&this.unhook(t);const n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){var t;(t=e.listener)==null||t.dispose(),e.listener=null}dispose(){var e;this.emitter.dispose();for(const t of this.events)(e=t.listener)==null||e.dispose();this.events=[]}}class Dv{constructor(){this.data=[]}wrapEvent(e,t,i){return(n,r,o)=>e(a=>{const l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(r,a)):n.call(r,a);return}const c=l;if(!c){n.call(r,t(i,a));return}c.items??(c.items=[]),c.items.push(a),c.buffers.length===0&&l.buffers.push(()=>{c.reducedResult??(c.reducedResult=i?c.items.reduce(t,i):c.items.reduce(t)),n.call(r,c.reducedResult)})},void 0,o)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}}class Gb{constructor(){this.listening=!1,this.inputEvent=ge.None,this.inputEventListener=ne.None,this.emitter=new $({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const Du=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new $,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(s){s=Math.min(Math.max(-5,s),20),this._zoomLevel!==s&&(this._zoomLevel=s,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},ige=rt?1.5:1.35,HI=8;class Og{static _create(e,t,i,n,r,o,a,l,c){o===0?o=ige*i:o<HI&&(o=o*i),o=Math.round(o),o<HI&&(o=HI);const u=1+(c?0:Du.getZoomLevel()*.1);return i*=u,o*=u,r===hQ&&(t==="normal"||t==="bold"?r=cQ:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new Og({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:r,lineHeight:o,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=Bo.fontFamily,t=Og._wrapInQuotes(this.fontFamily);return this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const nge=2;class UL extends Og{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=nge,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}const cQ="normal",hQ="translate",sge="Consolas, 'Courier New', monospace",rge="Menlo, Monaco, 'Courier New', monospace",oge="'Droid Sans Mono', 'monospace', monospace",Bo={fontFamily:rt?rge:cr?sge:oge,fontWeight:"normal",fontSize:rt?12:14,lineHeight:0,letterSpacing:0},Qn={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},uQ="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function age(s=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of uQ)s.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const f7=age();function g7(s){let e=f7;if(s&&s instanceof RegExp)if(s.global)e=s;else{let t="g";s.ignoreCase&&(t+="i"),s.multiline&&(t+="m"),s.unicode&&(t+="u"),e=new RegExp(s.source,t)}return e.lastIndex=0,e}const dQ=new sr;dQ.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function dw(s,e,t,i,n){if(e=g7(e),n||(n=_t.first(dQ)),t.length>n.maxLen){let c=s-n.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,s+n.maxLen/2),dw(s,e,t,i,n)}const r=Date.now(),o=s-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-r>=n.timeBudget);c++){const u=o-n.windowSize*c;e.lastIndex=Math.max(0,u);const d=lge(e,t,o,a);if(!d&&l||(l=d,u<=0))break;a=u}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function lge(s,e,t,i){let n;for(;n=s.exec(e);){const r=n.index||0;if(r<=t&&s.lastIndex>=t)return n;if(i>0&&r>i)return null}return null}const pl=8;class fQ{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class gQ{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class oi{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return Q2(e,t)}compute(e,t,i){return i}}class V0{constructor(e,t){this.newValue=e,this.didChange=t}}function Q2(s,e){if(typeof s!="object"||typeof e!="object"||!s||!e)return new V0(e,s!==e);if(Array.isArray(s)||Array.isArray(e)){const i=Array.isArray(s)&&Array.isArray(e)&&sn(s,e);return new V0(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=Q2(s[i],e[i]);n.didChange&&(s[i]=n.newValue,t=!0)}return new V0(s,t)}class Cd{constructor(e,t){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=t}applyUpdate(e,t){return Q2(e,t)}validate(e){return this.defaultValue}}class P1{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return Q2(e,t)}compute(e,t,i){return i}}function Le(s,e){return typeof s>"u"?e:s==="false"?!1:!!s}class Ge extends P1{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Le(e,this.defaultValue)}}function th(s,e,t,i){if(typeof s=="string"&&(s=parseInt(s,10)),typeof s!="number"||isNaN(s))return e;let n=s;return n=Math.max(t,n),n=Math.min(i,n),n|0}class Dt extends P1{static clampedInt(e,t,i,n){return th(e,t,i,n)}constructor(e,t,i,n,r,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=n,o.maximum=r),super(e,t,i,o),this.minimum=n,this.maximum=r}validate(e){return Dt.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function cge(s,e,t,i){if(typeof s>"u")return e;const n=rr.float(s,e);return rr.clamp(n,t,i)}class rr extends P1{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){return typeof e=="string"&&(e=parseFloat(e)),typeof e!="number"||isNaN(e)?t:e}constructor(e,t,i,n,r,o,a){typeof r<"u"&&(r.type="number",r.default=i,r.minimum=o,r.maximum=a),super(e,t,i,r),this.validationFn=n,this.minimum=o,this.maximum=a}validate(e){return this.validationFn(rr.float(e,this.defaultValue))}}class ys extends P1{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return ys.string(e,this.defaultValue)}}function Xt(s,e,t,i){return typeof s!="string"?e:i&&s in i?i[s]:t.indexOf(s)===-1?e:s}class si extends P1{constructor(e,t,i,n,r=void 0){typeof r<"u"&&(r.type="string",r.enum=n.slice(0),r.default=i),super(e,t,i,r),this._allowedValues=n}validate(e){return Xt(e,this.defaultValue,this._allowedValues)}}class Kb extends oi{constructor(e,t,i,n,r,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=n),super(e,t,i,a),this._allowedValues=r,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function hge(s){switch(s){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class uge extends oi{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[w(201,"Use platform APIs to detect when a Screen Reader is attached."),w(202,"Optimize for usage with a Screen Reader."),w(203,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:w(204,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class dge extends oi{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(29,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:w(205,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:w(206,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Le(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Le(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function fge(s){switch(s){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var cn;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(cn||(cn={}));function _H(s){switch(s){case"line":return cn.Line;case"block":return cn.Block;case"underline":return cn.Underline;case"line-thin":return cn.LineThin;case"block-outline":return cn.BlockOutline;case"underline-thin":return cn.UnderlineThin}}class gge extends Cd{constructor(){super(162,"")}compute(e,t,i){const n=["monaco-editor"];return t.get(48)&&n.push(t.get(48)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(82)==="default"?n.push("mouse-default"):t.get(82)==="copy"&&n.push("mouse-copy"),t.get(127)&&n.push("showUnused"),t.get(157)&&n.push("showDeprecated"),n.join(" ")}}class mge extends Ge{constructor(){super(45,"emptySelectionClipboard",!0,{description:w(207,"Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class pge extends oi{constructor(){const e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(50,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:w(208,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[w(209,"Never seed search string from the editor selection."),w(210,"Always seed search string from the editor selection, including word at cursor position."),w(211,"Only seed search string from the editor selection.")],description:w(212,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[w(213,"Never turn on Find in Selection automatically (default)."),w(214,"Always turn on Find in Selection automatically."),w(215,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:w(216,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:w(217,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:rt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:w(218,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:w(219,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[w(220,"Do not store search history from the find widget."),w(221,"Store search history across the active workspace")],description:w(222,"Controls how the find widget history should be stored")},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[w(223,"Do not store history from the replace widget."),w(224,"Store replace history across the active workspace")],description:w(225,"Controls how the replace widget history should be stored")},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:w(226,"Controls whether the Find Widget should search as you type.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Le(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:Le(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":Xt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":Xt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Le(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Le(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Le(t.loop,this.defaultValue.loop),history:Xt(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:Xt(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}}const Yc=class Yc extends oi{constructor(){super(60,"fontLigatures",Yc.OFF,{anyOf:[{type:"boolean",description:w(227,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:w(228,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:w(229,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?Yc.OFF:e==="true"?Yc.ON:e:e?Yc.ON:Yc.OFF}};Yc.OFF='"liga" off, "calt" off',Yc.ON='"liga" on, "calt" on';let hd=Yc;const Qc=class Qc extends oi{constructor(){super(63,"fontVariations",Qc.OFF,{anyOf:[{type:"boolean",description:w(230,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:w(231,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:w(232,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?Qc.OFF:e==="true"?Qc.TRANSLATE:e:e?Qc.TRANSLATE:Qc.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};Qc.OFF=cQ,Qc.TRANSLATE=hQ;let XA=Qc;class _ge extends Cd{constructor(){super(59,new UL({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:!1,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:!1,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},!1))}compute(e,t,i){return e.fontInfo}}class bge extends Cd{constructor(){super(161,cn.Line)}compute(e,t,i){return e.inputMode==="overtype"?t.get(92):t.get(34)}}class Cge extends Cd{constructor(){super(170,!1)}compute(e,t){return e.editContextSupported&&t.get(44)}}class wge extends Cd{constructor(){super(172,!1)}compute(e,t){return e.accessibilitySupport===2?t.get(7):t.get(6)}}class vge extends P1{constructor(){super(61,"fontSize",Bo.fontSize,{type:"number",minimum:6,maximum:100,default:Bo.fontSize,description:w(233,"Controls the font size in pixels.")})}validate(e){const t=rr.float(e,this.defaultValue);return t===0?Bo.fontSize:rr.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const vl=class vl extends oi{constructor(){super(62,"fontWeight",Bo.fontWeight,{anyOf:[{type:"number",minimum:vl.MINIMUM_VALUE,maximum:vl.MAXIMUM_VALUE,errorMessage:w(234,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:vl.SUGGESTION_VALUES}],default:Bo.fontWeight,description:w(235,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Dt.clampedInt(e,Bo.fontWeight,vl.MINIMUM_VALUE,vl.MAXIMUM_VALUE))}};vl.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],vl.MINIMUM_VALUE=1,vl.MAXIMUM_VALUE=1e3;let ZA=vl;class yge extends oi{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[w(236,"Show Peek view of the results (default)"),w(237,"Go to the primary result and show a Peek view"),w(238,"Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(67,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:w(239,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:w(240,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:w(241,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:w(242,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:w(243,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:w(244,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:w(245,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:w(246,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:w(247,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:w(248,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:w(249,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:Xt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:Xt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:Xt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:Xt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:Xt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:Xt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:Xt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:ys.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:ys.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:ys.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:ys.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:ys.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:ys.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class Sge extends oi{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(69,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:w(250,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:w(251,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:w(252,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:w(253,"Controls the delay in milliseconds after which the hover is hidden. Requires `#editor.hover.sticky#` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:w(254,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),delay:Dt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Le(t.sticky,this.defaultValue.sticky),hidingDelay:Dt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Le(t.above,this.defaultValue.above)}}}class v_ extends Cd{constructor(){super(165,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(e,t,i){return v_.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const r=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:r,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,d=e.minimap.renderCharacters;let g=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const p=e.minimap.maxColumn,_=e.minimap.size,C=e.minimap.side,v=e.verticalScrollbarWidth,x=e.viewLineCount,S=e.remainingWidth,k=e.isViewportWrapping,E=d?2:3;let T=Math.floor(r*n);const R=T/r;let N=!1,A=!1,O=E*g,W=g/r,j=1;if(_==="fill"||_==="fit"){const{typicalViewportLineCount:Q,extraLinesBeforeFirstLine:le,extraLinesBeyondLastLine:ve,desiredRatio:V,minimapLineCount:ce}=v_.computeContainedMinimapLineCount({viewLineCount:x,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:r});if(x/ce>1)N=!0,A=!0,g=1,O=1,W=g/r;else{let Se=!1,me=g+1;if(_==="fit"){const Oe=Math.ceil((le+x+ve)*O);k&&a&&S<=t.stableFitRemainingWidth?(Se=!0,me=t.stableFitMaxMinimapScale):Se=Oe>T}if(_==="fill"||Se){N=!0;const Oe=g;O=Math.min(l*r,Math.max(1,Math.floor(1/V))),k&&a&&S<=t.stableFitRemainingWidth&&(me=t.stableFitMaxMinimapScale),g=Math.min(me,Math.max(1,Math.floor(O/E))),g>Oe&&(j=Math.min(2,g/Oe)),W=g/r/j,T=Math.ceil(Math.max(Q,le+x+ve)*O),k?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=S,t.stableFitMaxMinimapScale=g):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const F=Math.floor(p*W),q=Math.min(F,Math.max(0,Math.floor((S-v-2)*W/(c+W)))+pl);let Z=Math.floor(r*q);const K=Z/r;Z=Math.floor(Z*j);const U=d?1:2,G=C==="left"?0:i-q-v;return{renderMinimap:U,minimapLeft:G,minimapWidth:q,minimapHeightIsEditorHeight:N,minimapIsSampling:A,minimapScale:g,minimapLineHeight:O,minimapCanvasInnerWidth:Z,minimapCanvasInnerHeight:T,minimapCanvasOuterWidth:K,minimapCanvasOuterHeight:R}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,r=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,u=t.viewLineCount,d=e.get(154),g=d==="inherit"?e.get(153):d,p=g==="inherit"?e.get(149):g,_=e.get(152),C=t.isDominatedByLongLines,v=e.get(66),x=e.get(76).renderType!==0,S=e.get(77),k=e.get(119),E=e.get(96),T=e.get(81),R=e.get(117),N=R.verticalScrollbarSize,A=R.verticalHasArrows,O=R.arrowSize,W=R.horizontalScrollbarSize,j=e.get(52),F=e.get(126)!=="never";let q=e.get(74);j&&F&&(q+=16);let Z=0;if(x){const Xe=Math.max(o,S);Z=Math.round(Xe*l)}let K=0;v&&(K=r*t.glyphMarginDecorationLaneCount);let U=0,G=U+K,Q=G+Z,le=Q+q;const ve=i-K-Z-q;let V=!1,ce=!1,oe=-1;e.get(2)===2&&g==="inherit"&&C?(V=!0,ce=!0):p==="on"||p==="bounded"?ce=!0:p==="wordWrapColumn"&&(oe=_);const Se=v_._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:k,paddingTop:E.top,paddingBottom:E.bottom,minimap:T,verticalScrollbarWidth:N,viewLineCount:u,remainingWidth:ve,isViewportWrapping:ce},t.memory||new gQ);Se.renderMinimap!==0&&Se.minimapLeft===0&&(U+=Se.minimapWidth,G+=Se.minimapWidth,Q+=Se.minimapWidth,le+=Se.minimapWidth);const me=ve-Se.minimapWidth,Oe=Math.max(1,Math.floor((me-N-2)/a)),it=A?O:0;return ce&&(oe=Math.max(1,Oe),p==="bounded"&&(oe=Math.min(oe,_))),{width:i,height:n,glyphMarginLeft:U,glyphMarginWidth:K,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:G,lineNumbersWidth:Z,decorationsLeft:Q,decorationsWidth:q,contentLeft:le,contentWidth:me,minimap:Se,viewportColumn:Oe,isWordWrapMinified:V,isViewportWrapping:ce,wrappingColumn:oe,verticalScrollbarWidth:N,horizontalScrollbarHeight:W,overviewRuler:{top:it,width:N,height:n-2*it,right:0}}}}class xge extends oi{constructor(){super(156,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[w(255,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),w(256,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:w(257,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return Xt(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var jc;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(jc||(jc={}));class Lge extends oi{constructor(){const e={enabled:jc.OnCode};super(73,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[jc.Off,jc.OnCode,jc.On],default:e.enabled,enumDescriptions:[w(258,"Disable the code action menu."),w(259,"Show the code action menu when the cursor is on lines with code."),w(260,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:w(261,"Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Xt(e.enabled,this.defaultValue.enabled,[jc.Off,jc.OnCode,jc.On])}}}class kge extends oi{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(131,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:w(262,"Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:w(263,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:w(264,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:w(265,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),maxLineCount:Dt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Xt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Le(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class Ege extends oi{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(159,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:w(266,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[w(267,"Inlay hints are enabled"),w(268,"Inlay hints are showing by default and hide when holding {0}",rt?"Ctrl+Option":"Ctrl+Alt"),w(269,"Inlay hints are hidden by default and show when holding {0}",rt?"Ctrl+Option":"Ctrl+Alt"),w(270,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:w(271,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:w(272,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:w(273,"Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:w(274,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:Xt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Dt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:ys.string(t.fontFamily,this.defaultValue.fontFamily),padding:Le(t.padding,this.defaultValue.padding),maximumLength:Dt.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}}class Dge extends oi{constructor(){super(74,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Dt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Dt.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class Tge extends rr{constructor(){super(75,"lineHeight",Bo.lineHeight,e=>rr.clamp(e,0,150),{markdownDescription:w(275,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)},0,150)}compute(e,t,i){return e.fontInfo.lineHeight}}class Nge extends oi{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(81,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:w(276,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[w(277,"The minimap is always shown."),w(278,"The minimap is hidden when mouse is not over the minimap and shown when mouse is over the minimap."),w(279,"The minimap is only shown when the editor is scrolled")],default:e.autohide,description:w(280,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[w(281,"The minimap has the same size as the editor contents (and might scroll)."),w(282,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),w(283,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:w(284,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:w(285,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:w(286,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:w(287,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:w(288,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:w(289,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:w(290,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:w(291,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:w(292,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:w(293,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:w(294,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const n=t.markSectionHeaderRegex;if(typeof n=="string")try{new RegExp(n,"d"),i=n}catch{}return{enabled:Le(t.enabled,this.defaultValue.enabled),autohide:Xt(t.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:Xt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Xt(t.side,this.defaultValue.side,["right","left"]),showSlider:Xt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Le(t.renderCharacters,this.defaultValue.renderCharacters),scale:Dt.clampedInt(t.scale,1,1,3),maxColumn:Dt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Le(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Le(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:rr.clamp(rr.float(t.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:rr.clamp(rr.float(t.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}}function Ige(s){return s==="ctrlCmd"?rt?"metaKey":"ctrlKey":"altKey"}class Rge extends oi{constructor(){super(96,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:w(295,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:w(296,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Dt.clampedInt(t.top,0,0,1e3),bottom:Dt.clampedInt(t.bottom,0,0,1e3)}}}class Age extends oi{constructor(){const e={enabled:!0,cycle:!0};super(98,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:w(297,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:w(298,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),cycle:Le(t.cycle,this.defaultValue.cycle)}}}class Mge extends Cd{constructor(){super(163,1)}compute(e,t,i){return e.pixelRatio}}class Oge extends oi{constructor(){super(100,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class Pge extends oi{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[w(299,"Quick suggestions show inside the suggest widget"),w(300,"Quick suggestions show as ghost text"),w(301,"Quick suggestions are disabled")]}];super(102,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:w(302,"Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:w(303,"Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:w(304,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:w(305,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,r=["on","inline","off"];let o,a,l;return typeof t=="boolean"?o=t?"on":"off":o=Xt(t,this.defaultValue.other,r),typeof i=="boolean"?a=i?"on":"off":a=Xt(i,this.defaultValue.comments,r),typeof n=="boolean"?l=n?"on":"off":l=Xt(n,this.defaultValue.strings,r),{other:o,comments:a,strings:l}}}class Fge extends oi{constructor(){super(76,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[w(306,"Line numbers are not rendered."),w(307,"Line numbers are rendered as absolute number."),w(308,"Line numbers are rendered as distance in lines to cursor position."),w(309,"Line numbers are rendered every 10 lines.")],default:"on",description:w(310,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function jL(s){const e=s.get(112);return e==="editable"?s.get(104):e!=="on"}function $L(s){return!s.get(172)}class Bge extends oi{constructor(){const e=[],t={type:"number",description:w(311,"Number of monospace characters at which this editor ruler will render.")};super(116,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:w(312,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:w(313,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Dt.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Dt.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class Vge extends oi{constructor(){super(105,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function bH(s,e){if(typeof s!="string")return e;switch(s){case"hidden":return 2;case"visible":return 3;default:return 1}}let Wge=class extends oi{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(117,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[w(314,"The vertical scrollbar will be visible only when necessary."),w(315,"The vertical scrollbar will always be visible."),w(316,"The vertical scrollbar will always be hidden.")],default:"auto",description:w(317,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[w(318,"The horizontal scrollbar will be visible only when necessary."),w(319,"The horizontal scrollbar will always be visible."),w(320,"The horizontal scrollbar will always be hidden.")],default:"auto",description:w(321,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:w(322,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:w(323,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:w(324,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:w(325,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Dt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Dt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Dt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:bH(t.vertical,this.defaultValue.vertical),horizontal:bH(t.horizontal,this.defaultValue.horizontal),useShadows:Le(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Le(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Le(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Le(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Le(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Dt.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Dt.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Le(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Le(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const La="inUntrustedWorkspace",Kd={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class Hge extends oi{constructor(){const e={nonBasicASCII:La,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:La,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(142,"unicodeHighlight",e,{[Kd.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,La],default:e.nonBasicASCII,description:w(326,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Kd.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:w(327,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[Kd.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:w(328,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Kd.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,La],default:e.includeComments,description:w(329,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[Kd.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,La],default:e.includeStrings,description:w(330,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[Kd.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:w(331,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Kd.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:w(332,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(xr(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(xr(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new V0(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:y_(t.nonBasicASCII,La,[!0,!1,La]),invisibleCharacters:Le(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Le(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:y_(t.includeComments,La,[!0,!1,La]),includeStrings:y_(t.includeStrings,La,[!0,!1,La]),allowedCharacters:this.validateBooleanMap(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(t.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,r]of Object.entries(e))r===!0&&(i[n]=!0);return i}}class zge extends oi{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,minShowDelay:0,suppressInSnippetMode:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always"},triggerCommandOnProviderChange:!1,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:!0}};super(71,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:w(333,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[w(334,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),w(335,"Show the inline suggestion toolbar when hovering over an inline suggestion."),w(336,"Never show the inline suggestion toolbar.")],description:w(337,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:w(338,"Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:w(339,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:w(340,"Controls whether inline suggestions are suppressed when in snippet mode.")},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:w(341,"Controls the minimal delay in milliseconds after which inline suggestions are shown after typing.")},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:w(342,"Suppresses inline completions for specified extension IDs -- comma separated."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:w(343,"Controls whether to send request information from the inline suggestion provider."),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:w(344,"Controls whether to trigger a command when the inline suggestion provider changes."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:w(345,"Controls whether to show inline suggestions when there is a suggest conflict."),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:w(346,"Controls the font family of the inline suggestions.")},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:w(347,"Controls whether showing a suggestion will shift the code to make space for the suggestion inline."),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:w(348,"Controls whether larger suggestions can be shown side by side."),enum:["auto","never"],enumDescriptions:[w(349,"Larger suggestions will show side by side if there is enough space, otherwise they will be shown below."),w(350,"Larger suggestions are never shown side by side and will always be shown below.")],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:w(351,"Controls whether the suggestion will show as collapsed until jumping to it."),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),mode:Xt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Xt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Le(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Le(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:ys.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:Le(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:Dt.clampedInt(t.minShowDelay,0,0,1e4),suppressInSnippetMode:Le(t.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this._validateEdits(t.edits),triggerCommandOnProviderChange:Le(t.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this._validateExperimental(t.experimental)}}_validateEdits(e){if(!e||typeof e!="object")return this.defaultValue.edits;const t=e;return{enabled:Le(t.enabled,this.defaultValue.edits.enabled),showCollapsed:Le(t.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:Xt(t.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),renderSideBySide:Xt(t.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}_validateExperimental(e){if(!e||typeof e!="object")return this.defaultValue.experimental;const t=e;return{suppressInlineSuggestions:ys.string(t.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:Xt(t.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:Le(t.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}}class Uge extends oi{constructor(){const e={enabled:Qn.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Qn.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(21,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:w(352,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:w(353,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Le(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class jge extends oi{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(22,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[w(354,"Enables bracket pair guides."),w(355,"Enables bracket pair guides only for the active bracket pair."),w(356,"Disables bracket pair guides.")],default:e.bracketPairs,description:w(357,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[w(358,"Enables horizontal guides as addition to vertical bracket pair guides."),w(359,"Enables horizontal guides only for the active bracket pair."),w(360,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:w(361,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:w(362,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:w(363,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[w(364,"Highlights the active indent guide."),w(365,"Highlights the active indent guide even if bracket guides are highlighted."),w(366,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:w(367,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:y_(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:y_(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Le(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Le(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:y_(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function y_(s,e,t){const i=t.indexOf(s);return i===-1?e:t[i]}class $ge extends oi{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(134,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[w(368,"Insert suggestion without overwriting text right of the cursor."),w(369,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:w(370,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:w(371,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:w(372,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:w(373,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[w(374,"Always select a suggestion when automatically triggering IntelliSense."),w(375,"Never select a suggestion when automatically triggering IntelliSense."),w(376,"Select a suggestion only when triggering IntelliSense from a trigger character."),w(377,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:w(378,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:w(379,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:w(380,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:w(381,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:w(382,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:w(383,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:w(384,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:w(385,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:w(386,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:w(387,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:w(388,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:w(389,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:w(390,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:w(391,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:w(392,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:w(393,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:w(394,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:w(395,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:w(396,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:w(397,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:w(398,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:w(399,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:w(400,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:w(401,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:w(402,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:w(403,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:w(404,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:w(405,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:w(406,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:w(407,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:w(408,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:w(409,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:w(410,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:w(411,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:w(412,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:w(413,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:w(414,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:w(415,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:Xt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Le(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Le(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Le(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Le(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Xt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Le(t.showIcons,this.defaultValue.showIcons),showStatusBar:Le(t.showStatusBar,this.defaultValue.showStatusBar),preview:Le(t.preview,this.defaultValue.preview),previewMode:Xt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Le(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Le(t.showMethods,this.defaultValue.showMethods),showFunctions:Le(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Le(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Le(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Le(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Le(t.showFields,this.defaultValue.showFields),showVariables:Le(t.showVariables,this.defaultValue.showVariables),showClasses:Le(t.showClasses,this.defaultValue.showClasses),showStructs:Le(t.showStructs,this.defaultValue.showStructs),showInterfaces:Le(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Le(t.showModules,this.defaultValue.showModules),showProperties:Le(t.showProperties,this.defaultValue.showProperties),showEvents:Le(t.showEvents,this.defaultValue.showEvents),showOperators:Le(t.showOperators,this.defaultValue.showOperators),showUnits:Le(t.showUnits,this.defaultValue.showUnits),showValues:Le(t.showValues,this.defaultValue.showValues),showConstants:Le(t.showConstants,this.defaultValue.showConstants),showEnums:Le(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Le(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Le(t.showKeywords,this.defaultValue.showKeywords),showWords:Le(t.showWords,this.defaultValue.showWords),showColors:Le(t.showColors,this.defaultValue.showColors),showFiles:Le(t.showFiles,this.defaultValue.showFiles),showReferences:Le(t.showReferences,this.defaultValue.showReferences),showFolders:Le(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Le(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Le(t.showSnippets,this.defaultValue.showSnippets),showUsers:Le(t.showUsers,this.defaultValue.showUsers),showIssues:Le(t.showIssues,this.defaultValue.showIssues)}}}class qge extends oi{constructor(){super(129,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:w(416,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:w(417,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Le(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Le(e.selectSubwords,this.defaultValue.selectSubwords)}}}class Gge extends oi{constructor(){const e=[];super(147,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:w(418,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class Kge extends oi{constructor(){super(155,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[w(419,"No indentation. Wrapped lines begin at column 1."),w(420,"Wrapped lines get the same indentation as the parent."),w(421,"Wrapped lines get +1 indentation toward the parent."),w(422,"Wrapped lines get +2 indentation toward the parent.")],description:w(423,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class Yge extends Cd{constructor(){super(166,{isDominatedByLongLines:!1,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1})}compute(e,t,i){const n=t.get(165);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class Qge extends oi{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(43,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:w(424,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:w(425,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[w(426,"Show the drop selector widget after a file is dropped into the editor."),w(427,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),showDropSelector:Xt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class Xge extends oi{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(97,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:w(428,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:w(429,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[w(430,"Show the paste selector widget after content is pasted into the editor."),w(431,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Le(t.enabled,this.defaultValue.enabled),showPasteSelector:Xt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const Pp=[];function re(s){return Pp[s.id]=s,s}const Kr={acceptSuggestionOnCommitCharacter:re(new Ge(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:w(432,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:re(new si(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",w(433,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:w(434,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:re(new uge),accessibilityPageSize:re(new Dt(3,"accessibilityPageSize",500,1,1073741824,{description:w(435,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),allowOverflow:re(new Ge(4,"allowOverflow",!0)),allowVariableLineHeights:re(new Ge(5,"allowVariableLineHeights",!0,{description:w(436,"Controls whether to allow using variable line heights in the editor.")})),allowVariableFonts:re(new Ge(6,"allowVariableFonts",!0,{description:w(437,"Controls whether to allow using variable fonts in the editor.")})),allowVariableFontsInAccessibilityMode:re(new Ge(7,"allowVariableFontsInAccessibilityMode",!1,{description:w(438,"Controls whether to allow using variable fonts in the editor in the accessibility mode."),tags:["accessibility"]})),ariaLabel:re(new ys(8,"ariaLabel",w(439,"Editor content"))),ariaRequired:re(new Ge(9,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:re(new Ge(12,"screenReaderAnnounceInlineSuggestion",!0,{description:w(440,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:re(new si(10,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",w(441,"Use language configurations to determine when to autoclose brackets."),w(442,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:w(443,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:re(new si(11,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",w(444,"Use language configurations to determine when to autoclose comments."),w(445,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:w(446,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:re(new si(13,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",w(447,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:w(448,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:re(new si(14,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",w(449,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:w(450,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:re(new si(15,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",w(451,"Use language configurations to determine when to autoclose quotes."),w(452,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:w(453,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:re(new Kb(16,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],hge,{enumDescriptions:[w(454,"The editor will not insert indentation automatically."),w(455,"The editor will keep the current line's indentation."),w(456,"The editor will keep the current line's indentation and honor language defined brackets."),w(457,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),w(458,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:w(459,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),autoIndentOnPaste:re(new Ge(17,"autoIndentOnPaste",!1,{description:w(460,"Controls whether the editor should automatically auto-indent the pasted content.")})),autoIndentOnPasteWithinString:re(new Ge(18,"autoIndentOnPasteWithinString",!0,{description:w(461,"Controls whether the editor should automatically auto-indent the pasted content when pasted within a string. This takes effect when autoIndentOnPaste is true.")})),automaticLayout:re(new Ge(19,"automaticLayout",!1)),autoSurround:re(new si(20,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[w(462,"Use language configurations to determine when to automatically surround selections."),w(463,"Surround with quotes but not brackets."),w(464,"Surround with brackets but not quotes."),""],description:w(465,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:re(new Uge),bracketPairGuides:re(new jge),stickyTabStops:re(new Ge(132,"stickyTabStops",!1,{description:w(466,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:re(new Ge(23,"codeLens",!0,{description:w(467,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:re(new ys(24,"codeLensFontFamily","",{description:w(468,"Controls the font family for CodeLens.")})),codeLensFontSize:re(new Dt(25,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:w(469,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:re(new Ge(26,"colorDecorators",!0,{description:w(470,"Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:re(new si(168,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[w(471,"Make the color picker appear both on click and hover of the color decorator"),w(472,"Make the color picker appear on hover of the color decorator"),w(473,"Make the color picker appear on click of the color decorator")],description:w(474,"Controls the condition to make a color picker appear from a color decorator.")})),colorDecoratorsLimit:re(new Dt(27,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:w(475,"Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:re(new Ge(28,"columnSelection",!1,{description:w(476,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:re(new dge),contextmenu:re(new Ge(30,"contextmenu",!0)),copyWithSyntaxHighlighting:re(new Ge(31,"copyWithSyntaxHighlighting",!0,{description:w(477,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:re(new Kb(32,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],fge,{description:w(478,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:re(new si(33,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[w(479,"Smooth caret animation is disabled."),w(480,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),w(481,"Smooth caret animation is always enabled.")],description:w(482,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:re(new Kb(34,"cursorStyle",cn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],_H,{description:w(483,"Controls the cursor style in insert input mode.")})),overtypeCursorStyle:re(new Kb(92,"overtypeCursorStyle",cn.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],_H,{description:w(484,"Controls the cursor style in overtype input mode.")})),cursorSurroundingLines:re(new Dt(35,"cursorSurroundingLines",0,0,1073741824,{description:w(485,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:re(new si(36,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[w(486,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),w(487,"`cursorSurroundingLines` is enforced always.")],markdownDescription:w(488,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:re(new Dt(37,"cursorWidth",0,0,1073741824,{markdownDescription:w(489,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),cursorHeight:re(new Dt(38,"cursorHeight",0,0,1073741824,{markdownDescription:w(490,"Controls the height of the cursor when `#editor.cursorStyle#` is set to `line`. Cursor's max height depends on line height.")})),disableLayerHinting:re(new Ge(39,"disableLayerHinting",!1)),disableMonospaceOptimizations:re(new Ge(40,"disableMonospaceOptimizations",!1)),domReadOnly:re(new Ge(41,"domReadOnly",!1)),dragAndDrop:re(new Ge(42,"dragAndDrop",!0,{description:w(491,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:re(new mge),dropIntoEditor:re(new Qge),editContext:re(new Ge(44,"editContext",!0,{description:w(492,"Sets whether the EditContext API should be used instead of the text area to power input in the editor."),included:h7||oQ||cw})),renderRichScreenReaderContent:re(new Ge(107,"renderRichScreenReaderContent",!1,{markdownDescription:w(493,"Whether to render rich screen reader content when the `#editor.editContext#` setting is enabled.")})),stickyScroll:re(new kge),experimentalGpuAcceleration:re(new si(46,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[w(494,"Use regular DOM-based rendering."),w(495,"Use GPU acceleration.")],description:w(496,"Controls whether to use the experimental GPU acceleration to render the editor.")})),experimentalWhitespaceRendering:re(new si(47,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[w(497,"Use a new rendering method with svgs."),w(498,"Use a new rendering method with font characters."),w(499,"Use the stable rendering method.")],description:w(500,"Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:re(new ys(48,"extraEditorClassName","")),fastScrollSensitivity:re(new rr(49,"fastScrollSensitivity",5,s=>s<=0?5:s,{markdownDescription:w(501,"Scrolling speed multiplier when pressing `Alt`.")})),find:re(new pge),fixedOverflowWidgets:re(new Ge(51,"fixedOverflowWidgets",!1)),folding:re(new Ge(52,"folding",!0,{description:w(502,"Controls whether the editor has code folding enabled.")})),foldingStrategy:re(new si(53,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[w(503,"Use a language-specific folding strategy if available, else the indentation-based one."),w(504,"Use the indentation-based folding strategy.")],description:w(505,"Controls the strategy for computing folding ranges.")})),foldingHighlight:re(new Ge(54,"foldingHighlight",!0,{description:w(506,"Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:re(new Ge(55,"foldingImportsByDefault",!1,{description:w(507,"Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:re(new Dt(56,"foldingMaximumRegions",5e3,10,65e3,{description:w(508,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:re(new Ge(57,"unfoldOnClickAfterEndOfLine",!1,{description:w(509,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:re(new ys(58,"fontFamily",Bo.fontFamily,{description:w(510,"Controls the font family.")})),fontInfo:re(new _ge),fontLigatures2:re(new hd),fontSize:re(new vge),fontWeight:re(new ZA),fontVariations:re(new XA),formatOnPaste:re(new Ge(64,"formatOnPaste",!1,{description:w(511,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:re(new Ge(65,"formatOnType",!1,{description:w(512,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:re(new Ge(66,"glyphMargin",!0,{description:w(513,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:re(new yge),hideCursorInOverviewRuler:re(new Ge(68,"hideCursorInOverviewRuler",!1,{description:w(514,"Controls whether the cursor should be hidden in the overview ruler.")})),hover:re(new Sge),inDiffEditor:re(new Ge(70,"inDiffEditor",!1)),inertialScroll:re(new Ge(158,"inertialScroll",!1,{description:w(515,"Make scrolling inertial - mostly useful with touchpad on linux.")})),letterSpacing:re(new rr(72,"letterSpacing",Bo.letterSpacing,s=>rr.clamp(s,-5,20),{description:w(516,"Controls the letter spacing in pixels.")})),lightbulb:re(new Lge),lineDecorationsWidth:re(new Dge),lineHeight:re(new Tge),lineNumbers:re(new Fge),lineNumbersMinChars:re(new Dt(77,"lineNumbersMinChars",5,1,300)),linkedEditing:re(new Ge(78,"linkedEditing",!1,{description:w(517,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:re(new Ge(79,"links",!0,{description:w(518,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:re(new si(80,"matchBrackets","always",["always","near","never"],{description:w(519,"Highlight matching brackets.")})),minimap:re(new Nge),mouseStyle:re(new si(82,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:re(new rr(83,"mouseWheelScrollSensitivity",1,s=>s===0?1:s,{markdownDescription:w(520,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:re(new Ge(84,"mouseWheelZoom",!1,{markdownDescription:rt?w(521,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):w(522,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:re(new Ge(85,"multiCursorMergeOverlapping",!0,{description:w(523,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:re(new Kb(86,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Ige,{markdownEnumDescriptions:[w(524,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),w(525,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:w(526,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),mouseMiddleClickAction:re(new si(87,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:w(527,"Controls what happens when middle mouse button is clicked in the editor.")})),multiCursorPaste:re(new si(88,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[w(528,"Each cursor pastes a single line of the text."),w(529,"Each cursor pastes the full text.")],markdownDescription:w(530,"Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:re(new Dt(89,"multiCursorLimit",1e4,1,1e5,{markdownDescription:w(531,"Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:re(new si(90,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[w(532,"Does not highlight occurrences."),w(533,"Highlights occurrences only in the current file."),w(534,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:w(535,"Controls whether occurrences should be highlighted across open files.")})),occurrencesHighlightDelay:re(new Dt(91,"occurrencesHighlightDelay",0,0,2e3,{description:w(536,"Controls the delay in milliseconds after which occurrences are highlighted."),tags:["preview"]})),overtypeOnPaste:re(new Ge(93,"overtypeOnPaste",!0,{description:w(537,"Controls whether pasting should overtype.")})),overviewRulerBorder:re(new Ge(94,"overviewRulerBorder",!0,{description:w(538,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:re(new Dt(95,"overviewRulerLanes",3,0,3)),padding:re(new Rge),pasteAs:re(new Xge),parameterHints:re(new Age),peekWidgetDefaultFocus:re(new si(99,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[w(539,"Focus the tree when opening peek"),w(540,"Focus the editor when opening peek")],description:w(541,"Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:re(new Oge),definitionLinkOpensInPeek:re(new Ge(101,"definitionLinkOpensInPeek",!1,{description:w(542,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:re(new Pge),quickSuggestionsDelay:re(new Dt(103,"quickSuggestionsDelay",10,0,1073741824,{description:w(543,"Controls the delay in milliseconds after which quick suggestions will show up."),experiment:{mode:"auto"}})),readOnly:re(new Ge(104,"readOnly",!1)),readOnlyMessage:re(new Vge),renameOnType:re(new Ge(106,"renameOnType",!1,{description:w(544,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:w(545,"Deprecated, use `#editor.linkedEditing#` instead.")})),renderControlCharacters:re(new Ge(108,"renderControlCharacters",!0,{description:w(546,"Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:re(new si(109,"renderFinalNewline",kr?"dimmed":"on",["off","on","dimmed"],{description:w(547,"Render last line number when the file ends with a newline.")})),renderLineHighlight:re(new si(110,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",w(548,"Highlights both the gutter and the current line.")],description:w(549,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:re(new Ge(111,"renderLineHighlightOnlyWhenFocus",!1,{description:w(550,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:re(new si(112,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:re(new si(113,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",w(551,"Render whitespace characters except for single spaces between words."),w(552,"Render whitespace characters only on selected text."),w(553,"Render only trailing whitespace characters."),""],description:w(554,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:re(new Dt(114,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:re(new Ge(115,"roundedSelection",!0,{description:w(555,"Controls whether selections should have rounded corners.")})),rulers:re(new Bge),scrollbar:re(new Wge),scrollBeyondLastColumn:re(new Dt(118,"scrollBeyondLastColumn",4,0,1073741824,{description:w(556,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:re(new Ge(119,"scrollBeyondLastLine",!0,{description:w(557,"Controls whether the editor will scroll beyond the last line.")})),scrollOnMiddleClick:re(new Ge(171,"scrollOnMiddleClick",!1,{description:w(558,"Controls whether the editor will scroll when the middle button is pressed.")})),scrollPredominantAxis:re(new Ge(120,"scrollPredominantAxis",!0,{description:w(559,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:re(new Ge(121,"selectionClipboard",!0,{description:w(560,"Controls whether the Linux primary clipboard should be supported."),included:kr})),selectionHighlight:re(new Ge(122,"selectionHighlight",!0,{description:w(561,"Controls whether the editor should highlight matches similar to the selection.")})),selectionHighlightMaxLength:re(new Dt(123,"selectionHighlightMaxLength",200,0,1073741824,{description:w(562,"Controls how many characters can be in the selection before similiar matches are not highlighted. Set to zero for unlimited.")})),selectionHighlightMultiline:re(new Ge(124,"selectionHighlightMultiline",!1,{description:w(563,"Controls whether the editor should highlight selection matches that span multiple lines.")})),selectOnLineNumbers:re(new Ge(125,"selectOnLineNumbers",!0)),showFoldingControls:re(new si(126,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[w(564,"Always show the folding controls."),w(565,"Never show the folding controls and reduce the gutter size."),w(566,"Only show the folding controls when the mouse is over the gutter.")],description:w(567,"Controls when the folding controls on the gutter are shown.")})),showUnused:re(new Ge(127,"showUnused",!0,{description:w(568,"Controls fading out of unused code.")})),showDeprecated:re(new Ge(157,"showDeprecated",!0,{description:w(569,"Controls strikethrough deprecated variables.")})),inlayHints:re(new Ege),snippetSuggestions:re(new si(128,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[w(570,"Show snippet suggestions on top of other suggestions."),w(571,"Show snippet suggestions below other suggestions."),w(572,"Show snippets suggestions with other suggestions."),w(573,"Do not show snippet suggestions.")],description:w(574,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:re(new qge),smoothScrolling:re(new Ge(130,"smoothScrolling",!1,{description:w(575,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:re(new Dt(133,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:re(new $ge),inlineSuggest:re(new zge),inlineCompletionsAccessibilityVerbose:re(new Ge(169,"inlineCompletionsAccessibilityVerbose",!1,{description:w(576,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:re(new Dt(135,"suggestFontSize",0,0,1e3,{markdownDescription:w(577,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:re(new Dt(136,"suggestLineHeight",0,0,1e3,{markdownDescription:w(578,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:re(new Ge(137,"suggestOnTriggerCharacters",!0,{description:w(579,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:re(new si(138,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[w(580,"Always select the first suggestion."),w(581,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),w(582,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:w(583,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:re(new si(139,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[w(584,"Tab complete will insert the best matching suggestion when pressing tab."),w(585,"Disable tab completions."),w(586,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:w(587,"Enables tab completions.")})),tabIndex:re(new Dt(140,"tabIndex",0,-1,1073741824)),trimWhitespaceOnDelete:re(new Ge(141,"trimWhitespaceOnDelete",!1,{description:w(588,"Controls whether the editor will also delete the next line's indentation whitespace when deleting a newline.")})),unicodeHighlight:re(new Hge),unusualLineTerminators:re(new si(143,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[w(589,"Unusual line terminators are automatically removed."),w(590,"Unusual line terminators are ignored."),w(591,"Unusual line terminators prompt to be removed.")],description:w(592,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:re(new Ge(144,"useShadowDOM",!0)),useTabStops:re(new Ge(145,"useTabStops",!0,{description:w(593,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:re(new si(146,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[w(594,"Use the default line break rule."),w(595,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:w(596,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:re(new Gge),wordSeparators:re(new ys(148,"wordSeparators",uQ,{description:w(597,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:re(new si(149,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[w(598,"Lines will never wrap."),w(599,"Lines will wrap at the viewport width."),w(600,"Lines will wrap at `#editor.wordWrapColumn#`."),w(601,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:w(602,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:re(new ys(150,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:re(new ys(151,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:re(new Dt(152,"wordWrapColumn",80,1,1073741824,{markdownDescription:w(603,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:re(new si(153,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:re(new si(154,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:re(new Ge(160,"wrapOnEscapedLineFeeds",!1,{markdownDescription:w(604,'Controls whether literal `\\n` shall trigger a wordWrap when `#editor.wordWrap#` is enabled.\n\nFor example:\n```c\nchar* str="hello\\nworld"\n```\nwill be displayed as\n```c\nchar* str="hello\\n\n           world"\n```')})),effectiveCursorStyle:re(new bge),editorClassName:re(new gge),defaultColorDecorators:re(new si(167,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[w(605,"Show default color decorators only when no extension provides colors decorators."),w(606,"Always show default color decorators."),w(607,"Never show default color decorators.")],description:w(608,"Controls whether inline color decorations should be shown using the default document color provider.")})),pixelRatio:re(new Mge),tabFocusMode:re(new Ge(164,"tabFocusMode",!1,{markdownDescription:w(609,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:re(new v_),wrappingInfo:re(new Yge),wrappingIndent:re(new Kge),wrappingStrategy:re(new xge),effectiveEditContextEnabled:re(new Cge),effectiveAllowVariableFonts:re(new wge)},mQ=Object.freeze(function(s,e){const t=setTimeout(s.bind(e),0);return{dispose(){clearTimeout(t)}}});var lo;(function(s){function e(t){return t===s.None||t===s.Cancelled||t instanceof Mx?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}s.isCancellationToken=e,s.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ge.None}),s.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:mQ})})(lo||(lo={}));class Mx{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?mQ:(this._emitter||(this._emitter=new $),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let sm=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Mx),this._token}cancel(){this._token?this._token instanceof Mx&&this._token.cancel():this._token=lo.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof Mx&&this._token.dispose():this._token=lo.None}};class m7{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const Ox=new m7,JA=new m7,eM=new m7,pQ=new Array(230),Zge=Object.create(null),Jge=Object.create(null),p7=[];for(let s=0;s<=193;s++)p7[s]=-1;(function(){const e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN","",""],[1,1,"Hyper",0,"",0,"","",""],[1,2,"Super",0,"",0,"","",""],[1,3,"Fn",0,"",0,"","",""],[1,4,"FnLock",0,"",0,"","",""],[1,5,"Suspend",0,"",0,"","",""],[1,6,"Resume",0,"",0,"","",""],[1,7,"Turbo",0,"",0,"","",""],[1,8,"Sleep",0,"",0,"VK_SLEEP","",""],[1,9,"WakeUp",0,"",0,"","",""],[0,10,"KeyA",31,"A",65,"VK_A","",""],[0,11,"KeyB",32,"B",66,"VK_B","",""],[0,12,"KeyC",33,"C",67,"VK_C","",""],[0,13,"KeyD",34,"D",68,"VK_D","",""],[0,14,"KeyE",35,"E",69,"VK_E","",""],[0,15,"KeyF",36,"F",70,"VK_F","",""],[0,16,"KeyG",37,"G",71,"VK_G","",""],[0,17,"KeyH",38,"H",72,"VK_H","",""],[0,18,"KeyI",39,"I",73,"VK_I","",""],[0,19,"KeyJ",40,"J",74,"VK_J","",""],[0,20,"KeyK",41,"K",75,"VK_K","",""],[0,21,"KeyL",42,"L",76,"VK_L","",""],[0,22,"KeyM",43,"M",77,"VK_M","",""],[0,23,"KeyN",44,"N",78,"VK_N","",""],[0,24,"KeyO",45,"O",79,"VK_O","",""],[0,25,"KeyP",46,"P",80,"VK_P","",""],[0,26,"KeyQ",47,"Q",81,"VK_Q","",""],[0,27,"KeyR",48,"R",82,"VK_R","",""],[0,28,"KeyS",49,"S",83,"VK_S","",""],[0,29,"KeyT",50,"T",84,"VK_T","",""],[0,30,"KeyU",51,"U",85,"VK_U","",""],[0,31,"KeyV",52,"V",86,"VK_V","",""],[0,32,"KeyW",53,"W",87,"VK_W","",""],[0,33,"KeyX",54,"X",88,"VK_X","",""],[0,34,"KeyY",55,"Y",89,"VK_Y","",""],[0,35,"KeyZ",56,"Z",90,"VK_Z","",""],[0,36,"Digit1",22,"1",49,"VK_1","",""],[0,37,"Digit2",23,"2",50,"VK_2","",""],[0,38,"Digit3",24,"3",51,"VK_3","",""],[0,39,"Digit4",25,"4",52,"VK_4","",""],[0,40,"Digit5",26,"5",53,"VK_5","",""],[0,41,"Digit6",27,"6",54,"VK_6","",""],[0,42,"Digit7",28,"7",55,"VK_7","",""],[0,43,"Digit8",29,"8",56,"VK_8","",""],[0,44,"Digit9",30,"9",57,"VK_9","",""],[0,45,"Digit0",21,"0",48,"VK_0","",""],[1,46,"Enter",3,"Enter",13,"VK_RETURN","",""],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE","",""],[1,48,"Backspace",1,"Backspace",8,"VK_BACK","",""],[1,49,"Tab",2,"Tab",9,"VK_TAB","",""],[1,50,"Space",10,"Space",32,"VK_SPACE","",""],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,"",0,"","",""],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL","",""],[1,64,"F1",59,"F1",112,"VK_F1","",""],[1,65,"F2",60,"F2",113,"VK_F2","",""],[1,66,"F3",61,"F3",114,"VK_F3","",""],[1,67,"F4",62,"F4",115,"VK_F4","",""],[1,68,"F5",63,"F5",116,"VK_F5","",""],[1,69,"F6",64,"F6",117,"VK_F6","",""],[1,70,"F7",65,"F7",118,"VK_F7","",""],[1,71,"F8",66,"F8",119,"VK_F8","",""],[1,72,"F9",67,"F9",120,"VK_F9","",""],[1,73,"F10",68,"F10",121,"VK_F10","",""],[1,74,"F11",69,"F11",122,"VK_F11","",""],[1,75,"F12",70,"F12",123,"VK_F12","",""],[1,76,"PrintScreen",0,"",0,"","",""],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL","",""],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE","",""],[1,79,"Insert",19,"Insert",45,"VK_INSERT","",""],[1,80,"Home",14,"Home",36,"VK_HOME","",""],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR","",""],[1,82,"Delete",20,"Delete",46,"VK_DELETE","",""],[1,83,"End",13,"End",35,"VK_END","",""],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT","",""],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",""],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",""],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",""],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",""],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK","",""],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE","",""],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY","",""],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT","",""],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD","",""],[1,94,"NumpadEnter",3,"",0,"","",""],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1","",""],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2","",""],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3","",""],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4","",""],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5","",""],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6","",""],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7","",""],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8","",""],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9","",""],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0","",""],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL","",""],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102","",""],[1,107,"ContextMenu",58,"ContextMenu",93,"","",""],[1,108,"Power",0,"",0,"","",""],[1,109,"NumpadEqual",0,"",0,"","",""],[1,110,"F13",71,"F13",124,"VK_F13","",""],[1,111,"F14",72,"F14",125,"VK_F14","",""],[1,112,"F15",73,"F15",126,"VK_F15","",""],[1,113,"F16",74,"F16",127,"VK_F16","",""],[1,114,"F17",75,"F17",128,"VK_F17","",""],[1,115,"F18",76,"F18",129,"VK_F18","",""],[1,116,"F19",77,"F19",130,"VK_F19","",""],[1,117,"F20",78,"F20",131,"VK_F20","",""],[1,118,"F21",79,"F21",132,"VK_F21","",""],[1,119,"F22",80,"F22",133,"VK_F22","",""],[1,120,"F23",81,"F23",134,"VK_F23","",""],[1,121,"F24",82,"F24",135,"VK_F24","",""],[1,122,"Open",0,"",0,"","",""],[1,123,"Help",0,"",0,"","",""],[1,124,"Select",0,"",0,"","",""],[1,125,"Again",0,"",0,"","",""],[1,126,"Undo",0,"",0,"","",""],[1,127,"Cut",0,"",0,"","",""],[1,128,"Copy",0,"",0,"","",""],[1,129,"Paste",0,"",0,"","",""],[1,130,"Find",0,"",0,"","",""],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE","",""],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP","",""],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN","",""],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR","",""],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1","",""],[1,136,"KanaMode",0,"",0,"","",""],[0,137,"IntlYen",0,"",0,"","",""],[1,138,"Convert",0,"",0,"","",""],[1,139,"NonConvert",0,"",0,"","",""],[1,140,"Lang1",0,"",0,"","",""],[1,141,"Lang2",0,"",0,"","",""],[1,142,"Lang3",0,"",0,"","",""],[1,143,"Lang4",0,"",0,"","",""],[1,144,"Lang5",0,"",0,"","",""],[1,145,"Abort",0,"",0,"","",""],[1,146,"Props",0,"",0,"","",""],[1,147,"NumpadParenLeft",0,"",0,"","",""],[1,148,"NumpadParenRight",0,"",0,"","",""],[1,149,"NumpadBackspace",0,"",0,"","",""],[1,150,"NumpadMemoryStore",0,"",0,"","",""],[1,151,"NumpadMemoryRecall",0,"",0,"","",""],[1,152,"NumpadMemoryClear",0,"",0,"","",""],[1,153,"NumpadMemoryAdd",0,"",0,"","",""],[1,154,"NumpadMemorySubtract",0,"",0,"","",""],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR","",""],[1,156,"NumpadClearEntry",0,"",0,"","",""],[1,0,"",5,"Ctrl",17,"VK_CONTROL","",""],[1,0,"",4,"Shift",16,"VK_SHIFT","",""],[1,0,"",6,"Alt",18,"VK_MENU","",""],[1,0,"",57,"Meta",91,"VK_COMMAND","",""],[1,157,"ControlLeft",5,"",0,"VK_LCONTROL","",""],[1,158,"ShiftLeft",4,"",0,"VK_LSHIFT","",""],[1,159,"AltLeft",6,"",0,"VK_LMENU","",""],[1,160,"MetaLeft",57,"",0,"VK_LWIN","",""],[1,161,"ControlRight",5,"",0,"VK_RCONTROL","",""],[1,162,"ShiftRight",4,"",0,"VK_RSHIFT","",""],[1,163,"AltRight",6,"",0,"VK_RMENU","",""],[1,164,"MetaRight",57,"",0,"VK_RWIN","",""],[1,165,"BrightnessUp",0,"",0,"","",""],[1,166,"BrightnessDown",0,"",0,"","",""],[1,167,"MediaPlay",0,"",0,"","",""],[1,168,"MediaRecord",0,"",0,"","",""],[1,169,"MediaFastForward",0,"",0,"","",""],[1,170,"MediaRewind",0,"",0,"","",""],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK","",""],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK","",""],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP","",""],[1,174,"Eject",0,"",0,"","",""],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE","",""],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT","",""],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL","",""],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2","",""],[1,179,"LaunchApp1",0,"",0,"VK_MEDIA_LAUNCH_APP1","",""],[1,180,"SelectTask",0,"",0,"","",""],[1,181,"LaunchScreenSaver",0,"",0,"","",""],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH","",""],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME","",""],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK","",""],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD","",""],[1,186,"BrowserStop",0,"",0,"VK_BROWSER_STOP","",""],[1,187,"BrowserRefresh",0,"",0,"VK_BROWSER_REFRESH","",""],[1,188,"BrowserFavorites",0,"",0,"VK_BROWSER_FAVORITES","",""],[1,189,"ZoomToggle",0,"",0,"","",""],[1,190,"MailReply",0,"",0,"","",""],[1,191,"MailForward",0,"",0,"","",""],[1,192,"MailSend",0,"",0,"","",""],[1,0,"",114,"KeyInComposition",229,"","",""],[1,0,"",116,"ABNT_C2",194,"VK_ABNT_C2","",""],[1,0,"",96,"OEM_8",223,"VK_OEM_8","",""],[1,0,"",0,"",0,"VK_KANA","",""],[1,0,"",0,"",0,"VK_HANGUL","",""],[1,0,"",0,"",0,"VK_JUNJA","",""],[1,0,"",0,"",0,"VK_FINAL","",""],[1,0,"",0,"",0,"VK_HANJA","",""],[1,0,"",0,"",0,"VK_KANJI","",""],[1,0,"",0,"",0,"VK_CONVERT","",""],[1,0,"",0,"",0,"VK_NONCONVERT","",""],[1,0,"",0,"",0,"VK_ACCEPT","",""],[1,0,"",0,"",0,"VK_MODECHANGE","",""],[1,0,"",0,"",0,"VK_SELECT","",""],[1,0,"",0,"",0,"VK_PRINT","",""],[1,0,"",0,"",0,"VK_EXECUTE","",""],[1,0,"",0,"",0,"VK_SNAPSHOT","",""],[1,0,"",0,"",0,"VK_HELP","",""],[1,0,"",0,"",0,"VK_APPS","",""],[1,0,"",0,"",0,"VK_PROCESSKEY","",""],[1,0,"",0,"",0,"VK_PACKET","",""],[1,0,"",0,"",0,"VK_DBE_SBCSCHAR","",""],[1,0,"",0,"",0,"VK_DBE_DBCSCHAR","",""],[1,0,"",0,"",0,"VK_ATTN","",""],[1,0,"",0,"",0,"VK_CRSEL","",""],[1,0,"",0,"",0,"VK_EXSEL","",""],[1,0,"",0,"",0,"VK_EREOF","",""],[1,0,"",0,"",0,"VK_PLAY","",""],[1,0,"",0,"",0,"VK_ZOOM","",""],[1,0,"",0,"",0,"VK_NONAME","",""],[1,0,"",0,"",0,"VK_PA1","",""],[1,0,"",0,"",0,"VK_OEM_CLEAR","",""]],t=[],i=[];for(const n of e){const[r,o,a,l,c,u,d,g,p]=n;if(i[o]||(i[o]=!0,Zge[a]=o,Jge[a.toLowerCase()]=o,r&&(p7[o]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);Ox.define(l,c),JA.define(l,g||c),eM.define(l,p||g||c)}u&&(pQ[u]=l)}})();var oh;(function(s){function e(a){return Ox.keyCodeToStr(a)}s.toString=e;function t(a){return Ox.strToKeyCode(a)}s.fromString=t;function i(a){return JA.keyCodeToStr(a)}s.toUserSettingsUS=i;function n(a){return eM.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function r(a){return JA.strToKeyCode(a)||eM.strToKeyCode(a)}s.fromUserSettings=r;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Ox.keyCodeToStr(a)}s.toElectronAccelerator=o})(oh||(oh={}));function _Q(s,e){const t=(e&65535)<<16>>>0;return(s|t)>>>0}var CH={};let S_;const zI=globalThis.vscode;var dG;if(typeof zI<"u"&&typeof zI.process<"u"){const s=zI.process;S_={get platform(){return s.platform},get arch(){return s.arch},get env(){return s.env},cwd(){return s.cwd()}}}else typeof process<"u"&&typeof((dG=process==null?void 0:process.versions)==null?void 0:dG.node)=="string"?S_={get platform(){return process.platform},get arch(){return process.arch},get env(){return CH},cwd(){return CH.VSCODE_CWD||process.cwd()}}:S_={get platform(){return cr?"win32":rt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const qL=S_.cwd,GL=S_.env,eme=S_.platform,tme=65,ime=97,nme=90,sme=122,ng=46,ms=47,Wr=92,Mc=58,rme=63;class bQ extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${n} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function ome(s,e){if(s===null||typeof s!="object")throw new bQ(e,"Object",s)}function vn(s,e){if(typeof s!="string")throw new bQ(e,"string",s)}const wd=eme==="win32";function Lt(s){return s===ms||s===Wr}function tM(s){return s===ms}function Oc(s){return s>=tme&&s<=nme||s>=ime&&s<=sme}function KL(s,e,t,i){let n="",r=0,o=-1,a=0,l=0;for(let c=0;c<=s.length;++c){if(c<s.length)l=s.charCodeAt(c);else{if(i(l))break;l=ms}if(i(l)){if(!(o===c-1||a===1))if(a===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==ng||n.charCodeAt(n.length-2)!==ng){if(n.length>2){const u=n.lastIndexOf(t);u===-1?(n="",r=0):(n=n.slice(0,u),r=n.length-1-n.lastIndexOf(t)),o=c,a=0;continue}else if(n.length!==0){n="",r=0,o=c,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",r=2)}else n.length>0?n+=`${t}${s.slice(o+1,c)}`:n=s.slice(o+1,c),r=c-o-1;o=c,a=0}else l===ng&&a!==-1?++a:a=-1}return n}function ame(s){return s?`${s[0]==="."?"":"."}${s}`:""}function CQ(s,e){ome(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${ame(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${s}${i}`:i}const Sr={resolve(...s){let e="",t="",i=!1;for(let n=s.length-1;n>=-1;n--){let r;if(n>=0){if(r=s[n],vn(r,`paths[${n}]`),r.length===0)continue}else e.length===0?r=qL():(r=GL[`=${e}`]||qL(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===Wr)&&(r=`${e}\\`));const o=r.length;let a=0,l="",c=!1;const u=r.charCodeAt(0);if(o===1)Lt(u)&&(a=1,c=!0);else if(Lt(u))if(c=!0,Lt(r.charCodeAt(1))){let d=2,g=d;for(;d<o&&!Lt(r.charCodeAt(d));)d++;if(d<o&&d!==g){const p=r.slice(g,d);for(g=d;d<o&&Lt(r.charCodeAt(d));)d++;if(d<o&&d!==g){for(g=d;d<o&&!Lt(r.charCodeAt(d));)d++;(d===o||d!==g)&&(l=`\\\\${p}\\${r.slice(g,d)}`,a=d)}}}else a=1;else Oc(u)&&r.charCodeAt(1)===Mc&&(l=r.slice(0,2),a=2,o>2&&Lt(r.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=KL(t,!i,"\\",Lt),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(s){vn(s,"path");const e=s.length;if(e===0)return".";let t=0,i,n=!1;const r=s.charCodeAt(0);if(e===1)return tM(r)?"\\":s;if(Lt(r))if(n=!0,Lt(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Lt(s.charCodeAt(a));)a++;if(a<e&&a!==l){const c=s.slice(l,a);for(l=a;a<e&&Lt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Lt(s.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${s.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${s.slice(l,a)}`,t=a)}}}else t=1;else Oc(r)&&s.charCodeAt(1)===Mc&&(i=s.slice(0,2),t=2,e>2&&Lt(s.charCodeAt(2))&&(n=!0,t=3));let o=t<e?KL(s.slice(t),!n,"\\",Lt):"";if(o.length===0&&!n&&(o="."),o.length>0&&Lt(s.charCodeAt(e-1))&&(o+="\\"),!n&&i===void 0&&s.includes(":")){if(o.length>=2&&Oc(o.charCodeAt(0))&&o.charCodeAt(1)===Mc)return`.\\${o}`;let a=s.indexOf(":");do if(a===e-1||Lt(s.charCodeAt(a+1)))return`.\\${o}`;while((a=s.indexOf(":",a+1))!==-1)}return i===void 0?n?`\\${o}`:o:n?`${i}\\${o}`:`${i}${o}`},isAbsolute(s){vn(s,"path");const e=s.length;if(e===0)return!1;const t=s.charCodeAt(0);return Lt(t)||e>2&&Oc(t)&&s.charCodeAt(1)===Mc&&Lt(s.charCodeAt(2))},join(...s){if(s.length===0)return".";let e,t;for(let r=0;r<s.length;++r){const o=s[r];vn(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Lt(t.charCodeAt(0))){++n;const r=t.length;r>1&&Lt(t.charCodeAt(1))&&(++n,r>2&&(Lt(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Lt(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return Sr.normalize(e)},relative(s,e){if(vn(s,"from"),vn(e,"to"),s===e)return"";const t=Sr.resolve(s),i=Sr.resolve(e);if(t===i||(s=t.toLowerCase(),e=i.toLowerCase(),s===e))return"";if(t.length!==s.length||i.length!==e.length){const _=t.split("\\"),C=i.split("\\");_[_.length-1]===""&&_.pop(),C[C.length-1]===""&&C.pop();const v=_.length,x=C.length,S=v<x?v:x;let k;for(k=0;k<S&&_[k].toLowerCase()===C[k].toLowerCase();k++);return k===0?i:k===S?x>S?C.slice(k).join("\\"):v>S?"..\\".repeat(v-1-k)+"..":"":"..\\".repeat(v-k)+C.slice(k).join("\\")}let n=0;for(;n<s.length&&s.charCodeAt(n)===Wr;)n++;let r=s.length;for(;r-1>n&&s.charCodeAt(r-1)===Wr;)r--;const o=r-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===Wr;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Wr;)l--;const c=l-a,u=o<c?o:c;let d=-1,g=0;for(;g<u;g++){const _=s.charCodeAt(n+g);if(_!==e.charCodeAt(a+g))break;_===Wr&&(d=g)}if(g!==u){if(d===-1)return i}else{if(c>u){if(e.charCodeAt(a+g)===Wr)return i.slice(a+g+1);if(g===2)return i.slice(a+g)}o>u&&(s.charCodeAt(n+g)===Wr?d=g:g===2&&(d=3)),d===-1&&(d=0)}let p="";for(g=n+d+1;g<=r;++g)(g===r||s.charCodeAt(g)===Wr)&&(p+=p.length===0?"..":"\\..");return a+=d,p.length>0?`${p}${i.slice(a,l)}`:(i.charCodeAt(a)===Wr&&++a,i.slice(a,l))},toNamespacedPath(s){if(typeof s!="string"||s.length===0)return s;const e=Sr.resolve(s);if(e.length<=2)return s;if(e.charCodeAt(0)===Wr){if(e.charCodeAt(1)===Wr){const t=e.charCodeAt(2);if(t!==rme&&t!==ng)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Oc(e.charCodeAt(0))&&e.charCodeAt(1)===Mc&&e.charCodeAt(2)===Wr)return`\\\\?\\${e}`;return e},dirname(s){vn(s,"path");const e=s.length;if(e===0)return".";let t=-1,i=0;const n=s.charCodeAt(0);if(e===1)return Lt(n)?s:".";if(Lt(n)){if(t=i=1,Lt(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Lt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Lt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Lt(s.charCodeAt(a));)a++;if(a===e)return s;a!==l&&(t=i=a+1)}}}}else Oc(n)&&s.charCodeAt(1)===Mc&&(t=e>2&&Lt(s.charCodeAt(2))?3:2,i=t);let r=-1,o=!0;for(let a=e-1;a>=i;--a)if(Lt(s.charCodeAt(a))){if(!o){r=a;break}}else o=!1;if(r===-1){if(t===-1)return".";r=t}return s.slice(0,r)},basename(s,e){e!==void 0&&vn(e,"suffix"),vn(s,"path");let t=0,i=-1,n=!0,r;if(s.length>=2&&Oc(s.charCodeAt(0))&&s.charCodeAt(1)===Mc&&(t=2),e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let o=e.length-1,a=-1;for(r=s.length-1;r>=t;--r){const l=s.charCodeAt(r);if(Lt(l)){if(!n){t=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(r=s.length-1;r>=t;--r)if(Lt(s.charCodeAt(r))){if(!n){t=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(t,i)},extname(s){vn(s,"path");let e=0,t=-1,i=0,n=-1,r=!0,o=0;s.length>=2&&s.charCodeAt(1)===Mc&&Oc(s.charCodeAt(0))&&(e=i=2);for(let a=s.length-1;a>=e;--a){const l=s.charCodeAt(a);if(Lt(l)){if(!r){i=a+1;break}continue}n===-1&&(r=!1,n=a+1),l===ng?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===i+1?"":s.slice(t,n)},format:CQ.bind(null,"\\"),parse(s){vn(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.length;let i=0,n=s.charCodeAt(0);if(t===1)return Lt(n)?(e.root=e.dir=s,e):(e.base=e.name=s,e);if(Lt(n)){if(i=1,Lt(s.charCodeAt(1))){let d=2,g=d;for(;d<t&&!Lt(s.charCodeAt(d));)d++;if(d<t&&d!==g){for(g=d;d<t&&Lt(s.charCodeAt(d));)d++;if(d<t&&d!==g){for(g=d;d<t&&!Lt(s.charCodeAt(d));)d++;d===t?i=d:d!==g&&(i=d+1)}}}}else if(Oc(n)&&s.charCodeAt(1)===Mc){if(t<=2)return e.root=e.dir=s,e;if(i=2,Lt(s.charCodeAt(2))){if(t===3)return e.root=e.dir=s,e;i=3}}i>0&&(e.root=s.slice(0,i));let r=-1,o=i,a=-1,l=!0,c=s.length-1,u=0;for(;c>=i;--c){if(n=s.charCodeAt(c),Lt(n)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===ng?r===-1?r=c:u!==1&&(u=1):r!==-1&&(u=-1)}return a!==-1&&(r===-1||u===0||u===1&&r===a-1&&r===o+1?e.base=e.name=s.slice(o,a):(e.name=s.slice(o,r),e.base=s.slice(o,a),e.ext=s.slice(r,a))),o>0&&o!==i?e.dir=s.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},lme=(()=>{if(wd){const s=/\\/g;return()=>{const e=qL().replace(s,"/");return e.slice(e.indexOf("/"))}}return()=>qL()})(),Gi={resolve(...s){let e="",t=!1;for(let i=s.length-1;i>=0&&!t;i--){const n=s[i];vn(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===ms)}if(!t){const i=lme();e=`${i}/${e}`,t=i.charCodeAt(0)===ms}return e=KL(e,!t,"/",tM),t?`/${e}`:e.length>0?e:"."},normalize(s){if(vn(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===ms,t=s.charCodeAt(s.length-1)===ms;return s=KL(s,!e,"/",tM),s.length===0?e?"/":t?"./":".":(t&&(s+="/"),e?`/${s}`:s)},isAbsolute(s){return vn(s,"path"),s.length>0&&s.charCodeAt(0)===ms},join(...s){if(s.length===0)return".";const e=[];for(let t=0;t<s.length;++t){const i=s[t];vn(i,"path"),i.length>0&&e.push(i)}return e.length===0?".":Gi.normalize(e.join("/"))},relative(s,e){if(vn(s,"from"),vn(e,"to"),s===e||(s=Gi.resolve(s),e=Gi.resolve(e),s===e))return"";const t=1,i=s.length,n=i-t,r=1,o=e.length-r,a=n<o?n:o;let l=-1,c=0;for(;c<a;c++){const d=s.charCodeAt(t+c);if(d!==e.charCodeAt(r+c))break;d===ms&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(r+c)===ms)return e.slice(r+c+1);if(c===0)return e.slice(r+c)}else n>a&&(s.charCodeAt(t+c)===ms?l=c:c===0&&(l=0));let u="";for(c=t+l+1;c<=i;++c)(c===i||s.charCodeAt(c)===ms)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(r+l)}`},toNamespacedPath(s){return s},dirname(s){if(vn(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===ms;let t=-1,i=!0;for(let n=s.length-1;n>=1;--n)if(s.charCodeAt(n)===ms){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":s.slice(0,t)},basename(s,e){e!==void 0&&vn(e,"suffix"),vn(s,"path");let t=0,i=-1,n=!0,r;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let o=e.length-1,a=-1;for(r=s.length-1;r>=0;--r){const l=s.charCodeAt(r);if(l===ms){if(!n){t=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===ms){if(!n){t=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(t,i)},extname(s){vn(s,"path");let e=-1,t=0,i=-1,n=!0,r=0;for(let o=s.length-1;o>=0;--o){const a=s[o];if(a==="/"){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a==="."?e===-1?e=o:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||i===-1||r===0||r===1&&e===i-1&&e===t+1?"":s.slice(e,i)},format:CQ.bind(null,"/"),parse(s){vn(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.charCodeAt(0)===ms;let i;t?(e.root="/",i=1):i=0;let n=-1,r=0,o=-1,a=!0,l=s.length-1,c=0;for(;l>=i;--l){const u=s.charCodeAt(l);if(u===ms){if(!a){r=l+1;break}continue}o===-1&&(a=!1,o=l+1),u===ng?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(o!==-1){const u=r===0&&t?1:r;n===-1||c===0||c===1&&n===o-1&&n===r+1?e.base=e.name=s.slice(u,o):(e.name=s.slice(u,n),e.base=s.slice(u,o),e.ext=s.slice(n,o))}return r>0?e.dir=s.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Gi.win32=Sr.win32=Sr;Gi.posix=Sr.posix=Gi;const wQ=wd?Sr.normalize:Gi.normalize,cme=wd?Sr.resolve:Gi.resolve,hme=wd?Sr.relative:Gi.relative,ume=wd?Sr.dirname:Gi.dirname,vQ=wd?Sr.basename:Gi.basename,dme=wd?Sr.extname:Gi.extname,Xu=wd?Sr.sep:Gi.sep,fme=/^\w[\w\d+.-]*$/,gme=/^\//,mme=/^\/\//;function pme(s,e){if(!s.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${s.authority}", path: "${s.path}", query: "${s.query}", fragment: "${s.fragment}"}`);if(s.scheme&&!fme.test(s.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(s.path){if(s.authority){if(!gme.test(s.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(mme.test(s.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function _me(s,e){return!s&&!e?"file":s}function bme(s,e){switch(s){case"https":case"http":case"file":e?e[0]!==Aa&&(e=Aa+e):e=Aa;break}return e}const Ai="",Aa="/",Cme=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class nt{static isUri(e){return e instanceof nt?!0:!e||typeof e!="object"?!1:typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function"}constructor(e,t,i,n,r,o=!1){typeof e=="object"?(this.scheme=e.scheme||Ai,this.authority=e.authority||Ai,this.path=e.path||Ai,this.query=e.query||Ai,this.fragment=e.fragment||Ai):(this.scheme=_me(e,o),this.authority=t||Ai,this.path=bme(this.scheme,i||Ai),this.query=n||Ai,this.fragment=r||Ai,pme(this,o))}get fsPath(){return YL(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:r,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=Ai),i===void 0?i=this.authority:i===null&&(i=Ai),n===void 0?n=this.path:n===null&&(n=Ai),r===void 0?r=this.query:r===null&&(r=Ai),o===void 0?o=this.fragment:o===null&&(o=Ai),t===this.scheme&&i===this.authority&&n===this.path&&r===this.query&&o===this.fragment?this:new dp(t,i,n,r,o)}static parse(e,t=!1){const i=Cme.exec(e);return i?new dp(i[2]||Ai,AS(i[4]||Ai),AS(i[5]||Ai),AS(i[7]||Ai),AS(i[9]||Ai),t):new dp(Ai,Ai,Ai,Ai,Ai)}static file(e){let t=Ai;if(cr&&(e=e.replace(/\\/g,Aa)),e[0]===Aa&&e[1]===Aa){const i=e.indexOf(Aa,2);i===-1?(t=e.substring(2),e=Aa):(t=e.substring(2,i),e=e.substring(i)||Aa)}return new dp("file",t,e,Ai,Ai)}static from(e,t){return new dp(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return cr&&e.scheme==="file"?i=nt.file(Sr.join(YL(e,!0),...t)).path:i=Gi.join(e.path,...t),e.with({path:i})}toString(e=!1){return iM(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof nt)return e;{const t=new dp(e);return t._formatted=e.external??null,t._fsPath=e._sep===yQ?e.fsPath??null:null,t}}else return e}}const yQ=cr?1:void 0;let dp=class extends nt{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=YL(this,!1)),this._fsPath}toString(e=!1){return e?iM(this,!0):(this._formatted||(this._formatted=iM(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=yQ),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const SQ={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function wH(s,e,t){let i,n=-1;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)n!==-1&&(i+=encodeURIComponent(s.substring(n,r)),n=-1),i!==void 0&&(i+=s.charAt(r));else{i===void 0&&(i=s.substr(0,r));const a=SQ[o];a!==void 0?(n!==-1&&(i+=encodeURIComponent(s.substring(n,r)),n=-1),i+=a):n===-1&&(n=r)}}return n!==-1&&(i+=encodeURIComponent(s.substring(n))),i!==void 0?i:s}function wme(s){let e;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i===35||i===63?(e===void 0&&(e=s.substr(0,t)),e+=SQ[i]):e!==void 0&&(e+=s[t])}return e!==void 0?e:s}function YL(s,e){let t;return s.authority&&s.path.length>1&&s.scheme==="file"?t=`//${s.authority}${s.path}`:s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58?e?t=s.path.substr(1):t=s.path[1].toLowerCase()+s.path.substr(2):t=s.path,cr&&(t=t.replace(/\//g,"\\")),t}function iM(s,e){const t=e?wme:wH;let i="",{scheme:n,authority:r,path:o,query:a,fragment:l}=s;if(n&&(i+=n,i+=":"),(r||n==="file")&&(i+=Aa,i+=Aa),r){let c=r.indexOf("@");if(c!==-1){const u=r.substr(0,c);r=r.substr(c+1),c=u.lastIndexOf(":"),c===-1?i+=t(u,!1,!1):(i+=t(u.substr(0,c),!1,!1),i+=":",i+=t(u.substr(c+1),!1,!0)),i+="@"}r=r.toLowerCase(),c=r.lastIndexOf(":"),c===-1?i+=t(r,!1,!0):(i+=t(r.substr(0,c),!1,!0),i+=r.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const c=o.charCodeAt(1);c>=65&&c<=90&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const c=o.charCodeAt(0);c>=65&&c<=90&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:wH(l,!1,!1)),i}function xQ(s){try{return decodeURIComponent(s)}catch{return s.length>3?s.substr(0,3)+xQ(s.substr(3)):s}}const vH=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function AS(s){return s.match(vH)?s.replace(vH,e=>xQ(e)):s}let Y=class of{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new of(e,t)}delta(e=0,t=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+t))}equals(e){return of.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return of.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return of.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const r=e.column|0,o=t.column|0;return r-o}return i-n}clone(){return new of(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new of(e.lineNumber,e.column)}static isIPosition(e){return!!e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},H=class Nn{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return Nn.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return Nn.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return Nn.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return Nn.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return Nn.plusRange(this,e)}static plusRange(e,t){let i,n,r,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,o=e.endColumn),new Nn(i,n,r,o)}intersectRanges(e){return Nn.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,u=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),r>c?(r=c,o=u):r===c&&(o=Math.min(o,u)),i>r||i===r&&n>o?null:new Nn(i,n,r,o)}equalsRange(e){return Nn.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return Nn.getEndPosition(this)}static getEndPosition(e){return new Y(e.endLineNumber,e.endColumn)}getStartPosition(){return Nn.getStartPosition(this)}static getStartPosition(e){return new Y(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new Nn(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new Nn(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return Nn.collapseToStart(this)}static collapseToStart(e){return new Nn(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return Nn.collapseToEnd(this)}static collapseToEnd(e){return new Nn(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new Nn(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,t=e){return new Nn(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new Nn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return!!e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static areOnlyIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber-1||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn-1||t.endLineNumber<e.startLineNumber-1||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn-1)}static compareRangesUsingStarts(e,t){if(e&&t){const r=e.startLineNumber|0,o=t.startLineNumber|0;if(r===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,u=t.endLineNumber|0;if(c===u){const d=e.endColumn|0,g=t.endColumn|0;return d-g}return c-u}return a-l}return r-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},gt=class ea extends H{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return ea.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new ea(this.startLineNumber,this.startColumn,e,t):new ea(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new Y(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Y(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new ea(e,t,this.endLineNumber,this.endColumn):new ea(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new ea(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new ea(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new ea(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new ea(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return!!e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,r){return r===0?new ea(e,t,i,n):new ea(i,n,e,t)}};const nM=Object.create(null);function D(s,e){if(Pn(e)){const t=nM[e];if(t===void 0)throw new Error(`${s} references an unknown codicon: ${e}`);e=t}return nM[s]=e,{id:s}}function LQ(){return nM}const vme={add:D("add",6e4),plus:D("plus",6e4),gistNew:D("gist-new",6e4),repoCreate:D("repo-create",6e4),lightbulb:D("lightbulb",60001),lightBulb:D("light-bulb",60001),repo:D("repo",60002),repoDelete:D("repo-delete",60002),gistFork:D("gist-fork",60003),repoForked:D("repo-forked",60003),gitPullRequest:D("git-pull-request",60004),gitPullRequestAbandoned:D("git-pull-request-abandoned",60004),recordKeys:D("record-keys",60005),keyboard:D("keyboard",60005),tag:D("tag",60006),gitPullRequestLabel:D("git-pull-request-label",60006),tagAdd:D("tag-add",60006),tagRemove:D("tag-remove",60006),person:D("person",60007),personFollow:D("person-follow",60007),personOutline:D("person-outline",60007),personFilled:D("person-filled",60007),sourceControl:D("source-control",60008),mirror:D("mirror",60009),mirrorPublic:D("mirror-public",60009),star:D("star",60010),starAdd:D("star-add",60010),starDelete:D("star-delete",60010),starEmpty:D("star-empty",60010),comment:D("comment",60011),commentAdd:D("comment-add",60011),alert:D("alert",60012),warning:D("warning",60012),search:D("search",60013),searchSave:D("search-save",60013),logOut:D("log-out",60014),signOut:D("sign-out",60014),logIn:D("log-in",60015),signIn:D("sign-in",60015),eye:D("eye",60016),eyeUnwatch:D("eye-unwatch",60016),eyeWatch:D("eye-watch",60016),circleFilled:D("circle-filled",60017),primitiveDot:D("primitive-dot",60017),closeDirty:D("close-dirty",60017),debugBreakpoint:D("debug-breakpoint",60017),debugBreakpointDisabled:D("debug-breakpoint-disabled",60017),debugHint:D("debug-hint",60017),terminalDecorationSuccess:D("terminal-decoration-success",60017),primitiveSquare:D("primitive-square",60018),edit:D("edit",60019),pencil:D("pencil",60019),info:D("info",60020),issueOpened:D("issue-opened",60020),gistPrivate:D("gist-private",60021),gitForkPrivate:D("git-fork-private",60021),lock:D("lock",60021),mirrorPrivate:D("mirror-private",60021),close:D("close",60022),removeClose:D("remove-close",60022),x:D("x",60022),repoSync:D("repo-sync",60023),sync:D("sync",60023),clone:D("clone",60024),desktopDownload:D("desktop-download",60024),beaker:D("beaker",60025),microscope:D("microscope",60025),vm:D("vm",60026),deviceDesktop:D("device-desktop",60026),file:D("file",60027),more:D("more",60028),ellipsis:D("ellipsis",60028),kebabHorizontal:D("kebab-horizontal",60028),mailReply:D("mail-reply",60029),reply:D("reply",60029),organization:D("organization",60030),organizationFilled:D("organization-filled",60030),organizationOutline:D("organization-outline",60030),newFile:D("new-file",60031),fileAdd:D("file-add",60031),newFolder:D("new-folder",60032),fileDirectoryCreate:D("file-directory-create",60032),trash:D("trash",60033),trashcan:D("trashcan",60033),history:D("history",60034),clock:D("clock",60034),folder:D("folder",60035),fileDirectory:D("file-directory",60035),symbolFolder:D("symbol-folder",60035),logoGithub:D("logo-github",60036),markGithub:D("mark-github",60036),github:D("github",60036),terminal:D("terminal",60037),console:D("console",60037),repl:D("repl",60037),zap:D("zap",60038),symbolEvent:D("symbol-event",60038),error:D("error",60039),stop:D("stop",60039),variable:D("variable",60040),symbolVariable:D("symbol-variable",60040),array:D("array",60042),symbolArray:D("symbol-array",60042),symbolModule:D("symbol-module",60043),symbolPackage:D("symbol-package",60043),symbolNamespace:D("symbol-namespace",60043),symbolObject:D("symbol-object",60043),symbolMethod:D("symbol-method",60044),symbolFunction:D("symbol-function",60044),symbolConstructor:D("symbol-constructor",60044),symbolBoolean:D("symbol-boolean",60047),symbolNull:D("symbol-null",60047),symbolNumeric:D("symbol-numeric",60048),symbolNumber:D("symbol-number",60048),symbolStructure:D("symbol-structure",60049),symbolStruct:D("symbol-struct",60049),symbolParameter:D("symbol-parameter",60050),symbolTypeParameter:D("symbol-type-parameter",60050),symbolKey:D("symbol-key",60051),symbolText:D("symbol-text",60051),symbolReference:D("symbol-reference",60052),goToFile:D("go-to-file",60052),symbolEnum:D("symbol-enum",60053),symbolValue:D("symbol-value",60053),symbolRuler:D("symbol-ruler",60054),symbolUnit:D("symbol-unit",60054),activateBreakpoints:D("activate-breakpoints",60055),archive:D("archive",60056),arrowBoth:D("arrow-both",60057),arrowDown:D("arrow-down",60058),arrowLeft:D("arrow-left",60059),arrowRight:D("arrow-right",60060),arrowSmallDown:D("arrow-small-down",60061),arrowSmallLeft:D("arrow-small-left",60062),arrowSmallRight:D("arrow-small-right",60063),arrowSmallUp:D("arrow-small-up",60064),arrowUp:D("arrow-up",60065),bell:D("bell",60066),bold:D("bold",60067),book:D("book",60068),bookmark:D("bookmark",60069),debugBreakpointConditionalUnverified:D("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:D("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:D("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:D("debug-breakpoint-data-unverified",60072),debugBreakpointData:D("debug-breakpoint-data",60073),debugBreakpointDataDisabled:D("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:D("debug-breakpoint-log-unverified",60074),debugBreakpointLog:D("debug-breakpoint-log",60075),debugBreakpointLogDisabled:D("debug-breakpoint-log-disabled",60075),briefcase:D("briefcase",60076),broadcast:D("broadcast",60077),browser:D("browser",60078),bug:D("bug",60079),calendar:D("calendar",60080),caseSensitive:D("case-sensitive",60081),check:D("check",60082),checklist:D("checklist",60083),chevronDown:D("chevron-down",60084),chevronLeft:D("chevron-left",60085),chevronRight:D("chevron-right",60086),chevronUp:D("chevron-up",60087),chromeClose:D("chrome-close",60088),chromeMaximize:D("chrome-maximize",60089),chromeMinimize:D("chrome-minimize",60090),chromeRestore:D("chrome-restore",60091),circleOutline:D("circle-outline",60092),circle:D("circle",60092),debugBreakpointUnverified:D("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:D("terminal-decoration-incomplete",60092),circleSlash:D("circle-slash",60093),circuitBoard:D("circuit-board",60094),clearAll:D("clear-all",60095),clippy:D("clippy",60096),closeAll:D("close-all",60097),cloudDownload:D("cloud-download",60098),cloudUpload:D("cloud-upload",60099),code:D("code",60100),collapseAll:D("collapse-all",60101),colorMode:D("color-mode",60102),commentDiscussion:D("comment-discussion",60103),creditCard:D("credit-card",60105),dash:D("dash",60108),dashboard:D("dashboard",60109),database:D("database",60110),debugContinue:D("debug-continue",60111),debugDisconnect:D("debug-disconnect",60112),debugPause:D("debug-pause",60113),debugRestart:D("debug-restart",60114),debugStart:D("debug-start",60115),debugStepInto:D("debug-step-into",60116),debugStepOut:D("debug-step-out",60117),debugStepOver:D("debug-step-over",60118),debugStop:D("debug-stop",60119),debug:D("debug",60120),deviceCameraVideo:D("device-camera-video",60121),deviceCamera:D("device-camera",60122),deviceMobile:D("device-mobile",60123),diffAdded:D("diff-added",60124),diffIgnored:D("diff-ignored",60125),diffModified:D("diff-modified",60126),diffRemoved:D("diff-removed",60127),diffRenamed:D("diff-renamed",60128),diff:D("diff",60129),diffSidebyside:D("diff-sidebyside",60129),discard:D("discard",60130),editorLayout:D("editor-layout",60131),emptyWindow:D("empty-window",60132),exclude:D("exclude",60133),extensions:D("extensions",60134),eyeClosed:D("eye-closed",60135),fileBinary:D("file-binary",60136),fileCode:D("file-code",60137),fileMedia:D("file-media",60138),filePdf:D("file-pdf",60139),fileSubmodule:D("file-submodule",60140),fileSymlinkDirectory:D("file-symlink-directory",60141),fileSymlinkFile:D("file-symlink-file",60142),fileZip:D("file-zip",60143),files:D("files",60144),filter:D("filter",60145),flame:D("flame",60146),foldDown:D("fold-down",60147),foldUp:D("fold-up",60148),fold:D("fold",60149),folderActive:D("folder-active",60150),folderOpened:D("folder-opened",60151),gear:D("gear",60152),gift:D("gift",60153),gistSecret:D("gist-secret",60154),gist:D("gist",60155),gitCommit:D("git-commit",60156),gitCompare:D("git-compare",60157),compareChanges:D("compare-changes",60157),gitMerge:D("git-merge",60158),githubAction:D("github-action",60159),githubAlt:D("github-alt",60160),globe:D("globe",60161),grabber:D("grabber",60162),graph:D("graph",60163),gripper:D("gripper",60164),heart:D("heart",60165),home:D("home",60166),horizontalRule:D("horizontal-rule",60167),hubot:D("hubot",60168),inbox:D("inbox",60169),issueReopened:D("issue-reopened",60171),issues:D("issues",60172),italic:D("italic",60173),jersey:D("jersey",60174),json:D("json",60175),kebabVertical:D("kebab-vertical",60176),key:D("key",60177),law:D("law",60178),lightbulbAutofix:D("lightbulb-autofix",60179),linkExternal:D("link-external",60180),link:D("link",60181),listOrdered:D("list-ordered",60182),listUnordered:D("list-unordered",60183),liveShare:D("live-share",60184),loading:D("loading",60185),location:D("location",60186),mailRead:D("mail-read",60187),mail:D("mail",60188),markdown:D("markdown",60189),megaphone:D("megaphone",60190),mention:D("mention",60191),milestone:D("milestone",60192),gitPullRequestMilestone:D("git-pull-request-milestone",60192),mortarBoard:D("mortar-board",60193),move:D("move",60194),multipleWindows:D("multiple-windows",60195),mute:D("mute",60196),noNewline:D("no-newline",60197),note:D("note",60198),octoface:D("octoface",60199),openPreview:D("open-preview",60200),package:D("package",60201),paintcan:D("paintcan",60202),pin:D("pin",60203),play:D("play",60204),run:D("run",60204),plug:D("plug",60205),preserveCase:D("preserve-case",60206),preview:D("preview",60207),project:D("project",60208),pulse:D("pulse",60209),question:D("question",60210),quote:D("quote",60211),radioTower:D("radio-tower",60212),reactions:D("reactions",60213),references:D("references",60214),refresh:D("refresh",60215),regex:D("regex",60216),remoteExplorer:D("remote-explorer",60217),remote:D("remote",60218),remove:D("remove",60219),replaceAll:D("replace-all",60220),replace:D("replace",60221),repoClone:D("repo-clone",60222),repoForcePush:D("repo-force-push",60223),repoPull:D("repo-pull",60224),repoPush:D("repo-push",60225),report:D("report",60226),requestChanges:D("request-changes",60227),rocket:D("rocket",60228),rootFolderOpened:D("root-folder-opened",60229),rootFolder:D("root-folder",60230),rss:D("rss",60231),ruby:D("ruby",60232),saveAll:D("save-all",60233),saveAs:D("save-as",60234),save:D("save",60235),screenFull:D("screen-full",60236),screenNormal:D("screen-normal",60237),searchStop:D("search-stop",60238),server:D("server",60240),settingsGear:D("settings-gear",60241),settings:D("settings",60242),shield:D("shield",60243),smiley:D("smiley",60244),sortPrecedence:D("sort-precedence",60245),splitHorizontal:D("split-horizontal",60246),splitVertical:D("split-vertical",60247),squirrel:D("squirrel",60248),starFull:D("star-full",60249),starHalf:D("star-half",60250),symbolClass:D("symbol-class",60251),symbolColor:D("symbol-color",60252),symbolConstant:D("symbol-constant",60253),symbolEnumMember:D("symbol-enum-member",60254),symbolField:D("symbol-field",60255),symbolFile:D("symbol-file",60256),symbolInterface:D("symbol-interface",60257),symbolKeyword:D("symbol-keyword",60258),symbolMisc:D("symbol-misc",60259),symbolOperator:D("symbol-operator",60260),symbolProperty:D("symbol-property",60261),wrench:D("wrench",60261),wrenchSubaction:D("wrench-subaction",60261),symbolSnippet:D("symbol-snippet",60262),tasklist:D("tasklist",60263),telescope:D("telescope",60264),textSize:D("text-size",60265),threeBars:D("three-bars",60266),thumbsdown:D("thumbsdown",60267),thumbsup:D("thumbsup",60268),tools:D("tools",60269),triangleDown:D("triangle-down",60270),triangleLeft:D("triangle-left",60271),triangleRight:D("triangle-right",60272),triangleUp:D("triangle-up",60273),twitter:D("twitter",60274),unfold:D("unfold",60275),unlock:D("unlock",60276),unmute:D("unmute",60277),unverified:D("unverified",60278),verified:D("verified",60279),versions:D("versions",60280),vmActive:D("vm-active",60281),vmOutline:D("vm-outline",60282),vmRunning:D("vm-running",60283),watch:D("watch",60284),whitespace:D("whitespace",60285),wholeWord:D("whole-word",60286),window:D("window",60287),wordWrap:D("word-wrap",60288),zoomIn:D("zoom-in",60289),zoomOut:D("zoom-out",60290),listFilter:D("list-filter",60291),listFlat:D("list-flat",60292),listSelection:D("list-selection",60293),selection:D("selection",60293),listTree:D("list-tree",60294),debugBreakpointFunctionUnverified:D("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:D("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:D("debug-breakpoint-function-disabled",60296),debugStackframeActive:D("debug-stackframe-active",60297),circleSmallFilled:D("circle-small-filled",60298),debugStackframeDot:D("debug-stackframe-dot",60298),terminalDecorationMark:D("terminal-decoration-mark",60298),debugStackframe:D("debug-stackframe",60299),debugStackframeFocused:D("debug-stackframe-focused",60299),debugBreakpointUnsupported:D("debug-breakpoint-unsupported",60300),symbolString:D("symbol-string",60301),debugReverseContinue:D("debug-reverse-continue",60302),debugStepBack:D("debug-step-back",60303),debugRestartFrame:D("debug-restart-frame",60304),debugAlt:D("debug-alt",60305),callIncoming:D("call-incoming",60306),callOutgoing:D("call-outgoing",60307),menu:D("menu",60308),expandAll:D("expand-all",60309),feedback:D("feedback",60310),gitPullRequestReviewer:D("git-pull-request-reviewer",60310),groupByRefType:D("group-by-ref-type",60311),ungroupByRefType:D("ungroup-by-ref-type",60312),account:D("account",60313),gitPullRequestAssignee:D("git-pull-request-assignee",60313),bellDot:D("bell-dot",60314),debugConsole:D("debug-console",60315),library:D("library",60316),output:D("output",60317),runAll:D("run-all",60318),syncIgnored:D("sync-ignored",60319),pinned:D("pinned",60320),githubInverted:D("github-inverted",60321),serverProcess:D("server-process",60322),serverEnvironment:D("server-environment",60323),pass:D("pass",60324),issueClosed:D("issue-closed",60324),stopCircle:D("stop-circle",60325),playCircle:D("play-circle",60326),record:D("record",60327),debugAltSmall:D("debug-alt-small",60328),vmConnect:D("vm-connect",60329),cloud:D("cloud",60330),merge:D("merge",60331),export:D("export",60332),graphLeft:D("graph-left",60333),magnet:D("magnet",60334),notebook:D("notebook",60335),redo:D("redo",60336),checkAll:D("check-all",60337),pinnedDirty:D("pinned-dirty",60338),passFilled:D("pass-filled",60339),circleLargeFilled:D("circle-large-filled",60340),circleLarge:D("circle-large",60341),circleLargeOutline:D("circle-large-outline",60341),combine:D("combine",60342),gather:D("gather",60342),table:D("table",60343),variableGroup:D("variable-group",60344),typeHierarchy:D("type-hierarchy",60345),typeHierarchySub:D("type-hierarchy-sub",60346),typeHierarchySuper:D("type-hierarchy-super",60347),gitPullRequestCreate:D("git-pull-request-create",60348),runAbove:D("run-above",60349),runBelow:D("run-below",60350),notebookTemplate:D("notebook-template",60351),debugRerun:D("debug-rerun",60352),workspaceTrusted:D("workspace-trusted",60353),workspaceUntrusted:D("workspace-untrusted",60354),workspaceUnknown:D("workspace-unknown",60355),terminalCmd:D("terminal-cmd",60356),terminalDebian:D("terminal-debian",60357),terminalLinux:D("terminal-linux",60358),terminalPowershell:D("terminal-powershell",60359),terminalTmux:D("terminal-tmux",60360),terminalUbuntu:D("terminal-ubuntu",60361),terminalBash:D("terminal-bash",60362),arrowSwap:D("arrow-swap",60363),copy:D("copy",60364),personAdd:D("person-add",60365),filterFilled:D("filter-filled",60366),wand:D("wand",60367),debugLineByLine:D("debug-line-by-line",60368),inspect:D("inspect",60369),layers:D("layers",60370),layersDot:D("layers-dot",60371),layersActive:D("layers-active",60372),compass:D("compass",60373),compassDot:D("compass-dot",60374),compassActive:D("compass-active",60375),azure:D("azure",60376),issueDraft:D("issue-draft",60377),gitPullRequestClosed:D("git-pull-request-closed",60378),gitPullRequestDraft:D("git-pull-request-draft",60379),debugAll:D("debug-all",60380),debugCoverage:D("debug-coverage",60381),runErrors:D("run-errors",60382),folderLibrary:D("folder-library",60383),debugContinueSmall:D("debug-continue-small",60384),beakerStop:D("beaker-stop",60385),graphLine:D("graph-line",60386),graphScatter:D("graph-scatter",60387),pieChart:D("pie-chart",60388),bracket:D("bracket",60175),bracketDot:D("bracket-dot",60389),bracketError:D("bracket-error",60390),lockSmall:D("lock-small",60391),azureDevops:D("azure-devops",60392),verifiedFilled:D("verified-filled",60393),newline:D("newline",60394),layout:D("layout",60395),layoutActivitybarLeft:D("layout-activitybar-left",60396),layoutActivitybarRight:D("layout-activitybar-right",60397),layoutPanelLeft:D("layout-panel-left",60398),layoutPanelCenter:D("layout-panel-center",60399),layoutPanelJustify:D("layout-panel-justify",60400),layoutPanelRight:D("layout-panel-right",60401),layoutPanel:D("layout-panel",60402),layoutSidebarLeft:D("layout-sidebar-left",60403),layoutSidebarRight:D("layout-sidebar-right",60404),layoutStatusbar:D("layout-statusbar",60405),layoutMenubar:D("layout-menubar",60406),layoutCentered:D("layout-centered",60407),target:D("target",60408),indent:D("indent",60409),recordSmall:D("record-small",60410),errorSmall:D("error-small",60411),terminalDecorationError:D("terminal-decoration-error",60411),arrowCircleDown:D("arrow-circle-down",60412),arrowCircleLeft:D("arrow-circle-left",60413),arrowCircleRight:D("arrow-circle-right",60414),arrowCircleUp:D("arrow-circle-up",60415),layoutSidebarRightOff:D("layout-sidebar-right-off",60416),layoutPanelOff:D("layout-panel-off",60417),layoutSidebarLeftOff:D("layout-sidebar-left-off",60418),blank:D("blank",60419),heartFilled:D("heart-filled",60420),map:D("map",60421),mapHorizontal:D("map-horizontal",60421),foldHorizontal:D("fold-horizontal",60421),mapFilled:D("map-filled",60422),mapHorizontalFilled:D("map-horizontal-filled",60422),foldHorizontalFilled:D("fold-horizontal-filled",60422),circleSmall:D("circle-small",60423),bellSlash:D("bell-slash",60424),bellSlashDot:D("bell-slash-dot",60425),commentUnresolved:D("comment-unresolved",60426),gitPullRequestGoToChanges:D("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:D("git-pull-request-new-changes",60428),searchFuzzy:D("search-fuzzy",60429),commentDraft:D("comment-draft",60430),send:D("send",60431),sparkle:D("sparkle",60432),insert:D("insert",60433),mic:D("mic",60434),thumbsdownFilled:D("thumbsdown-filled",60435),thumbsupFilled:D("thumbsup-filled",60436),coffee:D("coffee",60437),snake:D("snake",60438),game:D("game",60439),vr:D("vr",60440),chip:D("chip",60441),piano:D("piano",60442),music:D("music",60443),micFilled:D("mic-filled",60444),repoFetch:D("repo-fetch",60445),copilot:D("copilot",60446),lightbulbSparkle:D("lightbulb-sparkle",60447),robot:D("robot",60448),sparkleFilled:D("sparkle-filled",60449),diffSingle:D("diff-single",60450),diffMultiple:D("diff-multiple",60451),surroundWith:D("surround-with",60452),share:D("share",60453),gitStash:D("git-stash",60454),gitStashApply:D("git-stash-apply",60455),gitStashPop:D("git-stash-pop",60456),vscode:D("vscode",60457),vscodeInsiders:D("vscode-insiders",60458),codeOss:D("code-oss",60459),runCoverage:D("run-coverage",60460),runAllCoverage:D("run-all-coverage",60461),coverage:D("coverage",60462),githubProject:D("github-project",60463),mapVertical:D("map-vertical",60464),foldVertical:D("fold-vertical",60464),mapVerticalFilled:D("map-vertical-filled",60465),foldVerticalFilled:D("fold-vertical-filled",60465),goToSearch:D("go-to-search",60466),percentage:D("percentage",60467),sortPercentage:D("sort-percentage",60467),attach:D("attach",60468),goToEditingSession:D("go-to-editing-session",60469),editSession:D("edit-session",60470),codeReview:D("code-review",60471),copilotWarning:D("copilot-warning",60472),python:D("python",60473),copilotLarge:D("copilot-large",60474),copilotWarningLarge:D("copilot-warning-large",60475),keyboardTab:D("keyboard-tab",60476),copilotBlocked:D("copilot-blocked",60477),copilotNotConnected:D("copilot-not-connected",60478),flag:D("flag",60479),lightbulbEmpty:D("lightbulb-empty",60480),symbolMethodArrow:D("symbol-method-arrow",60481),copilotUnavailable:D("copilot-unavailable",60482),repoPinned:D("repo-pinned",60483),keyboardTabAbove:D("keyboard-tab-above",60484),keyboardTabBelow:D("keyboard-tab-below",60485),gitPullRequestDone:D("git-pull-request-done",60486),mcp:D("mcp",60487),extensionsLarge:D("extensions-large",60488),layoutPanelDock:D("layout-panel-dock",60489),layoutSidebarLeftDock:D("layout-sidebar-left-dock",60490),layoutSidebarRightDock:D("layout-sidebar-right-dock",60491),copilotInProgress:D("copilot-in-progress",60492),copilotError:D("copilot-error",60493),copilotSuccess:D("copilot-success",60494),chatSparkle:D("chat-sparkle",60495),searchSparkle:D("search-sparkle",60496),editSparkle:D("edit-sparkle",60497),copilotSnooze:D("copilot-snooze",60498),sendToRemoteAgent:D("send-to-remote-agent",60499),commentDiscussionSparkle:D("comment-discussion-sparkle",60500),chatSparkleWarning:D("chat-sparkle-warning",60501),chatSparkleError:D("chat-sparkle-error",60502),collection:D("collection",60503),newCollection:D("new-collection",60504),thinking:D("thinking",60505),build:D("build",60506),commentDiscussionQuote:D("comment-discussion-quote",60507),cursor:D("cursor",60508),eraser:D("eraser",60509),fileText:D("file-text",60510),gitLens:D("git-lens",60511),quotes:D("quotes",60512),rename:D("rename",60513),runWithDeps:D("run-with-deps",60514),debugConnected:D("debug-connected",60515),strikethrough:D("strikethrough",60516),openInProduct:D("open-in-product",60517),indexZero:D("index-zero",60518),agent:D("agent",60519),editCode:D("edit-code",60520),repoSelected:D("repo-selected",60521),skip:D("skip",60522),mergeInto:D("merge-into",60523),gitBranchChanges:D("git-branch-changes",60524),gitBranchStagedChanges:D("git-branch-staged-changes",60525),gitBranchConflicts:D("git-branch-conflicts",60526),gitBranch:D("git-branch",60527),gitBranchCreate:D("git-branch-create",60527),gitBranchDelete:D("git-branch-delete",60527),searchLarge:D("search-large",60528),terminalGitBash:D("terminal-git-bash",60529)},yme={dialogError:D("dialog-error","error"),dialogWarning:D("dialog-warning","warning"),dialogInfo:D("dialog-info","info"),dialogClose:D("dialog-close","close"),treeItemExpanded:D("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:D("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:D("tree-filter-on-type-off","list-selection"),treeFilterClear:D("tree-filter-clear","close"),treeItemLoading:D("tree-item-loading","loading"),menuSelection:D("menu-selection","check"),menuSubmenu:D("menu-submenu","chevron-right"),menuBarMore:D("menubar-more","more"),scrollbarButtonLeft:D("scrollbar-button-left","triangle-left"),scrollbarButtonRight:D("scrollbar-button-right","triangle-right"),scrollbarButtonUp:D("scrollbar-button-up","triangle-up"),scrollbarButtonDown:D("scrollbar-button-down","triangle-down"),toolBarMore:D("toolbar-more","more"),quickInputBack:D("quick-input-back","arrow-left"),dropDownButton:D("drop-down-button",60084),symbolCustomColor:D("symbol-customcolor",60252),exportIcon:D("export",60332),workspaceUnspecified:D("workspace-unspecified",60355),newLine:D("newline",60394),thumbsDownFilled:D("thumbsdown-filled",60435),thumbsUpFilled:D("thumbsup-filled",60436),gitFetch:D("git-fetch",60445),lightbulbSparkleAutofix:D("lightbulb-sparkle-autofix",60447),debugBreakpointPending:D("debug-breakpoint-pending",60377)},xe={...vme,...yme};let Sme=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new $,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Fe(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var n;(n=this._factories.get(e))==null||n.dispose();const i=new xme(this,e,t);return this._factories.set(e,i),Fe(()=>{const r=this._factories.get(e);!r||r!==i||(this._factories.delete(e),r.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class xme extends ne{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}let fw=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class _7{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class X2{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var yH;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(yH||(yH={}));var SH;(function(s){const e=new Map;e.set(0,xe.symbolMethod),e.set(1,xe.symbolFunction),e.set(2,xe.symbolConstructor),e.set(3,xe.symbolField),e.set(4,xe.symbolVariable),e.set(5,xe.symbolClass),e.set(6,xe.symbolStruct),e.set(7,xe.symbolInterface),e.set(8,xe.symbolModule),e.set(9,xe.symbolProperty),e.set(10,xe.symbolEvent),e.set(11,xe.symbolOperator),e.set(12,xe.symbolUnit),e.set(13,xe.symbolValue),e.set(15,xe.symbolEnum),e.set(14,xe.symbolConstant),e.set(15,xe.symbolEnum),e.set(16,xe.symbolEnumMember),e.set(17,xe.symbolKeyword),e.set(28,xe.symbolSnippet),e.set(18,xe.symbolText),e.set(19,xe.symbolColor),e.set(20,xe.symbolFile),e.set(21,xe.symbolReference),e.set(22,xe.symbolCustomColor),e.set(23,xe.symbolFolder),e.set(24,xe.symbolTypeParameter),e.set(25,xe.account),e.set(26,xe.issues),e.set(27,xe.tools);function t(o){let a=e.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=xe.symbolProperty),a}s.toIcon=t;function i(o){switch(o){case 0:return w(728,"Method");case 1:return w(729,"Function");case 2:return w(730,"Constructor");case 3:return w(731,"Field");case 4:return w(732,"Variable");case 5:return w(733,"Class");case 6:return w(734,"Struct");case 7:return w(735,"Interface");case 8:return w(736,"Module");case 9:return w(737,"Property");case 10:return w(738,"Event");case 11:return w(739,"Operator");case 12:return w(740,"Unit");case 13:return w(741,"Value");case 14:return w(742,"Constant");case 15:return w(743,"Enum");case 16:return w(744,"Enum Member");case 17:return w(745,"Keyword");case 18:return w(746,"Text");case 19:return w(747,"Color");case 20:return w(748,"File");case 21:return w(749,"Reference");case 22:return w(750,"Custom Color");case 23:return w(751,"Folder");case 24:return w(752,"Type Parameter");case 25:return w(753,"User");case 26:return w(754,"Issue");case 27:return w(755,"Tool");case 28:return w(756,"Snippet");default:return""}}s.toLabel=i;const n=new Map;n.set("method",0),n.set("function",1),n.set("constructor",2),n.set("field",3),n.set("variable",4),n.set("class",5),n.set("struct",6),n.set("interface",7),n.set("module",8),n.set("property",9),n.set("event",10),n.set("operator",11),n.set("unit",12),n.set("value",13),n.set("constant",14),n.set("enum",15),n.set("enum-member",16),n.set("enumMember",16),n.set("keyword",17),n.set("snippet",28),n.set("text",18),n.set("color",19),n.set("file",20),n.set("reference",21),n.set("customcolor",22),n.set("folder",23),n.set("type-parameter",24),n.set("typeParameter",24),n.set("account",25),n.set("issue",26),n.set("tool",27);function r(o,a){let l=n.get(o);return typeof l>"u"&&!a&&(l=9),l}s.fromString=r})(SH||(SH={}));var xH;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(xH||(xH={}));class Lme{constructor(e,t,i,n){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=n}equals(e){return H.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var LH;(function(s){s[s.Code=1]="Code",s[s.Label=2]="Label"})(LH||(LH={}));var kH;(function(s){s[s.Accepted=0]="Accepted",s[s.Rejected=1]="Rejected",s[s.Ignored=2]="Ignored"})(kH||(kH={}));var EH;(function(s){s[s.Automatic=0]="Automatic",s[s.PasteAs=1]="PasteAs"})(EH||(EH={}));var DH;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(DH||(DH={}));var TH;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(TH||(TH={}));w(757,"array"),w(758,"boolean"),w(759,"class"),w(760,"constant"),w(761,"constructor"),w(762,"enumeration"),w(763,"enumeration member"),w(764,"event"),w(765,"field"),w(766,"file"),w(767,"function"),w(768,"interface"),w(769,"key"),w(770,"method"),w(771,"module"),w(772,"namespace"),w(773,"null"),w(774,"number"),w(775,"object"),w(776,"operator"),w(777,"package"),w(778,"property"),w(779,"string"),w(780,"struct"),w(781,"type parameter"),w(782,"variable");var sM;(function(s){const e=new Map;e.set(0,xe.symbolFile),e.set(1,xe.symbolModule),e.set(2,xe.symbolNamespace),e.set(3,xe.symbolPackage),e.set(4,xe.symbolClass),e.set(5,xe.symbolMethod),e.set(6,xe.symbolProperty),e.set(7,xe.symbolField),e.set(8,xe.symbolConstructor),e.set(9,xe.symbolEnum),e.set(10,xe.symbolInterface),e.set(11,xe.symbolFunction),e.set(12,xe.symbolVariable),e.set(13,xe.symbolConstant),e.set(14,xe.symbolString),e.set(15,xe.symbolNumber),e.set(16,xe.symbolBoolean),e.set(17,xe.symbolArray),e.set(18,xe.symbolObject),e.set(19,xe.symbolKey),e.set(20,xe.symbolNull),e.set(21,xe.symbolEnumMember),e.set(22,xe.symbolStruct),e.set(23,xe.symbolEvent),e.set(24,xe.symbolOperator),e.set(25,xe.symbolTypeParameter);function t(r){let o=e.get(r);return o||(console.info("No codicon found for SymbolKind "+r),o=xe.symbolProperty),o}s.toIcon=t;const i=new Map;i.set(0,20),i.set(1,8),i.set(2,8),i.set(3,8),i.set(4,5),i.set(5,0),i.set(6,9),i.set(7,3),i.set(8,2),i.set(9,15),i.set(10,7),i.set(11,1),i.set(12,4),i.set(13,14),i.set(14,18),i.set(15,13),i.set(16,13),i.set(17,13),i.set(18,13),i.set(19,17),i.set(20,13),i.set(21,16),i.set(22,6),i.set(23,10),i.set(24,11),i.set(25,24);function n(r){let o=i.get(r);return o===void 0&&(console.info("No completion kind found for SymbolKind "+r),o=20),o}s.toCompletionKind=n})(sM||(sM={}));const ia=class ia{static fromValue(e){switch(e){case"comment":return ia.Comment;case"imports":return ia.Imports;case"region":return ia.Region}return new ia(e)}constructor(e){this.value=e}};ia.Comment=new ia("comment"),ia.Imports=new ia("imports"),ia.Region=new ia("region");let rM=ia;var NH;(function(s){s[s.AIGenerated=1]="AIGenerated"})(NH||(NH={}));var IH;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(IH||(IH={}));var RH;(function(s){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}s.is=e})(RH||(RH={}));var AH;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(AH||(AH={}));class kme{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const qi=new Sme;var oM;(function(s){s[s.Unknown=0]="Unknown",s[s.Disabled=1]="Disabled",s[s.Enabled=2]="Enabled"})(oM||(oM={}));var aM;(function(s){s[s.Invoke=1]="Invoke",s[s.Auto=2]="Auto"})(aM||(aM={}));var lM;(function(s){s[s.None=0]="None",s[s.KeepWhitespace=1]="KeepWhitespace",s[s.InsertAsSnippet=4]="InsertAsSnippet"})(lM||(lM={}));var cM;(function(s){s[s.Method=0]="Method",s[s.Function=1]="Function",s[s.Constructor=2]="Constructor",s[s.Field=3]="Field",s[s.Variable=4]="Variable",s[s.Class=5]="Class",s[s.Struct=6]="Struct",s[s.Interface=7]="Interface",s[s.Module=8]="Module",s[s.Property=9]="Property",s[s.Event=10]="Event",s[s.Operator=11]="Operator",s[s.Unit=12]="Unit",s[s.Value=13]="Value",s[s.Constant=14]="Constant",s[s.Enum=15]="Enum",s[s.EnumMember=16]="EnumMember",s[s.Keyword=17]="Keyword",s[s.Text=18]="Text",s[s.Color=19]="Color",s[s.File=20]="File",s[s.Reference=21]="Reference",s[s.Customcolor=22]="Customcolor",s[s.Folder=23]="Folder",s[s.TypeParameter=24]="TypeParameter",s[s.User=25]="User",s[s.Issue=26]="Issue",s[s.Tool=27]="Tool",s[s.Snippet=28]="Snippet"})(cM||(cM={}));var hM;(function(s){s[s.Deprecated=1]="Deprecated"})(hM||(hM={}));var uM;(function(s){s[s.Invoke=0]="Invoke",s[s.TriggerCharacter=1]="TriggerCharacter",s[s.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(uM||(uM={}));var dM;(function(s){s[s.EXACT=0]="EXACT",s[s.ABOVE=1]="ABOVE",s[s.BELOW=2]="BELOW"})(dM||(dM={}));var fM;(function(s){s[s.NotSet=0]="NotSet",s[s.ContentFlush=1]="ContentFlush",s[s.RecoverFromMarkers=2]="RecoverFromMarkers",s[s.Explicit=3]="Explicit",s[s.Paste=4]="Paste",s[s.Undo=5]="Undo",s[s.Redo=6]="Redo"})(fM||(fM={}));var gM;(function(s){s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(gM||(gM={}));var mM;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(mM||(mM={}));var pM;(function(s){s[s.None=0]="None",s[s.Keep=1]="Keep",s[s.Brackets=2]="Brackets",s[s.Advanced=3]="Advanced",s[s.Full=4]="Full"})(pM||(pM={}));var _M;(function(s){s[s.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",s[s.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",s[s.accessibilitySupport=2]="accessibilitySupport",s[s.accessibilityPageSize=3]="accessibilityPageSize",s[s.allowOverflow=4]="allowOverflow",s[s.allowVariableLineHeights=5]="allowVariableLineHeights",s[s.allowVariableFonts=6]="allowVariableFonts",s[s.allowVariableFontsInAccessibilityMode=7]="allowVariableFontsInAccessibilityMode",s[s.ariaLabel=8]="ariaLabel",s[s.ariaRequired=9]="ariaRequired",s[s.autoClosingBrackets=10]="autoClosingBrackets",s[s.autoClosingComments=11]="autoClosingComments",s[s.screenReaderAnnounceInlineSuggestion=12]="screenReaderAnnounceInlineSuggestion",s[s.autoClosingDelete=13]="autoClosingDelete",s[s.autoClosingOvertype=14]="autoClosingOvertype",s[s.autoClosingQuotes=15]="autoClosingQuotes",s[s.autoIndent=16]="autoIndent",s[s.autoIndentOnPaste=17]="autoIndentOnPaste",s[s.autoIndentOnPasteWithinString=18]="autoIndentOnPasteWithinString",s[s.automaticLayout=19]="automaticLayout",s[s.autoSurround=20]="autoSurround",s[s.bracketPairColorization=21]="bracketPairColorization",s[s.guides=22]="guides",s[s.codeLens=23]="codeLens",s[s.codeLensFontFamily=24]="codeLensFontFamily",s[s.codeLensFontSize=25]="codeLensFontSize",s[s.colorDecorators=26]="colorDecorators",s[s.colorDecoratorsLimit=27]="colorDecoratorsLimit",s[s.columnSelection=28]="columnSelection",s[s.comments=29]="comments",s[s.contextmenu=30]="contextmenu",s[s.copyWithSyntaxHighlighting=31]="copyWithSyntaxHighlighting",s[s.cursorBlinking=32]="cursorBlinking",s[s.cursorSmoothCaretAnimation=33]="cursorSmoothCaretAnimation",s[s.cursorStyle=34]="cursorStyle",s[s.cursorSurroundingLines=35]="cursorSurroundingLines",s[s.cursorSurroundingLinesStyle=36]="cursorSurroundingLinesStyle",s[s.cursorWidth=37]="cursorWidth",s[s.cursorHeight=38]="cursorHeight",s[s.disableLayerHinting=39]="disableLayerHinting",s[s.disableMonospaceOptimizations=40]="disableMonospaceOptimizations",s[s.domReadOnly=41]="domReadOnly",s[s.dragAndDrop=42]="dragAndDrop",s[s.dropIntoEditor=43]="dropIntoEditor",s[s.editContext=44]="editContext",s[s.emptySelectionClipboard=45]="emptySelectionClipboard",s[s.experimentalGpuAcceleration=46]="experimentalGpuAcceleration",s[s.experimentalWhitespaceRendering=47]="experimentalWhitespaceRendering",s[s.extraEditorClassName=48]="extraEditorClassName",s[s.fastScrollSensitivity=49]="fastScrollSensitivity",s[s.find=50]="find",s[s.fixedOverflowWidgets=51]="fixedOverflowWidgets",s[s.folding=52]="folding",s[s.foldingStrategy=53]="foldingStrategy",s[s.foldingHighlight=54]="foldingHighlight",s[s.foldingImportsByDefault=55]="foldingImportsByDefault",s[s.foldingMaximumRegions=56]="foldingMaximumRegions",s[s.unfoldOnClickAfterEndOfLine=57]="unfoldOnClickAfterEndOfLine",s[s.fontFamily=58]="fontFamily",s[s.fontInfo=59]="fontInfo",s[s.fontLigatures=60]="fontLigatures",s[s.fontSize=61]="fontSize",s[s.fontWeight=62]="fontWeight",s[s.fontVariations=63]="fontVariations",s[s.formatOnPaste=64]="formatOnPaste",s[s.formatOnType=65]="formatOnType",s[s.glyphMargin=66]="glyphMargin",s[s.gotoLocation=67]="gotoLocation",s[s.hideCursorInOverviewRuler=68]="hideCursorInOverviewRuler",s[s.hover=69]="hover",s[s.inDiffEditor=70]="inDiffEditor",s[s.inlineSuggest=71]="inlineSuggest",s[s.letterSpacing=72]="letterSpacing",s[s.lightbulb=73]="lightbulb",s[s.lineDecorationsWidth=74]="lineDecorationsWidth",s[s.lineHeight=75]="lineHeight",s[s.lineNumbers=76]="lineNumbers",s[s.lineNumbersMinChars=77]="lineNumbersMinChars",s[s.linkedEditing=78]="linkedEditing",s[s.links=79]="links",s[s.matchBrackets=80]="matchBrackets",s[s.minimap=81]="minimap",s[s.mouseStyle=82]="mouseStyle",s[s.mouseWheelScrollSensitivity=83]="mouseWheelScrollSensitivity",s[s.mouseWheelZoom=84]="mouseWheelZoom",s[s.multiCursorMergeOverlapping=85]="multiCursorMergeOverlapping",s[s.multiCursorModifier=86]="multiCursorModifier",s[s.mouseMiddleClickAction=87]="mouseMiddleClickAction",s[s.multiCursorPaste=88]="multiCursorPaste",s[s.multiCursorLimit=89]="multiCursorLimit",s[s.occurrencesHighlight=90]="occurrencesHighlight",s[s.occurrencesHighlightDelay=91]="occurrencesHighlightDelay",s[s.overtypeCursorStyle=92]="overtypeCursorStyle",s[s.overtypeOnPaste=93]="overtypeOnPaste",s[s.overviewRulerBorder=94]="overviewRulerBorder",s[s.overviewRulerLanes=95]="overviewRulerLanes",s[s.padding=96]="padding",s[s.pasteAs=97]="pasteAs",s[s.parameterHints=98]="parameterHints",s[s.peekWidgetDefaultFocus=99]="peekWidgetDefaultFocus",s[s.placeholder=100]="placeholder",s[s.definitionLinkOpensInPeek=101]="definitionLinkOpensInPeek",s[s.quickSuggestions=102]="quickSuggestions",s[s.quickSuggestionsDelay=103]="quickSuggestionsDelay",s[s.readOnly=104]="readOnly",s[s.readOnlyMessage=105]="readOnlyMessage",s[s.renameOnType=106]="renameOnType",s[s.renderRichScreenReaderContent=107]="renderRichScreenReaderContent",s[s.renderControlCharacters=108]="renderControlCharacters",s[s.renderFinalNewline=109]="renderFinalNewline",s[s.renderLineHighlight=110]="renderLineHighlight",s[s.renderLineHighlightOnlyWhenFocus=111]="renderLineHighlightOnlyWhenFocus",s[s.renderValidationDecorations=112]="renderValidationDecorations",s[s.renderWhitespace=113]="renderWhitespace",s[s.revealHorizontalRightPadding=114]="revealHorizontalRightPadding",s[s.roundedSelection=115]="roundedSelection",s[s.rulers=116]="rulers",s[s.scrollbar=117]="scrollbar",s[s.scrollBeyondLastColumn=118]="scrollBeyondLastColumn",s[s.scrollBeyondLastLine=119]="scrollBeyondLastLine",s[s.scrollPredominantAxis=120]="scrollPredominantAxis",s[s.selectionClipboard=121]="selectionClipboard",s[s.selectionHighlight=122]="selectionHighlight",s[s.selectionHighlightMaxLength=123]="selectionHighlightMaxLength",s[s.selectionHighlightMultiline=124]="selectionHighlightMultiline",s[s.selectOnLineNumbers=125]="selectOnLineNumbers",s[s.showFoldingControls=126]="showFoldingControls",s[s.showUnused=127]="showUnused",s[s.snippetSuggestions=128]="snippetSuggestions",s[s.smartSelect=129]="smartSelect",s[s.smoothScrolling=130]="smoothScrolling",s[s.stickyScroll=131]="stickyScroll",s[s.stickyTabStops=132]="stickyTabStops",s[s.stopRenderingLineAfter=133]="stopRenderingLineAfter",s[s.suggest=134]="suggest",s[s.suggestFontSize=135]="suggestFontSize",s[s.suggestLineHeight=136]="suggestLineHeight",s[s.suggestOnTriggerCharacters=137]="suggestOnTriggerCharacters",s[s.suggestSelection=138]="suggestSelection",s[s.tabCompletion=139]="tabCompletion",s[s.tabIndex=140]="tabIndex",s[s.trimWhitespaceOnDelete=141]="trimWhitespaceOnDelete",s[s.unicodeHighlighting=142]="unicodeHighlighting",s[s.unusualLineTerminators=143]="unusualLineTerminators",s[s.useShadowDOM=144]="useShadowDOM",s[s.useTabStops=145]="useTabStops",s[s.wordBreak=146]="wordBreak",s[s.wordSegmenterLocales=147]="wordSegmenterLocales",s[s.wordSeparators=148]="wordSeparators",s[s.wordWrap=149]="wordWrap",s[s.wordWrapBreakAfterCharacters=150]="wordWrapBreakAfterCharacters",s[s.wordWrapBreakBeforeCharacters=151]="wordWrapBreakBeforeCharacters",s[s.wordWrapColumn=152]="wordWrapColumn",s[s.wordWrapOverride1=153]="wordWrapOverride1",s[s.wordWrapOverride2=154]="wordWrapOverride2",s[s.wrappingIndent=155]="wrappingIndent",s[s.wrappingStrategy=156]="wrappingStrategy",s[s.showDeprecated=157]="showDeprecated",s[s.inertialScroll=158]="inertialScroll",s[s.inlayHints=159]="inlayHints",s[s.wrapOnEscapedLineFeeds=160]="wrapOnEscapedLineFeeds",s[s.effectiveCursorStyle=161]="effectiveCursorStyle",s[s.editorClassName=162]="editorClassName",s[s.pixelRatio=163]="pixelRatio",s[s.tabFocusMode=164]="tabFocusMode",s[s.layoutInfo=165]="layoutInfo",s[s.wrappingInfo=166]="wrappingInfo",s[s.defaultColorDecorators=167]="defaultColorDecorators",s[s.colorDecoratorsActivatedOn=168]="colorDecoratorsActivatedOn",s[s.inlineCompletionsAccessibilityVerbose=169]="inlineCompletionsAccessibilityVerbose",s[s.effectiveEditContext=170]="effectiveEditContext",s[s.scrollOnMiddleClick=171]="scrollOnMiddleClick",s[s.effectiveAllowVariableFonts=172]="effectiveAllowVariableFonts"})(_M||(_M={}));var bM;(function(s){s[s.TextDefined=0]="TextDefined",s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(bM||(bM={}));var CM;(function(s){s[s.LF=0]="LF",s[s.CRLF=1]="CRLF"})(CM||(CM={}));var wM;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(wM||(wM={}));var vM;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(vM||(vM={}));var yM;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(yM||(yM={}));var SM;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(SM||(SM={}));var xM;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(xM||(xM={}));var LM;(function(s){s[s.Accepted=0]="Accepted",s[s.Rejected=1]="Rejected",s[s.Ignored=2]="Ignored"})(LM||(LM={}));var kM;(function(s){s[s.Code=1]="Code",s[s.Label=2]="Label"})(kM||(kM={}));var EM;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(EM||(EM={}));var DM;(function(s){s[s.DependsOnKbLayout=-1]="DependsOnKbLayout",s[s.Unknown=0]="Unknown",s[s.Backspace=1]="Backspace",s[s.Tab=2]="Tab",s[s.Enter=3]="Enter",s[s.Shift=4]="Shift",s[s.Ctrl=5]="Ctrl",s[s.Alt=6]="Alt",s[s.PauseBreak=7]="PauseBreak",s[s.CapsLock=8]="CapsLock",s[s.Escape=9]="Escape",s[s.Space=10]="Space",s[s.PageUp=11]="PageUp",s[s.PageDown=12]="PageDown",s[s.End=13]="End",s[s.Home=14]="Home",s[s.LeftArrow=15]="LeftArrow",s[s.UpArrow=16]="UpArrow",s[s.RightArrow=17]="RightArrow",s[s.DownArrow=18]="DownArrow",s[s.Insert=19]="Insert",s[s.Delete=20]="Delete",s[s.Digit0=21]="Digit0",s[s.Digit1=22]="Digit1",s[s.Digit2=23]="Digit2",s[s.Digit3=24]="Digit3",s[s.Digit4=25]="Digit4",s[s.Digit5=26]="Digit5",s[s.Digit6=27]="Digit6",s[s.Digit7=28]="Digit7",s[s.Digit8=29]="Digit8",s[s.Digit9=30]="Digit9",s[s.KeyA=31]="KeyA",s[s.KeyB=32]="KeyB",s[s.KeyC=33]="KeyC",s[s.KeyD=34]="KeyD",s[s.KeyE=35]="KeyE",s[s.KeyF=36]="KeyF",s[s.KeyG=37]="KeyG",s[s.KeyH=38]="KeyH",s[s.KeyI=39]="KeyI",s[s.KeyJ=40]="KeyJ",s[s.KeyK=41]="KeyK",s[s.KeyL=42]="KeyL",s[s.KeyM=43]="KeyM",s[s.KeyN=44]="KeyN",s[s.KeyO=45]="KeyO",s[s.KeyP=46]="KeyP",s[s.KeyQ=47]="KeyQ",s[s.KeyR=48]="KeyR",s[s.KeyS=49]="KeyS",s[s.KeyT=50]="KeyT",s[s.KeyU=51]="KeyU",s[s.KeyV=52]="KeyV",s[s.KeyW=53]="KeyW",s[s.KeyX=54]="KeyX",s[s.KeyY=55]="KeyY",s[s.KeyZ=56]="KeyZ",s[s.Meta=57]="Meta",s[s.ContextMenu=58]="ContextMenu",s[s.F1=59]="F1",s[s.F2=60]="F2",s[s.F3=61]="F3",s[s.F4=62]="F4",s[s.F5=63]="F5",s[s.F6=64]="F6",s[s.F7=65]="F7",s[s.F8=66]="F8",s[s.F9=67]="F9",s[s.F10=68]="F10",s[s.F11=69]="F11",s[s.F12=70]="F12",s[s.F13=71]="F13",s[s.F14=72]="F14",s[s.F15=73]="F15",s[s.F16=74]="F16",s[s.F17=75]="F17",s[s.F18=76]="F18",s[s.F19=77]="F19",s[s.F20=78]="F20",s[s.F21=79]="F21",s[s.F22=80]="F22",s[s.F23=81]="F23",s[s.F24=82]="F24",s[s.NumLock=83]="NumLock",s[s.ScrollLock=84]="ScrollLock",s[s.Semicolon=85]="Semicolon",s[s.Equal=86]="Equal",s[s.Comma=87]="Comma",s[s.Minus=88]="Minus",s[s.Period=89]="Period",s[s.Slash=90]="Slash",s[s.Backquote=91]="Backquote",s[s.BracketLeft=92]="BracketLeft",s[s.Backslash=93]="Backslash",s[s.BracketRight=94]="BracketRight",s[s.Quote=95]="Quote",s[s.OEM_8=96]="OEM_8",s[s.IntlBackslash=97]="IntlBackslash",s[s.Numpad0=98]="Numpad0",s[s.Numpad1=99]="Numpad1",s[s.Numpad2=100]="Numpad2",s[s.Numpad3=101]="Numpad3",s[s.Numpad4=102]="Numpad4",s[s.Numpad5=103]="Numpad5",s[s.Numpad6=104]="Numpad6",s[s.Numpad7=105]="Numpad7",s[s.Numpad8=106]="Numpad8",s[s.Numpad9=107]="Numpad9",s[s.NumpadMultiply=108]="NumpadMultiply",s[s.NumpadAdd=109]="NumpadAdd",s[s.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",s[s.NumpadSubtract=111]="NumpadSubtract",s[s.NumpadDecimal=112]="NumpadDecimal",s[s.NumpadDivide=113]="NumpadDivide",s[s.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",s[s.ABNT_C1=115]="ABNT_C1",s[s.ABNT_C2=116]="ABNT_C2",s[s.AudioVolumeMute=117]="AudioVolumeMute",s[s.AudioVolumeUp=118]="AudioVolumeUp",s[s.AudioVolumeDown=119]="AudioVolumeDown",s[s.BrowserSearch=120]="BrowserSearch",s[s.BrowserHome=121]="BrowserHome",s[s.BrowserBack=122]="BrowserBack",s[s.BrowserForward=123]="BrowserForward",s[s.MediaTrackNext=124]="MediaTrackNext",s[s.MediaTrackPrevious=125]="MediaTrackPrevious",s[s.MediaStop=126]="MediaStop",s[s.MediaPlayPause=127]="MediaPlayPause",s[s.LaunchMediaPlayer=128]="LaunchMediaPlayer",s[s.LaunchMail=129]="LaunchMail",s[s.LaunchApp2=130]="LaunchApp2",s[s.Clear=131]="Clear",s[s.MAX_VALUE=132]="MAX_VALUE"})(DM||(DM={}));var TM;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(TM||(TM={}));var NM;(function(s){s[s.Unnecessary=1]="Unnecessary",s[s.Deprecated=2]="Deprecated"})(NM||(NM={}));var IM;(function(s){s[s.Inline=1]="Inline",s[s.Gutter=2]="Gutter"})(IM||(IM={}));var RM;(function(s){s[s.Normal=1]="Normal",s[s.Underlined=2]="Underlined"})(RM||(RM={}));var AM;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.TEXTAREA=1]="TEXTAREA",s[s.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",s[s.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",s[s.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",s[s.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",s[s.CONTENT_TEXT=6]="CONTENT_TEXT",s[s.CONTENT_EMPTY=7]="CONTENT_EMPTY",s[s.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",s[s.CONTENT_WIDGET=9]="CONTENT_WIDGET",s[s.OVERVIEW_RULER=10]="OVERVIEW_RULER",s[s.SCROLLBAR=11]="SCROLLBAR",s[s.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",s[s.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(AM||(AM={}));var MM;(function(s){s[s.AIGenerated=1]="AIGenerated"})(MM||(MM={}));var OM;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(OM||(OM={}));var PM;(function(s){s[s.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",s[s.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",s[s.TOP_CENTER=2]="TOP_CENTER"})(PM||(PM={}));var FM;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(FM||(FM={}));var BM;(function(s){s[s.Word=0]="Word",s[s.Line=1]="Line",s[s.Suggest=2]="Suggest"})(BM||(BM={}));var VM;(function(s){s[s.Left=0]="Left",s[s.Right=1]="Right",s[s.None=2]="None",s[s.LeftOfInjectedText=3]="LeftOfInjectedText",s[s.RightOfInjectedText=4]="RightOfInjectedText"})(VM||(VM={}));var WM;(function(s){s[s.Off=0]="Off",s[s.On=1]="On",s[s.Relative=2]="Relative",s[s.Interval=3]="Interval",s[s.Custom=4]="Custom"})(WM||(WM={}));var HM;(function(s){s[s.None=0]="None",s[s.Text=1]="Text",s[s.Blocks=2]="Blocks"})(HM||(HM={}));var zM;(function(s){s[s.Smooth=0]="Smooth",s[s.Immediate=1]="Immediate"})(zM||(zM={}));var UM;(function(s){s[s.Auto=1]="Auto",s[s.Hidden=2]="Hidden",s[s.Visible=3]="Visible"})(UM||(UM={}));var jM;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(jM||(jM={}));var $M;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})($M||($M={}));var qM;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(qM||(qM={}));var GM;(function(s){s[s.File=0]="File",s[s.Module=1]="Module",s[s.Namespace=2]="Namespace",s[s.Package=3]="Package",s[s.Class=4]="Class",s[s.Method=5]="Method",s[s.Property=6]="Property",s[s.Field=7]="Field",s[s.Constructor=8]="Constructor",s[s.Enum=9]="Enum",s[s.Interface=10]="Interface",s[s.Function=11]="Function",s[s.Variable=12]="Variable",s[s.Constant=13]="Constant",s[s.String=14]="String",s[s.Number=15]="Number",s[s.Boolean=16]="Boolean",s[s.Array=17]="Array",s[s.Object=18]="Object",s[s.Key=19]="Key",s[s.Null=20]="Null",s[s.EnumMember=21]="EnumMember",s[s.Struct=22]="Struct",s[s.Event=23]="Event",s[s.Operator=24]="Operator",s[s.TypeParameter=25]="TypeParameter"})(GM||(GM={}));var KM;(function(s){s[s.Deprecated=1]="Deprecated"})(KM||(KM={}));var YM;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(YM||(YM={}));var QM;(function(s){s[s.Hidden=0]="Hidden",s[s.Blink=1]="Blink",s[s.Smooth=2]="Smooth",s[s.Phase=3]="Phase",s[s.Expand=4]="Expand",s[s.Solid=5]="Solid"})(QM||(QM={}));var XM;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(XM||(XM={}));var ZM;(function(s){s[s.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",s[s.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",s[s.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",s[s.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(ZM||(ZM={}));var JM;(function(s){s[s.None=0]="None",s[s.Same=1]="Same",s[s.Indent=2]="Indent",s[s.DeepIndent=3]="DeepIndent"})(JM||(JM={}));var Ch;let Eme=(Ch=class{static chord(e,t){return _Q(e,t)}},Ch.CtrlCmd=2048,Ch.Shift=1024,Ch.Alt=512,Ch.WinCtrl=256,Ch);function kQ(){return{editor:void 0,languages:void 0,CancellationTokenSource:sm,Emitter:$,KeyCode:DM,KeyMod:Eme,Position:Y,Range:H,Selection:gt,SelectionDirection:jM,MarkerSeverity:TM,MarkerTag:NM,Uri:nt,Token:fw}}function Dme(s,e){const t=s;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}const Ut=window;function EQ(s){return s}class Tme{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=EQ):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}class MH{get cachedValues(){return this._map}constructor(e,t){this._map=new Map,this._map2=new Map,typeof e=="function"?(this._fn=e,this._computeKey=EQ):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);const i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}}var ff;(function(s){s[s.Uninitialized=0]="Uninitialized",s[s.Running=1]="Running",s[s.Completed=2]="Completed"})(ff||(ff={}));class Ws{constructor(e){this.executor=e,this._state=ff.Uninitialized}get value(){if(this._state===ff.Uninitialized){this._state=ff.Running;try{this._value=this.executor()}catch(e){this._error=e}finally{this._state=ff.Completed}}else if(this._state===ff.Running)throw new Error("Cannot read the value of a lazy that is being initialized");if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function Nme(s){return!s||typeof s!="string"?!0:s.trim().length===0}const Ime=/{(\d+)}/g;function e4(s,...e){return e.length===0?s:s.replace(Ime,function(t,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=e.length?t:e[n]})}function Rme(s){return s.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function ua(s){return s.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Yl(s){return s.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function Z2(s,e){if(!s||!e)return s;const t=e.length;if(t===0||s.length===0)return s;let i=0;for(;s.indexOf(e,i)===i;)i=i+t;return s.substring(i)}function Ame(s,e){if(!s||!e)return s;const t=e.length,i=s.length;if(t===0||i===0)return s;let n=i,r=-1;for(;r=s.lastIndexOf(e,n-1),!(r===-1||r+t!==n);){if(r===0)return"";n=r}return s.substring(0,n)}function Mme(s){return s.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function DQ(s,e,t={}){if(!s)throw new Error("Cannot create regex from empty string");e||(s=Yl(s)),t.wholeWord&&(/\B/.test(s.charAt(0))||(s="\\b"+s),/\B/.test(s.charAt(s.length-1))||(s=s+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(s,i)}function TQ(s){return s.source==="^"||s.source==="^$"||s.source==="$"||s.source==="^\\s*$"?!1:!!(s.exec("")&&s.lastIndex===0)}function F1(s){return s.split(/\r\n|\r|\n/)}function Lr(s){for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Os(s,e=0,t=s.length){for(let i=e;i<t;i++){const n=s.charCodeAt(i);if(n!==32&&n!==9)return s.substring(e,i)}return s.substring(e,t)}function rm(s,e=s.length-1){for(let t=e;t>=0;t--){const i=s.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function t4(s,e){return s<e?-1:s>e?1:0}function b7(s,e,t=0,i=s.length,n=0,r=e.length){for(;t<i&&n<r;t++,n++){const l=s.charCodeAt(t),c=e.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const o=i-t,a=r-n;return o<a?-1:o>a?1:0}function OH(s,e){return B1(s,e,0,s.length,0,e.length)}function B1(s,e,t=0,i=s.length,n=0,r=e.length){for(;t<i&&n<r;t++,n++){let l=s.charCodeAt(t),c=e.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return b7(s.toLowerCase(),e.toLowerCase(),t,i,n,r);Fp(l)&&(l-=32),Fp(c)&&(c-=32);const u=l-c;if(u!==0)return u}const o=i-t,a=r-n;return o<a?-1:o>a?1:0}function MS(s){return s>=48&&s<=57}function Fp(s){return s>=97&&s<=122}function Su(s){return s>=65&&s<=90}function zf(s,e){return s.length===e.length&&B1(s,e)===0}function C7(s,e){const t=e.length;return t<=s.length&&B1(s,e,0,t)===0}function Ome(s,e){const t=s.length,i=t-e.length;return i>=0&&B1(s,e,i,t)===0}function a1(s,e){const t=Math.min(s.length,e.length);let i;for(i=0;i<t;i++)if(s.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function l1(s,e){const t=Math.min(s.length,e.length);let i;const n=s.length-1,r=e.length-1;for(i=0;i<t;i++)if(s.charCodeAt(n-i)!==e.charCodeAt(r-i))return i;return t}function hn(s){return 55296<=s&&s<=56319}function Pg(s){return 56320<=s&&s<=57343}function w7(s,e){return(s-55296<<10)+(e-56320)+65536}function QL(s,e,t){const i=s.charCodeAt(t);if(hn(i)&&t+1<e){const n=s.charCodeAt(t+1);if(Pg(n))return w7(i,n)}return i}function Pme(s,e){const t=s.charCodeAt(e-1);if(Pg(t)&&e>1){const i=s.charCodeAt(e-2);if(hn(i))return w7(i,t)}return t}class v7{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=Pme(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=QL(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class XL{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new v7(e,t)}nextGraphemeLength(){const e=ZL.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const r=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(PH(n,o)){t.setOffset(r);break}n=o}return t.offset-i}prevGraphemeLength(){const e=ZL.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const r=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(PH(o,n)){t.setOffset(r);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function y7(s,e){return new XL(s,e).nextGraphemeLength()}function NQ(s,e){return new XL(s,e).prevGraphemeLength()}function Fme(s,e){e>0&&Pg(s.charCodeAt(e))&&e--;const t=e+y7(s,e);return[t-NQ(s,t),t]}let UI;function Bme(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function gw(s){return UI||(UI=Bme()),UI.test(s)}const Vme=/^[\t\n\r\x20-\x7E]*$/;function S7(s){return Vme.test(s)}const IQ=/[\u2028\u2029]/;function RQ(s){return IQ.test(s)}function Mh(s){return s>=11904&&s<=55215||s>=63744&&s<=64255||s>=65281&&s<=65374}function x7(s){return s>=127462&&s<=127487||s===8986||s===8987||s===9200||s===9203||s>=9728&&s<=10175||s===11088||s===11093||s>=127744&&s<=128591||s>=128640&&s<=128764||s>=128992&&s<=129008||s>=129280&&s<=129535||s>=129648&&s<=129782}const Wme="\uFEFF";function L7(s){return!!(s&&s.length>0&&s.charCodeAt(0)===65279)}function AQ(s){return s=s%52,s<26?String.fromCharCode(97+s):String.fromCharCode(65+s-26)}function PH(s,e){return s===0?e!==5&&e!==7:s===2&&e===3?!1:s===4||s===2||s===3||e===4||e===2||e===3?!0:!(s===8&&(e===8||e===9||e===11||e===12)||(s===11||s===9)&&(e===9||e===10)||(s===12||s===10)&&e===10||e===5||e===13||e===7||s===1||s===13&&e===14||s===6&&e===6)}const If=class If{static getInstance(){return If._INSTANCE||(If._INSTANCE=new If),If._INSTANCE}constructor(){this._data=Hme()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};If._INSTANCE=null;let ZL=If;function Hme(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function zme(s,e){if(s===0)return 0;const t=Ume(s,e);if(t!==void 0)return t;const i=new v7(e,s);return i.prevCodePoint(),i.offset}function Ume(s,e){const t=new v7(e,s);let i=t.prevCodePoint();for(;jme(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!x7(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function jme(s){return 127995<=s&&s<=127999}const yl=class yl{static getInstance(e){return yl.cache.get(Array.from(e))}static getLocales(){return yl._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};yl.ambiguousCharacterData=new Ws(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}')),yl.cache=new Tme({getCacheKey:JSON.stringify},e=>{function t(u){const d=new Map;for(let g=0;g<u.length;g+=2)d.set(u[g],u[g+1]);return d}function i(u,d){const g=new Map(u);for(const[p,_]of d)g.set(p,_);return g}function n(u,d){if(!u)return d;const g=new Map;for(const[p,_]of u)d.has(p)&&g.set(p,_);return g}const r=yl.ambiguousCharacterData.value;let o=e.filter(u=>!u.startsWith("_")&&Object.hasOwn(r,u));o.length===0&&(o=["_default"]);let a;for(const u of o){const d=t(r[u]);a=n(a,d)}const l=t(r._common),c=i(l,a);return new yl(c)}),yl._locales=new Ws(()=>Object.keys(yl.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let mw=yl;const i_=class i_{static getRawData(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static getData(){return this._data||(this._data=new Set([...Object.values(i_.getRawData())].flat())),this._data}static isInvisibleCharacter(e){return i_.getData().has(e)}static get codePoints(){return i_.getData()}};i_._data=void 0;let W0=i_;const OE=class OE{constructor(){this.mapWindowIdToZoomFactor=new Map}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}getWindowId(e){return e.vscodeWindowId}};OE.INSTANCE=new OE;let i4=OE;function MQ(s,e,t){typeof e=="string"&&(e=s.matchMedia(e)),e.addEventListener("change",t)}function n4(s){return i4.INSTANCE.getZoomFactor(s)}const V1=navigator.userAgent,Er=V1.indexOf("Firefox")>=0,J2=V1.indexOf("AppleWebKit")>=0,Tv=V1.indexOf("Chrome")>=0,Fg=!Tv&&V1.indexOf("Safari")>=0,OQ=!Tv&&!Fg&&J2;V1.indexOf("Electron/")>=0;const FH=V1.indexOf("Android")>=0;let jI=!1;if(typeof Ut.matchMedia=="function"){const s=Ut.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Ut.matchMedia("(display-mode: fullscreen)");jI=s.matches,MQ(Ut,s,({matches:t})=>{jI&&e.matches||(jI=t)})}function k7(){return globalThis.MonacoEnvironment}const Nv={clipboard:{writeText:cw||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:cw||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},pointerEvents:Ut.PointerEvent&&("ontouchstart"in Ut||navigator.maxTouchPoints>0)};function s4(s,e){if(typeof s=="number"){if(s===0)return null;const t=(s&65535)>>>0,i=(s&4294901760)>>>16;return i!==0?new $I([OS(t,e),OS(i,e)]):new $I([OS(t,e)])}else{const t=[];for(let i=0;i<s.length;i++)t.push(OS(s[i],e));return new $I(t)}}function OS(s,e){const t=!!(s&2048),i=!!(s&256),n=e===2?i:t,r=!!(s&1024),o=!!(s&512),a=e===2?t:i,l=s&255;return new Bg(n,r,o,a,l)}class Bg{constructor(e,t,i,n,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=r}equals(e){return e instanceof Bg&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class $I{constructor(e){if(e.length===0)throw K2("chords");this.chords=e}}class $me{constructor(e,t,i,n,r,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=r,this.keyAriaLabel=o}}class qme{}function Gme(s){if(s.charCode){const t=String.fromCharCode(s.charCode).toUpperCase();return oh.fromString(t)}const e=s.keyCode;if(e===3)return 7;if(Er)switch(e){case 59:return 85;case 60:if(kr)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(rt)return 57;break}else if(J2){if(rt&&e===93)return 57;if(!rt&&e===92)return 57}return pQ[e]||0}const Kme=rt?256:2048,Yme=512,Qme=1024,Xme=rt?2048:256;class jt{constructor(e){var i;this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=(i=t.getModifierState)==null?void 0:i.call(t,"AltGraph"),this.keyCode=Gme(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=Kme),this.altKey&&(t|=Yme),this.shiftKey&&(t|=Qme),this.metaKey&&(t|=Xme),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Bg(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}const BH=new WeakMap;function Zme(s){if(!s.parent||s.parent===s)return null;try{const e=s.location,t=s.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return s.parent}class Jme{static getSameOriginWindowChain(e){let t=BH.get(e);if(!t){t=[],BH.set(e,t);let i=e,n;do n=Zme(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0;const r=this.getSameOriginWindowChain(e);for(const o of r){const a=o.window.deref();if(i+=(a==null?void 0:a.scrollY)??0,n+=(a==null?void 0:a.scrollX)??0,a===t||!o.iframeElement)break;const l=o.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}}class io{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.defaultPrevented=t.defaultPrevented,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const i=Jme.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class Vg{constructor(e,t=0,i=0){var r;this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(Tv){const o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(e){const o=e,a=e,l=((r=e.view)==null?void 0:r.devicePixelRatio)||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*l):this.deltaY=o.wheelDeltaY/120;else if(typeof a.VERTICAL_AXIS<"u"&&a.axis===a.VERTICAL_AXIS)this.deltaY=-a.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?Er&&!rt?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof o.wheelDeltaX<"u")Fg&&cr?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*l):this.deltaX=o.wheelDeltaX/120;else if(typeof a.HORIZONTAL_AXIS<"u"&&a.axis===a.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?Er&&!rt?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*l):this.deltaY=e.wheelDelta/120)}}preventDefault(){var e;(e=this.browserEvent)==null||e.preventDefault()}stopPropagation(){var e;(e=this.browserEvent)==null||e.stopPropagation()}}const PQ=Symbol("MicrotaskDelay");function r4(s){return!!s&&typeof s.then=="function"}function o4(s){const e=new sm,t=s(e.token);let i=!1;const n=new Promise((r,o)=>{const a=e.token.onCancellationRequested(()=>{i=!0,a.dispose(),o(new O1)});Promise.resolve(t).then(l=>{a.dispose(),e.dispose(),i?Y2(l)&&l.dispose():r(l)},l=>{a.dispose(),e.dispose(),o(l)})});return new class{cancel(){e.cancel(),e.dispose()}then(r,o){return n.then(r,o)}catch(r){return this.then(void 0,r)}finally(r){return n.finally(r)}}}let epe=class{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null,this.cancellationTokenSource=new sm}queue(e){if(this.cancellationTokenSource.token.isCancellationRequested)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.cancellationTokenSource.token.isCancellationRequested)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(this.cancellationTokenSource.token),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.cancellationTokenSource.cancel()}};const tpe=(s,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},s);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},ipe=s=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,s())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class Iv{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,r)=>{this.doResolve=n,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const n=this.task;return this.task=null,n()}}));const i=()=>{var n;this.deferred=null,(n=this.doResolve)==null||n.call(this,null)};return this.deferred=t===PQ?ipe(i):tpe(t,i),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new O1),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class FQ{constructor(e){this.delayer=new Iv(e),this.throttler=new epe}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function c1(s,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{r.dispose(),t()},s),r=e.onCancellationRequested(()=>{clearTimeout(n),r.dispose(),i(new O1)})}):o4(t=>c1(s,t))}function a4(s,e=0,t){const i=setTimeout(()=>{s(),t&&n.dispose()},e),n=Fe(()=>{clearTimeout(i),t==null||t.delete(n)});return t==null||t.add(n),n}let npe=class{constructor(){this._runningTask=void 0,this._pendingTasks=[]}schedule(e){const t=new eD;return this._pendingTasks.push({task:e,deferred:t,setUndefinedWhenCleared:!1}),this._runIfNotRunning(),t.p}_runIfNotRunning(){this._runningTask===void 0&&this._processQueue()}async _processQueue(){if(this._pendingTasks.length===0)return;const e=this._pendingTasks.shift();if(e){if(this._runningTask)throw new Pe;this._runningTask=e.task;try{const t=await e.task();e.deferred.complete(t)}catch(t){e.deferred.error(t)}finally{this._runningTask=void 0,this._processQueue()}}}clearPending(){const e=this._pendingTasks;this._pendingTasks=[];for(const t of e)t.setUndefinedWhenCleared?t.deferred.complete(void 0):t.deferred.error(new O1)}};class Ql{constructor(e,t){this._isDisposed=!1,this._token=void 0,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==void 0&&(clearTimeout(this._token),this._token=void 0)}cancelAndSet(e,t){if(this._isDisposed)throw new Pe("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=void 0,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Pe("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===void 0&&(this._token=setTimeout(()=>{this._token=void 0,e()},t))}}class E7{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new Pe("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=Fe(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class os{constructor(e,t){this.timeoutToken=void 0,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=void 0)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==void 0}onTimeout(){this.timeoutToken=void 0,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let D7,H0;(function(){const s=globalThis;typeof s.requestIdleCallback!="function"||typeof s.cancelIdleCallback!="function"?H0=(e,t,i)=>{Ev(()=>{if(n)return;const r=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let n=!1;return{dispose(){n||(n=!0)}}}:H0=(e,t,i)=>{const n=e.requestIdleCallback(t,typeof i=="number"?{timeout:i}:void 0);let r=!1;return{dispose(){r||(r=!0,e.cancelIdleCallback(n))}}},D7=(e,t)=>H0(globalThis,e,t)})();class spe{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=H0(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class rpe extends spe{constructor(e){super(globalThis,e)}}class eD{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return this.isSettled?Promise.resolve():new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return this.isSettled?Promise.resolve():new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new O1)}}var pw;(function(s){async function e(i){let n;const r=await Promise.all(i.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return r}s.settled=e;function t(i){return new Promise(async(n,r)=>{try{await i(n,r)}catch(o){r(o)}})}s.withAsyncBody=t})(pw||(pw={}));class ope{constructor(){this._unsatisfiedConsumers=[],this._unconsumedValues=[]}get hasFinalValue(){return!!this._finalValue}produce(e){if(this._ensureNoFinalValue(),this._unsatisfiedConsumers.length>0){const t=this._unsatisfiedConsumers.shift();this._resolveOrRejectDeferred(t,e)}else this._unconsumedValues.push(e)}produceFinal(e){this._ensureNoFinalValue(),this._finalValue=e;for(const t of this._unsatisfiedConsumers)this._resolveOrRejectDeferred(t,e);this._unsatisfiedConsumers.length=0}_ensureNoFinalValue(){if(this._finalValue)throw new Pe("ProducerConsumer: cannot produce after final value has been set")}_resolveOrRejectDeferred(e,t){t.ok?e.complete(t.value):e.error(t.error)}consume(){if(this._unconsumedValues.length>0||this._finalValue){const e=this._unconsumedValues.length>0?this._unconsumedValues.shift():this._finalValue;return e.ok?Promise.resolve(e.value):Promise.reject(e.error)}else{const e=new eD;return this._unsatisfiedConsumers.push(e),e.p}}}const zr=class zr{constructor(e,t){this._onReturn=t,this._producerConsumer=new ope,this._iterator={next:()=>this._producerConsumer.consume(),return:()=>{var i;return(i=this._onReturn)==null||i.call(this),Promise.resolve({done:!0,value:void 0})},throw:async i=>(this._finishError(i),{done:!0,value:void 0})},queueMicrotask(async()=>{const i=e({emitOne:n=>this._producerConsumer.produce({ok:!0,value:{done:!1,value:n}}),emitMany:n=>{for(const r of n)this._producerConsumer.produce({ok:!0,value:{done:!1,value:r}})},reject:n=>this._finishError(n)});if(!this._producerConsumer.hasFinalValue)try{await i,this._finishOk()}catch(n){this._finishError(n)}})}static fromArray(e){return new zr(t=>{t.emitMany(e)})}static fromPromise(e){return new zr(async t=>{t.emitMany(await e)})}static fromPromisesResolveOrder(e){return new zr(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new zr(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}static map(e,t){return new zr(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return zr.map(this,e)}static coalesce(e){return zr.filter(e,t=>!!t)}coalesce(){return zr.coalesce(this)}static filter(e,t){return new zr(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return zr.filter(this,e)}_finishOk(){this._producerConsumer.hasFinalValue||this._producerConsumer.produceFinal({ok:!0,value:{done:!0,value:void 0}})}_finishError(e){this._producerConsumer.hasFinalValue||this._producerConsumer.produceFinal({ok:!1,error:e})}[Symbol.asyncIterator](){return this._iterator}};zr.EMPTY=zr.fromArray([]);let VH=zr;var je;(function(s){s.inMemory="inmemory",s.vscode="vscode",s.internal="private",s.walkThrough="walkThrough",s.walkThroughSnippet="walkThroughSnippet",s.http="http",s.https="https",s.file="file",s.mailto="mailto",s.untitled="untitled",s.data="data",s.command="command",s.vscodeRemote="vscode-remote",s.vscodeRemoteResource="vscode-remote-resource",s.vscodeManagedRemoteResource="vscode-managed-remote-resource",s.vscodeUserData="vscode-userdata",s.vscodeCustomEditor="vscode-custom-editor",s.vscodeNotebookCell="vscode-notebook-cell",s.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",s.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",s.vscodeNotebookCellOutput="vscode-notebook-cell-output",s.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",s.vscodeNotebookMetadata="vscode-notebook-metadata",s.vscodeInteractiveInput="vscode-interactive-input",s.vscodeSettings="vscode-settings",s.vscodeWorkspaceTrust="vscode-workspace-trust",s.vscodeTerminal="vscode-terminal",s.vscodeChatCodeBlock="vscode-chat-code-block",s.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",s.vscodeChatEditor="vscode-chat-editor",s.vscodeChatInput="chatSessionInput",s.vscodeLocalChatSession="vscode-chat-session",s.webviewPanel="webview-panel",s.vscodeWebview="vscode-webview",s.extension="extension",s.vscodeFileResource="vscode-file",s.tmp="tmp",s.vsls="vsls",s.vscodeSourceControl="vscode-scm",s.commentsInput="comment",s.codeSetting="code-setting",s.outputChannel="output",s.accessibleView="accessible-view",s.chatEditingSnapshotScheme="chat-editing-snapshot-text-model",s.chatEditingModel="chat-editing-text-model",s.copilotPr="copilot-pr"})(je||(je={}));function T7(s,e){return nt.isUri(s)?zf(s.scheme,e):C7(s,e+":")}function WH(s,...e){return e.some(t=>T7(s,t))}const ape="tkn";class lpe{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}get _remoteResourcesPath(){return Gi.join(this._serverRootPath,je.vscodeRemoteResource)}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return It(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],r=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(o+=`&${ape}=${encodeURIComponent(r)}`),nt.from({scheme:Fh?this._preferredWebSchema:je.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:o})}}const BQ=new lpe,cpe="vscode-app",xC=class xC{uriToBrowserUri(e){return e.scheme===je.vscodeRemote?BQ.rewrite(e):e.scheme===je.file&&(cw||Wfe===`${je.vscodeFileResource}://${xC.FALLBACK_AUTHORITY}`)?e.with({scheme:je.vscodeFileResource,authority:e.authority||xC.FALLBACK_AUTHORITY,query:null,fragment:null}):e}};xC.FALLBACK_AUTHORITY=cpe;let l4=xC;const VQ=new l4;var c4;(function(s){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(r){let o;typeof r=="string"?o=new URL(r).searchParams:r instanceof URL?o=r.searchParams:nt.isUri(r)&&(o=new URL(r.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}s.getHeadersFromQuery=i;function n(r,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";r instanceof URLSearchParams?r.set(t,l):r[t]=l}s.addSearchParam=n})(c4||(c4={}));const HH=typeof Buffer<"u";new Ws(()=>new Uint8Array(256));let qI;class tD{static wrap(e){return HH&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new tD(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return HH?this.buffer.toString():(qI||(qI=new TextDecoder),qI.decode(this.buffer))}}function hpe(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0}function upe(s,e,t){s[t+0]=e&255,e=e>>>8,s[t+1]=e&255}function Ia(s,e){return s[e]*2**24+s[e+1]*2**16+s[e+2]*2**8+s[e+3]}function Ra(s,e,t){s[t+3]=e,e=e>>>8,s[t+2]=e,e=e>>>8,s[t+1]=e,e=e>>>8,s[t]=e}function zH(s,e){return s[e]}function UH(s,e,t){s[t]=e}const jH="0123456789abcdef";function dpe({buffer:s}){let e="";for(let t=0;t<s.length;t++){const i=s[t];e+=jH[i>>>4],e+=jH[i&15]}return e}function N7(s){return iD(s,0)}function iD(s,e){switch(typeof s){case"object":return s===null?gh(349,e):Array.isArray(s)?gpe(s,e):mpe(s,e);case"string":return I7(s,e);case"boolean":return fpe(s,e);case"number":return gh(s,e);case"undefined":return gh(937,e);default:return gh(617,e)}}function gh(s,e){return(e<<5)-e+s|0}function fpe(s,e){return gh(s?433:863,e)}function I7(s,e){e=gh(149417,e);for(let t=0,i=s.length;t<i;t++)e=gh(s.charCodeAt(t),e);return e}function gpe(s,e){return e=gh(104579,e),s.reduce((t,i)=>iD(i,t),e)}function mpe(s,e){return e=gh(181387,e),Object.keys(s).sort().reduce((t,i)=>(t=I7(i,t),iD(s[i],t)),e)}function GI(s,e,t=32){const i=t-e,n=~((1<<i)-1);return(s<<e|(n&s)>>>i)>>>0}function Yb(s,e=32){return s instanceof ArrayBuffer?dpe(tD.wrap(new Uint8Array(s))):(s>>>0).toString(16).padStart(e/4,"0")}const PE=class PE{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,r=this._leftoverHighSurrogate,o,a;for(r!==0?(o=r,a=-1,r=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(hn(o))if(a+1<t){const c=e.charCodeAt(a+1);Pg(c)?(a++,l=w7(o,c)):l=65533}else{r=o;break}else Pg(o)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=r}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Yb(this._h0)+Yb(this._h1)+Yb(this._h2)+Yb(this._h3)+Yb(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,this._buff.subarray(this._buffLen).fill(0),this._buffLen>56&&(this._step(),this._buff.fill(0));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=PE._bigBlock32,t=this._buffDV;for(let d=0;d<64;d+=4)e.setUint32(d,t.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)e.setUint32(d,GI(e.getUint32(d-12,!1)^e.getUint32(d-32,!1)^e.getUint32(d-56,!1)^e.getUint32(d-64,!1),1),!1);let i=this._h0,n=this._h1,r=this._h2,o=this._h3,a=this._h4,l,c,u;for(let d=0;d<80;d++)d<20?(l=n&r|~n&o,c=1518500249):d<40?(l=n^r^o,c=1859775393):d<60?(l=n&r|n&o|r&o,c=2400959708):(l=n^r^o,c=3395469782),u=GI(i,5)+l+a+c+e.getUint32(d*4,!1)&4294967295,a=o,o=r,r=GI(n,30),n=i,i=u;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}};PE._bigBlock32=new DataView(new ArrayBuffer(320));let h4=PE,af;function ppe(s){af?af instanceof $H?af.loggers.push(s):af=new $H([af,s]):af=s}function rs(){return af}class $H{constructor(e){this.loggers=e}handleObservableCreated(e,t){for(const i of this.loggers)i.handleObservableCreated(e,t)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e,t){for(const i of this.loggers)i.handleAutorunCreated(e,t)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const n of this.loggers)n.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const n of this.loggers)n.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}}var hs;(function(s){let e=!1;function t(){e=!0}s.enable=t;function i(){if(!e)return;const n=Error,r=n.stackTraceLimit;n.stackTraceLimit=3;const o=new Error().stack;return n.stackTraceLimit=r,R7.fromStack(o,2)}s.ofCaller=i})(hs||(hs={}));class R7{static fromStack(e,t){const i=e.split(`
`),n=_pe(i[t+1]);if(n)return new R7(n.fileName,n.line,n.column,n.id)}constructor(e,t,i,n){this.fileName=e,this.line=t,this.column=i,this.id=n}}function _pe(s){const e=s.match(/\((.*):(\d+):(\d+)\)/);if(e)return{fileName:e[1],line:parseInt(e[2]),column:parseInt(e[3]),id:s};const t=s.match(/at ([^\(\)]*):(\d+):(\d+)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:s}}const Ka=(s,e)=>s===e;function u4(s=Ka){return(e,t)=>sn(e,t,s)}function bpe(){return(s,e)=>s.equals(e)}function C0(s,e,t){{const i=s;return(n,r)=>n==null||r===void 0||r===null?r===n:i(n,r)}}class Us{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return Cpe(e,this)}}const qH=new Map,d4=new WeakMap;function Cpe(s,e){const t=d4.get(s);if(t)return t;const i=wpe(s,e);if(i){let n=qH.get(i)??0;n++,qH.set(i,n);const r=n===1?i:`${i}#${n}`;return d4.set(s,r),r}}function wpe(s,e){const t=d4.get(s);if(t)return t;const i=e.owner?ype(e.owner)+".":"";let n;const r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(n=r(),n!==void 0)return i+n}else return i+r;const o=e.referenceFn;if(o!==void 0&&(n=A7(o),n!==void 0))return i+n;if(e.owner!==void 0){const a=vpe(e.owner,s);if(a!==void 0)return i+a}}function vpe(s,e){for(const t in s)if(s[t]===e)return t}const GH=new Map,KH=new WeakMap;function ype(s){const e=KH.get(s);if(e)return e;const t=WQ(s)??"Object";let i=GH.get(t)??0;i++,GH.set(t,i);const n=i===1?t:`${t}#${i}`;return KH.set(s,n),n}function WQ(s){const e=s.constructor;if(e)return e.name==="Object"?void 0:e.name}function A7(s){const e=s.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),n=i?i[1]:void 0;return n==null?void 0:n.trim()}let f4;function Spe(s){f4=s}let HQ;function xpe(s){HQ=s}class zQ{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t,i=hs.ofCaller()){const n=t===void 0?void 0:e,r=t===void 0?e:t;return f4({owner:n,debugName:()=>{const o=A7(r);if(o!==void 0)return o;const l=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(l)return`${this.debugName}.${l[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:r},o=>r(this.read(o),o),i)}flatten(){return f4({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(HQ(this,t)),this}}class W1 extends zQ{constructor(e){var t;super(),this._observers=new Set,(t=rs())==null||t.handleObservableCreated(this,e)}addObserver(e){var i;const t=this._observers.size;this._observers.add(e),t===0&&this.onFirstObserverAdded(),t!==this._observers.size&&((i=rs())==null||i.handleOnListenerCountChanged(this,this._observers.size))}removeObserver(e){var i;const t=this._observers.delete(e);t&&this._observers.size===0&&this.onLastObserverRemoved(),t&&((i=rs())==null||i.handleOnListenerCountChanged(this,this._observers.size))}onFirstObserverAdded(){}onLastObserverRemoved(){}debugGetObservers(){return this._observers}}function Lpe(s){switch(s){case 0:return"initial";case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}class na extends W1{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n=void 0,r,o){var a;super(o),this._debugNameData=e,this._computeFn=t,this._changeTracker=i,this._handleLastObserverRemoved=n,this._equalityComparator=r,this._state=0,this._value=void 0,this._updateCount=0,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._didReportChange=!1,this._isInBeforeUpdate=!1,this._isReaderValid=!1,this._store=void 0,this._delayedStore=void 0,this._removedObserverToCallEndUpdateOn=null,this._changeSummary=(a=this._changeTracker)==null?void 0:a.createChangeSummary(void 0)}onLastObserverRemoved(){var e,t;this._state=0,this._value=void 0,(e=rs())==null||e.handleDerivedCleared(this);for(const i of this._dependencies)i.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._delayedStore!==void 0&&(this._delayedStore.dispose(),this._delayedStore=void 0),(t=this._handleLastObserverRemoved)==null||t.call(this)}get(){var t,i;if(this._isComputing,this._observers.size===0){let n;try{this._isReaderValid=!0;let r;this._changeTracker&&(r=this._changeTracker.createChangeSummary(void 0),(i=(t=this._changeTracker).beforeUpdate)==null||i.call(t,this,r)),n=this._computeFn(this,r)}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),n}else{do{if(this._state===1){for(const n of this._dependencies)if(n.reportChanges(),this._state===2)break}this._state===1&&(this._state=3),this._state!==3&&this._recompute()}while(this._state!==3);return this._value}}_recompute(){var i,n,r,o;let e=!1;this._isComputing=!0,this._didReportChange=!1;const t=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=t;try{const a=this._changeSummary;this._isReaderValid=!0,this._changeTracker&&(this._isInBeforeUpdate=!0,(n=(i=this._changeTracker).beforeUpdate)==null||n.call(i,this,a),this._isInBeforeUpdate=!1,this._changeSummary=(r=this._changeTracker)==null?void 0:r.createChangeSummary(a));const l=this._state!==0,c=this._value;this._state=3;const u=this._delayedStore;u!==void 0&&(this._delayedStore=void 0);try{this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._value=this._computeFn(this,a)}finally{this._isReaderValid=!1;for(const d of this._dependenciesToBeRemoved)d.removeObserver(this);this._dependenciesToBeRemoved.clear(),u!==void 0&&u.dispose()}e=this._didReportChange||l&&!this._equalityComparator(c,this._value),(o=rs())==null||o.handleObservableUpdated(this,{oldValue:c,newValue:this._value,change:void 0,didChange:e,hadValue:l})}catch(a){VL(a)}if(this._isComputing=!1,!this._didReportChange&&e)for(const a of this._observers)a.handleChange(this,void 0);else this._didReportChange=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new Pe("Cyclic deriveds are not supported yet!");this._updateCount++,this._isUpdating=!0;try{const t=this._updateCount===1;if(this._state===3&&(this._state=1,!t))for(const i of this._observers)i.handlePossibleChange(this);if(t)for(const i of this._observers)i.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this._updateCount--,this._updateCount===0){const t=[...this._observers];for(const i of t)i.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){const i=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const n of i)n.endUpdate(this)}}Mg(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===3&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=1;for(const t of this._observers)t.handlePossibleChange(this)}}handleChange(e,t){var i;if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)||this._isInBeforeUpdate){(i=rs())==null||i.handleDerivedDependencyChanged(this,e,t);let n=!1;try{n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:o=>o===e},this._changeSummary):!0}catch(o){VL(o)}const r=this._state===3;if(n&&(this._state===1||r)&&(this._state=2,r))for(const o of this._observers)o.handlePossibleChange(this)}}_ensureReaderValid(){if(!this._isReaderValid)throw new Pe("The reader object cannot be used outside its compute function!")}readObservable(e){this._ensureReaderValid(),e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){return this._ensureReaderValid(),this._store===void 0&&(this._store=new Ee),this._store}addObserver(e){const t=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e),t&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)?this._removedObserverToCallEndUpdateOn.delete(e):e.beginUpdate(this))}removeObserver(e){this._observers.has(e)&&this._updateCount>0&&(this._removedObserverToCallEndUpdateOn||(this._removedObserverToCallEndUpdateOn=new Set),this._removedObserverToCallEndUpdateOn.add(e)),super.removeObserver(e)}debugGetState(){return{state:this._state,stateStr:Lpe(this._state),updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}debugRecompute(){this._isComputing?this._state=2:this._recompute()}setValue(e,t,i){this._value=e;const n=this._observers;t.updateObserver(this,this);for(const r of n)r.handleChange(this,i)}}class kpe extends na{constructor(e,t,i,n=void 0,r,o,a){super(e,t,i,n,r,a),this.set=o}}function Ie(s,e,t=hs.ofCaller()){return e!==void 0?new na(new Us(s,void 0,e),e,void 0,void 0,Ka,t):new na(new Us(void 0,void 0,s),s,void 0,void 0,Ka,t)}function M7(s,e,t,i=hs.ofCaller()){return new kpe(new Us(s,void 0,e),e,void 0,void 0,Ka,t,i)}function Vl(s,e,t=hs.ofCaller()){return new na(new Us(s.owner,s.debugName,s.debugReferenceFn),e,void 0,s.onLastObserverRemoved,s.equalsFn??Ka,t)}Spe(Vl);function Cl(s,e,t=hs.ofCaller()){let i,n;e===void 0?(i=s,n=void 0):(n=s,i=e);let r;return new na(new Us(n,void 0,i),o=>{r?r.clear():r=new Ee;const a=i(o);return a&&r.add(a),a},void 0,()=>{r&&(r.dispose(),r=void 0)},Ka,t)}function Epe(s){switch(s){case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}class _w{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n){var r,o;this._debugNameData=e,this._runFn=t,this._changeTracker=i,this._state=2,this._updateCount=0,this._disposed=!1,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._isRunning=!1,this._store=void 0,this._delayedStore=void 0,this._changeSummary=(r=this._changeTracker)==null?void 0:r.createChangeSummary(void 0),(o=rs())==null||o.handleAutorunCreated(this,n),this._run()}dispose(){var e;if(!this._disposed){this._disposed=!0;for(const t of this._dependencies)t.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&this._store.dispose(),this._delayedStore!==void 0&&this._delayedStore.dispose(),(e=rs())==null||e.handleAutorunDisposed(this)}}_run(){var t,i,n,r;const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e,this._state=3;try{if(!this._disposed){(t=rs())==null||t.handleAutorunStarted(this);const o=this._changeSummary,a=this._delayedStore;a!==void 0&&(this._delayedStore=void 0);try{this._isRunning=!0,this._changeTracker&&((n=(i=this._changeTracker).beforeUpdate)==null||n.call(i,this,o),this._changeSummary=this._changeTracker.createChangeSummary(o)),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._runFn(this,o)}catch(l){VL(l)}finally{this._isRunning=!1,a!==void 0&&a.dispose()}}}finally{this._disposed||(r=rs())==null||r.handleAutorunFinished(this);for(const o of this._dependenciesToBeRemoved)o.removeObserver(this);this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this._state===3&&(this._state=1),this._updateCount++}endUpdate(e){try{if(this._updateCount===1)do{if(this._state===1){this._state=3;for(const t of this._dependencies)if(t.reportChanges(),this._state===2)break}this._state!==3&&this._run()}while(this._state!==3)}finally{this._updateCount--}Mg(()=>this._updateCount>=0)}handlePossibleChange(e){this._state===3&&this._isDependency(e)&&(this._state=1)}handleChange(e,t){var i;if(this._isDependency(e)){(i=rs())==null||i.handleAutorunDependencyChanged(this,e,t);try{(this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this._changeSummary):!0)&&(this._state=2)}catch(n){VL(n)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}_ensureNoRunning(){if(!this._isRunning)throw new Pe("The reader object cannot be used outside its compute function!")}readObservable(e){if(this._ensureNoRunning(),this._disposed)return e.get();e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){if(this._ensureNoRunning(),this._disposed)throw new Pe("Cannot access store after dispose");return this._store===void 0&&(this._store=new Ee),this._store}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state,stateStr:Epe(this._state)}}debugRerun(){this._isRunning?this._state=2:this._run()}}function ct(s,e=hs.ofCaller()){return new _w(new Us(void 0,void 0,s),s,void 0,e)}function O7(s,e,t=hs.ofCaller()){return new _w(new Us(s.owner,s.debugName,s.debugReferenceFn??e),e,void 0,t)}function H1(s,e,t=hs.ofCaller()){return new _w(new Us(s.owner,s.debugName,s.debugReferenceFn??e),e,s.changeTracker,t)}function Dpe(s,e){const t=new Ee,i=H1({owner:s.owner,debugName:s.debugName,debugReferenceFn:s.debugReferenceFn??e,changeTracker:s.changeTracker},(n,r)=>{t.clear(),e(n,r,t)});return Fe(()=>{i.dispose(),t.dispose()})}function $a(s){const e=new Ee,t=O7({owner:void 0,debugName:void 0,debugReferenceFn:s},i=>{e.clear(),s(i,e)});return Fe(()=>{t.dispose(),e.dispose()})}function YH(s){const e=new Error("BugIndicatingErrorRecovery: "+s);It(e),console.error("recovered from an error that indicates a bug",e)}function Vi(s,e){const t=new Rv(s,e);try{s(t)}finally{t.finish()}}let PS;function w0(s){if(PS)s(PS);else{const e=new Rv(s,void 0);PS=e;try{s(e)}finally{e.finish(),PS=void 0}}}function P7(s,e,t){s?e(s):Vi(e,t)}class Rv{constructor(e,t){var i;this._fn=e,this._getDebugName=t,this._updatingObservers=[],(i=rs())==null||i.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():A7(this._fn)}updateObserver(e,t){if(!this._updatingObservers){YH("Transaction already finished!"),Vi(i=>{i.updateObserver(e,t)});return}this._updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){var t;const e=this._updatingObservers;if(!e){YH("transaction.finish() has already been called!");return}for(let i=0;i<e.length;i++){const{observer:n,observable:r}=e[i];n.endUpdate(r)}this._updatingObservers=null,(t=rs())==null||t.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}}function mi(...s){let e,t,i,n;return s.length===2?[t,i]=s:[e,t,i,n]=s,new Uf(new Us(e,void 0,i),t,i,()=>Uf.globalTransaction,Ka,n??hs.ofCaller())}class Uf extends W1{constructor(e,t,i,n,r,o){super(o),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=n,this._equalityComparator=r,this._hasValue=!1,this.handleEvent=a=>{var g;const l=this._getValue(a),c=this._value,u=!this._hasValue||!this._equalityComparator(c,l);let d=!1;u&&(this._value=l,this._hasValue&&(d=!0,P7(this._getTransaction(),p=>{var _;(_=rs())==null||_.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:u,hadValue:this._hasValue});for(const C of this._observers)p.updateObserver(C,this),C.handleChange(this,void 0)},()=>{const p=this.getDebugName();return"Event fired"+(p?`: ${p}`:"")})),this._hasValue=!0),d||(g=rs())==null||g.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:u,hadValue:this._hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose(),this._subscription=void 0,this._hasValue=!1,this._value=void 0}get(){return this._subscription?(this._hasValue||this.handleEvent(void 0),this._value):this._getValue(void 0)}debugSetValue(e){this._value=e}debugGetState(){return{value:this._value,hasValue:this._hasValue}}}(function(s){s.Observer=Uf;function e(t,i){let n=!1;Uf.globalTransaction===void 0&&(Uf.globalTransaction=t,n=!0);try{i()}finally{n&&(Uf.globalTransaction=void 0)}}s.batchEventsGlobally=e})(mi||(mi={}));function nD(s,e){const t=new Tpe(!0,e);s.addObserver(t);try{t.beginUpdate(s)}finally{t.endUpdate(s)}return Fe(()=>{s.removeObserver(t)})}xpe(nD);class Tpe{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter===1&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges()),this._counter--}handlePossibleChange(e){}handleChange(e,t){}}function Npe(s,e){let t;return Vl({owner:s,debugReferenceFn:e},n=>(t=e(n,t),t))}function Bp(s,e){switch(typeof s){case"number":return""+s;case"string":return s.length+2<=e?`"${s}"`:`"${s.substr(0,e-7)}"+...`;case"boolean":return s?"true":"false";case"undefined":return"undefined";case"object":return s===null?"null":Array.isArray(s)?Ipe(s,e):Rpe(s,e);case"symbol":return s.toString();case"function":return`[[Function${s.name?" "+s.name:""}]]`;default:return""+s}}function Ipe(s,e){let t="[ ",i=!0;for(const n of s){if(i||(t+=", "),t.length-5>e){t+="...";break}i=!1,t+=`${Bp(n,e-t.length)}`}return t+=" ]",t}function Rpe(s,e){if(typeof s.toString=="function"&&s.toString!==Object.prototype.toString){const r=s.toString();return r.length<=e?r:r.substring(0,e-3)+"..."}const t=WQ(s);let i=t?t+"(":"{ ",n=!0;for(const[r,o]of Object.entries(s)){if(n||(i+=", "),i.length-5>e){i+="...";break}n=!1,i+=`${r}: ${Bp(o,e-i.length)}`}return i+=t?")":" }",i}class F7{static createClient(e,t){return new F7(e,t)}constructor(e,t){this._channelFactory=e,this._getHandler=t,this._channel=this._channelFactory({handleNotification:r=>{const o=r,a=this._getHandler().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:r=>{const o=r;try{return{type:"result",value:this._getHandler().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const i=new Proxy({},{get:(r,o)=>async(...a)=>{const l=await this._channel.sendRequest([o,a]);if(l.type==="error")throw l.value;return l.value}}),n=new Proxy({},{get:(r,o)=>(...a)=>{this._channel.sendNotification([o,a])}});this.api={notifications:n,requests:i}}}function Ape(s,e){const t=globalThis;let i=[],n;const{channel:r,handler:o}=Mpe({sendNotification:l=>{n?n.sendNotification(l):i.push(l)}});let a;return(t.$$debugValueEditor_debugChannels??(t.$$debugValueEditor_debugChannels={}))[s]=l=>{a=e(),n=l;for(const c of i)l.sendNotification(c);return i=[],o},F7.createClient(r,()=>{if(!a)throw new Error("Not supported");return a})}function Mpe(s){let e;return{channel:i=>(e=i,{sendNotification:n=>{s.sendNotification(n)},sendRequest:n=>{throw new Error("not supported")}}),handler:{handleRequest:i=>i.type==="notification"?e==null?void 0:e.handleNotification(i.data):e==null?void 0:e.handleRequest(i.data)}}}class Ope{constructor(){this._timeout=void 0}throttle(e,t){this._timeout===void 0&&(this._timeout=setTimeout(()=>{this._timeout=void 0,e()},t))}dispose(){this._timeout!==void 0&&clearTimeout(this._timeout)}}function UQ(s,e){for(const t in e)s[t]&&typeof s[t]=="object"&&e[t]&&typeof e[t]=="object"?UQ(s[t],e[t]):s[t]=e[t]}function jQ(s,e){for(const t in e)e[t]===null?delete s[t]:s[t]&&typeof s[t]=="object"&&e[t]&&typeof e[t]=="object"?jQ(s[t],e[t]):s[t]=e[t]}function Qe(s,e,t=hs.ofCaller()){let i;return typeof s=="string"?i=new Us(void 0,s,void 0):i=new Us(s,void 0,void 0),new bw(i,e,Ka,t)}class bw extends W1{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i,n){var r;super(n),this._debugNameData=e,this._equalityComparator=i,this._value=t,(r=rs())==null||r.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this._value}set(e,t,i){var r;if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new Rv(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),(r=rs())==null||r.handleObservableUpdated(this,{oldValue:o,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this._observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}}function $Q(s,e,t=hs.ofCaller()){let i;return typeof s=="string"?i=new Us(void 0,s,void 0):i=new Us(s,void 0,void 0),new Ppe(i,e,Ka,t)}class Ppe extends bw{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){var e;(e=this._value)==null||e.dispose()}}const Rf=class Rf{static getInstance(){return Rf._instance===void 0&&(Rf._instance=new Rf),Rf._instance}getTransactionState(){const e=[],t=[...this._activeTransactions];if(t.length===0)return;const i=t.flatMap(r=>r.debugGetUpdatingObservers()??[]).map(r=>r.observer),n=new Set;for(;i.length>0;){const r=i.shift();if(n.has(r))continue;n.add(r);const o=this._getInfo(r,a=>{n.has(a)||i.push(a)});o&&e.push(o)}return{names:t.map(r=>r.getDebugName()??"tx"),affected:e}}_getObservableInfo(e){const t=this._instanceInfos.get(e);if(!t){It(new Pe("No info found"));return}return t}_getAutorunInfo(e){const t=this._instanceInfos.get(e);if(!t){It(new Pe("No info found"));return}return t}_getInfo(e,t){if(e instanceof na){const i=[...e.debugGetObservers()];for(const l of i)t(l);const n=this._getObservableInfo(e);if(!n)return;const r=e.debugGetState(),o={name:e.debugName,instanceId:n.instanceId,updateCount:r.updateCount},a=[...n.changedObservables].map(l=>{var c;return(c=this._instanceInfos.get(l))==null?void 0:c.instanceId}).filter(Io);if(r.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(r.state){case 0:return{...o,type:"observable/derived",state:"noValue"};case 3:return{...o,type:"observable/derived",state:"upToDate"};case 2:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(e instanceof _w){const i=this._getAutorunInfo(e);if(!i)return;const n={name:e.debugName,instanceId:i.instanceId,updateCount:i.updateCount},r=[...i.changedObservables].map(o=>this._instanceInfos.get(o).instanceId);if(e.debugGetState().isRunning)return{...n,type:"autorun",state:"updating",changedDependencies:r};switch(e.debugGetState().state){case 3:return{...n,type:"autorun",state:"upToDate"};case 2:return{...n,type:"autorun",state:"stale",changedDependencies:r};case 1:return{...n,type:"autorun",state:"possiblyStale"}}}}_formatObservable(e){const t=this._getObservableInfo(e);if(t)return{name:e.debugName,instanceId:t.instanceId}}_formatObserver(e){var i;if(e instanceof na)return{name:e.toString(),instanceId:(i=this._getObservableInfo(e))==null?void 0:i.instanceId};const t=this._getAutorunInfo(e);if(t)return{name:e.toString(),instanceId:t.instanceId}}constructor(){this._declarationId=0,this._instanceId=0,this._declarations=new Map,this._instanceInfos=new WeakMap,this._aliveInstances=new Map,this._activeTransactions=new Set,this._channel=Ape("observableDevTools",()=>({notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log("logObservableValue",e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null,this._channel.api.notifications.handleChange(this._fullState,!0)}},requests:{getDeclarations:()=>{const e={};for(const t of this._declarations.values())e[t.id]=t;return{decls:e}},getSummarizedInstances:()=>null,getObservableValueInfo:e=>({observers:[...this._aliveInstances.get(e).debugGetObservers()].map(i=>this._formatObserver(i)).filter(Io)}),getDerivedInfo:e=>{const t=this._aliveInstances.get(e);return{dependencies:[...t.debugGetState().dependencies].map(i=>this._formatObservable(i)).filter(Io),observers:[...t.debugGetObservers()].map(i=>this._formatObserver(i)).filter(Io)}},getAutorunInfo:e=>({dependencies:[...this._aliveInstances.get(e).debugGetState().dependencies].map(i=>this._formatObservable(i)).filter(Io)}),getTransactionState:()=>this.getTransactionState(),setValue:(e,t)=>{const i=this._aliveInstances.get(e);if(i instanceof na)i.debugSetValue(t);else if(i instanceof bw)i.debugSetValue(t);else if(i instanceof Uf)i.debugSetValue(t);else throw new Pe("Observable is not supported");const n=[...i.debugGetObservers()];for(const r of n)r.beginUpdate(i);for(const r of n)r.handleChange(i,void 0);for(const r of n)r.endUpdate(i)},getValue:e=>{const t=this._aliveInstances.get(e);if(t instanceof na)return Bp(t.debugGetState().value,200);if(t instanceof bw)return Bp(t.debugGetState().value,200)},logValue:e=>{const t=this._aliveInstances.get(e);if(t&&"get"in t)console.log("Logged Value:",t.get());else throw new Pe("Observable is not supported")},rerun:e=>{const t=this._aliveInstances.get(e);if(t instanceof na)t.debugRecompute();else if(t instanceof _w)t.debugRerun();else throw new Pe("Observable is not supported")}}})),this._pendingChanges=null,this._changeThrottler=new Ope,this._fullState={},this._flushUpdates=()=>{this._pendingChanges!==null&&(this._channel.api.notifications.handleChange(this._pendingChanges,!1),this._pendingChanges=null)},hs.enable()}_handleChange(e){jQ(this._fullState,e),this._pendingChanges===null?this._pendingChanges=e:UQ(this._pendingChanges,e),this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e,t){if(!t)return-1;let i=this._declarations.get(t.id);return i===void 0&&(i={id:this._declarationId++,type:e,url:t.fileName,line:t.line,column:t.column},this._declarations.set(t.id,i),this._handleChange({decls:{[i.id]:i}})),i.id}handleObservableCreated(e,t){const n={declarationId:this._getDeclarationId("observable/value",t),instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n)}handleOnListenerCountChanged(e,t){const i=this._getObservableInfo(e);if(i){if(i.listenerCount===0&&t>0){const n=e instanceof na?"observable/derived":"observable/value";this._aliveInstances.set(i.instanceId,e),this._handleChange({instances:{[i.instanceId]:{instanceId:i.instanceId,declarationId:i.declarationId,formattedValue:i.lastValue,type:n,name:e.debugName}}})}else i.listenerCount>0&&t===0&&(this._handleChange({instances:{[i.instanceId]:null}}),this._aliveInstances.delete(i.instanceId));i.listenerCount=t}}handleObservableUpdated(e,t){if(e instanceof na){this._handleDerivedRecomputed(e,t);return}const i=this._getObservableInfo(e);i&&t.didChange&&(i.lastValue=Bp(t.newValue,30),i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:i.lastValue}}}))}handleAutorunCreated(e,t){const n={declarationId:this._getDeclarationId("autorun",t),instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n),this._aliveInstances.set(n.instanceId,e),n&&this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,runCount:0,type:"autorun",name:e.debugName}}})}handleAutorunDisposed(e){const t=this._getAutorunInfo(e);t&&(this._handleChange({instances:{[t.instanceId]:null}}),this._instanceInfos.delete(e),this._aliveInstances.delete(t.instanceId))}handleAutorunDependencyChanged(e,t,i){const n=this._getAutorunInfo(e);n&&n.changedObservables.add(t)}handleAutorunStarted(e){}handleAutorunFinished(e){const t=this._getAutorunInfo(e);t&&(t.changedObservables.clear(),t.updateCount++,this._handleChange({instances:{[t.instanceId]:{runCount:t.updateCount}}}))}handleDerivedDependencyChanged(e,t,i){const n=this._getObservableInfo(e);n&&n.changedObservables.add(t)}_handleDerivedRecomputed(e,t){const i=this._getObservableInfo(e);if(!i)return;const n=Bp(t.newValue,30);i.updateCount++,i.changedObservables.clear(),i.lastValue=n,i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:n,recomputationCount:i.updateCount}}})}handleDerivedCleared(e){const t=this._getObservableInfo(e);t&&(t.lastValue=void 0,t.changedObservables.clear(),t.listenerCount>0&&this._handleChange({instances:{[t.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}};Rf._instance=void 0;let g4=Rf;GL&&GL.VSCODE_DEV_DEBUG_OBSERVABLES&&ppe(g4.getInstance());const{getWindow:Ae,getDocument:Fpe,getWindows:qQ,getWindowsCount:Bpe,getWindowId:Cw,getWindowById:QH,onDidRegisterWindow:Av,onWillUnregisterWindow:Vpe,onDidUnregisterWindow:Wpe}=(function(){const s=new Map;Dme(Ut,1);const e={window:Ut,disposables:new Ee};s.set(Ut.vscodeWindowId,e);const t=new $,i=new $,n=new $;function r(o,a){return(typeof o=="number"?s.get(o):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(o){if(s.has(o.vscodeWindowId))return ne.None;const a=new Ee,l={window:o,disposables:a.add(new Ee)};return s.set(o.vscodeWindowId,l),a.add(Fe(()=>{s.delete(o.vscodeWindowId),i.fire(o)})),a.add(J(o,pe.BEFORE_UNLOAD,()=>{n.fire(o)})),t.fire(l),a},getWindows(){return s.values()},getWindowsCount(){return s.size},getWindowId(o){return o.vscodeWindowId},hasWindow(o){return s.has(o)},getWindowById:r,getWindow(o){var c;const a=o;if((c=a==null?void 0:a.ownerDocument)!=null&&c.defaultView)return a.ownerDocument.defaultView.window;const l=o;return l!=null&&l.view?l.view.window:Ut},getDocument(o){return Ae(o).document}}})();function Ya(s){for(;s.firstChild;)s.firstChild.remove()}class Hpe{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function J(s,e,t,i){return new Hpe(s,e,t,i)}function zpe(s,e){return function(t){return e(new io(s,t))}}function Upe(s){return function(e){return s(new jt(e))}}const Xn=function(e,t,i,n){let r=i;return t==="click"||t==="mousedown"||t==="contextmenu"?r=zpe(Ae(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=Upe(i)),J(e,t,r,n)};function jpe(s,e,t){return J(s,Gl&&Nv.pointerEvents?pe.POINTER_DOWN:pe.MOUSE_DOWN,e,t)}function $pe(s,e,t){return J(s,Gl&&Nv.pointerEvents?pe.POINTER_MOVE:pe.MOUSE_MOVE,e,t)}function XH(s,e,t){return J(s,Gl&&Nv.pointerEvents?pe.POINTER_UP:pe.MOUSE_UP,e,t)}function FS(s,e,t){return H0(s,e,t)}let GQ,hr;class B7 extends E7{constructor(e){super(),this.defaultTarget=e&&Ae(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}}class KI{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){It(e)}}static sort(e,t){return t.priority-e.priority}}(function(){const s=new Map,e=new Map,t=new Map,i=new Map,n=r=>{t.set(r,!1);const o=s.get(r)??[];for(e.set(r,o),s.set(r,[]),i.set(r,!0);o.length>0;)o.sort(KI.sort),o.shift().execute();i.set(r,!1)};hr=(r,o,a=0)=>{const l=Cw(r),c=new KI(o,a);let u=s.get(l);return u||(u=[],s.set(l,u)),u.push(c),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>n(l))),c},GQ=(r,o,a)=>{const l=Cw(r);if(i.get(l)){const c=new KI(o,a);let u=e.get(l);return u||(u=[],e.set(l,u)),u.push(c),c}else return hr(r,o,a)}})();function V7(s){return Ae(s).getComputedStyle(s,null)}function m4(s,e,t){const i=Ae(s),n=i.document;if(s!==n.body)return new ah(s.clientWidth,s.clientHeight);if(Gl&&(i!=null&&i.visualViewport))return new ah(i.visualViewport.width,i.visualViewport.height);if(i!=null&&i.innerWidth&&i.innerHeight)return new ah(i.innerWidth,i.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new ah(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new ah(n.documentElement.clientWidth,n.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class Di{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t){const i=V7(e),n=i?i.getPropertyValue(t):"0";return Di.convertToPixels(e,n)}static getBorderLeftWidth(e){return Di.getDimension(e,"border-left-width")}static getBorderRightWidth(e){return Di.getDimension(e,"border-right-width")}static getBorderTopWidth(e){return Di.getDimension(e,"border-top-width")}static getBorderBottomWidth(e){return Di.getDimension(e,"border-bottom-width")}static getPaddingLeft(e){return Di.getDimension(e,"padding-left")}static getPaddingRight(e){return Di.getDimension(e,"padding-right")}static getPaddingTop(e){return Di.getDimension(e,"padding-top")}static getPaddingBottom(e){return Di.getDimension(e,"padding-bottom")}static getMarginLeft(e){return Di.getDimension(e,"margin-left")}static getMarginTop(e){return Di.getDimension(e,"margin-top")}static getMarginRight(e){return Di.getDimension(e,"margin-right")}static getMarginBottom(e){return Di.getDimension(e,"margin-bottom")}}const Af=class Af{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Af(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof Af?e:new Af(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};Af.None=new Af(0,0);let ah=Af;function qpe(s){let e=s.offsetParent,t=s.offsetTop,i=s.offsetLeft;for(;(s=s.parentNode)!==null&&s!==s.ownerDocument.body&&s!==s.ownerDocument.documentElement;){t-=s.scrollTop;const n=YQ(s)?null:V7(s);n&&(i-=n.direction!=="rtl"?s.scrollLeft:-s.scrollLeft),s===e&&(i+=Di.getBorderLeftWidth(s),t+=Di.getBorderTopWidth(s),t+=s.offsetTop,i+=s.offsetLeft,e=s.offsetParent)}return{left:i,top:t}}function Mo(s){const e=s.getBoundingClientRect(),t=Ae(s);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function KQ(s){let e=s,t=1;do{const i=V7(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function W7(s){const e=Di.getMarginLeft(s)+Di.getMarginRight(s);return s.offsetWidth+e}function YI(s){const e=Di.getBorderLeftWidth(s)+Di.getBorderRightWidth(s),t=Di.getPaddingLeft(s)+Di.getPaddingRight(s);return s.offsetWidth-e-t}function Gpe(s){const e=Di.getBorderTopWidth(s)+Di.getBorderBottomWidth(s),t=Di.getPaddingTop(s)+Di.getPaddingBottom(s);return s.offsetHeight-e-t}function p4(s){const e=Di.getMarginTop(s)+Di.getMarginBottom(s);return s.offsetHeight+e}function xn(s,e){return!!(e!=null&&e.contains(s))}function Kpe(s,e,t){for(;s&&s.nodeType===s.ELEMENT_NODE;){if(s.classList.contains(e))return s;if(t){if(typeof t=="string"){if(s.classList.contains(t))return null}else if(s===t)return null}s=s.parentNode}return null}function QI(s,e,t){return!!Kpe(s,e,t)}function YQ(s){return s&&!!s.host&&!!s.mode}function _4(s){return!!Wg(s)}function Wg(s){var e;for(;s.parentNode;){if(s===((e=s.ownerDocument)==null?void 0:e.body))return null;s=s.parentNode}return YQ(s)?s:null}function Ln(){let s=sD().activeElement;for(;s!=null&&s.shadowRoot;)s=s.shadowRoot.activeElement;return s}function H7(s){return Ln()===s}function QQ(s){return xn(Ln(),s)}function sD(){return Bpe()<=1?Ut.document:Array.from(qQ()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Ut.document}function At(){var e;return((e=sD().defaultView)==null?void 0:e.window)??Ut}const Ype=new class{constructor(){this.mutationObservers=new Map}observe(s,e,t){let i=this.mutationObservers.get(s);i||(i=new Map,this.mutationObservers.set(s,i));const n=N7(t);let r=i.get(n);if(r)r.users+=1;else{const o=new $,a=new MutationObserver(c=>o.fire(c));a.observe(s,t);const l=r={users:1,observer:a,onDidMutate:o.event};e.add(Fe(()=>{l.users-=1,l.users===0&&(o.dispose(),a.disconnect(),i==null||i.delete(n),(i==null?void 0:i.size)===0&&this.mutationObservers.delete(s))})),i.set(n,r)}return r.onDidMutate}};function Wi(s){return s instanceof HTMLElement||s instanceof Ae(s).HTMLElement}function ZH(s){return s instanceof HTMLAnchorElement||s instanceof Ae(s).HTMLAnchorElement}function XQ(s){return s instanceof SVGElement||s instanceof Ae(s).SVGElement}function z7(s){return s instanceof MouseEvent||s instanceof Ae(s).MouseEvent}function ih(s){return s instanceof KeyboardEvent||s instanceof Ae(s).KeyboardEvent}const pe={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"};function Qpe(s){const e=s;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const vt={stop:(s,e)=>(s.preventDefault(),e&&s.stopPropagation(),s)};function Xpe(s){const e=[];for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)e[t]=s.scrollTop,s=s.parentNode;return e}function Zpe(s,e){for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)s.scrollTop!==e[t]&&(s.scrollTop=e[t]),s=s.parentNode}let Jpe=class b4 extends ne{get onDidFocus(){return this._onDidFocus.event}get onDidBlur(){return this._onDidBlur.event}static hasFocusWithin(e){if(Wi(e)){const t=Wg(e),i=t?t.activeElement:e.ownerDocument.activeElement;return xn(i,e)}else{const t=e;return xn(t.document.activeElement,t.document)}}constructor(e){super(),this._onDidFocus=this._register(new $),this._onDidBlur=this._register(new $);let t=b4.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(i=!0,(Wi(e)?Ae(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{b4.hasFocusWithin(e)!==t&&(t?r():n())},this._register(J(e,pe.FOCUS,n,!0)),this._register(J(e,pe.BLUR,r,!0)),Wi(e)&&(this._register(J(e,pe.FOCUS_IN,()=>this._refreshStateHandler())),this._register(J(e,pe.FOCUS_OUT,()=>this._refreshStateHandler())))}};function h1(s){return new Jpe(s)}function e_e(s,e){return s.after(e),e}function De(s,...e){if(s.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function rD(s,e){return s.insertBefore(e,s.firstChild),e}function as(s,...e){s.textContent="",De(s,...e)}const t_e=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var ww;(function(s){s.HTML="http://www.w3.org/1999/xhtml",s.SVG="http://www.w3.org/2000/svg"})(ww||(ww={}));function ZQ(s,e,t,...i){const n=t_e.exec(e);if(!n)throw new Error("Bad use of emmet");const r=n[1]||"div";let o;return s!==ww.HTML?o=document.createElementNS(s,r):o=document.createElement(r),n[3]&&(o.id=n[3]),n[4]&&(o.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?o[a]=l:a==="selected"?l&&o.setAttribute(a,"true"):o.setAttribute(a,l))}),o.append(...i),o}function Ve(s,e,...t){return ZQ(ww.HTML,s,e,...t)}Ve.SVG=function(s,e,...t){return ZQ(ww.SVG,s,e,...t)};function JQ(...s){for(const e of s)e.style.display="",e.removeAttribute("aria-hidden")}function JH(...s){for(const e of s)e.style.display="none",e.setAttribute("aria-hidden","true")}function ez(s,e){const t=s.devicePixelRatio*e;return Math.max(1,Math.floor(t))/s.devicePixelRatio}function eX(s){Ut.open(s,"_blank","noopener")}function i_e(s,e){const t=()=>{e(),i=hr(s,t)};let i=hr(s,t);return Fe(()=>i.dispose())}BQ.setPreferredWebSchema(/^https:/.test(Ut.location.href)?"https":"http");class Ou extends ${constructor(){super(),this._subscriptions=new Ee,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(ge.runAndSubscribe(Av,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Ut,disposables:this._subscriptions}))}registerListeners(e,t){t.add(J(e,"keydown",i=>{if(i.defaultPrevented)return;const n=new jt(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(J(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(J(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(J(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(J(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(J(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return Ou.instance||(Ou.instance=new Ou),Ou.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class n_e extends ne{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(J(this.element,pe.DRAG_START,e=>{var t,i;(i=(t=this.callbacks).onDragStart)==null||i.call(t,e)})),this.callbacks.onDrag&&this._register(J(this.element,pe.DRAG,e=>{var t,i;(i=(t=this.callbacks).onDrag)==null||i.call(t,e)})),this._register(J(this.element,pe.DRAG_ENTER,e=>{var t,i;this.counter++,this.dragStartTime=e.timeStamp,(i=(t=this.callbacks).onDragEnter)==null||i.call(t,e)})),this._register(J(this.element,pe.DRAG_OVER,e=>{var t,i;e.preventDefault(),(i=(t=this.callbacks).onDragOver)==null||i.call(t,e,e.timeStamp-this.dragStartTime)})),this._register(J(this.element,pe.DRAG_LEAVE,e=>{var t,i;this.counter--,this.counter===0&&(this.dragStartTime=0,(i=(t=this.callbacks).onDragLeave)==null||i.call(t,e))})),this._register(J(this.element,pe.DRAG_END,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDragEnd)==null||i.call(t,e)})),this._register(J(this.element,pe.DROP,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDrop)==null||i.call(t,e)}))}}const s_e=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function pt(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=s_e.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const r=n.groups.tag||"div",o=document.createElement(r);n.groups.id&&(o.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(o.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=o),i)for(const c of i)Wi(c)?o.appendChild(c):typeof c=="string"?o.append(c):"root"in c&&(Object.assign(l,c),o.appendChild(c.root));for(const[c,u]of Object.entries(t))if(c!=="className")if(c==="style")for(const[d,g]of Object.entries(u))o.style.setProperty(vw(d),typeof g=="number"?g+"px":""+g);else c==="tabIndex"?o.tabIndex=u:o.setAttribute(vw(c),u.toString());return l.root=o,l}function vw(s){return s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function qa(s){return s.tagName.toLowerCase()==="input"||s.tagName.toLowerCase()==="textarea"||Wi(s)&&!!s.editContext}var tz;(function(s){function e(n=void 0){return(r,o,a)=>{const l=o.class;delete o.class;const c=o.ref;delete o.ref;const u=o.obsRef;return delete o.obsRef,new o_e(r,c,u,n,l,o,a)}}function t(n,r=void 0){const o=e(r);return(a,l)=>o(n,a,l)}s.div=t("div"),s.elem=e(void 0),s.svg=t("svg","http://www.w3.org/2000/svg"),s.svgElem=e("http://www.w3.org/2000/svg");function i(){let n;const r=function(o){n=o};return Object.defineProperty(r,"element",{get(){if(!n)throw new Pe("Make sure the ref is set before accessing the element. Maybe wrong initialization order?");return n}}),r}s.ref=i})(tz||(tz={}));class U7{constructor(e,t,i,n,r,o,a){this._deriveds=[],this._element=n?document.createElementNS(n,e):document.createElement(e),t&&t(this._element),i&&this._deriveds.push(Ie(c=>{i(this),c.store.add({dispose:()=>{i(null)}})})),r&&(iX(r)?this._deriveds.push(Ie(this,c=>{iz(this._element,nz(r,c))})):iz(this._element,nz(r,void 0)));for(const[c,u]of Object.entries(o))if(c==="style")for(const[d,g]of Object.entries(u)){const p=vw(d);jf(g)?this._deriveds.push(Vl({owner:this,debugName:()=>`set.style.${p}`},_=>{this._element.style.setProperty(p,sz(g.read(_)))})):this._element.style.setProperty(p,sz(g))}else c==="tabIndex"?jf(u)?this._deriveds.push(Ie(this,d=>{this._element.tabIndex=u.read(d)})):this._element.tabIndex=u:c.startsWith("on")?this._element[c]=u:jf(u)?this._deriveds.push(Vl({owner:this,debugName:()=>`set.${c}`},d=>{rz(this._element,c,u.read(d))})):rz(this._element,c,u);if(a){let c=function(d,g){return jf(g)?c(d,g.read(d)):Array.isArray(g)?g.flatMap(p=>c(d,p)):g instanceof U7?(d&&g.readEffect(d),[g._element]):g?[g]:[]};var l=c;const u=Ie(this,d=>{this._element.replaceChildren(...c(d,a))});this._deriveds.push(u),nX(a)||u.get()}}readEffect(e){for(const t of this._deriveds)t.read(e)}keepUpdated(e){return Ie(t=>{this.readEffect(t)}).recomputeInitiallyAndOnChange(e),this}toDisposableLiveElement(){const e=new Ee;return this.keepUpdated(e),new r_e(this._element,e)}}function iz(s,e){XQ(s)?s.setAttribute("class",e):s.className=e}function tX(s,e,t){if(jf(s)){t(s.read(e));return}if(Array.isArray(s)){for(const i of s)tX(i,e,t);return}t(s)}function nz(s,e){let t="";return tX(s,e,i=>{i&&(t.length===0?t=i:t+=" "+i)}),t}function iX(s){return jf(s)?!0:Array.isArray(s)?s.some(e=>iX(e)):!1}function sz(s){return typeof s=="number"?s+"px":s}function nX(s){return jf(s)?!0:Array.isArray(s)?s.some(e=>nX(e)):!1}class r_e{constructor(e,t){this.element=e,this._disposable=t}dispose(){this._disposable.dispose()}}class o_e extends U7{constructor(){super(...arguments),this._isHovered=void 0,this._didMouseMoveDuringHover=void 0}get element(){return this._element}get isHovered(){if(!this._isHovered){const e=Qe("hovered",!1);this._element.addEventListener("mouseenter",t=>e.set(!0,void 0)),this._element.addEventListener("mouseleave",t=>e.set(!1,void 0)),this._isHovered=e}return this._isHovered}get didMouseMoveDuringHover(){if(!this._didMouseMoveDuringHover){let e=!1;const t=Qe("didMouseMoveDuringHover",!1);this._element.addEventListener("mouseenter",i=>{e=!0}),this._element.addEventListener("mousemove",i=>{e&&t.set(!0,void 0)}),this._element.addEventListener("mouseleave",i=>{e=!1,t.set(!1,void 0)}),this._didMouseMoveDuringHover=t}return this._didMouseMoveDuringHover}}function rz(s,e,t){t==null?s.removeAttribute(vw(e)):s.setAttribute(vw(e),String(t))}function jf(s){return!!s&&s.read!==void 0&&s.reportChanges!==void 0}class a_e extends ne{constructor(e){super(),this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){var i;(i=this._mediaQueryList)==null||i.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}}class l_e extends ne{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const t=this._register(new a_e(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}class c_e{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const t=Cw(e);let i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=new l_e(e),this.mapWindowIdToPixelRatioMonitor.set(t,i),ge.once(Wpe)(({vscodeWindowId:n})=>{n===t&&(i==null||i.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))})),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const JL=new c_e;class ek{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}focus(){this.domNode.focus()}setMaxWidth(e){const t=ka(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=ka(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=ka(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=ka(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=ka(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=ka(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=ka(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=ka(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=ka(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=ka(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=ka(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function ka(s){return typeof s=="number"?`${s}px`:s}function bt(s){return new ek(s)}function Jn(s,e){s instanceof ek?(s.setFontFamily(e.getMassagedFontFamily()),s.setFontWeight(e.fontWeight),s.setFontSize(e.fontSize),s.setFontFeatureSettings(e.fontFeatureSettings),s.setFontVariationSettings(e.fontVariationSettings),s.setLineHeight(e.lineHeight),s.setLetterSpacing(e.letterSpacing)):(s.style.fontFamily=e.getMassagedFontFamily(),s.style.fontWeight=e.fontWeight,s.style.fontSize=e.fontSize+"px",s.style.fontFeatureSettings=e.fontFeatureSettings,s.style.fontVariationSettings=e.fontVariationSettings,s.style.lineHeight=e.lineHeight+"px",s.style.letterSpacing=e.letterSpacing+"px")}class h_e{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class j7{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){var t;this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),(t=this._container)==null||t.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");Jn(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");Jn(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");Jn(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const r=[];for(const o of this._requests){let a;o.type===0&&(a=t),o.type===2&&(a=i),o.type===1&&(a=n),a.appendChild(document.createElement("br"));const l=document.createElement("span");j7._render(l,o),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let i="";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}}function u_e(s,e,t){new j7(e,t).read(s)}class d_e extends ne{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){const t=Cw(e);let i=this._cache.get(t);return i||(i=new f_e,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){const t=this._ensureCache(e),i=t.getValues();let n=!1;for(const r of i)r.isTrusted||(n=!0,t.remove(r));n&&this._onDidChange.fire()}readFontInfo(e,t){const i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new UL({pixelRatio:JL.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){const r=new h_e(e,t);return i.push(r),n==null||n.push(r),r}_actualReadFontInfo(e,t){const i=[],n=[],r=this._createRequest("n",0,i,n),o=this._createRequest("",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),c=this._createRequest("1",0,i,n),u=this._createRequest("2",0,i,n),d=this._createRequest("3",0,i,n),g=this._createRequest("4",0,i,n),p=this._createRequest("5",0,i,n),_=this._createRequest("6",0,i,n),C=this._createRequest("7",0,i,n),v=this._createRequest("8",0,i,n),x=this._createRequest("9",0,i,n),S=this._createRequest("",0,i,n),k=this._createRequest("",0,i,null),E=this._createRequest("",0,i,n),T=this._createRequest("",0,i,null),R="|/-_ilm%";for(let j=0,F=R.length;j<F;j++)this._createRequest(R.charAt(j),0,i,n),this._createRequest(R.charAt(j),1,i,n),this._createRequest(R.charAt(j),2,i,n);u_e(e,t,i);const N=Math.max(l.width,c.width,u.width,d.width,g.width,p.width,_.width,C.width,v.width,x.width);let A=t.fontFeatureSettings===hd.OFF;const O=n[0].width;for(let j=1,F=n.length;A&&j<F;j++){const q=O-n[j].width;if(q<-.001||q>.001){A=!1;break}}let W=!0;return A&&k.width!==O&&(W=!1),k.width>S.width&&(W=!1),new UL({pixelRatio:JL.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:A,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:o.width,canUseHalfwidthRightwardsArrow:W,spaceWidth:a.width,middotWidth:E.width,wsmiddotWidth:T.width,maxDigitWidth:N},!0)}}class f_e{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const C4=new d_e;var za;(function(s){s.serviceIds=new Map,s.DI_TARGET="$di$target",s.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[s.DI_DEPENDENCIES]||[]}s.getServiceDependencies=e})(za||(za={}));const wt=tt("instantiationService");function g_e(s,e,t){e[za.DI_TARGET]===e?e[za.DI_DEPENDENCIES].push({id:s,index:t}):(e[za.DI_DEPENDENCIES]=[{id:s,index:t}],e[za.DI_TARGET]=e)}function tt(s){if(za.serviceIds.has(s))return za.serviceIds.get(s);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");g_e(e,t,n)};return e.toString=()=>s,za.serviceIds.set(s,e),e}const fn=tt("codeEditorService"),Gs=tt("modelService"),oD=tt("textModelService");class Zu extends ne{get onDidChange(){return this._onDidChange.event}constructor(e,t="",i="",n=!0,r){super(),this._onDidChange=this._register(new $),this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class Hg extends ne{constructor(){super(...arguments),this._onWillRun=this._register(new $),this._onDidRun=this._register(new $)}get onWillRun(){return this._onWillRun.event}get onDidRun(){return this._onDidRun.event}async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}}const LC=class LC{constructor(){this.id=LC.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new LC,...i]:t=i);return t}async run(){}};LC.ID="vs.actions.separator";let On=LC;class aD{get actions(){return this._actions}constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}}const FE=class FE extends Zu{constructor(){super(FE.ID,w(28,"(empty)"),void 0,!1)}};FE.ID="vs.actions.empty";let w4=FE;function sg(s){return{id:s.id,label:s.label,tooltip:s.tooltip??s.label,class:s.class,enabled:s.enabled??!0,checked:s.checked,run:async(...e)=>s.run(...e)}}var v4;(function(s){function e(t){return!!t&&typeof t=="object"&&typeof t.id=="string"}s.isThemeColor=e})(v4||(v4={}));var ht;(function(s){s.iconNameSegment="[A-Za-z0-9]+",s.iconNameExpression="[A-Za-z0-9-]+",s.iconModifierExpression="~[A-Za-z]+",s.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${s.iconNameExpression})(${s.iconModifierExpression})?$`);function t(_){const C=e.exec(_.id);if(!C)return t(xe.error);const[,v,x]=C,S=["codicon","codicon-"+v];return x&&S.push("codicon-modifier-"+x.substring(1)),S}s.asClassNameArray=t;function i(_){return t(_).join(" ")}s.asClassName=i;function n(_){return"."+t(_).join(".")}s.asCSSSelector=n;function r(_){return!!_&&typeof _=="object"&&typeof _.id=="string"&&(typeof _.color>"u"||v4.isThemeColor(_.color))}s.isThemeIcon=r;const o=new RegExp(`^\\$\\((${s.iconNameExpression}(?:${s.iconModifierExpression})?)\\)$`);function a(_){const C=o.exec(_);if(!C)return;const[,v]=C;return{id:v}}s.fromString=a;function l(_){return{id:_}}s.fromId=l;function c(_,C){let v=_.id;const x=v.lastIndexOf("~");return x!==-1&&(v=v.substring(0,x)),C&&(v=`${v}~${C}`),{id:v}}s.modify=c;function u(_){const C=_.id.lastIndexOf("~");if(C!==-1)return _.id.substring(C+1)}s.getModifier=u;function d(_,C){var v,x;return _.id===C.id&&((v=_.color)==null?void 0:v.id)===((x=C.color)==null?void 0:x.id)}s.isEqual=d;function g(_){return(_==null?void 0:_.id)===xe.file.id}s.isFile=g;function p(_){return(_==null?void 0:_.id)===xe.folder.id}s.isFolder=p})(ht||(ht={}));const ho=tt("commandService"),dr=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new $,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(s,e){if(!s)throw new Error("invalid command");if(typeof s=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:s,handler:e})}if(s.metadata&&Array.isArray(s.metadata.args)){const o=[];for(const l of s.metadata.args)o.push(l.constraint);const a=s.handler;s.handler=function(l,...c){return Ife(c,o),a(l,...c)}}const{id:t}=s;let i=this._commands.get(t);i||(i=new sr,this._commands.set(t,i));const n=i.unshift(s),r=Fe(()=>{n();const o=this._commands.get(t);o!=null&&o.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(s,e){return dr.registerCommand(s,(t,...i)=>t.get(ho).executeCommand(e,...i))}getCommand(s){const e=this._commands.get(s);if(!(!e||e.isEmpty()))return _t.first(e)}getCommands(){const s=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&s.set(e,t)}return s}};dr.registerCommand("noop",()=>{});function XI(...s){switch(s.length){case 1:return w(1693,"Did you mean {0}?",s[0]);case 2:return w(1694,"Did you mean {0} or {1}?",s[0],s[1]);case 3:return w(1695,"Did you mean {0}, {1} or {2}?",s[0],s[1],s[2]);default:return}}const m_e=w(1696,"Did you forget to open or close the quote?"),p_e=w(1697,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),n_=class n_{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw HL(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(XI("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(XI("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(XI("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=n_._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(m_e);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(p_e);return}const r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!i){e++;break}else r===91?i=!0:r===92?t=!0:r===93&&(i=!1);e++}for(;e<this._input.length&&n_._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};n_._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),n_._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);let gf=n_;const us=new Map;us.set("false",!1);us.set("true",!0);us.set("isMac",rt);us.set("isLinux",kr);us.set("isWindows",cr);us.set("isWeb",Fh);us.set("isMacNative",rt&&!Fh);us.set("isEdge",oQ);us.set("isFirefox",Ufe);us.set("isChrome",h7);us.set("isSafari",jfe);const __e=Object.prototype.hasOwnProperty,b_e={regexParsingWithErrorRecovery:!0},C_e=w(1675,"Empty context key expression"),w_e=w(1676,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),v_e=w(1677,"'in' after 'not'."),oz=w(1678,"closing parenthesis ')'"),y_e=w(1679,"Unexpected token"),S_e=w(1680,"Did you forget to put && or || before the token?"),x_e=w(1681,"Unexpected end of expression"),L_e=w(1682,"Did you forget to put a context key?");var Al;let k_e=(Al=class{constructor(e=b_e){this._config=e,this._scanner=new gf,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:C_e,offset:0,lexeme:"",additionalInfo:w_e});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?S_e:void 0;throw this._parsingErrors.push({message:y_e,offset:i.offset,lexeme:gf.getLexeme(i),additionalInfo:n}),Al._parseError}return t}catch(t){if(t!==Al._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:ft.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:ft.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),js.INSTANCE;case 12:return this._advance(),ur.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,oz),t==null?void 0:t.negate()}case 17:return this._advance(),am.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),ft.true();case 12:return this._advance(),ft.false();case 0:{this._advance();const t=this._expr();return this._consume(1,oz),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const r=n.lexeme,o=r.lastIndexOf("/"),a=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let l;try{l=new RegExp(r.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return yw.create(t,l)}switch(n.type){case 10:case 19:{const r=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let g=0;g<n.lexeme.length;g++)n.lexeme.charCodeAt(g)===40?a++:n.lexeme.charCodeAt(g)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let g=0;g<o.lexeme.length;g++)o.lexeme.charCodeAt(g)===40?a++:n.lexeme.charCodeAt(g)===41&&a--}if(a<0)break;r.push(gf.getLexeme(o)),this._advance(),o=this._peek()}const l=r.join(""),c=l.lastIndexOf("/"),u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),u)}catch{throw this._errExpectedButGot("REGEX",n)}return ft.regex(t,d)}case 18:{const r=n.lexeme;this._advance();let o=null;if(!Nme(r)){const a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){const c=r.slice(a+1,l),u=r[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return yw.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,v_e);const n=this._value();return ft.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return ft.equals(t,n);switch(n){case"true":return ft.has(t);case"false":return ft.not(t);default:return ft.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return ft.notEquals(t,n);switch(n){case"true":return ft.not(t);case"false":return ft.has(t);default:return ft.notEquals(t,n)}}case 5:return this._advance(),gD.create(t,this._value());case 6:return this._advance(),mD.create(t,this._value());case 7:return this._advance(),dD.create(t,this._value());case 8:return this._advance(),fD.create(t,this._value());case 13:return this._advance(),ft.in(t,this._value());default:return ft.has(t)}}case 20:throw this._parsingErrors.push({message:x_e,offset:e.offset,lexeme:"",additionalInfo:L_e}),Al._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=w(1683,`Expected: {0}
Received: '{1}'.`,e,gf.getLexeme(t)),r=t.offset,o=gf.getLexeme(t);return this._parsingErrors.push({message:n,offset:r,lexeme:o,additionalInfo:i}),Al._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Al._parseError=new Error,Al);const H9=class H9{static false(){return js.INSTANCE}static true(){return ur.INSTANCE}static has(e){return om.create(e)}static equals(e,t){return Mv.create(e,t)}static notEquals(e,t){return hD.create(e,t)}static regex(e,t){return yw.create(e,t)}static in(e,t){return lD.create(e,t)}static notIn(e,t){return cD.create(e,t)}static not(e){return am.create(e)}static and(...e){return $f.create(e,null,!0)}static or(...e){return lh.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};H9._parser=new k_e({regexParsingWithErrorRecovery:!1});let ft=H9;function E_e(s,e){const t=s?s.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function z0(s,e){return s.cmp(e)}const BE=class BE{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return ur.INSTANCE}};BE.INSTANCE=new BE;let js=BE;const VE=class VE{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return js.INSTANCE}};VE.INSTANCE=new VE;let ur=VE;class om{static create(e,t=null){const i=us.get(e);return typeof i=="boolean"?i?ur.INSTANCE:js.INSTANCE:new om(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:rX(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=us.get(this.key);return typeof e=="boolean"?e?ur.INSTANCE:js.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=am.create(this.key,this)),this.negated}}class Mv{static create(e,t,i=null){if(typeof t=="boolean")return t?om.create(e,i):am.create(e,i);const n=us.get(e);return typeof n=="boolean"?t===(n?"true":"false")?ur.INSTANCE:js.INSTANCE:new Mv(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=us.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?ur.INSTANCE:js.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=hD.create(this.key,this.value,this)),this.negated}}class lD{static create(e,t){return new lD(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?__e.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=cD.create(this.key,this.valueKey)),this.negated}}class cD{static create(e,t){return new cD(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=lD.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class hD{static create(e,t,i=null){if(typeof t=="boolean")return t?am.create(e,i):om.create(e,i);const n=us.get(e);return typeof n=="boolean"?t===(n?"true":"false")?js.INSTANCE:ur.INSTANCE:new hD(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=us.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?js.INSTANCE:ur.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Mv.create(this.key,this.value,this)),this.negated}}class am{static create(e,t=null){const i=us.get(e);return typeof i=="boolean"?i?js.INSTANCE:ur.INSTANCE:new am(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:rX(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=us.get(this.key);return typeof e=="boolean"?e?js.INSTANCE:ur.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=om.create(this.key,this)),this.negated}}function uD(s,e){if(typeof s=="string"){const t=parseFloat(s);isNaN(t)||(s=t)}return typeof s=="string"||typeof s=="number"?e(s):js.INSTANCE}class dD{static create(e,t,i=null){return uD(t,n=>new dD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=mD.create(this.key,this.value,this)),this.negated}}class fD{static create(e,t,i=null){return uD(t,n=>new fD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=gD.create(this.key,this.value,this)),this.negated}}class gD{static create(e,t,i=null){return uD(t,n=>new gD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=fD.create(this.key,this.value,this)),this.negated}}class mD{static create(e,t,i=null){return uD(t,n=>new mD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:lm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=dD.create(this.key,this.value,this)),this.negated}}class yw{static create(e,t){return new yw(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=$7.create(this)),this.negated}}class $7{static create(e){return new $7(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function sX(s){let e=null;for(let t=0,i=s.length;t<i;t++){const n=s[t].substituteConstants();if(s[t]!==n&&e===null){e=[];for(let r=0;r<t;r++)e[r]=s[r]}e!==null&&(e[t]=n)}return e===null?s:e}class $f{static create(e,t,i){return $f._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=z0(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=sX(this.expr);return e===this.expr?this:$f.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let r=!1;for(const o of e)if(o){if(o.type===1){r=!0;continue}if(o.type===0)return js.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&r)return ur.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(z0);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=lh.create(o.expr.map(u=>$f.create([u,a],null,i)),null,l);c&&(n.push(c),n.sort(z0))}if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return js.INSTANCE;if(n.length===1)return n[0]}return new $f(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=lh.create(e,this,!0)}return this.negated}}class lh{static create(e,t,i){return lh._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=z0(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=sX(this.expr);return e===this.expr?this:lh.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],r=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return ur.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&r)return js.INSTANCE;n.sort(z0)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return ur.INSTANCE;if(n.length===1)return n[0]}return new lh(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const r of lz(t))for(const o of lz(i))n.push($f.create([r,o],null,!1));e.unshift(lh.create(n,null,!1))}this.negated=lh.create(e,this,!0)}return this.negated}}const s_=class s_ extends om{static all(){return s_._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?s_._info.push({...i,key:e}):i!==!0&&s_._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return Mv.create(this.key,e)}};s_._info=[];let Ne=s_;const St=tt("contextKeyService");function rX(s,e){return s<e?-1:s>e?1:0}function lm(s,e,t,i){return s<t?-1:s>t?1:e<i?-1:e>i?1:0}function y4(s,e){if(s.type===0||e.type===1)return!0;if(s.type===9)return e.type===9?az(s.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(y4(s,t))return!0;return!1}if(s.type===6){if(e.type===6)return az(e.expr,s.expr);for(const t of s.expr)if(y4(t,e))return!0;return!1}return s.equals(e)}function az(s,e){let t=0,i=0;for(;t<s.length&&i<e.length;){const n=s[t].cmp(e[i]);if(n<0)return!1;n===0&&t++,i++}return t===s.length}function lz(s){return s.type===9?s.expr:[s]}class D_e{constructor(){this.data=new Map}add(e,t){FI(Pn(e)),FI(Vs(t)),FI(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{o1(e.dispose)&&e.dispose()}),this.data.clear()}}const Fn=new D_e;class q7{constructor(){this._coreKeybindings=new sr,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(ca===1){if(e&&e.win)return e.win}else if(ca===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=q7.bindToCurrentPlatform(e),i=new Ee;if(t&&t.primary){const n=s4(t.primary,ca);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,r=t.secondary.length;n<r;n++){const o=t.secondary[n],a=s4(o,ca);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}registerCommandAndKeybindingRule(e){return Bl(this.registerKeybindingRule(e),dr.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,r,o){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:o,weight1:n,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Fe(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(N_e)),this._cachedMergedKeybindings.slice(0)}}const vd=new q7,T_e={EditorModes:"platform.keybindingsRegistry"};Fn.add(T_e.EditorModes,vd);function N_e(s,e){if(s.weight1!==e.weight1)return s.weight1-e.weight1;if(s.command&&e.command){if(s.command<e.command)return-1;if(s.command>e.command)return 1}return s.weight2-e.weight2}var I_e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},cz=function(s,e){return function(t,i){e(t,i,s)}},Px;function U0(s){return s.command!==void 0}function R_e(s){return s.submenu!==void 0}const M=class M{constructor(e){if(M._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);M._instances.set(e,this),this.id=e}};M._instances=new Map,M.CommandPalette=new M("CommandPalette"),M.DebugBreakpointsContext=new M("DebugBreakpointsContext"),M.DebugCallStackContext=new M("DebugCallStackContext"),M.DebugConsoleContext=new M("DebugConsoleContext"),M.DebugVariablesContext=new M("DebugVariablesContext"),M.NotebookVariablesContext=new M("NotebookVariablesContext"),M.DebugHoverContext=new M("DebugHoverContext"),M.DebugWatchContext=new M("DebugWatchContext"),M.DebugToolBar=new M("DebugToolBar"),M.DebugToolBarStop=new M("DebugToolBarStop"),M.DebugDisassemblyContext=new M("DebugDisassemblyContext"),M.DebugCallStackToolbar=new M("DebugCallStackToolbar"),M.DebugCreateConfiguration=new M("DebugCreateConfiguration"),M.EditorContext=new M("EditorContext"),M.SimpleEditorContext=new M("SimpleEditorContext"),M.EditorContent=new M("EditorContent"),M.EditorLineNumberContext=new M("EditorLineNumberContext"),M.EditorContextCopy=new M("EditorContextCopy"),M.EditorContextPeek=new M("EditorContextPeek"),M.EditorContextShare=new M("EditorContextShare"),M.EditorTitle=new M("EditorTitle"),M.CompactWindowEditorTitle=new M("CompactWindowEditorTitle"),M.EditorTitleRun=new M("EditorTitleRun"),M.EditorTitleContext=new M("EditorTitleContext"),M.EditorTitleContextShare=new M("EditorTitleContextShare"),M.EmptyEditorGroup=new M("EmptyEditorGroup"),M.EmptyEditorGroupContext=new M("EmptyEditorGroupContext"),M.EditorTabsBarContext=new M("EditorTabsBarContext"),M.EditorTabsBarShowTabsSubmenu=new M("EditorTabsBarShowTabsSubmenu"),M.EditorTabsBarShowTabsZenModeSubmenu=new M("EditorTabsBarShowTabsZenModeSubmenu"),M.EditorActionsPositionSubmenu=new M("EditorActionsPositionSubmenu"),M.EditorSplitMoveSubmenu=new M("EditorSplitMoveSubmenu"),M.ExplorerContext=new M("ExplorerContext"),M.ExplorerContextShare=new M("ExplorerContextShare"),M.ExtensionContext=new M("ExtensionContext"),M.ExtensionEditorContextMenu=new M("ExtensionEditorContextMenu"),M.GlobalActivity=new M("GlobalActivity"),M.CommandCenter=new M("CommandCenter"),M.CommandCenterCenter=new M("CommandCenterCenter"),M.LayoutControlMenuSubmenu=new M("LayoutControlMenuSubmenu"),M.LayoutControlMenu=new M("LayoutControlMenu"),M.MenubarMainMenu=new M("MenubarMainMenu"),M.MenubarAppearanceMenu=new M("MenubarAppearanceMenu"),M.MenubarDebugMenu=new M("MenubarDebugMenu"),M.MenubarEditMenu=new M("MenubarEditMenu"),M.MenubarCopy=new M("MenubarCopy"),M.MenubarFileMenu=new M("MenubarFileMenu"),M.MenubarGoMenu=new M("MenubarGoMenu"),M.MenubarHelpMenu=new M("MenubarHelpMenu"),M.MenubarLayoutMenu=new M("MenubarLayoutMenu"),M.MenubarNewBreakpointMenu=new M("MenubarNewBreakpointMenu"),M.PanelAlignmentMenu=new M("PanelAlignmentMenu"),M.PanelPositionMenu=new M("PanelPositionMenu"),M.ActivityBarPositionMenu=new M("ActivityBarPositionMenu"),M.MenubarPreferencesMenu=new M("MenubarPreferencesMenu"),M.MenubarRecentMenu=new M("MenubarRecentMenu"),M.MenubarSelectionMenu=new M("MenubarSelectionMenu"),M.MenubarShare=new M("MenubarShare"),M.MenubarSwitchEditorMenu=new M("MenubarSwitchEditorMenu"),M.MenubarSwitchGroupMenu=new M("MenubarSwitchGroupMenu"),M.MenubarTerminalMenu=new M("MenubarTerminalMenu"),M.MenubarTerminalSuggestStatusMenu=new M("MenubarTerminalSuggestStatusMenu"),M.MenubarViewMenu=new M("MenubarViewMenu"),M.MenubarHomeMenu=new M("MenubarHomeMenu"),M.OpenEditorsContext=new M("OpenEditorsContext"),M.OpenEditorsContextShare=new M("OpenEditorsContextShare"),M.ProblemsPanelContext=new M("ProblemsPanelContext"),M.SCMInputBox=new M("SCMInputBox"),M.SCMChangeContext=new M("SCMChangeContext"),M.SCMResourceContext=new M("SCMResourceContext"),M.SCMResourceContextShare=new M("SCMResourceContextShare"),M.SCMResourceFolderContext=new M("SCMResourceFolderContext"),M.SCMResourceGroupContext=new M("SCMResourceGroupContext"),M.SCMSourceControl=new M("SCMSourceControl"),M.SCMSourceControlInline=new M("SCMSourceControlInline"),M.SCMSourceControlTitle=new M("SCMSourceControlTitle"),M.SCMHistoryTitle=new M("SCMHistoryTitle"),M.SCMHistoryItemContext=new M("SCMHistoryItemContext"),M.SCMHistoryItemChangeContext=new M("SCMHistoryItemChangeContext"),M.SCMHistoryItemRefContext=new M("SCMHistoryItemRefContext"),M.SCMArtifactGroupContext=new M("SCMArtifactGroupContext"),M.SCMArtifactContext=new M("SCMArtifactContext"),M.SCMQuickDiffDecorations=new M("SCMQuickDiffDecorations"),M.SCMTitle=new M("SCMTitle"),M.SearchContext=new M("SearchContext"),M.SearchActionMenu=new M("SearchActionContext"),M.StatusBarWindowIndicatorMenu=new M("StatusBarWindowIndicatorMenu"),M.StatusBarRemoteIndicatorMenu=new M("StatusBarRemoteIndicatorMenu"),M.StickyScrollContext=new M("StickyScrollContext"),M.TestItem=new M("TestItem"),M.TestItemGutter=new M("TestItemGutter"),M.TestProfilesContext=new M("TestProfilesContext"),M.TestMessageContext=new M("TestMessageContext"),M.TestMessageContent=new M("TestMessageContent"),M.TestPeekElement=new M("TestPeekElement"),M.TestPeekTitle=new M("TestPeekTitle"),M.TestCallStack=new M("TestCallStack"),M.TestCoverageFilterItem=new M("TestCoverageFilterItem"),M.TouchBarContext=new M("TouchBarContext"),M.TitleBar=new M("TitleBar"),M.TitleBarContext=new M("TitleBarContext"),M.TitleBarTitleContext=new M("TitleBarTitleContext"),M.TunnelContext=new M("TunnelContext"),M.TunnelPrivacy=new M("TunnelPrivacy"),M.TunnelProtocol=new M("TunnelProtocol"),M.TunnelPortInline=new M("TunnelInline"),M.TunnelTitle=new M("TunnelTitle"),M.TunnelLocalAddressInline=new M("TunnelLocalAddressInline"),M.TunnelOriginInline=new M("TunnelOriginInline"),M.ViewItemContext=new M("ViewItemContext"),M.ViewContainerTitle=new M("ViewContainerTitle"),M.ViewContainerTitleContext=new M("ViewContainerTitleContext"),M.ViewTitle=new M("ViewTitle"),M.ViewTitleContext=new M("ViewTitleContext"),M.CommentEditorActions=new M("CommentEditorActions"),M.CommentThreadTitle=new M("CommentThreadTitle"),M.CommentThreadActions=new M("CommentThreadActions"),M.CommentThreadAdditionalActions=new M("CommentThreadAdditionalActions"),M.CommentThreadTitleContext=new M("CommentThreadTitleContext"),M.CommentThreadCommentContext=new M("CommentThreadCommentContext"),M.CommentTitle=new M("CommentTitle"),M.CommentActions=new M("CommentActions"),M.CommentsViewThreadActions=new M("CommentsViewThreadActions"),M.InteractiveToolbar=new M("InteractiveToolbar"),M.InteractiveCellTitle=new M("InteractiveCellTitle"),M.InteractiveCellDelete=new M("InteractiveCellDelete"),M.InteractiveCellExecute=new M("InteractiveCellExecute"),M.InteractiveInputExecute=new M("InteractiveInputExecute"),M.InteractiveInputConfig=new M("InteractiveInputConfig"),M.ReplInputExecute=new M("ReplInputExecute"),M.IssueReporter=new M("IssueReporter"),M.NotebookToolbar=new M("NotebookToolbar"),M.NotebookToolbarContext=new M("NotebookToolbarContext"),M.NotebookStickyScrollContext=new M("NotebookStickyScrollContext"),M.NotebookCellTitle=new M("NotebookCellTitle"),M.NotebookCellDelete=new M("NotebookCellDelete"),M.NotebookCellInsert=new M("NotebookCellInsert"),M.NotebookCellBetween=new M("NotebookCellBetween"),M.NotebookCellListTop=new M("NotebookCellTop"),M.NotebookCellExecute=new M("NotebookCellExecute"),M.NotebookCellExecuteGoTo=new M("NotebookCellExecuteGoTo"),M.NotebookCellExecutePrimary=new M("NotebookCellExecutePrimary"),M.NotebookDiffCellInputTitle=new M("NotebookDiffCellInputTitle"),M.NotebookDiffDocumentMetadata=new M("NotebookDiffDocumentMetadata"),M.NotebookDiffCellMetadataTitle=new M("NotebookDiffCellMetadataTitle"),M.NotebookDiffCellOutputsTitle=new M("NotebookDiffCellOutputsTitle"),M.NotebookOutputToolbar=new M("NotebookOutputToolbar"),M.NotebookOutlineFilter=new M("NotebookOutlineFilter"),M.NotebookOutlineActionMenu=new M("NotebookOutlineActionMenu"),M.NotebookEditorLayoutConfigure=new M("NotebookEditorLayoutConfigure"),M.NotebookKernelSource=new M("NotebookKernelSource"),M.BulkEditTitle=new M("BulkEditTitle"),M.BulkEditContext=new M("BulkEditContext"),M.TimelineItemContext=new M("TimelineItemContext"),M.TimelineTitle=new M("TimelineTitle"),M.TimelineTitleContext=new M("TimelineTitleContext"),M.TimelineFilterSubMenu=new M("TimelineFilterSubMenu"),M.AccountsContext=new M("AccountsContext"),M.SidebarTitle=new M("SidebarTitle"),M.PanelTitle=new M("PanelTitle"),M.AuxiliaryBarTitle=new M("AuxiliaryBarTitle"),M.TerminalInstanceContext=new M("TerminalInstanceContext"),M.TerminalEditorInstanceContext=new M("TerminalEditorInstanceContext"),M.TerminalNewDropdownContext=new M("TerminalNewDropdownContext"),M.TerminalTabContext=new M("TerminalTabContext"),M.TerminalTabEmptyAreaContext=new M("TerminalTabEmptyAreaContext"),M.TerminalStickyScrollContext=new M("TerminalStickyScrollContext"),M.WebviewContext=new M("WebviewContext"),M.InlineCompletionsActions=new M("InlineCompletionsActions"),M.InlineEditsActions=new M("InlineEditsActions"),M.NewFile=new M("NewFile"),M.MergeInput1Toolbar=new M("MergeToolbar1Toolbar"),M.MergeInput2Toolbar=new M("MergeToolbar2Toolbar"),M.MergeBaseToolbar=new M("MergeBaseToolbar"),M.MergeInputResultToolbar=new M("MergeToolbarResultToolbar"),M.InlineSuggestionToolbar=new M("InlineSuggestionToolbar"),M.InlineEditToolbar=new M("InlineEditToolbar"),M.ChatContext=new M("ChatContext"),M.ChatCodeBlock=new M("ChatCodeblock"),M.ChatCompareBlock=new M("ChatCompareBlock"),M.ChatMessageTitle=new M("ChatMessageTitle"),M.ChatHistory=new M("ChatHistory"),M.ChatWelcomeContext=new M("ChatWelcomeContext"),M.ChatMessageFooter=new M("ChatMessageFooter"),M.ChatExecute=new M("ChatExecute"),M.ChatInput=new M("ChatInput"),M.ChatInputSide=new M("ChatInputSide"),M.ChatModePicker=new M("ChatModePicker"),M.ChatEditingWidgetToolbar=new M("ChatEditingWidgetToolbar"),M.ChatEditingEditorContent=new M("ChatEditingEditorContent"),M.ChatEditingEditorHunk=new M("ChatEditingEditorHunk"),M.ChatEditingDeletedNotebookCell=new M("ChatEditingDeletedNotebookCell"),M.ChatInputAttachmentToolbar=new M("ChatInputAttachmentToolbar"),M.ChatEditingWidgetModifiedFilesToolbar=new M("ChatEditingWidgetModifiedFilesToolbar"),M.ChatInputResourceAttachmentContext=new M("ChatInputResourceAttachmentContext"),M.ChatInputSymbolAttachmentContext=new M("ChatInputSymbolAttachmentContext"),M.ChatInlineResourceAnchorContext=new M("ChatInlineResourceAnchorContext"),M.ChatInlineSymbolAnchorContext=new M("ChatInlineSymbolAnchorContext"),M.ChatMessageCheckpoint=new M("ChatMessageCheckpoint"),M.ChatMessageRestoreCheckpoint=new M("ChatMessageRestoreCheckpoint"),M.ChatNewMenu=new M("ChatNewMenu"),M.ChatEditingCodeBlockContext=new M("ChatEditingCodeBlockContext"),M.ChatTitleBarMenu=new M("ChatTitleBarMenu"),M.ChatAttachmentsContext=new M("ChatAttachmentsContext"),M.ChatToolOutputResourceToolbar=new M("ChatToolOutputResourceToolbar"),M.ChatTextEditorMenu=new M("ChatTextEditorMenu"),M.ChatToolOutputResourceContext=new M("ChatToolOutputResourceContext"),M.ChatMultiDiffContext=new M("ChatMultiDiffContext"),M.ChatSessionsMenu=new M("ChatSessionsMenu"),M.ChatSessionsCreateSubMenu=new M("ChatSessionsCreateSubMenu"),M.ChatConfirmationMenu=new M("ChatConfirmationMenu"),M.ChatEditorInlineExecute=new M("ChatEditorInputExecute"),M.ChatEditorInlineInputSide=new M("ChatEditorInputSide"),M.AccessibleView=new M("AccessibleView"),M.MultiDiffEditorFileToolbar=new M("MultiDiffEditorFileToolbar"),M.DiffEditorHunkToolbar=new M("DiffEditorHunkToolbar"),M.DiffEditorSelectionToolbar=new M("DiffEditorSelectionToolbar");let rn=M;const cm=tt("menuService"),kC=class kC{static for(e){let t=this._all.get(e);return t||(t=new kC(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof kC&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}};kC._all=new Map;let mf=kC;const u1=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new ege({merge:mf.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(s){return this._commands.set(s.id,s),this._onDidChangeMenu.fire(mf.for(rn.CommandPalette)),Fe(()=>{this._commands.delete(s.id)&&this._onDidChangeMenu.fire(mf.for(rn.CommandPalette))})}getCommand(s){return this._commands.get(s)}getCommands(){const s=new Map;return this._commands.forEach((e,t)=>s.set(t,e)),s}appendMenuItem(s,e){let t=this._menuItems.get(s);t||(t=new sr,this._menuItems.set(s,t));const i=t.push(e);return this._onDidChangeMenu.fire(mf.for(s)),Fe(()=>{i(),this._onDidChangeMenu.fire(mf.for(s))})}appendMenuItems(s){const e=new Ee;for(const{id:t,item:i}of s)e.add(this.appendMenuItem(t,i));return e}getMenuItems(s){let e;return this._menuItems.has(s)?e=[...this._menuItems.get(s)]:e=[],s===rn.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(s){const e=new Set;for(const t of s)U0(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||s.push({command:t})})}};class x_ extends aD{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let Lh=Px=class{static label(e,t){return t!=null&&t.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,n,r,o,a){var c;this.hideActions=n,this.menuKeybinding=r,this._commandService=a,this.id=e.id,this.label=Px.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:(c=e.tooltip)==null?void 0:c.value)??"",this.enabled=!e.precondition||o.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){const u=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=o.contextMatchesRules(u.condition),this.checked&&u.tooltip&&(this.tooltip=typeof u.tooltip=="string"?u.tooltip:u.tooltip.value),this.checked&&ht.isThemeIcon(u.icon)&&(l=u.icon),this.checked&&u.title&&(this.label=typeof u.title=="string"?u.title:u.title.value)}l||(l=ht.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Px(t,void 0,i,n,void 0,o,a):void 0,this._options=i,this.class=l&&ht.asClassName(l)}run(...e){var i,n;let t=[];return(i=this._options)!=null&&i.arg&&(t=[...t,this._options.arg]),(n=this._options)!=null&&n.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Lh=Px=I_e([cz(5,St),cz(6,ho)],Lh);const Bh=tt("telemetryService");var hz,uz,dz;class A_e{constructor(e,t){this.uri=e,this.value=t}}function M_e(s){return Array.isArray(s)}const Mf=class Mf{constructor(e,t){if(this[hz]="ResourceMap",e instanceof Mf)this.map=new Map(e.map),this.toKey=t??Mf.defaultToKey;else if(M_e(e)){this.map=new Map,this.toKey=t??Mf.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Mf.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new A_e(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(hz=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};Mf.defaultToKey=e=>e.toString();let ls=Mf;class O_e{constructor(e,t){this[uz]="ResourceSet",!e||typeof e=="function"?this._map=new ls(e):(this._map=new ls(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(uz=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}class P_e{constructor(){this[dz]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}[(dz=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class F_e extends P_e{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class Ov extends F_e{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class B_e{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class oX{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}}class pD{constructor(){this._data=new Map}set(e,...t){let i=this._data;for(let n=0;n<t.length-1;n++)i.has(t[n])||i.set(t[n],new Map),i=i.get(t[n]);i.set(t[t.length-1],e)}get(...e){let t=this._data;for(let i=0;i<e.length-1;i++){if(!t.has(e[i]))return;t=t.get(e[i])}return t.get(e[e.length-1])}clear(){this._data.clear()}toString(){const e=(t,i)=>{let n="";for(const[r,o]of t)n+=`${"  ".repeat(i)}${r}: `,o instanceof Map?n+=`
`+e(o,i+1):n+=`${o}
`;return n};return e(this._data,0)}}function _u(s){return s===47||s===92}function aX(s){return s.replace(/[\\/]/g,Gi.sep)}function V_e(s){return s.indexOf("/")===-1&&(s=aX(s)),/^[a-zA-Z]:(\/|$)/.test(s)&&(s="/"+s),s}function fz(s,e=Gi.sep){if(!s)return"";const t=s.length,i=s.charCodeAt(0);if(_u(i)){if(_u(s.charCodeAt(1))&&!_u(s.charCodeAt(2))){let r=3;const o=r;for(;r<t&&!_u(s.charCodeAt(r));r++);if(o!==r&&!_u(s.charCodeAt(r+1))){for(r+=1;r<t;r++)if(_u(s.charCodeAt(r)))return s.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(W_e(i)&&s.charCodeAt(1)===58)return _u(s.charCodeAt(2))?s.slice(0,2)+e:s.slice(0,2);let n=s.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(_u(s.charCodeAt(n)))return s.slice(0,n+1)}return""}function S4(s,e,t,i=Xu){if(s===e)return!0;if(!s||!e||e.length>s.length)return!1;if(t){if(!C7(s,e))return!1;if(e.length===s.length)return!0;let r=e.length;return e.charAt(e.length-1)===i&&r--,s.charAt(r)===i}return e.charAt(e.length-1)!==i&&(e+=i),s.indexOf(e)===0}function W_e(s){return s>=65&&s<=90||s>=97&&s<=122}function Pc(s){return YL(s,!0)}class H_e{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:t4(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===je.file)return S4(Pc(e),Pc(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(mz(e.authority,t.authority))return S4(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return nt.joinPath(e,...t)}basenameOrAuthority(e){return G7(e)||e.authority}basename(e){return Gi.basename(e.path)}extname(e){return Gi.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===je.file?t=nt.file(ume(Pc(e))).path:(t=Gi.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===je.file?t=nt.file(wQ(Pc(e))).path:t=Gi.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!mz(e.authority,t.authority))return;if(e.scheme===je.file){const r=hme(Pc(e),Pc(t));return cr?aX(r):r}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(i.length,n.length);r<o&&!(i.charCodeAt(r)!==n.charCodeAt(r)&&i.charAt(r).toLowerCase()!==n.charAt(r).toLowerCase());r++);i=n.substr(0,r)+i.substr(r)}return Gi.relative(i,n)}resolvePath(e,t){if(e.scheme===je.file){const i=nt.file(cme(Pc(e),t));return e.with({authority:i.authority,path:i.path})}return t=V_e(t),e.with({path:Gi.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&zf(e,t)}hasTrailingPathSeparator(e,t=Xu){if(e.scheme===je.file){const i=Pc(e);return i.length>fz(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Xu){return pz(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Xu){let i=!1;if(e.scheme===je.file){const n=Pc(e);i=n!==void 0&&n.length===fz(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!pz(e,t)?e.with({path:e.path+"/"}):e}}const ui=new H_e(()=>!1),z_e=ui.isEqual.bind(ui);ui.isEqualOrParent.bind(ui);ui.getComparisonKey.bind(ui);ui.basenameOrAuthority.bind(ui);const G7=ui.basename.bind(ui);ui.extname.bind(ui);const U_e=ui.dirname.bind(ui),j_e=ui.joinPath.bind(ui),$_e=ui.normalizePath.bind(ui);ui.relativePath.bind(ui);const gz=ui.resolvePath.bind(ui);ui.isAbsolutePath.bind(ui);const mz=ui.isEqualAuthority.bind(ui),pz=ui.hasTrailingPathSeparator.bind(ui);ui.removeTrailingPathSeparator.bind(ui);ui.addTrailingPathSeparator.bind(ui);var tk;(function(s){s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&i.set(a,l)});const r=t.path.substring(0,t.path.indexOf(";"));return r&&i.set(s.META_DATA_MIME,r),i}s.parseMetaData=e})(tk||(tk={}));const Ks=tt("logService"),q_e=tt("loggerService");var yn;(function(s){s[s.Off=0]="Off",s[s.Trace=1]="Trace",s[s.Debug=2]="Debug",s[s.Info=3]="Info",s[s.Warning=4]="Warning",s[s.Error=5]="Error"})(yn||(yn={}));const lX=yn.Info;function G_e(s,e){return s!==yn.Off&&s<=e}class cX extends ne{constructor(){super(...arguments),this.level=lX,this._onDidChangeLogLevel=this._register(new $)}get onDidChangeLogLevel(){return this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return G_e(this.level,e)}canLog(e){return this._store.isDisposed?!1:this.checkLogLevel(e)}}class K_e extends cX{constructor(e=lX,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.canLog(yn.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.canLog(yn.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.canLog(yn.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.canLog(yn.Warning)&&(this.useColors?console.warn("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.canLog(yn.Error)&&(this.useColors?console.error("%c  ERR","color: #f33",e,...t):console.error(e,...t))}}class Y_e extends cX{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class Q_e extends ne{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new ls,this._onDidChangeLoggers=this._register(new $),this._onDidChangeVisibility=this._register(new $),i)for(const n of i)this._loggers.set(n.resource,{logger:void 0,info:n})}getLoggerEntry(e){return Pn(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}createLogger(e,t){var l;const i=this.toResource(e),n=Pn(e)?e:(t==null?void 0:t.id)??N7(i.toString()).toString(16);let r=(l=this._loggers.get(i))==null?void 0:l.logger;const o=(t==null?void 0:t.logLevel)==="always"?yn.Trace:t==null?void 0:t.logLevel;r||(r=this.doCreateLogger(i,o??this.getLogLevel(i)??this.logLevel,{...t,id:n}));const a={logger:r,info:{resource:i,id:n,logLevel:o,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,group:t==null?void 0:t.group,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(i,a),r}toResource(e){return Pn(e)?j_e(this.logsHome,`${e}.log`):e}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){var i;let t;return e&&(t=(i=this._loggers.get(e))==null?void 0:i.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}class X_e{constructor(){this.onDidChangeLogLevel=new $().event}setLevel(e){}getLevel(){return yn.Info}trace(e,...t){}debug(e,...t){}info(e,...t){}warn(e,...t){}error(e,...t){}dispose(){}}class Z_e extends Q_e{constructor(){super(yn.Off,nt.parse("log:///log"))}doCreateLogger(e,t,i){return new X_e}}function J_e(s){switch(s){case yn.Trace:return"trace";case yn.Debug:return"debug";case yn.Info:return"info";case yn.Warning:return"warn";case yn.Error:return"error";case yn.Off:return"off"}}new Ne("logLevel",J_e(yn.Info));const EC=class EC{static getRegisteredCommands(){return[...EC.REGISTERED_COMMANDS]}static registerCommand(e){EC.REGISTERED_COMMANDS.add(e)}};EC.REGISTERED_COMMANDS=new Set;let x4=EC;class _D{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata,this.canTriggerInlineEdits=e.canTriggerInlineEdits}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=ft.and(i,this.precondition):i=this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};vd.registerKeybindingRule(n)}}dr.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata}),this.canTriggerInlineEdits&&x4.registerCommand(this.id)}_registerMenuItem(e){u1.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class K7 extends _D{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((r,o)=>o.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===i){this._implementations.splice(r,1);return}}}}runCommand(e,t){const i=e.get(Ks),n=e.get(St);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const r of this._implementations){if(r.when){const a=n.getContext(Ln());if(!r.when.evaluate(a))continue}const o=r.implementation(e,t);if(o)return i.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof o=="boolean"?void 0:o}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class hX extends _D{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class zg extends _D{static bindToContribution(e){return class extends zg{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,r){const o=e(n);o&&this._callback(o,r)}}}static runEditorCommand(e,t,i,n){const r=e.get(fn),o=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(o)return o.invokeWithinContext(a=>{if(a.get(St).contextMatchesRules(i??void 0))return n(a,o,t)})}runCommand(e,t){return zg.runEditorCommand(e,t,this.precondition,(i,n,r)=>this.runEditorCommand(i,n,r))}}function Ke(s){return Il.INSTANCE.registerEditorCommand(s),s}function uX(s,e,t){Il.INSTANCE.registerEditorContribution(s,e,t)}var L_;(function(s){function e(o){return Il.INSTANCE.getEditorCommand(o)}s.getEditorCommand=e;function t(){return Il.INSTANCE.getEditorActions()}s.getEditorActions=t;function i(){return Il.INSTANCE.getEditorContributions()}s.getEditorContributions=i;function n(o){return Il.INSTANCE.getEditorContributions().filter(a=>o.indexOf(a.id)>=0)}s.getSomeEditorContributions=n;function r(){return Il.INSTANCE.getDiffEditorContributions()}s.getDiffEditorContributions=r})(L_||(L_={}));const e1e={EditorCommonContributions:"editor.contributions"},WE=class WE{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};WE.INSTANCE=new WE;let Il=WE;Fn.add(e1e.EditorCommonContributions,Il.INSTANCE);function Pv(s){return s.register(),s}const dX=Pv(new K7({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:rn.MenubarEditMenu,group:"1_do",title:w(69,"&&Undo"),order:1},{menuId:rn.CommandPalette,group:"",title:w(70,"Undo"),order:1},{menuId:rn.SimpleEditorContext,group:"1_do",title:w(71,"Undo"),order:1}]}));Pv(new hX(dX,{id:"default:undo",precondition:void 0}));const fX=Pv(new K7({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:rn.MenubarEditMenu,group:"1_do",title:w(72,"&&Redo"),order:2},{menuId:rn.CommandPalette,group:"",title:w(73,"Redo"),order:1},{menuId:rn.SimpleEditorContext,group:"1_do",title:w(74,"Redo"),order:2}]}));Pv(new hX(fX,{id:"default:redo",precondition:void 0}));const t1e=Pv(new K7({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:rn.MenubarSelectionMenu,group:"1_basic",title:w(75,"&&Select All"),order:1},{menuId:rn.CommandPalette,group:"",title:w(76,"Select All"),order:1},{menuId:rn.SimpleEditorContext,group:"9_select",title:w(77,"Select All"),order:1}]})),_z="default",i1e="$initialize";let bz=!1;function L4(s){Fh&&(bz||(bz=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(s.message))}class n1e{constructor(e,t,i,n,r){this.vsWorker=e,this.req=t,this.channel=i,this.method=n,this.args=r,this.type=0}}class Cz{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class s1e{constructor(e,t,i,n,r){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=n,this.arg=r,this.type=2}}class r1e{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class o1e{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class a1e{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}async sendMessage(e,t,i){const n=String(++this._lastSentReq);return new Promise((r,o)=>{this._pendingReplies[n]={resolve:r,reject:o},this._send(new n1e(this._workerId,n,e,t,i))})}listen(e,t,i){let n=null;const r=new $({onWillAddFirstListener:()=>{n=String(++this._lastSentReq),this._pendingEmitters.set(n,r),this._send(new s1e(this._workerId,n,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(n),this._send(new o1e(this._workerId,n)),n=null}});return r.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(n,r)=>(typeof r=="string"&&!n[r]&&(mX(r)?n[r]=o=>this.listen(e,r,o):gX(r)?n[r]=this.listen(e,r,void 0):r.charCodeAt(0)===36&&(n[r]=async(...o)=>(await(t==null?void 0:t()),this.sendMessage(e,r,o)))),n[r])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;if(e.err.$isError){const n=new Error;n.name=e.err.name,n.message=e.err.message,n.stack=e.err.stack,i=n}t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(n=>{this._send(new Cz(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=$A(n.detail)),this._send(new Cz(this._workerId,t,void 0,$A(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(n=>{this._send(new r1e(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++){const n=e.args[i];n instanceof ArrayBuffer&&t.push(n)}else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class l1e extends ne{constructor(e){super(),this._localChannels=new Map,this._worker=this._register(e),this._register(this._worker.onMessage(t=>{this._protocol.handleMessage(t)})),this._register(this._worker.onError(t=>{L4(t),It(t)})),this._protocol=new a1e({sendMessage:(t,i)=>{this._worker.postMessage(t,i)},handleMessage:(t,i,n)=>this._handleMessage(t,i,n),handleEvent:(t,i,n)=>this._handleEvent(t,i,n)}),this._protocol.setWorkerId(this._worker.getId()),this._onModuleLoaded=this._protocol.sendMessage(_z,i1e,[this._worker.getId()]).then(()=>{}),this.proxy=this._protocol.createProxyToRemoteChannel(_z,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(t=>{this._onError("Worker failed to load ",t)})}_handleMessage(e,t,i){const n=this._localChannels.get(e);if(!n)return Promise.reject(new Error(`Missing channel ${e} on main thread`));const r=n[t];if(typeof r!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(r.apply(n,i))}catch(o){return Promise.reject(o)}}_handleEvent(e,t,i){const n=this._localChannels.get(e);if(!n)throw new Error(`Missing channel ${e} on main thread`);if(mX(t)){const r=n[t];if(typeof r!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);const o=r.call(n,i);if(typeof o!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return o}if(gX(t)){const r=n[t];if(typeof r!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return r}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function gX(s){return s[0]==="o"&&s[1]==="n"&&Su(s.charCodeAt(2))}function mX(s){return/^onDynamic/.test(s)&&Su(s.charCodeAt(9))}function yd(s,e){var i;const t=k7();if(t!=null&&t.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(s,e)}catch(n){It(n);return}try{return(i=globalThis.trustedTypes)==null?void 0:i.createPolicy(s,e)}catch(n){It(n);return}}let Vp;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?Vp=globalThis.workerttPolicy:Vp=yd("defaultWorkerFactory",{createScriptURL:s=>s});function c1e(s,e){const t=s.label||"anonymous"+e,i=k7();if(i){if(typeof i.getWorker=="function")return i.getWorker("workerMain.js",t);if(typeof i.getWorkerUrl=="function"){const r=i.getWorkerUrl("workerMain.js",t);return new Worker(Vp?Vp.createScriptURL(r):r,{name:t,type:"module"})}}const n=s.esmModuleLocation;if(n){const r=h1e(t,n.toString(!0)),o=new Worker(Vp?Vp.createScriptURL(r):r,{name:t,type:"module"});return u1e(o)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function h1e(s,e){if(!(/^((http:)|(https:)|(file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const i=e.lastIndexOf("?"),n=e.lastIndexOf("#",i),r=i>0?new URLSearchParams(e.substring(i+1,~n?n:void 0)):new URLSearchParams;c4.addSearchParam(r,!0,!0),r.toString()?e=`${e}?${r.toString()}#${s}`:e=`${e}#${s}`}const t=new Blob([i7([`/*${s}*/`,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(iQ())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(a7())};`,`globalThis._VSCODE_FILE_ROOT = ${JSON.stringify(globalThis._VSCODE_FILE_ROOT)};`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL(${JSON.stringify(e)}) ?? ${JSON.stringify(e)});`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${s}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(t)}function u1e(s){return new Promise((e,t)=>{s.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(s.onmessage=null,e(s))},s.onerror=t})}function d1e(s){return!!s&&typeof s.then=="function"}const HE=class HE extends ne{constructor(e){super(),this._onMessage=this._register(new $),this.onMessage=this._onMessage.event,this._onError=this._register(new $),this.onError=this._onError.event,this.id=++HE.LAST_WORKER_ID;const t=e instanceof Worker||"then"in e?e:c1e(e,this.id);d1e(t)?this.worker=t:this.worker=Promise.resolve(t),this.postMessage("-please-ignore-",[]);const i=n=>{this._onError.fire(n)};this.worker.then(n=>{n.onmessage=r=>{this._onMessage.fire(r.data)},n.onmessageerror=r=>{this._onError.fire(r)},typeof n.addEventListener=="function"&&n.addEventListener("error",i)}),this._register(Fe(()=>{var n;(n=this.worker)==null||n.then(r=>{r.onmessage=null,r.onmessageerror=null,r.removeEventListener("error",i),r.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)==null||i.then(n=>{try{n.postMessage(e,t)}catch(r){It(r),It(new Error("FAILED to post message to worker",{cause:r}))}})}};HE.LAST_WORKER_ID=0;let k4=HE;class f1e{constructor(e,t){this.esmModuleLocation=e,this.label=t}}function g1e(s,e){const t=nt.isUri(s)?new f1e(s,e):s;return new l1e(new k4(t))}var Hs;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(Hs||(Hs={}));class ZI{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class m1e{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)Qb(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Qb(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Qb(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Qb(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Qb(this.autoClosingPairsCloseSingleChar,t.close,t)}}function Qb(s,e,t){s.has(e)?s.get(e).push(t):s.set(e,[t])}const r_=class r_{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new ZI(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new ZI({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new ZI({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:r_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:r_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};r_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`,r_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;let E4=r_;function qf(s,e){const t=s.getCount(),i=s.findTokenIndexAtOffset(e),n=s.getLanguageId(i);let r=i;for(;r+1<t&&s.getLanguageId(r+1)===n;)r++;let o=i;for(;o>0&&s.getLanguageId(o-1)===n;)o--;return new p1e(s,n,o,r+1,s.getStartOffset(o),s.getEndOffset(r))}class p1e{constructor(e,t,i,n,r,o){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=r,this._lastCharOffset=o,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function _l(s){return(s&3)!==0}let JI;function pX(){return JI||(JI=new TextDecoder("UTF-16LE")),JI}let eR;function _1e(){return eR||(eR=new TextDecoder("UTF-16BE")),eR}let tR;function _X(){return tR||(tR=zfe()?pX():_1e()),tR}function b1e(s,e,t){const i=new Uint16Array(s.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?C1e(s,e,t):pX().decode(i)}function C1e(s,e,t){const i=[];let n=0;for(let r=0;r<t;r++){const o=hpe(s,e);e+=2,i[n++]=String.fromCharCode(o)}return i.join("")}class z1{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return _X().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||hn(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class ik{constructor(e,t,i,n,r,o){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=r,this.reversedRegex=o,this._openSet=ik._toSet(this.open),this._closeSet=ik._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function w1e(s){const e=s.length;s=s.map(o=>[o[0].toLowerCase(),o[1].toLowerCase()]);const t=[];for(let o=0;o<e;o++)t[o]=o;const i=(o,a)=>{const[l,c]=o,[u,d]=a;return l===u||l===d||c===u||c===d},n=(o,a)=>{const l=Math.min(o,a),c=Math.max(o,a);for(let u=0;u<e;u++)t[u]===c&&(t[u]=l)};for(let o=0;o<e;o++){const a=s[o];for(let l=o+1;l<e;l++){const c=s[l];i(a,c)&&n(t[o],t[l])}}const r=[];for(let o=0;o<e;o++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===o){const[u,d]=s[c];a.push(u),l.push(d)}a.length>0&&r.push({open:a,close:l})}return r}class v1e{constructor(e,t){this._richEditBracketsBrand=void 0;const i=w1e(t);this.brackets=i.map((n,r)=>new ik(e,r,n.open,n.close,y1e(n.open,n.close,i,r),S1e(n.open,n.close,i,r))),this.forwardRegex=x1e(this.brackets),this.reversedRegex=L1e(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const r of n.open)this.textIsBracket[r]=n,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(const r of n.close)this.textIsBracket[r]=n,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}}function bX(s,e,t,i){for(let n=0,r=e.length;n<r;n++){if(n===t)continue;const o=e[n];for(const a of o.open)a.indexOf(s)>=0&&i.push(a);for(const a of o.close)a.indexOf(s)>=0&&i.push(a)}}function CX(s,e){return s.length-e.length}function bD(s){if(s.length<=1)return s;const e=[],t=new Set;for(const i of s)t.has(i)||(e.push(i),t.add(i));return e}function y1e(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let r=0,o=n.length;r<o;r++)bX(n[r],t,i,n);return n=bD(n),n.sort(CX),n.reverse(),Fv(n)}function S1e(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let r=0,o=n.length;r<o;r++)bX(n[r],t,i,n);return n=bD(n),n.sort(CX),n.reverse(),Fv(n.map(Y7))}function x1e(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=bD(e),Fv(e)}function L1e(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=bD(e),Fv(e.map(Y7))}function k1e(s){const e=/^[\w ]+$/.test(s);return s=Yl(s),e?`\\b${s}\\b`:s}function Fv(s,e){const t=`(${s.map(k1e).join(")|(")})`;return DQ(t,!0,e)}const Y7=(function(){function s(i){const n=new Uint16Array(i.length);let r=0;for(let o=i.length-1;o>=0;o--)n[r++]=i.charCodeAt(o);return _X().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=s(e)),t}})();class ta{static _findPrevBracketInText(e,t,i,n){const r=i.match(e);if(!r)return null;const o=i.length-(r.index||0),a=r[0].length,l=n+o;return new H(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,r){const a=Y7(i).substring(i.length-r,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){const r=i.match(e);if(!r)return null;const o=r.index||0,a=r[0].length;if(a===0)return null;const l=n+o;return new H(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,r){const o=i.substring(n,r);return this.findNextBracketInText(e,t,o,n)}}class E1e{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const n=i.charAt(i.length-1);e.push(n)}return Ag(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const n=t.findTokenIndexAtOffset(i-1);if(_l(t.getStandardTokenType(n)))return null;const r=this._richEditBrackets.reversedRegex,o=t.getLineContent().substring(0,i-1)+e,a=ta.findPrevBracketInRange(r,1,o,0,o.length);if(!a)return null;const l=o.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const u=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(u)?{matchOpenBracket:l}:null}}function BS(s){return s.global&&(s.lastIndex=0),!0}class D1e{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&BS(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&BS(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&BS(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&BS(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class Wp{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=Wp._createOpenBracketRegExp(t[0]),n=Wp._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let r=0,o=this._regExpRules.length;r<o;r++){const a=this._regExpRules[r];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let r=0,o=this._brackets.length;r<o;r++){const a=this._brackets[r];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:Hs.IndentOutdent}}if(e>=2&&i.length>0){for(let r=0,o=this._brackets.length;r<o;r++)if(this._brackets[r].openRegExp.test(i))return{indentAction:Hs.Indent}}return null}static _createOpenBracketRegExp(e){let t=Yl(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",Wp._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Yl(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,Wp._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return It(t),null}}}const ai=tt("configurationService");function D4(s,e){const t=Object.create(null);for(const i in s)wX(t,i,s[i],e);return t}function wX(s,e,t,i){const n=e.split("."),r=n.pop();let o=s;for(let a=0;a<n.length;a++){const l=n[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[r]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}function T1e(s,e){const t=e.split(".");vX(s,t)}function vX(s,e){if(!s)return;const t=e.shift();if(e.length===0){delete s[t];return}if(Object.keys(s).indexOf(t)!==-1){const i=s[t];typeof i=="object"&&!Array.isArray(i)&&(vX(i,e),Object.keys(i).length===0&&delete s[t])}}function wz(s,e,t){function i(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=e.split("."),r=i(s,n);return typeof r>"u"?t:r}function N1e(s){return s.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}const En=tt("languageService");class Dl{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const yX=[];function ut(s,e,t){e instanceof Dl||(e=new Dl(e,[],!!t)),yX.push([s,e])}function vz(){return yX}const ch=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),CD={JSONContribution:"base.contributions.json"};function I1e(s){return s.length>0&&s.charAt(s.length-1)==="#"?s.substring(0,s.length-1):s}class R1e extends ne{constructor(){super(...arguments),this.schemasById={},this._onDidChangeSchema=this._register(new $)}registerSchema(e,t,i){const n=I1e(e);this.schemasById[n]=t,this._onDidChangeSchema.fire(e),i&&i.add(Fe(()=>{delete this.schemasById[n],this._onDidChangeSchema.fire(e)}))}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const A1e=new R1e;Fn.add(CD.JSONContribution,A1e);let Hr;const iR=globalThis.vscode;if(typeof iR<"u"&&typeof iR.context<"u"){const s=iR.context.configuration();if(s)Hr=s.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Hr=globalThis._VSCODE_PRODUCT_JSON,GL.VSCODE_DEV&&Object.assign(Hr,{nameShort:`${Hr.nameShort} Dev`,nameLong:`${Hr.nameLong} Dev`,dataFolderName:`${Hr.dataFolderName}-dev`,serverDataFolderName:Hr.serverDataFolderName?`${Hr.serverDataFolderName}-dev`:void 0}),!Hr.version){const s=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Hr,{version:s.version})}}else Hr={},Object.keys(Hr).length===0&&Object.assign(Hr,{version:"1.104.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var nR=Hr;const hm={Configuration:"base.contributions.configuration"},VS="vscode://schemas/settings/resourceLanguage",yz=Fn.as(CD.JSONContribution);class M1e extends ne{constructor(){super(),this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=this._register(new $),this._onDidUpdateConfiguration=this._register(new $),this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:w(1664,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},yz.registerSchema(VS,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),yz.registerSchema(VS,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:n,source:r}of e)for(const o in n){t.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o),l=n[o];if(a.configurationDefaultOverrides.push({value:l,source:r}),ud.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,r,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(o,c,r),i.push(...nk(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,r,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const u=this.configurationProperties[o];u&&(this.updatePropertyDefaultValue(o,u),this.updateSchema(o,u))}}this.doRegisterOverrideIdentifiers(i)}updateDefaultOverrideProperty(e,t,i){const n={section:{id:this.defaultLanguageConfigurationOverridesNode.id,title:this.defaultLanguageConfigurationOverridesNode.title,order:this.defaultLanguageConfigurationOverridesNode.order,extensionInfo:this.defaultLanguageConfigurationOverridesNode.extensionInfo},type:"object",default:t.value,description:w(1665,"Configure settings to be overridden for {0}.",N1e(e)),$ref:VS,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){const r=(n==null?void 0:n.value)||{},o=(n==null?void 0:n.source)??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(Vs(l)&&(to(r[a])||Vs(r[a]))){if(r[a]={...r[a]??{},...l},i)for(const u in l)o.set(`${a}.${u}`,i)}else r[a]=l,i?o.set(a,i):o.delete(a)}return{value:r,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){const r=this.configurationProperties[e],o=(n==null?void 0:n.value)??(r==null?void 0:r.defaultDefaultValue);let a=i;if(Vs(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(to(o)||Vs(o)))){if(a=(n==null?void 0:n.source)??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...Vs(o)?o:{},...t}}return{value:t,source:a}}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}validateAndRegisterProperties(e,t=!0,i,n,r=4,o){var c,u,d;r=Ro(e.scope)?r:e.scope;const a=e.properties;if(a)for(const g in a){const p=a[g];if(p.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo},t&&F1e(g,p,i==null?void 0:i.id)){delete a[g];continue}p.source=i,p.defaultDefaultValue=a[g].default,this.updatePropertyDefaultValue(g,p),ud.test(g)?p.scope=void 0:(p.scope=Ro(p.scope)?r:p.scope,p.restricted=Ro(p.restricted)?!!(n!=null&&n.includes(g)):p.restricted),p.experiment?(c=p.tags)!=null&&c.some(v=>v.toLowerCase()==="onexp")||(p.tags=p.tags??[],p.tags.push("onExP")):(u=p.tags)!=null&&u.some(v=>v.toLowerCase()==="onexp")&&(console.error(`Invalid tag 'onExP' found for property '${g}'. Please use 'experiment' property instead.`),p.experiment={mode:"startup"});const _=a[g].hasOwnProperty("included")&&!a[g].included,C=(d=a[g].policy)==null?void 0:d.name;_?(this.excludedConfigurationProperties[g]=a[g],C&&(this.policyConfigurations.set(C,g),o.add(g)),delete a[g]):(o.add(g),C&&this.policyConfigurations.set(C,g),this.configurationProperties[g]=a[g],!a[g].deprecationMessage&&a[g].markdownDeprecationMessage&&(a[g].deprecationMessage=a[g].markdownDeprecationMessage))}const l=e.allOf;if(l)for(const g of l)this.validateAndRegisterProperties(g,t,i,n,r,o)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const o in n)this.updateSchema(o,n[o]);const r=i.allOf;r==null||r.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 3:break;case 7:break;case 4:break;case 5:break;case 6:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:w(1666,"Configure editor settings to be overridden for a language."),errorMessage:w(1667,"This setting does not support per-language configuration."),$ref:VS};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){w(1668,"Configure editor settings to be overridden for a language."),w(1669,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){var o;const i=(o=this.configurationDefaultsOverrides.get(e))==null?void 0:o.configurationDefaultOverrideValue;let n,r;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,r=i.source),to(n)&&(n=t.defaultDefaultValue,r=void 0),to(n)&&(n=P1e(t.type)),t.default=n,t.defaultValueSource=r}}const SX="\\[([^\\]]+)\\]",Sz=new RegExp(SX,"g"),O1e=`^(${SX})+$`,ud=new RegExp(O1e);function nk(s){const e=[];if(ud.test(s)){let t=Sz.exec(s);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=Sz.exec(s)}}return Ag(e)}function P1e(s){switch(Array.isArray(s)?s[0]:s){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const Fx=new M1e;Fn.add(hm.Configuration,Fx);function F1e(s,e,t){var i,n,r,o;return s.trim()?ud.test(s)?w(1671,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",s):Fx.getConfigurationProperties()[s]!==void 0&&(!t||!B1e.has(t.toLowerCase()))?w(1672,"Cannot register '{0}'. This property is already registered.",s):(i=e.policy)!=null&&i.name&&Fx.getPolicyConfigurations().get((n=e.policy)==null?void 0:n.name)!==void 0?w(1673,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",s,(r=e.policy)==null?void 0:r.name,Fx.getPolicyConfigurations().get((o=e.policy)==null?void 0:o.name)):null:w(1670,"Cannot register an empty property")}const B1e=new Set(nR.defaultChatAgent?[nR.defaultChatAgent.extensionId,nR.defaultChatAgent.chatExtensionId].map(s=>s.toLowerCase()):[]),V1e={ModesRegistry:"editor.modesRegistry"};class W1e extends ne{constructor(){super(),this._onDidChangeLanguages=this._register(new $),this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const d1=new W1e;Fn.add(V1e.ModesRegistry,d1);const da="plaintext",H1e=".txt";d1.registerLanguage({id:da,extensions:[H1e],aliases:[w(784,"Plain Text"),"text"],mimetypes:[ch.text]});Fn.as(hm.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);class z1e{constructor(e,t){this.languageId=e;const i=t.brackets?xz(t.brackets):[],n=new MH(a=>{const l=new Set;return{info:new U1e(this,a,l),closing:l}}),r=new MH(a=>{const l=new Set,c=new Set;return{info:new j1e(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=n.get(a),u=r.get(l);c.closing.add(u.info),u.opening.add(c.info)}const o=t.colorizedBracketPairs?xz(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of o){const c=n.get(a),u=r.get(l);c.closing.add(u.info),u.openingColorized.add(c.info),u.opening.add(c.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){const t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Fv(t,e)}}function xz(s){return s.filter(([e,t])=>e!==""&&t!=="")}class xX{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class U1e extends xX{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class j1e extends xX{constructor(e,t,i,n){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=n,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var $1e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Lz=function(s,e){return function(t,i){e(t,i,s)}};class sR{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const rc=tt("languageConfigurationService");let T4=class extends ne{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new Y1e),this.onDidChangeEmitter=this._register(new $),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(N4));this._register(this.configurationService.onDidChangeConfiguration(n=>{const r=n.change.keys.some(a=>i.has(a)),o=n.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(r)this.configurations.clear(),this.onDidChangeEmitter.fire(new sR(void 0));else for(const a of o)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new sR(a)))})),this._register(this._registry.onDidChange(n=>{this.configurations.delete(n.languageId),this.onDidChangeEmitter.fire(new sR(n.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=q1e(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};T4=$1e([Lz(0,ai),Lz(1,En)],T4);function q1e(s,e,t,i){let n=e.getLanguageConfiguration(s);if(!n){if(!i.isRegisteredLanguageId(s))return new k_(s,{});n=new k_(s,{})}const r=G1e(n.languageId,t),o=kX([n.underlyingConfig,r]);return new k_(n.languageId,o)}const N4={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function G1e(s,e){const t=e.getValue(N4.brackets,{overrideIdentifier:s}),i=e.getValue(N4.colorizedBracketPairs,{overrideIdentifier:s});return{brackets:kz(t),colorizedBracketPairs:kz(i)}}function kz(s){if(Array.isArray(s))return s.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function LX(s,e,t){const i=s.getLineContent(e);let n=Os(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}class K1e{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new Ez(e,t,++this._order);return this._entries.push(i),this._resolved=null,Fe(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new k_(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Ez.cmp),kX(this._entries.map(e=>e.configuration)))}}function kX(s){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of s)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class Ez{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class Dz{constructor(e){this.languageId=e}}class Y1e extends ne{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this._register(this.register(da,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new K1e(e),this._entries.set(e,n));const r=n.register(t,i);return this._onDidChange.fire(new Dz(e)),Fe(()=>{r.dispose(),this._onDidChange.fire(new Dz(e))})}getLanguageConfiguration(e){const t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}}class k_{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Wp(this.underlyingConfig):null,this.comments=k_._handleComments(this.underlyingConfig),this.characterPair=new E4(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||f7,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new D1e(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new z1e(e,this.underlyingConfig)}getWordDefinition(){return g7(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new v1e(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new E1e(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new m1e(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(typeof t.lineComment=="string"?i.lineCommentToken=t.lineComment:(i.lineCommentToken=t.lineComment.comment,i.lineCommentNoIndent=t.lineComment.noIndent)),t.blockComment){const[n,r]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=r}return i}}ut(rc,T4,1);class wu{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class Tz{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function Q1e(s,e,t){return new hh(new Tz(s),new Tz(e)).ComputeDiff(t).changes}class fp{static Assert(e,t){if(!e)throw new Error(t)}}class gp{static Copy(e,t,i,n,r){for(let o=0;o<r;o++)i[n+o]=e[t+o]}static Copy2(e,t,i,n,r){for(let o=0;o<r;o++)i[n+o]=e[t+o]}}class Nz{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new wu(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class hh{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,r,o]=hh._getElements(e),[a,l,c]=hh._getElements(t);this._hasStrings=o&&c,this._originalStringElements=n,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(hh._isStringArray(t)){const i=new Int32Array(t.length);for(let n=0,r=t.length;n<r;n++)i[n]=I7(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=hh._getStrictElement(this._originalSequence,e),n=hh._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,r){const o=[!1];let a=this.ComputeDiffRecursive(e,t,i,n,o);return r&&(a=this.PrettifyChanges(a)),{quitEarly:o[0],changes:a}}ComputeDiffRecursive(e,t,i,n,r){for(r[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let d;return i<=n?(fp.Assert(e===t+1,"originalStart should only be one more than originalEnd"),d=[new wu(e,0,i,n-i+1)]):e<=t?(fp.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),d=[new wu(e,t-e+1,i,0)]):(fp.Assert(e===t+1,"originalStart should only be one more than originalEnd"),fp.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),d=[]),d}const o=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,o,a,r),c=o[0],u=a[0];if(l!==null)return l;if(!r[0]){const d=this.ComputeDiffRecursive(e,c,i,u,r);let g=[];return r[0]?g=[new wu(c+1,t-(c+1)+1,u+1,n-(u+1)+1)]:g=this.ComputeDiffRecursive(c+1,t,u+1,n,r),this.ConcatenateChanges(d,g)}return[new wu(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,r,o,a,l,c,u,d,g,p,_,C,v,x,S){let k=null,E=null,T=new Nz,R=t,N=i,A=p[0]-v[0]-n,O=-1073741824,W=this.m_forwardHistory.length-1;do{const j=A+e;j===R||j<N&&c[j-1]<c[j+1]?(d=c[j+1],_=d-A-n,d<O&&T.MarkNextChange(),O=d,T.AddModifiedElement(d+1,_),A=j+1-e):(d=c[j-1]+1,_=d-A-n,d<O&&T.MarkNextChange(),O=d-1,T.AddOriginalElement(d,_+1),A=j-1-e),W>=0&&(c=this.m_forwardHistory[W],e=c[0],R=1,N=c.length-1)}while(--W>=-1);if(k=T.getReverseChanges(),S[0]){let j=p[0]+1,F=v[0]+1;if(k!==null&&k.length>0){const q=k[k.length-1];j=Math.max(j,q.getOriginalEnd()),F=Math.max(F,q.getModifiedEnd())}E=[new wu(j,g-j+1,F,C-F+1)]}else{T=new Nz,R=o,N=a,A=p[0]-v[0]-l,O=1073741824,W=x?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const j=A+r;j===R||j<N&&u[j-1]>=u[j+1]?(d=u[j+1]-1,_=d-A-l,d>O&&T.MarkNextChange(),O=d+1,T.AddOriginalElement(d+1,_+1),A=j+1-r):(d=u[j-1],_=d-A-l,d>O&&T.MarkNextChange(),O=d,T.AddModifiedElement(d+1,_+1),A=j-1-r),W>=0&&(u=this.m_reverseHistory[W],r=u[0],R=1,N=u.length-1)}while(--W>=-1);E=T.getChanges()}return this.ConcatenateChanges(k,E)}ComputeRecursionPoint(e,t,i,n,r,o,a){let l=0,c=0,u=0,d=0,g=0,p=0;e--,i--,r[0]=0,o[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const _=t-e+(n-i),C=_+1,v=new Int32Array(C),x=new Int32Array(C),S=n-i,k=t-e,E=e-i,T=t-n,N=(k-S)%2===0;v[S]=e,x[k]=t,a[0]=!1;for(let A=1;A<=_/2+1;A++){let O=0,W=0;u=this.ClipDiagonalBound(S-A,A,S,C),d=this.ClipDiagonalBound(S+A,A,S,C);for(let F=u;F<=d;F+=2){F===u||F<d&&v[F-1]<v[F+1]?l=v[F+1]:l=v[F-1]+1,c=l-(F-S)-E;const q=l;for(;l<t&&c<n&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(v[F]=l,l+c>O+W&&(O=l,W=c),!N&&Math.abs(F-k)<=A-1&&l>=x[F])return r[0]=l,o[0]=c,q<=x[F]&&A<=1448?this.WALKTRACE(S,u,d,E,k,g,p,T,v,x,l,t,r,c,n,o,N,a):null}const j=(O-e+(W-i)-A)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(O,j))return a[0]=!0,r[0]=O,o[0]=W,j>0&&A<=1448?this.WALKTRACE(S,u,d,E,k,g,p,T,v,x,l,t,r,c,n,o,N,a):(e++,i++,[new wu(e,t-e+1,i,n-i+1)]);g=this.ClipDiagonalBound(k-A,A,k,C),p=this.ClipDiagonalBound(k+A,A,k,C);for(let F=g;F<=p;F+=2){F===g||F<p&&x[F-1]>=x[F+1]?l=x[F+1]-1:l=x[F-1],c=l-(F-k)-T;const q=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(x[F]=l,N&&Math.abs(F-S)<=A&&l<=v[F])return r[0]=l,o[0]=c,q>=v[F]&&A<=1448?this.WALKTRACE(S,u,d,E,k,g,p,T,v,x,l,t,r,c,n,o,N,a):null}if(A<=1447){let F=new Int32Array(d-u+2);F[0]=S-u+1,gp.Copy2(v,u,F,1,d-u+1),this.m_forwardHistory.push(F),F=new Int32Array(p-g+2),F[0]=k-g+1,gp.Copy2(x,g,F,1,p-g+1),this.m_reverseHistory.push(F)}}return this.WALKTRACE(S,u,d,E,k,g,p,T,v,x,l,t,r,c,n,o,N,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,o=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<r&&(!o||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,r=0;if(t>0){const d=e[t-1];n=d.originalStart+d.originalLength,r=d.modifiedStart+d.modifiedLength}const o=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let d=1;;d++){const g=i.originalStart-d,p=i.modifiedStart-d;if(g<n||p<r||o&&!this.OriginalElementsAreEqual(g,g+i.originalLength)||a&&!this.ModifiedElementsAreEqual(p,p+i.modifiedLength))break;const C=(g===n&&p===r?5:0)+this._boundaryScore(g,i.originalLength,p,i.modifiedLength);C>c&&(c=C,l=d)}i.originalStart-=l,i.modifiedStart-=l;const u=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],u)){e[t-1]=u[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const n=e[t-1],r=e[t],o=r.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=r.originalStart+r.originalLength,c=l-a,u=n.modifiedStart,d=r.modifiedStart+r.modifiedLength,g=d-u;if(o<5&&c<20&&g<20){const p=this._findBetterContiguousSequence(a,c,u,g,o);if(p){const[_,C]=p;(_!==n.originalStart+n.originalLength||C!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=_-n.originalStart,n.modifiedLength=C-n.modifiedStart,r.originalStart=_+o,r.modifiedStart=C+o,r.originalLength=l-r.originalStart,r.modifiedLength=d-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,r){if(t<r||n<r)return null;const o=e+t-r+1,a=i+n-r+1;let l=0,c=0,u=0;for(let d=e;d<o;d++)for(let g=i;g<a;g++){const p=this._contiguousSequenceScore(d,g,r);p>0&&p>l&&(l=p,c=d,u=g)}return l>0?[c,u]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let r=0;r<i;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;n+=this._originalStringElements[e+r].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){const r=this._OriginalRegionIsBoundary(e,t)?1:0,o=this._ModifiedRegionIsBoundary(i,n)?1:0;return r+o}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return gp.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],gp.Copy(t,1,n,e.length,t.length-1),n}else{const n=new Array(e.length+t.length);return gp.Copy(e,0,n,0,e.length),gp.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(fp.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),fp.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let r=e.originalLength;const o=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new wu(n,r,o,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const r=i,o=n-i-1,a=t%2===0;if(e<0){const l=r%2===0;return a===l?0:1}else{const l=o%2===0;return a===l?n-1:n-2}}}function sk(s){return s<0?0:s>255?255:s|0}function mp(s){return s<0?0:s>4294967295?4294967295:s|0}class Bv{constructor(e){const t=sk(e);this._defaultValue=t,this._asciiMap=Bv._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=sk(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class X1e{constructor(e,t,i){const n=new Uint8Array(e*t);for(let r=0,o=e*t;r<o;r++)n[r]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Z1e{constructor(e){let t=0,i=0;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new X1e(i,t,0);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let rR=null;function J1e(){return rR===null&&(rR=new Z1e([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),rR}let Xb=null;function ebe(){if(Xb===null){Xb=new Bv(0);const s=` 	<>'"|`;for(let t=0;t<s.length;t++)Xb.set(s.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)Xb.set(e.charCodeAt(t),2)}return Xb}class rk{static _createLink(e,t,i,n,r){let o=r-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=J1e()){const i=ebe(),n=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r),l=a.length;let c=0,u=0,d=0,g=1,p=!1,_=!1,C=!1,v=!1;for(;c<l;){let x=!1;const S=a.charCodeAt(c);if(g===13){let k;switch(S){case 40:p=!0,k=0;break;case 41:k=p?0:1;break;case 91:C=!0,_=!0,k=0;break;case 93:C=!1,k=_?0:1;break;case 123:v=!0,k=0;break;case 125:k=v?0:1;break;case 39:case 34:case 96:d===S?k=1:d===39||d===34||d===96?k=0:k=1;break;case 42:k=d===42?1:0;break;case 32:k=C?0:1;break;default:k=i.get(S)}k===1&&(n.push(rk._createLink(i,a,r,u,c)),x=!0)}else if(g===12){let k;S===91?(_=!0,k=0):k=i.get(S),k===1?x=!0:g=13}else g=t.nextState(g,S),g===0&&(x=!0);x&&(g=1,p=!1,_=!1,v=!1,u=c+1,d=S),c++}g===13&&n.push(rk._createLink(i,a,r,u,l))}return n}}function tbe(s){return!s||typeof s.getLineCount!="function"||typeof s.getLineContent!="function"?[]:rk.computeLinks(s)}const zE=class zE{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,r){if(e&&t){const o=this.doNavigateValueSet(t,r);if(o)return{range:e,value:o}}if(i&&n){const o=this.doNavigateValueSet(n,r);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const r=parseFloat(e);return!isNaN(n)&&!isNaN(r)&&n===r?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let r=0,o=e.length;n===null&&r<o;r++)n=this.valueSetReplace(e[r],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}};zE.INSTANCE=new zE;let I4=zE;const Vv={DateTimeFormat(s,e){return new Ws(()=>{try{return new Intl.DateTimeFormat(s,e)}catch{return new Intl.DateTimeFormat(void 0,e)}})},Collator(s,e){return new Ws(()=>{try{return new Intl.Collator(s,e)}catch{return new Intl.Collator(void 0,e)}})},Segmenter(s,e){return new Ws(()=>{try{return new Intl.Segmenter(s,e)}catch{return new Intl.Segmenter(void 0,e)}})},Locale(s,e){return new Ws(()=>{try{return new Intl.Locale(s,e)}catch{return new Intl.Locale(Hf,e)}})},NumberFormat(s,e){return new Ws(()=>{try{return new Intl.NumberFormat(s,e)}catch{return new Intl.NumberFormat(void 0,e)}})}};class ibe extends Bv{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=Vv.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.value.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const Iz=new Ov(10);function f1(s,e){const t=`${s}/${e.join(",")}`;let i=Iz.get(t);return i||(i=new ibe(s,e),Iz.set(t,i)),i}var ok;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(ok||(ok={}));var dd;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(dd||(dd={}));var no;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(no||(no={}));var g1;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(g1||(g1={}));class Bx{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&xr(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class Sw{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function nbe(s){return!!s&&typeof s.read=="function"}class oR{constructor(e,t,i,n,r,o){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=r,this._isTracked=o}}class sbe{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class rbe{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function obe(s){return!s.isTooLargeForSyncing()&&!s.isForSimpleWidget}const abe=999;class pp{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=EX(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=DQ(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new sbe(t,this.wordSeparators?f1(this.wordSeparators,[]):null,i?this.searchString:null)}}function EX(s){if(!s||s.length===0)return!1;for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=s.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function pf(s,e,t){if(!t)return new Sw(s,null);const i=[];for(let n=0,r=e.length;n<r;n++)i[n]=e[n];return new Sw(s,i)}class Rz{constructor(e){const t=[];let i=0;for(let n=0,r=e.length;n<r;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){const r=i+((n-i)/2>>0);t[r]>=e?n=r-1:t[r+1]>=e?(i=r,n=r):i=r+1}return i+1}}class WS{static findMatches(e,t,i,n,r){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,i,new Hp(o.wordSeparators,o.regex),n,r):this._doFindMatchesLineByLine(e,i,o,n,r):[]}static _getMultilineMatchRange(e,t,i,n,r,o){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let c;if(n){const p=n.findLineFeedCountBeforeOffset(r+o.length)-l;c=a+o.length+p}else c=a+o.length;const u=e.getPositionAt(a),d=e.getPositionAt(c);return new H(u.lineNumber,u.column,d.lineNumber,d.column)}static _doFindMatchesMultiline(e,t,i,n,r){const o=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new Rz(a):null,c=[];let u=0,d;for(i.reset(0);d=i.next(a);)if(c[u++]=pf(this._getMultilineMatchRange(e,o,a,l,d.index,d[0]),d,n),u>=r)return c;return c}static _doFindMatchesLineByLine(e,t,i,n,r){const o=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,o,n,r),o}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,o,n,r);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<r;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,o,n,r);if(a<r){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,o,n,r)}return o}static _findMatchesInLine(e,t,i,n,r,o,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const g=e.simpleSearch,p=g.length,_=t.length;let C=-p;for(;(C=t.indexOf(g,C+p))!==-1;)if((!c||Q7(c,t,_,C,p))&&(o[r++]=new Sw(new H(i,C+1+n,i,C+1+p+n),null),r>=l))return r;return r}const u=new Hp(e.wordSeparators,e.regex);let d;u.reset(0);do if(d=u.next(t),d&&(o[r++]=pf(new H(i,d.index+1+n,i,d.index+1+d[0].length+n),d,a),r>=l))return r;while(d);return r}static findNextMatch(e,t,i,n){const r=t.parseSearchRequest();if(!r)return null;const o=new Hp(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,i,o,n):this._doFindNextMatchLineByLine(e,i,o,n)}static _doFindNextMatchMultiline(e,t,i,n){const r=new Y(t.lineNumber,1),o=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new H(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new Rz(l):null;i.reset(t.column-1);const u=i.next(l);return u?pf(this._getMultilineMatchRange(e,o,l,c,u.index,u[0]),u,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new Y(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o),l=this._findFirstMatchInLine(i,a,o,t.column,n);if(l)return l;for(let c=1;c<=r;c++){const u=(o+c-1)%r,d=e.getLineContent(u+1),g=this._findFirstMatchInLine(i,d,u+1,1,n);if(g)return g}return null}static _findFirstMatchInLine(e,t,i,n,r){e.reset(n-1);const o=e.next(t);return o?pf(new H(i,o.index+1,i,o.index+1+o[0].length),o,r):null}static findPreviousMatch(e,t,i,n){const r=t.parseSearchRequest();if(!r)return null;const o=new Hp(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,i,o,n):this._doFindPreviousMatchLineByLine(e,i,o,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const r=this._doFindMatchesMultiline(e,new H(1,1,t.lineNumber,t.column),i,n,10*abe);if(r.length>0)return r[r.length-1];const o=e.getLineCount();return t.lineNumber!==o||t.column!==e.getLineMaxColumn(o)?this._doFindPreviousMatchMultiline(e,new Y(o,e.getLineMaxColumn(o)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,o,n);if(l)return l;for(let c=1;c<=r;c++){const u=(r+o-c-1)%r,d=e.getLineContent(u+1),g=this._findLastMatchInLine(i,d,u+1,n);if(g)return g}return null}static _findLastMatchInLine(e,t,i,n){let r=null,o;for(e.reset(0);o=e.next(t);)r=pf(new H(i,o.index+1,i,o.index+1+o[0].length),o,n);return r}}function lbe(s,e,t,i,n){if(i===0)return!0;const r=e.charCodeAt(i-1);if(s.get(r)!==0||r===13||r===10)return!0;if(n>0){const o=e.charCodeAt(i);if(s.get(o)!==0)return!0}return!1}function cbe(s,e,t,i,n){if(i+n===t)return!0;const r=e.charCodeAt(i+n);if(s.get(r)!==0||r===13||r===10)return!0;if(n>0){const o=e.charCodeAt(i+n-1);if(s.get(o)!==0)return!0}return!1}function Q7(s,e,t,i,n){return lbe(s,e,t,i,n)&&cbe(s,e,t,i,n)}class Hp{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,r=i[0].length;if(n===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){QL(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=r,!this._wordSeparators||Q7(this._wordSeparators,e,t,n,r))return i}while(i);return null}}class hbe{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,r=i?i.endLineNumber:e.getLineCount(),o=new Az(t),a=o.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${ube(Array.from(a))}`,"g");const c=new Hp(null,l),u=[];let d=!1,g,p=0,_=0,C=0;e:for(let v=n,x=r;v<=x;v++){const S=e.getLineContent(v),k=S.length;c.reset(0);do if(g=c.next(S),g){let E=g.index,T=g.index+g[0].length;if(E>0){const O=S.charCodeAt(E-1);hn(O)&&E--}if(T+1<k){const O=S.charCodeAt(T-1);hn(O)&&T++}const R=S.substring(E,T);let N=dw(E+1,f7,S,0);N&&N.endColumn<=E+1&&(N=null);const A=o.shouldHighlightNonBasicASCII(R,N?N.word:null);if(A!==0){if(A===3?p++:A===2?_++:A===1?C++:r7(),u.length>=1e3){d=!0;break e}u.push(new H(v,E+1,v,T+1))}}while(g)}return{ranges:u,hasMore:d,ambiguousCharacterCount:p,invisibleCharacterCount:_,nonBasicAsciiCharacterCount:C}}static computeUnicodeHighlightReason(e,t){const i=new Az(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const r=e.codePointAt(0),o=i.ambiguousCharacters.getPrimaryConfusable(r),a=mw.getLocales().filter(l=>!mw.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(r));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function ube(s,e){return`[${Yl(s.map(i=>String.fromCodePoint(i)).join(""))}]`}class Az{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=mw.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of W0.codePoints)Mz(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,r=!1;if(t)for(const o of t){const a=o.codePointAt(0),l=S7(o);n=n||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!W0.isInvisibleCharacter(a)&&(r=!0)}return!n&&r?0:this.options.invisibleCharacters&&!Mz(e)&&W0.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function Mz(s){return s===" "||s===`
`||s==="	"}class Vx{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class DX{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class Re{static fromTo(e,t){return new Re(e,t)}static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{const r=Math.min(e.start,t[i].start),o=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new Re(r,o))}}static tryCreate(e,t){if(!(e>t))return new Re(e,t)}static ofLength(e){return new Re(0,e)}static ofStartAndLength(e,t){return new Re(e,e+t)}static emptyAt(e){return new Re(e,e)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new Pe(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new Re(this.start+e,this.endExclusive+e)}deltaStart(e){return new Re(this.start+e,this.endExclusive)}deltaEnd(e){return new Re(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new Re(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new Re(t,i)}intersectionLength(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,i-t)}intersects(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}intersectsOrTouches(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<=i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Pe(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Pe(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}joinRightTouching(e){if(this.endExclusive!==e.start)throw new Pe(`Invalid join: ${this.toString()} and ${e.toString()}`);return new Re(this.start,e.endExclusive)}}class X7{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const n=Math.min(e.start,this._sortedRanges[t].start),r=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new Re(n,r))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new X7;for(const i of this._sortedRanges){const n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function ak(s,e,t=s.length-1){const i=dbe(s,e,t);if(i!==-1)return s[i]}function dbe(s,e,t=s.length-1){for(let i=t;i>=0;i--){const n=s[i];if(e(n,i))return i}return-1}function m1(s,e){const t=p1(s,e);return t===-1?void 0:s[t]}function p1(s,e,t=0,i=s.length){let n=t,r=i;for(;n<r;){const o=Math.floor((n+r)/2);e(s[o])?n=o+1:r=o}return n-1}function fbe(s,e){const t=R4(s,e);return t===s.length?void 0:s[t]}function R4(s,e,t=0,i=s.length){let n=t,r=i;for(;n<r;){const o=Math.floor((n+r)/2);e(s[o])?r=o:n=o+1}return n}const UE=class UE{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(UE.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=p1(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};UE.assertInvariants=!1;let lk=UE;function TX(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>0&&(t=n)}return t}function gbe(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>=0&&(t=n)}return t}function mbe(s,e){return TX(s,(t,i)=>-e(t,i))}function pbe(s,e){if(s.length===0)return-1;let t=0;for(let i=1;i<s.length;i++){const n=s[i];e(n,s[t])>0&&(t=i)}return t}const yo=class yo{static ofLength(e,t){return new yo(e,e+t)}static fromRange(e){return new yo(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new yo(e.startLineNumber,e.endLineNumber+1)}static joinMany(e){if(e.length===0)return[];let t=new Ao(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new Ao(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new Pe("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new yo(t,i)}static deserialize(e){return new yo(e[0],e[1])}constructor(e,t){if(e>t)throw new Pe(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new yo(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new yo(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new yo(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new yo(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}intersectsOrTouches(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new H(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new H(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}toOffsetRange(){return new Re(this.startLineNumber-1,this.endLineNumberExclusive-1)}addMargin(e,t){return new yo(this.startLineNumber-e,this.endLineNumberExclusive+t)}};yo.compareByStart=oo(e=>e.startLineNumber,Sh);let He=yo;class Ao{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=R4(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=p1(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{const n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){const t=m1(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){const t=m1(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,n=0,r=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let o=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(o=a,i++):(o=l,n++)}else i<this._normalizedRanges.length?(o=this._normalizedRanges[i],i++):(o=e._normalizedRanges[n],n++);r===null?r=o:r.endLineNumberExclusive>=o.startLineNumber?r=new He(r.startLineNumber,Math.max(r.endLineNumberExclusive,o.endLineNumberExclusive)):(t.push(r),r=o)}return r!==null&&t.push(r),new Ao(t)}subtractFrom(e){const t=R4(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),i=p1(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new Ao([e]);const n=[];let r=e.startLineNumber;for(let o=t;o<i;o++){const a=this._normalizedRanges[o];a.startLineNumber>r&&n.push(new He(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&n.push(new He(r,e.endLineNumberExclusive)),new Ao(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){const r=this._normalizedRanges[i],o=e._normalizedRanges[n],a=r.intersect(o);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<o.endLineNumberExclusive?i++:n++}return new Ao(t)}getWithDelta(e){return new Ao(this._normalizedRanges.map(t=>t.delta(e)))}}const Na=class Na{static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new Na(0,t.column-e.column):new Na(t.lineNumber-e.lineNumber,t.column-1)}static fromPosition(e){return new Na(e.lineNumber-1,e.column-1)}static ofRange(e){return Na.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(const n of e)n===`
`?(t++,i=0):i++;return new Na(t,i)}constructor(e,t){this.lineCount=e,this.columnCount=t}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}add(e){return e.lineCount===0?new Na(this.lineCount,this.columnCount+e.columnCount):new Na(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new H(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new H(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new H(1,1,this.lineCount+1,this.columnCount+1)}toLineRange(){return He.ofLength(1,this.lineCount+1)}addToPosition(e){return this.lineCount===0?new Y(e.lineNumber,e.column+this.columnCount):new Y(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};Na.zero=new Na(0,0);let Dr=Na;class _be{getOffsetRange(e){return new Re(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getRange(e){return H.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getStringReplacement(e){return new rg.deps.StringReplacement(this.getOffsetRange(e.range),e.text)}getTextReplacement(e){return new rg.deps.TextReplacement(this.getRange(e.replaceRange),e.newText)}getTextEdit(e){const t=e.replacements.map(i=>this.getTextReplacement(i));return new rg.deps.TextEdit(t)}}const z9=class z9{static get deps(){if(!this._deps)throw new Error("Dependencies not set. Call _setDependencies first.");return this._deps}};z9._deps=void 0;let rg=z9;function bbe(s){rg._deps=s}class wD extends _be{constructor(e){super(),this.text=e,this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&(this.lineStartOffsetByLineIdx.push(t+1),t>0&&e.charAt(t-1)==="\r"?this.lineEndOffsetByLineIdx.push(t-1):this.lineEndOffsetByLineIdx.push(t));this.lineEndOffsetByLineIdx.push(e.length)}getOffset(e){const t=this._validatePosition(e);return this.lineStartOffsetByLineIdx[t.lineNumber-1]+t.column-1}_validatePosition(e){if(e.lineNumber<1)return new Y(1,1);const t=this.textLength.lineCount+1;if(e.lineNumber>t){const n=this.getLineLength(t);return new Y(t,n+1)}if(e.column<1)return new Y(e.lineNumber,1);const i=this.getLineLength(e.lineNumber);return e.column-1>i?new Y(e.lineNumber,i+1):e}getPosition(e){const t=p1(this.lineStartOffsetByLineIdx,r=>r<=e),i=t+1,n=e-this.lineStartOffsetByLineIdx[t]+1;return new Y(i,n)}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new rg.deps.TextLength(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}}class Z7{constructor(){this._transformer=void 0}get endPositionExclusive(){return this.length.addToPosition(new Y(1,1))}get lineRange(){return this.length.toLineRange()}getValue(){return this.getValueOfRange(this.length.toRange())}getValueOfOffsetRange(e){return this.getValueOfRange(this.getTransformer().getRange(e))}getLineLength(e){return this.getValueOfRange(new H(e,1,e,Number.MAX_SAFE_INTEGER)).length}getTransformer(){return this._transformer||(this._transformer=new wD(this.getValue())),this._transformer}getLineAt(e){return this.getValueOfRange(new H(e,1,e,Number.MAX_SAFE_INTEGER))}}class Cbe extends Z7{constructor(e,t){zL(t>=1),super(),this._getLineContent=e,this._lineCount=t}getValueOfRange(e){if(e.startLineNumber===e.endLineNumber)return this._getLineContent(e.startLineNumber).substring(e.startColumn-1,e.endColumn-1);let t=this._getLineContent(e.startLineNumber).substring(e.startColumn-1);for(let i=e.startLineNumber+1;i<e.endLineNumber;i++)t+=`
`+this._getLineContent(i);return t+=`
`+this._getLineContent(e.endLineNumber).substring(0,e.endColumn-1),t}getLineLength(e){return this._getLineContent(e).length}get length(){const e=this._getLineContent(this._lineCount);return new Dr(this._lineCount-1,e.length)}}class HS extends Cbe{constructor(e){super(t=>e[t-1],e.length)}}class Oz extends Z7{constructor(e){super(),this.value=e,this._t=new wD(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}getTransformer(){return this._t}}class xw{static fromStringEdit(e,t){const i=e.replacements.map(n=>Ma.fromStringReplacement(n,t));return new xw(i)}static fromParallelReplacementsUnsorted(e){const t=e.slice().sort(oo(i=>i.range,H.compareRangesUsingStarts));return new xw(t)}constructor(e){this.replacements=e,Mg(()=>o7(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}mapPosition(e){let t=0,i=0,n=0;for(const r of this.replacements){const o=r.range.getStartPosition();if(e.isBeforeOrEqual(o))break;const a=r.range.getEndPosition(),l=Dr.ofText(r.text);if(e.isBefore(a)){const c=new Y(o.lineNumber+t,o.column+(o.lineNumber+t===i?n:0)),u=l.addToPosition(c);return zS(c,u)}o.lineNumber+t!==i&&(n=0),t+=l.lineCount-(r.range.endLineNumber-r.range.startLineNumber),l.lineCount===0?a.lineNumber!==o.lineNumber?n+=l.columnCount-(a.column-1):n+=l.columnCount-(a.column-o.column):n=l.columnCount,i=a.lineNumber+t}return new Y(e.lineNumber+t,e.column+(e.lineNumber+t===i?n:0))}mapRange(e){function t(o){return o instanceof Y?o:o.getStartPosition()}function i(o){return o instanceof Y?o:o.getEndPosition()}const n=t(this.mapPosition(e.getStartPosition())),r=i(this.mapPosition(e.getEndPosition()));return zS(n,r)}apply(e){let t="",i=new Y(1,1);for(const r of this.replacements){const o=r.range,a=o.getStartPosition(),l=o.getEndPosition(),c=zS(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=r.text,i=l}const n=zS(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){const t=new Oz(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,n=0;for(const r of this.replacements){const o=Dr.ofText(r.text),a=Y.lift({lineNumber:r.range.startLineNumber+i,column:r.range.startColumn+(r.range.startLineNumber===t?n:0)}),l=o.createRange(a);e.push(l),i=l.endLineNumber-r.range.endLineNumber,n=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}toReplacement(e){if(this.replacements.length===0)throw new Pe;if(this.replacements.length===1)return this.replacements[0];const t=this.replacements[0].range.getStartPosition(),i=this.replacements[this.replacements.length-1].range.getEndPosition();let n="";for(let r=0;r<this.replacements.length;r++){const o=this.replacements[r];if(n+=o.text,r<this.replacements.length-1){const a=this.replacements[r+1],l=H.fromPositions(o.range.getEndPosition(),a.range.getStartPosition()),c=e.getValueOfRange(l);n+=c}}return new Ma(H.fromPositions(t,i),n)}toString(e){return e===void 0?this.replacements.map(t=>t.toString()).join(`
`):typeof e=="string"?this.toString(new Oz(e)):this.replacements.length===0?"":this.replacements.map(t=>{const n=e.getValueOfRange(t.range),r=H.fromPositions(new Y(Math.max(1,t.range.startLineNumber-1),1),t.range.getStartPosition());let o=e.getValueOfRange(r);o.length>10&&(o="..."+o.substring(o.length-10));const a=H.fromPositions(t.range.getEndPosition(),new Y(t.range.endLineNumber+1,1));let l=e.getValueOfRange(a);l.length>10&&(l=l.substring(0,10)+"...");let c=n;if(c.length>10){const d=Math.floor(5);c=c.substring(0,d)+"..."+c.substring(c.length-d)}let u=t.text;if(u.length>10){const d=Math.floor(5);u=u.substring(0,d)+"..."+u.substring(u.length-d)}return c.length===0?`${o}${u}${l}`:`${o}${c}${u}${l}`}).join(`
`)}}class Ma{static joinReplacements(e,t){if(e.length===0)throw new Pe;if(e.length===1)return e[0];const i=e[0].range.getStartPosition(),n=e[e.length-1].range.getEndPosition();let r="";for(let o=0;o<e.length;o++){const a=e[o];if(r+=a.text,o<e.length-1){const l=e[o+1],c=H.fromPositions(a.range.getEndPosition(),l.range.getStartPosition()),u=t.getValueOfRange(c);r+=u}}return new Ma(H.fromPositions(i,n),r)}static fromStringReplacement(e,t){return new Ma(t.getTransformer().getRange(e.replaceRange),e.newText)}static delete(e){return new Ma(e,"")}constructor(e,t){this.range=e,this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}equals(e){return Ma.equals(this,e)}removeCommonPrefixAndSuffix(e){return this.removeCommonPrefix(e).removeCommonSuffix(e)}removeCommonPrefix(e){const t=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=this.text.replaceAll(`\r
`,`
`),n=a1(t,i),r=Dr.ofText(t.substring(0,n)).addToPosition(this.range.getStartPosition()),o=i.substring(n),a=H.fromPositions(r,this.range.getEndPosition());return new Ma(a,o)}removeCommonSuffix(e){const t=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=this.text.replaceAll(`\r
`,`
`),n=l1(t,i),r=Dr.ofText(t.substring(0,t.length-n)).addToPosition(this.range.getStartPosition()),o=i.substring(0,i.length-n),a=H.fromPositions(this.range.getStartPosition(),r);return new Ma(a,o)}toString(){const e=this.range.getStartPosition(),t=this.range.getEndPosition();return`(${e.lineNumber},${e.column} -> ${t.lineNumber},${t.column}): "${this.text}"`}}function zS(s,e){if(s.lineNumber===e.lineNumber&&s.column===Number.MAX_SAFE_INTEGER)return H.fromPositions(e,e);if(!s.isBeforeOrEqual(e))throw new Pe("start must be before end");return new H(s.lineNumber,s.column,e.lineNumber,e.column)}class Ss{static inverse(e,t,i){const n=[];let r=1,o=1;for(const l of e){const c=new Ss(new He(r,l.original.startLineNumber),new He(o,l.modified.startLineNumber));c.modified.isEmpty||n.push(c),r=l.original.endLineNumberExclusive,o=l.modified.endLineNumberExclusive}const a=new Ss(new He(r,t+1),new He(o,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){const n=[];for(const r of e){const o=r.original.intersect(t),a=r.modified.intersect(i);o&&!o.isEmpty&&a&&!a.isEmpty&&n.push(new Ss(o,a))}return n}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Ss(this.modified,this.original)}join(e){return new Ss(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new Cr(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new Pe("not a valid diff");return new Cr(new H(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new H(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new Cr(new H(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new H(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(Pz(this.original.endLineNumberExclusive,e)&&Pz(this.modified.endLineNumberExclusive,t))return new Cr(new H(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new H(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new Cr(H.fromPositions(new Y(this.original.startLineNumber,1),_p(new Y(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),H.fromPositions(new Y(this.modified.startLineNumber,1),_p(new Y(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new Cr(H.fromPositions(_p(new Y(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),_p(new Y(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),H.fromPositions(_p(new Y(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),_p(new Y(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new Pe}}function _p(s,e){if(s.lineNumber<1)return new Y(1,1);if(s.lineNumber>e.length)return new Y(e.length,e[e.length-1].length+1);const t=e[s.lineNumber-1];return s.column>t.length+1?new Y(s.lineNumber,t.length+1):s}function Pz(s,e){return s>=1&&s<=e.length}class ao extends Ss{static fromRangeMappings(e){const t=He.join(e.map(n=>He.fromRangeInclusive(n.originalRange))),i=He.join(e.map(n=>He.fromRangeInclusive(n.modifiedRange)));return new ao(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new ao(this.modified,this.original,(e=this.innerChanges)==null?void 0:e.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new ao(this.original,this.modified,[this.toRangeMapping()])}}class Cr{static fromEdit(e){const t=e.getNewRanges();return e.replacements.map((n,r)=>new Cr(n.range,t[r]))}static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new Pe("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new Cr(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new Ma(this.originalRange,t)}}function Fz(s,e,t,i=!1){const n=[];for(const r of t7(s.map(o=>wbe(o,e,t)),(o,a)=>o.original.intersectsOrTouches(a.original)||o.modified.intersectsOrTouches(a.modified))){const o=r[0],a=r[r.length-1];n.push(new ao(o.original.join(a.original),o.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return Mg(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length.lineCount-n[n.length-1].modified.endLineNumberExclusive!==e.length.lineCount-n[n.length-1].original.endLineNumberExclusive)?!1:o7(n,(r,o)=>o.original.startLineNumber-r.original.endLineNumberExclusive===o.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<o.original.startLineNumber&&r.modified.endLineNumberExclusive<o.modified.startLineNumber)),n}function wbe(s,e,t){let i=0,n=0;s.modifiedRange.endColumn===1&&s.originalRange.endColumn===1&&s.originalRange.startLineNumber+i<=s.originalRange.endLineNumber&&s.modifiedRange.startLineNumber+i<=s.modifiedRange.endLineNumber&&(n=-1),s.modifiedRange.startColumn-1>=t.getLineLength(s.modifiedRange.startLineNumber)&&s.originalRange.startColumn-1>=e.getLineLength(s.originalRange.startLineNumber)&&s.originalRange.startLineNumber<=s.originalRange.endLineNumber+n&&s.modifiedRange.startLineNumber<=s.modifiedRange.endLineNumber+n&&(i=1);const r=new He(s.originalRange.startLineNumber+i,s.originalRange.endLineNumber+1+n),o=new He(s.modifiedRange.startLineNumber+i,s.modifiedRange.endLineNumber+1+n);return new ao(r,o,[s])}const vbe=3;class ybe{computeDiff(e,t,i){var l;const r=new Lbe(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),o=[];let a=null;for(const c of r.changes){let u;c.originalEndLineNumber===0?u=new He(c.originalStartLineNumber+1,c.originalStartLineNumber+1):u=new He(c.originalStartLineNumber,c.originalEndLineNumber+1);let d;c.modifiedEndLineNumber===0?d=new He(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):d=new He(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let g=new ao(u,d,(l=c.charChanges)==null?void 0:l.map(p=>new Cr(new H(p.originalStartLineNumber,p.originalStartColumn,p.originalEndLineNumber,p.originalEndColumn),new H(p.modifiedStartLineNumber,p.modifiedStartColumn,p.modifiedEndLineNumber,p.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===g.modified.startLineNumber||a.original.endLineNumberExclusive===g.original.startLineNumber)&&(g=new ao(a.original.join(g.original),a.modified.join(g.modified),a.innerChanges&&g.innerChanges?a.innerChanges.concat(g.innerChanges):void 0),o.pop()),o.push(g),a=g}return Mg(()=>o7(o,(c,u)=>u.original.startLineNumber-c.original.endLineNumberExclusive===u.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<u.original.startLineNumber&&c.modified.endLineNumberExclusive<u.modified.startLineNumber)),new Vx(o,[],r.quitEarly)}}function NX(s,e,t,i){return new hh(s,e,t).ComputeDiff(i)}let Bz=class{constructor(e){const t=[],i=[];for(let n=0,r=e.length;n<r;n++)t[n]=A4(e[n],1),i[n]=M4(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],r=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],u=e?this._startColumns[l]:1,d=e?this._endColumns[l]:c.length+1;for(let g=u;g<d;g++)n[a]=c.charCodeAt(g-1),r[a]=l+1,o[a]=g,a++;!e&&l<i&&(n[a]=10,r[a]=l+1,o[a]=c.length+1,a++)}return new Sbe(n,r,o)}};class Sbe{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class E_{constructor(e,t,i,n,r,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=r,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),u=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),d=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new E_(n,r,o,a,l,c,u,d)}}function xbe(s){if(s.length<=1)return s;const e=[s[0]];let t=e[0];for(let i=1,n=s.length;i<n;i++){const r=s[i],o=r.originalStart-(t.originalStart+t.originalLength),a=r.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<vbe?(t.originalLength=r.originalStart+r.originalLength-t.originalStart,t.modifiedLength=r.modifiedStart+r.modifiedLength-t.modifiedStart):(e.push(r),t=r)}return e}class j0{constructor(e,t,i,n,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=r}static createFromDiffResult(e,t,i,n,r,o,a){let l,c,u,d,g;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(u=n.getStartLineNumber(t.modifiedStart)-1,d=0):(u=n.getStartLineNumber(t.modifiedStart),d=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const p=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),_=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(p.getElements().length>0&&_.getElements().length>0){let C=NX(p,_,r,!0).changes;a&&(C=xbe(C)),g=[];for(let v=0,x=C.length;v<x;v++)g.push(E_.createFromDiffChange(C[v],p,_))}}return new j0(l,c,u,d,g)}}class Lbe{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new Bz(e),this.modified=new Bz(t),this.continueLineDiff=Vz(i.maxComputationTime),this.continueCharDiff=Vz(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=NX(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(j0.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let r=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,u=c?c.originalStart:this.originalLines.length,d=c?c.modifiedStart:this.modifiedLines.length;for(;r<u&&o<d;){const g=this.originalLines[r],p=this.modifiedLines[o];if(g!==p){{let _=A4(g,1),C=A4(p,1);for(;_>1&&C>1;){const v=g.charCodeAt(_-2),x=p.charCodeAt(C-2);if(v!==x)break;_--,C--}(_>1||C>1)&&this._pushTrimWhitespaceCharChange(n,r+1,1,_,o+1,1,C)}{let _=M4(g,1),C=M4(p,1);const v=g.length+1,x=p.length+1;for(;_<v&&C<x;){const S=g.charCodeAt(_-1),k=g.charCodeAt(C-1);if(S!==k)break;_++,C++}(_<v||C<x)&&this._pushTrimWhitespaceCharChange(n,r+1,_,v,o+1,C,x)}}r++,o++}c&&(n.push(j0.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,r,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,r,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new E_(t,i,t,n,r,o,r,a)]),e.push(new j0(t,t,r,r,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,r,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===r?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new E_(t,i,t,n,r,o,r,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===r?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new E_(t,i,t,n,r,o,r,a)),!0):!1}}function A4(s,e){const t=Lr(s);return t===-1?e:t+1}function M4(s,e){const t=rm(s);return t===-1?e:t+2}function Vz(s){if(s===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<s}class kh{static trivial(e,t){return new kh([new ln(Re.ofLength(e.length),Re.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new kh([new ln(Re.ofLength(e.length),Re.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class ln{static invert(e,t){const i=[];return XY(e,(n,r)=>{i.push(ln.fromOffsetPairs(n?n.getEndExclusives():mh.zero,r?r.getStarts():new mh(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new ln(new Re(e.offset1,t.offset1),new Re(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new Pe("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new ln(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new ln(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new ln(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new ln(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new ln(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new ln(t,i)}getStarts(){return new mh(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new mh(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}const Of=class Of{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new Of(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}};Of.zero=new Of(0,0),Of.max=new Of(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);let mh=Of;const jE=class jE{isValid(){return!0}};jE.instance=new jE;let Lw=jE;class kbe{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new Pe("timeout must be positive")}isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}}class aR{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function O4(s){return s===32||s===9}const DC=class DC{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let n=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){const o=t[r];for(let l=0;l<o.length;l++){n++;const c=o[l],u=DC.getKey(c);this.histogram[u]=(this.histogram[u]||0)+1}n++;const a=DC.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}};DC.chrKeys=new Map;let ck=DC;class Ebe{compute(e,t,i=Lw.instance,n){if(e.length===0||t.length===0)return kh.trivial(e,t);const r=new aR(e.length,t.length),o=new aR(e.length,t.length),a=new aR(e.length,t.length);for(let _=0;_<e.length;_++)for(let C=0;C<t.length;C++){if(!i.isValid())return kh.trivialTimedOut(e,t);const v=_===0?0:r.get(_-1,C),x=C===0?0:r.get(_,C-1);let S;e.getElement(_)===t.getElement(C)?(_===0||C===0?S=0:S=r.get(_-1,C-1),_>0&&C>0&&o.get(_-1,C-1)===3&&(S+=a.get(_-1,C-1)),S+=n?n(_,C):1):S=-1;const k=Math.max(v,x,S);if(k===S){const E=_>0&&C>0?a.get(_-1,C-1):0;a.set(_,C,E+1),o.set(_,C,3)}else k===v?(a.set(_,C,0),o.set(_,C,1)):k===x&&(a.set(_,C,0),o.set(_,C,2));r.set(_,C,k)}const l=[];let c=e.length,u=t.length;function d(_,C){(_+1!==c||C+1!==u)&&l.push(new ln(new Re(_+1,c),new Re(C+1,u))),c=_,u=C}let g=e.length-1,p=t.length-1;for(;g>=0&&p>=0;)o.get(g,p)===3?(d(g,p),g--,p--):o.get(g,p)===1?g--:p--;return d(-1,-1),l.reverse(),new kh(l,!1)}}class IX{compute(e,t,i=Lw.instance){if(e.length===0||t.length===0)return kh.trivial(e,t);const n=e,r=t;function o(C,v){for(;C<n.length&&v<r.length&&n.getElement(C)===r.getElement(v);)C++,v++;return C}let a=0;const l=new Dbe;l.set(0,o(0,0));const c=new Tbe;c.set(0,l.get(0)===0?null:new Wz(null,0,0,l.get(0)));let u=0;e:for(;;){if(a++,!i.isValid())return kh.trivialTimedOut(n,r);const C=-Math.min(a,r.length+a%2),v=Math.min(a,n.length+a%2);for(u=C;u<=v;u+=2){const x=u===v?-1:l.get(u+1),S=u===C?-1:l.get(u-1)+1,k=Math.min(Math.max(x,S),n.length),E=k-u;if(k>n.length||E>r.length)continue;const T=o(k,E);l.set(u,T);const R=k===x?c.get(u+1):c.get(u-1);if(c.set(u,T!==k?new Wz(R,k,E,T-k):R),l.get(u)===n.length&&l.get(u)-u===r.length)break e}}let d=c.get(u);const g=[];let p=n.length,_=r.length;for(;;){const C=d?d.x+d.length:0,v=d?d.y+d.length:0;if((C!==p||v!==_)&&g.push(new ln(new Re(C,p),new Re(v,_))),!d)break;p=d.x,_=d.y,d=d.prev}return g.reverse(),new kh(g,!1)}}class Wz{constructor(e,t,i,n){this.prev=e,this.x=t,this.y=i,this.length=n}}class Dbe{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class Tbe{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class hk{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let r=e[n-1],o=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(o=this.range.startColumn-1,r=r.substring(o)),this.lineStartOffsets.push(o);let a=0;if(!i){const c=r.trimStart();a=r.length-c.length,r=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-o-a,r.length):r.length;for(let c=0;c<l;c++)this.elements.push(r.charCodeAt(c));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Re(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=Uz(e>0?this.elements[e-1]:-1),i=Uz(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=zz(t),n+=zz(i),n}translateOffset(e,t="right"){const i=p1(this.firstElementOffsetByLineIdx,r=>r<=e),n=e-this.firstElementOffsetByLineIdx[i];return new Y(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?H.fromPositions(i,i):H.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!bp(this.elements[e]))return;let t=e;for(;t>0&&bp(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&bp(this.elements[i]);)i++;return new Re(t,i)}findSubWordContaining(e){if(e<0||e>=this.elements.length||!bp(this.elements[e]))return;let t=e;for(;t>0&&bp(this.elements[t-1])&&!Hz(this.elements[t]);)t--;let i=e;for(;i<this.elements.length&&bp(this.elements[i])&&!Hz(this.elements[i]);)i++;return new Re(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=m1(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=fbe(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new Re(t,i)}}function bp(s){return s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57}function Hz(s){return s>=65&&s<=90}const Nbe={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function zz(s){return Nbe[s]}function Uz(s){return s===10?8:s===13?7:O4(s)?6:s>=97&&s<=122?0:s>=65&&s<=90?1:s>=48&&s<=57?2:s===-1?3:s===44||s===59?5:4}function Ibe(s,e,t,i,n,r){let{moves:o,excludedChanges:a}=Abe(s,e,t,r);if(!r.isValid())return[];const l=s.filter(u=>!a.has(u)),c=Mbe(l,i,n,e,t,r);return jA(o,c),o=Obe(o),o=o.filter(u=>{const d=u.original.toOffsetRange().slice(e).map(p=>p.trim());return d.join(`
`).length>=15&&Rbe(d,p=>p.length>=2)>=2}),o=Pbe(s,o),o}function Rbe(s,e){let t=0;for(const i of s)e(i)&&t++;return t}function Abe(s,e,t,i){const n=[],r=s.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new ck(l.original,e,l)),o=new Set(s.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new ck(l.modified,t,l))),a=new Set;for(const l of r){let c=-1,u;for(const d of o){const g=l.computeSimilarity(d);g>c&&(c=g,u=d)}if(c>.9&&u&&(o.delete(u),n.push(new Ss(l.range,u.range)),a.add(l.source),a.add(u.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function Mbe(s,e,t,i,n,r){const o=[],a=new oX;for(const g of s)for(let p=g.original.startLineNumber;p<g.original.endLineNumberExclusive-2;p++){const _=`${e[p-1]}:${e[p+1-1]}:${e[p+2-1]}`;a.add(_,{range:new He(p,p+3)})}const l=[];s.sort(oo(g=>g.modified.startLineNumber,Sh));for(const g of s){let p=[];for(let _=g.modified.startLineNumber;_<g.modified.endLineNumberExclusive-2;_++){const C=`${t[_-1]}:${t[_+1-1]}:${t[_+2-1]}`,v=new He(_,_+3),x=[];a.forEach(C,({range:S})=>{for(const E of p)if(E.originalLineRange.endLineNumberExclusive+1===S.endLineNumberExclusive&&E.modifiedLineRange.endLineNumberExclusive+1===v.endLineNumberExclusive){E.originalLineRange=new He(E.originalLineRange.startLineNumber,S.endLineNumberExclusive),E.modifiedLineRange=new He(E.modifiedLineRange.startLineNumber,v.endLineNumberExclusive),x.push(E);return}const k={modifiedLineRange:v,originalLineRange:S};l.push(k),x.push(k)}),p=x}if(!r.isValid())return[]}l.sort(kfe(oo(g=>g.modifiedLineRange.length,Sh)));const c=new Ao,u=new Ao;for(const g of l){const p=g.modifiedLineRange.startLineNumber-g.originalLineRange.startLineNumber,_=c.subtractFrom(g.modifiedLineRange),C=u.subtractFrom(g.originalLineRange).getWithDelta(p),v=_.getIntersection(C);for(const x of v.ranges){if(x.length<3)continue;const S=x,k=x.delta(-p);o.push(new Ss(k,S)),c.addRange(S),u.addRange(k)}}o.sort(oo(g=>g.original.startLineNumber,Sh));const d=new lk(s);for(let g=0;g<o.length;g++){const p=o[g],_=d.findLastMonotonous(R=>R.original.startLineNumber<=p.original.startLineNumber),C=m1(s,R=>R.modified.startLineNumber<=p.modified.startLineNumber),v=Math.max(p.original.startLineNumber-_.original.startLineNumber,p.modified.startLineNumber-C.modified.startLineNumber),x=d.findLastMonotonous(R=>R.original.startLineNumber<p.original.endLineNumberExclusive),S=m1(s,R=>R.modified.startLineNumber<p.modified.endLineNumberExclusive),k=Math.max(x.original.endLineNumberExclusive-p.original.endLineNumberExclusive,S.modified.endLineNumberExclusive-p.modified.endLineNumberExclusive);let E;for(E=0;E<v;E++){const R=p.original.startLineNumber-E-1,N=p.modified.startLineNumber-E-1;if(R>i.length||N>n.length||c.contains(N)||u.contains(R)||!jz(i[R-1],n[N-1],r))break}E>0&&(u.addRange(new He(p.original.startLineNumber-E,p.original.startLineNumber)),c.addRange(new He(p.modified.startLineNumber-E,p.modified.startLineNumber)));let T;for(T=0;T<k;T++){const R=p.original.endLineNumberExclusive+T,N=p.modified.endLineNumberExclusive+T;if(R>i.length||N>n.length||c.contains(N)||u.contains(R)||!jz(i[R-1],n[N-1],r))break}T>0&&(u.addRange(new He(p.original.endLineNumberExclusive,p.original.endLineNumberExclusive+T)),c.addRange(new He(p.modified.endLineNumberExclusive,p.modified.endLineNumberExclusive+T))),(E>0||T>0)&&(o[g]=new Ss(new He(p.original.startLineNumber-E,p.original.endLineNumberExclusive+T),new He(p.modified.startLineNumber-E,p.modified.endLineNumberExclusive+T)))}return o}function jz(s,e,t){if(s.trim()===e.trim())return!0;if(s.length>300&&e.length>300)return!1;const n=new IX().compute(new hk([s],new H(1,1,1,s.length),!1),new hk([e],new H(1,1,1,e.length),!1),t);let r=0;const o=ln.invert(n.diffs,s.length);for(const u of o)u.seq1Range.forEach(d=>{O4(s.charCodeAt(d))||r++});function a(u){let d=0;for(let g=0;g<s.length;g++)O4(u.charCodeAt(g))||d++;return d}const l=a(s.length>e.length?s:e);return r/l>.6&&l>10}function Obe(s){if(s.length===0)return s;s.sort(oo(t=>t.original.startLineNumber,Sh));const e=[s[0]];for(let t=1;t<s.length;t++){const i=e[e.length-1],n=s[t],r=n.original.startLineNumber-i.original.endLineNumberExclusive,o=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(r>=0&&o>=0&&r+o<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function Pbe(s,e){const t=new lk(s);return e=e.filter(i=>{const n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Ss(new He(1,1),new He(1,1)),r=m1(s,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==r}),e}function $z(s,e,t){let i=t;return i=qz(s,e,i),i=qz(s,e,i),i=Fbe(s,e,i),i}function qz(s,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let r=1;r<t.length;r++){const o=i[i.length-1];let a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-o.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(s.getElement(a.seq1Range.start-c)!==s.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new ln(new Re(o.seq1Range.start,a.seq1Range.endExclusive-l),new Re(o.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const n=[];for(let r=0;r<i.length-1;r++){const o=i[r+1];let a=i[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=o.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!s.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[r+1]=new ln(new Re(a.seq1Range.start+l,o.seq1Range.endExclusive),new Re(a.seq2Range.start+l,o.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function Fbe(s,e,t){if(!s.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const n=i>0?t[i-1]:void 0,r=t[i],o=i+1<t.length?t[i+1]:void 0,a=new Re(n?n.seq1Range.endExclusive+1:0,o?o.seq1Range.start-1:s.length),l=new Re(n?n.seq2Range.endExclusive+1:0,o?o.seq2Range.start-1:e.length);r.seq1Range.isEmpty?t[i]=Gz(r,s,e,a,l):r.seq2Range.isEmpty&&(t[i]=Gz(r.swap(),e,s,l,a).swap())}return t}function Gz(s,e,t,i,n){let o=1;for(;s.seq1Range.start-o>=i.start&&s.seq2Range.start-o>=n.start&&t.isStronglyEqual(s.seq2Range.start-o,s.seq2Range.endExclusive-o)&&o<100;)o++;o--;let a=0;for(;s.seq1Range.start+a<i.endExclusive&&s.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(s.seq2Range.start+a,s.seq2Range.endExclusive+a)&&a<100;)a++;if(o===0&&a===0)return s;let l=0,c=-1;for(let u=-o;u<=a;u++){const d=s.seq2Range.start+u,g=s.seq2Range.endExclusive+u,p=s.seq1Range.start+u,_=e.getBoundaryScore(p)+t.getBoundaryScore(d)+t.getBoundaryScore(g);_>c&&(c=_,l=u)}return s.delta(l)}function Bbe(s,e,t){const i=[];for(const n of t){const r=i[i.length-1];if(!r){i.push(n);continue}n.seq1Range.start-r.seq1Range.endExclusive<=2||n.seq2Range.start-r.seq2Range.endExclusive<=2?i[i.length-1]=new ln(r.seq1Range.join(n.seq1Range),r.seq2Range.join(n.seq2Range)):i.push(n)}return i}function Kz(s,e,t,i,n=!1){const r=ln.invert(t,s.length),o=[];let a=new mh(0,0);function l(u,d){if(u.offset1<a.offset1||u.offset2<a.offset2)return;const g=i(s,u.offset1),p=i(e,u.offset2);if(!g||!p)return;let _=new ln(g,p);const C=_.intersect(d);let v=C.seq1Range.length,x=C.seq2Range.length;for(;r.length>0;){const S=r[0];if(!(S.seq1Range.intersects(_.seq1Range)||S.seq2Range.intersects(_.seq2Range)))break;const E=i(s,S.seq1Range.start),T=i(e,S.seq2Range.start),R=new ln(E,T),N=R.intersect(S);if(v+=N.seq1Range.length,x+=N.seq2Range.length,_=_.join(R),_.seq1Range.endExclusive>=S.seq1Range.endExclusive)r.shift();else break}(n&&v+x<_.seq1Range.length+_.seq2Range.length||v+x<(_.seq1Range.length+_.seq2Range.length)*2/3)&&o.push(_),a=_.getEndExclusives()}for(;r.length>0;){const u=r.shift();u.seq1Range.isEmpty||(l(u.getStarts(),u),l(u.getEndExclusives().delta(-1),u))}return Vbe(t,o)}function Vbe(s,e){const t=[];for(;s.length>0||e.length>0;){const i=s[0],n=e[0];let r;i&&(!n||i.seq1Range.start<n.seq1Range.start)?r=s.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function Wbe(s,e,t){let i=t;if(i.length===0)return i;let n=0,r;do{r=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let d=function(p,_){const C=new Re(u.seq1Range.endExclusive,c.seq1Range.start);return s.getText(C).replace(/\s/g,"").length<=4&&(p.seq1Range.length+p.seq2Range.length>5||_.seq1Range.length+_.seq2Range.length>5)};var o=d;const c=i[l],u=a[a.length-1];d(u,c)?(r=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(n++<10&&r);return i}function Hbe(s,e,t){let i=t;if(i.length===0)return i;let n=0,r;do{r=!1;const l=[i[0]];for(let c=1;c<i.length;c++){let g=function(_,C){const v=new Re(d.seq1Range.endExclusive,u.seq1Range.start);if(s.countLinesIn(v)>5||v.length>500)return!1;const S=s.getText(v).trim();if(S.length>20||S.split(/\r\n|\r|\n/).length>1)return!1;const k=s.countLinesIn(_.seq1Range),E=_.seq1Range.length,T=e.countLinesIn(_.seq2Range),R=_.seq2Range.length,N=s.countLinesIn(C.seq1Range),A=C.seq1Range.length,O=e.countLinesIn(C.seq2Range),W=C.seq2Range.length,j=130;function F(q){return Math.min(q,j)}return Math.pow(Math.pow(F(k*40+E),1.5)+Math.pow(F(T*40+R),1.5),1.5)+Math.pow(Math.pow(F(N*40+A),1.5)+Math.pow(F(O*40+W),1.5),1.5)>(j**1.5)**1.5*1.3};var a=g;const u=i[c],d=l[l.length-1];g(d,u)?(r=!0,l[l.length-1]=l[l.length-1].join(u)):l.push(u)}i=l}while(n++<10&&r);const o=[];return vfe(i,(l,c,u)=>{let d=c;function g(S){return S.length>0&&S.trim().length<=3&&c.seq1Range.length+c.seq2Range.length>100}const p=s.extendToFullLines(c.seq1Range),_=s.getText(new Re(p.start,c.seq1Range.start));g(_)&&(d=d.deltaStart(-_.length));const C=s.getText(new Re(c.seq1Range.endExclusive,p.endExclusive));g(C)&&(d=d.deltaEnd(C.length));const v=ln.fromOffsetPairs(l?l.getEndExclusives():mh.zero,u?u.getStarts():mh.max),x=d.intersect(v);o.length>0&&x.getStarts().equals(o[o.length-1].getEndExclusives())?o[o.length-1]=o[o.length-1].join(x):o.push(x)}),o}class Yz{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:Qz(this.lines[e-1]),i=e===this.lines.length?0:Qz(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function Qz(s){let e=0;for(;e<s.length&&(s.charCodeAt(e)===32||s.charCodeAt(e)===9);)e++;return e}class zbe{constructor(){this.dynamicProgrammingDiffing=new Ebe,this.myersDiffingAlgorithm=new IX}computeDiff(e,t,i){if(e.length<=1&&sn(e,t,(N,A)=>N===A))return new Vx([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new Vx([new ao(new He(1,e.length+1),new He(1,t.length+1),[new Cr(new H(1,1,e.length,e[e.length-1].length+1),new H(1,1,t.length,t[t.length-1].length+1))])],[],!1);const n=i.maxComputationTimeMs===0?Lw.instance:new kbe(i.maxComputationTimeMs),r=!i.ignoreTrimWhitespace,o=new Map;function a(N){let A=o.get(N);return A===void 0&&(A=o.size,o.set(N,A)),A}const l=e.map(N=>a(N.trim())),c=t.map(N=>a(N.trim())),u=new Yz(l,e),d=new Yz(c,t),g=u.length+d.length<1700?this.dynamicProgrammingDiffing.compute(u,d,n,(N,A)=>e[N]===t[A]?t[A].length===0?.1:1+Math.log(1+t[A].length):.99):this.myersDiffingAlgorithm.compute(u,d,n);let p=g.diffs,_=g.hitTimeout;p=$z(u,d,p),p=Wbe(u,d,p);const C=[],v=N=>{if(r)for(let A=0;A<N;A++){const O=x+A,W=S+A;if(e[O]!==t[W]){const j=this.refineDiff(e,t,new ln(new Re(O,O+1),new Re(W,W+1)),n,r,i);for(const F of j.mappings)C.push(F);j.hitTimeout&&(_=!0)}}};let x=0,S=0;for(const N of p){Mg(()=>N.seq1Range.start-x===N.seq2Range.start-S);const A=N.seq1Range.start-x;v(A),x=N.seq1Range.endExclusive,S=N.seq2Range.endExclusive;const O=this.refineDiff(e,t,N,n,r,i);O.hitTimeout&&(_=!0);for(const W of O.mappings)C.push(W)}v(e.length-x);const k=new HS(e),E=new HS(t),T=Fz(C,k,E);let R=[];return i.computeMoves&&(R=this.computeMoves(T,e,t,l,c,n,r,i)),Mg(()=>{function N(O,W){if(O.lineNumber<1||O.lineNumber>W.length)return!1;const j=W[O.lineNumber-1];return!(O.column<1||O.column>j.length+1)}function A(O,W){return!(O.startLineNumber<1||O.startLineNumber>W.length+1||O.endLineNumberExclusive<1||O.endLineNumberExclusive>W.length+1)}for(const O of T){if(!O.innerChanges)return!1;for(const W of O.innerChanges)if(!(N(W.modifiedRange.getStartPosition(),t)&&N(W.modifiedRange.getEndPosition(),t)&&N(W.originalRange.getStartPosition(),e)&&N(W.originalRange.getEndPosition(),e)))return!1;if(!A(O.modified,t)||!A(O.original,e))return!1}return!0}),new Vx(T,R,_)}computeMoves(e,t,i,n,r,o,a,l){return Ibe(e,t,i,n,r,o).map(d=>{const g=this.refineDiff(t,i,new ln(d.original.toOffsetRange(),d.modified.toOffsetRange()),o,a,l),p=Fz(g.mappings,new HS(t),new HS(i),!0);return new DX(d,p)})}refineDiff(e,t,i,n,r,o){const l=Ube(i).toRangeMapping2(e,t),c=new hk(e,l.originalRange,r),u=new hk(t,l.modifiedRange,r),d=c.length+u.length<500?this.dynamicProgrammingDiffing.compute(c,u,n):this.myersDiffingAlgorithm.compute(c,u,n);let g=d.diffs;return g=$z(c,u,g),g=Kz(c,u,g,(_,C)=>_.findWordContaining(C)),o.extendToSubwords&&(g=Kz(c,u,g,(_,C)=>_.findSubWordContaining(C),!0)),g=Bbe(c,u,g),g=Hbe(c,u,g),{mappings:g.map(_=>new Cr(c.translateRange(_.seq1Range),u.translateRange(_.seq2Range))),hitTimeout:d.hitTimeout}}}function Ube(s){return new Ss(new He(s.seq1Range.start+1,s.seq1Range.endExclusive+1),new He(s.seq2Range.start+1,s.seq2Range.endExclusive+1))}const Xz={getLegacy:()=>new ybe,getDefault:()=>new zbe};function Ju(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}class ie{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Ju(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class sa{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Ju(Math.max(Math.min(1,t),0),3),this.l=Ju(Math.max(Math.min(1,i),0),3),this.a=Ju(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=e.a,o=Math.max(t,i,n),a=Math.min(t,i,n);let l=0,c=0;const u=(a+o)/2,d=o-a;if(d>0){switch(c=Math.min(u<=.5?d/(2*u):d/(2-2*u),1),o){case t:l=(i-n)/d+(i<n?6:0);break;case i:l=(n-t)/d+2;break;case n:l=(t-i)/d+4;break}l*=60,l=Math.round(l)}return new sa(l,c,u,r)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:r}=e;let o,a,l;if(i===0)o=a=l=n;else{const c=n<.5?n*(1+i):n+i-n*i,u=2*n-c;o=sa._hue2rgb(u,c,t+1/3),a=sa._hue2rgb(u,c,t),l=sa._hue2rgb(u,c,t-1/3)}return new ie(Math.round(o*255),Math.round(a*255),Math.round(l*255),r)}}class zp{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Ju(Math.max(Math.min(1,t),0),3),this.v=Ju(Math.max(Math.min(1,i),0),3),this.a=Ju(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),o=Math.min(t,i,n),a=r-o,l=r===0?0:a/r;let c;return a===0?c=0:r===t?c=((i-n)/a%6+6)%6:r===i?c=(n-t)/a+2:c=(t-i)/a+4,new zp(Math.round(c*60),l,r,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:r}=e,o=n*i,a=o*(1-Math.abs(t/60%2-1)),l=n-o;let[c,u,d]=[0,0,0];return t<60?(c=o,u=a):t<120?(c=a,u=o):t<180?(u=o,d=a):t<240?(u=a,d=o):t<300?(c=a,d=o):t<=360&&(c=o,d=a),c=Math.round((c+l)*255),u=Math.round((u+l)*255),d=Math.round((d+l)*255),new ie(c,u,d,r)}}const pi=class pi{static fromHex(e){return pi.Format.CSS.parseHex(e)||pi.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:sa.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:zp.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof ie)this.rgba=e;else if(e instanceof sa)this._hsla=e,this.rgba=sa.toRGBA(e);else if(e instanceof zp)this._hsva=e,this.rgba=zp.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&ie.equals(this.rgba,e.rgba)&&sa.equals(this.hsla,e.hsla)&&zp.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=pi._relativeLuminanceForComponent(this.rgba.r),t=pi._relativeLuminanceForComponent(this.rgba.g),i=pi._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return Ju(n,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new pi(new sa(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new pi(new sa(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:r}=this.rgba;return new pi(new ie(t,i,n,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new pi(new ie(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}mix(e,t=.5){const i=Math.min(Math.max(t,0),1),n=this.rgba,r=e.rgba,o=n.r+(r.r-n.r)*i,a=n.g+(r.g-n.g)*i,l=n.b+(r.b-n.b)*i,c=n.a+(r.a-n.a)*i;return new pi(new ie(o,a,l,c))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:n,a:r}=this.rgba;return new pi(new ie(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-i),e.rgba.b-r*(e.rgba.b-n),1))}toString(){return this._toString||(this._toString=pi.Format.CSS.format(this)),this._toString}toNumber32Bit(){return this._toNumber32Bit||(this._toNumber32Bit=(this.rgba.r<<24|this.rgba.g<<16|this.rgba.b<<8|this.rgba.a*255<<0)>>>0),this._toNumber32Bit}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(r-n)/r,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(n-r)/n,e.darken(i)}};pi.white=new pi(new ie(255,255,255,1)),pi.black=new pi(new ie(0,0,0,1)),pi.red=new pi(new ie(255,0,0,1)),pi.blue=new pi(new ie(0,0,255,1)),pi.green=new pi(new ie(0,255,0,1)),pi.cyan=new pi(new ie(0,255,255,1)),pi.lightgrey=new pi(new ie(211,211,211,1)),pi.transparent=new pi(new ie(0,0,0,0));let ae=pi;(function(s){(function(e){(function(t){function i(C){return C.rgba.a===1?`rgb(${C.rgba.r}, ${C.rgba.g}, ${C.rgba.b})`:s.Format.CSS.formatRGBA(C)}t.formatRGB=i;function n(C){return`rgba(${C.rgba.r}, ${C.rgba.g}, ${C.rgba.b}, ${+C.rgba.a.toFixed(2)})`}t.formatRGBA=n;function r(C){return C.hsla.a===1?`hsl(${C.hsla.h}, ${Math.round(C.hsla.s*100)}%, ${Math.round(C.hsla.l*100)}%)`:s.Format.CSS.formatHSLA(C)}t.formatHSL=r;function o(C){return`hsla(${C.hsla.h}, ${Math.round(C.hsla.s*100)}%, ${Math.round(C.hsla.l*100)}%, ${C.hsla.a.toFixed(2)})`}t.formatHSLA=o;function a(C){const v=C.toString(16);return v.length!==2?"0"+v:v}function l(C){return`#${a(C.rgba.r)}${a(C.rgba.g)}${a(C.rgba.b)}`}t.formatHex=l;function c(C,v=!1){return v&&C.rgba.a===1?s.Format.CSS.formatHex(C):`#${a(C.rgba.r)}${a(C.rgba.g)}${a(C.rgba.b)}${a(Math.round(C.rgba.a*255))}`}t.formatHexA=c;function u(C){return C.isOpaque()?s.Format.CSS.formatHex(C):s.Format.CSS.formatRGBA(C)}t.format=u;function d(C){var v,x,S,k,E,T,R;if(C==="transparent")return s.transparent;if(C.startsWith("#"))return p(C);if(C.startsWith("rgba(")){const N=C.match(/rgba\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+), *(?<a>(?:\+|-)?\d+(\.\d+)?)\)/);if(!N)throw new Error("Invalid color format "+C);const A=parseInt(((v=N.groups)==null?void 0:v.r)??"0"),O=parseInt(((x=N.groups)==null?void 0:x.g)??"0"),W=parseInt(((S=N.groups)==null?void 0:S.b)??"0"),j=parseFloat(((k=N.groups)==null?void 0:k.a)??"0");return new s(new ie(A,O,W,j))}if(C.startsWith("rgb(")){const N=C.match(/rgb\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+)\)/);if(!N)throw new Error("Invalid color format "+C);const A=parseInt(((E=N.groups)==null?void 0:E.r)??"0"),O=parseInt(((T=N.groups)==null?void 0:T.g)??"0"),W=parseInt(((R=N.groups)==null?void 0:R.b)??"0");return new s(new ie(A,O,W))}return g(C)}t.parse=d;function g(C){switch(C){case"aliceblue":return new s(new ie(240,248,255,1));case"antiquewhite":return new s(new ie(250,235,215,1));case"aqua":return new s(new ie(0,255,255,1));case"aquamarine":return new s(new ie(127,255,212,1));case"azure":return new s(new ie(240,255,255,1));case"beige":return new s(new ie(245,245,220,1));case"bisque":return new s(new ie(255,228,196,1));case"black":return new s(new ie(0,0,0,1));case"blanchedalmond":return new s(new ie(255,235,205,1));case"blue":return new s(new ie(0,0,255,1));case"blueviolet":return new s(new ie(138,43,226,1));case"brown":return new s(new ie(165,42,42,1));case"burlywood":return new s(new ie(222,184,135,1));case"cadetblue":return new s(new ie(95,158,160,1));case"chartreuse":return new s(new ie(127,255,0,1));case"chocolate":return new s(new ie(210,105,30,1));case"coral":return new s(new ie(255,127,80,1));case"cornflowerblue":return new s(new ie(100,149,237,1));case"cornsilk":return new s(new ie(255,248,220,1));case"crimson":return new s(new ie(220,20,60,1));case"cyan":return new s(new ie(0,255,255,1));case"darkblue":return new s(new ie(0,0,139,1));case"darkcyan":return new s(new ie(0,139,139,1));case"darkgoldenrod":return new s(new ie(184,134,11,1));case"darkgray":return new s(new ie(169,169,169,1));case"darkgreen":return new s(new ie(0,100,0,1));case"darkgrey":return new s(new ie(169,169,169,1));case"darkkhaki":return new s(new ie(189,183,107,1));case"darkmagenta":return new s(new ie(139,0,139,1));case"darkolivegreen":return new s(new ie(85,107,47,1));case"darkorange":return new s(new ie(255,140,0,1));case"darkorchid":return new s(new ie(153,50,204,1));case"darkred":return new s(new ie(139,0,0,1));case"darksalmon":return new s(new ie(233,150,122,1));case"darkseagreen":return new s(new ie(143,188,143,1));case"darkslateblue":return new s(new ie(72,61,139,1));case"darkslategray":return new s(new ie(47,79,79,1));case"darkslategrey":return new s(new ie(47,79,79,1));case"darkturquoise":return new s(new ie(0,206,209,1));case"darkviolet":return new s(new ie(148,0,211,1));case"deeppink":return new s(new ie(255,20,147,1));case"deepskyblue":return new s(new ie(0,191,255,1));case"dimgray":return new s(new ie(105,105,105,1));case"dimgrey":return new s(new ie(105,105,105,1));case"dodgerblue":return new s(new ie(30,144,255,1));case"firebrick":return new s(new ie(178,34,34,1));case"floralwhite":return new s(new ie(255,250,240,1));case"forestgreen":return new s(new ie(34,139,34,1));case"fuchsia":return new s(new ie(255,0,255,1));case"gainsboro":return new s(new ie(220,220,220,1));case"ghostwhite":return new s(new ie(248,248,255,1));case"gold":return new s(new ie(255,215,0,1));case"goldenrod":return new s(new ie(218,165,32,1));case"gray":return new s(new ie(128,128,128,1));case"green":return new s(new ie(0,128,0,1));case"greenyellow":return new s(new ie(173,255,47,1));case"grey":return new s(new ie(128,128,128,1));case"honeydew":return new s(new ie(240,255,240,1));case"hotpink":return new s(new ie(255,105,180,1));case"indianred":return new s(new ie(205,92,92,1));case"indigo":return new s(new ie(75,0,130,1));case"ivory":return new s(new ie(255,255,240,1));case"khaki":return new s(new ie(240,230,140,1));case"lavender":return new s(new ie(230,230,250,1));case"lavenderblush":return new s(new ie(255,240,245,1));case"lawngreen":return new s(new ie(124,252,0,1));case"lemonchiffon":return new s(new ie(255,250,205,1));case"lightblue":return new s(new ie(173,216,230,1));case"lightcoral":return new s(new ie(240,128,128,1));case"lightcyan":return new s(new ie(224,255,255,1));case"lightgoldenrodyellow":return new s(new ie(250,250,210,1));case"lightgray":return new s(new ie(211,211,211,1));case"lightgreen":return new s(new ie(144,238,144,1));case"lightgrey":return new s(new ie(211,211,211,1));case"lightpink":return new s(new ie(255,182,193,1));case"lightsalmon":return new s(new ie(255,160,122,1));case"lightseagreen":return new s(new ie(32,178,170,1));case"lightskyblue":return new s(new ie(135,206,250,1));case"lightslategray":return new s(new ie(119,136,153,1));case"lightslategrey":return new s(new ie(119,136,153,1));case"lightsteelblue":return new s(new ie(176,196,222,1));case"lightyellow":return new s(new ie(255,255,224,1));case"lime":return new s(new ie(0,255,0,1));case"limegreen":return new s(new ie(50,205,50,1));case"linen":return new s(new ie(250,240,230,1));case"magenta":return new s(new ie(255,0,255,1));case"maroon":return new s(new ie(128,0,0,1));case"mediumaquamarine":return new s(new ie(102,205,170,1));case"mediumblue":return new s(new ie(0,0,205,1));case"mediumorchid":return new s(new ie(186,85,211,1));case"mediumpurple":return new s(new ie(147,112,219,1));case"mediumseagreen":return new s(new ie(60,179,113,1));case"mediumslateblue":return new s(new ie(123,104,238,1));case"mediumspringgreen":return new s(new ie(0,250,154,1));case"mediumturquoise":return new s(new ie(72,209,204,1));case"mediumvioletred":return new s(new ie(199,21,133,1));case"midnightblue":return new s(new ie(25,25,112,1));case"mintcream":return new s(new ie(245,255,250,1));case"mistyrose":return new s(new ie(255,228,225,1));case"moccasin":return new s(new ie(255,228,181,1));case"navajowhite":return new s(new ie(255,222,173,1));case"navy":return new s(new ie(0,0,128,1));case"oldlace":return new s(new ie(253,245,230,1));case"olive":return new s(new ie(128,128,0,1));case"olivedrab":return new s(new ie(107,142,35,1));case"orange":return new s(new ie(255,165,0,1));case"orangered":return new s(new ie(255,69,0,1));case"orchid":return new s(new ie(218,112,214,1));case"palegoldenrod":return new s(new ie(238,232,170,1));case"palegreen":return new s(new ie(152,251,152,1));case"paleturquoise":return new s(new ie(175,238,238,1));case"palevioletred":return new s(new ie(219,112,147,1));case"papayawhip":return new s(new ie(255,239,213,1));case"peachpuff":return new s(new ie(255,218,185,1));case"peru":return new s(new ie(205,133,63,1));case"pink":return new s(new ie(255,192,203,1));case"plum":return new s(new ie(221,160,221,1));case"powderblue":return new s(new ie(176,224,230,1));case"purple":return new s(new ie(128,0,128,1));case"rebeccapurple":return new s(new ie(102,51,153,1));case"red":return new s(new ie(255,0,0,1));case"rosybrown":return new s(new ie(188,143,143,1));case"royalblue":return new s(new ie(65,105,225,1));case"saddlebrown":return new s(new ie(139,69,19,1));case"salmon":return new s(new ie(250,128,114,1));case"sandybrown":return new s(new ie(244,164,96,1));case"seagreen":return new s(new ie(46,139,87,1));case"seashell":return new s(new ie(255,245,238,1));case"sienna":return new s(new ie(160,82,45,1));case"silver":return new s(new ie(192,192,192,1));case"skyblue":return new s(new ie(135,206,235,1));case"slateblue":return new s(new ie(106,90,205,1));case"slategray":return new s(new ie(112,128,144,1));case"slategrey":return new s(new ie(112,128,144,1));case"snow":return new s(new ie(255,250,250,1));case"springgreen":return new s(new ie(0,255,127,1));case"steelblue":return new s(new ie(70,130,180,1));case"tan":return new s(new ie(210,180,140,1));case"teal":return new s(new ie(0,128,128,1));case"thistle":return new s(new ie(216,191,216,1));case"tomato":return new s(new ie(255,99,71,1));case"turquoise":return new s(new ie(64,224,208,1));case"violet":return new s(new ie(238,130,238,1));case"wheat":return new s(new ie(245,222,179,1));case"white":return new s(new ie(255,255,255,1));case"whitesmoke":return new s(new ie(245,245,245,1));case"yellow":return new s(new ie(255,255,0,1));case"yellowgreen":return new s(new ie(154,205,50,1));default:return null}}function p(C){const v=C.length;if(v===0||C.charCodeAt(0)!==35)return null;if(v===7){const x=16*_(C.charCodeAt(1))+_(C.charCodeAt(2)),S=16*_(C.charCodeAt(3))+_(C.charCodeAt(4)),k=16*_(C.charCodeAt(5))+_(C.charCodeAt(6));return new s(new ie(x,S,k,1))}if(v===9){const x=16*_(C.charCodeAt(1))+_(C.charCodeAt(2)),S=16*_(C.charCodeAt(3))+_(C.charCodeAt(4)),k=16*_(C.charCodeAt(5))+_(C.charCodeAt(6)),E=16*_(C.charCodeAt(7))+_(C.charCodeAt(8));return new s(new ie(x,S,k,E/255))}if(v===4){const x=_(C.charCodeAt(1)),S=_(C.charCodeAt(2)),k=_(C.charCodeAt(3));return new s(new ie(16*x+x,16*S+S,16*k+k))}if(v===5){const x=_(C.charCodeAt(1)),S=_(C.charCodeAt(2)),k=_(C.charCodeAt(3)),E=_(C.charCodeAt(4));return new s(new ie(16*x+x,16*S+S,16*k+k,(16*E+E)/255))}return null}t.parseHex=p;function _(C){switch(C){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(s.Format||(s.Format={}))})(ae||(ae={}));function RX(s){const e=[];for(const t of s){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function J7(s,e,t,i){return{red:s/255,blue:t/255,green:e/255,alpha:i}}function Zb(s,e){const t=e.index,i=e[0].length;if(t===void 0)return;const n=s.positionAt(t);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+i}}function jbe(s,e){if(!s)return;const t=ae.Format.CSS.parseHex(e);if(t)return{range:s,color:J7(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function Zz(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),r=RX(n);return{range:s,color:J7(r[0],r[1],r[2],t?r[3]:1)}}function Jz(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),r=RX(n),o=new ae(new sa(r[0],r[1]/100,r[2]/100,t?r[3]:1));return{range:s,color:J7(o.rgba.r,o.rgba.g,o.rgba.b,o.rgba.a)}}function Jb(s,e){return typeof s=="string"?[...s.matchAll(e)]:s.findMatches(e)}function $be(s){const e=[],t=new RegExp(`\\b(rgb|rgba|hsl|hsla)(\\([0-9\\s,.\\%]*\\))|^(#)([A-Fa-f0-9]{3})\\b|^(#)([A-Fa-f0-9]{4})\\b|^(#)([A-Fa-f0-9]{6})\\b|^(#)([A-Fa-f0-9]{8})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{3})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{4})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{6})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{8})\\b`,"gm"),i=Jb(s,t);if(i.length>0)for(const n of i){const r=n.filter(c=>c!==void 0),o=r[1],a=r[2];if(!a)continue;let l;if(o==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=Zz(Zb(s,n),Jb(a,c),!1)}else if(o==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=Zz(Zb(s,n),Jb(a,c),!0)}else if(o==="hsl"){const c=/^\(\s*((?:360(?:\.0+)?|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])(?:\.\d+)?))\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=Jz(Zb(s,n),Jb(a,c),!1)}else if(o==="hsla"){const c=/^\(\s*((?:360(?:\.0+)?|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])(?:\.\d+)?))\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(0[.][0-9]+|[.][0-9]+|[01][.]0*|[01])\s*\)$/gm;l=Jz(Zb(s,n),Jb(a,c),!0)}else o==="#"&&(l=jbe(Zb(s,n),o+a));l&&e.push(l)}return e}function qbe(s){return!s||typeof s.getValue!="function"||typeof s.positionAt!="function"?[]:$be(s)}const Gbe=/^-+|-+$/g,eU=100,Kbe=5;function Ybe(s,e){var i;let t=[];if(e.findRegionSectionHeaders&&((i=e.foldingRules)!=null&&i.markers)){const n=Qbe(s,e);t=t.concat(n)}if(e.findMarkSectionHeaders){const n=Xbe(s,e);t=t.concat(n)}return t}function Qbe(s,e){const t=[],i=s.getLineCount();for(let n=1;n<=i;n++){const r=s.getLineContent(n),o=r.match(e.foldingRules.markers.start);if(o){const a={startLineNumber:n,startColumn:o[0].length+1,endLineNumber:n,endColumn:r.length+1};if(a.endColumn>a.startColumn){const l={range:a,...Zbe(r.substring(o[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function Xbe(s,e){const t=[],i=s.getLineCount();if(!e.markSectionHeaderRegex||e.markSectionHeaderRegex.trim()==="")return t;const n=EX(e.markSectionHeaderRegex),r=new RegExp(e.markSectionHeaderRegex,`gdm${n?"s":""}`);if(TQ(r))return t;for(let o=1;o<=i;o+=eU-Kbe){const a=Math.min(o+eU-1,i),l=[];for(let d=o;d<=a;d++)l.push(s.getLineContent(d));const c=l.join(`
`);r.lastIndex=0;let u;for(;(u=r.exec(c))!==null;){const d=c.substring(0,u.index),g=(d.match(/\n/g)||[]).length,p=o+g,_=u[0].split(`
`),C=_.length,v=p+C-1,x=d.lastIndexOf(`
`)+1,S=u.index-x+1,k=_[_.length-1],E=C===1?S+u[0].length:k.length+1,T={startLineNumber:p,startColumn:S,endLineNumber:v,endColumn:E},R=(u.groups??{}).label??"",N=((u.groups??{}).separator??"")!=="",A={range:T,text:R,hasSeparatorLine:N,shouldBeInComments:!0};(A.text||A.hasSeparatorLine)&&(t.length===0||t[t.length-1].range.endLineNumber<A.range.startLineNumber)&&t.push(A),r.lastIndex=u.index+u[0].length}}return t}function Zbe(s){s=s.trim();const e=s.startsWith("-");return s=s.replace(Gbe,""),{text:s,hasSeparatorLine:e}}class Jbe{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=mp(e);const i=this.values,n=this.prefixSum,r=t.length;return r===0?!1:(this.values=new Uint32Array(i.length+r),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+r),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=mp(e),t=mp(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=mp(e),t=mp(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const r=i.length-e;return t>=r&&(t=r),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=mp(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,r=0,o=0;for(;t<=i;)if(n=t+(i-t)/2|0,r=this.prefixSum[n],o=r-this.values[n],e<o)i=n-1;else if(e>=r)t=n+1;else break;return new AX(n,e-o)}}class e0e{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new AX(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=G2(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let r=0;r<i;r++)this._indexBySum[n+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class AX{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class t0e{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new Y(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Jbe(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=F1(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this._lines.splice(e.lineNumber+r-1,0,i[r]),n[r-1]=i[r].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const tU=60*1e3;class i0e extends ne{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new E7;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(tU/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)Zi(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>tU&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const r=new Ee;r.add(i.onDidChangeContent(o=>{this._proxy.$acceptModelChanged(n.toString(),o)})),r.add(i.onWillDispose(()=>{this._stopModelSync(n)})),r.add(Fe(()=>{this._proxy.$acceptRemovedModel(n)})),this._syncedModels[n]=r}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],Zi(t)}}class n0e{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new s0e(nt.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class s0e extends t0e{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const n=this._lines[i],r=this.offsetAt(new Y(i+1,1)),o=n.matchAll(e);for(const a of o)(a.index||a.index===0)&&(a.index=a.index+r),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=dw(e.column,g7(t),this._lines[e.lineNumber-1],0);return i?new H(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,r="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=r.substring(a[o].start,a[o].end);o+=1,yield l}else if(n<t.length)r=t[n],a=i(r,e),o=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),r=[];for(const o of n)r.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return r}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,r=[];r.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<n;o++)r.push(this._lines[o]);return r.push(this._lines[n].substring(0,e.endColumn-1)),r.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!Y.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const r=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>r&&(i=r,n=!0)}return n?{lineNumber:t,column:i}:e}}const Pf=class Pf{constructor(e=null){this._foreignModule=e,this._requestHandlerBrand=void 0,this._workerTextModelSyncServer=new n0e}dispose(){}async $ping(){return"pong"}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const n=this._getModel(e);return n?hbe.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?Ybe(i,t):[]}async $computeDiff(e,t,i,n){const r=this._getModel(e),o=this._getModel(t);return!r||!o?null:Pf.computeDiff(r,o,i,n)}static computeDiff(e,t,i,n){const r=n==="advanced"?Xz.getDefault():Xz.getLegacy(),o=e.getLinesContent(),a=t.getLinesContent(),l=r.computeDiff(o,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function u(d){return d.map(g=>{var p;return[g.original.startLineNumber,g.original.endLineNumberExclusive,g.modified.startLineNumber,g.modified.endLineNumberExclusive,(p=g.innerChanges)==null?void 0:p.map(_=>[_.originalRange.startLineNumber,_.originalRange.startColumn,_.originalRange.endLineNumber,_.originalRange.endColumn,_.modifiedRange.startLineNumber,_.modifiedRange.startColumn,_.modifiedRange.endLineNumber,_.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:u(l.changes),moves:l.moves.map(d=>[d.lineRangeMapping.original.startLineNumber,d.lineRangeMapping.original.endLineNumberExclusive,d.lineRangeMapping.modified.startLineNumber,d.lineRangeMapping.modified.endLineNumberExclusive,u(d.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let r=1;r<=i;r++){const o=e.getLineContent(r),a=t.getLineContent(r);if(o!==a)return!1}return!0}async $computeMoreMinimalEdits(e,t,i){const n=this._getModel(e);if(!n)return t;const r=[];let o;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return H.compareRangesUsingStarts(l.range,c.range);const u=l.range?0:1,d=c.range?0:1;return u-d});let a=0;for(let l=1;l<t.length;l++)H.getEndPosition(t[a].range).equals(H.getStartPosition(t[l].range))?(t[a].range=H.fromPositions(H.getStartPosition(t[a].range),H.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:u}of t){if(typeof u=="number"&&(o=u),H.isEmpty(l)&&!c)continue;const d=n.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,n.eol),d===c)continue;if(Math.max(c.length,d.length)>Pf._diffLimit){r.push({range:l,text:c});continue}const g=Q1e(d,c,i),p=n.offsetAt(H.lift(l).getStartPosition());for(const _ of g){const C=n.positionAt(p+_.originalStart),v=n.positionAt(p+_.originalStart+_.originalLength),x={text:c.substr(_.modifiedStart,_.modifiedLength),range:{startLineNumber:C.lineNumber,startColumn:C.column,endLineNumber:v.lineNumber,endColumn:v.column}};n.getValueInRange(x.range)!==x.text&&r.push(x)}}return typeof o=="number"&&r.push({eol:o,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),r}async $computeLinks(e){const t=this._getModel(e);return t?tbe(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?qbe(t):null}async $textualSuggest(e,t,i,n){const r=new Ah,o=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const u of c.words(o))if(!(u===t||!isNaN(Number(u)))&&(a.add(u),a.size>Pf._suggestionsLimit))break e}}return{words:Array.from(a),duration:r.elapsed()}}async $computeWordRanges(e,t,i,n){const r=this._getModel(e);if(!r)return Object.create(null);const o=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=r.getLineWords(l,o);for(const u of c){if(!isNaN(Number(u.word)))continue;let d=a[u.word];d||(d=[],a[u.word]=d),d.push({startLineNumber:l,startColumn:u.startColumn,endLineNumber:l,endColumn:u.endColumn})}}return a}async $navigateValueSet(e,t,i,n,r){const o=this._getModel(e);if(!o)return null;const a=new RegExp(n,r);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const u=o.getValueInRange(c);return I4.INSTANCE.navigateValueSet(t,l,c,u,i)}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}};Pf._diffLimit=1e5,Pf._suggestionsLimit=1e4;let P4=Pf;typeof importScripts=="function"&&(globalThis.monaco=kQ());const e6=tt("textResourceConfigurationService"),MX=tt("textResourcePropertiesService"),ei=tt("ILanguageFeaturesService"),TC=class TC{static getChannel(e){return e.getChannel(TC.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(TC.CHANNEL_NAME,t)}};TC.CHANNEL_NAME="editorWorkerHost";let F4=TC;var t6=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_f=function(s,e){return function(t,i){e(t,i,s)}};const iU=300*1e3;function bf(s,e){const t=s.getModel(e);return!(!t||t.isTooLargeForSyncing())}let B4=class extends ne{constructor(e,t,i,n,r,o){super(),this._languageConfigurationService=r,this._modelService=t,this._workerManager=this._register(new V4(e,this._modelService)),this._logService=n,this._register(o.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!bf(this._modelService,a.uri))return Promise.resolve({links:[]});const u=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return u&&{links:u}}})),this._register(o.completionProvider.register("*",new r0e(this._workerManager,i,this._modelService,this._languageConfigurationService,this._logService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return bf(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,n){const o=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,n);if(!o)return null;return{identical:o.identical,quitEarly:o.quitEarly,changes:l(o.changes),moves:o.moves.map(c=>new DX(new Ss(new He(c[0],c[1]),new He(c[2],c[3])),l(c[4])))};function l(c){return c.map(u=>{var d;return new ao(new He(u[0],u[1]),new He(u[2],u[3]),(d=u[4])==null?void 0:d.map(g=>new Cr(new H(g[0],g[1],g[2],g[3]),new H(g[4],g[5],g[6],g[7]))))})}}async computeMoreMinimalEdits(e,t,i=!1){if(q2(t)){if(!bf(this._modelService,e))return Promise.resolve(t);const n=Ah.create(),r=this._workerWithResources([e]).then(o=>o.$computeMoreMinimalEdits(e.toString(),t,i));return r.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed())),Promise.race([r,c1(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return bf(this._modelService,e)}async navigateValueSet(e,t,i){const n=this._modelService.getModel(e);if(!n)return null;const r=this._languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),o=r.source,a=r.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,o,a)}canComputeWordRanges(e){return bf(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const n=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),r=n.source,o=n.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,r,o)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};B4=t6([_f(1,Gs),_f(2,e6),_f(3,Ks),_f(4,rc),_f(5,ei)],B4);class r0e{constructor(e,t,i,n,r){this.languageConfigurationService=n,this.logService=r,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const n=[];if(i.wordBasedSuggestions==="currentDocument")bf(this._modelService,e.uri)&&n.push(e.uri);else for(const d of this._modelService.getModels())bf(this._modelService,d.uri)&&(d===e?n.unshift(d.uri):(i.wordBasedSuggestions==="allDocuments"||d.getLanguageId()===e.getLanguageId())&&n.push(d.uri));if(n.length===0)return;const r=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),o=e.getWordAtPosition(t),a=o?new H(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):H.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column);this.logService.trace("[WordBasedCompletionItemProvider]",`word: "${(o==null?void 0:o.word)||""}", wordDef: "${r}", replace: [${a.toString()}], insert: [${l.toString()}]`);const u=await(await this._workerManager.withWorker()).textualSuggest(n,o==null?void 0:o.word,r);if(u)return{duration:u.duration,suggestions:u.words.map(d=>({kind:18,label:d,insertText:d,range:{insert:l,replace:a}}))}}}let V4=class extends ne{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new B7).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(iU/2),Ut),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>iU&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new uk(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};V4=t6([_f(1,Gs)],V4);class o0e{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let uk=class extends ne{constructor(e,t,i){super(),this._workerDescriptorOrWorker=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(g1e(this._workerDescriptorOrWorker)),F4.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){L4(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return L4(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new o0e(new P4(null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new i0e(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject(Dfe());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const n=await this.workerWithSyncedResources(e),r=i.source,o=i.flags;return n.$textualSuggest(e.map(a=>a.toString()),t,r,o)}dispose(){super.dispose(),this._disposed=!0}};uk=t6([_f(2,Gs)],uk);function a0e(s,e){return new l0e(s,e)}class l0e extends uk{constructor(e,t){super(t.worker,t.keepIdleModels||!1,e),this._foreignModuleHost=t.host||null,this._foreignProxy=this._getProxy().then(i=>new Proxy({},{get(n,r,o){if(r!=="then"){if(typeof r!="string")throw new Error("Not supported");return(...a)=>i.$fmr(r,a)}}}))}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}getProxy(){return this._foreignProxy}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}const vD={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"},kw=new class{clone(){return this}equals(s){return this===s}};function OX(s,e){return new _7([new fw(0,"",s)],e)}function i6(s,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(s<<0|0|0|32768|2<<24)>>>0,new X2(t,e===null?kw:e)}class Qr{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let r=`color: ${t[i]};`;n&1&&(r+="font-style: italic;"),n&2&&(r+="font-weight: bold;");let o="";return n&4&&(o+=" underline"),n&8&&(o+=" line-through"),o&&(r+=`text-decoration:${o};`),r}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}const Xc=class Xc{static createEmpty(e,t){const i=Xc.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new Xc(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="";const r=new Array;for(const{text:o,metadata:a}of e)r.push(i+o.length,a),i+=o.length,n+=o;return new Xc(new Uint32Array(r),n,t)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let r=0;r<n;r++)e[r<<1]=e[r+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const r=i+Math.floor((n-i)/2),o=e[r<<1];if(o===t)return r+1;o<t?i=r+1:o>t&&(n=r)}return i}constructor(e,t,i){this._lineTokensBrand=void 0,(e.length>1?e[e.length-2]:0)!==t.length&&It(new Error("Token length and text length do not match!")),this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}getTextLength(){return this._text.length}equals(e){return e instanceof Xc?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const n=t<<1,r=n+(i<<1);for(let o=n;o<r;o++)if(this._tokens[o]!==e._tokens[o])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Qr.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Qr.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Qr.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Qr.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Qr.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return Qr.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return Xc.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new n6(this,e,t,i)}sliceZeroCopy(e){return this.sliceAndInflate(e.start,e.endExclusive,0)}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="";const r=new Array;let o=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(o,a);const c=this._tokens[(t<<1)+1];r.push(n.length,c),t++,o=a}else if(l){if(l.offset>o){n+=this._text.substring(o,l.offset);const c=this._tokens[(t<<1)+1];r.push(n.length,c),o=l.offset}n+=l.text,r.push(n.length,l.tokenMetadata),i++}else break}return new Xc(new Uint32Array(r),n,this.languageIdCodec)}getTokensInRange(e){const t=new c0e,i=this.findTokenIndexAtOffset(e.start),n=this.findTokenIndexAtOffset(e.endExclusive);for(let r=i;r<=n;r++){const a=new Re(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){const t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){const t=this.getCount();for(let i=0;i<t;i++)e(i)}toString(){let e="";return this.forEach(t=>{e+=`[${this.getTokenText(t)}]{${this.getClassName(t)}}`}),e}};Xc.defaultTokenMetadata=(32768|2<<24)>>>0;let gn=Xc;class n6{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,o=e.getCount();r<o&&!(e.getStartOffset(r)>=i);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof n6?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){const t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t);let r=this._source.getTokenText(t);return i<this._startOffset&&(r=r.substring(this._startOffset-i)),n>this._endOffset&&(r=r.substring(0,r.length-(n-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}class $0{static fromLineTokens(e){const t=[];for(let i=0;i<e.getCount();i++)t.push(new W4(e.getEndOffset(i)-e.getStartOffset(i),e.getMetadata(i)));return $0.create(t)}static create(e){return new $0(e)}constructor(e){this._tokenInfo=e}toLineTokens(e,t){return gn.createFromTextAndMetadata(this.map((i,n)=>({text:i.substring(e),metadata:n.metadata})),t)}forEach(e){let t=0;for(const i of this._tokenInfo){const n=new Re(t,t+i.length);e(n,i),t+=i.length}}map(e){const t=[];let i=0;for(const n of this._tokenInfo){const r=new Re(i,i+n.length);t.push(e(r,n)),i+=n.length}return t}slice(e){const t=[];let i=0;for(const n of this._tokenInfo){const r=i,o=r+n.length;if(o>e.start){if(r>=e.endExclusive)break;const a=Math.max(0,e.start-r),l=Math.max(0,o-e.endExclusive);t.push(new W4(n.length-a-l,n.metadata))}i+=n.length}return $0.create(t)}}class W4{constructor(e,t){this.length=e,this.metadata=t}}class c0e{constructor(){this._tokens=[]}add(e,t){this._tokens.push(new W4(e,t))}build(){return $0.create(this._tokens)}}class Oo{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,n=t.length;if(i!==n)return!1;for(let r=0;r<i;r++)if(!Oo._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const n=t+1,r=i+1,o=i-t,a=[];let l=0;for(const c of e)c.endColumn<=n||c.startColumn>=r||(a[l++]=new Oo(Math.max(1,c.startColumn-n+1),Math.min(o+1,c.endColumn-n+1),c.className,c.type));return a}static filter(e,t,i,n){if(e.length===0)return[];const r=[];let o=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.range;if(u.endLineNumber<t||u.startLineNumber>t||u.isEmpty()&&(c.type===0||c.type===3))continue;const d=u.startLineNumber===t?u.startColumn:i,g=u.endLineNumber===t?u.endColumn:n;r[o++]=new Oo(d,g,c.inlineClassName,c.type)}return r}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=Oo._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class nU{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class dk{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new nU(t,this.stopOffsets[n],this.classNames.join(" "),dk._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new nU(t,e-1,this.classNames.join(" "),dk._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class h0e{static normalize(e,t){if(t.length===0)return[];const i=[],n=new dk;let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];let c=l.startColumn,u=l.endColumn;const d=l.className,g=l.type===1?2:l.type===2?4:0;if(c>1){const C=e.charCodeAt(c-2);hn(C)&&c--}if(u>1){const C=e.charCodeAt(u-2);hn(C)&&u--}const p=c-1,_=u-2;r=n.consumeLowerThan(p,r,i),n.count===0&&(r=p),n.insert(_,d,g)}return n.consumeLowerThan(1073741824,r,i),i}}class nn{constructor(e,t,i,n){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=n,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class um{get isLTR(){return!this.containsRTL&&this.textDirection!==no.RTL}constructor(e,t,i,n,r,o,a,l,c,u,d,g,p,_,C,v,x,S,k,E,T,R=!1){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=r,this.containsRTL=o,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(Oo.compare),this.tabSize=u,this.startVisibleColumn=d,this.spaceWidth=g,this.stopRenderingLineAfter=C,this.renderWhitespace=v==="all"?4:v==="boundary"?1:v==="selection"?2:v==="trailing"?3:0,this.renderControlCharacters=x,this.fontLigatures=S,this.selectionsOnLine=k&&k.sort((O,W)=>O.start<W.start?-1:1),this.renderNewLineWhenEmpty=R,this.textDirection=E,this.verticalScrollbarSize=T;const N=Math.abs(_-g),A=Math.abs(p-g);N<A?(this.renderSpaceWidth=_,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=p,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&Oo.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)&&this.textDirection===e.textDirection&&this.verticalScrollbarSize===e.verticalScrollbarSize&&this.renderNewLineWhenEmpty===e.renderNewLineWhenEmpty}}class PX{constructor(e,t){this.partIndex=e,this.charIndex=t}}class Tl{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){const r=(t<<16|i<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=Tl.getPartIndex(t),n=Tl.getCharIndex(t);return new PX(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const n=(e<<16|i<<0)>>>0;let r=0,o=this.length-1;for(;r+1<o;){const C=r+o>>>1,v=this._data[C];if(v===n)return C;v>n?o=C:r=C}if(r===o)return r;const a=this._data[r],l=this._data[o];if(a===n)return r;if(l===n)return o;const c=Tl.getPartIndex(a),u=Tl.getCharIndex(a),d=Tl.getPartIndex(l);let g;c!==d?g=t:g=Tl.getCharIndex(l);const p=i-u,_=g-i;return p<=_?r:o}}class fk{constructor(e,t){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsForeignElements=t}}function yD(s,e){if(s.lineContent.length===0){if(s.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(const o of s.lineDecorations)(o.type===1||o.type===2)&&(e.appendString('<span class="'),e.appendString(o.className),e.appendString('"></span>'),o.type===1&&(n|=1,t++),o.type===2&&(n|=2,i++));e.appendString("</span>");const r=new Tl(1,t+i);return r.setColumnInfo(1,t,0,0),new fk(r,n)}return s.renderNewLineWhenEmpty?e.appendString(`<span><span>
</span></span>`):e.appendString("<span><span></span></span>"),new fk(new Tl(0,0),0)}return w0e(f0e(s),e)}class u0e{constructor(e,t,i){this.characterMapping=e,this.html=t,this.containsForeignElements=i}}function SD(s){const e=new z1(1e4),t=yD(s,e);return new u0e(t.characterMapping,e.build(),t.containsForeignElements)}class d0e{constructor(e,t,i,n,r,o,a,l,c,u,d,g,p,_,C){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=r,this.overflowingCharCount=o,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=u,this.startVisibleColumn=d,this.spaceWidth=g,this.renderSpaceCharCode=p,this.renderWhitespace=_,this.renderControlCharacters=C}}function f0e(s){const e=s.lineContent;let t,i,n;s.stopRenderingLineAfter!==-1&&s.stopRenderingLineAfter<e.length?(t=!0,i=e.length-s.stopRenderingLineAfter,n=s.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let r=g0e(e,s.containsRTL,s.lineTokens,s.fauxIndentLength,n);s.renderControlCharacters&&!s.isBasicASCII&&(r=_0e(e,r)),(s.renderWhitespace===4||s.renderWhitespace===1||s.renderWhitespace===2&&s.selectionsOnLine||s.renderWhitespace===3&&!s.continuesWithWrappedLine)&&(r=b0e(s,e,n,r));let o=0;if(s.lineDecorations.length>0){for(let a=0,l=s.lineDecorations.length;a<l;a++){const c=s.lineDecorations[a];c.type===3||c.type===1?o|=1:c.type===2&&(o|=2)}r=C0e(e,n,r,s.lineDecorations)}return s.containsRTL?r=p0e(e,r):r=m0e(e,r,!s.isBasicASCII||s.fontLigatures),new d0e(s.useMonospaceOptimizations,s.canUseHalfwidthRightwardsArrow,e,n,t,i,r,o,s.fauxIndentLength,s.tabSize,s.startVisibleColumn,s.spaceWidth,s.renderSpaceCharCode,s.renderWhitespace,s.renderControlCharacters)}function g0e(s,e,t,i,n){const r=[];let o=0;i>0&&(r[o++]=new nn(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const u=t.getEndOffset(l);if(u<=i)continue;const d=t.getClassName(l);if(u>=n){const p=e?gw(s.substring(a,n)):!1;r[o++]=new nn(n,d,0,p);break}const g=e?gw(s.substring(a,u)):!1;r[o++]=new nn(u,d,0,g),a=u}return r}function m0e(s,e,t){let i=0;const n=[];let r=0;if(t)for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex;if(i+50<c){const u=l.type,d=l.metadata,g=l.containsRTL;let p=-1,_=i;for(let C=i;C<c;C++)s.charCodeAt(C)===32&&(p=C),p!==-1&&C-_>=50&&(n[r++]=new nn(p+1,u,d,g),_=p+1,p=-1);_!==c&&(n[r++]=new nn(c,u,d,g))}else n[r++]=l;i=c}else for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex,u=c-i;if(u>50){const d=l.type,g=l.metadata,p=l.containsRTL,_=Math.ceil(u/50);for(let C=1;C<_;C++){const v=i+C*50;n[r++]=new nn(v,d,g,p)}n[r++]=new nn(c,d,g,p)}else n[r++]=l;i=c}return n}function p0e(s,e){if(e.length===0)return e;const t=e[0];if(!t.containsRTL)return e;const i=t.endIndex;let n=0;for(let o=0;o<i;o++){const a=s.charCodeAt(o);if(a!==32&&a!==9){n=o;break}}if(n===0)return e;const r=[];r.push(new nn(n,t.type,t.metadata,!1)),r.push(new nn(i,t.type,t.metadata,t.containsRTL));for(let o=1;o<e.length;o++)r.push(e[o]);return r}function FX(s){return s<32?s!==9:s===127||s>=8234&&s<=8238||s>=8294&&s<=8297||s>=8206&&s<=8207||s===1564}function _0e(s,e){const t=[];let i=new nn(0,"",0,!1),n=0;for(const r of e){const o=r.endIndex;for(;n<o;n++){const a=s.charCodeAt(n);FX(a)&&(n>i.endIndex&&(i=new nn(n,r.type,r.metadata,r.containsRTL),t.push(i)),i=new nn(n+1,"mtkcontrol",r.metadata,!1),t.push(i))}n>i.endIndex&&(i=new nn(o,r.type,r.metadata,r.containsRTL),t.push(i))}return t}function b0e(s,e,t,i){const n=s.continuesWithWrappedLine,r=s.fauxIndentLength,o=s.tabSize,a=s.startVisibleColumn,l=s.useMonospaceOptimizations,c=s.selectionsOnLine,u=s.renderWhitespace===1,d=s.renderWhitespace===3,g=s.renderSpaceWidth!==s.spaceWidth,p=[];let _=0,C=0,v=i[C].type,x=i[C].containsRTL,S=i[C].endIndex;const k=i.length;let E=!1,T=Lr(e),R;T===-1?(E=!0,T=t,R=t):R=rm(e);let N=!1,A=0,O=c&&c[A],W=a%o;for(let F=r;F<t;F++){const q=e.charCodeAt(F);O&&O.endExclusive<=F&&(A++,O=c&&c[A]);let Z;if(F<T||F>R)Z=!0;else if(q===9)Z=!0;else if(q===32)if(u)if(N)Z=!0;else{const K=F+1<t?e.charCodeAt(F+1):0;Z=K===32||K===9}else Z=!0;else Z=!1;if(Z&&c&&(Z=!!O&&O.start<=F&&F<O.endExclusive),Z&&d&&(Z=E||F>R),Z&&x&&F>=T&&F<=R&&(Z=!1),N){if(!Z||!l&&W>=o){if(g){const K=_>0?p[_-1].endIndex:r;for(let U=K+1;U<=F;U++)p[_++]=new nn(U,"mtkw",1,!1)}else p[_++]=new nn(F,"mtkw",1,!1);W=W%o}}else(F===S||Z&&F>r)&&(p[_++]=new nn(F,v,0,x),W=W%o);for(q===9?W=o:Mh(q)?W+=2:W++,N=Z;F===S&&(C++,C<k);)v=i[C].type,x=i[C].containsRTL,S=i[C].endIndex}let j=!1;if(N)if(n&&u){const F=t>0?e.charCodeAt(t-1):0,q=t>1?e.charCodeAt(t-2):0;F===32&&q!==32&&q!==9||(j=!0)}else j=!0;if(j)if(g){const F=_>0?p[_-1].endIndex:r;for(let q=F+1;q<=t;q++)p[_++]=new nn(q,"mtkw",1,!1)}else p[_++]=new nn(t,"mtkw",1,!1);else p[_++]=new nn(t,v,0,x);return p}function C0e(s,e,t,i){i.sort(Oo.compare);const n=h0e.normalize(s,i),r=n.length;let o=0;const a=[];let l=0,c=0;for(let d=0,g=t.length;d<g;d++){const p=t[d],_=p.endIndex,C=p.type,v=p.metadata,x=p.containsRTL;for(;o<r&&n[o].startOffset<_;){const S=n[o];if(S.startOffset>c&&(c=S.startOffset,a[l++]=new nn(c,C,v,x)),S.endOffset+1<=_)c=S.endOffset+1,a[l++]=new nn(c,C+" "+S.className,v|S.metadata,x),o++;else{c=_,a[l++]=new nn(c,C+" "+S.className,v|S.metadata,x);break}}_>c&&(c=_,a[l++]=new nn(c,C,v,x))}const u=t[t.length-1].endIndex;if(o<r&&n[o].startOffset===u)for(;o<r&&n[o].startOffset===u;){const d=n[o];a[l++]=new nn(c,d.className,d.metadata,!1),o++}return a}function w0e(s,e){const t=s.fontIsMonospace,i=s.canUseHalfwidthRightwardsArrow,n=s.containsForeignElements,r=s.lineContent,o=s.len,a=s.isOverflowing,l=s.overflowingCharCount,c=s.parts,u=s.fauxIndentLength,d=s.tabSize,g=s.startVisibleColumn,p=s.spaceWidth,_=s.renderSpaceCharCode,C=s.renderWhitespace,v=s.renderControlCharacters,x=new Tl(o+1,c.length);let S=!1,k=0,E=g,T=0,R=0,N=0;e.appendString("<span>");for(let A=0,O=c.length;A<O;A++){const W=c[A],j=W.endIndex,F=W.type,q=W.containsRTL,Z=C!==0&&W.isWhitespace(),K=Z&&!t&&(F==="mtkw"||!n),U=k===j&&W.isPseudoAfter();if(T=0,e.appendString("<span "),q&&e.appendString('dir="rtl" style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(K?"mtkz":F),e.appendASCIICharCode(34),Z){let G=0;{let Q=k,le=E;for(;Q<j;Q++){const V=(r.charCodeAt(Q)===9?d-le%d:1)|0;G+=V,Q>=u&&(le+=V)}}for(K&&(e.appendString(' style="width:'),e.appendString(String(p*G)),e.appendString('px"')),e.appendASCIICharCode(62);k<j;k++){x.setColumnInfo(k+1,A-N,T,R),N=0;const Q=r.charCodeAt(k);let le,ve;if(Q===9){le=d-E%d|0,ve=le,!i||ve>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let V=2;V<=ve;V++)e.appendCharCode(160)}else le=2,ve=1,e.appendCharCode(_),e.appendCharCode(8204);T+=le,R+=ve,k>=u&&(E+=ve)}}else for(e.appendASCIICharCode(62);k<j;k++){x.setColumnInfo(k+1,A-N,T,R),N=0;const G=r.charCodeAt(k);let Q=1,le=1;switch(G){case 9:Q=d-E%d,le=Q;for(let ve=1;ve<=Q;ve++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Mh(G)&&le++,v&&G<32?e.appendCharCode(9216+G):v&&G===127?e.appendCharCode(9249):v&&FX(G)?(e.appendString("[U+"),e.appendString(v0e(G)),e.appendString("]"),Q=8,le=Q):e.appendCharCode(G)}T+=Q,R+=le,k>=u&&(E+=le)}U?N++:N=0,k>=o&&!S&&W.isPseudoAfter()&&(S=!0,x.setColumnInfo(k+1,A,T,R)),e.appendString("</span>")}return S||x.setColumnInfo(o+1,c.length-1,T,R),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(w(796,"Show more ({0})",y0e(l))),e.appendString("</span>")),e.appendString("</span>"),new fk(x,n)}function v0e(s){return s.toString(16).toUpperCase().padStart(4,"0")}function y0e(s){return s<1024?w(797,"{0} chars",s):s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(1)} MB`}class sU{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}}class S0e{constructor(e,t){this.tabSize=e,this.data=t}}class s6{constructor(e,t,i,n,r,o,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=r,this.tokens=o,this.inlineDecorations=a}}class co{constructor(e,t,i,n,r,o,a,l,c,u,d,g){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=co.isBasicASCII(i,o),this.containsRTL=co.containsRTL(i,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=u,this.textDirection=d,this.hasVariableFonts=g}static isBasicASCII(e,t){return t?S7(e):!0}static containsRTL(e,t,i){return!t&&i?gw(e):!1}}class Ew{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&sn(e.data,t.data)}static equalsArr(e,t){return sn(e,t,Ew.equals)}}function x0e(s){return Array.isArray(s)}function L0e(s){return!x0e(s)}function BX(s){return typeof s=="string"}function rU(s){return!BX(s)}function Cf(s){return!s}function Eh(s,e){return s.ignoreCase&&e?e.toLowerCase():e}function oU(s){return s.replace(/[&<>'"_]/g,"-")}function k0e(s,e){console.log(`${s.languageId}: ${e}`)}function ii(s,e){return new Error(`${s.languageId}: ${e}`)}function Tu(s,e,t,i,n){const r=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(r,function(a,l,c,u,d,g,p,_,C){return Cf(c)?Cf(u)?!Cf(d)&&d<i.length?Eh(s,i[d]):!Cf(p)&&s&&typeof s[p]=="string"?s[p]:(o===null&&(o=n.split("."),o.unshift(n)),!Cf(g)&&g<o.length?Eh(s,o[g]):""):Eh(s,t):"$"})}function E0e(s,e,t){const i=/\$[sS](\d\d?)/g;let n=null;return e.replace(i,function(r,o){return n===null&&(n=t.split("."),n.unshift(t)),!Cf(o)&&o<n.length?Yl(Eh(s,n[o])):""})}function US(s,e){let t=e;for(;t&&t.length>0;){const i=s.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function D0e(s,e){let t=e;for(;t&&t.length>0;){if(s.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var T0e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},N0e=function(s,e){return function(t,i){e(t,i,s)}},H4;const VX=5,$E=class $E{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new D_(e,t);let i=D_.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new D_(e,t),this._entries[i]=n,n)}};$E._INSTANCE=new $E(VX);let Dw=$E;class D_{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return D_._equals(this,e)}push(e){return Dw.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Dw.create(this.parent,e)}}class Up{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new Up(this.languageId,this.state)}}const qE=class qE{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new q0(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new q0(e,t);const i=D_.getStackElementId(e);let n=this._entries[i];return n||(n=new q0(e,null),this._entries[i]=n,n)}};qE._INSTANCE=new qE(VX);let Nu=qE;class q0{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Nu.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof q0)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class I0e{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new fw(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,a=qi.get(r);if(!a)return this.enterLanguage(r),this.emit(n,""),o;const l=a.tokenize(e,t,o);if(n!==0)for(const c of l.tokens)this._tokens.push(new fw(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new _7(this._tokens,e)}}class gk{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,r=t.length,o=i!==null?i.length:0;if(n===0&&r===0&&o===0)return new Uint32Array(0);if(n===0&&r===0)return i;if(r===0&&o===0)return e;const a=new Uint32Array(n+r+o);e!==null&&a.set(e);for(let l=0;l<r;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+r),a}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,a=qi.get(r);if(!a)return this.enterLanguage(r),this.emit(n,""),o;const l=a.tokenizeEncoded(e,t,o);if(n!==0)for(let c=0,u=l.tokens.length;c<u;c+=2)l.tokens[c]+=n;return this._prependTokens=gk._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new X2(gk._merge(this._prependTokens,this._tokens,null),e)}}let Tw=H4=class extends ne{constructor(e,t,i,n,r){super(),this._configurationService=r,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._register(qi.onDidChange(a=>{if(o)return;let l=!1;for(let c=0,u=a.changedLanguages.length;c<u;c++){const d=a.changedLanguages[c];if(this._embeddedLanguages[d]){l=!0;break}}l&&(o=!0,qi.handleChange([this._languageId]),o=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=qi.get(t);if(i){if(i instanceof H4){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}qi.isResolved(t)||e.push(qi.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=Dw.create(null,this._lexer.start);return Nu.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return OX(this._languageId,i);const n=new I0e,r=this._tokenize(e,t,i,n);return n.finalize(r)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return i6(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new gk(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),r=this._tokenize(e,t,i,n);return n.finalize(r)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=US(this._lexer,t.stack.state),!i))throw ii(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,r=!1;for(const o of i){if(!rU(o.action)||!(o.action.nextEmbedded==="@pop"||o.action.hasEmbeddedEndInCases))continue;r=!0;let a=o.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const u=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),u)}const c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!r)throw ii(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,r){const o=this._findLeavingNestedLanguageOffset(e,i);if(o===-1){const c=r.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return Nu.create(i.stack,new Up(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,o);a.length>0&&r.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(o);return this._myTokenize(l,t,i,n+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,r){r.enterLanguage(this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,u=i.stack,d=0,g=null,p=!0;for(;p||d<l;){const _=d,C=u.depth,v=g?g.groups.length:0,x=u.state;let S=null,k=null,E=null,T=null,R=null;if(g){S=g.matches;const O=g.groups.shift();k=O.matched,E=O.action,T=g.rule,g.groups.length===0&&(g=null)}else{if(!p&&d>=l)break;p=!1;let O=this._lexer.tokenizer[x];if(!O&&(O=US(this._lexer,x),!O))throw ii(this._lexer,"tokenizer state is not defined: "+x);const W=a.substr(d);for(const j of O)if((d===0||!j.matchOnlyAtLineStart)&&(S=W.match(j.resolveRegex(x)),S)){k=S[0],E=j.action;break}}if(S||(S=[""],k=""),E||(d<l&&(S=[a.charAt(d)],k=S[0]),E=this._lexer.defaultToken),k===null)break;for(d+=k.length;L0e(E)&&rU(E)&&E.test;)E=E.test(k,S,x,d===l);let N=null;if(typeof E=="string"||Array.isArray(E))N=E;else if(E.group)N=E.group;else if(E.token!==null&&E.token!==void 0){if(E.tokenSubst?N=Tu(this._lexer,E.token,k,S,x):N=E.token,E.nextEmbedded)if(E.nextEmbedded==="@pop"){if(!c)throw ii(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw ii(this._lexer,"cannot enter embedded language from within an embedded language");R=Tu(this._lexer,E.nextEmbedded,k,S,x)}if(E.goBack&&(d=Math.max(0,d-E.goBack)),E.switchTo&&typeof E.switchTo=="string"){let O=Tu(this._lexer,E.switchTo,k,S,x);if(O[0]==="@"&&(O=O.substr(1)),US(this._lexer,O))u=u.switchTo(O);else throw ii(this._lexer,"trying to switch to a state '"+O+"' that is undefined in rule: "+this._safeRuleName(T))}else{if(E.transform&&typeof E.transform=="function")throw ii(this._lexer,"action.transform not supported");if(E.next)if(E.next==="@push"){if(u.depth>=this._lexer.maxStack)throw ii(this._lexer,"maximum tokenizer stack size reached: ["+u.state+","+u.parent.state+",...]");u=u.push(x)}else if(E.next==="@pop"){if(u.depth<=1)throw ii(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(T));u=u.pop()}else if(E.next==="@popall")u=u.popall();else{let O=Tu(this._lexer,E.next,k,S,x);if(O[0]==="@"&&(O=O.substr(1)),US(this._lexer,O))u=u.push(O);else throw ii(this._lexer,"trying to set a next state '"+O+"' that is undefined in rule: "+this._safeRuleName(T))}}E.log&&typeof E.log=="string"&&k0e(this._lexer,this._lexer.languageId+": "+Tu(this._lexer,E.log,k,S,x))}if(N===null)throw ii(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(T));const A=O=>{const W=this._languageService.getLanguageIdByLanguageName(O)||this._languageService.getLanguageIdByMimeType(O)||O,j=this._getNestedEmbeddedLanguageData(W);if(d<l){const F=e.substr(d);return this._nestedTokenize(F,t,Nu.create(u,j),n+d,r)}else return Nu.create(u,j)};if(Array.isArray(N)){if(g&&g.groups.length>0)throw ii(this._lexer,"groups cannot be nested: "+this._safeRuleName(T));if(S.length!==N.length+1)throw ii(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(T));let O=0;for(let W=1;W<S.length;W++)O+=S[W].length;if(O!==k.length)throw ii(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(T));g={rule:T,matches:S,groups:[]};for(let W=0;W<N.length;W++)g.groups[W]={action:N[W],matched:S[W+1]};d-=k.length;continue}else{if(N==="@rematch"&&(d-=k.length,k="",S=null,N="",R!==null))return A(R);if(k.length===0){if(l===0||C!==u.depth||x!==u.state||(g?g.groups.length:0)!==v)continue;throw ii(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(T))}let O=null;if(BX(N)&&N.indexOf("@brackets")===0){const W=N.substr(9),j=R0e(this._lexer,k);if(!j)throw ii(this._lexer,"@brackets token returned but no bracket defined as: "+k);O=oU(j.token+W)}else{const W=N===""?"":N+this._lexer.tokenPostfix;O=oU(W)}_<o&&r.emit(_+n,O)}if(R!==null)return A(R)}return Nu.create(u,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new Up(e,kw);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),qi.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=qi.get(e);return t?new Up(e,t.getInitialState()):new Up(e,kw)}};Tw=H4=T0e([N0e(4,ai)],Tw);function R0e(s,e){if(!e)return null;e=Eh(s,e);const t=s.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const lR=yd("standaloneColorizer",{createHTML:s=>s});class r6{static colorizeElement(e,t,i,n){n=n||{};const r=n.theme||"vs",o=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(o)||o;e.setTheme(r);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+r;const c=u=>{const d=(lR==null?void 0:lR.createHTML(u))??u;i.innerHTML=d};return this.colorize(t,l||"",a,n).then(c,u=>console.error(u))}static async colorize(e,t,i,n){const r=e.languageIdCodec;let o=4;n&&typeof n.tabSize=="number"&&(o=n.tabSize),L7(t)&&(t=t.substr(1));const a=F1(t);if(!e.isRegisteredLanguageId(i))return aU(a,o,r);const l=await qi.getOrCreate(i);return l?A0e(a,o,l,r):aU(a,o,r)}static colorizeLine(e,t,i,n,r=4){const o=co.isBasicASCII(e,t),a=co.containsRTL(e,o,i);return SD(new um(!1,!0,e,!1,o,a,0,n,[],r,0,0,0,0,-1,"none",!1,!1,null,null,0)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const o=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function A0e(s,e,t,i){return new Promise((n,r)=>{const o=()=>{const a=M0e(s,e,t,i);if(t instanceof Tw){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,r);return}}n(a)};o()})}function aU(s,e,t){let i=[];const r=new Uint32Array(2);r[0]=0,r[1]=33587200;for(let o=0,a=s.length;o<a;o++){const l=s[o];r[0]=l.length;const c=new gn(r,l,t),u=co.isBasicASCII(l,!0),d=co.containsRTL(l,u,!0),g=SD(new um(!1,!0,l,!1,u,d,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null,null,0));i=i.concat(g.html),i.push("<br/>")}return i.join("")}function M0e(s,e,t,i){let n=[],r=t.getInitialState();for(let o=0,a=s.length;o<a;o++){const l=s[o],c=t.tokenizeEncoded(l,!0,r);gn.convertToEndOffset(c.tokens,l.length);const u=new gn(c.tokens,l,i),d=co.isBasicASCII(l,!0),g=co.containsRTL(l,d,!0),p=SD(new um(!1,!0,l,!1,d,g,0,u.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null,null,0));n=n.concat(p.html),n.push("<br/>"),r=c.endState}return n.join("")}const lU=2e4;let wf,Wx,z4,Hx,U4;function O0e(s){wf=document.createElement("div"),wf.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),wf.appendChild(i),i};Wx=e(),z4=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),wf.appendChild(i),i};Hx=t(),U4=t(),s.appendChild(wf)}function Nw(s){wf&&(Wx.textContent!==s?(Ya(z4),pk(Wx,s)):(Ya(Wx),pk(z4,s)))}function mk(s){wf&&(Hx.textContent!==s?(Ya(U4),pk(Hx,s)):(Ya(Hx),pk(U4,s)))}function pk(s,e){Ya(s),e.length>lU&&(e=e.substr(0,lU)),s.textContent=e,s.style.visibility="hidden",s.style.visibility="visible"}const WX=tt("markerDecorationsService");var P0e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},F0e=function(s,e){return function(t,i){e(t,i,s)}},$_;let _k=($_=class{constructor(e,t){}dispose(){}},$_.ID="editor.contrib.markerDecorations",$_);_k=P0e([F0e(1,WX)],_k);uX(_k.ID,_k,0);class HX extends ne{constructor(e,t){super(),this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,n=!1;const r=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{hr(Ae(this._referenceDomElement),()=>{n=!1,r()})}};this._resizeObserver=new ResizeObserver(o=>{o&&o[0]&&o[0].contentRect?e={width:o[0].contentRect.width,height:o[0].contentRect.height}:e=null,i=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}}const o_=class o_{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=o_._read(e,this.key),i=r=>o_._read(e,r),n=(r,o)=>o_._write(e,r,o);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u"||e===null)return;const i=t.indexOf(".");if(i>=0){const n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){const n=t.indexOf(".");if(n>=0){const r=t.substring(0,n);e[r]=e[r]||{},this._write(e[r],t.substring(n+1),i);return}e[t]=i}};o_.items=[];let Iw=o_;function Ho(s,e){Iw.items.push(new Iw(s,e))}function Ys(s,e){Ho(s,(t,i,n)=>{if(typeof t<"u"){for(const[r,o]of e)if(t===r){n(s,o);return}}})}function B0e(s){Iw.items.forEach(e=>e.apply(s))}Ys("wordWrap",[[!0,"on"],[!1,"off"]]);Ys("lineNumbers",[[!0,"on"],[!1,"off"]]);Ys("cursorBlinking",[["visible","solid"]]);Ys("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Ys("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Ys("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Ys("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Ys("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ys("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ys("autoIndent",[[!1,"advanced"],[!0,"full"]]);Ys("matchBrackets",[[!0,"always"],[!1,"never"]]);Ys("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Ys("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Ys("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);Ys("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Ys("defaultColorDecorators",[[!0,"auto"],[!1,"never"]]);Ys("minimap.autohide",[[!0,"mouseover"],[!1,"none"]]);Ho("autoClosingBrackets",(s,e,t)=>{s===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Ho("renderIndentGuides",(s,e,t)=>{typeof s<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!s))});Ho("highlightActiveIndentGuide",(s,e,t)=>{typeof s<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!s))});const V0e={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Ho("suggest.filteredTypes",(s,e,t)=>{if(s&&typeof s=="object"){for(const i of Object.entries(V0e))s[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});Ho("quickSuggestions",(s,e,t)=>{if(typeof s=="boolean"){const i=s?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});Ho("experimental.stickyScroll.enabled",(s,e,t)=>{typeof s=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",s))});Ho("experimental.stickyScroll.maxLineCount",(s,e,t)=>{typeof s=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",s))});Ho("editor.experimentalEditContextEnabled",(s,e,t)=>{typeof s=="boolean"&&(t("editor.experimentalEditContextEnabled",void 0),typeof e("editor.editContext")>"u"&&t("editor.editContext",s))});Ho("codeActionsOnSave",(s,e,t)=>{if(s&&typeof s=="object"){let i=!1;const n={};for(const r of Object.entries(s))typeof r[1]=="boolean"?(i=!0,n[r[0]]=r[1]?"explicit":"never"):n[r[0]]=r[1];i&&t("codeActionsOnSave",n)}});Ho("codeActionWidget.includeNearbyQuickfixes",(s,e,t)=>{typeof s=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",s))});Ho("lightbulb.enabled",(s,e,t)=>{typeof s=="boolean"&&t("lightbulb.enabled",s?void 0:"off")});Ho("inlineSuggest.edits.codeShifting",(s,e,t)=>{typeof s=="boolean"&&(t("inlineSuggest.edits.codeShifting",void 0),t("inlineSuggest.edits.allowCodeShifting",s?"always":"never"))});class W0e{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new $,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const bk=new W0e;function H0e(s,e,t){const i=s.get(58),n=s.get(62),r=s.get(61),o=s.get(60),a=s.get(63),l=s.get(75),c=s.get(72);return Og._create(i,n,r,o,a,l,c,e,t)}function z0e(s,e,t=!1){const i=Kr.fontFamily.validate(s.fontFamily),n=Kr.fontWeight.validate(s.fontWeight),r=Kr.fontSize.validate(s.fontSize),o=Kr.fontLigatures2.validate(s.fontLigatures),a=Kr.fontVariations.validate(s.fontVariations),l=Kr.lineHeight.validate(s.lineHeight),c=Kr.letterSpacing.validate(s.letterSpacing);return Og._create(i,n,r,o,a,l,c,e,t)}const uo=tt("accessibilityService"),U0e=new Ne("accessibilityModeEnabled",!1);class j0e{constructor(){this._inputMode="insert",this._onDidChangeInputMode=new $,this.onDidChangeInputMode=this._onDidChangeInputMode.event}getInputMode(){return this._inputMode}}const j4=new j0e;var $0e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},q0e=function(s,e){return function(t,i){e(t,i,s)}};let $4=class extends ne{constructor(e,t,i,n,r){super(),this._accessibilityService=r,this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new $),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new gQ,this.isSimpleWidget=e,this.contextMenuId=t,this._containerObserver=this._register(new HX(n,i.dimension)),this._targetWindowId=Ae(n).vscodeWindowId,this._rawOptions=cU(i),this._validatedOptions=Iu.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(19)&&this._containerObserver.startObserving(),this._register(Du.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(bk.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(C4.onDidChange(()=>this._recomputeOptions())),this._register(JL.getInstance(Ae(n)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions())),this._register(j4.onDidChangeInputMode(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Iu.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=H0e(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:this._validatedOptions.get(164)||bk.getTabFocusMode(),inputMode:j4.getInputMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount,editContextSupported:e.editContextSupported};return Iu.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:K0e(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:J2||Er,pixelRatio:JL.getInstance(QH(this._targetWindowId,!0).window).value,editContextSupported:typeof globalThis.EditContext=="function",accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return C4.readFontInfo(QH(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=cU(e);Iu.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Iu.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=G0e(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};$4=$0e([q0e(4,uo)],$4);function G0e(s){let e=0;for(;s;)s=Math.floor(s/10),e++;return e||1}function K0e(){let s="";return Fg||OQ?(s+="no-minimap-shadow ",s+="enable-user-select "):s+="no-user-select ",rt&&(s+="mac "),s}class Y0e{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class Q0e{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Iu{static validateOptions(e){const t=new Y0e;for(const i of Pp){const n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new Q0e;for(const n of Pp)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?sn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Iu._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const r of Pp){const o=!Iu._deepEquals(e._read(r.id),t._read(r.id));i[r.id]=o,o&&(n=!0)}return n?new fQ(i):null}static applyUpdate(e,t){let i=!1;for(const n of Pp)if(t.hasOwnProperty(n.name)){const r=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=r.newValue,i=i||r.didChange}return i}}function cU(s){const e=eh(s);return B0e(e),e}var Pu;(function(s){const e={total:0,min:Number.MAX_VALUE,max:0},t={...e},i={...e},n={...e};let r=0;const o={keydown:0,input:0,render:0};function a(){x(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),o.keydown=1,queueMicrotask(l)}s.onKeyDown=a;function l(){o.keydown===1&&(performance.mark("keydown/end"),o.keydown=2)}function c(){performance.mark("input/start"),o.input=1,v()}s.onBeforeInput=c;function u(){o.input===0&&c(),queueMicrotask(d)}s.onInput=u;function d(){o.input===1&&(performance.mark("input/end"),o.input=2)}function g(){x()}s.onKeyUp=g;function p(){x()}s.onSelectionChange=p;function _(){o.keydown===2&&o.input===2&&o.render===0&&(performance.mark("render/start"),o.render=1,queueMicrotask(C),v())}s.onRenderStart=_;function C(){o.render===1&&(performance.mark("render/end"),o.render=2)}function v(){setTimeout(x)}function x(){o.keydown===2&&o.input===2&&o.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),S("keydown",e),S("input",t),S("render",i),S("inputlatency",n),r++,k())}function S(N,A){const O=performance.getEntriesByName(N)[0].duration;A.total+=O,A.min=Math.min(A.min,O),A.max=Math.max(A.max,O)}function k(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),o.keydown=0,o.input=0,o.render=0}function E(){if(r===0)return;const N={keydown:T(e),input:T(t),render:T(i),total:T(n),sampleCount:r};return R(e),R(t),R(i),R(n),r=0,N}s.getAndClearMeasurements=E;function T(N){return{average:N.total/r,max:N.max,min:N.min}}function R(N){N.total=0,N.min=Number.MAX_VALUE,N.max=0}})(Pu||(Pu={}));const zX=new Map;function Qa(s=Ut.document.head,e,t){const i=document.createElement("style");if(i.type="text/css",i.media="screen",e==null||e(i),s.appendChild(i),s===Ut.document.head){const n=new Set;zX.set(i,n);for(const{window:r,disposables:o}of qQ())r!==Ut&&o.add(X0e(i,n,r))}return i}function X0e(s,e,t){var r,o;const i=new Ee,n=s.cloneNode(!0);t.document.head.appendChild(n),i.add(Fe(()=>n.remove()));for(const a of J0e(s))(o=n.sheet)==null||o.insertRule(a.cssText,(r=n.sheet)==null?void 0:r.cssRules.length);return i.add(Ype.observe(s,i,{childList:!0,subtree:Er,characterData:Er})(()=>{n.textContent=s.textContent})),e.add(n),i.add(Fe(()=>e.delete(n))),i}let cR=null;function Z0e(){return cR||(cR=Qa()),cR}function J0e(s){var e,t;return(e=s==null?void 0:s.sheet)!=null&&e.rules?s.sheet.rules:(t=s==null?void 0:s.sheet)!=null&&t.cssRules?s.sheet.cssRules:[]}function q4(s,e,t=Z0e()){var i;if(!(!t||!e)){(i=t.sheet)==null||i.insertRule(`${s} {${e}}`,0);for(const n of zX.get(t)??[])q4(s,e,n)}}class xD{constructor(){this._hooks=new Ee,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=r;let o=e;try{e.setPointerCapture(t),this._hooks.add(Fe(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{o=Ae(e)}this._hooks.add(J(o,pe.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(J(o,pe.POINTER_UP,a=>this.stopMonitoring(!0)))}}function o6(s){return`--vscode-${s.replace(/\./g,"-")}`}function Ce(s){return`var(${o6(s)})`}function eCe(s,e){return`var(${o6(s)}, ${e})`}function tCe(s){return s!==null&&typeof s=="object"&&"light"in s&&"dark"in s}const UX={ColorContribution:"base.contributions.colors"},iCe="default";class nCe extends ne{constructor(){super(),this._onDidChangeSchema=this._register(new $),this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,r){const o={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:r};this.colorsById[e]=o;const a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=w(2022,"This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:iCe,description:w(2023,"Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i!=null&&i.defaults){const n=tCe(i.defaults)?i.defaults[t.type]:i.defaults;return vo(n,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const n=t.indexOf(".")===-1?0:1,r=i.indexOf(".")===-1?0:1;return n!==r?n-r:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const LD=new nCe;Fn.add(UX.ColorContribution,LD);function B(s,e,t,i,n){return LD.registerColor(s,e,t,i,n)}function sCe(s,e){var t,i,n,r;switch(s.op){case 0:return(t=vo(s.value,e))==null?void 0:t.darken(s.factor);case 1:return(i=vo(s.value,e))==null?void 0:i.lighten(s.factor);case 2:return(n=vo(s.value,e))==null?void 0:n.transparent(s.factor);case 7:{const o=vo(s.color,e)||ae.transparent,a=vo(s.with,e)||ae.transparent;return o.mix(a,s.ratio)}case 3:{const o=vo(s.background,e);return o?(r=vo(s.value,e))==null?void 0:r.makeOpaque(o):vo(s.value,e)}case 4:for(const o of s.values){const a=vo(o,e);if(a)return a}return;case 6:return vo(e.defines(s.if)?s.then:s.else,e);case 5:{const o=vo(s.value,e);if(!o)return;const a=vo(s.background,e);return a?o.isDarkerThan(a)?ae.getLighterColor(o,a,s.factor).transparent(s.transparency):ae.getDarkerColor(o,a,s.factor).transparent(s.transparency):o.transparent(s.factor*s.transparency)}default:throw r7()}}function dm(s,e){return{op:0,value:s,factor:e}}function Ga(s,e){return{op:1,value:s,factor:e}}function st(s,e){return{op:2,value:s,factor:e}}function hU(...s){return{op:4,values:s}}function rCe(s,e,t){return{op:6,if:s,then:e,else:t}}function uU(s,e,t,i){return{op:5,value:s,background:e,factor:t,transparency:i}}function vo(s,e){if(s!==null){if(typeof s=="string")return s[0]==="#"?ae.fromHex(s):e.getColor(s);if(s instanceof ae)return s;if(typeof s=="object")return sCe(s,e)}}const jX="vscode://schemas/workbench-colors",$X=Fn.as(CD.JSONContribution);$X.registerSchema(jX,LD.getColorSchema());const dU=new os(()=>$X.notifySchemaChanged(jX),200);LD.onDidChangeSchema(()=>{dU.isScheduled()||dU.schedule()});const $t=B("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},w(1773,"Overall foreground color. This color is only used if not overridden by a component."));B("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},w(1774,"Overall foreground for disabled elements. This color is only used if not overridden by a component."));B("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},w(1775,"Overall foreground color for error messages. This color is only used if not overridden by a component."));B("descriptionForeground",{light:"#717171",dark:st($t,.7),hcDark:st($t,.7),hcLight:st($t,.7)},w(1776,"Foreground color for description text providing additional information, for example for a label."));const G4=B("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},w(1777,"The default color for icons in the workbench.")),Xl=B("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},w(1778,"Overall border color for focused elements. This color is only used if not overridden by a component.")),Ct=B("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},w(1779,"An extra border around elements to separate them from others for greater contrast.")),Hi=B("contrastActiveBorder",{light:null,dark:null,hcDark:Xl,hcLight:Xl},w(1780,"An extra border around active elements to separate them from others for greater contrast."));B("selection.background",null,w(1781,"The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const oCe=B("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},w(1782,"Foreground color for links in text."));B("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},w(1783,"Foreground color for links in text when clicked on and on mouse hover."));B("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:ae.black,hcLight:"#292929"},w(1784,"Color for text separators."));B("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},w(1785,"Foreground color for preformatted text segments."));B("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},w(1786,"Background color for preformatted text segments."));B("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},w(1787,"Background color for block quotes in text."));B("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:ae.white,hcLight:"#292929"},w(1788,"Border color for block quotes in text."));B("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:ae.black,hcLight:"#F2F2F2"},w(1789,"Background color for code blocks in text."));B("sash.hoverBorder",Xl,w(1994,"Border color of active sashes."));const zx=B("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:ae.black,hcLight:"#0F4A85"},w(1995,"Badge background color. Badges are small information labels, e.g. for search results count.")),aCe=B("badge.foreground",{dark:ae.white,light:"#333",hcDark:ae.white,hcLight:ae.white},w(1996,"Badge foreground color. Badges are small information labels, e.g. for search results count."));B("activityWarningBadge.foreground",{dark:ae.black.lighten(.2),light:ae.white,hcDark:null,hcLight:ae.black.lighten(.2)},w(1997,"Foreground color of the warning activity badge"));B("activityWarningBadge.background",{dark:"#CCA700",light:"#BF8803",hcDark:null,hcLight:"#CCA700"},w(1998,"Background color of the warning activity badge"));B("activityErrorBadge.foreground",{dark:ae.black.lighten(.2),light:ae.white,hcDark:null,hcLight:ae.black.lighten(.2)},w(1999,"Foreground color of the error activity badge"));B("activityErrorBadge.background",{dark:"#F14C4C",light:"#E51400",hcDark:null,hcLight:"#F14C4C"},w(2e3,"Background color of the error activity badge"));const a6=B("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},w(2001,"Scrollbar shadow to indicate that the view is scrolled.")),qX=B("scrollbarSlider.background",{dark:ae.fromHex("#797979").transparent(.4),light:ae.fromHex("#646464").transparent(.4),hcDark:st(Ct,.6),hcLight:st(Ct,.4)},w(2002,"Scrollbar slider background color.")),GX=B("scrollbarSlider.hoverBackground",{dark:ae.fromHex("#646464").transparent(.7),light:ae.fromHex("#646464").transparent(.7),hcDark:st(Ct,.8),hcLight:st(Ct,.8)},w(2003,"Scrollbar slider background color when hovering.")),KX=B("scrollbarSlider.activeBackground",{dark:ae.fromHex("#BFBFBF").transparent(.4),light:ae.fromHex("#000000").transparent(.6),hcDark:Ct,hcLight:Ct},w(2004,"Scrollbar slider background color when clicked on."));B("scrollbar.background",null,w(2005,"Scrollbar track background color."));const lCe=B("progressBar.background",{dark:ae.fromHex("#0E70C0"),light:ae.fromHex("#0E70C0"),hcDark:Ct,hcLight:Ct},w(2006,"Background color of the progress bar that can show for long running operations."));B("chart.line",{dark:"#236B8E",light:"#236B8E",hcDark:"#236B8E",hcLight:"#236B8E"},w(2007,"Line color for the chart."));B("chart.axis",{dark:ae.fromHex("#BFBFBF").transparent(.4),light:ae.fromHex("#000000").transparent(.6),hcDark:Ct,hcLight:Ct},w(2008,"Axis color for the chart."));B("chart.guide",{dark:ae.fromHex("#BFBFBF").transparent(.2),light:ae.fromHex("#000000").transparent(.2),hcDark:Ct,hcLight:Ct},w(2009,"Guide line for the chart."));const ga=B("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:ae.black,hcLight:ae.white},w(1798,"Editor background color.")),Wv=B("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:ae.white,hcLight:$t},w(1799,"Editor default foreground color."));B("editorStickyScroll.background",ga,w(1800,"Background color of sticky scroll in the editor"));B("editorStickyScrollGutter.background",ga,w(1801,"Background color of the gutter part of sticky scroll in the editor"));B("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:ae.fromHex("#0F4A85").transparent(.1)},w(1802,"Background color of sticky scroll on hover in the editor"));B("editorStickyScroll.border",{dark:null,light:null,hcDark:Ct,hcLight:Ct},w(1803,"Border color of sticky scroll in the editor"));B("editorStickyScroll.shadow",a6,w(1804," Shadow color of sticky scroll in the editor"));const ha=B("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:ae.white},w(1805,"Background color of editor widgets, such as find/replace.")),kD=B("editorWidget.foreground",$t,w(1806,"Foreground color of editor widgets, such as find/replace.")),YX=B("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Ct,hcLight:Ct},w(1807,"Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));B("editorWidget.resizeBorder",null,w(1808,"Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));B("editorError.background",null,w(1809,"Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const l6=B("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},w(1810,"Foreground color of error squigglies in the editor."));B("editorError.border",{dark:null,light:null,hcDark:ae.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},w(1811,"If set, color of double underlines for errors in the editor."));const cCe=B("editorWarning.background",null,w(1812,"Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),fd=B("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},w(1813,"Foreground color of warning squigglies in the editor.")),Ck=B("editorWarning.border",{dark:null,light:null,hcDark:ae.fromHex("#FFCC00").transparent(.8),hcLight:ae.fromHex("#FFCC00").transparent(.8)},w(1814,"If set, color of double underlines for warnings in the editor."));B("editorInfo.background",null,w(1815,"Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const Ug=B("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},w(1816,"Foreground color of info squigglies in the editor.")),wk=B("editorInfo.border",{dark:null,light:null,hcDark:ae.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},w(1817,"If set, color of double underlines for infos in the editor.")),hCe=B("editorHint.foreground",{dark:ae.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},w(1818,"Foreground color of hint squigglies in the editor."));B("editorHint.border",{dark:null,light:null,hcDark:ae.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},w(1819,"If set, color of double underlines for hints in the editor."));B("editorLink.activeForeground",{dark:"#4E94CE",light:ae.blue,hcDark:ae.cyan,hcLight:"#292929"},w(1820,"Color of active links."));const jp=B("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},w(1821,"Color of the editor selection.")),uCe=B("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:ae.white},w(1822,"Color of the selected text for high contrast.")),QX=B("editor.inactiveSelectionBackground",{light:st(jp,.5),dark:st(jp,.5),hcDark:st(jp,.7),hcLight:st(jp,.5)},w(1823,"Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),XX=B("editor.selectionHighlightBackground",{light:uU(jp,ga,.3,.6),dark:uU(jp,ga,.3,.6),hcDark:null,hcLight:null},w(1824,"Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);B("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Hi,hcLight:Hi},w(1825,"Border color for regions with the same content as the selection."));B("editor.compositionBorder",{light:"#000000",dark:"#ffffff",hcLight:"#000000",hcDark:"#ffffff"},w(1826,"The border color for an IME composition."));B("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},w(1827,"Color of the current search match."));B("editor.findMatchForeground",null,w(1828,"Text color of the current search match."));const Fu=B("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},w(1829,"Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0);B("editor.findMatchHighlightForeground",null,w(1830,"Foreground color of the other search matches."),!0);B("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},w(1831,"Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);B("editor.findMatchBorder",{light:null,dark:null,hcDark:Hi,hcLight:Hi},w(1832,"Border color of the current search match."));const $p=B("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Hi,hcLight:Hi},w(1833,"Border color of the other search matches."));B("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:st(Hi,.4),hcLight:st(Hi,.4)},w(1834,"Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);B("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},w(1835,"Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const fU=B("editorHoverWidget.background",ha,w(1836,"Background color of the editor hover."));B("editorHoverWidget.foreground",kD,w(1837,"Foreground color of the editor hover."));const dCe=B("editorHoverWidget.border",YX,w(1838,"Border color of the editor hover."));B("editorHoverWidget.statusBarBackground",{dark:Ga(fU,.2),light:dm(fU,.05),hcDark:ha,hcLight:ha},w(1839,"Background color of the editor hover status bar."));const ZX=B("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:ae.white,hcLight:ae.black},w(1840,"Foreground color of inline hints")),JX=B("editorInlayHint.background",{dark:st(zx,.1),light:st(zx,.1),hcDark:st(ae.white,.1),hcLight:st(zx,.1)},w(1841,"Background color of inline hints"));B("editorInlayHint.typeForeground",ZX,w(1842,"Foreground color of inline hints for types"));B("editorInlayHint.typeBackground",JX,w(1843,"Background color of inline hints for types"));B("editorInlayHint.parameterForeground",ZX,w(1844,"Foreground color of inline hints for parameters"));B("editorInlayHint.parameterBackground",JX,w(1845,"Background color of inline hints for parameters"));const fCe=B("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},w(1846,"The color used for the lightbulb actions icon."));B("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},w(1847,"The color used for the lightbulb auto fix actions icon."));B("editorLightBulbAi.foreground",fCe,w(1848,"The color used for the lightbulb AI icon."));B("editor.snippetTabstopHighlightBackground",{dark:new ae(new ie(124,124,124,.3)),light:new ae(new ie(10,50,100,.2)),hcDark:new ae(new ie(124,124,124,.3)),hcLight:new ae(new ie(10,50,100,.2))},w(1849,"Highlight background color of a snippet tabstop."));B("editor.snippetTabstopHighlightBorder",null,w(1850,"Highlight border color of a snippet tabstop."));B("editor.snippetFinalTabstopHighlightBackground",null,w(1851,"Highlight background color of the final tabstop of a snippet."));B("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new ae(new ie(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},w(1852,"Highlight border color of the final tabstop of a snippet."));const K4=new ae(new ie(155,185,85,.2)),Y4=new ae(new ie(255,0,0,.2)),gCe=B("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},w(1853,"Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),mCe=B("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},w(1854,"Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);B("diffEditor.insertedLineBackground",{dark:K4,light:K4,hcDark:null,hcLight:null},w(1855,"Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);B("diffEditor.removedLineBackground",{dark:Y4,light:Y4,hcDark:null,hcLight:null},w(1856,"Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);B("diffEditorGutter.insertedLineBackground",null,w(1857,"Background color for the margin where lines got inserted."));B("diffEditorGutter.removedLineBackground",null,w(1858,"Background color for the margin where lines got removed."));const pCe=B("diffEditorOverview.insertedForeground",null,w(1859,"Diff overview ruler foreground for inserted content.")),_Ce=B("diffEditorOverview.removedForeground",null,w(1860,"Diff overview ruler foreground for removed content."));B("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},w(1861,"Outline color for the text that got inserted."));B("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},w(1862,"Outline color for text that got removed."));B("diffEditor.border",{dark:null,light:null,hcDark:Ct,hcLight:Ct},w(1863,"Border color between the two text editors."));B("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},w(1864,"Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));B("diffEditor.unchangedRegionBackground","sideBar.background",w(1865,"The background color of unchanged blocks in the diff editor."));B("diffEditor.unchangedRegionForeground","foreground",w(1866,"The foreground color of unchanged blocks in the diff editor."));B("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},w(1867,"The background color of unchanged code in the diff editor."));const Hv=B("widget.shadow",{dark:st(ae.black,.36),light:st(ae.black,.16),hcDark:null,hcLight:null},w(1868,"Shadow color of widgets such as find/replace inside the editor.")),eZ=B("widget.border",{dark:null,light:null,hcDark:Ct,hcLight:Ct},w(1869,"Border color of widgets such as find/replace inside the editor.")),gU=B("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},w(1870,"Toolbar background when hovering over actions using the mouse"));B("toolbar.hoverOutline",{dark:null,light:null,hcDark:Hi,hcLight:Hi},w(1871,"Toolbar outline when hovering over actions using the mouse"));B("toolbar.activeBackground",{dark:Ga(gU,.1),light:dm(gU,.1),hcDark:null,hcLight:null},w(1872,"Toolbar background when holding the mouse over actions"));const bCe=B("breadcrumb.foreground",st($t,.8),w(1873,"Color of focused breadcrumb items.")),CCe=B("breadcrumb.background",ga,w(1874,"Background color of breadcrumb items.")),mU=B("breadcrumb.focusForeground",{light:dm($t,.2),dark:Ga($t,.1),hcDark:Ga($t,.1),hcLight:Ga($t,.1)},w(1875,"Color of focused breadcrumb items.")),wCe=B("breadcrumb.activeSelectionForeground",{light:dm($t,.2),dark:Ga($t,.1),hcDark:Ga($t,.1),hcLight:Ga($t,.1)},w(1876,"Color of selected breadcrumb items."));B("breadcrumbPicker.background",ha,w(1877,"Background color of breadcrumb item picker."));const tZ=.5,pU=ae.fromHex("#40C8AE").transparent(tZ),_U=ae.fromHex("#40A6FF").transparent(tZ),bU=ae.fromHex("#606060").transparent(.4),c6=.4,_1=1,Q4=B("merge.currentHeaderBackground",{dark:pU,light:pU,hcDark:null,hcLight:null},w(1878,"Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);B("merge.currentContentBackground",st(Q4,c6),w(1879,"Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const X4=B("merge.incomingHeaderBackground",{dark:_U,light:_U,hcDark:null,hcLight:null},w(1880,"Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);B("merge.incomingContentBackground",st(X4,c6),w(1881,"Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Z4=B("merge.commonHeaderBackground",{dark:bU,light:bU,hcDark:null,hcLight:null},w(1882,"Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);B("merge.commonContentBackground",st(Z4,c6),w(1883,"Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const b1=B("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},w(1884,"Border color on headers and the splitter in inline merge-conflicts."));B("editorOverviewRuler.currentContentForeground",{dark:st(Q4,_1),light:st(Q4,_1),hcDark:b1,hcLight:b1},w(1885,"Current overview ruler foreground for inline merge-conflicts."));B("editorOverviewRuler.incomingContentForeground",{dark:st(X4,_1),light:st(X4,_1),hcDark:b1,hcLight:b1},w(1886,"Incoming overview ruler foreground for inline merge-conflicts."));B("editorOverviewRuler.commonContentForeground",{dark:st(Z4,_1),light:st(Z4,_1),hcDark:b1,hcLight:b1},w(1887,"Common ancestor overview ruler foreground for inline merge-conflicts."));B("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},w(1888,"Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0);B("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",w(1889,"Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const vCe=B("problemsErrorIcon.foreground",l6,w(1890,"The color used for the problems error icon.")),yCe=B("problemsWarningIcon.foreground",fd,w(1891,"The color used for the problems warning icon.")),SCe=B("problemsInfoIcon.foreground",Ug,w(1892,"The color used for the problems info icon.")),xCe=B("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},w(1983,"Minimap marker color for find matches."),!0);B("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},w(1984,"Minimap marker color for repeating editor selections."),!0);const CU=B("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},w(1985,"Minimap marker color for the editor selection."),!0),LCe=B("minimap.infoHighlight",{dark:Ug,light:Ug,hcDark:wk,hcLight:wk},w(1986,"Minimap marker color for infos.")),kCe=B("minimap.warningHighlight",{dark:fd,light:fd,hcDark:Ck,hcLight:Ck},w(1987,"Minimap marker color for warnings.")),ECe=B("minimap.errorHighlight",{dark:new ae(new ie(255,18,18,.7)),light:new ae(new ie(255,18,18,.7)),hcDark:new ae(new ie(255,50,50,1)),hcLight:"#B5200D"},w(1988,"Minimap marker color for errors.")),DCe=B("minimap.background",null,w(1989,"Minimap background color.")),TCe=B("minimap.foregroundOpacity",ae.fromHex("#000f"),w(1990,'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));B("minimapSlider.background",st(qX,.5),w(1991,"Minimap slider background color."));B("minimapSlider.hoverBackground",st(GX,.5),w(1992,"Minimap slider background color when hovering."));B("minimapSlider.activeBackground",st(KX,.5),w(1993,"Minimap slider background color when clicked on."));B("charts.foreground",$t,w(1790,"The foreground color used in charts."));B("charts.lines",st($t,.5),w(1791,"The color used for horizontal lines in charts."));B("charts.red",l6,w(1792,"The red color used in chart visualizations."));B("charts.blue",Ug,w(1793,"The blue color used in chart visualizations."));B("charts.yellow",fd,w(1794,"The yellow color used in chart visualizations."));B("charts.orange",xCe,w(1795,"The orange color used in chart visualizations."));B("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},w(1796,"The green color used in chart visualizations."));B("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},w(1797,"The purple color used in chart visualizations."));const NCe=B("input.background",{dark:"#3C3C3C",light:ae.white,hcDark:ae.black,hcLight:ae.white},w(1893,"Input box background.")),ICe=B("input.foreground",$t,w(1894,"Input box foreground.")),RCe=B("input.border",{dark:null,light:null,hcDark:Ct,hcLight:Ct},w(1895,"Input box border.")),iZ=B("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Ct,hcLight:Ct},w(1896,"Border color of activated options in input fields.")),ACe=B("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},w(1897,"Background color of activated options in input fields.")),nZ=B("inputOption.activeBackground",{dark:st(Xl,.4),light:st(Xl,.2),hcDark:ae.transparent,hcLight:ae.transparent},w(1898,"Background hover color of options in input fields.")),sZ=B("inputOption.activeForeground",{dark:ae.white,light:ae.black,hcDark:$t,hcLight:$t},w(1899,"Foreground color of activated options in input fields."));B("input.placeholderForeground",{light:st($t,.5),dark:st($t,.5),hcDark:st($t,.7),hcLight:st($t,.7)},w(1900,"Input box foreground color for placeholder text."));const MCe=B("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:ae.black,hcLight:ae.white},w(1901,"Input validation background color for information severity.")),OCe=B("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:$t},w(1902,"Input validation foreground color for information severity.")),PCe=B("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Ct,hcLight:Ct},w(1903,"Input validation border color for information severity.")),FCe=B("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:ae.black,hcLight:ae.white},w(1904,"Input validation background color for warning severity.")),BCe=B("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:$t},w(1905,"Input validation foreground color for warning severity.")),VCe=B("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Ct,hcLight:Ct},w(1906,"Input validation border color for warning severity.")),WCe=B("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:ae.black,hcLight:ae.white},w(1907,"Input validation background color for error severity.")),HCe=B("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:$t},w(1908,"Input validation foreground color for error severity.")),zCe=B("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Ct,hcLight:Ct},w(1909,"Input validation border color for error severity.")),ED=B("dropdown.background",{dark:"#3C3C3C",light:ae.white,hcDark:ae.black,hcLight:ae.white},w(1910,"Dropdown background.")),UCe=B("dropdown.listBackground",{dark:null,light:null,hcDark:ae.black,hcLight:ae.white},w(1911,"Dropdown list background.")),h6=B("dropdown.foreground",{dark:"#F0F0F0",light:$t,hcDark:ae.white,hcLight:$t},w(1912,"Dropdown foreground.")),u6=B("dropdown.border",{dark:ED,light:"#CECECE",hcDark:Ct,hcLight:Ct},w(1913,"Dropdown border.")),rZ=B("button.foreground",ae.white,w(1914,"Button foreground color.")),jCe=B("button.separator",st(rZ,.4),w(1915,"Button separator color.")),v0=B("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:ae.black,hcLight:"#0F4A85"},w(1916,"Button background color.")),$Ce=B("button.hoverBackground",{dark:Ga(v0,.2),light:dm(v0,.2),hcDark:v0,hcLight:v0},w(1917,"Button background color when hovering.")),qCe=B("button.border",Ct,w(1918,"Button border color.")),GCe=B("button.secondaryForeground",{dark:ae.white,light:ae.white,hcDark:ae.white,hcLight:$t},w(1919,"Secondary button foreground color.")),J4=B("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:ae.white},w(1920,"Secondary button background color.")),KCe=B("button.secondaryHoverBackground",{dark:Ga(J4,.2),light:dm(J4,.2),hcDark:null,hcLight:null},w(1921,"Secondary button background color when hovering.")),y0=B("radio.activeForeground",sZ,w(1922,"Foreground color of active radio option.")),YCe=B("radio.activeBackground",nZ,w(1923,"Background color of active radio option.")),QCe=B("radio.activeBorder",iZ,w(1924,"Border color of the active radio option.")),XCe=B("radio.inactiveForeground",null,w(1925,"Foreground color of inactive radio option.")),ZCe=B("radio.inactiveBackground",null,w(1926,"Background color of inactive radio option.")),JCe=B("radio.inactiveBorder",{light:st(y0,.2),dark:st(y0,.2),hcDark:st(y0,.4),hcLight:st(y0,.2)},w(1927,"Border color of the inactive radio option.")),ewe=B("radio.inactiveHoverBackground",ACe,w(1928,"Background color of inactive active radio option when hovering.")),d6=B("checkbox.background",ED,w(1929,"Background color of checkbox widget."));B("checkbox.selectBackground",ha,w(1930,"Background color of checkbox widget when the element it's in is selected."));const f6=B("checkbox.foreground",h6,w(1931,"Foreground color of checkbox widget.")),twe=B("checkbox.border",u6,w(1932,"Border color of checkbox widget."));B("checkbox.selectBorder",G4,w(1933,"Border color of checkbox widget when the element it's in is selected."));const iwe=B("checkbox.disabled.background",{op:7,color:d6,with:f6,ratio:.33},w(1934,"Background of a disabled checkbox.")),nwe=B("checkbox.disabled.foreground",{op:7,color:f6,with:d6,ratio:.33},w(1935,"Foreground of a disabled checkbox.")),swe=B("keybindingLabel.background",{dark:new ae(new ie(128,128,128,.17)),light:new ae(new ie(221,221,221,.4)),hcDark:ae.transparent,hcLight:ae.transparent},w(1936,"Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),rwe=B("keybindingLabel.foreground",{dark:ae.fromHex("#CCCCCC"),light:ae.fromHex("#555555"),hcDark:ae.white,hcLight:$t},w(1937,"Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),owe=B("keybindingLabel.border",{dark:new ae(new ie(51,51,51,.6)),light:new ae(new ie(204,204,204,.4)),hcDark:new ae(new ie(111,195,223)),hcLight:Ct},w(1938,"Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),awe=B("keybindingLabel.bottomBorder",{dark:new ae(new ie(68,68,68,.6)),light:new ae(new ie(187,187,187,.4)),hcDark:new ae(new ie(111,195,223)),hcLight:$t},w(1939,"Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),lwe=B("list.focusBackground",null,w(1940,"List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),cwe=B("list.focusForeground",null,w(1941,"List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),hwe=B("list.focusOutline",{dark:Xl,light:Xl,hcDark:Hi,hcLight:Hi},w(1942,"List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),uwe=B("list.focusAndSelectionOutline",null,w(1943,"List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),jg=B("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:ae.fromHex("#0F4A85").transparent(.1)},w(1944,"List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Rw=B("list.activeSelectionForeground",{dark:ae.white,light:ae.white,hcDark:null,hcLight:null},w(1945,"List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),oZ=B("list.activeSelectionIconForeground",null,w(1946,"List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),dwe=B("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:ae.fromHex("#0F4A85").transparent(.1)},w(1947,"List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),fwe=B("list.inactiveSelectionForeground",null,w(1948,"List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),gwe=B("list.inactiveSelectionIconForeground",null,w(1949,"List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),mwe=B("list.inactiveFocusBackground",null,w(1950,"List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),pwe=B("list.inactiveFocusOutline",null,w(1951,"List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),aZ=B("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:ae.white.transparent(.1),hcLight:ae.fromHex("#0F4A85").transparent(.1)},w(1952,"List/Tree background when hovering over items using the mouse.")),lZ=B("list.hoverForeground",null,w(1953,"List/Tree foreground when hovering over items using the mouse.")),_we=B("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},w(1954,"List/Tree drag and drop background when moving items over other items when using the mouse.")),bwe=B("list.dropBetweenBackground",{dark:G4,light:G4,hcDark:null,hcLight:null},w(1955,"List/Tree drag and drop border color when moving items between items when using the mouse.")),jS=B("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Xl,hcLight:Xl},w(1956,"List/Tree foreground color of the match highlights when searching inside the list/tree."));B("list.focusHighlightForeground",{dark:jS,light:rCe(jg,jS,"#BBE7FF"),hcDark:jS,hcLight:jS},w(1957,"List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));B("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},w(1958,"List/Tree foreground color for invalid items, for example an unresolved root in explorer."));B("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},w(1959,"Foreground color of list items containing errors."));B("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},w(1960,"Foreground color of list items containing warnings."));const Cwe=B("listFilterWidget.background",{light:dm(ha,0),dark:Ga(ha,0),hcDark:ha,hcLight:ha},w(1961,"Background color of the type filter widget in lists and trees.")),wwe=B("listFilterWidget.outline",{dark:ae.transparent,light:ae.transparent,hcDark:"#f38518",hcLight:"#007ACC"},w(1962,"Outline color of the type filter widget in lists and trees.")),vwe=B("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Ct,hcLight:Ct},w(1963,"Outline color of the type filter widget in lists and trees, when there are no matches.")),ywe=B("listFilterWidget.shadow",Hv,w(1964,"Shadow color of the type filter widget in lists and trees."));B("list.filterMatchBackground",{dark:Fu,light:Fu,hcDark:null,hcLight:null},w(1965,"Background color of the filtered match."));B("list.filterMatchBorder",{dark:$p,light:$p,hcDark:Ct,hcLight:Hi},w(1966,"Border color of the filtered match."));B("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},w(1967,"List/Tree foreground color for items that are deemphasized."));const cZ=B("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},w(1968,"Tree stroke color for the indentation guides.")),Swe=B("tree.inactiveIndentGuidesStroke",st(cZ,.4),w(1969,"Tree stroke color for the indentation guides that are not active.")),xwe=B("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},w(1970,"Table border color between columns.")),Lwe=B("tree.tableOddRowsBackground",{dark:st($t,.04),light:st($t,.04),hcDark:null,hcLight:null},w(1971,"Background color for odd table rows."));B("editorActionList.background",ha,w(1972,"Action List background color."));B("editorActionList.foreground",kD,w(1973,"Action List foreground color."));B("editorActionList.focusForeground",Rw,w(1974,"Action List foreground color for the focused item."));B("editorActionList.focusBackground",jg,w(1975,"Action List background color for the focused item."));const kwe=B("menu.border",{dark:null,light:null,hcDark:Ct,hcLight:Ct},w(1976,"Border color of menus.")),Ewe=B("menu.foreground",h6,w(1977,"Foreground color of menu items.")),Dwe=B("menu.background",ED,w(1978,"Background color of menu items.")),Twe=B("menu.selectionForeground",Rw,w(1979,"Foreground color of the selected menu item in menus.")),Nwe=B("menu.selectionBackground",jg,w(1980,"Background color of the selected menu item in menus.")),Iwe=B("menu.selectionBorder",{dark:null,light:null,hcDark:Hi,hcLight:Hi},w(1981,"Border color of the selected menu item in menus.")),Rwe=B("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Ct,hcLight:Ct},w(1982,"Color of a separator menu item in menus.")),hR=B("quickInput.background",ha,w(2010,"Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),Awe=B("quickInput.foreground",kD,w(2011,"Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),Mwe=B("quickInputTitle.background",{dark:new ae(new ie(255,255,255,.105)),light:new ae(new ie(0,0,0,.06)),hcDark:"#000000",hcLight:ae.white},w(2012,"Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),hZ=B("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:ae.white,hcLight:"#0F4A85"},w(2013,"Quick picker color for grouping labels.")),Owe=B("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:ae.white,hcLight:"#0F4A85"},w(2014,"Quick picker color for grouping borders.")),wU=B("quickInput.list.focusBackground",null,"",void 0,w(2015,"Please use quickInputList.focusBackground instead")),e5=B("quickInputList.focusForeground",Rw,w(2016,"Quick picker foreground color for the focused item.")),uZ=B("quickInputList.focusIconForeground",oZ,w(2017,"Quick picker icon foreground color for the focused item.")),t5=B("quickInputList.focusBackground",{dark:hU(wU,jg),light:hU(wU,jg),hcDark:null,hcLight:null},w(2018,"Quick picker background color for the focused item."));B("search.resultsInfoForeground",{light:$t,dark:st($t,.65),hcDark:$t,hcLight:$t},w(2019,"Color of the text in the search viewlet's completion message."));B("searchEditor.findMatchBackground",{light:st(Fu,.66),dark:st(Fu,.66),hcDark:Fu,hcLight:Fu},w(2020,"Color of the Search Editor query matches."));B("searchEditor.findMatchBorder",{light:st($p,.66),dark:st($p,.66),hcDark:$p,hcLight:$p},w(2021,"Border color of the Search Editor query matches."));class zv{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(e){return new dZ(this.x-e.scrollX,this.y-e.scrollY)}}class dZ{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(e){return new zv(this.clientX+e.scrollX,this.clientY+e.scrollY)}}class Pwe{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class Fwe{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function DD(s){const e=Mo(s);return new Pwe(e.left,e.top,e.width,e.height)}function TD(s,e,t){const i=e.width/s.offsetWidth,n=e.height/s.offsetHeight,r=(t.x-e.x)/i,o=(t.y-e.y)/n;return new Fwe(r,o)}class gd extends io{constructor(e,t,i){super(Ae(i),e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new zv(this.posx,this.posy),this.editorPos=DD(i),this.relativePos=TD(i,this.editorPos,this.pos)}}class Bwe{constructor(e){this._editorViewDomNode=e}_create(e){return new gd(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return J(e,pe.CONTEXT_MENU,i=>{t(this._create(i))})}onMouseUp(e,t){return J(e,pe.MOUSE_UP,i=>{t(this._create(i))})}onMouseDown(e,t){return J(e,pe.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return J(e,pe.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return J(e,pe.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return J(e,pe.MOUSE_MOVE,i=>t(this._create(i)))}}class Vwe{constructor(e){this._editorViewDomNode=e}_create(e){return new gd(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return J(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return J(e,pe.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return J(e,pe.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return J(e,"pointermove",i=>t(this._create(i)))}}class Wwe extends ne{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new xD),this._keydownListener=null}startMonitoring(e,t,i,n,r){this._keydownListener=Xn(e.ownerDocument,"keydown",o=>{o.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,o.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,o=>{n(new gd(o,!0,this._editorViewDomNode))},o=>{this._keydownListener.dispose(),r(o)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class fm extends ne{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const r=e[i];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}}class Qs extends fm{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class Xa{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=i[n-o-1];return r}}class Hwe{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getLineHeightForLineNumber(e){return this._viewLayout.getLineHeightForLineNumber(e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class zwe extends Hwe{constructor(e,t,i,n){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i,this._viewLinesGpu=n}linesVisibleRangesForRange(e,t){const i=this._viewLines.linesVisibleRangesForRange(e,t);if(!this._viewLinesGpu)return i??null;const n=this._viewLinesGpu.linesVisibleRangesForRange(e,t);return i?n?i.concat(n).sort((r,o)=>r.lineNumber-o.lineNumber):i:n}visibleRangeForPosition(e){var t;return this._viewLines.visibleRangeForPosition(e)??((t=this._viewLinesGpu)==null?void 0:t.visibleRangeForPosition(e))??null}}class fZ{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class Uv{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const r=e[i];t[i]=new Uv(r.left,r.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class ed{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class gZ{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class i5{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class Ux{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,r){const o=this._createRange();try{return o.setStart(e,t),o.setEnd(i,n),o.getClientRects()}catch{return null}finally{this._detachRange(o,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(ed.compare);const t=[];let i=0,n=e[0];for(let r=1,o=e.length;r<o;r++){const a=e[r];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const n=[];for(let r=0,o=e.length;r<o;r++){const a=e[r];n[r]=new ed(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,r,o){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===r&&i===0&&!e.children[t].firstChild){const g=e.children[t].getClientRects();return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(g,o.clientRectDeltaLeft,o.clientRectScale)}t!==n&&n>0&&r===0&&(n--,r=1073741824);let c=e.children[t].firstChild,u=e.children[n].firstChild;if((!c||!u)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!u&&r===0&&n>0&&(u=e.children[n-1].firstChild,r=1073741824)),!c||!u)return null;i=Math.min(c.textContent.length,Math.max(0,i)),r=Math.min(u.textContent.length,Math.max(0,r));const d=this._readClientRects(c,i,u,r,o.endNode);return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(d,o.clientRectDeltaLeft,o.clientRectScale)}}var Po;(function(s){s.DARK="dark",s.LIGHT="light",s.HIGH_CONTRAST_DARK="hcDark",s.HIGH_CONTRAST_LIGHT="hcLight"})(Po||(Po={}));var qp;(function(s){s.VS="vs",s.VS_DARK="vs-dark",s.HC_BLACK="hc-black",s.HC_LIGHT="hc-light"})(qp||(qp={}));function T_(s){return s===Po.HIGH_CONTRAST_DARK||s===Po.HIGH_CONTRAST_LIGHT}function gm(s){return s===Po.DARK||s===Po.HIGH_CONTRAST_DARK}const Uwe=(function(){return cw?!0:!(kr||Er||Fg)})();let N_=!0;const GE=class GE{constructor(e,t){this._viewGpuContext=e,this._options=t,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=bt(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){var e;return T_(this._options.themeType)||((e=this._renderedViewLine)==null?void 0:e.input.renderWhitespace)===2?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,r){var C,v,x;if(this._options.useGpu&&((C=this._viewGpuContext)!=null&&C.canRender(this._options,n,e)))return(x=(v=this._renderedViewLine)==null?void 0:v.domNode)==null||x.domNode.remove(),this._renderedViewLine=null,!1;if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const o=n.getViewLineRenderingData(e),a=this._options,l=Oo.filter(o.inlineDecorations,e,o.minColumn,o.maxColumn),c=o.hasVariableFonts||a.experimentalWhitespaceRendering==="off"?a.renderWhitespace:"none",u=!o.hasVariableFonts;let d=null;if(T_(a.themeType)||c==="selection"){const S=n.selections;for(const k of S){if(k.endLineNumber<e||k.startLineNumber>e)continue;const E=k.startLineNumber===e?k.startColumn:o.minColumn,T=k.endLineNumber===e?k.endColumn:o.maxColumn;E<T&&(T_(a.themeType)&&l.push(new Oo(E,T,"inline-selected-text",0)),c==="selection"&&(d||(d=[]),d.push(new Re(E-1,T-1))))}}const g=new um(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,o.content,o.continuesWithWrappedLine,o.isBasicASCII,o.containsRTL,o.minColumn-1,o.tokens,l,o.tabSize,o.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,c,a.renderControlCharacters,a.fontLigatures!==hd.OFF,d,o.textDirection,a.verticalScrollbarSize);if(this._renderedViewLine&&this._renderedViewLine.input.equals(g))return!1;r.appendString("<div "),o.textDirection===no.RTL?r.appendString('dir="rtl" '):o.containsRTL&&r.appendString('dir="ltr" '),r.appendString('style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(i)),r.appendString("px;line-height:"),r.appendString(String(i)),o.textDirection===no.RTL&&(r.appendString("px;padding-right:"),r.appendString(String(a.verticalScrollbarSize))),r.appendString('px;" class="'),r.appendString(GE.CLASS_NAME),r.appendString('">');const p=yD(g,r);r.appendString("</div>");let _=null;return u&&N_&&Uwe&&o.isBasicASCII&&g.isLTR&&a.useMonospaceOptimizations&&p.containsForeignElements===0&&(_=new $S(this._renderedViewLine?this._renderedViewLine.domNode:null,g,p.characterMapping)),_||(_=pZ(this._renderedViewLine?this._renderedViewLine.domNode:null,g,p.characterMapping,p.containsForeignElements)),this._renderedViewLine=_,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i),this._renderedViewLine.domNode.setLineHeight(i))}isRenderedRTL(){return this._renderedViewLine?this._renderedViewLine.input.textDirection===no.RTL:!1}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof $S:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof $S?this._renderedViewLine.monospaceAssumptionsAreValid():N_}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof $S&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&i>r+1)return new i5(!0,[new ed(this.getWidth(n),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&i>r+1&&(i=r+1);const o=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return o&&o.length>0?new i5(!1,o):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};GE.CLASS_NAME="view-line";let uh=GE;class $S{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let r=0;r<n;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return N_;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),N_=!1)}return N_}toSlowRenderedLine(){return pZ(this.domNode,this.input,this._characterMapping,0)}getVisibleRangesForRange(e,t,i,n){const r=this._getColumnPixelOffset(e,t,n),o=this._getColumnPixelOffset(e,i,n);return[new ed(r,o-r)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const n=Math.floor((t-1)/300)-1,r=(n+1)*300+1;let o=-1;if(this._keyColumnPixelOffsetCache&&(o=this._keyColumnPixelOffsetCache[n],o===-1&&(o=this._actualReadPixelOffset(e,r,i),this._keyColumnPixelOffsetCache[n]=o)),o===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return o+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const n=this._characterMapping.getDomPosition(t),r=Ux.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return Aw(this._characterMapping,e,t)}}class mZ{constructor(e,t,i,n){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=n,this._cachedWidth=-1,this._pixelOffsetCache=null,t.isLTR){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let r=0,o=this._characterMapping.length;r<=o;r++)this._pixelOffsetCache[r]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const r=this._readPixelOffset(this.domNode,e,t,n);if(r===-1)return null;const o=this._readPixelOffset(this.domNode,e,i,n);return o===-1?null:[new ed(r,o-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,r){if(i===n){const o=this._readPixelOffset(e,t,i,r);return o===-1?null:[new ed(o,0)]}else return this._readRawVisibleRangesForRange(e,i,n,r)}_readPixelOffset(e,t,i,n){if(this.input.isLTR&&this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);const r=this._getReadingTarget(e);return r.firstChild?(n.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const r=this._pixelOffsetCache[i];if(r!==-1)return r;const o=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=o,o}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){const l=Ux.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(this.input.isLTR&&i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);const r=this._characterMapping.getDomPosition(i),o=Ux.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,n);if(!o||o.length===0)return-1;const a=o[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,n){if(this.input.isLTR&&t===1&&i===this._characterMapping.length)return[new ed(0,this.getWidth(n))];const r=this._characterMapping.getDomPosition(t),o=this._characterMapping.getDomPosition(i);return Ux.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,o.partIndex,o.charIndex,n)}getColumnOfNodeOffset(e,t){return Aw(this._characterMapping,e,t)}}class jwe extends mZ{_readVisibleRangesForRange(e,t,i,n,r){const o=super._readVisibleRangesForRange(e,t,i,n,r);if(!o||o.length===0||i===n||i===1&&n===this._characterMapping.length)return o;if(this.input.isLTR){const a=this._readPixelOffset(e,t,n,r);if(a!==-1){const l=o[o.length-1];l.left<a&&(l.width=a-l.left)}}return o}}const pZ=(function(){return J2?$we:qwe})();function $we(s,e,t,i){return new jwe(s,e,t,i)}function qwe(s,e,t,i){return new mZ(s,e,t,i)}function Aw(s,e,t){const i=e.textContent.length;let n=-1;for(;e;)e=e.previousSibling,n++;return s.getColumn(new PX(n,t),i)}class _i{static _nextVisibleColumn(e,t,i){return e===9?_i.nextRenderTabStop(t,i):Mh(e)||x7(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),r=e.substring(0,n),o=new XL(r);let a=0;for(;!o.eol();){const l=QL(r,n,o.offset);o.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,r=new XL(e);let o=0,a=1;for(;!r.eol();){const l=QL(e,n,r.offset);r.nextGraphemeLength();const c=this._nextVisibleColumn(l,o,i),u=r.offset+1;if(c>=t){const d=t-o;return c-t<d?u:a}o=c,a=u}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return _i.nextRenderTabStop(e,t)}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return _i.prevRenderTabStop(e,t)}}class Mw{static whitespaceVisibleColumn(e,t,i){const n=e.length;let r=0,o=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[o,a,r];switch(r%i===0&&(o=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=_i.nextRenderTabStop(r,i);break;default:return[-1,-1,-1]}}return t===n?[o,a,r]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const r=e.length,[o,a,l]=Mw.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(n){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(o===-1)return-1;let g=a;for(let p=o;p<r;++p){if(g===a+i)return o;switch(e.charCodeAt(p)){case 32:g+=1;break;case 9:g=_i.nextRenderTabStop(g,i);break;default:return-1}}return g===a+i?o:-1}const u=_i.nextRenderTabStop(l,i);let d=l;for(let g=t;g<r;g++){if(d===u)return g;switch(e.charCodeAt(g)){case 32:d+=1;break;case 9:d=_i.nextRenderTabStop(d,i);break;default:return-1}}return d===u?r:-1}}class vu{constructor(e=null){this.hitTarget=e,this.type=0}}class _Z{get hitTarget(){return this.spanNode}constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var vf;(function(s){function e(t,i,n){const r=t.getPositionFromDOMInfo(i,n);return r?new _Z(r,i,null):new vu(i)}s.createFromDOMInfo=e})(vf||(vf={}));class Gwe{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class Kn{static _deduceRage(e,t=null){return!t&&e?new H(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,r,o){return{type:e,element:t,mouseColumn:i,position:n,range:r,detail:o}}static createViewZone(e,t,i,n,r){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:r}}static createContentText(e,t,i,n,r){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:r}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class Is{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}}class C1{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(165),this.viewDomNode=t.viewDomNode,this.viewLinesGpu=t.viewLinesGpu,this.lineHeight=n.get(75),this.stickyTabStops=n.get(132),this.typicalHalfwidthCharacterWidth=n.get(59).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return C1.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,r=e.viewModel.getLineCount();let o=null,a,l=null;return i.afterLineNumber!==r&&(l=new Y(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(o=new Y(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=o:o===null?a=l:t<n?a=o:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:o,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const n=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(n);return{range:new H(n,r,n,r),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new H(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return C1._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}isRtl(e){return this.viewModel.getTextDirection(e)===no.RTL}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class Kwe{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,ps._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class Ywe extends Kwe{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Xa.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,r){super(e,t,i,n),this.hitTestResult=new Ws(()=>ps.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=e,this._eventTarget=r;const o=!!this._eventTarget;this._useHitTestTarget=!o}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?_i.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Kn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Kn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return Kn.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return Kn.createViewZone(e,this.target,this._getMouseColumn(),t,i)}fulfillContentText(e,t,i){return Kn.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return Kn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Kn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Kn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Kn.createOverlayWidget(this.target,this._getMouseColumn(),e)}}const vU={isAfterLines:!0};function Yd(s){return{isAfterLines:!1,horizontalDistanceToText:s}}class ps{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=Xa.collect(t,this._viewHelper.viewDomNode);return!!(Is.isChildOfContentWidgets(i)||Is.isChildOfOverflowingContentWidgets(i)||Is.isChildOfOverlayWidgets(i)||Is.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,r){const o=new C1(this._context,this._viewHelper,e),a=new Ywe(o,t,i,n,r);try{const l=ps._createMouseTarget(o,a);if(l.type===6&&o.stickyTabStops&&l.position!==null){const c=ps._snapToSoftTabBoundary(l.position,o.viewModel),u=H.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,u,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();const i=t;let n=null;return!Is.isChildOfOverflowGuard(t.targetPath)&&!Is.isChildOfOverflowingContentWidgets(t.targetPath)&&!Is.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||ps._hitTestContentWidget(e,i),n=n||ps._hitTestOverlayWidget(e,i),n=n||ps._hitTestMinimap(e,i),n=n||ps._hitTestScrollbarSlider(e,i),n=n||ps._hitTestViewZone(e,i),n=n||ps._hitTestMargin(e,i),n=n||ps._hitTestViewCursor(e,i),n=n||ps._hitTestTextArea(e,i),n=n||ps._hitTestViewLines(e,i),n=n||ps._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(Is.isChildOfContentWidgets(t.targetPath)||Is.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(Is.isChildOfOverlayWidgets(t.targetPath)||Is.isChildOfOverflowingOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(const o of i){if(n<o.contentLeft||n>o.contentLeft+o.width)continue;const a=e.getVerticalOffsetForLineNumber(o.position.lineNumber);if(a<=r&&r<=a+o.height)return t.fulfillContentText(o.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return Is.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let r=Math.abs(t.relativePos.x);const o={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){const a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return o.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,n,i.range,o)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,o):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,o))}return null}static _hitTestViewLines(e,t){if(!Is.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new Y(1,1),vU);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new Y(n,r),vU)}if(Is.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineLength(n),o=e.getLineWidth(n);if(r===0){const l=Yd(t.mouseContentHorizontalOffset-o);return t.fulfillContentEmpty(new Y(n,1),l)}if(e.isRtl(n)){if(t.mouseContentHorizontalOffset+o<=e.layoutInfo.contentWidth-e.layoutInfo.verticalScrollbarWidth){const l=Yd(t.mouseContentHorizontalOffset-o),c=new Y(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(t.mouseContentHorizontalOffset>=o){const l=Yd(t.mouseContentHorizontalOffset-o),c=new Y(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(e.viewLinesGpu){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){const l=e.getLineWidth(n),c=Yd(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(new Y(n,1),c)}const r=e.getLineWidth(n);if(e.isRtl(n)){if(t.mouseContentHorizontalOffset+r<=e.layoutInfo.contentWidth-e.layoutInfo.verticalScrollbarWidth){const l=Yd(t.mouseContentHorizontalOffset-r),c=new Y(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(t.mouseContentHorizontalOffset>=r){const l=Yd(t.mouseContentHorizontalOffset-r),c=new Y(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}const a=e.viewLinesGpu.getPositionAtCoordinate(n,t.mouseContentHorizontalOffset);if(a){const l={injectedText:null,mightBeForeignElement:!1};return t.fulfillContentText(a,H.fromPositions(a,a),l)}}const i=t.hitTestResult.value;return i.type===1?ps.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(Is.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new Y(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(Is.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new Y(n,r))}}return null}static _hitTestScrollbar(e,t){if(Is.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new Y(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(165),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return ps._getMouseColumn(n,t.get(59).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,r){const o=n.lineNumber,a=n.column,l=e.getLineWidth(o);if(t.mouseContentHorizontalOffset>l){const x=Yd(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,x)}const c=e.visibleRangeForPosition(o,a);if(!c)return t.fulfillUnknown(n);const u=c.left;if(Math.abs(t.mouseContentHorizontalOffset-u)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!r,injectedText:r});const d=[];if(d.push({offset:c.left,column:a}),a>1){const x=e.visibleRangeForPosition(o,a-1);x&&d.push({offset:x.left,column:a-1})}const g=e.viewModel.getLineMaxColumn(o);if(a<g){const x=e.visibleRangeForPosition(o,a+1);x&&d.push({offset:x.left,column:a+1})}d.sort((x,S)=>x.offset-S.offset);const p=t.pos.toClientCoordinates(Ae(e.viewDomNode)),_=i.getBoundingClientRect(),C=_.left<=p.clientX&&p.clientX<=_.right;let v=null;for(let x=1;x<d.length;x++){const S=d[x-1],k=d[x];if(S.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=k.offset){v=new H(o,S.column,o,k.column);const E=Math.abs(S.offset-t.mouseContentHorizontalOffset),T=Math.abs(k.offset-t.mouseContentHorizontalOffset);n=E<T?new Y(o,S.column):new Y(o,k.column);break}}return t.fulfillContentText(n,v,{mightBeForeignElement:!C||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),r=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){const a=Math.floor((n+r)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new zv(t.pos.x,l),u=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates(Ae(e.viewDomNode)));if(u.type===1)return u}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(Ae(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=Wg(e.viewDomNode);let n;if(i?typeof i.caretRangeFromPoint>"u"?n=Qwe(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new vu;const r=n.startContainer;if(r.nodeType===r.TEXT_NODE){const o=r.parentNode,a=o?o.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===uh.CLASS_NAME?vf.createFromDOMInfo(e,o,n.startOffset):new vu(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){const o=r.parentNode,a=o?o.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===uh.CLASS_NAME?vf.createFromDOMInfo(e,r,r.textContent.length):new vu(r)}return new vu}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const n=i.offsetNode.parentNode,r=n?n.parentNode:null,o=r?r.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===uh.CLASS_NAME?vf.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new vu(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const n=i.offsetNode.parentNode,r=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,o=n?n.parentNode:null,a=o&&o.nodeType===o.ELEMENT_NODE?o.className:null;if(r===uh.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return vf.createFromDOMInfo(e,l,0)}else if(a===uh.CLASS_NAME)return vf.createFromDOMInfo(e,i.offsetNode,0)}return new vu(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),r=Mw.atomicPosition(i,e.column-1,n,2);return r!==-1?new Y(e.lineNumber,r+1):e}static doHitTest(e,t){let i=new vu;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(Ae(e.viewDomNode)))),i.type===1){const n=e.viewModel.getInjectedTextAt(i.position),r=e.viewModel.normalizePosition(i.position,2);(n||!r.equals(i.position))&&(i=new _Z(r,i.spanNode,n))}return i}}function Qwe(s,e,t){const i=document.createRange();let n=s.elementFromPoint(e,t);if(n!=null&&n.hasChildNodes()){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const r=n.getBoundingClientRect(),o=Ae(n),a=o.getComputedStyle(n,null).getPropertyValue("font-style"),l=o.getComputedStyle(n,null).getPropertyValue("font-variant"),c=o.getComputedStyle(n,null).getPropertyValue("font-weight"),u=o.getComputedStyle(n,null).getPropertyValue("font-size"),d=o.getComputedStyle(n,null).getPropertyValue("line-height"),g=o.getComputedStyle(n,null).getPropertyValue("font-family"),p=`${a} ${l} ${c} ${u}/${d} ${g}`,_=n.innerText;let C=r.left,v=0,x;if(e>r.left+r.width)v=_.length;else{const S=n5.getInstance();for(let k=0;k<_.length+1;k++){if(x=S.getCharWidth(_.charAt(k),p)/2,C+=x,e<C){v=k;break}C+=x}}i.setStart(n.firstChild,v),i.setEnd(n.firstChild,v)}return i}const Ff=class Ff{static getInstance(){return Ff._INSTANCE||(Ff._INSTANCE=new Ff),Ff._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const o=n.measureText(e).width;return this._cache[i]=o,o}};Ff._INSTANCE=null;let n5=Ff;function Si(s,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");const r=`$memoize$${e}`;t[i]=function(...o){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,o)}),this[r]}}var Xwe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Qt;(function(s){s.Tap="-monaco-gesturetap",s.Change="-monaco-gesturechange",s.Start="-monaco-gesturestart",s.End="-monaco-gesturesend",s.Contextmenu="-monaco-gesturecontextmenu"})(Qt||(Qt={}));const qn=class qn extends ne{constructor(){super(),this.dispatched=!1,this.targets=new sr,this.ignoreTargets=new sr,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(ge.runAndSubscribe(Av,({window:e,disposables:t})=>{t.add(J(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(J(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(J(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Ut,disposables:this._store}))}static addTarget(e){if(!qn.isTouchDevice())return ne.None;qn.INSTANCE||(qn.INSTANCE=new qn);const t=qn.INSTANCE.targets.push(e);return Fe(t)}static ignoreTarget(e){if(!qn.isTouchDevice())return ne.None;qn.INSTANCE||(qn.INSTANCE=new qn);const t=qn.INSTANCE.ignoreTargets.push(e);return Fe(t)}static isTouchDevice(){return"ontouchstart"in Ut||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){const r=e.targetTouches.item(i);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};const o=this.newGestureEvent(Qt.Start,r.target);o.pageX=r.pageX,o.pageY=r.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){const i=Date.now(),n=Object.keys(this.activeTouches).length;for(let r=0,o=t.changedTouches.length;r<o;r++){const a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}const l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<qn.HOLD_DELAY&&Math.abs(l.initialPageX-l.rollingPageX.at(-1))<30&&Math.abs(l.initialPageY-l.rollingPageY.at(-1))<30){const u=this.newGestureEvent(Qt.Tap,l.initialTarget);u.pageX=l.rollingPageX.at(-1),u.pageY=l.rollingPageY.at(-1),this.dispatchEvent(u)}else if(c>=qn.HOLD_DELAY&&Math.abs(l.initialPageX-l.rollingPageX.at(-1))<30&&Math.abs(l.initialPageY-l.rollingPageY.at(-1))<30){const u=this.newGestureEvent(Qt.Contextmenu,l.initialTarget);u.pageX=l.rollingPageX.at(-1),u.pageY=l.rollingPageY.at(-1),this.dispatchEvent(u)}else if(n===1){const u=l.rollingPageX.at(-1),d=l.rollingPageY.at(-1),g=l.rollingTimestamps.at(-1)-l.rollingTimestamps[0],p=u-l.rollingPageX[0],_=d-l.rollingPageY[0],C=[...this.targets].filter(v=>l.initialTarget instanceof Node&&v.contains(l.initialTarget));this.inertia(e,C,i,Math.abs(p)/g,p>0?1:-1,u,Math.abs(_)/g,_>0?1:-1,d)}this.dispatchEvent(this.newGestureEvent(Qt.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Qt.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>qn.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Qt.Change||e.type===Qt.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(e.initialTarget))return;const t=[];for(const i of this.targets)if(i.contains(e.initialTarget)){let n=0,r=e.initialTarget;for(;r&&r!==i;)n++,r=r.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(const[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,r,o,a,l,c){this.handle=hr(e,()=>{const u=Date.now(),d=u-i;let g=0,p=0,_=!0;n+=qn.SCROLL_FRICTION*d,a+=qn.SCROLL_FRICTION*d,n>0&&(_=!1,g=r*n*d),a>0&&(_=!1,p=l*a*d);const C=this.newGestureEvent(Qt.Change);C.translationX=g,C.translationY=p,t.forEach(v=>v.dispatchEvent(C)),_||this.inertia(e,t,u,n,r,o+g,a,l,c+p)})}onTouchMove(e){const t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){const r=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}const o=this.activeTouches[r.identifier],a=this.newGestureEvent(Qt.Change,o.initialTarget);a.translationX=r.pageX-o.rollingPageX.at(-1),a.translationY=r.pageY-o.rollingPageY.at(-1),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(r.pageX),o.rollingPageY.push(r.pageY),o.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};qn.SCROLL_FRICTION=-.005,qn.HOLD_DELAY=700,qn.CLEAR_TAP_COUNT_TIME=400;let $s=qn;Xwe([Si],$s,"isTouchDevice",null);let oc=class extends ne{onclick(e,t){this._register(J(e,pe.CLICK,i=>t(new io(Ae(e),i))))}onmousedown(e,t){this._register(J(e,pe.MOUSE_DOWN,i=>t(new io(Ae(e),i))))}onmouseover(e,t){this._register(J(e,pe.MOUSE_OVER,i=>t(new io(Ae(e),i))))}onmouseleave(e,t){this._register(J(e,pe.MOUSE_LEAVE,i=>t(new io(Ae(e),i))))}onkeydown(e,t){this._register(J(e,pe.KEY_DOWN,i=>t(new jt(i))))}onkeyup(e,t){this._register(J(e,pe.KEY_UP,i=>t(new jt(i))))}oninput(e,t){this._register(J(e,pe.INPUT,t))}onblur(e,t){this._register(J(e,pe.BLUR,t))}onfocus(e,t){this._register(J(e,pe.FOCUS,t))}ignoreGesture(e){return $s.ignoreTarget(e)}};const w1=11;class Zwe extends oc{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...ht.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=w1+"px",this.domNode.style.height=w1+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new xD),this._register(Xn(this.bgDomNode,pe.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Xn(this.domNode,pe.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new B7),this._pointerdownScheduleRepeatTimer=this._register(new Ql)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Ae(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class Jwe extends ne{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Ql)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var e;(e=this._domNode)==null||e.setClassName(this._visibleClassName)},0))}_hide(e){var t;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(t=this._domNode)==null||t.setClassName(this._invisibleClassName+(e?" fade":"")))}}const eve=140;class bZ extends oc{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new Jwe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new xD),this._shouldRender=!0,this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(J(this.domNode.domNode,pe.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new Zwe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=bt(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(J(this.slider.domNode,pe.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);i<=r&&r<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const o=Mo(this.domNode.domNode);t=e.pageX-o.left,i=e.pageY-o.top}const n=e.pointerType==="mouse",r=e.button===0;if(r||!n){const o=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(o):this._scrollbarState.getDesiredScrollPositionFromOffset(o))}r&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{const o=this._sliderOrthogonalPointerPosition(r),a=Math.abs(o-i);if(cr&&a>eve){this._setDesiredScrollPositionNow(n.getScrollPosition());return}const c=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const tve=20;class v1{constructor(e,t,i,n,r,o){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=r,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new v1(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,r){const o=Math.max(0,i-e),a=Math.max(0,o-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(tve,Math.floor(i*a/n))),u=(a-c)/(n-i),d=r*u;return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:u,computedSliderPosition:Math.round(d)}}_refreshComputedValues(){const e=v1._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class ive extends bZ{constructor(e,t,i){const n=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new v1(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const o=(t.arrowSize-w1)/2,a=(t.horizontalScrollbarSize-w1)/2;this._createArrow({className:"scra",icon:xe.scrollbarButtonLeft,top:a,left:o,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Vg(null,1,0))}),this._createArrow({className:"scra",icon:xe.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:o,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Vg(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class nve extends bZ{constructor(e,t,i){const n=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new v1(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const o=(t.arrowSize-w1)/2,a=(t.verticalScrollbarSize-w1)/2;this._createArrow({className:"scra",icon:xe.scrollbarButtonUp,top:o,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Vg(null,0,1))}),this._createArrow({className:"scra",icon:xe.scrollbarButtonDown,top:void 0,left:a,bottom:o,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Vg(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class vk{constructor(e,t,i,n,r,o,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,r=r|0,o=o|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),r<0&&(r=0),a+r>o&&(a=o-r),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=r,this.scrollHeight=o,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new vk(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new vk(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:r,heightChanged:o,scrollHeightChanged:a,scrollTopChanged:l}}}class U1 extends ne{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new $),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new vk(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){var n;const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),(n=this._smoothScrolling)==null||n.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new Ow(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=Ow.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class yU{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function uR(s,e){const t=e-s;return function(i){return s+t*ove(i)}}function sve(s,e,t){return function(i){return i<t?s(i/t):e((i-t)/(1-t))}}class Ow{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let r,o;return e<t?(r=e+.75*i,o=t-.75*i):(r=e-.75*i,o=t+.75*i),sve(uR(e,r),uR(o,t),.33)}return uR(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),n=this.scrollTop(t);return new yU(i,n,!1)}return new yU(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return Ow.start(e,t,i)}static start(e,t,i){i=i+10;const n=Date.now()-10;return new Ow(e,t,n,i)}}function rve(s){return Math.pow(s,3)}function ove(s){return 1-rve(1-s)}const ave=500,SU=50;class lve{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}const KE=class KE{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{const r=n===this._front?e:Math.pow(2,-i);if(e-=r,t+=this._memory[n].score*r,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(Tv){const t=Ae(e.browserEvent),i=n4(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null;const r=new lve(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){const n=Math.abs(e.deltaX),r=Math.abs(e.deltaY),o=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,o),1),c=Math.max(Math.min(r,a),1),u=Math.max(n,o),d=Math.max(r,a);u%l===0&&d%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){const t=Number.EPSILON*100;return Math.abs(Math.round(e)-e)<.01+t}};KE.INSTANCE=new KE;let yk=KE;class g6 extends oc{get onScroll(){return this._onScroll.event}get options(){return this._options}constructor(e,t,i){super(),this._inertialTimeout=null,this._inertialSpeed={X:0,Y:0},this._onScroll=this._register(new $),this._onWillScroll=this._register(new $),e.style.overflow="hidden",this._options=hve(t),this._scrollable=i,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));const n={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new nve(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new ive(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=bt(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=bt(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=bt(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new Ql),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Zi(this._mouseWheelToDispose),this._inertialTimeout&&(this._inertialTimeout.dispose(),this._inertialTimeout=null),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,rt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Vg(e))}async _periodicSync(){var t;let e=!1;(this._inertialSpeed.X!==0||this._inertialSpeed.Y!==0)&&(this._scrollable.setScrollPositionNow({scrollTop:this._scrollable.getCurrentScrollPosition().scrollTop-this._inertialSpeed.Y*100,scrollLeft:this._scrollable.getCurrentScrollPosition().scrollLeft-this._inertialSpeed.X*100}),this._inertialSpeed.X*=.9,this._inertialSpeed.Y*=.9,Math.abs(this._inertialSpeed.X)<.01&&(this._inertialSpeed.X=0),Math.abs(this._inertialSpeed.Y)<.01&&(this._inertialSpeed.Y=0),e=this._inertialSpeed.X!==0||this._inertialSpeed.Y!==0),e?(this._inertialTimeout||(this._inertialTimeout=new Ql),this._inertialTimeout.cancelAndSet(()=>this._periodicSync(),1e3/60)):((t=this._inertialTimeout)==null||t.dispose(),this._inertialTimeout=null)}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Zi(this._mouseWheelToDispose),e)){const i=n=>{this._onMouseWheel(new Vg(n))};this._mouseWheelToDispose.push(J(this._listenOnDomNode,pe.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){var r;if((r=e.browserEvent)!=null&&r.defaultPrevented)return;const t=yk.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&a+o===0?a=o=0:Math.abs(o)>=Math.abs(a)?a=0:o=0),this._options.flipAxes&&([o,a]=[a,o]);const l=!rt&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||l)&&!a&&(a=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(a=a*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);const c=this._scrollable.getFutureScrollPosition();let u={};if(o){const d=SU*o,g=c.scrollTop-(d<0?Math.floor(d):Math.ceil(d));this._verticalScrollbar.writeScrollPosition(u,g)}if(a){const d=SU*a,g=c.scrollLeft-(d<0?Math.floor(d):Math.ceil(d));this._horizontalScrollbar.writeScrollPosition(u,g)}if(u=this._scrollable.validateScrollPosition(u),this._options.inertialScroll&&(a||o)&&!t.isPhysicalMouseWheel()){let d=!1;this._inertialSpeed.X===0&&this._inertialSpeed.Y===0&&(d=!0),this._inertialSpeed.Y=(o<0?-1:1)*Math.abs(o)**1.02,this._inertialSpeed.X=(a<0?-1:1)*Math.abs(a)**1.02,d&&this._periodicSync()}(c.scrollLeft!==u.scrollLeft||c.scrollTop!==u.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(u):this._scrollable.setScrollPositionNow(u),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",r=t?" top":"",o=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${o}${r}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),ave)}}class cve extends g6{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new U1({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>hr(Ae(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class ND extends g6{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class m6 extends g6{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new U1({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>hr(Ae(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function hve(s){const e={lazyRender:typeof s.lazyRender<"u"?s.lazyRender:!1,className:typeof s.className<"u"?s.className:"",useShadows:typeof s.useShadows<"u"?s.useShadows:!0,handleMouseWheel:typeof s.handleMouseWheel<"u"?s.handleMouseWheel:!0,flipAxes:typeof s.flipAxes<"u"?s.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof s.consumeMouseWheelIfScrollbarIsNeeded<"u"?s.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof s.alwaysConsumeMouseWheel<"u"?s.alwaysConsumeMouseWheel:!1,scrollYToX:typeof s.scrollYToX<"u"?s.scrollYToX:!1,mouseWheelScrollSensitivity:typeof s.mouseWheelScrollSensitivity<"u"?s.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof s.fastScrollSensitivity<"u"?s.fastScrollSensitivity:5,scrollPredominantAxis:typeof s.scrollPredominantAxis<"u"?s.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof s.mouseWheelSmoothScroll<"u"?s.mouseWheelSmoothScroll:!0,inertialScroll:typeof s.inertialScroll<"u"?s.inertialScroll:!1,arrowSize:typeof s.arrowSize<"u"?s.arrowSize:11,listenOnDomNode:typeof s.listenOnDomNode<"u"?s.listenOnDomNode:null,horizontal:typeof s.horizontal<"u"?s.horizontal:1,horizontalScrollbarSize:typeof s.horizontalScrollbarSize<"u"?s.horizontalScrollbarSize:10,horizontalSliderSize:typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:0,horizontalHasArrows:typeof s.horizontalHasArrows<"u"?s.horizontalHasArrows:!1,vertical:typeof s.vertical<"u"?s.vertical:1,verticalScrollbarSize:typeof s.verticalScrollbarSize<"u"?s.verticalScrollbarSize:10,verticalHasArrows:typeof s.verticalHasArrows<"u"?s.verticalHasArrows:!1,verticalSliderSize:typeof s.verticalSliderSize<"u"?s.verticalSliderSize:0,scrollByPage:typeof s.scrollByPage<"u"?s.scrollByPage:!1};return e.horizontalSliderSize=typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof s.verticalSliderSize<"u"?s.verticalSliderSize:e.verticalScrollbarSize,rt&&(e.className+=" mac"),e}class CZ extends ne{constructor(e,t,i,n){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=this._createDragScrollingOperation(e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class wZ extends ne{constructor(e,t,i,n,r,o){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._position=r,this._mouseEvent=o,this._lastTime=Date.now(),this._animationFrameDisposable=hr(Ae(o.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}}class uve extends CZ{_createDragScrollingOperation(e,t){return new dve(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}}class dve extends wZ{_getScrollSpeed(){const e=this._context.configuration.options.get(75),t=this._context.configuration.options.get(165).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(75),t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e,r=this._position.outsidePosition==="above"?-n:n;this._context.viewModel.viewLayout.deltaScrollNow(0,r),this._viewHelper.renderNow();const o=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?o.startLineNumber:o.endLineNumber;let l;{const c=DD(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(165).horizontalScrollbarHeight,d=new zv(this._mouseEvent.pos.x,c.y+c.height-u-.1),g=TD(this._viewHelper.viewDomNode,c,d);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,d,g,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=Kn.createOutsideEditor(this._position.mouseColumn,new Y(a,1),"above",this._position.outsideDistance):l=Kn.createOutsideEditor(this._position.mouseColumn,new Y(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=hr(Ae(l.element),()=>this._execute())}}class fve extends CZ{_createDragScrollingOperation(e,t){return new gve(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}}class gve extends wZ{_getScrollSpeed(){const e=this._context.configuration.options.get(59).typicalFullwidthCharacterWidth,t=this._context.configuration.options.get(165).contentWidth/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(59).typicalFullwidthCharacterWidth,t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e*.5,r=this._position.outsidePosition==="left"?-n:n;if(this._context.viewModel.viewLayout.deltaScrollNow(r,0),this._viewHelper.renderNow(),!this._position.position)return;const o=this._position.position.lineNumber;let a;{const l=DD(this._viewHelper.viewDomNode),c=this._context.configuration.options.get(165).horizontalScrollbarHeight,u=new zv(this._mouseEvent.pos.x,l.y+l.height-c-.1),d=TD(this._viewHelper.viewDomNode,l,u);a=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),l,u,d,null)}this._position.outsidePosition==="left"?a=Kn.createOutsideEditor(a.mouseColumn,new Y(o,a.mouseColumn),"left",this._position.outsideDistance):a=Kn.createOutsideEditor(a.mouseColumn,new Y(o,a.mouseColumn),"right",this._position.outsideDistance),this._dispatchMouse(a,!0,2),this._animationFrameDisposable=hr(Ae(a.element),()=>this._execute())}}class p6 extends fm{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new ps(this._context,i),this._mouseDownOperation=this._register(new mve(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(o,a)=>this._createMouseTarget(o,a),o=>this._getMouseColumn(o))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(165).height;const n=new Bwe(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,o=>this._onContextMenu(o,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,o=>{this._onMouseMove(o),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=J(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new gd(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o)));let r=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,a)=>{r=a})),this._register(J(this.viewHelper.viewDomNode,pe.POINTER_UP,o=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,o=>this._onMouseDown(o,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=yk.INSTANCE;let t=0,i=Du.getZoomLevel(),n=!1,r=0;const o=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(84))return;const c=new Vg(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const u=Du.getZoomLevel(),d=c.deltaY>0?1:-1;Du.setZoomLevel(u+d),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=Du.getZoomLevel(),n=a(l),r=0),t=Date.now(),r+=c.deltaY,n&&(Du.setZoomLevel(i+r/5),c.preventDefault(),c.stopPropagation())};this._register(J(this.viewHelper.viewDomNode,pe.MOUSE_WHEEL,o,{capture:!0,passive:!1}));function a(l){return rt?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(165)){const t=this._context.configuration.options.get(165).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const n=new dZ(e,t).toPageCoordinates(Ae(this.viewHelper.viewDomNode)),r=DD(this.viewHelper.viewDomNode);if(n.y<r.y||n.y>r.y+r.height||n.x<r.x||n.x>r.x+r.width)return null;const o=TD(this.viewHelper.viewDomNode,r,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,n,o,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const n=Wg(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(o=>this.viewHelper.viewDomNode.contains(o))??null)}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,r=i.type===2||i.type===3||i.type===4,o=i.type===3,a=this._context.configuration.options.get(125),l=i.type===8||i.type===5,c=i.type===9;let u=e.leftButton||e.middleButton;rt&&e.leftButton&&e.ctrlKey&&(u=!1);const d=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(u&&(n||o&&a))d(),this._mouseDownOperation.start(i.type,e,t);else if(r)e.preventDefault();else if(l){const g=i.detail;u&&this.viewHelper.shouldSuppressMouseDownOnViewZone(g.viewZoneId)&&(d(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(d(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class mve extends ne{constructor(e,t,i,n,r,o){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=n,this._createMouseTarget=r,this._getMouseColumn=o,this._mouseMoveMonitor=this._register(new Wwe(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new uve(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._leftRightDragScrolling=this._register(new fve(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new s5,this._currentSelection=new gt(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13?t.outsidePosition==="above"||t.outsidePosition==="below"?(this._topBottomDragScrolling.start(t,e),this._leftRightDragScrolling.stop()):(this._leftRightDragScrolling.start(t,e),this._topBottomDragScrolling.stop()):(this._topBottomDragScrolling.stop(),this._leftRightDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const r=this._context.configuration.options;if(!r.get(104)&&r.get(42)&&!r.get(28)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&n.type===6&&n.position&&this._currentSelection.containsPosition(n.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),o=>{const a=this._findMousePosition(this._lastMouseEvent,!1);ih(o)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop(),this._leftRightDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,r=this._getMouseColumn(e);if(e.posy<t.y){const d=t.y-e.posy,g=Math.max(n.getCurrentScrollTop()-d,0),p=C1.getZoneAtCoord(this._context,g);if(p){const C=this._helpPositionJumpOverViewZone(p);if(C)return Kn.createOutsideEditor(r,C,"above",d)}const _=n.getLineNumberAtVerticalOffset(g);return Kn.createOutsideEditor(r,new Y(_,1),"above",d)}if(e.posy>t.y+t.height){const d=e.posy-t.y-t.height,g=n.getCurrentScrollTop()+e.relativePos.y,p=C1.getZoneAtCoord(this._context,g);if(p){const C=this._helpPositionJumpOverViewZone(p);if(C)return Kn.createOutsideEditor(r,C,"below",d)}const _=n.getLineNumberAtVerticalOffset(g);return Kn.createOutsideEditor(r,new Y(_,i.getLineMaxColumn(_)),"below",d)}const o=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y),a=this._context.configuration.options.get(165),l=a.contentLeft;if(e.relativePos.x<=l){const d=l-e.relativePos.x;return Kn.createOutsideEditor(r,new Y(o,1),"left",d)}const u=a.minimap.minimapLeft===0?a.width-a.verticalScrollbarWidth:a.minimap.minimapLeft;if(e.relativePos.x>=u){const d=e.relativePos.x-u;return Kn.createOutsideEditor(r,new Y(o,i.getLineMaxColumn(o)),"right",d)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(n.type===8||n.type===5){const o=this._helpPositionJumpOverViewZone(n.detail);if(o)return Kn.createViewZone(n.type,n.element,n.mouseColumn,o,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new Y(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}const YE=class YE{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>YE.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};YE.CLEAR_MOUSE_DOWN_COUNT_TIME=400;let s5=YE;class Nt{get event(){return this.emitter.event}constructor(e,t,i){const n=r=>this.emitter.fire(r);this.emitter=new $({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}}function vZ(s,e,t,i){const n=s.getPlainTextToCopy(e,t,cr),r=s.model.getEOL(),o=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(n)?n:null,l=Array.isArray(n)?n.join(r):n;let c,u=null;if(i&&l.length<65536){const g=s.getRichTextToCopy(e,t);g&&(c=g.html,u=g.mode)}return{isFromEmptySelection:o,multicursorText:a,text:l,html:c,mode:u}}const QE=class QE{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}};QE.INSTANCE=new QE;let og=QE;const Sk={getTextData(s){const e=s.getData(ch.text);let t=null;const i=s.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&s.files.length>0?[Array.prototype.slice.call(s.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(s,e,t,i){s.setData(ch.text,e),typeof t=="string"&&s.setData("text/html",t),s.setData("vscode-editor-data",JSON.stringify(i))}},Bf=class Bf{constructor(e,t,i,n,r){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=n,this.newlineCountBeforeSelection=r}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),n=e.getSelectionStart(),r=e.getSelectionEnd();let o;if(t){const a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(o=t.newlineCountBeforeSelection)}return new Bf(i,n,r,null,o)}collapseSelection(){return this.selectionStart===this.value.length?this:new Bf(this.value,this.value.length,this.value.length,null,void 0)}isWrittenToTextArea(e,t){const i=this.value===e.getValue();return t?this.selectionStart===e.getSelectionStart()&&this.selectionEnd===e.getSelectionEnd()&&i:i}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){var n,r,o,a;if(e<=this.selectionStart){const l=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(((n=this.selection)==null?void 0:n.getStartPosition())??null,l,-1)}if(e>=this.selectionEnd){const l=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(((r=this.selection)==null?void 0:r.getEndPosition())??null,l,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf("")===-1)return this._finishDeduceEditorPosition(((o=this.selection)==null?void 0:o.getStartPosition())??null,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(((a=this.selection)==null?void 0:a.getEndPosition())??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(a1(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(l1(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-r);const o=t.value.substring(n,t.value.length-r),a=e.selectionStart-n,l=e.selectionEnd-n,c=t.selectionStart-n,u=t.selectionEnd-n;if(c===u){const g=e.selectionStart-n;return{text:o,replacePrevCharCnt:g,replaceNextCharCnt:0,positionDelta:0}}const d=l-a;return{text:o,replacePrevCharCnt:d,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(a1(e.value,t.value),e.selectionEnd),n=Math.min(l1(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(i,e.value.length-n),o=t.value.substring(i,t.value.length-n);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:o,replacePrevCharCnt:a,replaceNextCharCnt:r.length-a,positionDelta:l-o.length}}static fromScreenReaderContentState(e){return new Bf(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};Bf.EMPTY=new Bf("",0,0,null,void 0);let ws=Bf;const _6=(function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const s=new Uint8Array(16),e=[];for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(s),s[6]=s[6]&15|64,s[8]=s[8]&63|128;let i=0,n="";return n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n}})();function pve(s){return`${s}-${_6()}`}var _ve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xU=function(s,e){return function(t,i){e(t,i,s)}},xk;(function(s){s.Tap="-monaco-textarea-synthetic-tap"})(xk||(xk={}));class bve{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}let r5=class extends ne{get textAreaState(){return this._textAreaState}constructor(e,t,i,n,r,o){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._accessibilityService=r,this._logService=o,this._onFocus=this._register(new $),this.onFocus=this._onFocus.event,this._onBlur=this._register(new $),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new $),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new $),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new $),this.onCut=this._onCut.event,this._onPaste=this._register(new $),this.onPaste=this._onPaste.event,this._onType=this._register(new $),this.onType=this._onType.event,this._onCompositionStart=this._register(new $),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new $),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new $),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new $),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new kn),this._asyncTriggerCut=this._register(new os(()=>this._onCut.fire(),0)),this._textAreaState=ws.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(ge.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new os(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let a=null;this._register(this._textArea.onKeyDown(l=>{const c=new jt(l);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),a=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(l=>{const c=new jt(l);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(l=>{const c=new bve;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&a&&a.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===l.data&&(a.code==="ArrowRight"||a.code==="ArrowLeft")){c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:l.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:l.data});return}this._onCompositionStart.fire({data:l.data})})),this._register(this._textArea.onCompositionUpdate(l=>{const c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){const d=ws.readFromTextArea(this._textArea,this._textAreaState),g=ws.deduceAndroidCompositionInput(this._textAreaState,d);this._textAreaState=d,this._onType.fire(g),this._onCompositionUpdate.fire(l);return}const u=c.handleCompositionUpdate(l.data);this._textAreaState=ws.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(l)})),this._register(this._textArea.onCompositionEnd(l=>{const c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){const d=ws.readFromTextArea(this._textArea,this._textAreaState),g=ws.deduceAndroidCompositionInput(this._textAreaState,d);this._textAreaState=d,this._onType.fire(g),this._onCompositionEnd.fire();return}const u=c.handleCompositionUpdate(l.data);this._textAreaState=ws.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const c=ws.readFromTextArea(this._textArea,this._textAreaState),u=ws.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(hn(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&(l.inputType==="insertFromPaste"?this._onPaste.fire({text:u.text,metadata:og.INSTANCE.get(u.text)}):this._onType.fire(u)))})),this._register(this._textArea.onCut(l=>{this._logService.trace("TextAreaInput#onCut",l),this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(l),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(l=>{this._logService.trace("TextAreaInput#onCopy",l),this._ensureClipboardGetsEditorSelection(l)})),this._register(this._textArea.onPaste(l=>{if(this._logService.trace("TextAreaInput#onPaste",l),this._textArea.setIgnoreSelectionChangeTime("received paste event"),l.preventDefault(),!l.clipboardData)return;let[c,u]=Sk.getTextData(l.clipboardData);this._logService.trace("TextAreaInput#onPaste with id : ",u==null?void 0:u.id," with text.length: ",c.length),c&&(u=u||og.INSTANCE.get(c),this._logService.trace("TextAreaInput#onPaste (before onPaste)"),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{const l=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!l&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new os(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return J(this._textArea.ownerDocument,"selectionchange",t=>{if(Pu.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const r=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),r<100||!this._textAreaState.selection)return;const o=this._textArea.getValue();if(this._textAreaState.value!==o)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),u=this._host.deduceModelPosition(c[0],c[1],c[2]),d=this._textAreaState.deduceEditorPosition(l),g=this._host.deduceModelPosition(d[0],d[1],d[2]),p=new gt(u.lineNumber,u.column,g.lineNumber,g.column);this._onSelectionChangeRequest.fire(p)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.isWrittenToTextArea(this._textArea,this._hasFocus)||this._logService.trace(`writeTextAreaState(reason: ${e})`),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent())}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy();let i;this._logService.getLevel()===yn.Trace&&(i=_6());const n={version:1,id:i,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};og.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,n),e.preventDefault(),e.clipboardData&&Sk.setTextData(e.clipboardData,t.text,t.html,n),this._logService.trace("TextAreaEditContextInput#_ensureClipboardGetsEditorSelection with id : ",i," with text.length: ",t.text.length)}};r5=_ve([xU(4,uo),xU(5,Ks)],r5);class Cve extends ne{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this._onSyntheticTap=this._register(new $),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this.onKeyDown=this._register(new Nt(this._actual,"keydown")).event,this.onKeyPress=this._register(new Nt(this._actual,"keypress")).event,this.onKeyUp=this._register(new Nt(this._actual,"keyup")).event,this.onCompositionStart=this._register(new Nt(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new Nt(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new Nt(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new Nt(this._actual,"beforeinput")).event,this.onInput=this._register(new Nt(this._actual,"input")).event,this.onCut=this._register(new Nt(this._actual,"cut")).event,this.onCopy=this._register(new Nt(this._actual,"copy")).event,this.onPaste=this._register(new Nt(this._actual,"paste")).event,this.onFocus=this._register(new Nt(this._actual,"focus")).event,this.onBlur=this._register(new Nt(this._actual,"blur")).event,this._register(this.onKeyDown(()=>Pu.onKeyDown())),this._register(this.onBeforeInput(()=>Pu.onBeforeInput())),this._register(this.onInput(()=>Pu.onInput())),this._register(this.onKeyUp(()=>Pu.onKeyUp())),this._register(J(this._actual,xk.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=Wg(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?Ln()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let r=null;const o=Wg(n);o?r=o.activeElement:r=Ln();const a=Ae(r),l=r===n,c=n.selectionStart,u=n.selectionEnd;if(l&&c===t&&u===i){Er&&a.parent!==a&&n.focus();return}if(l){this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),Er&&a.parent!==a&&n.focus();return}try{const d=Xpe(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),Zpe(n,d)}catch{}}}class wve extends p6{constructor(e,t,i){super(e,t,i),this._register($s.addTarget(this.viewHelper.linesContentDomNode)),this._register(J(this.viewHelper.linesContentDomNode,Qt.Tap,r=>this.onTap(r))),this._register(J(this.viewHelper.linesContentDomNode,Qt.Change,r=>this.onChange(r))),this._register(J(this.viewHelper.linesContentDomNode,Qt.Contextmenu,r=>this._onContextMenu(new gd(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(J(this.viewHelper.linesContentDomNode,"pointerdown",r=>{const o=r.pointerType;if(o==="mouse"){this._lastPointerType="mouse";return}else o==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const n=new Vwe(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(r,o)=>this._onMouseDown(r,o)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){const i=this._createMouseTarget(new gd(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class vve extends p6{constructor(e,t,i){super(e,t,i),this._register($s.addTarget(this.viewHelper.linesContentDomNode)),this._register(J(this.viewHelper.linesContentDomNode,Qt.Tap,n=>this.onTap(n))),this._register(J(this.viewHelper.linesContentDomNode,Qt.Change,n=>this.onChange(n))),this._register(J(this.viewHelper.linesContentDomNode,Qt.Contextmenu,n=>this._onContextMenu(new gd(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new gd(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(xk.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class yve extends ne{constructor(e,t,i){super(),(Gl||$fe&&rQ)&&Nv.pointerEvents?this.handler=this._register(new wve(e,t,i)):Ut.TouchEvent?this.handler=this._register(new vve(e,t,i)):this.handler=this._register(new p6(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}function Sve(s,e,t){let i=0;for(let r=0;r<s.length;r++)s.charAt(r)==="	"?i=_i.nextIndentTabStop(i,e):i++;let n="";if(!t){const r=Math.floor(i/e);i=i%e;for(let o=0;o<r;o++)n+="	"}for(let r=0;r<i;r++)n+=" ";return n}function yZ(s,e,t){let i=Lr(s);return i===-1&&(i=s.length),Sve(s.substring(0,i),e,t)+s.substring(i)}const xve=()=>!0,Lve=()=>!1,kve=s=>s===" "||s==="	";class Cp{static shouldRecreate(e){return e.hasChanged(165)||e.hasChanged(148)||e.hasChanged(45)||e.hasChanged(85)||e.hasChanged(88)||e.hasChanged(89)||e.hasChanged(10)||e.hasChanged(11)||e.hasChanged(15)||e.hasChanged(13)||e.hasChanged(14)||e.hasChanged(20)||e.hasChanged(145)||e.hasChanged(141)||e.hasChanged(59)||e.hasChanged(104)||e.hasChanged(147)||e.hasChanged(93)}constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const r=i.options,o=r.get(165),a=r.get(59);this.readOnly=r.get(104),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(132),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(o.height/this.lineHeight)-2),this.useTabStops=r.get(145),this.trimWhitespaceOnDelete=r.get(141),this.wordSeparators=r.get(148),this.emptySelectionClipboard=r.get(45),this.copyWithSyntaxHighlighting=r.get(31),this.multiCursorMergeOverlapping=r.get(85),this.multiCursorPaste=r.get(88),this.multiCursorLimit=r.get(89),this.autoClosingBrackets=r.get(10),this.autoClosingComments=r.get(11),this.autoClosingQuotes=r.get(15),this.autoClosingDelete=r.get(13),this.autoClosingOvertype=r.get(14),this.autoSurround=r.get(20),this.autoIndent=r.get(16),this.wordSegmenterLocales=r.get(147),this.overtypeOnPaste=r.get(93),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(const u of l)this.surroundingPairs[u.open]=u.close;const c=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=(c==null?void 0:c.blockCommentStartToken)??null}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)==null?void 0:e.getElectricCharacters();if(t)for(const i of t)this._electricChars[i]=!0}return this._electricChars}get inputMode(){return j4.getInputMode()}onElectricCharacter(e,t,i){const n=qf(t,i-1),r=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return r?r.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return yZ(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return kve;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return xve;case"never":return Lve}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return _i.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=_i.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),r=e.getLineMinColumn(t);if(n<r)return r;const o=e.getLineMaxColumn(t);return n>o?o:n}}class at{static fromModelState(e){return new Eve(e)}static fromViewState(e){return new Dve(e)}static fromModelSelection(e){const t=gt.liftSelection(e),i=new In(H.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return at.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class Eve{constructor(e){this.modelState=e,this.viewState=null}}class Dve{constructor(e){this.modelState=null,this.viewState=e}}class In{constructor(e,t,i,n,r){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=n,this.leftoverVisibleColumns=r,this._singleCursorStateBrand=void 0,this.selection=In._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new In(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new Y(t,i),n):new In(new H(t,i,t,i),0,n,new Y(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?gt.fromPositions(e.getStartPosition(),t):gt.fromPositions(e.getEndPosition(),t)}}class qs{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function md(s){return s==="'"||s==='"'||s==="`"}class yf{static columnSelect(e,t,i,n,r,o){const a=Math.abs(r-i)+1,l=i>r,c=n>o,u=n<o,d=[];for(let g=0;g<a;g++){const p=i+(l?-g:g),_=e.columnFromVisibleColumn(t,p,n),C=e.columnFromVisibleColumn(t,p,o),v=e.visibleColumnFromColumn(t,new Y(p,_)),x=e.visibleColumnFromColumn(t,new Y(p,C));u&&(v>o||x<n)||c&&(x>n||v<o)||d.push(new In(new H(p,_,p,_),0,0,new Y(p,C),0))}if(d.length===0)for(let g=0;g<a;g++){const p=i+(l?-g:g),_=t.getLineMaxColumn(p);d.push(new In(new H(p,_,p,_),0,0,new Y(p,_),0))}return{viewStates:d,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:r,toVisualColumn:o}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,yf.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const r=Math.min(i.fromViewLineNumber,i.toViewLineNumber),o=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=r;l<=o;l++){const c=t.getLineMaxColumn(l),u=e.visibleColumnFromColumn(t,new Y(l,c));n=Math.max(n,u)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){const r=n?e.pageSize:1,o=Math.max(1,i.toViewLineNumber-r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const r=n?e.pageSize:1,o=Math.min(t.getLineCount(),i.toViewLineNumber+r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}}class wr{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return gt.fromPositions(n.getEndPosition())}}class o5{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){const i=this._range.getStartPosition(),n=this._range.getEndPosition(),r=n.lineNumber,o=this._text.length+(this._range.isEmpty()?0:-1);let a=SZ(e,n,o);a.lineNumber>r&&(a=new Y(r,e.getLineMaxColumn(r)));const l=H.fromPositions(i,a);t.addTrackedEditOperation(l,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return gt.fromPositions(n.getEndPosition())}}class jx{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return gt.fromPositions(n.getStartPosition())}}class Lk{constructor(e,t,i,n,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return gt.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class Tve{constructor(e){this._range=e}getEditOperations(e,t){const i=e.getValueInRange(this._range),n=this._range.getEndPosition(),r=n.lineNumber;let o=SZ(e,n,i.length);o.lineNumber>r&&(o=new Y(r,e.getLineMaxColumn(r)));const a=H.fromPositions(n,o);t.addTrackedEditOperation(a,"")}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return gt.fromPositions(n.getEndPosition())}}class Nve{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function SZ(s,e,t){if(t<0)throw new Error("Unexpected negative delta");const i=s.getLineCount();let n=new Y(i,s.getLineMaxColumn(i));for(let r=e.lineNumber;r<=i;r++)if(r===e.lineNumber){const o=t-s.getLineMaxColumn(e.lineNumber)+e.column;if(o<=0){n=new Y(e.lineNumber,e.column+t);break}t=o}else{const o=t-s.getLineMaxColumn(r);if(o<=0){n=new Y(r,t);break}t=o}return n}class dR{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class Et{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-NQ(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new Y(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),o=Mw.atomicPosition(r,t.column-1,i,0);if(o!==-1&&o+1>=n)return new Y(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?Et.leftPositionAtomicSoftTabs(t,i,e.tabSize):Et.leftPosition(t,i);return new dR(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,r){let o,a;if(i.hasSelection()&&!n)o=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(r-1)),c=t.normalizePosition(Et.clipPositionColumn(l,t),0),u=Et.left(e,t,c);o=u.lineNumber,a=u.column}return i.move(n,o,a,0)}static clipPositionColumn(e,t){return new Y(e.lineNumber,Et.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+y7(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new Y(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,r){if(i<e.getLineIndentColumn(t)){const o=e.getLineContent(t),a=Mw.atomicPosition(o,i-1,n,1);if(a!==-1)return new Y(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?Et.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):Et.rightPosition(t,i.lineNumber,i.column);return new dR(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,r){let o,a;if(i.hasSelection()&&!n)o=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,r-1),c=t.normalizePosition(Et.clipPositionColumn(l,t),1),u=Et.right(e,t,c);o=u.lineNumber,a=u.column}return i.move(n,o,a,0)}static vertical(e,t,i,n,r,o,a,l){const c=_i.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+r,u=t.getLineCount(),d=i===1&&n===1,g=i===u&&n===t.getLineMaxColumn(i),p=o<i?d:g;if(i=o,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>u?(i=u,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,c),p?r=0:r=c-_i.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){const _=new Y(i,n),C=t.normalizePosition(_,l);r=r+(n-C.column),i=C.lineNumber,n=C.column}return new dR(i,n,r)}static down(e,t,i,n,r,o,a){return this.vertical(e,t,i,n,r,i+o,a,4)}static moveDown(e,t,i,n,r){let o,a;i.hasSelection()&&!n?(o=i.selection.endLineNumber,a=i.selection.endColumn):(o=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=Et.down(e,t,o+l,a,i.leftoverVisibleColumns,r,!0),t.normalizePosition(new Y(c.lineNumber,c.column),2).lineNumber>o)break;while(l++<10&&o+l<t.getLineCount());return i.move(n,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,r=Et.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Et.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new In(new H(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new Y(o.lineNumber,o.column),o.leftoverVisibleColumns)}static up(e,t,i,n,r,o,a){return this.vertical(e,t,i,n,r,i-o,a,3)}static moveUp(e,t,i,n,r){let o,a;i.hasSelection()&&!n?(o=i.selection.startLineNumber,a=i.selection.startColumn):(o=i.position.lineNumber,a=i.position.column);const l=Et.up(e,t,o,a,i.leftoverVisibleColumns,r,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,r=Et.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Et.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new In(new H(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new Y(o.lineNumber,o.column),o.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let r=i.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,i,n){const r=t.getLineCount();let o=i.position.lineNumber;for(;o<r&&this._isBlankLine(t,o);)o++;for(;o<r&&!this._isBlankLine(t,o);)o++;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToBeginningOfLine(e,t,i,n){const r=i.position.lineNumber,o=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||o;let l;return i.position.column===a?l=o:l=a,i.move(n,r,l,0)}static moveToEndOfLine(e,t,i,n,r){const o=i.position.lineNumber,a=t.getLineMaxColumn(o);return i.move(n,o,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const r=t.getLineCount(),o=t.getLineMaxColumn(r);return i.move(n,r,o,0)}}class $g{static deleteRight(e,t,i,n){const r=[];let o=e!==3;for(let a=0,l=n.length;a<l;a++){const c=n[a],u=this.getDeleteRightRange(c,i,t);if(u.isEmpty()){r[a]=null;continue}u.startLineNumber!==u.endLineNumber&&(o=!0),r[a]=new wr(u,"")}return[o,r]}static getDeleteRightRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition(),r=Et.right(i,t,n);if(i.trimWhitespaceOnDelete&&r.lineNumber!==n.lineNumber){const o=t.getLineFirstNonWhitespaceColumn(n.lineNumber)>0,a=t.getLineFirstNonWhitespaceColumn(r.lineNumber);if(o&&a>0)return new H(r.lineNumber,a,n.lineNumber,n.column)}return new H(r.lineNumber,r.column,n.lineNumber,n.column)}static isAutoClosingPairDelete(e,t,i,n,r,o,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=o.length;l<c;l++){const u=o[l],d=u.getPosition();if(!u.isEmpty())return!1;const g=r.getLineContent(d.lineNumber);if(d.column<2||d.column>=g.length+1)return!1;const p=g.charAt(d.column-2),_=n.get(p);if(!_)return!1;if(md(p)){if(i==="never")return!1}else if(t==="never")return!1;const C=g.charAt(d.column-1);let v=!1;for(const x of _)x.open===p&&x.close===C&&(v=!0);if(!v)return!1;if(e==="auto"){let x=!1;for(let S=0,k=a.length;S<k;S++){const E=a[S];if(d.lineNumber===E.startLineNumber&&d.column===E.startColumn){x=!0;break}}if(!x)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].getPosition(),l=new H(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[r]=new wr(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,r))return this._runAutoClosingPairDelete(t,i,n);const o=[];let a=e!==2;for(let l=0,c=n.length;l<c;l++){const u=$g.getDeleteLeftRange(n[l],i,t);if(u.isEmpty()){o[l]=null;continue}u.startLineNumber!==u.endLineNumber&&(a=!0),o[l]=new wr(u,"")}return[a,o]}static getDeleteLeftRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const r=t.getLineContent(n.lineNumber),o=Lr(r),a=o===-1?r.length+1:o+1;if(n.column<=a){const l=i.visibleColumnFromColumn(t,n),c=_i.prevIndentTabStop(l,i.indentSize),u=i.columnFromVisibleColumn(t,n.lineNumber,c);return new H(n.lineNumber,u,n.lineNumber,n.column)}}return H.fromPositions($g.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=zme(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new Y(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const n=[];let r=null;i.sort((o,a)=>Y.compare(o.getStartPosition(),a.getEndPosition()));for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let u,d,g,p;c.lineNumber<t.getLineCount()?(u=c.lineNumber,d=1,g=c.lineNumber+1,p=1):c.lineNumber>1&&(r==null?void 0:r.endLineNumber)!==c.lineNumber?(u=c.lineNumber-1,d=t.getLineMaxColumn(c.lineNumber-1),g=c.lineNumber,p=t.getLineMaxColumn(c.lineNumber)):(u=c.lineNumber,d=1,g=c.lineNumber,p=t.getLineMaxColumn(c.lineNumber));const _=new H(u,d,g,p);r=_,_.isEmpty()?n[o]=null:n[o]=new wr(_,"")}else n[o]=null;else n[o]=new wr(l,"")}return new qs(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Mi{static _createWord(e,t,i,n,r){return{start:n,end:r,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;const r=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let o=i.column-2;o>=0;o--){const a=e.charCodeAt(o),l=t.get(a);if(r&&o===r.index)return this._createIntlWord(r,l);if(l===0){if(n===2)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const r=t.findNextIntlWordAtOrAfterOffset(e,n),o=e.length;for(let a=n;a<o;a++){const l=e.charCodeAt(a),c=t.get(l);if(r&&a===r.index+r.segment.length||c===1||i===1&&c===2||i===2&&c===0)return a}return o}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const r=e.length,o=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<r;a++){const l=e.charCodeAt(a),c=t.get(l);if(o&&a===o.index)return this._createIntlWord(o,c);if(c===0){if(n===2)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(c===2){if(n===1)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(c===1&&n!==0)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,r-1),r):null}static _findStartOfWord(e,t,i,n){const r=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let o=n;o>=0;o--){const a=e.charCodeAt(o),l=t.get(a);if(r&&o===r.index)return o;if(l===1||i===1&&l===2||i===2&&l===0)return o+1}return 0}static moveWordLeft(e,t,i,n,r){let o=i.lineNumber,a=i.column;a===1&&o>1&&(o=o-1,a=t.getLineMaxColumn(o));let l=Mi._findPreviousWordOnLine(e,t,new Y(o,a));if(n===0)return new Y(o,l?l.start+1:1);if(n===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=Mi._findPreviousWordOnLine(e,t,new Y(o,l.start+1))),new Y(o,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=Mi._findPreviousWordOnLine(e,t,new Y(o,l.start+1));return new Y(o,l?l.start+1:1)}return l&&a<=l.end+1&&(l=Mi._findPreviousWordOnLine(e,t,new Y(o,l.start+1))),new Y(o,l?l.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new Y(i-1,e.getLineMaxColumn(i-1)):t;const r=e.getLineContent(i);for(let o=t.column-1;o>1;o--){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a===95&&l!==95)return new Y(i,o);if(a===45&&l!==45)return new Y(i,o);if((Fp(a)||MS(a))&&Su(l))return new Y(i,o);if(Su(a)&&Su(l)&&o+1<n){const c=r.charCodeAt(o);if(Fp(c)||MS(c))return new Y(i,o)}}return new Y(i,1)}static moveWordRight(e,t,i,n){let r=i.lineNumber,o=i.column,a=!1;o===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,o=1);let l=Mi._findNextWordOnLine(e,t,new Y(r,o));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=Mi._findNextWordOnLine(e,t,new Y(r,l.end+1))),l?o=l.end+1:o=t.getLineMaxColumn(r);else if(n===3){for(a&&(o=0);l&&(l.wordType===2||l.start+1<=o);)l=Mi._findNextWordOnLine(e,t,new Y(r,l.end+1));l?o=l.start+1:o=t.getLineMaxColumn(r)}else l&&!a&&o>=l.start+1&&(l=Mi._findNextWordOnLine(e,t,new Y(r,l.end+1))),l?o=l.start+1:o=t.getLineMaxColumn(r);return new Y(r,o)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new Y(i+1,1):t;const r=e.getLineContent(i);for(let o=t.column+1;o<n;o++){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a!==95&&l===95)return new Y(i,o);if(a!==45&&l===45)return new Y(i,o);if((Fp(a)||MS(a))&&Su(l))return new Y(i,o);if(Su(a)&&Su(l)&&o+1<n){const c=r.charCodeAt(o);if(Fp(c)||MS(c))return new Y(i,o)}}return new Y(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,r=rm(i,n);return r+1<n?new H(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;if($g.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const d=e.selection.getPosition();return new H(d.lineNumber,d.column-1,d.lineNumber,d.column+1)}const a=new Y(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(o){const d=this._deleteWordLeftWhitespace(n,a);if(d)return d}let u=Mi._findPreviousWordOnLine(i,n,a);return t===0?u?c=u.start+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l)):(u&&c<=u.end+1&&(u=Mi._findPreviousWordOnLine(i,n,new Y(l,u.start+1))),u?c=u.end+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l))),new H(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new Y(i.positionLineNumber,i.positionColumn),r=this._deleteInsideWordWhitespace(t,n);return r||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,r))return null;let o=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,o))return null;for(;r>0&&this._charAtIsWhitespace(i,r-1);)r--;for(;o+1<n&&this._charAtIsWhitespace(i,o+1);)o++;return new H(t.lineNumber,r+1,t.lineNumber,o+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),r=n.length;if(r===0)return i.lineNumber>1?new H(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new H(i.lineNumber,1,i.lineNumber+1,1):new H(i.lineNumber,1,i.lineNumber,1);const o=d=>d.start+1<=i.column&&i.column<=d.end+1,a=(d,g)=>(d=Math.min(d,i.column),g=Math.max(g,i.column),new H(i.lineNumber,d,i.lineNumber,g)),l=d=>{let g=d.start+1,p=d.end+1,_=!1;for(;p-1<r&&this._charAtIsWhitespace(n,p-1);)_=!0,p++;if(!_)for(;g>1&&this._charAtIsWhitespace(n,g-2);)g--;return a(g,p)},c=Mi._findPreviousWordOnLine(e,t,i);if(c&&o(c))return l(c);const u=Mi._findNextWordOnLine(e,t,i);return u&&o(u)?l(u):c&&u?a(c.end+1,u.start+1):c?a(c.start+1,c.end+1):u?a(u.start+1,u.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=Mi._moveWordPartLeft(e,i);return new H(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const r=e.charAt(n);if(r!==" "&&r!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,r=this._findFirstNonWhitespaceChar(i,n);return n+1<r?new H(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;const a=new Y(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;const u=n.getLineCount(),d=n.getLineMaxColumn(l);if(l===u&&c===d)return null;if(o){const p=this._deleteWordRightWhitespace(n,a);if(p)return p}let g=Mi._findNextWordOnLine(i,n,a);return t===2?g?c=g.end+1:c<d||l===u?c=d:(l++,g=Mi._findNextWordOnLine(i,n,new Y(l,1)),g?c=g.start+1:c=n.getLineMaxColumn(l)):(g&&c>=g.start+1&&(g=Mi._findNextWordOnLine(i,n,new Y(l,g.end+1))),g?c=g.start+1:c<d||l===u?c=d:(l++,g=Mi._findNextWordOnLine(i,n,new Y(l,1)),g?c=g.start+1:c=n.getLineMaxColumn(l))),new H(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=Mi._moveWordPartRight(e,i);return new H(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new H(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){const r=f1(t,i),o=Mi._findPreviousWordOnLine(r,e,n);if(o&&o.wordType===1&&o.start<=n.column-1&&n.column-1<=o.end)return Mi._createWordAtPosition(e,n.lineNumber,o);const a=Mi._findNextWordOnLine(r,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?Mi._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,r){const o=f1(e.wordSeparators,e.wordSegmenterLocales),a=Mi._findPreviousWordOnLine(o,t,r),l=Mi._findNextWordOnLine(o,t,r);if(!n){let p,_;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end||a&&a.wordType===2&&a.start<=r.column-1&&r.column-1<a.end?(p=a.start+1,_=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end||l&&l.wordType===2&&l.start<=r.column-1&&r.column-1<l.end?(p=l.start+1,_=l.end+1):(a?p=a.end+1:p=1,l?_=l.start+1:_=t.getLineMaxColumn(r.lineNumber)),new In(new H(r.lineNumber,p,r.lineNumber,_),1,0,new Y(r.lineNumber,_),0)}let c,u;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(c=a.start+1,u=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(c=l.start+1,u=l.end+1):(c=r.column,u=r.column);const d=r.lineNumber;let g;if(i.selectionStart.containsPosition(r))g=i.selectionStart.endColumn;else if(r.isBeforeOrEqual(i.selectionStart.getStartPosition())){g=c;const p=new Y(d,g);i.selectionStart.containsPosition(p)&&(g=i.selectionStart.endColumn)}else{g=u;const p=new Y(d,g);i.selectionStart.containsPosition(p)&&(g=i.selectionStart.startColumn)}return i.move(!0,d,g,0)}}class fs{static addCursorDown(e,t,i){const n=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];n[r++]=new at(l.modelState,l.viewState),i?n[r++]=at.fromModelState(Et.translateDown(e.cursorConfig,e.model,l.modelState)):n[r++]=at.fromViewState(Et.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){const n=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];n[r++]=new at(l.modelState,l.viewState),i?n[r++]=at.fromModelState(Et.translateUp(e.cursorConfig,e.model,l.modelState)):n[r++]=at.fromViewState(Et.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,r=t.modelState.position.column,o=n===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!o&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return at.fromViewState(Et.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return at.fromModelState(Et.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=this._moveToLineEnd(e,l,i,n)}return r}static _moveToLineEnd(e,t,i,n){const r=t.viewState.position,o=e.getLineMaxColumn(r.lineNumber),a=r.column===o,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),u=o-r.column===c-l.column;return a||u?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return at.fromViewState(Et.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return at.fromModelState(Et.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,r=t.length;n<r;n++){const o=t[n],a=o.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=o.modelState.selection.endLineNumber,u;c===l?u=e.model.getLineMaxColumn(l):(c++,u=1),i[n]=at.fromModelState(new In(new H(a,1,a,1),0,0,new Y(c,u),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=at.fromModelState(Et.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=at.fromModelState(Et.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return at.fromModelState(new In(new H(1,1,1,1),0,0,new Y(i,n),0))}static line(e,t,i,n,r){const o=e.model.validatePosition(n),a=r?e.coordinatesConverter.validateViewPosition(new Y(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!i){const c=e.model.getLineCount();let u=o.lineNumber+1,d=1;return u>c&&(u=c,d=e.model.getLineMaxColumn(u)),at.fromModelState(new In(new H(o.lineNumber,1,u,d),2,0,new Y(u,d),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<l)return at.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(o.lineNumber>l){const c=e.getLineCount();let u=a.lineNumber+1,d=1;return u>c&&(u=c,d=e.getLineMaxColumn(u)),at.fromViewState(t.viewState.move(!0,u,d,0))}else{const c=t.modelState.selectionStart.getEndPosition();return at.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,n){const r=e.model.validatePosition(n);return at.fromModelState(Mi.word(e.cursorConfig,e.model,t.modelState,i,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new at(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return at.fromViewState(new In(new H(i,n,i,n),0,0,new Y(i,n),0))}static moveTo(e,t,i,n,r){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,r)}const o=e.model.validatePosition(n),a=r?e.coordinatesConverter.validateViewPosition(new Y(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return at.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,r,o){switch(i){case 0:return o===4?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,r);case 1:return o===4?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,r);case 2:return o===2?this._moveUpByViewLines(e,t,n,r):this._moveUpByModelLines(e,t,n,r);case 3:return o===2?this._moveDownByViewLines(e,t,n,r):this._moveDownByModelLines(e,t,n,r);case 4:return o===2?t.map(a=>at.fromViewState(Et.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>at.fromModelState(Et.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 5:return o===2?t.map(a=>at.fromViewState(Et.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>at.fromModelState(Et.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,r){const o=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(o);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 14:{const l=[];for(let c=0,u=t.length;c<u;c++){const d=t[c];l[c]=this.findPositionInViewportIfOutside(e,d,o,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const r=t.viewState.position.lineNumber;if(i.startLineNumber<=r&&r<=i.endLineNumber-1)return new at(t.modelState,t.viewState);{let o;r>i.endLineNumber-1?o=i.endLineNumber-1:r<i.startLineNumber?o=i.startLineNumber:o=r;const a=Et.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,o,!1);return at.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(r=>{const a=e.getTextDirection(r.viewState.position.lineNumber)===no.RTL;return at.fromViewState(a?Et.moveRight(e.cursorConfig,e,r.viewState,i,n):Et.moveLeft(e.cursorConfig,e,r.viewState,i,n))})}static _moveHalfLineLeft(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[r]=at.fromViewState(Et.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveRight(e,t,i,n){return t.map(r=>{const a=e.getTextDirection(r.viewState.position.lineNumber)===no.RTL;return at.fromViewState(a?Et.moveLeft(e.cursorConfig,e,r.viewState,i,n):Et.moveRight(e.cursorConfig,e,r.viewState,i,n))})}static _moveHalfLineRight(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[r]=at.fromViewState(Et.moveRight(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveDownByViewLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=at.fromViewState(Et.moveDown(e.cursorConfig,e,l.viewState,i,n))}return r}static _moveDownByModelLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=at.fromModelState(Et.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return r}static _moveUpByViewLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=at.fromViewState(Et.moveUp(e.cursorConfig,e,l.viewState,i,n))}return r}static _moveUpByModelLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=at.fromModelState(Et.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return r}static _moveToViewPosition(e,t,i,n,r){return at.fromViewState(t.viewState.move(i,n,r,0))}static _moveToModelPosition(e,t,i,n,r){return at.fromModelState(t.modelState.move(i,n,r,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}}var kk;(function(s){const e=function(i){if(!Vs(i))return!1;const n=i;return!(!Pn(n.to)||!to(n.select)&&!GA(n.select)||!to(n.by)&&!Pn(n.by)||!to(n.value)&&!nm(n.value)||!to(n.noHistory)&&!GA(n.noHistory))};s.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
					* 'noHistory': If 'true' does not add the movement to navigation history. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1},noHistory:{type:"boolean",default:!1}}}}]},s.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let n;switch(i.to){case s.RawDirection.Left:n=0;break;case s.RawDirection.Right:n=1;break;case s.RawDirection.Up:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.PrevBlankLine:n=4;break;case s.RawDirection.NextBlankLine:n=5;break;case s.RawDirection.WrappedLineStart:n=6;break;case s.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case s.RawDirection.WrappedLineColumnCenter:n=8;break;case s.RawDirection.WrappedLineEnd:n=9;break;case s.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case s.RawDirection.ViewPortTop:n=11;break;case s.RawDirection.ViewPortBottom:n=13;break;case s.RawDirection.ViewPortCenter:n=12;break;case s.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let r=0;switch(i.by){case s.RawUnit.Line:r=1;break;case s.RawUnit.WrappedLine:r=2;break;case s.RawUnit.Character:r=3;break;case s.RawUnit.HalfLine:r=4;break}return{direction:n,unit:r,select:!!i.select,value:i.value||1,noHistory:!!i.noHistory}}s.parse=t})(kk||(kk={}));class Ive{constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new xZ(e,i)}shouldIncrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}}class b6{constructor(e,t){this.model=e,this.indentationLineProcessor=new xZ(e,t)}getProcessedTokenContextAroundRange(e){const t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);const t=this.model.tokenization.getLineTokens(e.startLineNumber),i=qf(t,e.startColumn-1);let n;if(C6(this.model,e.getStartPosition())){const o=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+o;n=t.sliceAndInflate(a,l,0)}else{const o=e.startColumn-1;n=t.sliceAndInflate(0,o,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){const t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);const i=this.model.tokenization.getLineTokens(t.lineNumber),n=qf(i,t.column-1),r=t.column-1-n.firstCharOffset,o=n.firstCharOffset+r,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(o,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){const t=p=>{this.model.tokenization.forceTokenization(p);const _=this.model.tokenization.getLineTokens(p),C=this.model.getLineMaxColumn(p)-1;return qf(_,C)};this.model.tokenization.forceTokenization(e.startLineNumber);const i=this.model.tokenization.getLineTokens(e.startLineNumber),n=qf(i,e.startColumn-1),r=gn.createEmpty("",n.languageIdCodec),o=e.startLineNumber-1;if(o===0||!(n.firstCharOffset===0))return r;const c=t(o);if(!(n.languageId===c.languageId))return r;const d=c.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(d)}}class xZ{constructor(e,t){this.model=e,this.languageConfigurationService=t}getProcessedLine(e,t){var o,a;const i=(l,c)=>{const u=Os(l);return c+l.substring(u.length)};(a=(o=this.model.tokenization).forceTokenization)==null||a.call(o,e);const n=this.model.tokenization.getLineTokens(e);let r=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(r=i(r,t)),r}getProcessedTokens(e){const t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),o=[];return e.forEach(l=>{const c=e.getStandardTokenType(l);let u=e.getTokenText(l);t(c)&&(u=u.replace(r,""));const d=e.getMetadata(l);o.push({text:u,metadata:d})}),gn.createFromTextAndMetadata(o,e.languageIdCodec)}}function C6(s,e){s.tokenization.forceTokenization(e.lineNumber);const t=s.tokenization.getLineTokens(e.lineNumber),i=qf(t,e.column-1),n=i.firstCharOffset===0,r=t.getLanguageId(0)===i.languageId;return!n&&!r}function w6(s,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);const n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=i.getLanguageConfiguration(n);if(!r)return null;const a=new b6(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),c=a.beforeRangeProcessedTokens.getLineContent(),u=a.afterRangeProcessedTokens.getLineContent(),d=r.onEnter(s,l,c,u);if(!d)return null;const g=d.indentAction;let p=d.appendText;const _=d.removeText||0;p?g===Hs.Indent&&(p="	"+p):g===Hs.Indent||g===Hs.IndentOutdent?p="	":p="";let C=LX(e,t.startLineNumber,t.startColumn);return _&&(C=C.substring(0,C.length-_)),{indentAction:g,appendText:p,removeText:_,indentation:C}}var Rve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ave=function(s,e){return function(t,i){e(t,i,s)}},$x;const fR=Object.create(null);function Qd(s,e){if(e<=0)return"";fR[s]||(fR[s]=["",s]);const t=fR[s];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+s;return t[e]}let qg=$x=class{static unshiftIndent(e,t,i,n,r){const o=_i.visibleColumnFromColumn(e,t,i);if(r){const a=Qd(" ",n),c=_i.prevIndentTabStop(o,n)/n;return Qd(a,c)}else{const c=_i.prevRenderTabStop(o,i)/i;return Qd("	",c)}}static shiftIndent(e,t,i,n,r){const o=_i.visibleColumnFromColumn(e,t,i);if(r){const a=Qd(" ",n),c=_i.nextIndentTabStop(o,n)/n;return Qd(a,c)}else{const c=_i.nextRenderTabStop(o,i)/i;return Qd("	",c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);const{tabSize:r,indentSize:o,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,u=0;for(let d=i;d<=n;d++,c=u){u=0;const g=e.getLineContent(d);let p=Lr(g);if(this._opts.isUnshift&&(g.length===0||p===0)||!l&&!this._opts.isUnshift&&g.length===0)continue;if(p===-1&&(p=g.length),d>1&&_i.visibleColumnFromColumn(g,p+1,r)%o!==0&&e.tokenization.isCheapToTokenize(d-1)){const v=w6(this._opts.autoIndent,e,new H(d-1,e.getLineMaxColumn(d-1),d-1,e.getLineMaxColumn(d-1)),this._languageConfigurationService);if(v){if(u=c,v.appendText)for(let x=0,S=v.appendText.length;x<S&&u<o&&v.appendText.charCodeAt(x)===32;x++)u++;v.removeText&&(u=Math.max(0,u-v.removeText));for(let x=0;x<u&&!(p===0||g.charCodeAt(p-1)!==32);x++)p--}}if(this._opts.isUnshift&&p===0)continue;let _;this._opts.isUnshift?_=$x.unshiftIndent(g,p+1,r,o,a):_=$x.shiftIndent(g,p+1,r,o,a),this._addEditOperation(t,new H(d,1,d,p+1),_),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=p+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?Qd(" ",o):"	";for(let u=i;u<=n;u++){const d=e.getLineContent(u);let g=Lr(d);if(!(this._opts.isUnshift&&(d.length===0||g===0))&&!(!l&&!this._opts.isUnshift&&d.length===0)&&(g===-1&&(g=d.length),!(this._opts.isUnshift&&g===0)))if(this._opts.isUnshift){g=Math.min(g,o);for(let p=0;p<g;p++)if(d.charCodeAt(p)===9){g=p+1;break}this._addEditOperation(t,new H(u,1,u,g+1),"")}else this._addEditOperation(t,new H(u,1,u,1),c),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const n=t.getInverseEditOperations()[0];return new gt(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new gt(i.startLineNumber,n,i.endLineNumber,i.endColumn):new gt(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};qg=$x=Rve([Ave(2,rc)],qg);class Mve{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new H(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new H(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection||null)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,r=i[1].range;return new gt(n.endLineNumber,n.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}}class Ove{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new H(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new gt(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}function Pve(s,e,t){const i=s.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,r=-1;for(n=e-1;n>=1;n--){if(s.tokenization.getLanguageIdAtPosition(n,0)!==i)return r;const o=s.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(o)||o===""){r=n;continue}return n}}return-1}function Ek(s,e,t,i=!0,n){if(s<4)return null;const r=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;const o=new Ive(e,r,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const a=Pve(e,t,o);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(o.shouldIncrease(a)||o.shouldIndentNextLine(a)){const l=e.getLineContent(a);return{indentation:Os(l),action:Hs.Indent,line:a}}else if(o.shouldDecrease(a)){const l=e.getLineContent(a);return{indentation:Os(l),action:null,line:a}}else{if(a===1)return{indentation:Os(e.getLineContent(a)),action:null,line:a};const l=a-1,c=r.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let u=0;for(let d=l-1;d>0;d--)if(!o.shouldIndentNextLine(d)){u=d;break}return{indentation:Os(e.getLineContent(u+1)),action:null,line:u+1}}if(i)return{indentation:Os(e.getLineContent(a)),action:null,line:a};for(let u=a;u>0;u--){if(o.shouldIncrease(u))return{indentation:Os(e.getLineContent(u)),action:Hs.Indent,line:u};if(o.shouldIndentNextLine(u)){let d=0;for(let g=u-1;g>0;g--)if(!o.shouldIndentNextLine(u)){d=g;break}return{indentation:Os(e.getLineContent(d+1)),action:null,line:d+1}}else if(o.shouldDecrease(u))return{indentation:Os(e.getLineContent(u)),action:null,line:u}}return{indentation:Os(e.getLineContent(1)),action:null,line:1}}}function Fve(s,e,t,i,n){if(s<4)return null;const r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=n.getLanguageConfiguration(r).indentRulesSupport;if(!o)return null;e.tokenization.forceTokenization(t.startLineNumber);const l=new b6(e,n).getProcessedTokenContextAroundRange(t),c=l.afterRangeProcessedTokens,u=l.beforeRangeProcessedTokens,d=Os(u.getLineContent()),g=Vve(e,t.startLineNumber,u),p=C6(e,t.getStartPosition()),_=e.getLineContent(t.startLineNumber),C=Os(_),v=Ek(s,g,t.startLineNumber+1,void 0,n);if(!v){const S=p?C:d;return{beforeEnter:S,afterEnter:S}}let x=p?C:v.indentation;return v.action===Hs.Indent&&(x=i.shiftIndent(x)),o.shouldDecrease(c.getLineContent())&&(x=i.unshiftIndent(x)),{beforeEnter:p?C:d,afterEnter:x}}function Bve(s,e,t,i,n,r){const o=s.autoIndent;if(o<4||C6(e,t.getStartPosition()))return null;const l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),c=r.getLanguageConfiguration(l).indentRulesSupport;if(!c)return null;const d=new b6(e,r).getProcessedTokenContextAroundRange(t),g=d.beforeRangeProcessedTokens.getLineContent(),p=d.afterRangeProcessedTokens.getLineContent(),_=g+p,C=g+i+p;if(!c.shouldDecrease(_)&&c.shouldDecrease(C)){const x=Ek(o,e,t.startLineNumber,!1,r);if(!x)return null;let S=x.indentation;return x.action!==Hs.Indent&&(S=n.unshiftIndent(S)),S}const v=t.startLineNumber-1;if(v>0){const x=e.getLineContent(v);if(c.shouldIndentNextLine(x)&&c.shouldIncrease(C)){const S=Ek(o,e,t.startLineNumber,!1,r),k=S==null?void 0:S.indentation;if(k!==void 0){const E=e.getLineContent(t.startLineNumber),T=Os(E),N=n.shiftIndent(k)===T,A=/^\s*$/.test(_),O=s.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),j=O&&O.length>0&&A;if(N&&j)return k}}}return null}function Vve(s,e,t){return{tokenization:{getLineTokens:n=>n===e?t:s.tokenization.getLineTokens(n),getLanguageId:()=>s.getLanguageId(),getLanguageIdAtPosition:(n,r)=>s.getLanguageIdAtPosition(n,r)},getLineContent:n=>n===e?t.getLineContent():s.getLineContent(n)}}class Wve{static getEdits(e,t,i,n,r){if(!r&&this._isAutoIndentType(e,t,i)){const o=[];for(const l of i){const c=this._findActualIndentationForSelection(e,t,l,n);if(c===null)return;o.push({selection:l,indentation:c})}const a=a5.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,o,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,r=i.length;n<r;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){const r=Bve(e,t,i,n,{shiftIndent:a=>S6(e,a),unshiftIndent:a=>Dk(e,a)},e.languageConfigurationService);if(r===null)return null;const o=LX(t,i.startLineNumber,i.startColumn);return r===e.normalizeIndentation(o)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,r){const o=i.map(({selection:l,indentation:c})=>{if(r!==null){const u=this._getEditFromIndentationAndSelection(e,t,c,l,n,!1);return new Xve(u,l,n,r)}else{const u=this._getEditFromIndentationAndSelection(e,t,c,l,n,!0);return lf(u.range,u.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new qs(4,o,a)}static _getEditFromIndentationAndSelection(e,t,i,n,r,o=!0){const a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a);let c=e.normalizeIndentation(i);if(l!==0){const d=t.getLineContent(a);c+=d.substring(l-1,n.startColumn-1)}return c+=o?r:"",{range:new H(a,1,n.endLineNumber,n.endColumn),text:c}}}class Hve{static getEdits(e,t,i,n,r,o){if(kZ(t,i,n,r,o))return this._runAutoClosingOvertype(e,n,o)}static _runAutoClosingOvertype(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const l=t[r].getPosition(),c=new H(l.lineNumber,l.column,l.lineNumber,l.column+1);n[r]=new wr(c,i)}return new qs(4,n,{shouldPushStackElementBefore:ID(e,4),shouldPushStackElementAfter:!1})}}class zve{static getEdits(e,t,i,n,r){if(kZ(e,t,i,n,r)){const o=i.map(a=>new wr(new H(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new qs(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class a5{static getEdits(e,t,i,n,r,o){if(!o){const a=this.getAutoClosingPairClose(e,t,i,n,r);if(a!==null)return this._runAutoClosingOpenCharType(i,n,r,a)}}static _runAutoClosingOpenCharType(e,t,i,n){const r=[];for(let o=0,a=e.length;o<a;o++){const l=e[o];r[o]=new Qve(l,t,!i,n)}return new qs(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,r){for(const _ of i)if(!_.isEmpty())return null;const o=i.map(_=>{const C=_.getPosition();return r?{lineNumber:C.lineNumber,beforeColumn:C.column-n.length,afterColumn:C.column}:{lineNumber:C.lineNumber,beforeColumn:C.column,afterColumn:C.column}}),a=this._findAutoClosingPairOpen(e,t,o.map(_=>new Y(_.lineNumber,_.beforeColumn)),n);if(!a)return null;let l,c;if(md(n)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const d=this._findContainedAutoClosingPair(e,a),g=d?d.close:"";let p=!0;for(const _ of o){const{lineNumber:C,beforeColumn:v,afterColumn:x}=_,S=t.getLineContent(C),k=S.substring(0,v-1),E=S.substring(x-1);if(E.startsWith(g)||(p=!1),E.length>0){const A=E.charAt(0);if(!this._isBeforeClosingBrace(e,E)&&!c(A))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){const A=f1(e.wordSeparators,[]);if(k.length>0){const O=k.charCodeAt(k.length-1);if(A.get(O)===0)return null}}if(!t.tokenization.isCheapToTokenize(C))return null;t.tokenization.forceTokenization(C);const T=t.tokenization.getLineTokens(C),R=qf(T,v-1);if(!a.shouldAutoClose(R,v-R.firstCharOffset))return null;const N=a.findNeutralCharacter();if(N){const A=t.tokenization.getTokenTypeIfInsertingCharacter(C,v,N);if(!a.isOK(A))return null}}return p?a.close.substring(0,a.close.length-g.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let r=null;for(const o of n)o.open!==t.open&&t.open.includes(o.open)&&t.close.endsWith(o.close)&&(!r||o.open.length>r.open.length)&&(r=o);return r}static _findAutoClosingPairOpen(e,t,i,n){const r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!r)return null;let o=null;for(const a of r)if(o===null||a.open.length>o.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new H(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+n!==a.open){l=!1;break}l&&(o=a)}return o}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],o=n.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!o&&a}}class LU{static getEdits(e,t){if(!(e.inputMode==="overtype"))return null;const n=t.map(r=>new Tve(r.insertedTextRange));return new qs(4,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}class Uve{static getEdits(e,t,i,n,r){if(!r&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=e.surroundingPairs[i];n[r]=new Mve(a,i,l)}return new qs(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!EZ(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const r=md(n);for(const o of i){if(o.isEmpty())return!1;let a=!0;for(let l=o.startLineNumber;l<=o.endLineNumber;l++){const c=t.getLineContent(l),u=l===o.startLineNumber?o.startColumn-1:0,d=l===o.endLineNumber?o.endColumn-1:c.length,g=c.substring(u,d);if(/[^ \t]/.test(g)){a=!1;break}}if(a)return!1;if(r&&o.startLineNumber===o.endLineNumber&&o.startColumn+1===o.endColumn){const l=t.getValueInRange(o);if(md(l))return!1}}return!0}}class jve{static getEdits(e,t,i,n,r,o){if(!o&&this._isTypeInterceptorElectricChar(t,i,n)){const a=this._typeInterceptorElectricChar(e,t,i,n[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,r){if(!t.electricChars.hasOwnProperty(r)||!n.isEmpty())return null;const o=n.getPosition();i.tokenization.forceTokenization(o.lineNumber);const a=i.tokenization.getLineTokens(o.lineNumber);let l;try{l=t.onElectricCharacter(r,a,o.column)}catch(c){return It(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,u=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:o.lineNumber,column:c},500);if(u){if(u.startLineNumber===o.lineNumber)return null;const d=i.getLineContent(u.startLineNumber),g=Os(d),p=t.normalizeIndentation(g),_=i.getLineContent(o.lineNumber),C=i.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,v=_.substring(C-1,o.column-1),x=p+v+r,S=new H(o.lineNumber,1,o.lineNumber,o.column),k=new wr(S,x);return new qs(y6(x,e),[k],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class $ve{static getEdits(e,t,i,n,r){const o=[];for(let l=0,c=i.length;l<c;l++){const u=e.inputMode==="overtype"&&!r?o5:wr;o[l]=new u(i[l],n)}const a=y6(n,t);return new qs(a,o,{shouldPushStackElementBefore:ID(t,a),shouldPushStackElementAfter:!1})}}class LZ{static getEdits(e,t,i,n,r){if(!r&&n===`
`){const o=[];for(let a=0,l=i.length;a<l;a++)o[a]=this._enter(e,t,!1,i[a]);return new qs(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return lf(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(n.startLineNumber),c=Os(l).substring(0,n.startColumn-1);return lf(n,`
`+e.normalizeIndentation(c),i)}const r=w6(e.autoIndent,t,n,e.languageConfigurationService);if(r){if(r.indentAction===Hs.None)return lf(n,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===Hs.Indent)return lf(n,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===Hs.IndentOutdent){const l=e.normalizeIndentation(r.indentation),c=e.normalizeIndentation(r.indentation+r.appendText),u=`
`+c+`
`+l;return i?new jx(n,u,!0):new Lk(n,u,-1,c.length-l.length,!0)}else if(r.indentAction===Hs.Outdent){const l=Dk(e,r.indentation);return lf(n,`
`+e.normalizeIndentation(l+r.appendText),i)}}const o=t.getLineContent(n.startLineNumber),a=Os(o).substring(0,n.startColumn-1);if(e.autoIndent>=4){const l=Fve(e.autoIndent,t,n,{unshiftIndent:c=>Dk(e,c),shiftIndent:c=>S6(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,n.getEndPosition());const u=n.endColumn,d=t.getLineContent(n.endLineNumber),g=Lr(d);if(g>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,g+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new jx(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let p=0;return u<=g+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),p=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Lk(n,`
`+e.normalizeIndentation(l.afterEnter),0,p,!0)}}}return lf(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++){let a=i[r].positionLineNumber;if(a===1)n[r]=new jx(new H(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);n[r]=this._enter(e,t,!1,new H(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].positionLineNumber,l=t.getLineMaxColumn(a);n[r]=this._enter(e,t,!1,new H(a,l,a,l))}return n}static lineBreakInsert(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=this._enter(e,t,!0,i[r]);return n}}class qve{static getEdits(e,t,i,n,r,o){const a=this._distributePasteToCursors(e,i,n,r,o);return a?(i=i.sort(H.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,r)}static _distributePasteToCursors(e,t,i,n,r){if(n||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));const o=F1(i);if(o.length===t.length)return o}return null}static _distributedPaste(e,t,i,n){const r=[];for(let o=0,a=i.length;o<a;o++){const c=e.overtypeOnPaste&&e.inputMode==="overtype"?o5:wr;r[o]=new c(i[o],n[o])}return new qs(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,r){const o=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],u=c.getPosition();if(r&&!c.isEmpty()&&(r=!1),r&&n.indexOf(`
`)!==n.length-1&&(r=!1),r){const d=new H(u.lineNumber,1,u.lineNumber,1);o[a]=new Nve(d,n,c,!0)}else{const g=e.overtypeOnPaste&&e.inputMode==="overtype"?o5:wr;o[a]=new g(c,n)}}return new qs(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Gve{static getEdits(e,t,i,n,r,o,a,l){const c=n.map(u=>this._compositionType(i,u,r,o,a,l));return new qs(4,c,{shouldPushStackElementBefore:ID(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,r,o){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-n),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),u=new H(a.lineNumber,l,a.lineNumber,c);return new Lk(u,i,0,o)}}class Kve{static getEdits(e,t,i){const n=[];for(let o=0,a=t.length;o<a;o++)n[o]=new wr(t[o],i);const r=y6(i,e);return new qs(r,n,{shouldPushStackElementBefore:ID(e,r),shouldPushStackElementAfter:!1})}}class Yve{static getCommands(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const u=e.normalizeIndentation(c);if(!l.startsWith(u)){n[r]=new wr(new H(a.startLineNumber,1,a.startLineNumber,l.length+1),u,!0);continue}}n[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[r]=new qg(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,r="";const o=Ek(e.autoIndent,t,i,!1,e.languageConfigurationService);if(o)n=o.action,r=o.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const u=t.getLineContent(a);if(rm(u)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=w6(e.autoIndent,t,new H(a,l,a,l),e.languageConfigurationService);c&&(r=c.indentation+c.appendText)}return n&&(n===Hs.Indent&&(r=S6(e,r)),n===Hs.Outdent&&(r=Dk(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,i,n){let r="";const o=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,o),l=e.indentSize,c=l-a%l;for(let u=0;u<c;u++)r+=" "}else r="	";return new wr(i,r,n)}}class v6 extends Lk{constructor(e,t,i,n,r,o){super(e,t,i,n),this._openCharacter=r,this._closeCharacter=o,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new H(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new H(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}}class Qve extends v6{constructor(e,t,i,n){const r=(i?t:"")+n,o=0,a=-n.length;super(e,r,o,a,t,n)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}}class Xve extends v6{constructor(e,t,i,n){const r=i+n,o=0,a=i.length;super(t,r,o,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");const n=i[0].range,r=i[1].range,o=n.plusRange(r);return this._computeCursorStateWithRange(e,o,t)}}function y6(s,e){return s===" "?e===5||e===6?6:5:4}function ID(s,e){return EU(s)&&!EU(e)?!0:s===5?!1:kU(s)!==kU(e)}function kU(s){return s===6||s===5?"space":s}function EU(s){return s===4||s===5||s===6}function kZ(s,e,t,i,n){if(s.autoClosingOvertype==="never"||!s.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(!a.isEmpty())return!1;const l=a.getPosition(),c=e.getLineContent(l.lineNumber);if(c.charAt(l.column-1)!==n)return!1;const d=md(n);if((l.column>2?c.charCodeAt(l.column-2):0)===92&&d)return!1;if(s.autoClosingOvertype==="auto"){let p=!1;for(let _=0,C=i.length;_<C;_++){const v=i[_];if(l.lineNumber===v.startLineNumber&&l.column===v.startColumn){p=!0;break}}if(!p)return!1}}return!0}function lf(s,e,t){return t?new jx(s,e,!0):new wr(s,e,!0)}function S6(s,e,t){return t=t||1,qg.shiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function Dk(s,e,t){return t=t||1,qg.unshiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function EZ(s,e){return md(e)?s.autoSurround==="quotes"||s.autoSurround==="languageDefined":s.autoSurround==="brackets"||s.autoSurround==="languageDefined"}class Sf{static indent(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=new qg(i[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=new qg(i[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static paste(e,t,i,n,r,o){return qve.getEdits(e,t,i,n,r,o)}static tab(e,t,i){return Yve.getCommands(e,t,i)}static compositionType(e,t,i,n,r,o,a,l){return Gve.getEdits(e,t,i,n,r,o,a,l)}static compositionEndWithInterceptors(e,t,i,n,r,o){if(!n)return null;let a=null;for(const g of n)if(a===null)a=g.insertedText;else if(a!==g.insertedText)return null;if(!a||a.length!==1)return LU.getEdits(t,n);const l=a;let c=!1;for(const g of n)if(g.deletedText.length!==0){c=!0;break}if(c){if(!EZ(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const g=md(l);for(const C of n)if(C.deletedSelectionStart!==0||C.deletedSelectionEnd!==C.deletedText.length||/^[ \t]+$/.test(C.deletedText)||g&&md(C.deletedText))return null;const p=[];for(const C of r){if(!C.isEmpty())return null;p.push(C.getPosition())}if(p.length!==n.length)return null;const _=[];for(let C=0,v=p.length;C<v;C++)_.push(new Ove(p[C],n[C].deletedText,t.surroundingPairs[l]));return new qs(4,_,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const u=zve.getEdits(t,i,r,o,l);if(u!==void 0)return u;const d=a5.getEdits(t,i,r,l,!0,!1);return d!==void 0?d:LU.getEdits(t,n)}static typeWithInterceptors(e,t,i,n,r,o,a){const l=LZ.getEdits(i,n,r,a,e);if(l!==void 0)return l;const c=Wve.getEdits(i,n,r,a,e);if(c!==void 0)return c;const u=Hve.getEdits(t,i,n,r,o,a);if(u!==void 0)return u;const d=a5.getEdits(i,n,r,a,!1,e);if(d!==void 0)return d;const g=Uve.getEdits(i,n,r,a,e);if(g!==void 0)return g;const p=jve.getEdits(t,i,n,r,a,e);return p!==void 0?p:$ve.getEdits(i,t,r,a,e)}static typeWithoutInterceptors(e,t,i,n,r){return Kve.getEdits(e,n,r)}}class Zve{constructor(e,t,i,n,r,o,a){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=n,this.insertedSelectionStart=r,this.insertedSelectionEnd=o,this.insertedTextRange=a}}var ke;(function(s){s.editorSimpleInput=new Ne("editorSimpleInput",!1,!0),s.editorTextFocus=new Ne("editorTextFocus",!1,w(681,"Whether the editor text has focus (cursor is blinking)")),s.focus=new Ne("editorFocus",!1,w(682,"Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),s.textInputFocus=new Ne("textInputFocus",!1,w(683,"Whether an editor or a rich text input has focus (cursor is blinking)")),s.readOnly=new Ne("editorReadonly",!1,w(684,"Whether the editor is read-only")),s.inDiffEditor=new Ne("inDiffEditor",!1,w(685,"Whether the context is a diff editor")),s.isEmbeddedDiffEditor=new Ne("isEmbeddedDiffEditor",!1,w(686,"Whether the context is an embedded diff editor")),s.inMultiDiffEditor=new Ne("inMultiDiffEditor",!1,w(687,"Whether the context is a multi diff editor")),s.multiDiffEditorAllCollapsed=new Ne("multiDiffEditorAllCollapsed",void 0,w(688,"Whether all files in multi diff editor are collapsed")),s.hasChanges=new Ne("diffEditorHasChanges",!1,w(689,"Whether the diff editor has changes")),s.comparingMovedCode=new Ne("comparingMovedCode",!1,w(690,"Whether a moved code block is selected for comparison")),s.accessibleDiffViewerVisible=new Ne("accessibleDiffViewerVisible",!1,w(691,"Whether the accessible diff viewer is visible")),s.diffEditorRenderSideBySideInlineBreakpointReached=new Ne("diffEditorRenderSideBySideInlineBreakpointReached",!1,w(692,"Whether the diff editor render side by side inline breakpoint is reached")),s.diffEditorInlineMode=new Ne("diffEditorInlineMode",!1,w(693,"Whether inline mode is active")),s.diffEditorOriginalWritable=new Ne("diffEditorOriginalWritable",!1,w(694,"Whether modified is writable in the diff editor")),s.diffEditorModifiedWritable=new Ne("diffEditorModifiedWritable",!1,w(695,"Whether modified is writable in the diff editor")),s.diffEditorOriginalUri=new Ne("diffEditorOriginalUri","",w(696,"The uri of the original document")),s.diffEditorModifiedUri=new Ne("diffEditorModifiedUri","",w(697,"The uri of the modified document")),s.columnSelection=new Ne("editorColumnSelection",!1,w(698,"Whether `editor.columnSelection` is enabled")),s.writable=s.readOnly.toNegated(),s.hasNonEmptySelection=new Ne("editorHasSelection",!1,w(699,"Whether the editor has text selected")),s.hasOnlyEmptySelection=s.hasNonEmptySelection.toNegated(),s.hasMultipleSelections=new Ne("editorHasMultipleSelections",!1,w(700,"Whether the editor has multiple selections")),s.hasSingleSelection=s.hasMultipleSelections.toNegated(),s.tabMovesFocus=new Ne("editorTabMovesFocus",!1,w(701,"Whether `Tab` will move focus out of the editor")),s.tabDoesNotMoveFocus=s.tabMovesFocus.toNegated(),s.isInEmbeddedEditor=new Ne("isInEmbeddedEditor",!1,!0),s.canUndo=new Ne("canUndo",!1,!0),s.canRedo=new Ne("canRedo",!1,!0),s.hoverVisible=new Ne("editorHoverVisible",!1,w(702,"Whether the editor hover is visible")),s.hoverFocused=new Ne("editorHoverFocused",!1,w(703,"Whether the editor hover is focused")),s.stickyScrollFocused=new Ne("stickyScrollFocused",!1,w(704,"Whether the sticky scroll is focused")),s.stickyScrollVisible=new Ne("stickyScrollVisible",!1,w(705,"Whether the sticky scroll is visible")),s.standaloneColorPickerVisible=new Ne("standaloneColorPickerVisible",!1,w(706,"Whether the standalone color picker is visible")),s.standaloneColorPickerFocused=new Ne("standaloneColorPickerFocused",!1,w(707,"Whether the standalone color picker is focused")),s.inCompositeEditor=new Ne("inCompositeEditor",void 0,w(708,"Whether the editor is part of a larger editor (e.g. notebooks)")),s.notInCompositeEditor=s.inCompositeEditor.toNegated(),s.languageId=new Ne("editorLangId","",w(709,"The language identifier of the editor")),s.hasCompletionItemProvider=new Ne("editorHasCompletionItemProvider",!1,w(710,"Whether the editor has a completion item provider")),s.hasCodeActionsProvider=new Ne("editorHasCodeActionsProvider",!1,w(711,"Whether the editor has a code actions provider")),s.hasCodeLensProvider=new Ne("editorHasCodeLensProvider",!1,w(712,"Whether the editor has a code lens provider")),s.hasDefinitionProvider=new Ne("editorHasDefinitionProvider",!1,w(713,"Whether the editor has a definition provider")),s.hasDeclarationProvider=new Ne("editorHasDeclarationProvider",!1,w(714,"Whether the editor has a declaration provider")),s.hasImplementationProvider=new Ne("editorHasImplementationProvider",!1,w(715,"Whether the editor has an implementation provider")),s.hasTypeDefinitionProvider=new Ne("editorHasTypeDefinitionProvider",!1,w(716,"Whether the editor has a type definition provider")),s.hasHoverProvider=new Ne("editorHasHoverProvider",!1,w(717,"Whether the editor has a hover provider")),s.hasDocumentHighlightProvider=new Ne("editorHasDocumentHighlightProvider",!1,w(718,"Whether the editor has a document highlight provider")),s.hasDocumentSymbolProvider=new Ne("editorHasDocumentSymbolProvider",!1,w(719,"Whether the editor has a document symbol provider")),s.hasReferenceProvider=new Ne("editorHasReferenceProvider",!1,w(720,"Whether the editor has a reference provider")),s.hasRenameProvider=new Ne("editorHasRenameProvider",!1,w(721,"Whether the editor has a rename provider")),s.hasSignatureHelpProvider=new Ne("editorHasSignatureHelpProvider",!1,w(722,"Whether the editor has a signature help provider")),s.hasInlayHintsProvider=new Ne("editorHasInlayHintsProvider",!1,w(723,"Whether the editor has an inline hints provider")),s.hasDocumentFormattingProvider=new Ne("editorHasDocumentFormattingProvider",!1,w(724,"Whether the editor has a document formatting provider")),s.hasDocumentSelectionFormattingProvider=new Ne("editorHasDocumentSelectionFormattingProvider",!1,w(725,"Whether the editor has a document selection formatting provider")),s.hasMultipleDocumentFormattingProvider=new Ne("editorHasMultipleDocumentFormattingProvider",!1,w(726,"Whether the editor has multiple document formatting providers")),s.hasMultipleDocumentSelectionFormattingProvider=new Ne("editorHasMultipleDocumentSelectionFormattingProvider",!1,w(727,"Whether the editor has multiple document selection formatting providers"))})(ke||(ke={}));const mt=0;class wi extends zg{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var jn;(function(s){const e=function(i){if(!Vs(i))return!1;const n=i;return!(!Pn(n.to)||!to(n.by)&&!Pn(n.by)||!to(n.value)&&!nm(n.value)||!to(n.revealCursor)&&!GA(n.revealCursor))};s.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},s.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let n;switch(i.to){case s.RawDirection.Up:n=1;break;case s.RawDirection.Right:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.Left:n=4;break;default:return null}let r;switch(i.by){case s.RawUnit.Line:r=1;break;case s.RawUnit.WrappedLine:r=2;break;case s.RawUnit.Page:r=3;break;case s.RawUnit.HalfPage:r=4;break;case s.RawUnit.Editor:r=5;break;case s.RawUnit.Column:r=6;break;default:r=2}const o=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:n,unit:r,value:o,revealCursor:a,select:!!i.select}}s.parse=t})(jn||(jn={}));var Gp;(function(s){const e=function(t){if(!Vs(t))return!1;const i=t;return!(!nm(i.lineNumber)&&!Pn(i.lineNumber)||!to(i.at)&&!Pn(i.at))};s.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},s.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Gp||(Gp={}));class l5{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(fn).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const n=Ln();return n&&qa(n)?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(fn).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}var Cn;(function(s){class e extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){if(!k.position)return;S.model.pushStackElement(),S.setCursorStates(k.source,3,[fs.moveTo(S,S.getPrimaryCursorState(),this._inSelectionMode,k.position,k.viewPosition)])&&k.revealType!==2&&S.revealAllCursors(k.source,!0,!0)}}s.MoveTo=Ke(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),s.MoveToSelect=Ke(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends wi{runCoreEditorCommand(S,k){S.model.pushStackElement();const E=this._getColumnSelectResult(S,S.getPrimaryCursorState(),S.getCursorColumnSelectData(),k);E!==null&&(S.setCursorStates(k.source,3,E.viewStates.map(T=>at.fromViewState(T))),S.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:E.fromLineNumber,fromViewVisualColumn:E.fromVisualColumn,toViewLineNumber:E.toLineNumber,toViewVisualColumn:E.toVisualColumn}),E.reversed?S.revealTopMostCursor(k.source):S.revealBottomMostCursor(k.source))}}s.ColumnSelect=Ke(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(x,S,k,E){if(typeof E.position>"u"||typeof E.viewPosition>"u"||typeof E.mouseColumn>"u")return null;const T=x.model.validatePosition(E.position),R=x.coordinatesConverter.validateViewPosition(new Y(E.viewPosition.lineNumber,E.viewPosition.column),T),N=E.doColumnSelect?k.fromViewLineNumber:R.lineNumber,A=E.doColumnSelect?k.fromViewVisualColumn:E.mouseColumn-1;return yf.columnSelect(x.cursorConfig,x,N,A,R.lineNumber,E.mouseColumn-1)}}),s.CursorColumnSelectLeft=Ke(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(x,S,k,E){return yf.columnSelectLeft(x.cursorConfig,x,k)}}),s.CursorColumnSelectRight=Ke(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(x,S,k,E){return yf.columnSelectRight(x.cursorConfig,x,k)}});class i extends t{constructor(S){super(S),this._isPaged=S.isPaged}_getColumnSelectResult(S,k,E,T){return yf.columnSelectUp(S.cursorConfig,S,E,this._isPaged)}}s.CursorColumnSelectUp=Ke(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3600,linux:{primary:0}}})),s.CursorColumnSelectPageUp=Ke(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends t{constructor(S){super(S),this._isPaged=S.isPaged}_getColumnSelectResult(S,k,E,T){return yf.columnSelectDown(S.cursorConfig,S,E,this._isPaged)}}s.CursorColumnSelectDown=Ke(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3602,linux:{primary:0}}})),s.CursorColumnSelectPageDown=Ke(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3596,linux:{primary:0}}}));class r extends wi{constructor(){super({id:"cursorMove",precondition:void 0,metadata:kk.metadata})}runCoreEditorCommand(S,k){const E=kk.parse(k);E&&this._runCursorMove(S,k.source,E)}_runCursorMove(S,k,E){const T=E.noHistory?"api":k;S.model.pushStackElement(),S.setCursorStates(T,3,r._move(S,S.getCursorStates(),E)),S.revealAllCursors(T,!0)}static _move(S,k,E){const T=E.select,R=E.value;switch(E.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return fs.simpleMove(S,k,E.direction,T,R,E.unit);case 11:case 13:case 12:case 14:return fs.viewportMove(S,k,E.direction,T,R);default:return null}}}s.CursorMoveImpl=r,s.CursorMove=Ke(new r);class o extends wi{constructor(S){super(S),this._staticArgs=S.args}runCoreEditorCommand(S,k){let E=this._staticArgs;this._staticArgs.value===-1&&(E={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:k.pageSize||S.cursorConfig.pageSize}),S.model.pushStackElement(),S.setCursorStates(k.source,3,fs.simpleMove(S,S.getCursorStates(),E.direction,E.select,E.value,E.unit)),S.revealAllCursors(k.source,!0)}}s.CursorLeft=Ke(new o({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),s.CursorLeftSelect=Ke(new o({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1039}})),s.CursorRight=Ke(new o({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),s.CursorRightSelect=Ke(new o({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1041}})),s.CursorUp=Ke(new o({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),s.CursorUpSelect=Ke(new o({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),s.CursorPageUp=Ke(new o({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:11}})),s.CursorPageUpSelect=Ke(new o({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1035}})),s.CursorDown=Ke(new o({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),s.CursorDownSelect=Ke(new o({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),s.CursorPageDown=Ke(new o({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:12}})),s.CursorPageDownSelect=Ke(new o({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1036}})),s.CreateCursor=Ke(new class extends wi{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(x,S){if(!S.position)return;let k;S.wholeLine?k=fs.line(x,x.getPrimaryCursorState(),!1,S.position,S.viewPosition):k=fs.moveTo(x,x.getPrimaryCursorState(),!1,S.position,S.viewPosition);const E=x.getCursorStates();if(E.length>1){const T=k.modelState?k.modelState.position:null,R=k.viewState?k.viewState.position:null;for(let N=0,A=E.length;N<A;N++){const O=E[N];if(!(T&&!O.modelState.selection.containsPosition(T))&&!(R&&!O.viewState.selection.containsPosition(R))){E.splice(N,1),x.model.pushStackElement(),x.setCursorStates(S.source,3,E);return}}}E.push(k),x.model.pushStackElement(),x.setCursorStates(S.source,3,E)}}),s.LastCursorMoveToSelect=Ke(new class extends wi{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(x,S){if(!S.position)return;const k=x.getLastAddedCursorIndex(),E=x.getCursorStates(),T=E.slice(0);T[k]=fs.moveTo(x,E[k],!0,S.position,S.viewPosition),x.model.pushStackElement(),x.setCursorStates(S.source,3,T)}});class a extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){S.model.pushStackElement(),S.setCursorStates(k.source,3,fs.moveToBeginningOfLine(S,S.getCursorStates(),this._inSelectionMode)),S.revealAllCursors(k.source,!0)}}s.CursorHome=Ke(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),s.CursorHomeSelect=Ke(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){S.model.pushStackElement(),S.setCursorStates(k.source,3,this._exec(S.getCursorStates())),S.revealAllCursors(k.source,!0)}_exec(S){const k=[];for(let E=0,T=S.length;E<T;E++){const R=S[E],N=R.modelState.position.lineNumber;k[E]=at.fromModelState(R.modelState.move(this._inSelectionMode,N,1,0))}return k}}s.CursorLineStart=Ke(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:0,mac:{primary:287}}})),s.CursorLineStartSelect=Ke(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){S.model.pushStackElement(),S.setCursorStates(k.source,3,fs.moveToEndOfLine(S,S.getCursorStates(),this._inSelectionMode,k.sticky||!1)),S.revealAllCursors(k.source,!0)}}s.CursorEnd=Ke(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:mt,kbExpr:ke.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:w(66,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),s.CursorEndSelect=Ke(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:mt,kbExpr:ke.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:w(67,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class u extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){S.model.pushStackElement(),S.setCursorStates(k.source,3,this._exec(S,S.getCursorStates())),S.revealAllCursors(k.source,!0)}_exec(S,k){const E=[];for(let T=0,R=k.length;T<R;T++){const N=k[T],A=N.modelState.position.lineNumber,O=S.model.getLineMaxColumn(A);E[T]=at.fromModelState(N.modelState.move(this._inSelectionMode,A,O,0))}return E}}s.CursorLineEnd=Ke(new u({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:0,mac:{primary:291}}})),s.CursorLineEndSelect=Ke(new u({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:0,mac:{primary:1315}}}));class d extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){S.model.pushStackElement(),S.setCursorStates(k.source,3,fs.moveToBeginningOfBuffer(S,S.getCursorStates(),this._inSelectionMode)),S.revealAllCursors(k.source,!0)}}s.CursorTop=Ke(new d({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:2062,mac:{primary:2064}}})),s.CursorTopSelect=Ke(new d({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3086,mac:{primary:3088}}}));class g extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){S.model.pushStackElement(),S.setCursorStates(k.source,3,fs.moveToEndOfBuffer(S,S.getCursorStates(),this._inSelectionMode)),S.revealAllCursors(k.source,!0)}}s.CursorBottom=Ke(new g({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:2061,mac:{primary:2066}}})),s.CursorBottomSelect=Ke(new g({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:3085,mac:{primary:3090}}}));class p extends wi{constructor(){super({id:"editorScroll",precondition:void 0,metadata:jn.metadata})}determineScrollMethod(S){const k=[6],E=[1,2,3,4,5,6],T=[4,2],R=[1,3];return k.includes(S.unit)&&T.includes(S.direction)?this._runHorizontalEditorScroll.bind(this):E.includes(S.unit)&&R.includes(S.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(S,k){const E=jn.parse(k);if(!E)return;const T=this.determineScrollMethod(E);T&&T(S,k.source,E)}_runVerticalEditorScroll(S,k,E){const T=this._computeDesiredScrollTop(S,E);if(E.revealCursor){const R=S.getCompletelyVisibleViewRangeAtScrollTop(T);S.setCursorStates(k,3,[fs.findPositionInViewportIfOutside(S,S.getPrimaryCursorState(),R,E.select)])}S.viewLayout.setScrollPosition({scrollTop:T},0)}_computeDesiredScrollTop(S,k){if(k.unit===1){const R=S.viewLayout.getFutureViewport(),N=S.getCompletelyVisibleViewRangeAtScrollTop(R.top),A=S.coordinatesConverter.convertViewRangeToModelRange(N);let O;k.direction===1?O=Math.max(1,A.startLineNumber-k.value):O=Math.min(S.model.getLineCount(),A.startLineNumber+k.value);const W=S.coordinatesConverter.convertModelPositionToViewPosition(new Y(O,1));return S.viewLayout.getVerticalOffsetForLineNumber(W.lineNumber)}if(k.unit===5){let R=0;return k.direction===3&&(R=S.model.getLineCount()-S.cursorConfig.pageSize),S.viewLayout.getVerticalOffsetForLineNumber(R)}let E;k.unit===3?E=S.cursorConfig.pageSize*k.value:k.unit===4?E=Math.round(S.cursorConfig.pageSize/2)*k.value:E=k.value;const T=(k.direction===1?-1:1)*E;return S.viewLayout.getCurrentScrollTop()+T*S.cursorConfig.lineHeight}_runHorizontalEditorScroll(S,k,E){const T=this._computeDesiredScrollLeft(S,E);S.viewLayout.setScrollPosition({scrollLeft:T},0)}_computeDesiredScrollLeft(S,k){const E=(k.direction===4?-1:1)*k.value;return S.viewLayout.getCurrentScrollLeft()+E*S.cursorConfig.typicalHalfwidthCharacterWidth}}s.EditorScrollImpl=p,s.EditorScroll=Ke(new p),s.ScrollLineUp=Ke(new class extends wi{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Up,by:jn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollPageUp=Ke(new class extends wi{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Up,by:jn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollEditorTop=Ke(new class extends wi{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Up,by:jn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollLineDown=Ke(new class extends wi{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Down,by:jn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollPageDown=Ke(new class extends wi{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Down,by:jn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollEditorBottom=Ke(new class extends wi{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Down,by:jn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollLeft=Ke(new class extends wi{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Left,by:jn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollRight=Ke(new class extends wi{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:jn.RawDirection.Right,by:jn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:S.source})}});class _ extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){k.position&&(S.model.pushStackElement(),S.setCursorStates(k.source,3,[fs.word(S,S.getPrimaryCursorState(),this._inSelectionMode,k.position)]),k.revealType!==2&&S.revealAllCursors(k.source,!0,!0))}}s.WordSelect=Ke(new _({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),s.WordSelectDrag=Ke(new _({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),s.LastCursorWordSelect=Ke(new class extends wi{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(x,S){if(!S.position)return;const k=x.getLastAddedCursorIndex(),E=x.getCursorStates(),T=E.slice(0),R=E[k];T[k]=fs.word(x,R,R.modelState.hasSelection(),S.position),x.model.pushStackElement(),x.setCursorStates(S.source,3,T)}});class C extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){k.position&&(S.model.pushStackElement(),S.setCursorStates(k.source,3,[fs.line(S,S.getPrimaryCursorState(),this._inSelectionMode,k.position,k.viewPosition)]),k.revealType!==2&&S.revealAllCursors(k.source,!1,!0))}}s.LineSelect=Ke(new C({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),s.LineSelectDrag=Ke(new C({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class v extends wi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,k){if(!k.position)return;const E=S.getLastAddedCursorIndex(),T=S.getCursorStates(),R=T.slice(0);R[E]=fs.line(S,T[E],this._inSelectionMode,k.position,k.viewPosition),S.model.pushStackElement(),S.setCursorStates(k.source,3,R)}}s.LastCursorLineSelect=Ke(new v({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),s.LastCursorLineSelectDrag=Ke(new v({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),s.CancelSelection=Ke(new class extends wi{constructor(){super({id:"cancelSelection",precondition:ke.hasNonEmptySelection,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(x,S){x.model.pushStackElement(),x.setCursorStates(S.source,3,[fs.cancelSelection(x,x.getPrimaryCursorState())]),x.revealAllCursors(S.source,!0)}}),s.RemoveSecondaryCursors=Ke(new class extends wi{constructor(){super({id:"removeSecondaryCursors",precondition:ke.hasMultipleSelections,kbOpts:{weight:mt+1,kbExpr:ke.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(x,S){x.model.pushStackElement(),x.setCursorStates(S.source,3,[x.getPrimaryCursorState()]),x.revealAllCursors(S.source,!0),mk(w(68,"Removed secondary cursors"))}}),s.RevealLine=Ke(new class extends wi{constructor(){super({id:"revealLine",precondition:void 0,metadata:Gp.metadata})}runCoreEditorCommand(x,S){const k=S,E=k.lineNumber||0;let T=typeof E=="number"?E+1:parseInt(E)+1;T<1&&(T=1);const R=x.model.getLineCount();T>R&&(T=R);const N=new H(T,1,T,x.model.getLineMaxColumn(T));let A=0;if(k.at)switch(k.at){case Gp.RawAtArgument.Top:A=3;break;case Gp.RawAtArgument.Center:A=1;break;case Gp.RawAtArgument.Bottom:A=4;break}const O=x.coordinatesConverter.convertModelRangeToViewRange(N);x.revealRange(S.source,!1,O,A,0)}}),s.SelectAll=new class extends l5{constructor(){super(t1e)}runDOMCommand(x){Er&&(x.focus(),x.select()),x.ownerDocument.execCommand("selectAll")}runEditorCommand(x,S,k){const E=S._getViewModel();E&&this.runCoreEditorCommand(E,k)}runCoreEditorCommand(x,S){x.model.pushStackElement(),x.setCursorStates("keyboard",3,[fs.selectAll(x,x.getPrimaryCursorState())])}},s.SetSelection=Ke(new class extends wi{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(x,S){S.selection&&(x.model.pushStackElement(),x.setCursorStates(S.source,3,[at.fromModelSelection(S.selection)]))}})})(Cn||(Cn={}));const Jve=ft.and(ke.textInputFocus,ke.columnSelection);function j1(s,e){vd.registerKeybindingRule({id:s,primary:e,when:Jve,weight:mt+1})}j1(Cn.CursorColumnSelectLeft.id,1039);j1(Cn.CursorColumnSelectRight.id,1041);j1(Cn.CursorColumnSelectUp.id,1040);j1(Cn.CursorColumnSelectPageUp.id,1035);j1(Cn.CursorColumnSelectDown.id,1042);j1(Cn.CursorColumnSelectPageDown.id,1036);function DU(s){return s.register(),s}var TU;(function(s){class e extends zg{runEditorCommand(i,n,r){const o=n._getViewModel();o&&this.runCoreEditingCommand(n,o,r||{})}}s.CoreEditingCommand=e,s.LineBreakInsert=Ke(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:ke.writable,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,LZ.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection)))}}),s.Outdent=Ke(new class extends e{constructor(){super({id:"outdent",precondition:ke.writable,kbOpts:{weight:mt,kbExpr:ft.and(ke.editorTextFocus,ke.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Sf.outdent(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),s.Tab=Ke(new class extends e{constructor(){super({id:"tab",precondition:ke.writable,kbOpts:{weight:mt,kbExpr:ft.and(ke.editorTextFocus,ke.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Sf.tab(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),s.DeleteLeft=Ke(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,n){const[r,o]=$g.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(2)}}),s.DeleteRight=Ke(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:ke.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,n){const[r,o]=$g.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(3)}}),s.Undo=new class extends l5{constructor(){super(dX)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(104)===!0))return i.getModel().undo()}},s.Redo=new class extends l5{constructor(){super(fX)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(104)===!0))return i.getModel().redo()}}})(TU||(TU={}));class NU extends _D{constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){const i=e.get(fn).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function mm(s,e){DU(new NU("default:"+s,s)),DU(new NU(s,s,e))}mm("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});mm("replacePreviousChar");mm("compositionType");mm("compositionStart");mm("compositionEnd");mm("paste");mm("cut");class eye{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Cn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new Y(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(86)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(86)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=kr&&t.get(121),n=t.get(28),r=t.get(171);e.middleButton&&!i?r||this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Cn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Cn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Cn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Cn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Cn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Cn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Cn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Cn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Cn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Cn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Cn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Cn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Cn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class DZ{constructor(e){this._lineFactory=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Pe("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let r=0,o=0;for(let l=i;l<=n;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(o===0?(r=c,o=1):o++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(r,o)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const n=this.getStartLineNumber(),r=this.getEndLineNumber();let o=!1;for(let a=e;a<=i;a++)a>=n&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),o=!0);return o}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,n=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>r)return null;if(i+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);const o=[];for(let d=0;d<i;d++)o[d]=this._lineFactory.createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),u=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(o).concat(c),u}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let r=0,o=e.length;r<o;r++){const a=e[r];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let u=l;u<=c;u++){const d=u-this._rendLineNumberStart;this._lines[d].onTokensChanged(),n=!0}}return n}}class TZ{constructor(e,t){this._viewContext=e,this._lineFactory=t,this.domNode=this._createDomNode(),this._linesCollection=new DZ(this._lineFactory)}_createDomNode(){const e=bt(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(165)}onFlushed(e,t){var i;if(t){const n=this._linesCollection.getStartLineNumber(),r=this._linesCollection.getEndLineNumber();for(let o=n;o<=r;o++)(i=this._linesCollection.getLine(o).getDomNode())==null||i.remove()}return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const r=t[i].getDomNode();r==null||r.remove()}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const r=t[i].getDomNode();r==null||r.remove()}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new c5(this.domNode.domNode,this._lineFactory,e,this._viewContext),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}}const Zc=class Zc{constructor(e,t,i,n){this._domNode=e,this._lineFactory=t,this._viewportData=i,this._viewContext=n}render(e,t,i,n){const r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||i<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=i-t+1,r.lines=[];for(let o=t;o<=i;o++)r.lines[o-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,n),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(i-r.rendLineNumberStart,r.linesLength-1),n,t),r.rendLineNumberStart>t){const o=t,a=Math.min(i,r.rendLineNumberStart-1);o<=a&&(this._insertLinesBefore(r,o,a,n,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart<t){const o=Math.min(r.linesLength,t-r.rendLineNumberStart);o>0&&(this._removeLinesBefore(r,o),r.linesLength-=o)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<i){const o=r.rendLineNumberStart+r.linesLength,a=i;o<=a&&(this._insertLinesAfter(r,o,a,n,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart+r.linesLength-1>i){const o=Math.max(0,i-r.rendLineNumberStart+1),l=r.linesLength-1-o+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,n),r}_renderUntouchedLines(e,t,i,n,r){const o=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=o+l;a[l].layoutLine(c,n[c-r],this._lineHeightForLineNumber(c))}}_insertLinesBefore(e,t,i,n,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this._lineFactory.createLine();e.lines=o.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const n=e.lines[i].getDomNode();n==null||n.remove()}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(o)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++){const r=e.lines[i+n].getDomNode();r==null||r.remove()}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){Zc._ttPolicy&&(i=Zc._ttPolicy.createHTML(i));const r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=i:r.insertAdjacentHTML("afterend",i);let o=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];n[a]&&(l.setDomNode(o),o=o.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");Zc._ttPolicy&&(t=Zc._ttPolicy.createHTML(t)),n.innerHTML=t;for(let r=0;r<e.linesLength;r++){const o=e.lines[r];if(i[r]){const a=n.firstChild;o.getDomNode().replaceWith(a),o.setDomNode(a)}}}_finishRendering(e,t,i){const n=Zc._sb,r=e.linesLength,o=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let c=!1;for(let u=0;u<r;u++){const d=o[u];if(l[u]=!1,d.getDomNode())continue;const p=u+a;d.renderLine(p,i[u],this._lineHeightForLineNumber(p),this._viewportData,n)&&(l[u]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let c=!1;const u=[];for(let d=0;d<r;d++){const g=o[d];if(u[d]=!1,l[d])continue;const p=d+a;g.renderLine(p,i[d],this._lineHeightForLineNumber(p),this._viewportData,n)&&(u[d]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,n.build(),u)}}_lineHeightForLineNumber(e){return this._viewContext.viewLayout.getLineHeightForLineNumber(e)}};Zc._ttPolicy=yd("editorViewLayer",{createHTML:e=>e}),Zc._sb=new z1(1e5);let c5=Zc;class NZ extends Qs{constructor(e){super(e),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new TZ(this._context,{createLine:()=>new tye(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(59);Jn(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._context.configuration.options.get(59);return Jn(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){const r=t[i];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class tye{constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=bt(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,r){let o="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){const c=this._dynamicOverlays[a];o+=c.render(n.startLineNumber,e)}return this._renderedContent===o?!1:(this._renderedContent=o,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(i)),r.appendString("px;line-height:"),r.appendString(String(i)),r.appendString('px;">'),r.appendString(o),r.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i),this._domNode.setLineHeight(i))}}class iye extends NZ{constructor(e){super(e);const i=this._context.configuration.options.get(165);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class nye extends NZ{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Jn(this.domNode,t.get(59))}onConfigurationChanged(e){const t=this._context.configuration.options;Jn(this.domNode,t.get(59));const i=t.get(165);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class RD{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;(t=this.onKeyDown)==null||t.call(this,e)}emitKeyUp(e){var t;(t=this.onKeyUp)==null||t.call(this,e)}emitContextMenu(e){var t;(t=this.onContextMenu)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;(t=this.onMouseMove)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;(t=this.onMouseLeave)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;(t=this.onMouseDown)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;(t=this.onMouseUp)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;(t=this.onMouseDrag)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;(t=this.onMouseDrop)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;(e=this.onMouseDropCanceled)==null||e.call(this)}emitMouseWheel(e){var t;(t=this.onMouseWheel)==null||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return RD.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new Y(e.afterLineNumber,1)).lineNumber}}}class sye extends Qs{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(165),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);const r=i.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0;const i=e.getDecorationsInViewport();for(const n of i){if(!n.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=bt(document.createElement("div")),this.domNode.appendChild(r));let o,a;n.options.blockIsAfterEnd?(o=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(o=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[l,c,u,d]=n.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+n.options.blockClassName),r.setLeft(this.contentLeft-d),r.setWidth(this.contentWidth+d+c),r.setTop(o-e.scrollTop-l),r.setHeight(a-o+l+u),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}}class rye extends Qs{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=bt(document.createElement("div")),Xa.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=bt(document.createElement("div")),Xa.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new oye(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,r){this._widgets[e.getId()].setPosition(t,i,n,r),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class oye{constructor(e,t,i){this._primaryAnchor=new e0(null,null),this._secondaryAnchor=new e0(null,null),this._context=e,this._viewDomNode=t,this._actual=i;const n=this._context.configuration.options,r=n.get(165),o=n.get(4);this.domNode=bt(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=(this._actual.allowEditorOverflow||!1)&&o,this.suppressMouseDown=this._actual.suppressMouseDown||!1,this._fixedOverflowWidgets=n.get(51),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(e.hasChanged(165)){const i=t.get(165);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(r,o,a){if(!r)return new e0(null,null);const l=o.model.validatePosition(r);if(o.coordinatesConverter.modelPositionIsVisible(l)){const c=o.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new e0(r,c)}return new e0(r,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?(t==null?void 0:t.innerWidth)||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){const r=e.top,o=r,a=e.top+e.height,l=n.viewportHeight-a,c=r-i,u=o>=i,d=a,g=l>=i;let p=e.left;return p+t>n.scrollLeft+n.viewportWidth&&(p=n.scrollLeft+n.viewportWidth-t),p<n.scrollLeft&&(p=n.scrollLeft),{fitsAbove:u,aboveTop:c,fitsBelow:g,belowTop:d,left:p}}_layoutHorizontalSegmentInPage(e,t,i,n){const a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),u=this._viewDomNode.domNode.ownerDocument.defaultView;let d=t.left+i-((u==null?void 0:u.scrollX)??0);if(d+n>l){const g=d-(l-n);d-=g,i-=g}if(d<a){const g=d-a;d-=g,i-=g}return[i,d]}_layoutBoxInPage(e,t,i,n){const r=e.top-i,o=e.top+e.height,a=Mo(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,c=l.defaultView,u=a.top+r-((c==null?void 0:c.scrollY)??0),d=a.top+o-((c==null?void 0:c.scrollY)??0),g=m4(l.body),[p,_]=this._layoutHorizontalSegmentInPage(g,a,e.left-n.scrollLeft+this._contentLeft,t),C=22,v=22,x=u>=C,S=d+i<=g.height-v;return this._fixedOverflowWidgets?{fitsAbove:x,aboveTop:Math.max(u,C),fitsBelow:S,belowTop:d,left:_}:{fitsAbove:x,aboveTop:r,fitsBelow:S,belowTop:o,left:p}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new t0(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){var o,a;const t=r(this._primaryAnchor.viewPosition,this._affinity),i=((o=this._secondaryAnchor.viewPosition)==null?void 0:o.lineNumber)===((a=this._primaryAnchor.viewPosition)==null?void 0:a.lineNumber)?this._secondaryAnchor.viewPosition:null,n=r(i,this._affinity);return{primary:t,secondary:n};function r(l,c){if(!l)return null;const u=e.visibleRangeForPosition(l);if(!u)return null;const d=l.column===1&&c===3?0:u.left,g=e.getVerticalOffsetForLineNumber(l.lineNumber)-e.scrollTop,p=e.getLineHeightForLineNumber(l.lineNumber);return new IU(g,d,p)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const n=this._context.configuration.options.get(59);let r=t.left;return r<e.left?r=Math.max(r,e.left-i+n.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+i-n.typicalFullwidthCharacterWidth),new IU(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let o=null;if(typeof this._actual.beforeRender=="function"&&(o=gR(this._actual.beforeRender,this._actual)),o)this._cachedDomNodeOffsetWidth=o.width,this._cachedDomNodeOffsetHeight=o.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let r;this.allowEditorOverflow?r=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let o=1;o<=2;o++)for(const a of this._preference)if(a===1){if(!r)return null;if(o===2||r.fitsAbove)return{kind:"inViewport",coordinate:new t0(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(o===2||r.fitsBelow)return{kind:"inViewport",coordinate:new t0(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new t0(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new t0(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){var t;if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,((t=this._renderData)==null?void 0:t.kind)==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&gR(this._actual.afterRender,this._actual,null,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&gR(this._actual.afterRender,this._actual,this._renderData.position,this._renderData.coordinate)}}class e0{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class t0{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class IU{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function gR(s,e,...t){try{return s.call(e,...t)}catch{return null}}class Sd extends fm{}const Ir=tt("themeService");function wp(s){return{id:s}}function h5(s){switch(s){case Po.DARK:return qp.VS_DARK;case Po.HIGH_CONTRAST_DARK:return qp.HC_BLACK;case Po.HIGH_CONTRAST_LIGHT:return qp.HC_LIGHT;default:return qp.VS}}const IZ={ThemingContribution:"base.contributions.theming"};class aye extends ne{constructor(){super(),this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=this._register(new $)}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Fe(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const RZ=new aye;Fn.add(IZ.ThemingContribution,RZ);function Vh(s){return RZ.onColorThemeChange(s)}class lye extends ne{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}const AZ=B("editor.lineHighlightBackground",null,w(610,"Background color for the highlight of line at the cursor position.")),RU=B("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Ct},w(611,"Background color for the border around the line at the cursor position."));B("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},w(612,"Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);B("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Hi,hcLight:Hi},w(613,"Background color of the border around highlighted ranges."));B("editor.symbolHighlightBackground",{dark:Fu,light:Fu,hcDark:null,hcLight:null},w(614,"Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);B("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Hi,hcLight:Hi},w(615,"Background color of the border around highlighted symbols."));const AD=B("editorCursor.foreground",{dark:"#AEAFAD",light:ae.black,hcDark:ae.white,hcLight:"#0F4A85"},w(616,"Color of the editor cursor.")),x6=B("editorCursor.background",null,w(617,"The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),MZ=B("editorMultiCursor.primary.foreground",AD,w(618,"Color of the primary editor cursor when multiple cursors are present.")),cye=B("editorMultiCursor.primary.background",x6,w(619,"The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),OZ=B("editorMultiCursor.secondary.foreground",AD,w(620,"Color of secondary editor cursors when multiple cursors are present.")),hye=B("editorMultiCursor.secondary.background",x6,w(621,"The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),L6=B("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},w(622,"Color of whitespace characters in the editor.")),uye=B("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:ae.white,hcLight:"#292929"},w(623,"Color of editor line numbers.")),dye=B("editorIndentGuide.background",L6,w(624,"Color of the editor indentation guides."),!1,w(625,"'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),fye=B("editorIndentGuide.activeBackground",L6,w(626,"Color of the active editor indentation guides."),!1,w(627,"'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),jv=B("editorIndentGuide.background1",dye,w(628,"Color of the editor indentation guides (1).")),gye=B("editorIndentGuide.background2","#00000000",w(629,"Color of the editor indentation guides (2).")),mye=B("editorIndentGuide.background3","#00000000",w(630,"Color of the editor indentation guides (3).")),pye=B("editorIndentGuide.background4","#00000000",w(631,"Color of the editor indentation guides (4).")),_ye=B("editorIndentGuide.background5","#00000000",w(632,"Color of the editor indentation guides (5).")),bye=B("editorIndentGuide.background6","#00000000",w(633,"Color of the editor indentation guides (6).")),$v=B("editorIndentGuide.activeBackground1",fye,w(634,"Color of the active editor indentation guides (1).")),Cye=B("editorIndentGuide.activeBackground2","#00000000",w(635,"Color of the active editor indentation guides (2).")),wye=B("editorIndentGuide.activeBackground3","#00000000",w(636,"Color of the active editor indentation guides (3).")),vye=B("editorIndentGuide.activeBackground4","#00000000",w(637,"Color of the active editor indentation guides (4).")),yye=B("editorIndentGuide.activeBackground5","#00000000",w(638,"Color of the active editor indentation guides (5).")),Sye=B("editorIndentGuide.activeBackground6","#00000000",w(639,"Color of the active editor indentation guides (6).")),xye=B("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Hi,hcLight:Hi},w(640,"Color of editor active line number"),!1,w(641,"Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));B("editorLineNumber.activeForeground",xye,w(642,"Color of editor active line number"));const Lye=B("editorLineNumber.dimmedForeground",null,w(643,"Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),kye=B("editorRuler.foreground",{dark:"#5A5A5A",light:ae.lightgrey,hcDark:ae.white,hcLight:"#292929"},w(644,"Color of the editor rulers."));B("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},w(645,"Foreground color of editor CodeLens"));B("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},w(646,"Background color behind matching brackets"));B("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Ct,hcLight:Ct},w(647,"Color for matching brackets boxes"));const Eye=B("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},w(648,"Color of the overview ruler border.")),Dye=B("editorOverviewRuler.background",null,w(649,"Background color of the editor overview ruler."));B("editorGutter.background",ga,w(650,"Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));B("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:ae.fromHex("#fff").transparent(.8),hcLight:Ct},w(651,"Border color of unnecessary (unused) source code in the editor."));const Tye=B("editorUnnecessaryCode.opacity",{dark:ae.fromHex("#000a"),light:ae.fromHex("#0007"),hcDark:null,hcLight:null},w(652,`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));B("editorGhostText.border",{dark:null,light:null,hcDark:ae.fromHex("#fff").transparent(.8),hcLight:ae.fromHex("#292929").transparent(.8)},w(653,"Border color of ghost text in the editor."));B("editorGhostText.foreground",{dark:ae.fromHex("#ffffff56"),light:ae.fromHex("#0007"),hcDark:null,hcLight:null},w(654,"Foreground color of the ghost text in the editor."));B("editorGhostText.background",null,w(655,"Background color of the ghost text in the editor."));const Nye=new ae(new ie(0,122,204,.6));B("editorOverviewRuler.rangeHighlightForeground",Nye,w(656,"Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const Iye=B("editorOverviewRuler.errorForeground",{dark:new ae(new ie(255,18,18,.7)),light:new ae(new ie(255,18,18,.7)),hcDark:new ae(new ie(255,50,50,1)),hcLight:"#B5200D"},w(657,"Overview ruler marker color for errors.")),Rye=B("editorOverviewRuler.warningForeground",{dark:fd,light:fd,hcDark:Ck,hcLight:Ck},w(658,"Overview ruler marker color for warnings.")),Aye=B("editorOverviewRuler.infoForeground",{dark:Ug,light:Ug,hcDark:wk,hcLight:wk},w(659,"Overview ruler marker color for infos.")),PZ=B("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},w(660,"Foreground color of brackets (1). Requires enabling bracket pair colorization.")),FZ=B("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},w(661,"Foreground color of brackets (2). Requires enabling bracket pair colorization.")),BZ=B("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},w(662,"Foreground color of brackets (3). Requires enabling bracket pair colorization.")),VZ=B("editorBracketHighlight.foreground4","#00000000",w(663,"Foreground color of brackets (4). Requires enabling bracket pair colorization.")),WZ=B("editorBracketHighlight.foreground5","#00000000",w(664,"Foreground color of brackets (5). Requires enabling bracket pair colorization.")),HZ=B("editorBracketHighlight.foreground6","#00000000",w(665,"Foreground color of brackets (6). Requires enabling bracket pair colorization.")),Mye=B("editorBracketHighlight.unexpectedBracket.foreground",{dark:new ae(new ie(255,18,18,.8)),light:new ae(new ie(255,18,18,.8)),hcDark:new ae(new ie(255,50,50,1)),hcLight:"#B5200D"},w(666,"Foreground color of unexpected brackets.")),Oye=B("editorBracketPairGuide.background1","#00000000",w(667,"Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),Pye=B("editorBracketPairGuide.background2","#00000000",w(668,"Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),Fye=B("editorBracketPairGuide.background3","#00000000",w(669,"Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),Bye=B("editorBracketPairGuide.background4","#00000000",w(670,"Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),Vye=B("editorBracketPairGuide.background5","#00000000",w(671,"Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),Wye=B("editorBracketPairGuide.background6","#00000000",w(672,"Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),Hye=B("editorBracketPairGuide.activeBackground1","#00000000",w(673,"Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),zye=B("editorBracketPairGuide.activeBackground2","#00000000",w(674,"Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),Uye=B("editorBracketPairGuide.activeBackground3","#00000000",w(675,"Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),jye=B("editorBracketPairGuide.activeBackground4","#00000000",w(676,"Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),$ye=B("editorBracketPairGuide.activeBackground5","#00000000",w(677,"Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),qye=B("editorBracketPairGuide.activeBackground6","#00000000",w(678,"Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));B("editorUnicodeHighlight.border",fd,w(679,"Border color used to highlight unicode characters."));B("editorUnicodeHighlight.background",cCe,w(680,"Background color used to highlight unicode characters."));Vh((s,e)=>{const t=s.getColor(ga),i=s.getColor(AZ),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});class zZ extends Sd{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(165);this._renderLineHighlight=t.get(110),this._renderLineHighlightOnlyWhenFocus=t.get(111),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new gt(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=new Set;for(const r of this._selections)t.add(r.positionLineNumber);const i=Array.from(t);i.sort((r,o)=>r-o),sn(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const n=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._renderLineHighlight=t.get(110),this._renderLineHighlightOnlyWhenFocus=t.get(111),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let o=t;o<=i;o++){const a=o-t;n[a]=""}if(this._wordWrap){const o=this._renderOne(e,!1);for(const a of this._cursorLineNumbers){const l=this._context.viewModel.coordinatesConverter,c=l.convertViewPositionToModelPosition(new Y(a,1)).lineNumber,u=l.convertModelPositionToViewPosition(new Y(c,1)).lineNumber,d=l.convertModelPositionToViewPosition(new Y(c,this._context.viewModel.model.getLineMaxColumn(c))).lineNumber,g=Math.max(u,t),p=Math.min(d,i);for(let _=g;_<=p;_++){const C=_-t;n[C]=o}}}const r=this._renderOne(e,!0);for(const o of this._cursorLineNumbers){if(o<t||o>i)continue;const a=o-t;n[a]=r}this._renderData=n}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class Gye extends zZ{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class Kye extends zZ{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}Vh((s,e)=>{const t=s.getColor(AZ);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||s.defines(RU)){const i=s.getColor(RU);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),T_(s.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class Yye extends Sd{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let l=0,c=t.length;l<c;l++){const u=t[l];u.options.className&&(i[n++]=u)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const u=l.options.className,d=c.options.className;return u<d?-1:u>d?1:H.compareRangesUsingStarts(l.range,c.range)});const r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=o;l++){const c=l-r;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const n=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let o=0,a=t.length;o<a;o++){const l=t[o];if(!l.options.isWholeLine)continue;const c='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',u=Math.max(l.range.startLineNumber,n),d=Math.min(l.range.endLineNumber,r);for(let g=u;g<=d;g++){const p=g-n;i[p]+=c}}}_renderNormalDecorations(e,t,i){const n=e.visibleRange.startLineNumber;let r=null,o=!1,a=null,l=!1;for(let c=0,u=t.length;c<u;c++){const d=t[c];if(d.options.isWholeLine)continue;const g=d.options.className,p=!!d.options.showIfCollapsed;let _=d.range;if(p&&_.endColumn===1&&_.endLineNumber!==_.startLineNumber&&(_=new H(_.startLineNumber,_.startColumn,_.endLineNumber-1,this._context.viewModel.getLineMaxColumn(_.endLineNumber-1))),r===g&&o===p&&H.areIntersectingOrTouching(a,_)){a=H.plusRange(a,_);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,o,n,i),r=g,o=p,a=_,l=d.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,o,n,i)}_renderNormalDecoration(e,t,i,n,r,o,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,u=l.length;c<u;c++){const d=l[c];if(d.outsideRenderedLine)continue;const g=d.lineNumber-o;if(r&&d.ranges.length===1){const p=d.ranges[0];if(p.width<this._typicalHalfwidthCharacterWidth){const _=Math.round(p.left+p.width/2),C=Math.max(0,Math.round(_-this._typicalHalfwidthCharacterWidth/2));d.ranges[0]=new Uv(C,this._typicalHalfwidthCharacterWidth)}}for(let p=0,_=d.ranges.length;p<_;p++){const C=n&&d.continuesOnNextLine&&_===1,v=d.ranges[p],x='<div class="cdr '+i+'" style="left:'+String(v.left)+"px;width:"+(C?"100%;":String(v.width)+"px;")+'"></div>';a[g]+=x}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class Qye extends Qs{constructor(e,t,i,n){super(e);const r=this._context.configuration.options,o=r.get(117),a=r.get(83),l=r.get(49),c=r.get(120),u=r.get(158),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+h5(e.theme.type),useShadows:!1,lazyRender:!0,vertical:o.vertical,horizontal:o.horizontal,verticalHasArrows:o.verticalHasArrows,horizontalHasArrows:o.horizontalHasArrows,verticalScrollbarSize:o.verticalScrollbarSize,verticalSliderSize:o.verticalSliderSize,horizontalScrollbarSize:o.horizontalScrollbarSize,horizontalSliderSize:o.horizontalSliderSize,handleMouseWheel:o.handleMouseWheel,alwaysConsumeMouseWheel:o.alwaysConsumeMouseWheel,arrowSize:o.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:o.scrollByPage,inertialScroll:u};this.scrollbar=this._register(new ND(t.domNode,d,this._context.viewLayout.getScrollable())),Xa.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=bt(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const g=(p,_,C)=>{const v={};{const x=p.scrollTop;x&&(v.scrollTop=this._context.viewLayout.getCurrentScrollTop()+x,p.scrollTop=0)}if(C){const x=p.scrollLeft;x&&(v.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+x,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(v,1)};this._register(J(i.domNode,"scroll",p=>g(i.domNode,!0,!0))),this._register(J(t.domNode,"scroll",p=>g(t.domNode,!0,!1))),this._register(J(n.domNode,"scroll",p=>g(n.domNode,!0,!1))),this._register(J(this.scrollbarDomNode.domNode,"scroll",p=>g(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(165);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(81).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(117)||e.hasChanged(83)||e.hasChanged(49)){const t=this._context.configuration.options,i=t.get(117),n=t.get(83),r=t.get(49),o=t.get(120),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:r,scrollPredominantAxis:o};this.scrollbar.updateOptions(a)}return e.hasChanged(165)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+h5(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class u5{constructor(e,t,i,n,r){this.startLineNumber=e,this.endLineNumber=t,this.className=i,this.tooltip=n,this._decorationToRenderBrand=void 0,this.zIndex=r??0}}class Xye{constructor(e,t,i){this.className=e,this.zIndex=t,this.tooltip=i}}class Zye{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class UZ extends Sd{_render(e,t,i){const n=[];for(let a=e;a<=t;a++){const l=a-e;n[l]=new Zye}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,o=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],u=c.className,d=c.zIndex;let g=Math.max(c.startLineNumber,e)-e;const p=Math.min(c.endLineNumber,t)-e;r===u?(g=Math.max(o+1,g),o=Math.max(o,p)):(r=u,o=p);for(let _=g;_<=o;_++)n[_].add(new Xye(u,d,c.tooltip))}return n}}class Jye extends Qs{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(165);this.domNode=bt(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(75),this._glyphMargin=t.get(66),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._lineHeight=t.get(75),this._glyphMargin=t.get(66),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&H.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets[t]){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){var o;const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(const a of r){const l=a.options.glyphMarginClassName;if(!l)continue;const c=Math.max(a.range.startLineNumber,i),u=Math.min(a.range.endLineNumber,n),d=((o=a.options.glyphMargin)==null?void 0:o.position)??dd.Center,g=a.options.zIndex??0;for(let p=c;p<=u;p++){const _=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(p,0)),C=this._context.viewModel.glyphLanes.getLanesAtLine(_.lineNumber).indexOf(d);t.push(new eSe(p,C,g,l))}}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(const r of Object.values(this._widgets)){const o=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(H.lift(o));if(!a||!l||l<i||a>n)continue;const c=Math.max(a,i),u=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(c,0)),d=this._context.viewModel.glyphLanes.getLanesAtLine(u.lineNumber).indexOf(r.preference.lane);t.push(new tSe(c,d,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const n of Object.values(this._widgets))n.renderInfo=null;const t=new Rh(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const n=t.peek();if(!n)break;const r=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!r||r.length===0)break;const o=r[0];if(o.type===0){const a=[];for(const l of r){if(l.zIndex!==o.zIndex||l.type!==o.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(o.accept(a.join(" ")))}else o.widget.renderInfo={lineNumber:o.lineNumber,laneIndex:o.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(r),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const n=this._decorationGlyphsToRender[i],r=n.lineNumber,o=e.viewportData.relativeVerticalOffset[r-e.viewportData.startLineNumber],a=this._glyphMarginLeft+n.laneIndex*this._lineHeight;let l;i<this._managedDomNodes.length?l=this._managedDomNodes[i]:(l=bt(document.createElement("div")),this._managedDomNodes.push(l),this.domNode.appendChild(l));const c=this._context.viewLayout.getLineHeightForLineNumber(r);l.setClassName("cgmr codicon "+n.combinedClassName),l.setPosition("absolute"),l.setTop(o),l.setLeft(a),l.setWidth(t),l.setHeight(c)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}}}class eSe{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.className=n,this.type=0}accept(e){return new iSe(this.lineNumber,this.laneIndex,e)}}class tSe{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.widget=n,this.type=1}}class iSe{constructor(e,t,i){this.lineNumber=e,this.laneIndex=t,this.combinedClassName=i}}class jZ extends ne{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function nSe(s,e){let t=0,i=0;const n=s.length;for(;i<n;){const r=s.charCodeAt(i);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var ag;(function(s){s[s.Disabled=0]="Disabled",s[s.EnabledForActive=1]="EnabledForActive",s[s.Enabled=2]="Enabled"})(ag||(ag={}));class Gf{constructor(e,t,i,n,r,o){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=n,this.forWrappedLinesAfterColumn=r,this.forWrappedLinesBeforeOrAtColumn=o,e!==-1==(t!==-1))throw new Error}}class G0{constructor(e,t){this.top=e,this.endColumn=t}}class sSe extends jZ{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return nSe(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new Pe("Illegal value for lineNumber");const r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide);let a=-2,l=-1,c=-2,u=-1;const d=N=>{if(a!==-1&&(a===-2||a>N-1)){a=-1,l=-1;for(let A=N-2;A>=0;A--){const O=this._computeIndentLevel(A);if(O>=0){a=A,l=O;break}}}if(c===-2){c=-1,u=-1;for(let A=N;A<n;A++){const O=this._computeIndentLevel(A);if(O>=0){c=A,u=O;break}}}};let g=-2,p=-1,_=-2,C=-1;const v=N=>{if(g===-2){g=-1,p=-1;for(let A=N-2;A>=0;A--){const O=this._computeIndentLevel(A);if(O>=0){g=A,p=O;break}}}if(_!==-1&&(_===-2||_<N-1)){_=-1,C=-1;for(let A=N;A<n;A++){const O=this._computeIndentLevel(A);if(O>=0){_=A,C=O;break}}}};let x=0,S=!0,k=0,E=!0,T=0,R=0;for(let N=0;S||E;N++){const A=e-N,O=e+N;N>1&&(A<1||A<t)&&(S=!1),N>1&&(O>n||O>i)&&(E=!1),N>5e4&&(S=!1,E=!1);let W=-1;if(S&&A>=1){const F=this._computeIndentLevel(A-1);F>=0?(c=A-1,u=F,W=Math.ceil(F/this.textModel.getOptions().indentSize)):(d(A),W=this._getIndentLevelForWhitespaceLine(o,l,u))}let j=-1;if(E&&O<=n){const F=this._computeIndentLevel(O-1);F>=0?(g=O-1,p=F,j=Math.ceil(F/this.textModel.getOptions().indentSize)):(v(O),j=this._getIndentLevelForWhitespaceLine(o,p,C))}if(N===0){R=W;continue}if(N===1){if(O<=n&&j>=0&&R+1===j){S=!1,x=O,k=O,T=j;continue}if(A>=1&&W>=0&&W-1===R){E=!1,x=A,k=A,T=W;continue}if(x=e,k=e,T=R,T===0)return{startLineNumber:x,endLineNumber:k,indent:T}}S&&(W>=T?x=A:S=!1),E&&(j>=T?k=O:E=!1)}return{startLineNumber:x,endLineNumber:k,indent:T}}getLinesBracketGuides(e,t,i,n){var d;const r=[];for(let g=e;g<=t;g++)r.push([]);const o=!0,a=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new H(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let l;if(i&&a.length>0){const g=(e<=i.lineNumber&&i.lineNumber<=t?a:this.textModel.bracketPairs.getBracketPairsInRange(H.fromPositions(i)).toArray()).filter(p=>H.strictContainsPosition(p.range,i));l=(d=ak(g,p=>o))==null?void 0:d.range}const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new $Z;for(const g of a){if(!g.closingBracketRange)continue;const p=l&&g.range.equalsRange(l);if(!p&&!n.includeInactive)continue;const _=u.getInlineClassName(g.nestingLevel,g.nestingLevelOfEqualBracketType,c)+(n.highlightActive&&p?" "+u.activeClassName:""),C=g.openingBracketRange.getStartPosition(),v=g.closingBracketRange.getStartPosition(),x=n.horizontalGuides===ag.Enabled||n.horizontalGuides===ag.EnabledForActive&&p;if(g.range.startLineNumber===g.range.endLineNumber){x&&r[g.range.startLineNumber-e].push(new Gf(-1,g.openingBracketRange.getEndPosition().column,_,new G0(!1,v.column),-1,-1));continue}const S=this.getVisibleColumnFromPosition(v),k=this.getVisibleColumnFromPosition(g.openingBracketRange.getStartPosition()),E=Math.min(k,S,g.minVisibleColumnIndentation+1);let T=!1;Lr(this.textModel.getLineContent(g.closingBracketRange.startLineNumber))<g.closingBracketRange.startColumn-1&&(T=!0);const A=Math.max(C.lineNumber,e),O=Math.min(v.lineNumber,t),W=T?1:0;for(let j=A;j<O+W;j++)r[j-e].push(new Gf(E,-1,_,null,j===C.lineNumber?C.column:-1,j===v.lineNumber?v.column:-1));x&&(C.lineNumber>=e&&k>E&&r[C.lineNumber-e].push(new Gf(E,-1,_,new G0(!1,C.column),-1,-1)),v.lineNumber<=t&&S>E&&r[v.lineNumber-e].push(new Gf(E,-1,_,new G0(!T,v.column),-1,-1)))}for(const g of r)g.sort((p,_)=>p.visibleColumn-_.visibleColumn);return r}getVisibleColumnFromPosition(e){return _i.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide),a=new Array(t-e+1);let l=-2,c=-1,u=-2,d=-1;for(let g=e;g<=t;g++){const p=g-e,_=this._computeIndentLevel(g-1);if(_>=0){l=g-1,c=_,a[p]=Math.ceil(_/n.indentSize);continue}if(l===-2){l=-1,c=-1;for(let C=g-2;C>=0;C--){const v=this._computeIndentLevel(C);if(v>=0){l=C,c=v;break}}}if(u!==-1&&(u===-2||u<g-1)){u=-1,d=-1;for(let C=g;C<i;C++){const v=this._computeIndentLevel(C);if(v>=0){u=C,d=v;break}}}a[p]=this._getIndentLevelForWhitespaceLine(o,c,d)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class $Z{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class rSe extends Sd{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(166),n=t.get(59);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(22),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(166),n=t.get(59);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(22),!0}onCursorStateChanged(e){var n;const i=e.selections[0].getPosition();return(n=this._primaryPosition)!=null&&n.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var l,c;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,r=this._primaryPosition,o=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),r),a=[];for(let u=t;u<=i;u++){const d=u-t,g=o[d];let p="";const _=((l=e.visibleRangeForPosition(new Y(u,1)))==null?void 0:l.left)??0;for(const C of g){const v=C.column===-1?_+(C.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new Y(u,C.column)).left;if(v>n||this._maxIndentLeft>0&&v>this._maxIndentLeft)break;const x=C.horizontalLine?C.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",S=C.horizontalLine?(((c=e.visibleRangeForPosition(new Y(u,C.horizontalLine.endColumn)))==null?void 0:c.left)??v+this._spaceWidth)-v:this._spaceWidth;p+=`<div class="core-guide ${C.className} ${x}" style="left:${v}px;width:${S}px"></div>`}a[d]=p}this._renderResult=a}getGuidesByLine(e,t,i){const n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?ag.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?ag.EnabledForActive:ag.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let o=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const d=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);o=d.startLineNumber,a=d.endLineNumber,l=d.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),u=[];for(let d=e;d<=t;d++){const g=new Array;u.push(g);const p=n?n[d-e]:[],_=new Rh(p),C=r?r[d-e]:0;for(let v=1;v<=C;v++){const x=(v-1)*c+1,S=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||p.length===0)&&o<=d&&d<=a&&v===l;g.push(..._.takeWhile(E=>E.visibleColumn<x)||[]);const k=_.peek();(!k||k.visibleColumn!==x||k.horizontalLine)&&g.push(new Gf(x,-1,`core-guide-indent lvl-${(v-1)%30}`+(S?" indent-active":""),null,-1,-1))}g.push(..._.takeWhile(v=>!0)||[])}return u}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function vp(s){if(!(s&&s.isTransparent()))return s}Vh((s,e)=>{const t=[{bracketColor:PZ,guideColor:Oye,guideColorActive:Hye},{bracketColor:FZ,guideColor:Pye,guideColorActive:zye},{bracketColor:BZ,guideColor:Fye,guideColorActive:Uye},{bracketColor:VZ,guideColor:Bye,guideColorActive:jye},{bracketColor:WZ,guideColor:Vye,guideColorActive:$ye},{bracketColor:HZ,guideColor:Wye,guideColorActive:qye}],i=new $Z,n=[{indentColor:jv,indentColorActive:$v},{indentColor:gye,indentColorActive:Cye},{indentColor:mye,indentColorActive:wye},{indentColor:pye,indentColorActive:vye},{indentColor:_ye,indentColorActive:yye},{indentColor:bye,indentColorActive:Sye}],r=t.map(a=>{const l=s.getColor(a.bracketColor),c=s.getColor(a.guideColor),u=s.getColor(a.guideColorActive),d=vp(vp(c)??(l==null?void 0:l.transparent(.3))),g=vp(vp(u)??l);if(!(!d||!g))return{guideColor:d,guideColorActive:g}}).filter(Io),o=n.map(a=>{const l=s.getColor(a.indentColor),c=s.getColor(a.indentColorActive),u=vp(l),d=vp(c);if(!(!u||!d))return{indentColor:u,indentColorActive:d}}).filter(Io);if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});const XE=class XE extends Sd{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new Y(1,1),this._renderResult=null,this._activeModelLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(75);const t=e.get(76);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(109);const i=e.get(165);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeModelLineNumber!==this._lastCursorModelPosition.lineNumber&&(this._activeModelLineNumber=this._lastCursorModelPosition.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);const n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=kr?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(c=>!!c.options.lineNumberClassName);r.sort((c,u)=>H.compareRangesUsingEnds(c.range,u.range));let o=0;const a=this._context.viewModel.getLineCount(),l=[];for(let c=i;c<=n;c++){const u=c-i,d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(c,1)).lineNumber;let g=this._getLineRenderLineNumber(c),p="";for(;o<r.length&&r[o].range.endLineNumber<c;)o++;for(let _=o;_<r.length;_++){const{range:C,options:v}=r[_];C.startLineNumber<=c&&(p+=" "+v.lineNumberClassName)}if(!g&&!p){l[u]="";continue}c===a&&this._context.viewModel.getLineLength(c)===0&&(this._renderFinalNewline==="off"&&(g=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeModelLineNumber&&(p+=" active-line-number"),l[u]=`<div class="${XE.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${g}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};XE.CLASS_NAME="line-numbers";let Tk=XE;Vh((s,e)=>{const t=s.getColor(uye),i=s.getColor(Lye);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});const I_="monaco-mouse-cursor-text";class mR{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class Nk{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(59);this.renderWhitespace=i.get(113),this.experimentalWhitespaceRendering=i.get(47),this.renderControlCharacters=i.get(108),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(40),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(75),this.stopRenderingLineAfter=i.get(133),this.fontLigatures=i.get(60),this.verticalScrollbarSize=i.get(117).verticalScrollbarSize,this.useGpu=i.get(46)==="on"}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.experimentalWhitespaceRendering===e.experimentalWhitespaceRendering&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures&&this.verticalScrollbarSize===e.verticalScrollbarSize&&this.useGpu===e.useGpu}}class oSe{constructor(){this._currentVisibleRange=new H(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class aSe{constructor(e,t,i,n,r,o,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=r,this.stopScrollTop=o,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class lSe{constructor(e,t,i,n,r){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=r,this.type="selections";let o=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const u=t[l];o=Math.min(o,u.startLineNumber),a=Math.max(a,u.endLineNumber)}this.minLineNumber=o,this.maxLineNumber=a}}const ZE=class ZE extends Qs{constructor(e,t,i){super(e);const n=this._context.configuration,r=this._context.configuration.options,o=r.get(59),a=r.get(166);this._lineHeight=r.get(75),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=a.isViewportWrapping,this._revealHorizontalRightPadding=r.get(114),this._cursorSurroundingLines=r.get(35),this._cursorSurroundingLinesStyle=r.get(36),this._canUseLayerHinting=!r.get(39),this._viewLineOptions=new Nk(n,this._context.theme.type),this._linesContent=i,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new TZ(this._context,{createLine:()=>new uh(t,this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Xa.write(this.domNode,8),this.domNode.setClassName(`view-lines ${I_}`),Jn(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new os(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new os(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new oSe,this._horizontalRevealRequest=null,this._stickyScrollEnabled=r.get(131).enabled,this._maxNumberStickyLines=r.get(131).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(166)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(59),n=t.get(166);return this._lineHeight=t.get(75),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(114),this._cursorSurroundingLines=t.get(35),this._cursorSurroundingLinesStyle=t.get(36),this._canUseLayerHinting=!t.get(39),this._stickyScrollEnabled=t.get(131).enabled,this._maxNumberStickyLines=t.get(131).maxLineCount,Jn(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(165)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new Nk(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let r=t;r<=i;r++)n=this._visibleLines.getVisibleLine(r).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e,this._viewLineOptions.useGpu);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new aSe(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new lSe(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new Y(n,1);const r=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber();if(n<r||n>o)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new Y(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===uh.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){const r=this._visibleLines.getVisibleLine(n);if(e===r.getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const n=new mR(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=H.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;const r=[];let o=0;const a=new mR(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(n.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),u=this._visibleLines.getEndLineNumber();for(let d=n.startLineNumber;d<=n.endLineNumber;d++){if(d<c||d>u)continue;const g=d===n.startLineNumber?n.startColumn:1,p=d!==i,_=p?this._context.viewModel.getLineMaxColumn(d):n.endColumn,v=this._visibleLines.getVisibleLine(d).getVisibleRangesForRange(d,g,_,a);if(v){if(t&&d<i){const x=l;if(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(d+1,1)).lineNumber,x!==l){const S=v.ranges[v.ranges.length-1];S.width+=this._typicalHalfwidthCharacterWidth,this._context.viewModel.getTextDirection(x)===no.RTL&&(S.left-=this._typicalHalfwidthCharacterWidth)}}r[o++]=new fZ(v.outsideRenderedLine,d,Uv.from(v.ranges),p)}}return this._updateLineWidthsSlowIfDomDidLayout(a),o===0?null:r}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const n=new mR(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),r}_lineIsRenderedRTL(e){return e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber()?!1:this._visibleLines.getVisibleLine(e).isRenderedRTL()}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new gZ(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,r=!0;for(let o=t;o<=i;o++){const a=this._visibleLines.getVisibleLine(o);if(e&&!a.getWidthIsFast()){r=!1;continue}n=Math.max(n,a.getWidth(null))}return r&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++){const o=this._visibleLines.getVisibleLine(r);if(o.needsMonospaceFontCheck()){const a=o.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=i;r<=n;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const n=this._computeScrollLeftToReveal(i);n&&(!this._isViewportWrapping&&!n.hasRTL&&this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),kr&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,r,o){const a=e.top,l=e.height,c=a+l;let u,d,g;if(r&&r.length>0){let x=r[0].startLineNumber,S=r[0].endLineNumber;for(let k=1,E=r.length;k<E;k++){const T=r[k];x=Math.min(x,T.startLineNumber),S=Math.max(S,T.endLineNumber)}u=!1,d=this._context.viewLayout.getVerticalOffsetForLineNumber(x),g=this._context.viewLayout.getVerticalOffsetForLineNumber(S)+this._lineHeight}else if(n)u=!0,d=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),g=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;const p=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let _=0,C=0;if(p)i||(_=this._lineHeight);else{const x=l/this._lineHeight,S=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),k=Math.min(x/2,S);_=k*this._lineHeight,C=Math.max(0,k-1)*this._lineHeight}i||(o===0||o===4)&&(C+=this._lineHeight),d-=_,g+=C;let v;if(g-d>l){if(!u)return-1;v=d}else if(o===5||o===6)if(o===6&&a<=d&&g<=c)v=a;else{const x=Math.max(5*this._lineHeight,l*.2),S=d-x,k=g-l;v=Math.max(k,S)}else if(o===1||o===2)if(o===2&&a<=d&&g<=c)v=a;else{const x=(d+g)/2;v=Math.max(0,x-l/2)}else v=this._computeMinimumScrolling(a,c,d,g,o===3,o===4);return v}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(165),n=t.left,r=n+t.width-i.verticalScrollbarWidth;let o=1073741824,a=0,l=!1;if(e.type==="range"){l=this._lineIsRenderedRTL(e.lineNumber);const u=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!u)return null;for(const d of u.ranges)o=Math.min(o,Math.round(d.left)),a=Math.max(a,Math.round(d.left+d.width))}else for(const u of e.selections){if(u.startLineNumber!==u.endLineNumber)return null;const d=this._visibleRangesForLineRange(u.startLineNumber,u.startColumn,u.endColumn);if(l||(l=this._lineIsRenderedRTL(u.startLineNumber)),!d)return null;for(const g of d.ranges)o=Math.min(o,Math.round(g.left)),a=Math.max(a,Math.round(g.left+g.width))}return e.minimalReveal||(o=Math.max(0,o-ZE.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-o>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,r,o,a),maxHorizontalOffset:a,hasRTL:l}}_computeMinimumScrolling(e,t,i,n,r,o){e=e|0,t=t|0,i=i|0,n=n|0,r=!!r,o=!!o;const a=t-e;if(n-i<a){if(r)return i;if(o)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}};ZE.HORIZONTAL_EXTRA_PX=30;let d5=ZE;class cSe extends UZ{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(165);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[n++]=new u5(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,c));const u=a.options.firstLineDecorationClassName;u&&(i[n++]=new u5(a.range.startLineNumber,a.range.startLineNumber,u,a.options.linesDecorationsTooltip??null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),r=this._decorationsLeft.toString(),o=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+o+'px;"></div>',l=[];for(let c=t;c<=i;c++){const u=c-t,d=n[u].getDecorations();let g="";for(const p of d){let _='<div class="cldr '+p.className;p.tooltip!==null&&(_+='" title="'+p.tooltip),_+=a,g+=_}l[u]=g}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const a_=class a_ extends Qs{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._canUseLayerHinting=!t.get(39),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=bt(document.createElement("div")),this._domNode.setClassName(a_.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=bt(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(a_.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._canUseLayerHinting=!t.get(39),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};a_.CLASS_NAME="glyph-margin",a_.OUTER_CLASS_NAME="margin";let Ik=a_;class hSe extends UZ{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[n++]=new u5(a.range.startLineNumber,a.range.endLineNumber,l,null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),r=[];for(let o=t;o<=i;o++){const a=o-t,l=n[a].getDecorations();let c="";for(const u of l)c+='<div class="cmdr '+u.className+'" style=""></div>';r[a]=c}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const Lu=class Lu{constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=Lu._clamp(e),this.g=Lu._clamp(t),this.b=Lu._clamp(i),this.a=Lu._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};Lu.Empty=new Lu(0,0,0,0);let Dh=Lu;const JE=class JE extends ne{static getInstance(){return this._INSTANCE||(this._INSTANCE=new JE),this._INSTANCE}constructor(){super(),this._onDidChange=new $,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(qi.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=qi.getColorMap();if(!e){this._colors=[Dh.Empty],this._backgroundIsLight=!0;return}this._colors=[Dh.Empty];for(let i=1;i<e.length;i++){const n=e[i].rgba;this._colors[i]=new Dh(n.r,n.g,n.b,Math.round(n.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};JE._INSTANCE=null;let Rk=JE;const uSe=(()=>{const s=[];for(let e=32;e<=126;e++)s.push(e);return s.push(65533),s})(),dSe=(s,e)=>(s-=32,s<0||s>96?e<=2?(s+96)%96:95:s);class Pw{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=Pw.soften(e,12/15),this.charDataLight=Pw.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,r=e.length;n<r;n++)i[n]=sk(e[n]*t);return i}renderChar(e,t,i,n,r,o,a,l,c,u,d){const g=1*this.scale,p=2*this.scale,_=d?1:p;if(t+g>e.width||i+_>e.height){console.warn("bad render request outside image data");return}const C=u?this.charDataLight:this.charDataNormal,v=dSe(n,c),x=e.width*4,S=a.r,k=a.g,E=a.b,T=r.r-S,R=r.g-k,N=r.b-E,A=Math.max(o,l),O=e.data;let W=v*g*p,j=i*x+t*4;for(let F=0;F<_;F++){let q=j;for(let Z=0;Z<g;Z++){const K=C[W++]/255*(o/255);O[q++]=S+T*K,O[q++]=k+R*K,O[q++]=E+N*K,O[q++]=A}j+=x}}blockRenderChar(e,t,i,n,r,o,a,l){const c=1*this.scale,u=2*this.scale,d=l?1:u;if(t+c>e.width||i+d>e.height){console.warn("bad render request outside image data");return}const g=e.width*4,p=.5*(r/255),_=o.r,C=o.g,v=o.b,x=n.r-_,S=n.g-C,k=n.b-v,E=_+x*p,T=C+S*p,R=v+k*p,N=Math.max(r,a),A=e.data;let O=i*g+t*4;for(let W=0;W<d;W++){let j=O;for(let F=0;F<c;F++)A[j++]=E,A[j++]=T,A[j++]=R,A[j++]=N;O+=g}}}const AU={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},MU=s=>{const e=new Uint8ClampedArray(s.length/2);for(let t=0;t<s.length;t+=2)e[t>>1]=AU[s[t]]<<4|AU[s[t+1]]&15;return e},OU={1:hw(()=>MU("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:hw(()=>MU("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class K0{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return OU[e]?i=new Pw(OU[e](),e):i=K0.createFromSampleData(K0.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=960,t.style.width="960px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const r of uSe)i.fillText(String.fromCharCode(r),n,16/2),n+=10;return i.getImageData(0,0,960,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const n=K0._downsample(e,t);return new Pw(n,t)}static _downsampleChar(e,t,i,n,r){const o=1*r,a=2*r;let l=n,c=0;for(let u=0;u<a;u++){const d=u/a*16,g=(u+1)/a*16;for(let p=0;p<o;p++){const _=p/o*10,C=(p+1)/o*10;let v=0,x=0;for(let k=d;k<g;k++){const E=t+Math.floor(k)*3840,T=1-(k-Math.floor(k));for(let R=_;R<C;R++){const N=1-(R-Math.floor(R)),A=E+Math.floor(R)*4,O=N*T;x+=O,v+=e[A]*e[A+3]/255*O}}const S=v/x;c=Math.max(c,S),i[l++]=sk(S)}}return c}static _downsample(e,t){const i=2*t*1*t,n=i*96,r=new Uint8ClampedArray(n);let o=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,r,o,t)),o+=i,a+=40;if(l>0){const c=255/l;for(let u=0;u<n;u++)r[u]*=c}return r}}const fSe=cr?'"Segoe WPC", "Segoe UI", sans-serif':rt?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';class qZ{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}function gSe(s,e){return!(e.options.hideInCommentTokens&&mSe(s,e)||e.options.hideInStringTokens&&pSe(s,e))}function mSe(s,e){return GZ(s,e.range,t=>t===1)}function pSe(s,e){return GZ(s,e.range,t=>t===2)}function GZ(s,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const n=s.tokenization.getLineTokens(i),r=i===e.startLineNumber,o=i===e.endLineNumber;let a=r?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(o&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}const _Se=140,bSe=2;class R_{constructor(e,t,i){const n=e.options,r=n.get(163),o=n.get(165),a=o.minimap,l=n.get(59),c=n.get(81);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(119),this.paddingTop=n.get(96).top,this.paddingBottom=n.get(96).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(75),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=o.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=o.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=fSe,this.sectionHeaderFontSize=c.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=c.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=R_._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=hw(()=>K0.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=R_._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=R_._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(DCe);return i?new Dh(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(TCe);return t?Dh._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){const i=e.getColor(Wv);return i?new Dh(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class Y0{constructor(e,t,i,n,r,o,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=r,this.sliderHeight=o,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,r,o,a,l,c,u,d){const g=e.pixelRatio,p=e.minimapLineHeight,_=Math.floor(e.canvasInnerHeight/p),C=e.lineHeight;if(e.minimapHeightIsEditorHeight){let R=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(R+=Math.max(0,r-e.lineHeight-e.paddingBottom));const N=Math.max(1,Math.floor(r*r/R)),A=Math.max(0,e.minimapHeight-N),O=A/(u-r),W=c*O,j=A>0,F=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),q=Math.floor(e.paddingTop/e.lineHeight);return new Y0(c,u,j,O,W,N,q,1,Math.min(a,F))}let v;if(o&&i!==a){const R=i-t+1;v=Math.floor(R*p/g)}else{const R=r/C;v=Math.floor(R*p/g)}const x=Math.floor(e.paddingTop/C);let S=Math.floor(e.paddingBottom/C);if(e.scrollBeyondLastLine){const R=r/C;S=Math.max(S,R-1)}let k;if(S>0){const R=r/C;k=(x+a+S-R-1)*p/g}else k=Math.max(0,(x+a)*p/g-v);k=Math.min(e.minimapHeight-v,k);const E=k/(u-r),T=c*E;if(_>=x+a+S){const R=k>0;return new Y0(c,u,R,E,T,v,x,1,a)}else{let R;t>1?R=t+x:R=Math.max(1,c/C);let N,A=Math.max(1,Math.floor(R-T*g/p));A<x?(N=x-A+1,A=1):(N=0,A=Math.max(1,A-x)),d&&d.scrollHeight===u&&(d.scrollTop>c&&(A=Math.min(A,d.startLineNumber),N=Math.max(N,d.topPaddingLineCount)),d.scrollTop<c&&(A=Math.max(A,d.startLineNumber),N=Math.min(N,d.topPaddingLineCount)));const O=Math.min(a,A-N+_-1),W=(c-n)/C;let j;return c>=e.paddingTop?j=(t-A+N+W)*p/g:j=c/e.paddingTop*(N+W)*p/g,new Y0(c,u,!0,E,j,v,N,A,O)}}}const e2=class e2{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}};e2.INVALID=new e2(-1);let Ak=e2;class PU{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new DZ({createLine:()=>Ak.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let n=0,r=i.length;n<r;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class k6{constructor(e,t,i,n){this._backgroundFillData=k6._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,r=i.g,o=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let u=0;u<t;u++)for(let d=0;d<e;d++)l[c]=n,l[c+1]=r,l[c+2]=o,l[c+3]=a,c+=4;return l}}class Fw{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:n}=v_.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/n,o=r/2;if(!i||i.minimapLines.length===0){const v=[];if(v[0]=1,n>1){for(let x=0,S=n-1;x<S;x++)v[x]=Math.round(x*r+o);v[n-1]=t}return[new Fw(r,v),[]]}const a=i.minimapLines,l=a.length,c=[];let u=0,d=0,g=1;const p=10;let _=[],C=null;for(let v=0;v<n;v++){const x=Math.max(g,Math.round(v*r)),S=Math.max(x,Math.round((v+1)*r));for(;u<l&&a[u]<x;){if(_.length<p){const E=u+1+d;C&&C.type==="deleted"&&C._oldIndex===u-1?C.deleteToLineNumber++:(C={type:"deleted",_oldIndex:u,deleteFromLineNumber:E,deleteToLineNumber:E},_.push(C)),d--}u++}let k;if(u<l&&a[u]<=S)k=a[u],u++;else if(v===0?k=1:v+1===n?k=t:k=Math.round(v*r+o),_.length<p){const E=u+1+d;C&&C.type==="inserted"&&C._i===v-1?C.insertToLineNumber++:(C={type:"inserted",_i:v,insertFromLineNumber:E,insertToLineNumber:E},_.push(C)),d++}c[v]=k,g=k}if(_.length<p)for(;u<l;){const v=u+1+d;C&&C.type==="deleted"&&C._oldIndex===u-1?C.deleteToLineNumber++:(C={type:"deleted",_oldIndex:u,deleteFromLineNumber:v,deleteToLineNumber:v},_.push(C)),d--,u++}else _=[{type:"flush"}];return[new Fw(r,c),_]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const r=this.minimapLines[i];if(r<e||r>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,r),n=Math.max(n,r)):this.minimapLines[r]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class CSe extends Qs{constructor(e){super(e),this._sectionHeaderCache=new Ov(10,1.5),this.tokensColorTracker=Rk.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new R_(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=Fw.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new Kp(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new R_(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged(e)}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=Fw.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let r=0,o=t-e+1;r<o;r++)i[r]?n[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):n[r]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new gt(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){return this._getMinimapDecorationsInViewport(e,t).filter(i=>{var n;return!((n=i.options.minimap)!=null&&n.sectionHeaderStyle)})}getSectionHeaderDecorationsInViewport(e,t){const i=this.options.sectionHeaderFontSize/this.options.minimapLineHeight;return e=Math.floor(Math.max(1,e-i)),this._getMinimapDecorationsInViewport(e,t).filter(n=>{var r;return!!((r=n.options.minimap)!=null&&r.sectionHeaderStyle)})}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const r=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new H(r,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new H(e,1,t,this._context.viewModel.getLineMaxColumn(t));const n=this._context.viewModel.getMinimapDecorationsInRange(i);if(this._samplingState){const r=[];for(const o of n){if(!o.options.minimap)continue;const a=o.range,l=this._samplingState.modelLineToMinimapLine(a.startLineNumber),c=this._samplingState.modelLineToMinimapLine(a.endLineNumber);r.push(new qZ(new H(l,a.startColumn,c,a.endColumn),o.options))}return r}return n}getSectionHeaderText(e,t){var o;const i=(o=e.options.minimap)==null?void 0:o.sectionHeaderText;if(!i)return null;const n=this._sectionHeaderCache.get(i);if(n)return n;const r=t(i);return this._sectionHeaderCache.set(i,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new H(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class Kp extends ne{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._isMouseOverMinimap=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(CU),this._domNode=bt(document.createElement("div")),Xa.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=bt(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=bt(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=bt(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=bt(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=bt(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._hideDelayedScheduler=this._register(new os(()=>this._hideImmediatelyIfMouseIsOutside(),500)),this._register(Xn(this._domNode.domNode,pe.MOUSE_OVER,()=>{this._isMouseOverMinimap=!0})),this._register(Xn(this._domNode.domNode,pe.MOUSE_LEAVE,()=>{this._isMouseOverMinimap=!1})),this._pointerDownListener=Xn(this._domNode.domNode,pe.POINTER_DOWN,i=>{i.preventDefault();const n=i.pointerType==="mouse",r=i.button===0;if(this._model.options.renderMinimap!==0&&this._lastRenderData){if(this._model.options.size!=="proportional"){if(r&&this._lastRenderData){const a=Mo(this._slider.domNode),l=a.top+a.height/2;this._startSliderDragging(i,l,this._lastRenderData.renderedLayout)}return}if(r||!n){const a=this._model.options.minimapLineHeight,l=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let u=Math.floor(l/a)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;u=Math.min(u,this._model.getLineCount()),this._model.revealLineNumber(u)}}}),this._sliderPointerMoveMonitor=new xD,this._sliderPointerDownListener=Xn(this._slider.domNode,pe.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=$s.addTarget(this._domNode.domNode),this._sliderTouchStartListener=J(this._domNode.domNode,Qt.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=J(this._domNode.domNode,Qt.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=Xn(this._domNode.domNode,Qt.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_hideSoon(){this._hideDelayedScheduler.cancel(),this._hideDelayedScheduler.schedule()}_hideImmediatelyIfMouseIsOutside(){if(this._isMouseOverMinimap){this._hideSoon();return}this._domNode.toggleClassName("active",!1)}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const n=e.pageX;this._slider.toggleClassName("active",!0);const r=(o,a)=>{const l=Mo(this._domNode.domNode),c=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(cr&&c>_Se){this._model.setScrollTop(i.scrollTop);return}const u=o-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(u))};e.pageY!==t&&r(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>r(o.pageY,o.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide==="mouseover"?e.push("minimap-autohide-mouseover"):this._model.options.autohide==="scroll"&&e.push("minimap-autohide-scroll"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new k6(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesDeleted(e,t),!0}onLinesInserted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesInserted(e,t),!0}onScrollChanged(e){return this._model.options.autohide==="scroll"&&(e.scrollTopChanged||e.scrollHeightChanged)&&(this._domNode.toggleClassName("active",!0),this._hideSoon()),this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(CU),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=Y0.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(H.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((g,p)=>(g.options.zIndex||0)-(p.options.zIndex||0));const{canvasInnerWidth:n,canvasInnerHeight:r}=this._model.options,o=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,n,r);const u=new FU(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,u,e,o),this._renderDecorationsLineHighlights(c,i,u,e,o);const d=new FU(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,d,e,o,l,a,n),this._renderDecorationsHighlights(c,i,d,e,o,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let o=0,a=0;for(const l of t){const c=n.intersectWithViewport(l);if(!c)continue;const[u,d]=c;for(let _=u;_<=d;_++)i.set(_,!0);const g=n.getYForLineNumber(u,r),p=n.getYForLineNumber(d,r);a>=g||(a>o&&e.fillRect(pl,o,e.canvas.width,a-o),o=g),a=p}a>o&&e.fillRect(pl,o,e.canvas.width,a-o)}_renderDecorationsLineHighlights(e,t,i,n,r){const o=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==1)continue;const u=n.intersectWithViewport(l.range);if(!u)continue;const[d,g]=u,p=c.getColor(this._theme.value);if(!p||p.isTransparent())continue;let _=o.get(p.toString());_||(_=p.transparent(.5).toString(),o.set(p.toString(),_)),e.fillStyle=_;for(let C=d;C<=g;C++){if(i.has(C))continue;i.set(C,!0);const v=n.getYForLineNumber(d,r);e.fillRect(pl,v,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,i,n,r,o,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const u=n.intersectWithViewport(c);if(!u)continue;const[d,g]=u;for(let p=d;p<=g;p++)this.renderDecorationOnLine(e,i,c,this._selectionColor,n,p,r,r,o,a,l)}}_renderDecorationsHighlights(e,t,i,n,r,o,a,l){for(const c of t){const u=c.options.minimap;if(!u)continue;const d=n.intersectWithViewport(c.range);if(!d)continue;const[g,p]=d,_=u.getColor(this._theme.value);if(!(!_||_.isTransparent()))for(let C=g;C<=p;C++)switch(u.position){case 1:this.renderDecorationOnLine(e,i,c.range,_,n,C,r,r,o,a,l);continue;case 2:{const v=n.getYForLineNumber(C,r);this.renderDecoration(e,_,2,v,bSe,r);continue}}}}renderDecorationOnLine(e,t,i,n,r,o,a,l,c,u,d){const g=r.getYForLineNumber(o,l);if(g+a<0||g>this._model.options.canvasInnerHeight)return;const{startLineNumber:p,endLineNumber:_}=i,C=p===o?i.startColumn:1,v=_===o?i.endColumn:this._model.getLineMaxColumn(o),x=this.getXOffsetForPosition(t,o,C,c,u,d),S=this.getXOffsetForPosition(t,o,v,c,u,d);this.renderDecoration(e,n,x,g,S-x,a)}getXOffsetForPosition(e,t,i,n,r,o){if(i===1)return pl;if((i-1)*r>=o)return o;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[pl];let u=pl;for(let d=1;d<c.length+1;d++){const g=c.charCodeAt(d-1),p=g===9?n*r:Mh(g)?2*r:r,_=u+p;if(_>=o){l[d]=o;break}l[d]=_,u=_}e.set(t,l)}return i-1<l.length?l[i-1]:o}renderDecoration(e,t,i,n,r,o){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,r,o)}_renderSectionHeaders(e){var C;const t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,r=i*1.5,{canvasInnerWidth:o}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,c=this._model.options.sectionHeaderFontColor,u=`rgb(${c.r} ${c.g} ${c.b})`,d=u,g=this._decorationsCanvas.domNode.getContext("2d");g.letterSpacing=n+"px",g.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,g.strokeStyle=d,g.lineWidth=.4;const p=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);p.sort((v,x)=>v.range.startLineNumber-x.range.startLineNumber);const _=Kp._fitSectionHeader.bind(null,g,o-pl);for(const v of p){const x=e.getYForLineNumber(v.range.startLineNumber,t)+i,S=x-i,k=S+2,E=this._model.getSectionHeaderText(v,_);Kp._renderSectionLabel(g,E,((C=v.options.minimap)==null?void 0:C.sectionHeaderStyle)===2,l,u,o,S,r,x,k)}}static _fitSectionHeader(e,t,i){if(!i)return i;const n="",r=e.measureText(i).width,o=e.measureText(n).width;if(r<=t||r<=o)return i;const a=i.length,l=r/i.length,c=Math.floor((t-o)/l)-1;let u=Math.ceil(c/2);for(;u>0&&/\s/.test(i[u-1]);)--u;return i.substring(0,u)+n+i.substring(a-(c-u))}static _renderSectionLabel(e,t,i,n,r,o,a,l,c,u){t&&(e.fillStyle=n,e.fillRect(0,a,o,l),e.fillStyle=r,e.fillText(t,pl,c)),i&&(e.beginPath(),e.moveTo(0,u),e.lineTo(o,u),e.closePath(),e.stroke())}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const K=this._lastRenderData._get();return new PU(e,K.imageData,K.lines)}const r=this._getBuffer();if(!r)return null;const[o,a,l]=Kp._renderUntouchedLines(r,e.topPaddingLineCount,t,i,n,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),u=this._model.getOptions().tabSize,d=this._model.options.defaultBackgroundColor,g=this._model.options.backgroundColor,p=this._model.options.foregroundAlpha,_=this._model.tokensColorTracker,C=_.backgroundIsLight(),v=this._model.options.renderMinimap,x=this._model.options.charRenderer(),S=this._model.options.fontScale,k=this._model.options.minimapCharWidth,T=(v===1?2:3)*S,R=n>T?Math.floor((n-T)/2):0,N=g.a/255,A=new Dh(Math.round((g.r-d.r)*N+d.r),Math.round((g.g-d.g)*N+d.g),Math.round((g.b-d.b)*N+d.b),255);let O=e.topPaddingLineCount*n;const W=[];for(let K=0,U=i-t+1;K<U;K++)l[K]&&Kp._renderLine(r,A,g.a,C,v,k,_,p,x,O,R,u,c[K],S,n),W[K]=new Ak(O),O+=n;const j=o===-1?0:o,q=(a===-1?r.height:a)-j;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,j,r.width,q),new PU(e,r,W)}static _renderUntouchedLines(e,t,i,n,r,o){const a=[];if(!o){for(let O=0,W=n-i+1;O<W;O++)a[O]=!0;return[-1,-1,a]}const l=o._get(),c=l.imageData.data,u=l.rendLineNumberStart,d=l.lines,g=d.length,p=e.width,_=e.data,C=(n-i+1)*r*p*4;let v=-1,x=-1,S=-1,k=-1,E=-1,T=-1,R=t*r;for(let O=i;O<=n;O++){const W=O-i,j=O-u,F=j>=0&&j<g?d[j].dy:-1;if(F===-1){a[W]=!0,R+=r;continue}const q=F*p*4,Z=(F+r)*p*4,K=R*p*4,U=(R+r)*p*4;k===q&&T===K?(k=Z,T=U):(S!==-1&&(_.set(c.subarray(S,k),E),v===-1&&S===0&&S===E&&(v=k),x===-1&&k===C&&S===E&&(x=S)),S=q,k=Z,E=K,T=U),a[W]=!1,R+=r}S!==-1&&(_.set(c.subarray(S,k),E),v===-1&&S===0&&S===E&&(v=k),x===-1&&k===C&&S===E&&(x=S));const N=v===-1?-1:v/(p*4),A=x===-1?-1:x/(p*4);return[N,A,a]}static _renderLine(e,t,i,n,r,o,a,l,c,u,d,g,p,_,C){const v=p.content,x=p.tokens,S=e.width-o,k=C===1;let E=pl,T=0,R=0;for(let N=0,A=x.getCount();N<A;N++){const O=x.getEndOffset(N),W=x.getForeground(N),j=a.getColor(W);for(;T<O;T++){if(E>S)return;const F=v.charCodeAt(T);if(F===9){const q=g-(T+R)%g;R+=q-1,E+=q*o}else if(F===32)E+=o;else{const q=Mh(F)?2:1;for(let Z=0;Z<q;Z++)if(r===2?c.blockRenderChar(e,E,u+d,j,l,t,i,k):c.renderChar(e,E,u+d,F,j,l,t,i,_,n,k),E+=o,E>S)return}}}}}class FU{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,r=this._endLineNumber-this._startLineNumber+1;n<r;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class wSe extends Qs{constructor(e,t){super(e),this._viewDomNode=t;const n=this._context.configuration.options.get(165);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=bt(document.createElement("div")),Xa.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=bt(document.createElement("div")),Xa.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}_widgetCanOverflow(e){const i=this._context.configuration.options.get(4);return(e.allowEditorOverflow||!1)&&i}addWidget(e){const t=bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._widgetCanOverflow(e)?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()],n=t?t.preference:null,r=t==null?void 0:t.stackOridinal;return i.preference===n&&i.stack===r?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var i,n;let e=0;const t=Object.keys(this._widgets);for(let r=0,o=t.length;r<o;r++){const a=t[r],c=(n=(i=this._widgets[a].widget).getMinContentWidthInPx)==null?void 0:n.call(i);typeof c<"u"&&(e=Math.max(e,c))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){const i=e.domNode;if(e.preference===null){i.setTop("");return}const n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){const r=i.domNode.clientHeight;i.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{const{top:r,left:o}=e.preference;if(this._context.configuration.options.get(51)&&this._widgetCanOverflow(e.widget)){const l=this._viewDomNodeRect;i.setTop(r+l.top),i.setLeft(o+l.left),i.setPosition("fixed")}else i.setTop(r),i.setLeft(o),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Mo(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,r)=>(this._widgets[n].stack||0)-(this._widgets[r].stack||0));for(let n=0,r=t.length;n<r;n++){const o=t[n];this._renderWidget(this._widgets[o],i)}}}class vSe{constructor(e,t){const i=e.options;this.lineHeight=i.get(75),this.pixelRatio=i.get(163),this.overviewRulerLanes=i.get(95),this.renderBorder=i.get(94);const n=t.getColor(Eye);this.borderColor=n?n.toString():null,this.hideCursor=i.get(68);const r=t.getColor(AD);this.cursorColorSingle=r?r.transparent(.7).toString():null;const o=t.getColor(MZ);this.cursorColorPrimary=o?o.transparent(.7).toString():null;const a=t.getColor(OZ);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;const l=i.get(81),c=l.enabled,u=l.side,d=t.getColor(Dye),g=qi.getDefaultBackground();d?this.backgroundColor=d:c&&u==="right"?this.backgroundColor=g:this.backgroundColor=null;const _=i.get(165).overviewRuler;this.top=_.top,this.right=_.right,this.domWidth=_.width,this.domHeight=_.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[C,v]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=C,this.w=v}_initLanes(e,t,i){const n=t-e;if(i>=3){const r=Math.floor(n/3),o=Math.floor(n/3),a=n-r-o,l=e,c=l+r,u=l+r+a;return[[0,l,c,l,u,l,c,l],[0,r,a,r+a,o,r+a+o,a+o,r+a+o]]}else if(i===2){const r=Math.floor(n/2),o=n-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,o,r+o,r+o,r+o]]}else{const r=e,o=n;return[[0,r,r,r,r,r,r,r],[0,o,o,o,o,o,o,o]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&ae.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class ySe extends Qs{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=bt(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=qi.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new Y(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new vSe(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>Y.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?ae.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Ew.compareByRenderingProps),this._actualShouldRender===1&&!Ew.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!sn(this._renderedCursorPositions,this._cursorPositions,(_,C)=>_.position.lineNumber===C.position.lineNumber&&_.color===C.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,n=this._settings.canvasHeight,r=this._settings.lineHeight,o=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,c=6*this._settings.pixelRatio|0,u=c/2|0,d=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(d.fillStyle=ae.Format.CSS.formatHexA(e),d.fillRect(0,0,i,n)):(d.clearRect(0,0,i,n),d.fillStyle=ae.Format.CSS.formatHexA(e),d.fillRect(0,0,i,n)):d.clearRect(0,0,i,n);const g=this._settings.x,p=this._settings.w;for(const _ of t){const C=_.color,v=_.data;d.fillStyle=C;let x=0,S=0,k=0;for(let E=0,T=v.length/3;E<T;E++){const R=v[3*E],N=v[3*E+1],A=v[3*E+2];let O=o.getVerticalOffsetForLineNumber(N)*l|0,W=(o.getVerticalOffsetForLineNumber(A)+r)*l|0;if(W-O<c){let F=(O+W)/2|0;F<u?F=u:F+u>n&&(F=n-u),O=F-u,W=F+u}O>k+1||R!==x?(E!==0&&d.fillRect(g[x],S,p[x],k-S),x=R,S=O,k=W):W>k&&(k=W)}d.fillRect(g[x],S,p[x],k-S)}if(!this._settings.hideCursor){const _=2*this._settings.pixelRatio|0,C=_/2|0,v=this._settings.x[7],x=this._settings.w[7];let S=-100,k=-100,E=null;for(let T=0,R=this._cursorPositions.length;T<R;T++){const N=this._cursorPositions[T].color;if(!N)continue;const A=this._cursorPositions[T].position;let O=o.getVerticalOffsetForLineNumber(A.lineNumber)*l|0;O<C?O=C:O+C>n&&(O=n-C);const W=O-C,j=W+_;W>k+1||N!==E?(T!==0&&E&&d.fillRect(v,S,x,k-S),S=W,k=j):j>k&&(k=j),E=N,d.fillStyle=N}E&&d.fillRect(v,S,x,k-S)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(d.beginPath(),d.lineWidth=1,d.strokeStyle=this._settings.borderColor,d.moveTo(0,0),d.lineTo(0,n),d.moveTo(1,0),d.lineTo(i,0),d.stroke())}}class BU{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class KZ{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class SSe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(KZ.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),r=i/n,o=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const u=this._zones[l];if(!e){const E=u.getColorZones();if(E){a.push(E);continue}}const d=this._getVerticalOffsetForLine(u.startLineNumber),g=u.heightInLines===0?this._getVerticalOffsetForLine(u.endLineNumber)+t:d+u.heightInLines*t,p=Math.floor(r*d),_=Math.floor(r*g);let C=Math.floor((p+_)/2),v=_-C;v<o&&(v=o),C-v<0&&(C=v),C+v>i&&(C=i-v);const x=u.color;let S=this._color2Id[x];S||(S=++this._lastAssignedId,this._color2Id[x]=S,this._id2Color[S]=x);const k=new BU(C-v,C+v,S);u.setColorZone(k),a.push(k)}return this._colorZonesInvalid=!1,a.sort(BU.compare),a}}class xSe extends fm{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=bt(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new SSe(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(75)),this._zoneManager.setPixelRatio(i.get(163)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(75)&&(this._zoneManager.setLineHeight(t.get(75)),this._render()),e.hasChanged(163)&&(this._zoneManager.setPixelRatio(t.get(163)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(r,i,n,e),!0}_renderOneLane(e,t,i,n){let r=0,o=0,a=0;for(const l of t){const c=l.colorId,u=l.from,d=l.to;c!==r?(e.fillRect(0,o,n,a-o),r=c,e.fillStyle=i[r],o=u,a=d):a>=u?a=Math.max(a,d):(e.fillRect(0,o,n,a-o),o=u,a=d)}e.fillRect(0,o,n,a-o)}}class LSe extends Qs{constructor(e){super(e),this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(116),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(116),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.viewModel.model.getOptions(),r=n;let o=t-e;for(;o>0;){const a=bt(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),o--}return}let i=e-t;for(;i>0;){const n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const n=this._renderedRulers[t],r=this._rulers[t];n.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}}class kSe extends Qs{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(117);this._useShadows=i.useShadows,this._domNode=bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(165);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(117);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class ESe{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class DSe{constructor(e,t){this.lineNumber=e,this.ranges=t}}function TSe(s){return new ESe(s)}function NSe(s){return new DSe(s.lineNumber,s.ranges.map(TSe))}const Ei=class Ei extends Sd{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._roundedSelection=t.get(115),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._roundedSelection=t.get(115),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let r=null,o=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!r&&c<i.length;c++)i[c].lineNumber===a&&(r=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!o&&c>=0;c--)i[c].lineNumber===l&&(o=i[c].ranges[0]);r&&!r.startStyle&&(r=null),o&&!o.startStyle&&(o=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],u=c.left,d=c.left+c.width,g={top:0,bottom:0},p={top:0,bottom:0};if(a>0){const _=t[a-1].ranges[0].left,C=t[a-1].ranges[0].left+t[a-1].ranges[0].width;qS(u-_)<n?g.top=2:u>_&&(g.top=1),qS(d-C)<n?p.top=2:_<d&&d<C&&(p.top=1)}else r&&(g.top=r.startStyle.top,p.top=r.endStyle.top);if(a+1<l){const _=t[a+1].ranges[0].left,C=t[a+1].ranges[0].left+t[a+1].ranges[0].width;qS(u-_)<n?g.bottom=2:_<u&&u<C&&(g.bottom=1),qS(d-C)<n?p.bottom=2:d<C&&(p.bottom=1)}else o&&(g.bottom=o.startStyle.bottom,p.bottom=o.endStyle.bottom);c.startStyle=g,c.endStyle=p}}_getVisibleRangesWithStyle(e,t,i){const r=(t.linesVisibleRangesForRange(e,!0)||[]).map(NSe);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,i),r}_createSelectionPiece(e,t,i,n,r){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;const r=!!n[0].ranges[0].startStyle,o=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,c=n.length;l<c;l++){const u=n[l],d=u.lineNumber,g=d-t,p=i&&d===o?1:0,_=i&&d!==o&&d===a?1:0;let C="",v="";for(let x=0,S=u.ranges.length;x<S;x++){const k=u.ranges[x];if(r){const T=k.startStyle,R=k.endStyle;if(T.top===1||T.bottom===1){C+=this._createSelectionPiece(p,_,Ei.SELECTION_CLASS_NAME,k.left-Ei.ROUNDED_PIECE_WIDTH,Ei.ROUNDED_PIECE_WIDTH);let N=Ei.EDITOR_BACKGROUND_CLASS_NAME;T.top===1&&(N+=" "+Ei.SELECTION_TOP_RIGHT),T.bottom===1&&(N+=" "+Ei.SELECTION_BOTTOM_RIGHT),C+=this._createSelectionPiece(p,_,N,k.left-Ei.ROUNDED_PIECE_WIDTH,Ei.ROUNDED_PIECE_WIDTH)}if(R.top===1||R.bottom===1){C+=this._createSelectionPiece(p,_,Ei.SELECTION_CLASS_NAME,k.left+k.width,Ei.ROUNDED_PIECE_WIDTH);let N=Ei.EDITOR_BACKGROUND_CLASS_NAME;R.top===1&&(N+=" "+Ei.SELECTION_TOP_LEFT),R.bottom===1&&(N+=" "+Ei.SELECTION_BOTTOM_LEFT),C+=this._createSelectionPiece(p,_,N,k.left+k.width,Ei.ROUNDED_PIECE_WIDTH)}}let E=Ei.SELECTION_CLASS_NAME;if(r){const T=k.startStyle,R=k.endStyle;T.top===0&&(E+=" "+Ei.SELECTION_TOP_LEFT),T.bottom===0&&(E+=" "+Ei.SELECTION_BOTTOM_LEFT),R.top===0&&(E+=" "+Ei.SELECTION_TOP_RIGHT),R.bottom===0&&(E+=" "+Ei.SELECTION_BOTTOM_RIGHT)}v+=this._createSelectionPiece(p,_,E,k.left,k.width)}e[g][0]+=C,e[g][1]+=v}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let o=i;o<=n;o++){const a=o-i;t[a]=["",""]}const r=[];for(let o=0,a=this._selections.length;o<a;o++){const l=this._selections[o];if(l.isEmpty()){r[o]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[o]);r[o]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([o,a])=>o+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Ei.SELECTION_CLASS_NAME="selected-text",Ei.SELECTION_TOP_LEFT="top-left-radius",Ei.SELECTION_BOTTOM_LEFT="bottom-left-radius",Ei.SELECTION_TOP_RIGHT="top-right-radius",Ei.SELECTION_BOTTOM_RIGHT="bottom-right-radius",Ei.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",Ei.ROUNDED_PIECE_WIDTH=10;let f5=Ei;Vh((s,e)=>{const t=s.getColor(uCe);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function qS(s){return s<0?-s:s}class VU{constructor(e,t,i,n,r,o,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=n,this.height=r,this.textContent=o,this.textContentClassName=a}}var ph;(function(s){s[s.Single=0]="Single",s[s.MultiPrimary=1]="MultiPrimary",s[s.MultiSecondary=2]="MultiSecondary"})(ph||(ph={}));class WU{constructor(e,t){this._context=e;const i=this._context.configuration.options,n=i.get(59);this._cursorStyle=i.get(161),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(37),this._typicalHalfwidthCharacterWidth),this._lineCursorHeight=i.get(38),this._isVisible=!0,this._domNode=bt(document.createElement("div")),this._domNode.setClassName(`cursor ${I_}`),this._domNode.setHeight(this._context.viewLayout.getLineHeightForLineNumber(1)),this._domNode.setTop(0),this._domNode.setLeft(0),Jn(this._domNode,n),this._domNode.setDisplay("none"),this._position=new Y(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case ph.Single:this._pluralityClass="";break;case ph.MultiPrimary:this._pluralityClass="cursor-primary";break;case ph.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(59);return this._cursorStyle=t.get(161),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(37),this._typicalHalfwidthCharacterWidth),this._lineCursorHeight=t.get(38),Jn(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,r]=Fme(i,t-1);return[new Y(e,n+1),i.substring(n,r)]}_prepareRender(e){let t="",i="";const[n,r]=this._getGraphemeAwarePosition(),o=this._context.viewLayout.getLineHeightForLineNumber(n.lineNumber),a=this._lineCursorHeight===0?o:Math.min(o,this._lineCursorHeight),l=(o-a)/2;if(this._cursorStyle===cn.Line||this._cursorStyle===cn.LineThin){const C=e.visibleRangeForPosition(n);if(!C||C.outsideRenderedLine)return null;const v=Ae(this._domNode.domNode);let x;this._cursorStyle===cn.Line?(x=ez(v,this._lineCursorWidth>0?this._lineCursorWidth:2),x>2&&(t=r,i=this._getTokenClassName(n))):x=ez(v,1);let S=C.left,k=0;x>=2&&S>=1&&(k=1,S-=k);const E=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta+l;return new VU(E,S,k,x,a,t,i)}const c=e.linesVisibleRangesForRange(new H(n.lineNumber,n.column,n.lineNumber,n.column+r.length),!1);if(!c||c.length===0)return null;const u=c[0];if(u.outsideRenderedLine||u.ranges.length===0)return null;const d=u.ranges[0],g=r==="	"?this._typicalHalfwidthCharacterWidth:d.width<1?this._typicalHalfwidthCharacterWidth:d.width;this._cursorStyle===cn.Block&&(t=r,i=this._getTokenClassName(n));let p=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,_=o;return(this._cursorStyle===cn.Underline||this._cursorStyle===cn.UnderlineThin)&&(p+=o-2,_=2),new VU(p,d.left,0,g,_,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${I_} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}const NC=class NC extends Qs{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(104),this._cursorBlinking=t.get(32),this._cursorStyle=t.get(161),this._cursorSmoothCaretAnimation=t.get(33),this._editContextEnabled=t.get(170),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new WU(this._context,ph.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Ql,this._cursorFlatBlinkInterval=new B7,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(104),this._cursorBlinking=t.get(32),this._cursorStyle=t.get(161),this._cursorSmoothCaretAnimation=t.get(33),this._editContextEnabled=t.get(170),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?ph.MultiPrimary:ph.Single),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){const r=t.length-this._secondaryCursors.length;for(let o=0;o<r;o++){const a=new WU(this._context,ph.MultiSecondary);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const r=this._secondaryCursors.length-t.length;for(let o=0;o<r;o++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],n)}onCursorStateChanged(e){const t=[];for(let n=0,r=e.selections.length;n<r;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let n=0,r=e.ranges.length;n<r;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput&&!this._editContextEnabled||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},NC.BLINK_INTERVAL,Ae(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},NC.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case cn.Line:e+=" cursor-line-style";break;case cn.Block:e+=" cursor-block-style";break;case cn.Underline:e+=" cursor-underline-style";break;case cn.LineThin:e+=" cursor-line-thin-style";break;case cn.BlockOutline:e+=" cursor-block-outline-style";break;case cn.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let r=0,o=this._secondaryCursors.length;r<o;r++){const a=this._secondaryCursors[r].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};NC.BLINK_INTERVAL=500;let g5=NC;Vh((s,e)=>{const t=[{class:".cursor",foreground:AD,background:x6},{class:".cursor-primary",foreground:MZ,background:cye},{class:".cursor-secondary",foreground:OZ,background:hye}];for(const i of t){const n=s.getColor(i.foreground);if(n){let r=s.getColor(i.background);r||(r=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${r}; }`),T_(s.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});const pR=()=>{throw new Error("Invalid change accessor")};class ISe extends Qs{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._lineHeight=t.get(75),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=bt(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=bt(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l],u=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=u.isInHiddenArea;const d=t.get(l);d&&(d.afterLineNumber!==u.afterViewLineNumber||d.height!==u.heightInPx)&&(n.changeOneWhitespace(l,u.afterViewLineNumber,u.heightInPx),this._safeCallOnComputedHeight(c.delegate,u.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._lineHeight=t.get(75),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(75)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const o=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new Y(o,this._context.viewModel.model.getLineMaxColumn(o))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!r,afterViewLineNumber:n.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const n={addZone:r=>(t=!0,this._addZone(i,r)),removeZone:r=>{r&&(t=this._removeZone(i,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(i,r)||t)}};RSe(e,n),n.addZone=pR,n.removeZone=pR,n.layoutZone=pR}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:bt(t.domNode),marginDomNode:t.marginDomNode?bt(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,i.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){It(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){It(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const o of t)this._zones[o.id].isInHiddenArea||(i[o.id]=o,n=!0);const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l];let u=0,d=0,g="none";i.hasOwnProperty(l)?(u=i[l].verticalOffset-e.bigNumbersDelta,d=i[l].height,g="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(u),c.domNode.setHeight(d),c.domNode.setDisplay(g),c.marginDomNode&&(c.marginDomNode.setTop(u),c.marginDomNode.setHeight(d),c.marginDomNode.setDisplay(g))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function RSe(s,e){try{return s(e)}catch(t){It(t);return}}class ASe extends Sd{constructor(e){super(),this._context=e,this._options=new HU(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new HU(this._context.configuration);return this._options.equals(t)?e.hasChanged(165):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,r=new Array(n);for(let o=0;o<n;o++)r[o]=!0;this._renderResult=[];for(let o=e.viewportData.startLineNumber;o<=e.viewportData.endLineNumber;o++){const a=o-e.viewportData.startLineNumber,l=this._context.viewModel.getViewLineRenderingData(o);let c=null;if(this._options.renderWhitespace==="selection"){const u=this._selection;for(const d of u){if(d.endLineNumber<o||d.startLineNumber>o)continue;const g=d.startLineNumber===o?d.startColumn:l.minColumn,p=d.endLineNumber===o?d.endColumn:l.maxColumn;g<p&&(c||(c=[]),c.push(new Re(g-1,p-1)))}}this._renderResult[a]=this._applyRenderWhitespace(e,o,c,l)}}_applyRenderWhitespace(e,t,i,n){if(n.hasVariableFonts||this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";const r=this._context.theme.getColor(L6),o=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=n.continuesWithWrappedLine,u=n.minColumn-1,d=this._options.renderWhitespace==="boundary",g=this._options.renderWhitespace==="trailing",p=e.getLineHeightForLineNumber(t),_=this._options.middotWidth,C=this._options.wsmiddotWidth,v=this._options.spaceWidth,x=Math.abs(C-v),S=Math.abs(_-v),k=x<S?11825:183,E=this._options.canUseHalfwidthRightwardsArrow;let T="",R=!1,N=Lr(a),A;N===-1?(R=!0,N=l,A=l):A=rm(a);let O=0,W=i&&i[O],j=0;for(let F=u;F<l;F++){const q=a.charCodeAt(F);if(W&&W.endExclusive<=F&&(O++,W=i&&i[O]),q!==9&&q!==32||g&&!R&&F<=A)continue;if(d&&F>=N&&F<=A&&q===32){const K=F-1>=0?a.charCodeAt(F-1):0,U=F+1<l?a.charCodeAt(F+1):0;if(K!==32&&U!==32)continue}if(d&&c&&F===l-1){const K=F-1>=0?a.charCodeAt(F-1):0;if(q===32&&K!==32&&K!==9)continue}if(i&&!(W&&W.start<=F&&F<W.endExclusive))continue;const Z=e.visibleRangeForPosition(new Y(t,F+1));Z&&(o?(j=Math.max(j,Z.left),q===9?T+=this._renderArrow(p,v,Z.left):T+=`<circle cx="${(Z.left+v/2).toFixed(2)}" cy="${(p/2).toFixed(2)}" r="${(v/7).toFixed(2)}" />`):q===9?T+=`<div class="mwh" style="left:${Z.left}px;height:${p}px;">${E?"":""}</div>`:T+=`<div class="mwh" style="left:${Z.left}px;height:${p}px;">${String.fromCharCode(k)}</div>`)}return o?(j=Math.round(j+v),`<svg style="bottom:0;position:absolute;width:${j}px;height:${p}px" viewBox="0 0 ${j} ${p}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+T+"</svg>"):T}_renderArrow(e,t,i){const n=t/7,r=t,o=e/2,a=i,l={x:0,y:n/2},c={x:100/125*r,y:l.y},u={x:c.x-.2*c.x,y:c.y+.2*c.x},d={x:u.x+.1*c.x,y:u.y+.1*c.x},g={x:d.x+.35*c.x,y:d.y-.35*c.x},p={x:g.x,y:-g.y},_={x:d.x,y:-d.y},C={x:u.x,y:-u.y},v={x:c.x,y:-c.y},x={x:l.x,y:-l.y};return`<path d="M ${[l,c,u,d,g,p,_,C,v,x].map(E=>`${(a+E.x).toFixed(2)} ${(o+E.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class HU{constructor(e){const t=e.options,i=t.get(59),n=t.get(47);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(113),this.renderWithSVG=!0):(this.renderWhitespace=t.get(113),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(75),this.stopRenderingLineAfter=t.get(133)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}class MSe{constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new H(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class OSe{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class PSe{constructor(e,t,i){this.configuration=e,this.theme=new OSe(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}const lg=new Float32Array([1,0,1,1,0,1,0,0,0,1,1,0]);function y1(s){if(!s)throw new Error(`Value "${s}" cannot be null`);return s}function YZ(s,e,t){let i=new e.ResizeObserver(n=>{const r=n.find(l=>l.target===s);if(!r)return;if(!("devicePixelContentBoxSize"in r)){i==null||i.disconnect(),i=void 0;return}const o=r.devicePixelContentBoxSize[0].inlineSize,a=r.devicePixelContentBoxSize[0].blockSize;o>0&&a>0&&t(o,a)});try{i.observe(s,{box:["device-pixel-content-box"]})}catch{throw i.disconnect(),i=void 0,new Pe("Could not observe device pixel dimensions")}return Fe(()=>i==null?void 0:i.disconnect())}var FSe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};let BSe=0;class Mk extends ne{get cacheKey(){return`${this.fontFamily}_${this.fontSize}px`}constructor(e,t,i,n){super(),this.fontSize=e,this.fontFamily=t,this.devicePixelRatio=i,this._decorationStyleCache=n,this.id=BSe++,this._workGlyph={source:null,boundingBox:{left:0,bottom:0,right:0,top:0},originOffset:{x:0,y:0},fontBoundingBoxAscent:0,fontBoundingBoxDescent:0},this._workGlyphConfig={chars:void 0,tokenMetadata:0,decorationStyleSetId:0},this._antiAliasing=rt?"greyscale":"subpixel";const r=Math.ceil(this.fontSize*i);this._canvas=new OffscreenCanvas(r*3,r*3),this._ctx=y1(this._canvas.getContext("2d",{willReadFrequently:!0,alpha:this._antiAliasing==="greyscale"})),this._ctx.textBaseline="top",this._ctx.fillStyle="#FFFFFF",this._ctx.font=`${r}px ${this.fontFamily}`,this._textMetrics=this._ctx.measureText("A")}rasterizeGlyph(e,t,i,n){return e===""?{source:this._canvas,boundingBox:{top:0,left:0,bottom:-1,right:-1},originOffset:{x:0,y:0},fontBoundingBoxAscent:0,fontBoundingBoxDescent:0}:this._workGlyphConfig.chars===e&&this._workGlyphConfig.tokenMetadata===t&&this._workGlyphConfig.decorationStyleSetId===i?this._workGlyph:(this._workGlyphConfig.chars=e,this._workGlyphConfig.tokenMetadata=t,this._workGlyphConfig.decorationStyleSetId=i,this._rasterizeGlyph(e,t,i,n))}_rasterizeGlyph(e,t,i,n){const r=Math.ceil(this.fontSize*this.devicePixelRatio),o=r*3;this._canvas.width!==o&&(this._canvas.width=o,this._canvas.height=o),this._ctx.save();const a=(t&15)/10,l=Qr.getBackground(t),c=n[l],u=this._decorationStyleCache.getStyleSet(i);this._antiAliasing==="subpixel"?(this._ctx.fillStyle=c,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)):this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);const d=new z1(200),g=Qr.getFontStyle(t);g&1&&d.appendString("italic "),(u==null?void 0:u.bold)!==void 0?u.bold&&d.appendString("bold "):g&2&&d.appendString("bold "),d.appendString(`${r}px ${this.fontFamily}`),this._ctx.font=d.build();const p=r,_=r;(u==null?void 0:u.color)!==void 0?this._ctx.fillStyle=`#${u.color.toString(16).padStart(8,"0")}`:this._ctx.fillStyle=n[Qr.getForeground(t)],this._ctx.textBaseline="top",(u==null?void 0:u.opacity)!==void 0&&(this._ctx.globalAlpha=u.opacity),this._ctx.fillText(e,p+a,_),this._ctx.restore();const C=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height);if(this._antiAliasing==="subpixel"){const v=parseInt(c.substring(1,3),16),x=parseInt(c.substring(3,5),16),S=parseInt(c.substring(5,7),16);this._clearColor(C,v,x,S),this._ctx.putImageData(C,0,0)}return this._findGlyphBoundingBox(C,this._workGlyph.boundingBox),this._workGlyph.source=this._canvas,this._workGlyph.originOffset.x=this._workGlyph.boundingBox.left-p,this._workGlyph.originOffset.y=this._workGlyph.boundingBox.top-_,this._workGlyph.fontBoundingBoxAscent=this._textMetrics.fontBoundingBoxAscent,this._workGlyph.fontBoundingBoxDescent=this._textMetrics.fontBoundingBoxDescent,this._workGlyph}_clearColor(e,t,i,n){for(let r=0;r<e.data.length;r+=4)e.data[r]===t&&e.data[r+1]===i&&e.data[r+2]===n&&(e.data[r+3]=0)}_findGlyphBoundingBox(e,t){const i=this._canvas.height,n=this._canvas.width;let r=!1;for(let o=0;o<i;o++){for(let a=0;a<n;a++){const l=o*n*4+a*4+3;if(e.data[l]!==0){t.top=o,r=!0;break}}if(r)break}t.left=0,r=!1;for(let o=0;o<n;o++){for(let a=0;a<i;a++){const l=a*n*4+o*4+3;if(e.data[l]!==0){t.left=o,r=!0;break}}if(r)break}t.right=n,r=!1;for(let o=n-1;o>=t.left;o--){for(let a=0;a<i;a++){const l=a*n*4+o*4+3;if(e.data[l]!==0){t.right=o,r=!0;break}}if(r)break}t.bottom=t.top,r=!1;for(let o=i-1;o>=0;o--){for(let a=0;a<n;a++){const l=o*n*4+a*4+3;if(e.data[l]!==0){t.bottom=o,r=!0;break}}if(r)break}}getTextMetrics(e){return this._ctx.measureText(e)}}FSe([Si],Mk.prototype,"cacheKey",null);var VSe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},WSe=function(s,e){return function(t,i){e(t,i,s)}};let Ok=class extends ne{constructor(e){super(),this._logService=e,this._tasks=[],this._i=0,this._register(Fe(()=>this.clear()))}enqueue(e){this._tasks.push(e),this._start()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,n=e.timeRemaining(),r=0;for(;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),i=Math.max(t,i),r=e.timeRemaining(),i*1.5>r){n-t<-20&&this._logService.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),this._start();return}n=r}this.clear()}};Ok=VSe([WSe(0,Ks)],Ok);class HSe extends Ok{_requestCallback(e){return At().setTimeout(()=>e(this._createDeadline(16)))}_cancelCallback(e){At().clearTimeout(e)}_createDeadline(e){const t=Date.now()+e;return{timeRemaining:()=>Math.max(0,t-Date.now())}}}class zSe extends Ok{_requestCallback(e){return At().requestIdleCallback(e)}_cancelCallback(e){At().cancelIdleCallback(e)}}const USe="requestIdleCallback"in At()?zSe:HSe;class jSe{constructor(e,t){this._canvas=e,this._textureIndex=t,this._currentRow={x:0,y:0,h:0},this._allocatedGlyphs=new Set,this._nextIndex=0,this._ctx=y1(this._canvas.getContext("2d",{willReadFrequently:!0}))}allocate(e){const t=e.boundingBox.right-e.boundingBox.left+1,i=e.boundingBox.bottom-e.boundingBox.top+1;if(t>this._canvas.width||i>this._canvas.height)throw new Pe("Glyph is too large for the atlas page");if(e.boundingBox.right-e.boundingBox.left+1>this._canvas.width-this._currentRow.x&&(this._currentRow.x=0,this._currentRow.y+=this._currentRow.h,this._currentRow.h=1),this._currentRow.y+e.boundingBox.bottom-e.boundingBox.top+1>this._canvas.height)return;this._ctx.drawImage(e.source,e.boundingBox.left,e.boundingBox.top,t,i,this._currentRow.x,this._currentRow.y,t,i);const n={pageIndex:this._textureIndex,glyphIndex:this._nextIndex++,x:this._currentRow.x,y:this._currentRow.y,w:t,h:i,originOffsetX:e.originOffset.x,originOffsetY:e.originOffset.y,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent};return this._currentRow.x+=t,this._currentRow.h=Math.max(this._currentRow.h,i),this._allocatedGlyphs.add(n),n}getUsagePreview(){const e=this._canvas.width,t=this._canvas.height,i=new OffscreenCanvas(e,t),n=y1(i.getContext("2d"));n.fillStyle="#808080",n.fillRect(0,0,e,t);const r=new Map,o=new Map;for(const a of this._allocatedGlyphs)r.set(a.y,Math.max(r.get(a.y)??0,a.h)),o.set(a.y,Math.max(o.get(a.y)??0,a.x+a.w));for(const a of this._allocatedGlyphs)n.fillStyle="#4040FF",n.fillRect(a.x,a.y,a.w,a.h),n.fillStyle="#FF0000",n.fillRect(a.x,a.y+a.h,a.w,r.get(a.y)-a.h);for(const[a,l]of o.entries())a!==this._currentRow.y&&(n.fillStyle="#FF0000",n.fillRect(l,a,e-l,r.get(a)));return i.convertToBlob()}getStats(){const e=this._canvas.width,t=this._canvas.height;let i=0,n=0;const r=e*t,o=new Map,a=new Map;for(const l of this._allocatedGlyphs)o.set(l.y,Math.max(o.get(l.y)??0,l.h)),a.set(l.y,Math.max(a.get(l.y)??0,l.x+l.w));for(const l of this._allocatedGlyphs)i+=l.w*l.h,n+=l.w*(o.get(l.y)-l.h);for(const[l,c]of a.entries())l!==this._currentRow.y&&(n+=(e-c)*o.get(l));return[`page${this._textureIndex}:`,`     Total: ${r} (${e}x${t})`,`      Used: ${i} (${(i/r*100).toPrecision(2)}%)`,`    Wasted: ${n} (${(n/r*100).toPrecision(2)}%)`,`Efficiency: ${(i/(i+n)*100).toPrecision(2)}%`].join(`
`)}}class $Se{constructor(e,t,i){this._canvas=e,this._textureIndex=t,this._slabs=[],this._activeSlabsByDims=new pD,this._unusedRects=[],this._openRegionsByHeight=new Map,this._openRegionsByWidth=new Map,this._allocatedGlyphs=new Set,this._nextIndex=0,this._ctx=y1(this._canvas.getContext("2d",{willReadFrequently:!0})),this._slabW=Math.min((i==null?void 0:i.slabW)??64<<Math.max(Math.floor(At().devicePixelRatio)-1,0),this._canvas.width),this._slabH=Math.min((i==null?void 0:i.slabH)??this._slabW,this._canvas.height),this._slabsPerRow=Math.floor(this._canvas.width/this._slabW),this._slabsPerColumn=Math.floor(this._canvas.height/this._slabH)}allocate(e){const t=e.boundingBox.right-e.boundingBox.left+1,i=e.boundingBox.bottom-e.boundingBox.top+1;if(t>this._canvas.width||i>this._canvas.height)throw new Pe("Glyph is too large for the atlas page");if(t>this._slabW||i>this._slabH){if(this._allocatedGlyphs.size>0)return;let c=this._canvas.width;for(;t<c/2&&i<c/2;)c/=2;this._slabW=c,this._slabH=c,this._slabsPerRow=Math.floor(this._canvas.width/this._slabW),this._slabsPerColumn=Math.floor(this._canvas.height/this._slabH)}const n={w:t,h:i};let r=this._activeSlabsByDims.get(n.w,n.h);if(r){const c=Math.floor(this._slabW/r.entryW)*Math.floor(this._slabH/r.entryH);r.count>=c&&(r=void 0)}let o,a;if(!r)if(t<i){const c=this._openRegionsByWidth.get(t);if(c!=null&&c.length)for(let u=c.length-1;u>=0;u--){const d=c[u];if(d.w>=t&&d.h>=i){o=d.x,a=d.y,t<d.w&&this._unusedRects.push({x:d.x+t,y:d.y,w:d.w-t,h:i}),d.y+=i,d.h-=i,d.h===0&&(u===c.length-1?c.pop():this._unusedRects.splice(u,1));break}}}else{const c=this._openRegionsByHeight.get(i);if(c!=null&&c.length)for(let u=c.length-1;u>=0;u--){const d=c[u];if(d.w>=t&&d.h>=i){o=d.x,a=d.y,i<d.h&&this._unusedRects.push({x:d.x,y:d.y+i,w:t,h:d.h-i}),d.x+=t,d.w-=t,d.h===0&&(u===c.length-1?c.pop():this._unusedRects.splice(u,1));break}}}if(o===void 0||a===void 0){if(!r){if(this._slabs.length>=this._slabsPerRow*this._slabsPerColumn)return;r={x:Math.floor(this._slabs.length%this._slabsPerRow)*this._slabW,y:Math.floor(this._slabs.length/this._slabsPerRow)*this._slabH,entryW:n.w,entryH:n.h,count:0};const u=this._slabW%r.entryW,d=this._slabH%r.entryH;u&&zU(this._openRegionsByWidth,u,{x:r.x+this._slabW-u,w:u,y:r.y,h:this._slabH-(d??0)}),d&&zU(this._openRegionsByHeight,d,{x:r.x,w:this._slabW,y:r.y+this._slabH-d,h:d}),this._slabs.push(r),this._activeSlabsByDims.set(r,n.w,n.h)}const c=Math.floor(this._slabW/r.entryW);o=r.x+Math.floor(r.count%c)*r.entryW,a=r.y+Math.floor(r.count/c)*r.entryH,r.count++}this._ctx.drawImage(e.source,e.boundingBox.left,e.boundingBox.top,t,i,o,a,t,i);const l={pageIndex:this._textureIndex,glyphIndex:this._nextIndex++,x:o,y:a,w:t,h:i,originOffsetX:e.originOffset.x,originOffsetY:e.originOffset.y,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent};return this._allocatedGlyphs.add(l),l}getUsagePreview(){const e=this._canvas.width,t=this._canvas.height,i=new OffscreenCanvas(e,t),n=y1(i.getContext("2d"));n.fillStyle="#808080",n.fillRect(0,0,e,t);let r=0,o=0,a=0;const l=64<<Math.floor(At().devicePixelRatio)-1,c=l;for(const d of this._slabs){let g=0,p=0;for(let v=0;v<d.count;v++)g+d.entryW>l&&(g=0,p+=d.entryH),n.fillStyle="#FF0000",n.fillRect(d.x+g,d.y+p,d.entryW,d.entryH),r+=d.entryW*d.entryH,g+=d.entryW;const _=Math.floor(l/d.entryW),C=Math.floor(c/d.entryH);d.entryW*_*d.entryH*C}for(const d of this._allocatedGlyphs)o+=d.w*d.h,n.fillStyle="#4040FF",n.fillRect(d.x,d.y,d.w,d.h);const u=Array.from(this._openRegionsByWidth.values()).flat().concat(Array.from(this._openRegionsByHeight.values()).flat());for(const d of u)n.fillStyle="#FF000088",n.fillRect(d.x,d.y,d.w,d.h),a+=d.w*d.h;return n.globalAlpha=.5,n.drawImage(this._canvas,0,0),n.globalAlpha=1,i.convertToBlob()}getStats(){const e=this._canvas.width,t=this._canvas.height;let i=0,n=0,r=0,o=0,a=0;const l=e*t,c=64<<Math.floor(At().devicePixelRatio)-1,u=c;for(const _ of this._slabs){let C=0,v=0;for(let E=0;E<_.count;E++)C+_.entryW>c&&(C=0,v+=_.entryH),i+=_.entryW*_.entryH,C+=_.entryW;const x=Math.floor(c/_.entryW),S=Math.floor(u/_.entryH),k=_.entryW*x*_.entryH*S;r+=c*u-k}for(const _ of this._allocatedGlyphs)n+=_.w*_.h;const d=Array.from(this._openRegionsByWidth.values()).flat().concat(Array.from(this._openRegionsByHeight.values()).flat());for(const _ of d)a+=_.w*_.h;const g=r-a;o=i-(n-g);const p=n/(n+o+a);return[`page[${this._textureIndex}]:`,`     Total: ${l}px (${e}x${t})`,`      Used: ${n}px (${(n/l*100).toFixed(2)}%)`,`    Wasted: ${o}px (${(o/l*100).toFixed(2)}%)`,`Restricted: ${a}px (${(a/l*100).toFixed(2)}%) (hard to allocate)`,`Efficiency: ${p===1?"100":(p*100).toFixed(2)}%`,`     Slabs: ${this._slabs.length} of ${Math.floor(this._canvas.width/c)*Math.floor(this._canvas.height/u)}`].join(`
`)}}function zU(s,e,t){let i=s.get(e);i||(i=[],s.set(e,i)),i.push(t)}var qSe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},UU=function(s,e){return function(t,i){e(t,i,s)}},m5,mg;let Oa=(mg=class extends ne{get version(){return this._version}get usedArea(){return this._usedArea}get source(){return this._canvas}get glyphs(){return this._glyphInOrderSet.values()}constructor(e,t,i,n,r){switch(super(),this._logService=n,this._version=0,this._usedArea={left:0,top:0,right:0,bottom:0},this._glyphMap=new pD,this._glyphInOrderSet=new Set,this._canvas=new OffscreenCanvas(t,t),this._colorMap=r.getColorTheme().tokenColorMap,i){case"shelf":this._allocator=new jSe(this._canvas,e);break;case"slab":this._allocator=new $Se(this._canvas,e);break;default:this._allocator=i(this._canvas,e);break}this._register(Fe(()=>{this._canvas.width=1,this._canvas.height=1}))}getGlyph(e,t,i,n){return this._glyphMap.get(t,i,n,e.cacheKey)??this._createGlyph(e,t,i,n)}_createGlyph(e,t,i,n){if(this._glyphInOrderSet.size>=m5.maximumGlyphCount)return;const r=e.rasterizeGlyph(t,i,n,this._colorMap),o=this._allocator.allocate(r);if(o!==void 0)return this._glyphMap.set(o,t,i,n,e.cacheKey),this._glyphInOrderSet.add(o),this._version++,this._usedArea.right=Math.max(this._usedArea.right,o.x+o.w-1),this._usedArea.bottom=Math.max(this._usedArea.bottom,o.y+o.h-1),this._logService.getLevel()===yn.Trace&&this._logService.trace("New glyph",{chars:t,tokenMetadata:i,decorationStyleSetId:n,rasterizedGlyph:r,glyph:o}),o}getUsagePreview(){return this._allocator.getUsagePreview()}getStats(){return this._allocator.getStats()}},m5=mg,mg.maximumGlyphCount=5e3,mg);Oa=m5=qSe([UU(3,Ks),UU(4,Ir)],Oa);var GSe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},jU=function(s,e){return function(t,i){e(t,i,s)}},qx,pg;let Bu=(pg=class extends ne{get pages(){return this._pages}constructor(e,t,i,n,r){super(),this._maxTextureSize=e,this._decorationStyleCache=i,this._themeService=n,this._instantiationService=r,this._warmUpTask=this._register(new kn),this._warmedUpRasterizers=new Set,this._pages=[],this._glyphPageIndex=new pD,this._onDidDeleteGlyphs=this._register(new $),this.onDidDeleteGlyphs=this._onDidDeleteGlyphs.event,this._allocatorType=(t==null?void 0:t.allocatorType)??"slab",this._register(ge.runAndSubscribe(this._themeService.onDidColorThemeChange,()=>{this._colorMap&&this.clear(),this._colorMap=this._themeService.getColorTheme().tokenColorMap}));const o=Math.max(1,Math.floor(At().devicePixelRatio));this.pageSize=Math.min(1024*o,this._maxTextureSize),this._initFirstPage(),this._register(Fe(()=>Zi(this._pages)))}_initFirstPage(){const e=this._instantiationService.createInstance(Oa,0,this.pageSize,this._allocatorType);this._pages.push(e);const t=new Mk(1,"",1,this._decorationStyleCache);e.getGlyph(t,"",0,0),t.dispose()}clear(){for(const e of this._pages)e.dispose();this._pages.length=0,this._glyphPageIndex.clear(),this._warmedUpRasterizers.clear(),this._warmUpTask.clear(),this._initFirstPage(),this._onDidDeleteGlyphs.fire()}getGlyph(e,t,i,n,r){return i&=-2048,i|=Math.floor(r%1*10),this._warmedUpRasterizers.has(e.id)||(this._warmUpAtlas(e),this._warmedUpRasterizers.add(e.id)),this._tryGetGlyph(this._glyphPageIndex.get(t,i,n,e.cacheKey)??0,e,t,i,n)}_tryGetGlyph(e,t,i,n,r){return this._glyphPageIndex.set(e,i,n,r,t.cacheKey),this._pages[e].getGlyph(t,i,n,r)??(e+1<this._pages.length?this._tryGetGlyph(e+1,t,i,n,r):void 0)??this._getGlyphFromNewPage(t,i,n,r)}_getGlyphFromNewPage(e,t,i,n){if(this._pages.length>=qx.maximumPageCount)throw new Error(`Attempt to create a texture atlas page past the limit ${qx.maximumPageCount}`);return this._pages.push(this._instantiationService.createInstance(Oa,this._pages.length,this.pageSize,this._allocatorType)),this._glyphPageIndex.set(this._pages.length-1,t,i,n,e.cacheKey),this._pages[this._pages.length-1].getGlyph(e,t,i,n)}getStats(){return this._pages.map(e=>e.getStats())}_warmUpAtlas(e){var n;const t=this._colorMap;if(!t)throw new Pe("Cannot warm atlas without color map");(n=this._warmUpTask.value)==null||n.clear();const i=this._warmUpTask.value=this._instantiationService.createInstance(USe);for(let r=65;r<=90;r++)for(const o of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(r),o<<15&16744448,0,a)});for(let r=97;r<=122;r++)for(const o of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(r),o<<15&16744448,0,a)});for(let r=33;r<=126;r++)for(const o of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(r),o<<15&16744448,0,a)})}},qx=pg,pg.maximumPageCount=16,pg);Bu=qx=GSe([jU(3,Ir),jU(4,wt)],Bu);var Bw;(function(s){s[s.Ignore=0]="Ignore",s[s.Info=1]="Info",s[s.Warning=2]="Warning",s[s.Error=3]="Error"})(Bw||(Bw={}));(function(s){const e="error",t="warning",i="warn",n="info",r="ignore";function o(l){return l?zf(e,l)?s.Error:zf(t,l)||zf(i,l)?s.Warning:zf(n,l)?s.Info:s.Ignore:s.Ignore}s.fromValue=o;function a(l){switch(l){case s.Error:return e;case s.Warning:return t;case s.Info:return n;default:return r}}s.toString=a})(Bw||(Bw={}));var Fi=Bw,QZ=Fi;const _a=tt("notificationService");class KSe{}var nr;(function(s){async function e(n){try{if(!navigator.gpu)throw new Error("This browser does not support WebGPU");const r=await navigator.gpu.requestAdapter();if(!r)throw new Error("This browser supports WebGPU but it appears to be disabled");return _R(await r.requestDevice())}catch(r){throw n&&n(r.message),r}}s.requestDevice=e;function t(n,r,o){const a=n.createBuffer(r);return o&&n.queue.writeBuffer(a,0,o1(o)?o():o),_R(a)}s.createBuffer=t;function i(n,r){return _R(n.createTexture(r))}s.createTexture=i})(nr||(nr={}));function _R(s){return{object:s,dispose:()=>s.destroy()}}class YSe{get dataOffset(){return this._startIndex}get dirtySize(){if(!(this._startIndex===void 0||this._endIndex===void 0))return this._endIndex-this._startIndex+1}get isDirty(){return this._startIndex!==void 0}flag(e,t=1){return this._flag(e),t>1&&this._flag(e+t-1),e}_flag(e){(this._startIndex===void 0||e<this._startIndex)&&(this._startIndex=e),(this._endIndex===void 0||e>this._endIndex)&&(this._endIndex=e)}clear(){this._startIndex=void 0,this._endIndex=void 0}}function QSe(s,e){return new XSe(s,e)}class XSe extends ne{get entryCount(){return this._entries.size}get dirtyTracker(){return this._dirtyTracker}constructor(e,t){super(),this.propertySpecs=e,this.capacity=t,this._dirtyTracker=new YSe,this._propertySpecsMap=new Map,this._entries=new sr,this._onDidChange=this._register(new $),this._onDidChangeBuffer=this._register(new $),this.onDidChangeBuffer=this._onDidChangeBuffer.event,this.view=new Float32Array(t*e.length),this.buffer=this.view.buffer,this._entrySize=e.length;for(let i=0;i<e.length;i++){const n={offset:i,...e[i]};this._propertySpecsMap.set(n.name,n)}this._register(Fe(()=>Zi(this._entries)))}createEntry(e){this._entries.size===this.capacity&&(this._expandBuffer(),this._onDidChangeBuffer.fire());const t=new ZSe(this.view,this._propertySpecsMap,this._dirtyTracker,this._entries.size,e),i=this._entries.push(t),n=[];return n.push(ge.forward(t.onDidChange,this._onDidChange)),n.push(t.onWillDispose(()=>{const r=t.i;i(),this.view.set(this.view.subarray(r*this._entrySize+2,this._entries.size*this._entrySize+2),r*this._entrySize);for(const o of this._entries)o.i>r&&o.i--;this._dirtyTracker.flag(r,(this._entries.size-r)*this._entrySize),Zi(n)})),t}_expandBuffer(){this.capacity*=2;const e=new Float32Array(this.capacity*this._entrySize);e.set(this.view),this.view=e,this.buffer=this.view.buffer}}class ZSe extends ne{constructor(e,t,i,n,r){super(),this._view=e,this._propertySpecsMap=t,this._dirtyTracker=i,this.i=n,this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this._onWillDispose=this._register(new $),this.onWillDispose=this._onWillDispose.event;for(const o of this._propertySpecsMap.values())this._view[this.i*this._propertySpecsMap.size+o.offset]=r[o.name];this._dirtyTracker.flag(this.i*this._propertySpecsMap.size,this._propertySpecsMap.size)}dispose(){this._onWillDispose.fire(),super.dispose()}setRaw(e){if(e.length!==this._propertySpecsMap.size)throw new Error(`Data length ${e.length} does not match the number of properties in the collection (${this._propertySpecsMap.size})`);this._view.set(e,this.i*this._propertySpecsMap.size),this._dirtyTracker.flag(this.i*this._propertySpecsMap.size,this._propertySpecsMap.size)}}const JSe=`

struct Vertex {
	@location(0) position: vec2f,
};

struct LayoutInfo {
	canvasDims: vec2f,
	viewportOffset: vec2f,
	viewportDims: vec2f,
}

struct ScrollOffset {
	offset: vec2f,
}

struct Shape {
	position: vec2f,
	size: vec2f,
	color: vec4f,
};

struct VSOutput {
	@builtin(position) position: vec4f,
	@location(1)       color:    vec4f,
};

// Uniforms
@group(0) @binding(1) var<uniform>       layoutInfo:      LayoutInfo;

// Storage buffers
@group(0) @binding(0)            var<storage, read> shapes:          array<Shape>;
@group(0) @binding(2)      var<uniform>       scrollOffset:    ScrollOffset;

@vertex fn vs(
	vert: Vertex,
	@builtin(instance_index) instanceIndex: u32,
	@builtin(vertex_index) vertexIndex : u32
) -> VSOutput {
	let shape = shapes[instanceIndex];

	var vsOut: VSOutput;
	vsOut.position = vec4f(
		(
			// Top left corner
			vec2f(-1,  1) +
			// Convert pixel position to clipspace
			vec2f( 2, -2) / layoutInfo.canvasDims *
			// Shape position and size
			(layoutInfo.viewportOffset - scrollOffset.offset + shape.position + vert.position * shape.size)
		),
		0.0,
		1.0
	);
	vsOut.color = shape.color;
	return vsOut;
}

@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {
	return vsOut.color;
}
`;class exe extends fm{constructor(e,t,i,n,r,o){super(),this._context=e,this._contentLeft=t,this._devicePixelRatio=i,this._canvas=n,this._ctx=r,this._shapeBindBuffer=this._register(new kn),this._initialized=!1,this._shapeCollection=this._register(QSe([{name:"x"},{name:"y"},{name:"width"},{name:"height"},{name:"red"},{name:"green"},{name:"blue"},{name:"alpha"}],32)),this._context.addEventHandler(this),this._initWebgpu(o)}async _initWebgpu(e){if(this._device=await e,this._store.isDisposed)return;const t=navigator.gpu.getPreferredCanvasFormat();this._ctx.configure({device:this._device,format:t,alphaMode:"premultiplied"}),this._renderPassColorAttachment={view:null,loadOp:"load",storeOp:"store"},this._renderPassDescriptor={label:"Monaco rectangle renderer render pass",colorAttachments:[this._renderPassColorAttachment]};let i;{const a=new Float32Array(6),l=(c=this._canvas.width,u=this._canvas.height)=>(a[0]=c,a[1]=u,a[2]=Math.ceil(this._context.configuration.options.get(165).contentLeft*At().devicePixelRatio),a[3]=0,a[4]=a[0]-a[2],a[5]=a[1]-a[3],a);i=this._register(nr.createBuffer(this._device,{label:"Monaco rectangle renderer uniform buffer",size:24,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>l())).object,this._register(YZ(this._canvas,At(),(c,u)=>{this._device.queue.writeBuffer(i,0,l(c,u))}))}const n=2;this._scrollOffsetBindBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco rectangle renderer scroll offset buffer",size:n*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(n);const r=()=>nr.createBuffer(this._device,{label:"Monaco rectangle renderer shape buffer",size:this._shapeCollection.buffer.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});this._shapeBindBuffer.value=r(),this._register(ge.runAndSubscribe(this._shapeCollection.onDidChangeBuffer,()=>{this._shapeBindBuffer.value=r(),this._pipeline&&this._updateBindGroup(this._pipeline,i)})),this._vertexBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco rectangle renderer vertex buffer",size:lg.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST},lg)).object;const o=this._device.createShaderModule({label:"Monaco rectangle renderer shader module",code:JSe});this._pipeline=this._device.createRenderPipeline({label:"Monaco rectangle renderer render pipeline",layout:"auto",vertex:{module:o,buffers:[{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]}]},fragment:{module:o,targets:[{format:t,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"}}}]}}),this._updateBindGroup(this._pipeline,i),this._initialized=!0}_updateBindGroup(e,t){this._bindGroup=this._device.createBindGroup({label:"Monaco rectangle renderer bind group",layout:e.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._shapeBindBuffer.value.object}},{binding:1,resource:{buffer:t}},{binding:2,resource:{buffer:this._scrollOffsetBindBuffer}}]})}register(e,t,i,n,r,o,a,l){return this._shapeCollection.createEntry({x:e,y:t,width:i,height:n,red:r,green:o,blue:a,alpha:l})}onScrollChanged(e){if(this._device){const t=At().devicePixelRatio;this._scrollOffsetValueBuffer[0]=this._context.viewLayout.getCurrentScrollLeft()*t,this._scrollOffsetValueBuffer[1]=this._context.viewLayout.getCurrentScrollTop()*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer)}return!0}_update(){if(!this._device)return;const e=this._shapeCollection;e.dirtyTracker.isDirty&&(this._device.queue.writeBuffer(this._shapeBindBuffer.value.object,0,e.buffer,e.dirtyTracker.dataOffset,e.dirtyTracker.dirtySize*e.view.BYTES_PER_ELEMENT),e.dirtyTracker.clear())}draw(e){if(!this._initialized)return;this._update();const t=this._device.createCommandEncoder({label:"Monaco rectangle renderer command encoder"});this._renderPassColorAttachment.view=this._ctx.getCurrentTexture().createView();const i=t.beginRenderPass(this._renderPassDescriptor);i.setPipeline(this._pipeline),i.setVertexBuffer(0,this._vertexBuffer),i.setBindGroup(0,this._bindGroup);const n=Math.ceil(this._contentLeft.get()*this._devicePixelRatio.get());i.setScissorRect(n,0,this._canvas.width-n,this._canvas.height),i.draw(lg.length/2,this._shapeCollection.entryCount),i.end();const r=t.finish();this._device.queue.submit([r])}}class txe extends ne{constructor(){super(),this._ruleCache=new Map,this._container=Ve("div.monaco-decoration-css-rule-extractor"),this._dummyElement=Ve("span"),this._container.appendChild(this._dummyElement),this._register(Fe(()=>this._container.remove()))}getStyleRules(e,t){const i=this._ruleCache.get(t);if(i)return i;this._dummyElement.className=t,e.appendChild(this._container);const n=this._getStyleRules(t);return this._ruleCache.set(t,n),e.removeChild(this._container),n}_getStyleRules(e){const t=[],n=[...sD().styleSheets];for(let r=0;r<n.length;r++){const o=n[r];for(const a of o.cssRules)if(a instanceof CSSImportRule)a.styleSheet&&n.push(a.styleSheet);else if(a instanceof CSSStyleRule){const l=`.${e}`,c=a.selectorText.indexOf(l);if(c!==-1){const u=c+l.length;(a.selectorText.length===u||a.selectorText.substring(u,u+1).match(/[ :]/))&&t.push(a)}}}return t}}class ixe{constructor(){this._nextId=1,this._cacheById=new Map,this._cacheByStyle=new pD}getOrCreateEntry(e,t,i){if(e===void 0&&t===void 0&&i===void 0)return 0;const n=this._cacheByStyle.get(e??0,t?1:0,i===void 0?"":i.toFixed(2));if(n)return n.id;const r=this._nextId++,o={id:r,color:e,bold:t,opacity:i};return this._cacheById.set(r,o),this._cacheByStyle.set(o,e??0,t?1:0,i===void 0?"":i.toFixed(2)),r}getStyleSet(e){if(e!==0)return this._cacheById.get(e)}}function Q0(s,e){let t,i=!0;return Dpe({changeTracker:{createChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(n,r)=>{if(n.didChange(s)){const o=n.change;o!==void 0&&r.deltas.push(o),r.didChange=!0}return!0}}},(n,r)=>{const o=s.read(n),a=t;r.didChange&&(t=o,e(o,a,r.deltas)),i&&(i=!1,t=o)})}var nxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},bR=function(s,e){return function(t,i){e(t,i,s)}},Rs,td;let No=(td=class extends ne{static get decorationCssRuleExtractor(){return Rs._decorationCssRuleExtractor}static get decorationStyleCache(){return Rs._decorationStyleCache}static get atlas(){if(!Rs._atlas)throw new Pe("Cannot call ViewGpuContext.textureAtlas before device is resolved");return Rs._atlas}get atlas(){return Rs.atlas}constructor(e,t,i,n){super(),this._instantiationService=t,this._notificationService=i,this.configurationService=n,this.maxGpuCols=2e3,this.canvas=bt(document.createElement("canvas")),this.canvas.setClassName("editorCanvas"),this._register(ge.runAndSubscribe(n.onDidChangeConfiguration,l=>{var c;if(!l||l.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")){const u=((c=n.getValue("editor").scrollbar)==null?void 0:c.verticalScrollbarSize)??14;this.canvas.domNode.style.boxSizing="border-box",this.canvas.domNode.style.paddingRight=`${u}px`}})),this.ctx=y1(this.canvas.domNode.getContext("webgpu")),Rs.device||(Rs.device=nr.requestDevice(l=>{const c=[{label:w(78,"Use DOM-based rendering"),run:()=>this.configurationService.updateValue("editor.experimentalGpuAcceleration","off")}];this._notificationService.prompt(QZ.Warning,l,c)}).then(l=>(Rs.deviceSync=l.object,Rs._atlas||(Rs._atlas=this._instantiationService.createInstance(Bu,l.object.limits.maxTextureDimension2D,void 0,Rs.decorationStyleCache)),l.object)));const r=Qe(this,At().devicePixelRatio);this._register(J(At(),"resize",()=>{r.set(At().devicePixelRatio,void 0)})),this.devicePixelRatio=r,this._register(Q0(this.devicePixelRatio,()=>{var l;return(l=Rs.atlas)==null?void 0:l.clear()}));const o=Qe(this,{width:this.canvas.domNode.width,height:this.canvas.domNode.height});this._register(YZ(this.canvas.domNode,At(),(l,c)=>{this.canvas.domNode.width=l,this.canvas.domNode.height=c,o.set({width:l,height:c},void 0)})),this.canvasDevicePixelDimensions=o;const a=Qe(this,0);this._register(this.configurationService.onDidChangeConfiguration(l=>{a.set(e.configuration.options.get(165).contentLeft,void 0)})),this.contentLeft=a,this.rectangleRenderer=this._instantiationService.createInstance(exe,e,this.contentLeft,this.devicePixelRatio,this.canvas.domNode,this.ctx,Rs.device)}canRender(e,t,i){const n=t.getViewLineRenderingData(i);if(n.containsRTL||n.maxColumn>this.maxGpuCols)return!1;if(n.inlineDecorations.length>0){let r=!0;for(const o of n.inlineDecorations){if(o.type!==0){r=!1;break}const a=Rs._decorationCssRuleExtractor.getStyleRules(this.canvas.domNode,o.inlineClassName);if(r&&(r=a.every(l=>{if(l.selectorText.includes(":"))return!1;for(const c of l.style)if(!$U(c,l.style))return!1;return!0})),!r)break}return r}return!0}canRenderDetailed(e,t,i){const n=t.getViewLineRenderingData(i),r=[];if(n.containsRTL&&r.push("containsRTL"),n.maxColumn>this.maxGpuCols&&r.push("maxColumn > maxGpuCols"),n.inlineDecorations.length>0){let o=!0;const a=[],l=[],c=[];for(const u of n.inlineDecorations){if(u.type!==0){a.push(u.type),o=!1;continue}const d=Rs._decorationCssRuleExtractor.getStyleRules(this.canvas.domNode,u.inlineClassName);o&&(o=d.every(g=>{if(g.selectorText.includes(":"))return l.push(g.selectorText),!1;for(const p of g.style)if(!$U(p,g.style))return c.push(`${p}: ${g.style[p]}`),!1;return!0}))}a.length>0&&r.push(`inlineDecorations with unsupported types (${a.map(u=>`\`${u}\``).join(", ")})`),c.length>0&&r.push(`inlineDecorations with unsupported CSS rules (${c.map(u=>`\`${u}\``).join(", ")})`),l.length>0&&r.push(`inlineDecorations with unsupported CSS selectors (${l.map(u=>`\`${u}\``).join(", ")})`)}return r}},Rs=td,td._decorationCssRuleExtractor=new txe,td._decorationStyleCache=new ixe,td);No=Rs=nxe([bR(1,wt),bR(2,_a),bR(3,ai)],No);const sxe=["color","font-weight","opacity"];function $U(s,e){return!!sxe.includes(s)}function Pk(s,e){return s.isBasicASCII&&e.useMonospaceOptimizations?new rxe(s):new oxe(s)}class rxe{constructor(e){this._content=e.content}getSegmentAtIndex(e){return this._content[e]}}class oxe{constructor(e){this._segments=[];const t=e.content,i=Vv.Segmenter(void 0,{granularity:"grapheme"}).value,n=Array.from(i.segment(t));let r=0;for(let o=0;o<t.length;o++){const a=n[r];if(!a)break;if(a.index!==o){this._segments.push(void 0);continue}r++,this._segments.push(a)}}getSegmentAtIndex(e){var t;return(t=this._segments[e])==null?void 0:t.segment}}class XZ extends fm{get glyphRasterizer(){return this._glyphRasterizer.value}constructor(e,t,i,n){super(),this._context=e,this._viewGpuContext=t,this._device=i,this._glyphRasterizer=n,this._context.addEventHandler(this)}}const ZZ=`
struct GlyphInfo {
	position: vec2f,
	size: vec2f,
	origin: vec2f,
};

struct Vertex {
	@location(0) position: vec2f,
};

struct Cell {
	position: vec2f,
	unused1: vec2f,
	glyphIndex: f32,
	textureIndex: f32
};

struct LayoutInfo {
	canvasDims: vec2f,
	viewportOffset: vec2f,
	viewportDims: vec2f,
}

struct ScrollOffset {
	offset: vec2f
}

struct VSOutput {
	@builtin(position) position:   vec4f,
	@location(1)       layerIndex: f32,
	@location(0)       texcoord:   vec2f,
};

// Uniforms
@group(0) @binding(4)       var<uniform>       layoutInfo:      LayoutInfo;
@group(0) @binding(5)  var<uniform>       atlasDims:       vec2f;
@group(0) @binding(6)            var<uniform>       scrollOffset:    ScrollOffset;

// Storage buffers
@group(0) @binding(0)               var<storage, read> glyphInfo:       array<array<GlyphInfo, ${Oa.maximumGlyphCount}>, ${Bu.maximumPageCount}>;
@group(0) @binding(1)                   var<storage, read> cells:           array<Cell>;

@vertex fn vs(
	vert: Vertex,
	@builtin(instance_index) instanceIndex: u32,
	@builtin(vertex_index) vertexIndex : u32
) -> VSOutput {
	let cell = cells[instanceIndex];
	var glyph = glyphInfo[u32(cell.textureIndex)][u32(cell.glyphIndex)];

	var vsOut: VSOutput;
	// Multiple vert.position by 2,-2 to get it into clipspace which ranged from -1 to 1
	vsOut.position = vec4f(
		// Make everything relative to top left instead of center
		vec2f(-1, 1) +
		((vert.position * vec2f(2, -2)) / layoutInfo.canvasDims) * glyph.size +
		((cell.position * vec2f(2, -2)) / layoutInfo.canvasDims) +
		((glyph.origin * vec2f(2, -2)) / layoutInfo.canvasDims) +
		(((layoutInfo.viewportOffset - scrollOffset.offset * vec2(1, -1)) * 2) / layoutInfo.canvasDims),
		0.0,
		1.0
	);

	vsOut.layerIndex = cell.textureIndex;
	// Textures are flipped from natural direction on the y-axis, so flip it back
	vsOut.texcoord = vert.position;
	vsOut.texcoord = (
		// Glyph offset (0-1)
		(glyph.position / atlasDims) +
		// Glyph coordinate (0-1)
		(vsOut.texcoord * (glyph.size / atlasDims))
	);

	return vsOut;
}

@group(0) @binding(2) var ourSampler: sampler;
@group(0) @binding(3)        var ourTexture: texture_2d_array<f32>;

@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {
	return textureSample(ourTexture, ourSampler, vsOut.texcoord, u32(vsOut.layerIndex));
}
`,Sl=class Sl extends XZ{get bindGroupEntries(){return[{binding:1,resource:{buffer:this._cellBindBuffer}},{binding:6,resource:{buffer:this._scrollOffsetBindBuffer}}]}constructor(e,t,i,n){super(e,t,i,n),this.type="viewport",this.wgsl=ZZ,this._cellBindBufferLineCapacity=63,this._activeDoubleBufferIndex=0,this._visibleObjectCount=0,this._scrollInitialized=!1,this._onDidChangeBindGroupEntries=this._register(new $),this.onDidChangeBindGroupEntries=this._onDidChangeBindGroupEntries.event,this._rebuildCellBuffer(this._cellBindBufferLineCapacity);const r=2;this._scrollOffsetBindBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco scroll offset buffer",size:r*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(r)}_rebuildCellBuffer(e){var n;(n=this._cellBindBuffer)==null||n.destroy();const t=(Math.floor(e/32)+1)*32,i=t*Sl.maxSupportedColumns*6*Float32Array.BYTES_PER_ELEMENT;this._cellBindBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco full file cell buffer",size:i,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._cellValueBuffers=[new ArrayBuffer(i),new ArrayBuffer(i)],this._cellBindBufferLineCapacity=t,this._onDidChangeBindGroupEntries.fire()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onTokensChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onLinesChanged(e){return!0}onScrollChanged(e){const t=At().devicePixelRatio;return this._scrollOffsetValueBuffer[0]=((e==null?void 0:e.scrollLeft)??this._context.viewLayout.getCurrentScrollLeft())*t,this._scrollOffsetValueBuffer[1]=((e==null?void 0:e.scrollTop)??this._context.viewLayout.getCurrentScrollTop())*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer),!0}onThemeChanged(e){return!0}onLineMappingChanged(e){return!0}onZonesChanged(e){return!0}reset(){for(const e of[0,1]){const t=new Float32Array(this._cellValueBuffers[e]);t.fill(0,0,t.length),this._device.queue.writeBuffer(this._cellBindBuffer,0,t.buffer,0,t.byteLength)}}update(e,t){var q;let i="",n,r=0,o=0,a=0,l=0,c=0,u=0,d,g=0,p=0,_=0,C=0,v,x,S,k,E,T=0,R=0,N;const A=At().devicePixelRatio;let O;this._scrollInitialized||(this.onScrollChanged(),this._scrollInitialized=!0),this._cellBindBufferLineCapacity<e.endLineNumber-e.startLineNumber+1&&this._rebuildCellBuffer(e.endLineNumber-e.startLineNumber+1);const W=new Float32Array(this._cellValueBuffers[this._activeDoubleBufferIndex]);W.fill(0);const j=Sl.maxSupportedColumns*6;for(o=e.startLineNumber;o<=e.endLineNumber;o++)if(this._viewGpuContext.canRender(t,e,o)){k=e.getViewLineRenderingData(o),u=0,O=Pk(k,t),r=t.spaceWidth*A,l=0,N=k.tokens,p=k.minColumn-1,_=0;for(let Z=0,K=N.getCount();Z<K;Z++)if(_=N.getEndOffset(Z),!(_<=p)){for(C=N.getMetadata(Z),a=p;a<_&&!(a>Sl.maxSupportedColumns);a++){if(n=O.getSegmentAtIndex(a),n===void 0)continue;i=n,k.isBasicASCII&&t.useMonospaceOptimizations||(r=this.glyphRasterizer.getTextMetrics(i).width),x=void 0,v=void 0,S=void 0;for(E of k.inlineDecorations){if(o<E.range.startLineNumber||o>E.range.endLineNumber||o===E.range.startLineNumber&&a<E.range.startColumn-1||o===E.range.endLineNumber&&a>=E.range.endColumn-1)continue;const G=No.decorationCssRuleExtractor.getStyleRules(this._viewGpuContext.canvas.domNode,E.inlineClassName);for(const Q of G)for(const le of Q.style){const ve=((q=Q.styleMap.get(le))==null?void 0:q.toString())??"";switch(le){case"color":{const V=ae.Format.CSS.parse(ve);if(!V)throw new Pe("Invalid color format "+ve);x=V.toNumber32Bit();break}case"font-weight":{axe(ve)>=400?v=!0:v=!1;break}case"opacity":{S=lxe(ve);break}default:throw new Pe("Unexpected inline decoration style")}}}if(i===" "||i==="	"){if(g=((o-1)*Sl.maxSupportedColumns+a)*6,W.fill(0,g,g+6),i==="	"){const G=a+u;u=_i.nextRenderTabStop(a+u,k.tabSize),l+=r*(u-G),u-=a+1}else l+=r;continue}const U=No.decorationStyleCache.getOrCreateEntry(x,v,S);d=this._viewGpuContext.atlas.getGlyph(this.glyphRasterizer,i,C,U,l),c=Math.round(e.relativeVerticalOffset[o-e.startLineNumber]*A+Math.floor((e.lineHeight*A-(d.fontBoundingBoxAscent+d.fontBoundingBoxDescent))/2)+d.fontBoundingBoxAscent),g=((o-e.startLineNumber)*Sl.maxSupportedColumns+a)*6,W[g+0]=Math.floor(l),W[g+1]=c,W[g+4]=d.glyphIndex,W[g+5]=d.pageIndex,l+=r}p=_}T=((o-e.startLineNumber)*Sl.maxSupportedColumns+_)*6,R=(o-e.startLineNumber)*Sl.maxSupportedColumns*6,W.fill(0,T,R)}const F=(e.endLineNumber-e.startLineNumber+1)*j;return this._device.queue.writeBuffer(this._cellBindBuffer,0,W.buffer,0,(e.endLineNumber-e.startLineNumber)*j*Float32Array.BYTES_PER_ELEMENT),this._activeDoubleBufferIndex=this._activeDoubleBufferIndex?0:1,this._visibleObjectCount=F,F}draw(e,t){if(this._visibleObjectCount<=0)throw new Pe("Attempt to draw 0 objects");e.draw(lg.length/2,this._visibleObjectCount)}};Sl.maxSupportedColumns=2e3;let p5=Sl;function axe(s){switch(s){case"lighter":case"normal":return 400;case"bolder":case"bold":return 700}return parseInt(s)}function lxe(s){return s.endsWith("%")?parseFloat(s.substring(0,s.length-1))/100:s.match(/^\d+(?:\.\d*)/)?parseFloat(s):1}const Gn=class Gn extends XZ{get bindGroupEntries(){return[{binding:1,resource:{buffer:this._cellBindBuffer}},{binding:6,resource:{buffer:this._scrollOffsetBindBuffer}}]}constructor(e,t,i,n){super(e,t,i,n),this.type="fullfile",this.wgsl=ZZ,this._activeDoubleBufferIndex=0,this._upToDateLines=[new Set,new Set],this._visibleObjectCount=0,this._finalRenderedLine=0,this._scrollInitialized=!1,this._queuedBufferUpdates=[[],[]];const r=Gn.maxSupportedLines*Gn.maxSupportedColumns*6*Float32Array.BYTES_PER_ELEMENT;this._cellBindBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco full file cell buffer",size:r,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._cellValueBuffers=[new ArrayBuffer(r),new ArrayBuffer(r)];const o=2;this._scrollOffsetBindBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco scroll offset buffer",size:o*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(o)}onConfigurationChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}onDecorationsChanged(e){return this._invalidateAllLines(),!0}onTokensChanged(e){for(const t of e.ranges)this._invalidateLineRange(t.fromLineNumber,t.toLineNumber);return!0}onLinesDeleted(e){return this._invalidateLinesFrom(e.fromLineNumber),this._queueBufferUpdate(e),!0}onLinesInserted(e){return this._invalidateLinesFrom(e.fromLineNumber),!0}onLinesChanged(e){return this._invalidateLineRange(e.fromLineNumber,e.fromLineNumber+e.count),!0}onScrollChanged(e){const t=At().devicePixelRatio;return this._scrollOffsetValueBuffer[0]=((e==null?void 0:e.scrollLeft)??this._context.viewLayout.getCurrentScrollLeft())*t,this._scrollOffsetValueBuffer[1]=((e==null?void 0:e.scrollTop)??this._context.viewLayout.getCurrentScrollTop())*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer),!0}onThemeChanged(e){return this._invalidateAllLines(),!0}onLineMappingChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}onZonesChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}_invalidateAllLines(){this._upToDateLines[0].clear(),this._upToDateLines[1].clear()}_invalidateLinesFrom(e){for(const t of[0,1]){const i=this._upToDateLines[t];for(const n of i)n>=e&&i.delete(n)}}_invalidateLineRange(e,t){for(let i=e;i<=t;i++)this._upToDateLines[0].delete(i),this._upToDateLines[1].delete(i)}reset(){this._invalidateAllLines();for(const e of[0,1]){const t=new Float32Array(this._cellValueBuffers[e]);t.fill(0,0,t.length),this._device.queue.writeBuffer(this._cellBindBuffer,0,t.buffer,0,t.byteLength)}this._finalRenderedLine=0}update(e,t){var G;let i="",n,r=0,o=0,a=0,l=0,c=0,u=0,d,g=0,p=0,_=0,C=0,v,x,S,k,E,T=0,R=0,N;const A=At().devicePixelRatio;let O;this._scrollInitialized||(this.onScrollChanged(),this._scrollInitialized=!0);const W=new Float32Array(this._cellValueBuffers[this._activeDoubleBufferIndex]),j=Gn.maxSupportedColumns*6,F=this._upToDateLines[this._activeDoubleBufferIndex];let q=3e3,Z=0;const K=this._queuedBufferUpdates[this._activeDoubleBufferIndex];for(;K.length;){const Q=K.shift();switch(Q.type){case 2:case 8:case 17:{W.fill(0),q=1,Z=Math.max(Z,this._finalRenderedLine),this._finalRenderedLine=0;break}case 10:{const le=(Q.fromLineNumber-1)*Gn.maxSupportedColumns*6,ve=Q.toLineNumber*Gn.maxSupportedColumns*6,V=(this._finalRenderedLine-(Q.toLineNumber-Q.fromLineNumber+1))*Gn.maxSupportedColumns*6;W.set(W.subarray(ve),le),W.fill(0,V),q=Math.min(q,Q.fromLineNumber),Z=Math.max(Z,this._finalRenderedLine),this._finalRenderedLine-=Q.toLineNumber-Q.fromLineNumber+1;break}}}for(o=e.startLineNumber;o<=e.endLineNumber;o++){if(!this._viewGpuContext.canRender(t,e,o)){T=(o-1)*Gn.maxSupportedColumns*6,R=o*Gn.maxSupportedColumns*6,W.fill(0,T,R),q=Math.min(q,o),Z=Math.max(Z,o);continue}if(!F.has(o)){q=Math.min(q,o),Z=Math.max(Z,o),k=e.getViewLineRenderingData(o),u=0,O=Pk(k,t),r=t.spaceWidth*A,l=0,N=k.tokens,p=k.minColumn-1,_=0;for(let Q=0,le=N.getCount();Q<le;Q++)if(_=N.getEndOffset(Q),!(_<=p)){for(C=N.getMetadata(Q),a=p;a<_&&!(a>Gn.maxSupportedColumns);a++){if(n=O.getSegmentAtIndex(a),n===void 0)continue;i=n,k.isBasicASCII&&t.useMonospaceOptimizations||(r=this.glyphRasterizer.getTextMetrics(i).width),x=void 0,v=void 0,S=void 0;for(E of k.inlineDecorations){if(o<E.range.startLineNumber||o>E.range.endLineNumber||o===E.range.startLineNumber&&a<E.range.startColumn-1||o===E.range.endLineNumber&&a>=E.range.endColumn-1)continue;const V=No.decorationCssRuleExtractor.getStyleRules(this._viewGpuContext.canvas.domNode,E.inlineClassName);for(const ce of V)for(const oe of ce.style){const Se=((G=ce.styleMap.get(oe))==null?void 0:G.toString())??"";switch(oe){case"color":{const me=ae.Format.CSS.parse(Se);if(!me)throw new Pe("Invalid color format "+Se);x=me.toNumber32Bit();break}case"font-weight":{cxe(Se)>=400?v=!0:v=!1;break}case"opacity":{S=hxe(Se);break}default:throw new Pe("Unexpected inline decoration style")}}}if(i===" "||i==="	"){if(g=((o-1)*Gn.maxSupportedColumns+a)*6,W.fill(0,g,g+6),i==="	"){const V=a+u;u=_i.nextRenderTabStop(a+u,k.tabSize),l+=r*(u-V),u-=a+1}else l+=r;continue}const ve=No.decorationStyleCache.getOrCreateEntry(x,v,S);d=this._viewGpuContext.atlas.getGlyph(this.glyphRasterizer,i,C,ve,l),c=Math.round(e.relativeVerticalOffset[o-e.startLineNumber]*A+Math.floor((e.lineHeight*A-(d.fontBoundingBoxAscent+d.fontBoundingBoxDescent))/2)+d.fontBoundingBoxAscent),g=((o-1)*Gn.maxSupportedColumns+a)*6,W[g+0]=Math.floor(l),W[g+1]=c,W[g+4]=d.glyphIndex,W[g+5]=d.pageIndex,l+=r}p=_}T=((o-1)*Gn.maxSupportedColumns+_)*6,R=o*Gn.maxSupportedColumns*6,W.fill(0,T,R),F.add(o)}}const U=(e.endLineNumber-e.startLineNumber+1)*j;return q=Math.min(q,Gn.maxSupportedLines),Z=Math.min(Z,Gn.maxSupportedLines),q<=Z&&this._device.queue.writeBuffer(this._cellBindBuffer,(q-1)*j*Float32Array.BYTES_PER_ELEMENT,W.buffer,(q-1)*j*Float32Array.BYTES_PER_ELEMENT,(Z-q+1)*j*Float32Array.BYTES_PER_ELEMENT),this._finalRenderedLine=Math.max(this._finalRenderedLine,Z),this._activeDoubleBufferIndex=this._activeDoubleBufferIndex?0:1,this._visibleObjectCount=U,U}draw(e,t){if(this._visibleObjectCount<=0)throw new Pe("Attempt to draw 0 objects");e.draw(lg.length/2,this._visibleObjectCount,void 0,(t.startLineNumber-1)*Gn.maxSupportedColumns)}_queueBufferUpdate(e){this._queuedBufferUpdates[0].push(e),this._queuedBufferUpdates[1].push(e)}};Gn.maxSupportedLines=3e3,Gn.maxSupportedColumns=200;let xf=Gn;function cxe(s){switch(s){case"lighter":case"normal":return 400;case"bolder":case"bold":return 700}return parseInt(s)}function hxe(s){return s.endsWith("%")?parseFloat(s.substring(0,s.length-1))/100:s.match(/^\d+(?:\.\d*)/)?parseFloat(s):1}var uxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},qU=function(s,e){return function(t,i){e(t,i,s)}};let _5=class extends Qs{constructor(e,t,i,n){super(e),this._viewGpuContext=t,this._instantiationService=i,this._logService=n,this._atlasGpuTextureVersions=[],this._initialized=!1,this._glyphRasterizer=this._register(new kn),this._renderStrategy=this._register(new kn),this.canvas=this._viewGpuContext.canvas.domNode,this._register(ct(r=>{this._viewGpuContext.canvasDevicePixelDimensions.read(r);const o=this._lastViewportData;o&&setTimeout(()=>{o===this._lastViewportData&&this.renderText(o)})})),this.initWebgpu()}async initWebgpu(){if(this._device=No.deviceSync||await No.device,this._store.isDisposed)return;const e=No.atlas;this._register(e.onDidDeleteGlyphs(()=>{this._atlasGpuTextureVersions.length=0,this._atlasGpuTextureVersions[0]=0,this._atlasGpuTextureVersions[1]=0,this._renderStrategy.value.reset()}));const t=navigator.gpu.getPreferredCanvasFormat();this._viewGpuContext.ctx.configure({device:this._device,format:t,alphaMode:"premultiplied"}),this._renderPassColorAttachment={view:null,loadOp:"load",storeOp:"store"},this._renderPassDescriptor={label:"Monaco render pass",colorAttachments:[this._renderPassColorAttachment]};let i;{const l=new Float32Array(6),c=(u=this.canvas.width,d=this.canvas.height)=>(l[0]=u,l[1]=d,l[2]=Math.ceil(this._context.configuration.options.get(165).contentLeft*At().devicePixelRatio),l[3]=0,l[4]=l[0]-l[2],l[5]=l[1]-l[3],l);i=this._register(nr.createBuffer(this._device,{label:"Monaco uniform buffer",size:24,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>c())).object,this._register(Q0(this._viewGpuContext.canvasDevicePixelDimensions,({width:u,height:d})=>{this._device.queue.writeBuffer(i,0,c(u,d))})),this._register(Q0(this._viewGpuContext.contentLeft,()=>{this._device.queue.writeBuffer(i,0,c())}))}let n;n=this._register(nr.createBuffer(this._device,{label:"Monaco atlas info uniform buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>{const l=new Float32Array(2);return l[0]=e.pageSize,l[1]=e.pageSize,l})).object;const r=this._context.configuration.options.get(58),o=this._context.configuration.options.get(61);this._glyphRasterizer.value=this._register(new Mk(o,r,this._viewGpuContext.devicePixelRatio.get(),No.decorationStyleCache)),this._register(Q0(this._viewGpuContext.devicePixelRatio,()=>{this._refreshGlyphRasterizer()})),this._renderStrategy.value=this._instantiationService.createInstance(xf,this._context,this._viewGpuContext,this._device,this._glyphRasterizer),this._glyphStorageBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco glyph storage buffer",size:Bu.maximumPageCount*(Oa.maximumGlyphCount*24),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._atlasGpuTextureVersions[0]=0,this._atlasGpuTextureVersions[1]=0,this._atlasGpuTexture=this._register(nr.createTexture(this._device,{label:"Monaco atlas texture",format:"rgba8unorm",size:{width:e.pageSize,height:e.pageSize,depthOrArrayLayers:Bu.maximumPageCount},dimension:"2d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT})).object,this._updateAtlasStorageBufferAndTexture(),this._vertexBuffer=this._register(nr.createBuffer(this._device,{label:"Monaco vertex buffer",size:lg.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST},lg)).object;const a=this._device.createShaderModule({label:"Monaco shader module",code:this._renderStrategy.value.wgsl});if(this._pipeline=this._device.createRenderPipeline({label:"Monaco render pipeline",layout:"auto",vertex:{module:a,buffers:[{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]}]},fragment:{module:a,targets:[{format:t,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"}}}]}}),this._rebuildBindGroup=()=>{this._bindGroup=this._device.createBindGroup({label:"Monaco bind group",layout:this._pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._glyphStorageBuffer}},{binding:2,resource:this._device.createSampler({label:"Monaco atlas sampler",magFilter:"nearest",minFilter:"nearest"})},{binding:3,resource:this._atlasGpuTexture.createView()},{binding:4,resource:{buffer:i}},{binding:5,resource:{buffer:n}},...this._renderStrategy.value.bindGroupEntries]})},this._rebuildBindGroup(),this._initialized=!0,this._initViewportData){for(const l of this._initViewportData)this.renderText(l);this._initViewportData=void 0}}_refreshRenderStrategy(e){var i,n;if(((i=this._renderStrategy.value)==null?void 0:i.type)==="viewport"||e.endLineNumber<xf.maxSupportedLines&&this._viewportMaxColumn(e)<xf.maxSupportedColumns)return;this._logService.trace(`File is larger than ${xf.maxSupportedLines} lines or ${xf.maxSupportedColumns} columns, switching to viewport render strategy`);const t=this._instantiationService.createInstance(p5,this._context,this._viewGpuContext,this._device,this._glyphRasterizer);this._renderStrategy.value=t,this._register(t.onDidChangeBindGroupEntries(()=>{var r;return(r=this._rebuildBindGroup)==null?void 0:r.call(this)})),(n=this._rebuildBindGroup)==null||n.call(this)}_viewportMaxColumn(e){let t=0,i;for(let n=e.startLineNumber;n<=e.endLineNumber;n++)i=e.getViewLineRenderingData(n),t=Math.max(t,i.maxColumn);return t}_updateAtlasStorageBufferAndTexture(){for(const[e,t]of No.atlas.pages.entries()){if(e>=Bu.maximumPageCount){console.log(`Attempt to upload atlas page [${e}], only ${Bu.maximumPageCount} are supported currently`);continue}if(t.version===this._atlasGpuTextureVersions[e])continue;this._logService.trace("Updating atlas page[",e,"] from version ",this._atlasGpuTextureVersions[e]," to version ",t.version);const i=6*Oa.maximumGlyphCount,n=new Float32Array(i);let r=0;for(const o of t.glyphs)n[r+0]=o.x,n[r+0+1]=o.y,n[r+2]=o.w,n[r+2+1]=o.h,n[r+4]=o.originOffsetX,n[r+4+1]=o.originOffsetY,r+=6;if(r/6>Oa.maximumGlyphCount)throw new Error(`Attempting to write more glyphs (${r/6}) than the GPUBuffer can hold (${Oa.maximumGlyphCount})`);this._device.queue.writeBuffer(this._glyphStorageBuffer,e*6*Oa.maximumGlyphCount*Float32Array.BYTES_PER_ELEMENT,n,0,6*Oa.maximumGlyphCount),t.usedArea.right-t.usedArea.left>0&&t.usedArea.bottom-t.usedArea.top>0&&this._device.queue.copyExternalImageToTexture({source:t.source},{texture:this._atlasGpuTexture,origin:{x:t.usedArea.left,y:t.usedArea.top,z:e}},{width:t.usedArea.right-t.usedArea.left+1,height:t.usedArea.bottom-t.usedArea.top+1}),this._atlasGpuTextureVersions[e]=t.version}}prepareRender(e){throw new Pe("Should not be called")}render(e){throw new Pe("Should not be called")}onConfigurationChanged(e){return this._refreshGlyphRasterizer(),!0}onCursorStateChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onLineMappingChanged(e){return!0}onRevealRangeRequest(e){return!0}onScrollChanged(e){return!0}onThemeChanged(e){return!0}onZonesChanged(e){return!0}_refreshGlyphRasterizer(){const e=this._glyphRasterizer.value;if(!e)return;const t=this._context.configuration.options.get(58),i=this._context.configuration.options.get(61),n=this._viewGpuContext.devicePixelRatio.get();(e.fontFamily!==t||e.fontSize!==i||e.devicePixelRatio!==n)&&(this._glyphRasterizer.value=new Mk(i,t,n,No.decorationStyleCache))}renderText(e){if(this._initialized)return this._refreshRenderStrategy(e),this._renderText(e);this._initViewportData=this._initViewportData??[],this._initViewportData.push(e)}_renderText(e){this._viewGpuContext.rectangleRenderer.draw(e);const t=new Nk(this._context.configuration,this._context.theme.type);this._renderStrategy.value.update(e,t),this._updateAtlasStorageBufferAndTexture();const i=this._device.createCommandEncoder({label:"Monaco command encoder"});this._renderPassColorAttachment.view=this._viewGpuContext.ctx.getCurrentTexture().createView({label:"Monaco canvas texture view"});const n=i.beginRenderPass(this._renderPassDescriptor);n.setPipeline(this._pipeline),n.setVertexBuffer(0,this._vertexBuffer);const r=Math.ceil(this._viewGpuContext.contentLeft.get()*this._viewGpuContext.devicePixelRatio.get());n.setScissorRect(r,0,this.canvas.width-r,this.canvas.height),n.setBindGroup(0,this._bindGroup),this._renderStrategy.value.draw(n,e),n.end();const o=i.finish();this._device.queue.submit([o]),this._lastViewportData=e,this._lastViewLineOptions=t}linesVisibleRangesForRange(e,t){if(!this._lastViewportData)return null;const i=e.endLineNumber,n=H.intersectRanges(e,this._lastViewportData.visibleRange);if(!n)return null;const r=this._lastViewportData.startLineNumber,o=this._lastViewportData.endLineNumber,a=this._lastViewportData,l=this._lastViewLineOptions;if(!a||!l)return null;const c=[];let u=0;t&&(u=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(n.startLineNumber,1)).lineNumber);for(let d=n.startLineNumber;d<=n.endLineNumber;d++){if(d<r||d>o)continue;const g=d===n.startLineNumber?n.startColumn:1,p=d!==i,_=p?this._context.viewModel.getLineMaxColumn(d):n.endColumn,C=this._visibleRangesForLineRange(d,g,_);if(C){if(t&&d<i){const v=u;u=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Y(d+1,1)).lineNumber,v!==u&&(C.ranges[C.ranges.length-1].width+=l.spaceWidth)}c.push(new fZ(C.outsideRenderedLine,d,Uv.from(C.ranges),p))}}return c.length===0?null:c}_visibleRangesForLineRange(e,t,i){if(this.shouldRender())return null;const n=this._lastViewportData,r=this._lastViewLineOptions;if(!n||!r||e<n.startLineNumber||e>n.endLineNumber)return null;const o=n.getViewLineRenderingData(e),a=o.content;let l;o.isBasicASCII&&r.useMonospaceOptimizations||(l=Pk(o,r));let c="",u=0,d=0;for(let C=0;C<t-1;C++){if(o.isBasicASCII&&r.useMonospaceOptimizations)c=a.charAt(C);else{if(c=l.getSegmentAtIndex(C),c===void 0)continue;d+=this._renderStrategy.value.glyphRasterizer.getTextMetrics(c).width/At().devicePixelRatio-r.spaceWidth}c==="	"?u=_i.nextRenderTabStop(u,o.tabSize):u++}let g=u,p=0;for(let C=t-1;C<i-1;C++){if(o.isBasicASCII&&r.useMonospaceOptimizations)c=a.charAt(C);else{if(c=l.getSegmentAtIndex(C),c===void 0)continue;p+=this._renderStrategy.value.glyphRasterizer.getTextMetrics(c).width/At().devicePixelRatio-r.spaceWidth}c==="	"?g=_i.nextRenderTabStop(g,o.tabSize):g++}return new i5(!1,[new ed(u*r.spaceWidth+d,(g-u)*r.spaceWidth+p)])}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new gZ(t.outsideRenderedLine,t.ranges[0].left):null}getLineWidth(e){if(!this._lastViewportData||!this._lastViewLineOptions||!this._viewGpuContext.canRender(this._lastViewLineOptions,this._lastViewportData,e))return;const t=this._lastViewportData.getViewLineRenderingData(e),i=this._visibleRangesForLineRange(e,1,t.maxColumn),n=i==null?void 0:i.ranges.at(-1);if(n)return n.width}getPositionAtCoordinate(e,t){if(!this._lastViewportData||!this._lastViewLineOptions||!this._viewGpuContext.canRender(this._lastViewLineOptions,this._lastViewportData,e))return;const i=this._lastViewportData.getViewLineRenderingData(e),n=i.content,r=At().devicePixelRatio,o=t*r,a=this._lastViewLineOptions.spaceWidth*r,l=Pk(i,this._lastViewLineOptions);let c=0,u=0,d=0,g=0;for(let p=0;p<n.length;p++){const _=l.getSegmentAtIndex(p);if(_===void 0){g++;continue}if(_==="	"){const C=p+d;d=_i.nextRenderTabStop(p+d,i.tabSize),u=a*(d-C),d-=p+1}else i.isBasicASCII&&this._lastViewLineOptions.useMonospaceOptimizations?u=a:u=this._renderStrategy.value.glyphRasterizer.getTextMetrics(_).width;if(o<c+u/2)break;c+=u,g++}return new Y(e,g+1)}};_5=uxe([qU(2,wt),qU(3,Ks)],_5);class dxe{constructor(){this._onDidChange=new $,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const Wl=new dxe,Bn=tt("keybindingService");class JZ extends Qs{}class eJ{_getPageOfLine(e,t){return Math.floor((e-1)/t)}_getRangeForPage(e,t){const i=e*t,n=i+1,r=i+t;return new H(n,1,r+1,1)}fromEditorSelection(e,t,i,n){const o=this._getPageOfLine(t.startLineNumber,i),a=this._getRangeForPage(o,i),l=this._getPageOfLine(t.endLineNumber,i),c=this._getRangeForPage(l,i);let u=a.intersectRanges(new H(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(u,1)>500){const k=e.modifyPosition(u.getEndPosition(),-500);u=H.fromPositions(k,u.getEndPosition())}const d=e.getValueInRange(u,1),g=e.getLineCount(),p=e.getLineMaxColumn(g);let _=c.intersectRanges(new H(t.endLineNumber,t.endColumn,g,p));if(n&&e.getValueLengthInRange(_,1)>500){const k=e.modifyPosition(_.getStartPosition(),500);_=H.fromPositions(_.getStartPosition(),k)}const C=e.getValueInRange(_,1);let v;if(o===l||o+1===l)v=e.getValueInRange(t,1);else{const k=a.intersectRanges(t),E=c.intersectRanges(t);v=e.getValueInRange(k,1)+""+e.getValueInRange(E,1)}n&&v.length>2*500&&(v=v.substring(0,500)+""+v.substring(v.length-500,v.length));let x,S;return t.getDirection()===0?(x=d.length,S=d.length+v.length):(S=d.length,x=d.length+v.length),{value:d+v+C,selection:t,selectionStart:x,selectionEnd:S,startPositionWithinEditor:u.getStartPosition(),newlineCountBeforeSelection:u.endLineNumber-u.startLineNumber}}}function b5(s,e){var i,n,r;if(s.get(2)===1){const o=(i=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))==null?void 0:i.getAriaLabel(),a=(n=e.lookupKeybinding("workbench.action.showCommands"))==null?void 0:n.getAriaLabel(),l=(r=e.lookupKeybinding("workbench.action.openGlobalKeybindings"))==null?void 0:r.getAriaLabel(),c=w(61,"The editor is not accessible at this time.");return o?w(62,"{0} To enable screen reader optimized mode, use {1}",c,o):a?w(63,"{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",c,a):l?w(64,"{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",c,l):c}return s.get(8)}function GU(s){let e=0,t=-1;do{if(t=s.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var fxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},KU=function(s,e){return function(t,i){e(t,i,s)}};class gxe{constructor(e,t,i,n,r){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=r,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new Y(this.modelLineNumber,this.distanceToModelLineStart+1),i=new Y(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const CR=Er;let C5=class extends JZ{constructor(e,t,i,n,r,o){super(e),this._keybindingService=r,this._instantiationService=o,this._primaryCursorPosition=new Y(1,1),this._primaryCursorVisibleRange=null,this._viewController=i,this._visibleRangeProvider=n,this._scrollLeft=0,this._scrollTop=0;const a=this._context.configuration.options,l=a.get(165);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(59),this._emptySelectionClipboard=a.get(45),this._copyWithSyntaxHighlighting=a.get(31),this._visibleTextArea=null,this._selections=[new gt(1,1,1,1)],this._modelSelections=[new gt(1,1,1,1)],this._lastRenderPosition=null,this.textArea=bt(document.createElement("textarea")),Xa.write(this.textArea,7),this.textArea.setClassName(`inputarea ${I_}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:c}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${c*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",b5(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(9)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(140))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",w(65,"editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(104)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=bt(document.createElement("div")),this.textAreaCover.setPosition("absolute"),t.appendChild(this.textArea),t.appendChild(this.textAreaCover);const u=new eJ,d={getDataToCopy:()=>vZ(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const _=this._selections[0];if(rt&&_.isEmpty()){const v=_.getStartPosition();let x=this._getWordBeforePosition(v);if(x.length===0&&(x=this._getCharacterBeforePosition(v)),x.length>0)return new ws(x,x.length,x.length,H.fromPositions(v),0)}if(rt&&!_.isEmpty()&&this._context.viewModel.getValueLengthInRange(_,0)<500){const v=this._context.viewModel.getValueInRange(_,0);return new ws(v,0,v.length,_,0)}if(Fg&&!_.isEmpty()){const v="vscode-placeholder";return new ws(v,0,v.length,null,void 0)}return ws.EMPTY}if(FH){const _=this._selections[0];if(_.isEmpty()){const C=_.getStartPosition(),[v,x]=this._getAndroidWordAtPosition(C);if(v.length>0)return new ws(v,x,x,H.fromPositions(C),0)}return ws.EMPTY}const p=u.fromEditorSelection(this._context.viewModel,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return ws.fromScreenReaderContentState(p)},deduceModelPosition:(p,_,C)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(p,_,C)},g=this._register(new Cve(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(r5,d,g,ca,{isAndroid:FH,isChrome:Tv,isFirefox:Er,isSafari:Fg})),this._register(this._textAreaInput.onKeyDown(p=>{this._viewController.emitKeyDown(p)})),this._register(this._textAreaInput.onKeyUp(p=>{this._viewController.emitKeyUp(p)})),this._register(this._textAreaInput.onPaste(p=>{let _=!1,C=null,v=null;p.metadata&&(_=this._emptySelectionClipboard&&!!p.metadata.isFromEmptySelection,C=typeof p.metadata.multicursorText<"u"?p.metadata.multicursorText:null,v=p.metadata.mode),this._viewController.paste(p.text,_,C,v)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(p=>{p.replacePrevCharCnt||p.replaceNextCharCnt||p.positionDelta?this._viewController.compositionType(p.text,p.replacePrevCharCnt,p.replaceNextCharCnt,p.positionDelta):this._viewController.type(p.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(p=>{this._viewController.setSelection(p)})),this._register(this._textAreaInput.onCompositionStart(p=>{const _=this.textArea.domNode,C=this._modelSelections[0],{distanceToModelLineStart:v,widthOfHiddenTextBefore:x}=(()=>{const k=_.value.substring(0,Math.min(_.selectionStart,_.selectionEnd)),E=k.lastIndexOf(`
`),T=k.substring(E+1),R=T.lastIndexOf("	"),N=T.length-R-1,A=C.getStartPosition(),O=Math.min(A.column-1,N),W=A.column-1-O,j=T.substring(0,T.length-O),{tabSize:F}=this._context.viewModel.model.getOptions(),q=mxe(this.textArea.domNode.ownerDocument,j,this._fontInfo,F);return{distanceToModelLineStart:W,widthOfHiddenTextBefore:q}})(),{distanceToModelLineEnd:S}=(()=>{const k=_.value.substring(Math.max(_.selectionStart,_.selectionEnd)),E=k.indexOf(`
`),T=E===-1?k:k.substring(0,E),R=T.indexOf("	"),N=R===-1?T.length:T.length-R-1,A=C.getEndPosition(),O=Math.min(this._context.viewModel.model.getLineMaxColumn(A.lineNumber)-A.column,N);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(A.lineNumber)-A.column-O}})();this._context.viewModel.revealRange("keyboard",!0,H.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new gxe(this._context,C.startLineNumber,v,x,S),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${I_} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(p=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${I_}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(Wl.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}get domNode(){return this.textArea}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),n=f1(t,[]);let r=!0,o=e.column,a=!0,l=e.column,c=0;for(;c<50&&(r||a);){if(r&&o<=1&&(r=!1),r){const u=i.charCodeAt(o-2);n.get(u)!==0?r=!1:o--}if(a&&l>i.length&&(a=!1),a){const u=i.charCodeAt(l-1);n.get(u)!==0?a=!1:l++}c++}return[i.substring(o-1,l-1),e.column-o]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=f1(this._context.configuration.options.get(148),[]);let n=e.column,r=0;for(;n>1;){const o=t.charCodeAt(n-2);if(i.get(o)!==0||r>50)return t.substring(n-1,e.column-1);r++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!hn(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===Kr.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const n=e.get(165).wrappingColumn;if(n!==-1&&this._accessibilitySupport!==1){const r=e.get(59);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(n*r.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=CR?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(59),this._emptySelectionClipboard=t.get(45),this._copyWithSyntaxHighlighting=t.get(31),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:n}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${n*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",b5(t,this._keybindingService)),this.textArea.setAttribute("aria-required",t.get(9)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(140))),(e.hasChanged(41)||e.hasChanged(104))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!Wl.enabled||e.get(41)&&e.get(104)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){var t;this._primaryCursorPosition=new Y(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),(t=this._visibleTextArea)==null||t.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const i=this._visibleTextArea.visibleTextareaStart,n=this._visibleTextArea.visibleTextareaEnd,r=this._visibleTextArea.startPosition,o=this._visibleTextArea.endPosition;if(r&&o&&i&&n&&n.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){const a=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,l=GU(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,d=n.left-i.left+1;if(u<this._contentLeft){const k=this._contentLeft-u;u+=k,c+=k,d-=k}d>this._contentWidth&&(d=this._contentWidth);const g=this._context.viewLayout.getLineHeightForLineNumber(r.lineNumber),p=this._context.viewModel.getFontSizeAtPosition(this._primaryCursorPosition),_=this._context.viewModel.getViewLineData(r.lineNumber),C=_.tokens.findTokenIndexAtOffset(r.column-1),v=_.tokens.findTokenIndexAtOffset(o.column-1),x=C===v,S=this._visibleTextArea.definePresentation(x?_.tokens.getPresentation(C):null);this.textArea.domNode.scrollTop=l*g,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:a,left:u,width:d,height:g,useCover:!1,color:(qi.getColorMap()||[])[S.foreground],italic:S.italic,bold:S.bold,underline:S.underline,strikethrough:S.strikethrough,fontSize:p})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(rt||this._accessibilitySupport===2){const i=this._primaryCursorPosition.lineNumber,n=this._context.viewLayout.getLineHeightForLineNumber(i);this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:n,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const r=this._textAreaInput.textAreaState.newlineCountBeforeSelection??GU(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=r*n;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:CR?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:CR?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;Jn(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setLineHeight(e.height),t.setFontSize(e.fontSize??this._fontInfo.fontSize),t.setColor(e.color?ae.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(66)?i.setClassName("monaco-editor-background textAreaCover "+Ik.OUTER_CLASS_NAME):n.get(76).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+Tk.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};C5=fxe([KU(4,Bn),KU(5,wt)],C5);function mxe(s,e,t,i){if(e.length===0)return 0;const n=s.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const r=s.createElement("span");Jn(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${i*t.spaceWidth}px`,r.append(e),n.appendChild(r),s.body.appendChild(n);const o=r.offsetWidth;return n.remove(),o}var pxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_xe=function(s,e){return function(t,i){e(t,i,s)}};let w5=class extends ne{constructor(e,t,i){super(),this._domNode=t,this._onFocusChange=i,this._isFocused=!1,this._isPaused=!1,this._register(J(this._domNode,"focus",()=>{e.trace("NativeEditContext.focus"),!this._isPaused&&this.refreshFocusState()})),this._register(J(this._domNode,"blur",()=>{e.trace("NativeEditContext.blur"),!this._isPaused&&this._handleFocusedChanged(!1)}))}pause(){this._isPaused=!0}resume(){this._isPaused=!1,this.refreshFocusState()}_handleFocusedChanged(e){this._isFocused!==e&&(this._isFocused=e,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus(),this.refreshFocusState()}refreshFocusState(){const e=Wg(this._domNode),t=e?e.activeElement:Ln(),i=this._domNode===t;this._handleFocusedChanged(i)}get isFocused(){return this._isFocused}};w5=pxe([_xe(0,Ks)],w5);function i0(s,e,t,i){return s.addEventListener(e,t,i),{dispose(){s.removeEventListener(e,t)}}}var bxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Cxe=function(s,e){return function(t,i){e(t,i,s)}};const wR=yd("richScreenReaderContent",{createHTML:s=>s}),vR="data-line-number";let v5=class extends ne{constructor(e,t,i,n){super(),this._domNode=e,this._context=t,this._viewController=i,this._accessibilityService=n,this._selectionChangeListener=this._register(new kn),this._accessibilityPageSize=1,this._ignoreSelectionChangeTime=0,this._state=Vw.NULL,this._strategy=new yxe,this._renderedLines=new Map,this._renderedSelection=new gt(1,1,1,1),this.onConfigurationChanged(this._context.configuration.options)}updateScreenReaderContent(e){const t=At().document.activeElement;if(!t||t!==this._domNode.domNode)return;if(this._accessibilityService.isScreenReaderOptimized()){const n=this._getScreenReaderContentLineIntervals(e);this._state.equals(n)||(this._state=n,this._renderedLines=this._renderScreenReaderContent(n)),this._renderedSelection.equalsSelection(e)||(this._renderedSelection=e,this._setSelectionOnScreenReaderContent(this._context,this._renderedLines,e))}else this._state=Vw.NULL,this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.textContent=""}updateScrollTop(e){const t=this._state.intervals;if(!t.length)return;const i=this._context.viewModel.viewLayout,n=t[0].startLine,r=i.getVerticalOffsetForLineNumber(n),o=i.getVerticalOffsetForLineNumber(e.positionLineNumber);this._domNode.domNode.scrollTop=o-r}onFocusChange(e){e?this._selectionChangeListener.value=this._setSelectionChangeListener():this._selectionChangeListener.value=void 0}onConfigurationChanged(e){this._accessibilityPageSize=e.get(3)}onWillCut(){this._setIgnoreSelectionChangeTime("onCut")}onWillPaste(){this._setIgnoreSelectionChangeTime("onWillPaste")}_setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}_setSelectionChangeListener(){let e=0;return J(this._domNode.domNode.ownerDocument,"selectionchange",()=>{if(!(At().document.activeElement===this._domNode.domNode)||!this._accessibilityService.isScreenReaderOptimized()||!Wl.enabled)return;const r=Date.now(),o=r-e;if(e=r,o<5)return;const a=r-this._ignoreSelectionChangeTime;if(this._ignoreSelectionChangeTime=0,a<100)return;const l=this._getEditorSelectionFromDomRange();l&&this._viewController.setSelection(l)})}_renderScreenReaderContent(e){const t=[],i=new Map;for(const n of e.intervals)for(let r=n.startLine;r<=n.endLine;r++){const o=this._renderLine(r);i.set(r,o),t.push(o.domNode)}return this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.replaceChildren(...t),i}_renderLine(e){const t=this._context.viewModel,i=t.getViewLineRenderingData(e),n=this._context.configuration.options,r=n.get(59),o=n.get(133),a=n.get(108),l=n.get(60),c=n.get(40),u=Oo.filter(i.inlineDecorations,e,i.minColumn,i.maxColumn),d=r.isMonospace&&!c,g=l!==hd.OFF;let p;n.get(47)==="off"?p=n.get(113):p="none";const C=new um(d,r.canUseHalfwidthRightwardsArrow,i.content,i.continuesWithWrappedLine,i.isBasicASCII,i.containsRTL,i.minColumn-1,i.tokens,u,i.tabSize,i.startVisibleColumn,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,o,p,a,g,null,null,0,!0),v=new z1(1e4),x=yD(C,v),S=v.build(),k=(wR==null?void 0:wR.createHTML(S))??S,E=t.viewLayout.getLineHeightForLineNumber(e)+"px",T=document.createElement("div");return T.innerHTML=k,T.style.lineHeight=E,T.style.height=E,T.setAttribute(vR,e.toString()),new wxe(T,x.characterMapping)}_setSelectionOnScreenReaderContent(e,t,i){const r=At().document.getSelection();if(!r)return;const o=i.startLineNumber,a=i.endLineNumber,l=t.get(o),c=t.get(a);if(!l||!c)return;const u=e.viewModel,d=u.model,g=u.coordinatesConverter,p=new H(o,1,o,i.selectionStartColumn),_=g.convertViewRangeToModelRange(p),C=d.getCharacterCountInRange(_),v=new H(a,1,a,i.positionColumn),x=g.convertViewRangeToModelRange(v),S=d.getCharacterCountInRange(x),k=l.characterMapping.getDomPosition(C),E=c.characterMapping.getDomPosition(S),T=l.domNode.firstChild,R=c.domNode.firstChild,N=T.childNodes,A=R.childNodes,O=N.item(k.partIndex),W=A.item(E.partIndex);!O.firstChild||!W.firstChild||(this._setIgnoreSelectionChangeTime("setRange"),r.setBaseAndExtent(O.firstChild,i.startColumn===1?0:k.charIndex+1,W.firstChild,i.endColumn===1?0:E.charIndex+1))}_getScreenReaderContentLineIntervals(e){return this._strategy.fromEditorSelection(this._context.viewModel,e,this._accessibilityPageSize)}_getEditorSelectionFromDomRange(){var S,k,E,T;if(!this._renderedLines)return;const e=At().document.getSelection();if(!e||e.rangeCount===0)return;const i=e.getRangeAt(0),n=i.startContainer,r=i.endContainer,o=n.parentElement,a=r.parentElement;if(!o||!Wi(o)||!a||!Wi(a))return;const l=(S=o.parentElement)==null?void 0:S.parentElement,c=(k=a.parentElement)==null?void 0:k.parentElement;if(!l||!c)return;const u=l.getAttribute(vR),d=c.getAttribute(vR);if(!u||!d)return;const g=parseInt(u),p=parseInt(d),_=(E=this._renderedLines.get(g))==null?void 0:E.characterMapping,C=(T=this._renderedLines.get(p))==null?void 0:T.characterMapping;if(!_||!C)return;const v=Aw(_,o,i.startOffset),x=Aw(C,a,i.endOffset);return e.direction==="forward"?new gt(g,v,p,x):new gt(p,x,g,v)}};v5=bxe([Cxe(3,uo)],v5);class wxe{constructor(e,t){this.domNode=e,this.characterMapping=t}}class vxe{constructor(e,t){this.startLine=e,this.endLine=t}}class Vw{constructor(e,t){this.intervals=t;let i="";for(const n of t)for(let r=n.startLine;r<=n.endLine;r++)i+=e.getLineContent(r)+`
`;this.value=i}equals(e){return this.value===e.value}static get NULL(){const e={getLineContent:()=>"",getLineCount:()=>1,getLineMaxColumn:()=>1,getValueInRange:()=>"",getValueLengthInRange:()=>0,modifyPosition:(t,i)=>t};return new Vw(e,[])}}class yxe{constructor(){}_getPageOfLine(e,t){return Math.floor((e-1)/t)}_getRangeForPage(e,t,i){const n=t*i,r=n+1,o=Math.min(n+i,e.getLineCount());return new vxe(r,o)}fromEditorSelection(e,t,i){const n=this._getPageOfLine(t.startLineNumber,i),r=this._getRangeForPage(e,n,i),o=this._getPageOfLine(t.endLineNumber,i),a=this._getRangeForPage(e,o,i),l=[{startLine:r.startLine,endLine:r.endLine}];return n+1<o&&l.push({startLine:a.startLine,endLine:a.endLine}),new Vw(e,l)}}class Sxe{constructor(e){this.replacements=e;let t=-1;for(const i of e){if(!(i.replaceRange.start>=t))throw new Pe(`Edits must be disjoint and sorted. Found ${i} after ${t}`);t=i.replaceRange.endExclusive}}toString(){return`[${this.replacements.map(t=>t.toString()).join(", ")}]`}normalize(){const e=[];let t;for(const i of this.replacements)if(!(i.getNewLength()===0&&i.replaceRange.length===0)){if(t&&t.replaceRange.endExclusive===i.replaceRange.start){const n=t.tryJoinTouching(i);if(n){t=n;continue}}t&&e.push(t),t=i}return t&&e.push(t),this._createNew(e)}compose(e){const t=this.normalize(),i=e.normalize();if(t.isEmpty())return i;if(i.isEmpty())return t;const n=[...t.replacements],r=[];let o=0;for(const a of i.replacements){for(;;){const d=n[0];if(!d||d.replaceRange.start+o+d.getNewLength()>=a.replaceRange.start)break;n.shift(),r.push(d),o+=d.getNewLength()-d.replaceRange.length}const l=o;let c,u;for(;;){const d=n[0];if(!d||d.replaceRange.start+o>a.replaceRange.endExclusive)break;c||(c=d),u=d,n.shift(),o+=d.getNewLength()-d.replaceRange.length}if(!c)r.push(a.delta(-o));else{const d=Math.min(c.replaceRange.start,a.replaceRange.start-l),g=a.replaceRange.start-(c.replaceRange.start+l);if(g>0){const v=c.slice(Re.emptyAt(d),new Re(0,g));r.push(v)}if(!u)throw new Pe("Invariant violation: lastIntersecting is undefined");const p=u.replaceRange.endExclusive+o-a.replaceRange.endExclusive;if(p>0){const v=u.slice(Re.ofStartAndLength(u.replaceRange.endExclusive,0),new Re(u.getNewLength()-p,u.getNewLength()));n.unshift(v),o-=v.getNewLength()-v.replaceRange.length}const _=new Re(d,a.replaceRange.endExclusive-o),C=a.slice(_,new Re(0,a.getNewLength()));r.push(C)}}for(;;){const a=n.shift();if(!a)break;r.push(a)}return this._createNew(r).normalize()}getNewRanges(){const e=[];let t=0;for(const i of this.replacements)e.push(Re.ofStartAndLength(i.replaceRange.start+t,i.getNewLength())),t+=i.getLengthDelta();return e}isEmpty(){return this.replacements.length===0}}class xxe{constructor(e){this.replaceRange=e}delta(e){return this.slice(this.replaceRange.delta(e),new Re(0,this.getNewLength()))}getLengthDelta(){return this.getNewLength()-this.replaceRange.length}toString(){return`{ ${this.replaceRange.toString()} -> ${this.getNewLength()} }`}get isEmpty(){return this.getNewLength()===0&&this.replaceRange.length===0}getRangeAfterReplace(){return new Re(this.replaceRange.start,this.replaceRange.start+this.getNewLength())}}class Lxe extends Sxe{apply(e){const t=[];let i=0;for(const n of this.replacements)t.push(e.substring(i,n.replaceRange.start)),t.push(n.newText),i=n.replaceRange.endExclusive;return t.push(e.substring(i)),t.join("")}}class kxe extends xxe{constructor(e,t){super(e),this.newText=t}getNewLength(){return this.newText.length}toString(){return`${this.replaceRange} -> ${JSON.stringify(this.newText)}`}replace(e){return e.substring(0,this.replaceRange.start)+this.newText+e.substring(this.replaceRange.endExclusive)}removeCommonSuffixPrefix(e){const t=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),i=a1(t,this.newText),n=Math.min(t.length-i,this.newText.length-i,l1(t,this.newText)),r=new Re(this.replaceRange.start+i,this.replaceRange.endExclusive-n),o=this.newText.substring(i,this.newText.length-n);return new Kf(r,o)}removeCommonSuffixAndPrefix(e){return this.removeCommonSuffix(e).removeCommonPrefix(e)}removeCommonPrefix(e){const t=this.replaceRange.substring(e),i=a1(t,this.newText);return i===0?this:this.slice(this.replaceRange.deltaStart(i),new Re(i,this.newText.length))}removeCommonSuffix(e){const t=this.replaceRange.substring(e),i=l1(t,this.newText);return i===0?this:this.slice(this.replaceRange.deltaEnd(-i),new Re(0,this.newText.length-i))}toJson(){return{txt:this.newText,pos:this.replaceRange.start,len:this.replaceRange.length}}}const l_=class l_ extends Lxe{static compose(e){if(e.length===0)return l_.empty;let t=e[0];for(let i=1;i<e.length;i++)t=t.compose(e[i]);return t}constructor(e){super(e)}_createNew(e){return new l_(e)}};l_.empty=new l_([]);let y5=l_;class Kf extends kxe{static insert(e,t){return new Kf(Re.emptyAt(e),t)}static replace(e,t){return new Kf(e,t)}equals(e){return this.replaceRange.equals(e.replaceRange)&&this.newText===e.newText}tryJoinTouching(e){return new Kf(this.replaceRange.joinRightTouching(e.replaceRange),this.newText+e.newText)}slice(e,t){return new Kf(e,t?t.substring(this.newText):this.newText)}}bbe({StringEdit:y5,StringReplacement:Kf,TextReplacement:Ma,TextEdit:xw,TextLength:Dr});var Exe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Dxe=function(s,e){return function(t,i){e(t,i,s)}};let S5=class extends ne{constructor(e,t,i,n){super(),this._domNode=e,this._context=t,this._viewController=i,this._accessibilityService=n,this._selectionChangeListener=this._register(new kn),this._accessibilityPageSize=1,this._ignoreSelectionChangeTime=0,this._strategy=new eJ,this.onConfigurationChanged(this._context.configuration.options)}updateScreenReaderContent(e){const t=this._domNode.domNode,i=At().document.activeElement;if(!i||i!==t)return;if(this._accessibilityService.isScreenReaderOptimized()){this._state=this._getScreenReaderContentState(e),t.textContent!==this._state.value&&(this._setIgnoreSelectionChangeTime("setValue"),t.textContent=this._state.value);const r=At().document.getSelection();if(!r)return;const o=this._getScreenReaderRange(this._state.selectionStart,this._state.selectionEnd);if(!o)return;this._setIgnoreSelectionChangeTime("setRange"),r.setBaseAndExtent(o.anchorNode,o.anchorOffset,o.focusNode,o.focusOffset)}else this._state=void 0,this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.textContent=""}updateScrollTop(e){if(!this._state)return;const t=this._context.viewModel.viewLayout,i=this._state.startPositionWithinEditor.lineNumber,n=t.getVerticalOffsetForLineNumber(i),r=t.getVerticalOffsetForLineNumber(e.positionLineNumber);this._domNode.domNode.scrollTop=r-n}onFocusChange(e){e?this._selectionChangeListener.value=this._setSelectionChangeListener():this._selectionChangeListener.value=void 0}onConfigurationChanged(e){this._accessibilityPageSize=e.get(3)}onWillCut(){this._setIgnoreSelectionChangeTime("onCut")}onWillPaste(){this._setIgnoreSelectionChangeTime("onWillPaste")}_setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}_setSelectionChangeListener(){let e=0;return J(this._domNode.domNode.ownerDocument,"selectionchange",()=>{const t=this._accessibilityService.isScreenReaderOptimized();if(!this._state||!t||!Wl.enabled||!(At().document.activeElement===this._domNode.domNode))return;const r=At().document.getSelection();if(!r||r.rangeCount===0)return;const a=r.getRangeAt(0),l=Date.now(),c=l-e;if(e=l,c<5)return;const u=l-this._ignoreSelectionChangeTime;this._ignoreSelectionChangeTime=0,!(u<100)&&this._viewController.setSelection(this._getEditorSelectionFromDomRange(this._context,this._state,r.direction,a))})}_getScreenReaderContentState(e){const t=this._strategy.fromEditorSelection(this._context.viewModel,e,this._accessibilityPageSize,this._accessibilityService.getAccessibilitySupport()===0),i=this._context.viewModel.model.getPositionAt(1/0);let n=t.value;return i.column===1&&e.getEndPosition().equals(i)&&(n+=`
`),t.value=n,t}_getScreenReaderRange(e,t){const i=this._domNode.domNode.firstChild;if(!i)return;const n=new globalThis.Range;return n.setStart(i,e),n.setEnd(i,t),{anchorNode:i,anchorOffset:e,focusNode:i,focusOffset:t}}_getEditorSelectionFromDomRange(e,t,i,n){const r=e.viewModel,o=r.model,l=r.coordinatesConverter.convertViewPositionToModelPosition(t.startPositionWithinEditor),c=o.getOffsetAt(l);let u=n.startOffset+c,d=n.endOffset+c;if(o.getEndOfLineSequence()===1){const x=t.value,S=new wD(x),k=S.getPosition(n.startOffset),E=S.getPosition(n.endOffset);u+=k.lineNumber-1,d+=E.lineNumber-1}const p=o.getPositionAt(u),_=o.getPositionAt(d),C=i==="forward"?p:_,v=i==="forward"?_:p;return gt.fromPositions(C,v)}};S5=Exe([Dxe(3,uo)],S5);var Txe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},YU=function(s,e){return function(t,i){e(t,i,s)}};let x5=class extends ne{constructor(e,t,i,n,r){super(),this._domNode=e,this._context=t,this._viewController=i,this._keybindingService=n,this._accessibilityService=r,this._contentLeft=1,this._contentWidth=1,this._contentHeight=1,this._divWidth=1,this._primarySelection=new gt(1,1,1,1),this._primaryCursorVisibleRange=null,this._state=this._register(new kn),this._instantiateScreenReaderContent(),this._updateConfigurationSettings(),this._updateDomAttributes()}onWillPaste(){var e;(e=this._state.value)==null||e.onWillPaste()}onWillCut(){var e;(e=this._state.value)==null||e.onWillCut()}handleFocusChange(e){var t;(t=this._state.value)==null||t.onFocusChange(e),this.writeScreenReaderContent()}onConfigurationChanged(e){this._instantiateScreenReaderContent(),this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_instantiateScreenReaderContent(){const e=this._context.configuration.options.get(107);this._renderRichContent!==e&&(this._renderRichContent=e,this._state.value=this._createScreenReaderContent(e))}_createScreenReaderContent(e){return e?new v5(this._domNode,this._context,this._viewController,this._accessibilityService):new S5(this._domNode,this._context,this._viewController,this._accessibilityService)}_updateConfigurationSettings(){var n;const e=this._context.configuration.options,t=e.get(165),i=t.wrappingColumn;this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._contentHeight=t.height,this._fontInfo=e.get(59),this._divWidth=Math.round(i*this._fontInfo.typicalHalfwidthCharacterWidth),(n=this._state.value)==null||n.onConfigurationChanged(e)}_updateDomAttributes(){const e=this._context.configuration.options;this._domNode.domNode.setAttribute("role","textbox"),this._domNode.domNode.setAttribute("aria-required",e.get(9)?"true":"false"),this._domNode.domNode.setAttribute("aria-multiline","true"),this._domNode.domNode.setAttribute("aria-autocomplete",e.get(104)?"none":"both"),this._domNode.domNode.setAttribute("aria-roledescription",w(60,"editor")),this._domNode.domNode.setAttribute("aria-label",b5(e,this._keybindingService));const t=this._context.viewModel.model.getOptions().tabSize,i=e.get(59).spaceWidth;this._domNode.domNode.style.tabSize=`${t*i}px`;const n=e.get(154),r=n==="inherit"?e.get(153):n,o=r==="inherit"?e.get(149):r;this._domNode.domNode.style.textWrap=o==="off"?"nowrap":"wrap"}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new gt(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent(),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primarySelection.getPosition())}render(e){var l;if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const t=this._context.viewLayout.getCurrentScrollLeft(),i=this._contentLeft+this._primaryCursorVisibleRange.left-t;if(i<this._contentLeft||i>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const n=this._context.viewLayout.getCurrentScrollTop(),r=this._primarySelection.positionLineNumber,o=this._context.viewLayout.getVerticalOffsetForLineNumber(r)-n;if(o<0||o>this._contentHeight){this._renderAtTopLeft();return}const a=this._context.viewLayout.getLineHeightForLineNumber(r);this._doRender(o,this._contentLeft,this._divWidth,a),(l=this._state.value)==null||l.updateScrollTop(this._primarySelection)}_renderAtTopLeft(){this._doRender(0,0,this._contentWidth,1)}_doRender(e,t,i,n){Jn(this._domNode,this._fontInfo),this._domNode.setTop(e),this._domNode.setLeft(t),this._domNode.setWidth(i),this._domNode.setHeight(n),this._domNode.setLineHeight(n)}setAriaOptions(e){e.activeDescendant?(this._domNode.setAttribute("aria-haspopup","true"),this._domNode.setAttribute("aria-autocomplete","list"),this._domNode.setAttribute("aria-activedescendant",e.activeDescendant)):(this._domNode.setAttribute("aria-haspopup","false"),this._domNode.setAttribute("aria-autocomplete","both"),this._domNode.removeAttribute("aria-activedescendant")),e.role&&this._domNode.setAttribute("role",e.role)}writeScreenReaderContent(){var e;(e=this._state.value)==null||e.updateScreenReaderContent(this._primarySelection)}};x5=Txe([YU(3,Bn),YU(4,uo)],x5);var L5;(function(s){function e(t,i){return new t.EditContext(i)}s.create=e})(L5||(L5={}));class Nxe{constructor(){this._nativeEditContextMapping=new Map}register(e,t){return this._nativeEditContextMapping.set(e,t),{dispose:()=>{this._nativeEditContextMapping.delete(e)}}}get(e){return this._nativeEditContextMapping.get(e)}}const Ixe=new Nxe;var Rxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},QU=function(s,e){return function(t,i){e(t,i,s)}},X0;(function(s){s.NONE="edit-context-composition-none",s.SECONDARY="edit-context-composition-secondary",s.PRIMARY="edit-context-composition-primary"})(X0||(X0={}));let Fk=class extends JZ{constructor(e,t,i,n,r,o,a){super(t),this._viewController=n,this._visibleRangeProvider=r,this.logService=a,this._previousEditContextSelection=new Re(0,0),this._editContextPrimarySelection=new gt(1,1,1,1),this._decorations=[],this._primarySelection=new gt(1,1,1,1),this._targetWindowId=-1,this._scrollTop=0,this._scrollLeft=0,this._linesVisibleRanges=null,this.domNode=new ek(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._imeTextArea=new ek(document.createElement("textarea")),this._imeTextArea.setClassName("ime-text-area"),this._imeTextArea.setAttribute("readonly","true"),this._imeTextArea.setAttribute("tabindex","-1"),this._imeTextArea.setAttribute("aria-hidden","true"),this.domNode.setAttribute("autocorrect","off"),this.domNode.setAttribute("autocapitalize","off"),this.domNode.setAttribute("autocomplete","off"),this.domNode.setAttribute("spellcheck","false"),this._updateDomAttributes(),i.appendChild(this.domNode),i.appendChild(this._imeTextArea),this._parent=i.domNode,this._focusTracker=this._register(new w5(a,this.domNode.domNode,d=>{a.trace("NativeEditContext#handleFocusChange : ",d),this._screenReaderSupport.handleFocusChange(d),this._context.viewModel.setHasFocus(d)}));const l=Ae(this.domNode.domNode);this._editContext=L5.create(l),this.setEditContextOnDomNode(),this._screenReaderSupport=this._register(o.createInstance(x5,this.domNode,t,this._viewController)),this._register(J(this.domNode.domNode,"copy",d=>{this.logService.trace("NativeEditContext#copy"),this._ensureClipboardGetsEditorSelection(d)})),this._register(J(this.domNode.domNode,"cut",d=>{this.logService.trace("NativeEditContext#cut"),this._screenReaderSupport.onWillCut(),this._ensureClipboardGetsEditorSelection(d),this.logService.trace("NativeEditContext#cut (before viewController.cut)"),this._viewController.cut()})),this._register(J(this.domNode.domNode,"keyup",d=>this._onKeyUp(d))),this._register(J(this.domNode.domNode,"keydown",async d=>this._onKeyDown(d))),this._register(J(this._imeTextArea.domNode,"keyup",d=>this._onKeyUp(d))),this._register(J(this._imeTextArea.domNode,"keydown",async d=>this._onKeyDown(d))),this._register(J(this.domNode.domNode,"beforeinput",async d=>{(d.inputType==="insertParagraph"||d.inputType==="insertLineBreak")&&this._onType(this._viewController,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0})})),this._register(J(this.domNode.domNode,"paste",d=>{if(this.logService.trace("NativeEditContext#paste"),d.preventDefault(),!d.clipboardData)return;let[g,p]=Sk.getTextData(d.clipboardData);if(this.logService.trace("NativeEditContext#paste with id : ",p==null?void 0:p.id," with text.length: ",g.length),!g)return;p=p||og.INSTANCE.get(g);let _=!1,C=null,v=null;p&&(_=this._context.configuration.options.get(45)&&!!p.isFromEmptySelection,C=typeof p.multicursorText<"u"?p.multicursorText:null,v=p.mode),this.logService.trace("NativeEditContext#paste (before viewController.paste)"),this._viewController.paste(g,_,C,v)})),this._register(i0(this._editContext,"textformatupdate",d=>this._handleTextFormatUpdate(d))),this._register(i0(this._editContext,"characterboundsupdate",d=>this._updateCharacterBounds(d)));let c;this._register(i0(this._editContext,"textupdate",d=>{const g=d.text;if(g.length===1){const p=g.charCodeAt(0);if(hn(p)){c=g;return}if(Pg(p)&&c){const _={text:c+g,selectionEnd:d.selectionEnd,selectionStart:d.selectionStart,updateRangeStart:d.updateRangeStart-1,updateRangeEnd:d.updateRangeEnd-1};c=void 0,this._emitTypeEvent(this._viewController,_);return}}this._emitTypeEvent(this._viewController,d)})),this._register(i0(this._editContext,"compositionstart",d=>{this._updateEditContext(),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(i0(this._editContext,"compositionend",d=>{this._updateEditContext(),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}));let u=!1;this._register(Wl.onDidChange(()=>{Wl.enabled&&u&&(this._focusTracker.resume(),this.domNode.focus(),u=!1),!Wl.enabled&&this.isFocused()&&(this._focusTracker.pause(),this._imeTextArea.focus(),u=!0)})),this._register(Ixe.register(e,this))}dispose(){this.domNode.domNode.editContext=void 0,this.domNode.domNode.blur(),this.domNode.domNode.remove(),this._imeTextArea.domNode.remove(),super.dispose()}setAriaOptions(e){this._screenReaderSupport.setAriaOptions(e)}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._screenReaderSupport.prepareRender(e),this._updateSelectionAndControlBoundsData(e)}onDidRender(){this._updateSelectionAndControlBoundsAfterRender()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new gt(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),this._updateEditContext(),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.fromLineNumber+e.count-1),!0}onLinesDeleted(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.toLineNumber),!0}onLinesInserted(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.toLineNumber),!0}_updateEditContextOnLineChange(e,t){this._editContextPrimarySelection.endLineNumber<e||this._editContextPrimarySelection.startLineNumber>t||this._updateEditContext()}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}onWillPaste(){this.logService.trace("NativeEditContext#onWillPaste"),this._onWillPaste()}_onWillPaste(){this._screenReaderSupport.onWillPaste()}onWillCopy(){this.logService.trace("NativeEditContext#onWillCopy"),this.logService.trace("NativeEditContext#isFocused : ",this.domNode.domNode===Ln())}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus(),this.refreshFocusState()}refreshFocusState(){this._focusTracker.refreshFocusState()}setEditContextOnDomNode(){const e=Ae(this.domNode.domNode),t=Cw(e);this._targetWindowId!==t&&(this.domNode.domNode.editContext=this._editContext,this._targetWindowId=t)}_onKeyUp(e){this._viewController.emitKeyUp(new jt(e))}_onKeyDown(e){const t=new jt(e);t.keyCode===114&&t.stopPropagation(),this._viewController.emitKeyDown(t)}_updateDomAttributes(){const e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(140)))}_updateEditContext(){const e=this._getNewEditContextState();e&&(this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text??" "),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._editContextPrimarySelection=e.editContextPrimarySelection,this._previousEditContextSelection=new Re(e.selectionStartOffset,e.selectionEndOffset))}_emitTypeEvent(e,t){if(!this._editContext)return;const i=this._previousEditContextSelection.endExclusive,n=this._previousEditContextSelection.start;this._previousEditContextSelection=new Re(t.selectionStart,t.selectionEnd);let r=0,o=0;t.updateRangeEnd>i&&(r=t.updateRangeEnd-i),t.updateRangeStart<n&&(o=n-t.updateRangeStart);let a="";n<t.updateRangeStart&&(a+=this._editContext.text.substring(n,t.updateRangeStart)),a+=t.text,i>t.updateRangeEnd&&(a+=this._editContext.text.substring(t.updateRangeEnd,i));let l=0;t.selectionStart===t.selectionEnd&&n===i&&(l=t.selectionStart-(t.updateRangeStart+t.text.length));const c={text:a,replacePrevCharCnt:o,replaceNextCharCnt:r,positionDelta:l};this._onType(e,c)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_getNewEditContextState(){const e=this._primarySelection,t=this._context.viewModel.model;if(!t.isValidRange(e))return;const i=e.startLineNumber,n=e.endLineNumber,r=t.getLineMaxColumn(n),o=new H(i,1,n,r),a=t.getValueInRange(o,0),l=e.startColumn-1,c=a.length+e.endColumn-r;return{text:a,selectionStartOffset:l,selectionEndOffset:c,editContextPrimarySelection:e}}_editContextStartPosition(){return new Y(this._editContextPrimarySelection.startLineNumber,1)}_handleTextFormatUpdate(e){if(!this._editContext)return;const t=e.getTextFormats(),i=this._editContextStartPosition(),n=[];t.forEach(r=>{const o=this._context.viewModel.model,a=o.getOffsetAt(i),l=o.getPositionAt(a+r.rangeStart),c=o.getPositionAt(a+r.rangeEnd),u=H.fromPositions(l,c),d=r.underlineThickness.toLowerCase();let g=X0.NONE;switch(d){case"thin":g=X0.SECONDARY;break;case"thick":g=X0.PRIMARY;break}n.push({range:u,options:{description:"textFormatDecoration",inlineClassName:g}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,n)}_updateSelectionAndControlBoundsData(e){const t=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(this._primarySelection);if(this._primarySelection.isEmpty()){const i=e.visibleRangeForPosition(t.getStartPosition());this._linesVisibleRanges=i}else this._linesVisibleRanges=null}_updateSelectionAndControlBoundsAfterRender(){const t=this._context.configuration.options.get(165).contentLeft,i=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(this._primarySelection),n=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),r=this._context.viewLayout.getVerticalOffsetAfterLineNumber(i.endLineNumber),o=this._parent.getBoundingClientRect(),a=o.top+n-this._scrollTop,l=r-n;let c=o.left+t-this._scrollLeft,u;this._primarySelection.isEmpty()?(this._linesVisibleRanges&&(c+=this._linesVisibleRanges.left),u=0):u=o.width-t;const d=new DOMRect(c,a,u,l);this._editContext.updateSelectionBounds(d),this._editContext.updateControlBounds(d)}_updateCharacterBounds(e){const t=this._context.configuration.options,i=t.get(59).typicalHalfwidthCharacterWidth,n=t.get(165).contentLeft,r=this._parent.getBoundingClientRect(),o=[],a=new wD(this._editContext.text);for(let l=e.rangeStart;l<e.rangeEnd;l++){const c=a.getPosition(l),u=this._editContextPrimarySelection.startLineNumber-1,d=new Y(u+c.lineNumber,c.column),g=d.delta(0,1),p=H.fromPositions(d,g),_=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(p),C=this._visibleRangeProvider.linesVisibleRangesForRange(_,!0)??[],v=_.startLineNumber,x=this._context.viewLayout.getVerticalOffsetForLineNumber(v),S=r.top+x-this._scrollTop;let k=0,E=i;if(C.length>0)for(const R of C[0].ranges){k=R.left,E=R.width;break}const T=this._context.viewLayout.getLineHeightForLineNumber(v);o.push(new DOMRect(r.left+n+k-this._scrollLeft,S,E,T))}this._editContext.updateCharacterBounds(e.rangeStart,o)}_ensureClipboardGetsEditorSelection(e){const t=this._context.configuration.options,i=t.get(45),n=t.get(31),r=this._context.viewModel.getCursorStates().map(c=>c.modelState.selection),o=vZ(this._context.viewModel,r,i,n);let a;this.logService.getLevel()===yn.Trace&&(a=_6());const l={version:1,id:a,isFromEmptySelection:o.isFromEmptySelection,multicursorText:o.multicursorText,mode:o.mode};og.INSTANCE.set(Er?o.text.replace(/\r\n/g,`
`):o.text,l),e.preventDefault(),e.clipboardData&&Sk.setTextData(e.clipboardData,o.text,o.html,l),this.logService.trace("NativeEditContext#_ensureClipboardGetsEditorSelectios with id : ",a," with text.length: ",o.text.length)}};Fk=Rxe([QU(5,wt),QU(6,Ks)],Fk);class Axe extends Qs{constructor(e,t){super(e),this._viewGpuContext=t,this._gpuShapes=[],this._register(ct(i=>this._updateEntries(i)))}onConfigurationChanged(e){return this._updateEntries(void 0),!0}prepareRender(e){}render(e){}_updateEntries(e){const t=this._context.configuration.options,i=t.get(116),n=t.get(59).typicalHalfwidthCharacterWidth,r=this._viewGpuContext.devicePixelRatio.read(e);for(let o=0,a=i.length;o<a;o++){const l=i[o],c=this._gpuShapes[o],u=l.color?ae.fromHex(l.color):this._context.theme.getColor(kye)??ae.white,d=[l.column*n*r,0,Math.max(1,Math.ceil(r)),Number.MAX_SAFE_INTEGER,u.rgba.r/255,u.rgba.g/255,u.rgba.b/255,u.rgba.a];c?c.setRaw(d):this._gpuShapes[o]=this._viewGpuContext.rectangleRenderer.register(...d)}for(;this._gpuShapes.length>i.length;)this._gpuShapes.splice(-1,1)[0].dispose()}}const t2=class t2 extends Sd{constructor(e,t){super(),this._viewGpuContext=t,this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onCursorStateChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return!0}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.viewportData,r=new Nk(this._context.configuration,this._context.theme.type),o=[];for(let a=t;a<=i;a++){const l=a-t,c=this._viewGpuContext.canRenderDetailed(r,n,a);o[l]=c.length?`<div class="${t2.CLASS_NAME}" title="Cannot render on GPU: ${c.join(", ")}"></div>`:""}this._renderResult=o}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};t2.CLASS_NAME="gpu-mark";let k5=t2;var Mxe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Oxe=function(s,e){return function(t,i){e(t,i,s)}};let E5=class extends fm{constructor(e,t,i,n,r,o,a,l,c){super(),this._instantiationService=c,this._shouldRecomputeGlyphMarginLanes=!1,this._ownerID=t,this._widgetFocusTracker=this._register(new Pxe(e,l)),this._register(this._widgetFocusTracker.onChange(()=>{this._context.viewModel.setHasWidgetFocus(this._widgetFocusTracker.hasFocus())})),this._selections=[new gt(1,1,1,1)],this._renderAnimationFrame=null,this._overflowGuardContainer=bt(document.createElement("div")),Xa.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._viewController=new eye(n,o,a,i),this._context=new PSe(n,r,o),this._context.addEventHandler(this),this._viewParts=[],this._editContextEnabled=this._context.configuration.options.get(170),this._accessibilitySupport=this._context.configuration.options.get(2),this._editContext=this._instantiateEditContext(),this._viewParts.push(this._editContext),this._linesContent=bt(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=bt(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._context.configuration.options.get(46)==="on"&&(this._viewGpuContext=this._instantiationService.createInstance(No,this._context)),this._scrollbar=new Qye(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new d5(this._context,this._viewGpuContext,this._linesContent),this._viewGpuContext&&(this._viewLinesGpu=this._instantiationService.createInstance(_5,this._context,this._viewGpuContext)),this._viewZones=new ISe(this._context),this._viewParts.push(this._viewZones);const u=new ySe(this._context);this._viewParts.push(u);const d=new kSe(this._context);this._viewParts.push(d);const g=new iye(this._context);this._viewParts.push(g),g.addDynamicOverlay(new Gye(this._context)),g.addDynamicOverlay(new f5(this._context)),g.addDynamicOverlay(new rSe(this._context)),g.addDynamicOverlay(new Yye(this._context)),g.addDynamicOverlay(new ASe(this._context));const p=new nye(this._context);this._viewParts.push(p),p.addDynamicOverlay(new Kye(this._context)),p.addDynamicOverlay(new hSe(this._context)),p.addDynamicOverlay(new cSe(this._context)),p.addDynamicOverlay(new Tk(this._context)),this._viewGpuContext&&p.addDynamicOverlay(new k5(this._context,this._viewGpuContext)),this._glyphMarginWidgets=new Jye(this._context),this._viewParts.push(this._glyphMarginWidgets);const _=new Ik(this._context);_.getDomNode().appendChild(this._viewZones.marginDomNode),_.getDomNode().appendChild(p.getDomNode()),_.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(_),this._contentWidgets=new rye(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new g5(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new wSe(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const C=this._viewGpuContext?new Axe(this._context,this._viewGpuContext):new LSe(this._context);this._viewParts.push(C);const v=new sye(this._context);this._viewParts.push(v);const x=new CSe(this._context);if(this._viewParts.push(x),u){const S=this._scrollbar.getOverviewRulerLayoutInfo();S.parent.insertBefore(u.getDomNode(),S.insertBefore)}this._linesContent.appendChild(g.getDomNode()),"domNode"in C&&this._linesContent.appendChild(C.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(_.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._viewGpuContext&&this._overflowGuardContainer.appendChild(this._viewGpuContext.canvas),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(x.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),l?(l.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),l.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new yve(this._context,this._viewController,this._createPointerHandlerHelper()))}_instantiateEditContext(){return this._context.configuration.options.get(170)?this._instantiationService.createInstance(Fk,this._ownerID,this._context,this._overflowGuardContainer,this._viewController,this._createTextAreaHandlerHelper()):this._instantiationService.createInstance(C5,this._context,this._overflowGuardContainer,this._viewController,this._createTextAreaHandlerHelper())}_updateEditContext(){const e=this._context.configuration.options.get(170),t=this._context.configuration.options.get(2);if(this._editContextEnabled===e&&this._accessibilitySupport===t)return;this._editContextEnabled=e,this._accessibilitySupport=t;const i=this._editContext.isFocused(),n=this._viewParts.indexOf(this._editContext);this._editContext.dispose(),this._editContext=this._instantiateEditContext(),i&&this._editContext.focus(),n!==-1&&this._viewParts.splice(n,1,this._editContext)}_computeGlyphMarginLanes(){const e=this._context.viewModel.model,t=this._context.viewModel.glyphLanes;let i=[],n=0;i=i.concat(e.getAllMarginDecorations().map(r=>{var a,l;const o=((a=r.options.glyphMargin)==null?void 0:a.position)??dd.Center;return n=Math.max(n,r.range.endLineNumber),{range:r.range,lane:o,persist:(l=r.options.glyphMargin)==null?void 0:l.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(r=>{const o=e.validateRange(r.preference.range);return n=Math.max(n,o.endLineNumber),{range:o,lane:r.preference.lane}})),i.sort((r,o)=>H.compareRangesUsingStarts(r.range,o.range)),t.reset(n);for(const r of i)t.push(r.lane,r.range,r.persist);return t}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,viewLinesGpu:this._viewLinesGpu,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._editContext.domNode.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._editContext.getLastRenderData();return new Gwe(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>{var n;this._flushAccumulatedAndRenderNow();const i=new Y(e,t);return this._viewLines.visibleRangeForPosition(i)??((n=this._viewLinesGpu)==null?void 0:n.visibleRangeForPosition(i))??null},getLineWidth:e=>{if(this._flushAccumulatedAndRenderNow(),this._viewLinesGpu){const t=this._viewLinesGpu.getLineWidth(e);if(t!==void 0)return t}return this._viewLines.getLineWidth(e)}}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e)),linesVisibleRangesForRange:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.linesVisibleRangesForRange(e,t))}}_applyLayout(){const t=this._context.configuration.options.get(165);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const e=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(162)+" "+h5(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._updateEditContext(),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){var e,t;this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),(e=this._viewGpuContext)==null||e.dispose(),this._viewLines.dispose(),(t=this._viewLinesGpu)==null||t.dispose();for(const i of this._viewParts)i.dispose();super.dispose()}_scheduleRender(){var e;if(this._store.isDisposed)throw new Pe;if(this._renderAnimationFrame===null){this._editContext instanceof Fk&&this._editContext.setEditContextOnDomNode();const t=this._createCoordinatedRendering();this._renderAnimationFrame=D5.INSTANCE.scheduleCoordinatedRendering({window:Ae((e=this.domNode)==null?void 0:e.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Pe;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Pe;return t.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new Pe;return t.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new Pe;return t.render(i,n)}})}}_flushAccumulatedAndRenderNow(){const e=this._createCoordinatedRendering();Vu(()=>e.prepareRenderText());const t=Vu(()=>e.renderText());if(t){const[i,n]=t;Vu(()=>e.prepareRender(i,n)),Vu(()=>e.render(i,n))}}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}Pu.onRenderStart()},renderText:()=>{var n;if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new MSe(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),(n=this._viewLinesGpu)!=null&&n.shouldRender()&&(this._viewLinesGpu.renderText(i),this._viewLinesGpu.onDidRender()),[e,new zwe(this._context.viewLayout,i,this._viewLines,this._viewLinesGpu)]},prepareRender:(e,t)=>{for(const i of e)i.prepareRender(t)},render:(e,t)=>{for(const i of e)i.render(t),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const r=this._viewLines.visibleRangeForPosition(new Y(n.lineNumber,n.column));return r?r.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?RD.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new xSe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._editContext.writeScreenReaderContent(e)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}isWidgetFocused(){return this._widgetFocusTracker.hasFocus()}setAriaOptions(e){this._editContext.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,n,r;this._contentWidgets.setWidgetPosition(e.widget,((t=e.position)==null?void 0:t.position)??null,((i=e.position)==null?void 0:i.secondaryPosition)??null,((n=e.position)==null?void 0:n.preference)??null,((r=e.position)==null?void 0:r.positionAffinity)??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};E5=Mxe([Oxe(8,wt)],E5);function Vu(s){try{return s()}catch(e){return It(e),null}}const i2=class i2{constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{const t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(const[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){const t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,GQ(e,t,100))}}_onRenderScheduled(){const e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of e)Vu(()=>i.prepareRenderText());const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];t[i]=Vu(()=>r.renderText())}for(let i=0,n=e.length;i<n;i++){const r=e[i],o=t[i];if(!o)continue;const[a,l]=o;Vu(()=>r.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){const r=e[i],o=t[i];if(!o)continue;const[a,l]=o;Vu(()=>r.render(a,l))}}};i2.INSTANCE=new i2;let D5=i2;class Pxe extends ne{constructor(e,t){super(),this._onChange=this._register(new $),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(h1(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(h1(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class Z0{constructor(e,t,i,n,r){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&n>this.injectionOffsets[r];r++)n<this.injectionOffsets[r]+this.injectionOptions[r].content.length?n=this.injectionOffsets[r]:n-=this.injectionOptions[r].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,r=0,o=0;for(;i<=n;){r=i+(n-i)/2|0;const l=this.breakOffsets[r];if(o=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=o)n=r-1;else if(e>l)i=r+1;else break;else if(e<o)n=r-1;else if(e>=l)i=r+1;else break}let a=e-o;return r>0&&(a+=this.wrappedTextIndentLength),new GS(r,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const n=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(r!==n)return this.offsetInInputWithInjectionsToOutputPosition(r,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new GS(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new GS(e+1,this.getMinOutputOffset(e+1))}return new GS(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&XU(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(ZU(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let r=i.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[i.injectedTextIndex]&&!(XU(this.injectionOptions[r].cursorStops)||(n-=this.injectionOptions[r].content.length,ZU(this.injectionOptions[r].cursorStops)));)r--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,r=i.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)n+=this.injectionOptions[r+1].content.length,r++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,r=i.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)n-=this.injectionOptions[r-1].content.length,r--;return n}r7()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let r=0;r<t.length;r++){const o=i[r].content.length,a=t[r]+n,l=t[r]+n+o;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:o};n+=o}}}}function XU(s){return s==null?!0:s===g1.Right||s===g1.Both}function ZU(s){return s==null?!0:s===g1.Left||s===g1.Both}class GS{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new Y(e+this.outputLineIndex,this.outputOffset+1)}}class Fxe{constructor(){this.changeType=1}}class Za{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(const r of t)i+=e.substring(n,r.column-1),n=r.column-1,i+=r.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new Za(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new Za(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}constructor(e,t,i,n,r){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=r}}class JU{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class Bxe{constructor(e,t,i,n){this.ownerId=e,this.decorationId=t,this.lineNumber=i,this.lineHeight=n}}class Vxe{constructor(e,t){this.ownerId=e,this.lineNumber=t}}class Wxe{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class Hxe{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class zxe{constructor(){this.changeType=5}}class A_{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,r=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing;return new A_(i,n,r,o)}}class tJ{constructor(e){this.changes=e}}let iJ=class{constructor(e){this.changes=e}},nJ=class{constructor(e){this.changes=e}};class cg{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=A_.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=cg._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new cg(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.eol,r=t.versionId,o=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:c,versionId:r,isUndoing:o,isRedoing:a,isFlush:l,detailedReasons:e.detailedReasons.concat(t.detailedReasons),detailedReasonsChangeLengths:e.detailedReasonsChangeLengths.concat(t.detailedReasonsChangeLengths)}}}const yR=yd("domLineBreaksComputer",{createHTML:s=>s});class E6{static create(e){return new E6(new WeakRef(e))}constructor(e){this.targetWindow=e}createLineBreaksComputer(e,t,i,n,r,o){const a=[],l=[];return{addRequest:(c,u,d)=>{a.push(c),l.push(u)},finalize:()=>Uxe(JY(this.targetWindow.deref()),a,e,t,i,n,r,l)}}}function Uxe(s,e,t,i,n,r,o,a){function l(O){const W=a[O];if(W){const j=Za.applyInjectedText(e[O],W),F=W.map(Z=>Z.options),q=W.map(Z=>Z.column-1);return new Z0(q,F,[j.length],[],0)}else return null}if(n===-1){const O=[];for(let W=0,j=e.length;W<j;W++)O[W]=l(W);return O}const c=Math.round(n*t.typicalHalfwidthCharacterWidth),d=Math.round(i*(r===3?2:r===2?1:0)),g=Math.ceil(t.spaceWidth*d),p=document.createElement("div");Jn(p,t);const _=new z1(1e4),C=[],v=[],x=[],S=[],k=[];for(let O=0;O<e.length;O++){const W=Za.applyInjectedText(e[O],a[O]);let j=0,F=0,q=c;if(r!==0)if(j=Lr(W),j===-1)j=0;else{for(let G=0;G<j;G++){const Q=W.charCodeAt(G)===9?i-F%i:1;F+=Q}const U=Math.ceil(t.spaceWidth*F);U+t.typicalFullwidthCharacterWidth>c?(j=0,F=0):q=c-U}const Z=W.substr(j),K=jxe(Z,F,i,q,_,g);C[O]=j,v[O]=F,x[O]=Z,S[O]=K[0],k[O]=K[1]}const E=_.build(),T=(yR==null?void 0:yR.createHTML(E))??E;p.innerHTML=T,p.style.position="absolute",p.style.top="10000",o==="keepAll"?(p.style.wordBreak="keep-all",p.style.overflowWrap="anywhere"):(p.style.wordBreak="inherit",p.style.overflowWrap="break-word"),s.document.body.appendChild(p);const R=document.createRange(),N=Array.prototype.slice.call(p.children,0),A=[];for(let O=0;O<e.length;O++){const W=N[O],j=$xe(R,W,x[O],S[O]);if(j===null){A[O]=l(O);continue}const F=C[O],q=v[O]+d,Z=k[O],K=[];for(let le=0,ve=j.length;le<ve;le++)K[le]=Z[j[le]];if(F!==0)for(let le=0,ve=j.length;le<ve;le++)j[le]+=F;let U,G;const Q=a[O];Q?(U=Q.map(le=>le.options),G=Q.map(le=>le.column-1)):(U=null,G=null),A[O]=new Z0(G,U,j,K,q)}return p.remove(),A}function jxe(s,e,t,i,n,r){if(r!==0){const g=String(r);n.appendString('<div style="text-indent: -'),n.appendString(g),n.appendString("px; padding-left: "),n.appendString(g),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');const o=s.length;let a=e,l=0;const c=[],u=[];let d=0<o?s.charCodeAt(0):0;n.appendString("<span>");for(let g=0;g<o;g++){g!==0&&g%16384===0&&n.appendString("</span><span>"),c[g]=l,u[g]=a;const p=d;d=g+1<o?s.charCodeAt(g+1):0;let _=1,C=1;switch(p){case 9:_=t-a%t,C=_;for(let v=1;v<=_;v++)v<_?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:d===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:Mh(p)&&C++,p<32?n.appendCharCode(9216+p):n.appendCharCode(p)}l+=_,a+=C}return n.appendString("</span>"),c[s.length]=l,u[s.length]=a,n.appendString("</div>"),[c,u]}function $xe(s,e,t,i){if(t.length<=1)return null;const n=Array.prototype.slice.call(e.children,0),r=[];try{T5(s,n,i,0,null,t.length-1,null,r)}catch(o){return console.log(o),null}return r.length===0?null:(r.push(t.length),r)}function T5(s,e,t,i,n,r,o,a){if(i===r||(n=n||SR(s,e,t[i],t[i+1]),o=o||SR(s,e,t[r],t[r+1]),Math.abs(n[0].top-o[0].top)<=.1))return;if(i+1===r){a.push(r);return}const l=i+(r-i)/2|0,c=SR(s,e,t[l],t[l+1]);T5(s,e,t,i,n,l,c,a),T5(s,e,t,l,c,r,o,a)}function SR(s,e,t,i){return s.setStart(e[t/16384|0].firstChild,t%16384),s.setEnd(e[i/16384|0].firstChild,i%16384),s.getClientRects()}class qxe extends ne{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new u7),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t){if(this._pending.has(n.id)){It(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(FS(Ae(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(FS(Ae(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(FS(Ae(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){var e;return FS(Ae((e=this._editor)==null?void 0:e.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){It(i)}}}}class sJ{constructor(e,t,i,n,r,o,a){this.id=e,this.label=t,this.alias=i,this.metadata=n,this._precondition=r,this._run=o,this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}function S1(s){let e=0,t=0,i=0,n=0;for(let r=0,o=s.length;r<o;r++){const a=s.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<o&&s.charCodeAt(r+1)===10?(n|=2,r++):n|=3,i=r+1):a===10&&(n|=1,e===0&&(t=r),e++,i=r+1)}return e===0&&(t=s.length),[e,t,s.length-i,n]}class ej{constructor(e,t,i,n){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=n}}class Gxe{constructor(e,t,i,n,r,o){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n,this.nestingLevelOfEqualBracketType=r,this.bracketPairNode=o}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class Kxe extends Gxe{constructor(e,t,i,n,r,o,a){super(e,t,i,n,r,o),this.minVisibleColumnIndentation=a}}function Yxe(s,e,t,i){return s!==t?Oi(t-s,i):Oi(0,i-e)}const or=0;function Bk(s){return s===0}const so=2**26;function Oi(s,e){return s*so+e}function Vo(s){const e=s,t=Math.floor(e/so),i=e-t*so;return new Dr(t,i)}function Qxe(s){return Math.floor(s/so)}function Xi(s,e){let t=s+e;return e>=so&&(t=t-s%so),t}function Xxe(s,e){return s.reduce((t,i)=>Xi(t,e(i)),or)}function rJ(s,e){return s===e}function Ww(s,e){const t=s,i=e;if(i-t<=0)return or;const r=Math.floor(t/so),o=Math.floor(i/so),a=i-o*so;if(r===o){const l=t-r*so;return Oi(0,a-l)}else return Oi(o-r,a)}function M_(s,e){return s<e}function O_(s,e){return s<=e}function S0(s,e){return s>=e}function Yp(s){return Oi(s.lineNumber-1,s.column-1)}function hg(s,e){const t=s,i=Math.floor(t/so),n=t-i*so,r=e,o=Math.floor(r/so),a=r-o*so;return new H(i+1,n+1,o+1,a+1)}function Zxe(s){const e=F1(s);return Oi(e.length-1,e[e.length-1].length)}class _h{static fromModelContentChanges(e){return e.map(i=>{const n=H.lift(i.range);return new _h(Yp(n.getStartPosition()),Yp(n.getEndPosition()),Zxe(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${Vo(this.startOffset)}...${Vo(this.endOffset)}) -> ${Vo(this.newLength)}`}}class Jxe{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>D6.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:Ww(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Oi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Oi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=Vo(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Oi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Oi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(O_(i,e)){this.nextEditIdx++;const n=Vo(i),r=Vo(this.translateOldToCur(t.endOffsetBeforeObj)),o=n.lineCount-r.lineCount;this.deltaOldToNewLineCount+=o;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class D6{static from(e){return new D6(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=Vo(t),this.endOffsetAfterObj=Vo(Xi(e,i)),this.offsetObj=Vo(e)}}const KS=[],So=class So{static create(e,t){if(e<=128&&t.length===0){let i=So.cache[e];return i||(i=new So(e,t),So.cache[e]=i),i}return new So(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let n=i>>5;if(n===0){const o=1<<i|this.items;return o===this.items?this:So.create(o,this.additionalItems)}n--;const r=this.additionalItems.slice(0);for(;r.length<n;)r.push(0);return r[n]|=1<<(i&31),So.create(this.items,r)}merge(e){const t=this.items|e.items;if(this.additionalItems===KS&&e.additionalItems===KS)return t===this.items?this:t===e.items?e:So.create(t,KS);const i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const r=this.additionalItems[n]||0,o=e.additionalItems[n]||0;i.push(r|o)}return So.create(t,i)}intersects(e){if((this.items&e.items)!==0)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if((this.additionalItems[t]&e.additionalItems[t])!==0)return!0;return!1}};So.cache=new Array(129),So.empty=So.create(0,KS);let vr=So;const tj={getKey(s){return s}};class eLe{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class T6{get length(){return this._length}constructor(e){this._length=e}}class Hw extends T6{static create(e,t,i){let n=e.length;return t&&(n=Xi(n,t.length)),i&&(n=Xi(n,i.length)),new Hw(n,e,t,i,t?t.missingOpeningBracketIds:vr.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,n,r){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=r}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new Hw(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(Xi(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class Zl extends T6{static create23(e,t,i,n=!1){let r=e.length,o=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(r=Xi(r,t.length),o=o.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");r=Xi(r,i.length),o=o.merge(i.missingOpeningBracketIds)}return n?new tLe(r,e.listHeight+1,e,t,i,o):new zw(r,e.listHeight+1,e,t,i,o)}static getEmpty(){return new iLe(or,0,[],vr.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new Pe;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const r=this.getChild(n);t=Xi(t,r.length),i=i.merge(r.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let r=0;r<this.childrenLength;r++){const o=this.getChild(r);o&&(i=Math.min(i,o.computeMinIndentation(n,t)),n=Xi(n,o.length))}return this.cachedMinIndentation=i,i}}class zw extends Zl{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,n,r,o){super(e,t,o),this._item1=i,this._item2=n,this._item3=r}deepClone(){return new zw(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class tLe extends zw{toMutable(){return new zw(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class Vk extends Zl{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,n){super(e,t,n),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new Vk(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class iLe extends Vk{toMutable(){return new Vk(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const nLe=[];class N6 extends T6{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return nLe}deepClone(){return this}}class Lf extends N6{get kind(){return 0}get missingOpeningBracketIds(){return vr.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=Vo(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,r=Qxe(Xi(e,this.length))+1;let o=Number.MAX_SAFE_INTEGER;for(let a=n;a<=r;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const u=_i.visibleColumnFromColumn(c,l,t.getOptions().tabSize);o=Math.min(o,u)}return o}}class Wk extends N6{static create(e,t,i){return new Wk(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return vr.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class sLe extends N6{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let Ru=class{constructor(e,t,i,n,r){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=r}};class rLe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new oLe(this.textModel,this.bracketTokens),this._offset=or,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Oi(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=Xi(this._offset,e);const t=Vo(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=Xi(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class oLe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const r=this.lineTokens,o=r.getCount();let a=null;if(this.lineTokenOffset<o){const l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<o&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Qr.getTokenType(l)===0,u=Qr.containsBalancedBrackets(l),d=r.getEndOffset(this.lineTokenOffset);if(u&&c&&this.lineCharOffset<d){const g=r.getLanguageId(this.lineTokenOffset),p=this.line.substring(this.lineCharOffset,d),_=this.bracketTokens.getSingleLanguageBracketTokens(g),C=_.regExpGlobal;if(C){C.lastIndex=0;const v=C.exec(p);v&&(a=_.getToken(v[0]),a&&(this.lineCharOffset+=v.index))}}if(i+=d-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=d}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const n=Yxe(e,t,this.lineIdx,this.lineCharOffset);return new Ru(n,0,-1,vr.getEmpty(),new Lf(n))}}class aLe{constructor(e,t){this.text=e,this._offset=or,this.idx=0;const i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,r=[];let o,a=0,l=0,c=0,u=0;const d=[];for(let _=0;_<60;_++)d.push(new Ru(Oi(0,_),0,-1,vr.getEmpty(),new Lf(Oi(0,_))));const g=[];for(let _=0;_<60;_++)g.push(new Ru(Oi(1,_),0,-1,vr.getEmpty(),new Lf(Oi(1,_))));if(n)for(n.lastIndex=0;(o=n.exec(e))!==null;){const _=o.index,C=o[0];if(C===`
`)a++,l=_+1;else{if(c!==_){let v;if(u===a){const x=_-c;if(x<d.length)v=d[x];else{const S=Oi(0,x);v=new Ru(S,0,-1,vr.getEmpty(),new Lf(S))}}else{const x=a-u,S=_-l;if(x===1&&S<g.length)v=g[S];else{const k=Oi(x,S);v=new Ru(k,0,-1,vr.getEmpty(),new Lf(k))}}r.push(v)}r.push(t.getToken(C)),c=_+C.length,u=a}}const p=e.length;if(c!==p){const _=u===a?Oi(0,p-c):Oi(a-u,p-l);r.push(new Ru(_,0,-1,vr.getEmpty(),new Lf(_)))}this.length=Oi(a,p-l),this.tokens=r}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new Tfe}}class I6{static createFromLanguage(e,t){function i(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}const n=new Map;for(const r of e.bracketsNew.openingBrackets){const o=Oi(0,r.bracketText.length),a=i(r),l=vr.getEmpty().add(a,tj);n.set(r.bracketText,new Ru(o,1,a,l,Wk.create(o,r,l)))}for(const r of e.bracketsNew.closingBrackets){const o=Oi(0,r.bracketText.length);let a=vr.getEmpty();const l=r.getOpeningBrackets();for(const c of l)a=a.add(i(c),tj);n.set(r.bracketText,new Ru(o,2,i(l[0]),a,Wk.create(o,r,a)))}return new I6(n)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>lLe(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function lLe(s){let e=Yl(s);return/^[\w ]+/.test(s)&&(e=`\\b${e}`),/[\w ]+$/.test(s)&&(e=`${e}\\b`),e}class cLe{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=I6.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function hLe(s){if(s.length===0)return null;if(s.length===1)return s[0];let e=0;function t(){if(e>=s.length)return null;const o=e,a=s[o].listHeight;for(e++;e<s.length&&s[e].listHeight===a;)e++;return e-o>=2?oJ(o===0&&e===s.length?s:s.slice(o,e),!1):s[o]}let i=t(),n=t();if(!n)return i;for(let o=t();o;o=t())ij(i,n)<=ij(n,o)?(i=xR(i,n),n=o):n=xR(n,o);return xR(i,n)}function oJ(s,e=!1){if(s.length===0)return null;if(s.length===1)return s[0];let t=s.length;for(;t>3;){const i=t>>1;for(let n=0;n<i;n++){const r=n<<1;s[n]=Zl.create23(s[r],s[r+1],r+3===t?s[r+2]:null,e)}t=i}return Zl.create23(s[0],s[1],t>=3?s[2]:null,e)}function ij(s,e){return Math.abs(s.listHeight-e.listHeight)}function xR(s,e){return s.listHeight===e.listHeight?Zl.create23(s,e,null,!1):s.listHeight>e.listHeight?uLe(s,e):dLe(e,s)}function uLe(s,e){s=s.toMutable();let t=s;const i=[];let n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let r=i.length-1;r>=0;r--){const o=i[r];n?o.childrenLength>=3?n=Zl.create23(o.unappendChild(),n,null,!1):(o.appendChildOfSameHeight(n),n=void 0):o.handleChildrenChanged()}return n?Zl.create23(s,n,null,!1):s}function dLe(s,e){s=s.toMutable();let t=s;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let r=i.length-1;r>=0;r--){const o=i[r];n?o.childrenLength>=3?n=Zl.create23(n,o.unprependChild(),null,!1):(o.prependChildOfSameHeight(n),n=void 0):o.handleChildrenChanged()}return n?Zl.create23(n,s,null,!1):s}class fLe{constructor(e){this.lastOffset=or,this.nextNodes=[e],this.offsets=[or],this.idxs=[]}readLongestNodeAt(e,t){if(M_(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=n0(this.nextNodes);if(!i)return;const n=n0(this.offsets);if(M_(e,n))return;if(M_(n,e))if(Xi(n,i.length)<=e)this.nextNodeAfterCurrent();else{const r=LR(i);r!==-1?(this.nextNodes.push(i.getChild(r)),this.offsets.push(n),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const r=LR(i);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(r)),this.offsets.push(n),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){const e=n0(this.offsets),t=n0(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=n0(this.nextNodes),n=LR(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(Xi(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}}function LR(s,e=-1){for(;;){if(e++,e>=s.childrenLength)return-1;if(s.getChild(e))return e}}function n0(s){return s.length>0?s[s.length-1]:void 0}function nj(s,e,t,i){return new gLe(s,e,t,i).parseDocument()}class gLe{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new fLe(i):void 0,this.positionMapper=new Jxe(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(vr.getEmpty(),0);return e||(e=Zl.getEmpty()),e}parseList(e,t){const i=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){const o=this.tokenizer.peek();if(!o||o.kind===2&&o.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||i.push(r)}return this.oldNodeReader?hLe(i):oJ(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Bk(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!M_(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new sLe(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new Lf(i.length);const n=e.merge(i.bracketIds),r=this.parseList(n,t+1),o=this.tokenizer.peek();return o&&o.kind===2&&(o.bracketId===i.bracketId||o.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),Hw.create(i.astNode,r,o.astNode)):Hw.create(i.astNode,r,null)}default:throw new Error("unexpected")}}}function Hk(s,e){if(s.length===0)return e;if(e.length===0)return s;const t=new Rh(sj(s)),i=sj(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function r(c){if(c===void 0){const d=t.takeWhile(g=>!0)||[];return n&&d.unshift(n),d}const u=[];for(;n&&!Bk(c);){const[d,g]=n.splitAt(c);u.push(d),c=Ww(d.lengthAfter,c),n=g??t.dequeue()}return Bk(c)||u.push(new Wu(!1,c,c)),u}const o=[];function a(c,u,d){if(o.length>0&&rJ(o[o.length-1].endOffset,c)){const g=o[o.length-1];o[o.length-1]=new _h(g.startOffset,u,Xi(g.newLength,d))}else o.push({startOffset:c,endOffset:u,newLength:d})}let l=or;for(const c of i){const u=r(c.lengthBefore);if(c.modified){const d=Xxe(u,p=>p.lengthBefore),g=Xi(l,d);a(l,g,c.lengthAfter),l=g}else for(const d of u){const g=l;l=Xi(l,d.lengthBefore),d.modified&&a(g,l,d.lengthAfter)}}return o}class Wu{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=Ww(e,this.lengthAfter);return rJ(t,or)?[this,void 0]:this.modified?[new Wu(this.modified,this.lengthBefore,e),new Wu(this.modified,or,t)]:[new Wu(this.modified,e,e),new Wu(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Vo(this.lengthBefore)} -> ${Vo(this.lengthAfter)}`}}function sj(s){const e=[];let t=or;for(const i of s){const n=Ww(t,i.startOffset);Bk(n)||e.push(new Wu(!1,n,n));const r=Ww(i.startOffset,i.endOffset);e.push(new Wu(!0,r,i.newLength)),t=i.endOffset}return e}class mLe extends ne{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new $,this.denseKeyProvider=new eLe,this.brackets=new cLe(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),n=new aLe(this.textModel.getValue(),i);this.initialAstWithoutTokens=nj(n,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new _h(Oi(i.fromLineNumber-1,0),Oi(i.toLineNumber,0),Oi(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=_h.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=Hk(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=Hk(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const n=t,r=new rLe(this.textModel,this.brackets);return nj(r,e,n,i)}getBracketsInRange(e,t){this.flushQueue();const i=Oi(e.startLineNumber-1,e.startColumn-1),n=Oi(e.endLineNumber-1,e.endColumn-1);return new ig(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens;N5(o,or,o.length,i,n,r,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=Yp(e.getStartPosition()),n=Yp(e.getEndPosition());return new ig(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens,a=new pLe(r,t,this.textModel);I5(o,or,o.length,i,n,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return lJ(t,or,t.length,Yp(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return aJ(t,or,t.length,Yp(e))}}function aJ(s,e,t,i){if(s.kind===4||s.kind===2){const n=[];for(const r of s.children)t=Xi(e,r.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=n.length-1;r>=0;r--){const{nodeOffsetStart:o,nodeOffsetEnd:a}=n[r];if(M_(o,i)){const l=aJ(s.children[r],o,a,i);if(l)return l}}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=hg(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function lJ(s,e,t,i){if(s.kind===4||s.kind===2){for(const n of s.children){if(t=Xi(e,n.length),M_(i,t)){const r=lJ(n,e,t,i);if(r)return r}e=t}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=hg(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function N5(s,e,t,i,n,r,o,a,l,c,u=!1){if(o>200)return!0;e:for(;;)switch(s.kind){case 4:{const d=s.childrenLength;for(let g=0;g<d;g++){const p=s.getChild(g);if(p){if(t=Xi(e,p.length),O_(e,n)&&S0(t,i)){if(S0(t,n)){s=p;continue e}if(!N5(p,e,t,i,n,r,o,0,l,c))return!1}e=t}}return!0}case 2:{const d=!c||!s.closingBracket||s.closingBracket.bracketInfo.closesColorized(s.openingBracket.bracketInfo);let g=0;if(l){let _=l.get(s.openingBracket.text);_===void 0&&(_=0),g=_,d&&(_++,l.set(s.openingBracket.text,_))}const p=s.childrenLength;for(let _=0;_<p;_++){const C=s.getChild(_);if(C){if(t=Xi(e,C.length),O_(e,n)&&S0(t,i)){if(S0(t,n)&&C.kind!==1){s=C,d?(o++,a=g+1):a=g;continue e}if((d||C.kind!==1||!s.closingBracket)&&!N5(C,e,t,i,n,r,d?o+1:o,d?g+1:g,l,c,!s.closingBracket))return!1}e=t}}return l==null||l.set(s.openingBracket.text,g),!0}case 3:{const d=hg(e,t);return r(new ej(d,o-1,0,!0))}case 1:{const d=hg(e,t);return r(new ej(d,o-1,a-1,u))}case 0:return!0}}class pLe{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function I5(s,e,t,i,n,r,o,a){var c;if(o>200)return!0;let l=!0;if(s.kind===2){let u=0;if(a){let p=a.get(s.openingBracket.text);p===void 0&&(p=0),u=p,p++,a.set(s.openingBracket.text,p)}const d=Xi(e,s.openingBracket.length);let g=-1;if(r.includeMinIndentation&&(g=s.computeMinIndentation(e,r.textModel)),l=r.push(new Kxe(hg(e,t),hg(e,d),s.closingBracket?hg(Xi(d,((c=s.child)==null?void 0:c.length)||or),t):void 0,o,u,s,g)),e=d,l&&s.child){const p=s.child;if(t=Xi(e,p.length),O_(e,n)&&S0(t,i)&&(l=I5(p,e,t,i,n,r,o+1,a),!l))return!1}a==null||a.set(s.openingBracket.text,u)}else{let u=e;for(const d of s.children){const g=u;if(u=Xi(u,d.length),O_(g,n)&&O_(i,u)&&(l=I5(d,g,u,i,n,r,o,a),!l))return!1}}return l}class _Le extends ne{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new kn),this.onDidChangeEmitter=new $,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(e){var t;(!e.languageId||(t=this.bracketPairsTree.value)!=null&&t.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;(e=this.bracketPairsTree.value)==null||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new Ee;this.bracketPairsTree.value=bLe(e.add(new mLe(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!1))||ig.empty}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!0))||ig.empty}getBracketsInRange(e,t=!1){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)==null?void 0:i.object.getBracketsInRange(e,t))||ig.empty}findMatchingBracketUp(e,t,i){const n=this.textModel.validatePosition(t),r=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column);if(this.canBuildAST){const o=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew.getClosingBracketInfo(e);if(!o)return null;const a=this.getBracketPairsInRange(H.fromPositions(t,t)).findLast(l=>o.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const o=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(r).brackets;if(!a)return null;const l=a.textIsBracket[o];return l?YS(this._findMatchingBracketUp(l,n,kR(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(H.fromPositions(e,e)).filter(n=>n.closingBracketRange!==void 0&&(n.openingBracketRange.containsPosition(e)||n.closingBracketRange.containsPosition(e))).findLastMaxBy(oo(n=>n.openingBracketRange.containsPosition(e)?n.openingBracketRange:n.closingBracketRange,H.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=kR(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,n){const r=t.getCount(),o=t.getLanguageId(n);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=n-1;c>=0;c--){const u=t.getEndOffset(c);if(u<=a)break;if(_l(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){a=u;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=n+1;c<r;c++){const u=t.getStartOffset(c);if(u>=l)break;if(_l(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){l=u;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.tokenization.getLineTokens(i),r=this.textModel.getLineContent(i),o=n.findTokenIndexAtOffset(e.column-1);if(o<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(o)).brackets;if(a&&!_l(n.getStandardTokenType(o))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,n,a,o),u=null;for(;;){const d=ta.findNextBracketInRange(a.forwardRegex,i,r,l,c);if(!d)break;if(d.startColumn<=e.column&&e.column<=d.endColumn){const g=r.substring(d.startColumn-1,d.endColumn-1).toLowerCase(),p=this._matchFoundBracket(d,a.textIsBracket[g],a.textIsOpenBracket[g],t);if(p){if(p instanceof nh)return null;u=p}}l=d.endColumn-1}if(u)return u}if(o>0&&n.getStartOffset(o)===e.column-1){const l=o-1,c=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(l)).brackets;if(c&&!_l(n.getStandardTokenType(l))){const{searchStartOffset:u,searchEndOffset:d}=this._establishBracketSearchOffsets(e,n,c,l),g=ta.findPrevBracketInRange(c.reversedRegex,i,r,u,d);if(g&&g.startColumn<=e.column&&e.column<=g.endColumn){const p=r.substring(g.startColumn-1,g.endColumn-1).toLowerCase(),_=this._matchFoundBracket(g,c.textIsBracket[p],c.textIsOpenBracket[p],t);if(_)return _ instanceof nh?null:_}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const r=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return r?r instanceof nh?r:[e,r]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,r=e.reversedRegex;let o=-1,a=0;const l=(c,u,d,g)=>{for(;;){if(i&&++a%100===0&&!i())return nh.INSTANCE;const p=ta.findPrevBracketInRange(r,c,u,d,g);if(!p)break;const _=u.substring(p.startColumn-1,p.endColumn-1).toLowerCase();if(e.isOpen(_)?o++:e.isClose(_)&&o--,o===0)return p;g=p.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const u=this.textModel.tokenization.getLineTokens(c),d=u.getCount(),g=this.textModel.getLineContent(c);let p=d-1,_=g.length,C=g.length;c===t.lineNumber&&(p=u.findTokenIndexAtOffset(t.column-1),_=t.column-1,C=t.column-1);let v=!0;for(;p>=0;p--){const x=u.getLanguageId(p)===n&&!_l(u.getStandardTokenType(p));if(x)v?_=u.getStartOffset(p):(_=u.getStartOffset(p),C=u.getEndOffset(p));else if(v&&_!==C){const S=l(c,g,_,C);if(S)return S}v=x}if(v&&_!==C){const x=l(c,g,_,C);if(x)return x}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,r=e.forwardRegex;let o=1,a=0;const l=(u,d,g,p)=>{for(;;){if(i&&++a%100===0&&!i())return nh.INSTANCE;const _=ta.findNextBracketInRange(r,u,d,g,p);if(!_)break;const C=d.substring(_.startColumn-1,_.endColumn-1).toLowerCase();if(e.isOpen(C)?o++:e.isClose(C)&&o--,o===0)return _;g=_.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=t.lineNumber;u<=c;u++){const d=this.textModel.tokenization.getLineTokens(u),g=d.getCount(),p=this.textModel.getLineContent(u);let _=0,C=0,v=0;u===t.lineNumber&&(_=d.findTokenIndexAtOffset(t.column-1),C=t.column-1,v=t.column-1);let x=!0;for(;_<g;_++){const S=d.getLanguageId(_)===n&&!_l(d.getStandardTokenType(_));if(S)x||(C=d.getStartOffset(_)),v=d.getEndOffset(_);else if(x&&C!==v){const k=l(u,p,C,v);if(k)return k}x=S}if(x&&C!==v){const S=l(u,p,C,v);if(S)return S}}return null}findPrevBracket(e){var o;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((o=this.bracketPairsTree.value)==null?void 0:o.object.getFirstBracketBefore(t))||null;let i=null,n=null,r=null;for(let a=t.lineNumber;a>=1;a--){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),u=this.textModel.getLineContent(a);let d=c-1,g=u.length,p=u.length;if(a===t.lineNumber){d=l.findTokenIndexAtOffset(t.column-1),g=t.column-1,p=t.column-1;const C=l.getLanguageId(d);i!==C&&(i=C,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let _=!0;for(;d>=0;d--){const C=l.getLanguageId(d);if(i!==C){if(n&&r&&_&&g!==p){const x=ta.findPrevBracketInRange(n.reversedRegex,a,u,g,p);if(x)return this._toFoundBracket(r,x);_=!1}i=C,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}const v=!!n&&!_l(l.getStandardTokenType(d));if(v)_?g=l.getStartOffset(d):(g=l.getStartOffset(d),p=l.getEndOffset(d));else if(r&&n&&_&&g!==p){const x=ta.findPrevBracketInRange(n.reversedRegex,a,u,g,p);if(x)return this._toFoundBracket(r,x)}_=v}if(r&&n&&_&&g!==p){const C=ta.findPrevBracketInRange(n.reversedRegex,a,u,g,p);if(C)return this._toFoundBracket(r,C)}}return null}findNextBracket(e){var a;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((a=this.bracketPairsTree.value)==null?void 0:a.object.getFirstBracketAfter(t))||null;const i=this.textModel.getLineCount();let n=null,r=null,o=null;for(let l=t.lineNumber;l<=i;l++){const c=this.textModel.tokenization.getLineTokens(l),u=c.getCount(),d=this.textModel.getLineContent(l);let g=0,p=0,_=0;if(l===t.lineNumber){g=c.findTokenIndexAtOffset(t.column-1),p=t.column-1,_=t.column-1;const v=c.getLanguageId(g);n!==v&&(n=v,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let C=!0;for(;g<u;g++){const v=c.getLanguageId(g);if(n!==v){if(o&&r&&C&&p!==_){const S=ta.findNextBracketInRange(r.forwardRegex,l,d,p,_);if(S)return this._toFoundBracket(o,S);C=!1}n=v,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const x=!!r&&!_l(c.getStandardTokenType(g));if(x)C||(p=c.getStartOffset(g)),_=c.getEndOffset(g);else if(o&&r&&C&&p!==_){const S=ta.findNextBracketInRange(r.forwardRegex,l,d,p,_);if(S)return this._toFoundBracket(o,S)}C=x}if(o&&r&&C&&p!==_){const v=ta.findNextBracketInRange(r.forwardRegex,l,d,p,_);if(v)return this._toFoundBracket(o,v)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const p=H.fromPositions(i),_=this.getBracketPairsInRange(H.fromPositions(i,i)).findLast(C=>C.closingBracketRange!==void 0&&C.range.strictContainsRange(p));return _?[_.openingBracketRange,_.closingBracketRange]:null}const n=kR(t),r=this.textModel.getLineCount(),o=new Map;let a=[];const l=(p,_)=>{if(!o.has(p)){const C=[];for(let v=0,x=_?_.brackets.length:0;v<x;v++)C[v]=0;o.set(p,C)}a=o.get(p)};let c=0;const u=(p,_,C,v,x)=>{for(;;){if(n&&++c%100===0&&!n())return nh.INSTANCE;const S=ta.findNextBracketInRange(p.forwardRegex,_,C,v,x);if(!S)break;const k=C.substring(S.startColumn-1,S.endColumn-1).toLowerCase(),E=p.textIsBracket[k];if(E&&(E.isOpen(k)?a[E.index]++:E.isClose(k)&&a[E.index]--,a[E.index]===-1))return this._matchFoundBracket(S,E,!1,n);v=S.endColumn-1}return null};let d=null,g=null;for(let p=i.lineNumber;p<=r;p++){const _=this.textModel.tokenization.getLineTokens(p),C=_.getCount(),v=this.textModel.getLineContent(p);let x=0,S=0,k=0;if(p===i.lineNumber){x=_.findTokenIndexAtOffset(i.column-1),S=i.column-1,k=i.column-1;const T=_.getLanguageId(x);d!==T&&(d=T,g=this.languageConfigurationService.getLanguageConfiguration(d).brackets,l(d,g))}let E=!0;for(;x<C;x++){const T=_.getLanguageId(x);if(d!==T){if(g&&E&&S!==k){const N=u(g,p,v,S,k);if(N)return YS(N);E=!1}d=T,g=this.languageConfigurationService.getLanguageConfiguration(d).brackets,l(d,g)}const R=!!g&&!_l(_.getStandardTokenType(x));if(R)E||(S=_.getStartOffset(x)),k=_.getEndOffset(x);else if(g&&E&&S!==k){const N=u(g,p,v,S,k);if(N)return YS(N)}E=R}if(g&&E&&S!==k){const T=u(g,p,v,S,k);if(T)return YS(T)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.getBracketInfo(i);return n?{range:t,bracketInfo:n}:null}}function bLe(s,e){return{object:s,dispose:()=>e==null?void 0:e.dispose()}}function kR(s){if(typeof s>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=s}}const n2=class n2{constructor(){this._searchCanceledBrand=void 0}};n2.INSTANCE=new n2;let nh=n2;function YS(s){return s instanceof nh?null:s}class CLe extends ne{constructor(e){super(),this.textModel=e,this.colorProvider=new cJ,this.onDidChangeEmitter=new $,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,n){return n?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(o=>({id:`bracket${o.range.toString()}-${o.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(o,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:o.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new H(1,1,this.textModel.getLineCount(),1),e,t):[]}}class cJ{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}Vh((s,e)=>{const t=[PZ,FZ,BZ,VZ,WZ,HZ],i=new cJ;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${s.getColor(Mye)}; }`);const n=t.map(r=>s.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){const o=n[r%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(r)} { color: ${o}; }`)}});function QS(s){return s.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Yn{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${QS(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${QS(this.oldText)}")`:`(replace@${this.oldPosition} "${QS(this.oldText)}" with "${QS(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;Ra(e,n,i),i+=4;for(let r=0;r<n;r++)upe(e,t.charCodeAt(r),i),i+=2;return i}static _readString(e,t){const i=Ia(e,t);return t+=4,b1e(e,t,i)}writeSize(){return 8+Yn._writeStringSize(this.oldText)+Yn._writeStringSize(this.newText)}write(e,t){return Ra(e,this.oldPosition,t),t+=4,Ra(e,this.newPosition,t),t+=4,t=Yn._writeString(e,this.oldText,t),t=Yn._writeString(e,this.newText,t),t}static read(e,t,i){const n=Ia(e,t);t+=4;const r=Ia(e,t);t+=4;const o=Yn._readString(e,t);t+=Yn._writeStringSize(o);const a=Yn._readString(e,t);return t+=Yn._writeStringSize(a),i.push(new Yn(n,o,r,a)),t}}function wLe(s,e){return s===null||s.length===0?e:new wl(s,e).compress()}class wl{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[c,u]=wl._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(c),n=u;continue}if(i.newPosition<n.oldPosition){const[c,u]=wl._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(c),i=u;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[c,u]=wl._splitPrev(i,n.oldLength);a=c,l=n,i=u,n=this._getCurr(++t)}else{const[c,u]=wl._splitCurr(n,i.newLength);a=i,l=c,i=this._getPrev(++e),n=u}this._result[this._resultLen++]=new Yn(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const r=wl._merge(this._result);return wl._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=wl._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=wl._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new Yn(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new Yn(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new Yn(e.oldPosition,e.oldText,e.newPosition,i),new Yn(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new Yn(e.oldPosition,i,e.newPosition,e.newText),new Yn(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,n=e[0];for(let r=1;r<e.length;r++){const o=e[r];n.oldEnd===o.oldPosition?n=new Yn(n.oldPosition,n.oldText+o.oldText,n.newPosition,n.newText+o.newText):(t[i++]=n,n=o)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const r=e[n];r.oldText!==r.newText&&(t[i++]=r)}return t}}const vLe=Symbol("TextModelEditSource");class hJ{constructor(e,t){this.metadata=e}toString(){return`${this.metadata.source}`}getType(){const e=this.metadata;switch(e.source){case"cursor":return e.kind;case"inlineCompletionAccept":return e.source+(e.$nes?":nes":"");case"unknown":return e.name||"unknown";default:return e.source}}toKey(e,t={}){const i=this.metadata;return Object.entries(i).filter(([r,o])=>{const a=t[r];return a!==void 0?a:(r.match(/\$/g)||[]).length<=e&&o!==void 0&&o!==null&&o!==""}).map(([r,o])=>`${r}:${o}`).join("-")}}function Js(s){return new hJ(s,vLe)}const Do={unknown(s){return Js({source:"unknown",name:s.name})},rename:()=>Js({source:"rename"}),chatApplyEdits(s){var e,t;return Js({source:"Chat.applyEdits",$modelId:rj(s.modelId),$extensionId:(e=s.extensionId)==null?void 0:e.extensionId,$extensionVersion:(t=s.extensionId)==null?void 0:t.version,$$languageId:s.languageId,$$sessionId:s.sessionId,$$requestId:s.requestId,$$mode:s.mode,$$codeBlockSuggestionId:s.codeBlockSuggestionId})},chatUndoEdits:()=>Js({source:"Chat.undoEdits"}),chatReset:()=>Js({source:"Chat.reset"}),inlineCompletionAccept(s){return Js({source:"inlineCompletionAccept",$nes:s.nes,...XS(s.providerId),$$requestUuid:s.requestUuid,$$languageId:s.languageId})},inlineCompletionPartialAccept(s){return Js({source:"inlineCompletionPartialAccept",type:s.type,$nes:s.nes,...XS(s.providerId),$$requestUuid:s.requestUuid,$$languageId:s.languageId})},inlineChatApplyEdit(s){var e,t;return Js({source:"inlineChat.applyEdits",$modelId:rj(s.modelId),$extensionId:(e=s.extensionId)==null?void 0:e.extensionId,$extensionVersion:(t=s.extensionId)==null?void 0:t.version,$$sessionId:s.sessionId,$$requestId:s.requestId,$$languageId:s.languageId})},reloadFromDisk:()=>Js({source:"reloadFromDisk"}),cursor(s){return Js({source:"cursor",kind:s.kind,detailedSource:s.detailedSource})},setValue:()=>Js({source:"setValue"}),eolChange:()=>Js({source:"eolChange"}),applyEdits:()=>Js({source:"applyEdits"}),snippet:()=>Js({source:"snippet"}),suggest:s=>Js({source:"suggest",...XS(s.providerId)}),codeAction:s=>Js({source:"codeAction",$kind:s.kind,...XS(s.providerId)})};function XS(s){return s?{$extensionId:s.extensionId,$extensionVersion:s.extensionVersion,$providerId:s.providerId}:{}}function rj(s){if(s!==void 0)return s.replaceAll("/","|")}class zk{static fromText(e){const t=Dr.ofText(e).lineCount,i=e.length;return new zk(t,0,i,0)}static tryCreate(e,t,i,n){if(!(e===void 0||t===void 0||i===void 0||n===void 0))return new zk(e,t,i,n)}constructor(e,t,i,n){this.linesAdded=e,this.linesRemoved=t,this.charsAdded=i,this.charsRemoved=n}}var oj;(function(s){function e(t){const i=t?t("sgt"):pve("sgt");return i}s.newId=e})(oj||(oj={}));function yp(s){return s.toString()}class wn{static create(e,t){const i=e.getAlternativeVersionId(),n=R5(e);return new wn(i,i,n,n,t,t,[])}constructor(e,t,i,n,r,o,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=r,this.afterCursorState=o,this.changes=a}append(e,t,i,n,r){t.length>0&&(this.changes=wLe(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,i){if(Ra(e,t?t.length:0,i),i+=4,t)for(const n of t)Ra(e,n.selectionStartLineNumber,i),i+=4,Ra(e,n.selectionStartColumn,i),i+=4,Ra(e,n.positionLineNumber,i),i+=4,Ra(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=Ia(e,t);t+=4;for(let r=0;r<n;r++){const o=Ia(e,t);t+=4;const a=Ia(e,t);t+=4;const l=Ia(e,t);t+=4;const c=Ia(e,t);t+=4,i.push(new gt(o,a,l,c))}return t}serialize(){let e=10+wn._writeSelectionsSize(this.beforeCursorState)+wn._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;Ra(t,this.beforeVersionId,i),i+=4,Ra(t,this.afterVersionId,i),i+=4,UH(t,this.beforeEOL,i),i+=1,UH(t,this.afterEOL,i),i+=1,i=wn._writeSelections(t,this.beforeCursorState,i),i=wn._writeSelections(t,this.afterCursorState,i),Ra(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=Ia(t,i);i+=4;const r=Ia(t,i);i+=4;const o=zH(t,i);i+=1;const a=zH(t,i);i+=1;const l=[];i=wn._readSelections(t,i,l);const c=[];i=wn._readSelections(t,i,c);const u=Ia(t,i);i+=4;const d=[];for(let g=0;g<u;g++)i=Yn.read(t,i,d);return new wn(n,r,o,a,l,c,d)}}class uJ{get type(){return 0}get resource(){return nt.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,n){this.label=e,this.code=t,this.model=i,this._data=wn.create(i,n)}toString(){return(this._data instanceof wn?this._data:wn.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(nt.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof wn}append(e,t,i,n,r){this._data instanceof wn&&this._data.append(e,t,i,n,r)}close(){this._data instanceof wn&&(this._data=this._data.serialize())}open(){this._data instanceof wn||(this._data=wn.deserialize(this._data))}undo(){if(nt.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof wn&&(this._data=this._data.serialize());const e=wn.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(nt.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof wn&&(this._data=this._data.serialize());const e=wn.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof wn&&(this._data=this._data.serialize()),this._data.byteLength+168}}class yLe{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const r=yp(n.resource);this._editStackElementsMap.set(r,n)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=yp(e);return this._editStackElementsMap.has(t)}setModel(e){const t=yp(nt.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=yp(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,r){const o=yp(e.uri);this._editStackElementsMap.get(o).append(e,t,i,n,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=yp(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${G7(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function R5(s){return s.getEOL()===`
`?0:1}function sh(s){return s?s instanceof uJ||s instanceof yLe:!1}class R6{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);sh(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);sh(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(sh(i)&&i.canAppend(this._model))return i;const n=new uJ(w(785,"Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],R5(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n,r=Do.unknown({name:"pushEditOperation"})){const o=this._getOrCreateEditStackElement(e,n),a=this._model.applyEdits(t,!0,r),l=R6._computeCursorState(i,a),c=a.map((u,d)=>({index:d,textChange:u.textChange}));return c.sort((u,d)=>u.textChange.oldPosition===d.textChange.oldPosition?u.index-d.index:u.textChange.oldPosition-d.textChange.oldPosition),o.append(this._model,c.map(u=>u.textChange),R5(this._model),this._model.getAlternativeVersionId(),l),l}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return It(i),null}}}class SLe{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function xLe(s,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<i;r++){const g=s.charCodeAt(r),p=t.charCodeAt(r);if(g!==p)break}let o=0,a=0;for(let g=r;g<e;g++)s.charCodeAt(g)===32?o++:a++;let l=0,c=0;for(let g=r;g<i;g++)t.charCodeAt(g)===32?l++:c++;if(o>0&&a>0||l>0&&c>0)return;const u=Math.abs(a-c),d=Math.abs(o-l);if(u===0){n.spacesDiff=d,d>0&&0<=l-1&&l-1<s.length&&l<t.length&&t.charCodeAt(l)!==32&&s.charCodeAt(l-1)===32&&s.charCodeAt(s.length-1)===44&&(n.looksLikeAlignment=!0);return}if(d%u===0){n.spacesDiff=d/u;return}}function aj(s,e,t){const i=Math.min(s.getLineCount(),1e4);let n=0,r=0,o="",a=0;const l=[2,4,6,8,3,5,7],c=8,u=[0,0,0,0,0,0,0,0,0],d=new SLe;for(let _=1;_<=i;_++){const C=s.getLineLength(_),v=s.getLineContent(_),x=C<=65536;let S=!1,k=0,E=0,T=0;for(let N=0,A=C;N<A;N++){const O=x?v.charCodeAt(N):s.getLineCharCode(_,N);if(O===9)T++;else if(O===32)E++;else{S=!0,k=N;break}}if(!S||(T>0?n++:E>1&&r++,xLe(o,a,v,k,d),d.looksLikeAlignment&&!(t&&e===d.spacesDiff)))continue;const R=d.spacesDiff;R<=c&&u[R]++,o=v,a=k}let g=t;n!==r&&(g=n<r);let p=e;if(g){let _=g?0:.1*i;l.forEach(C=>{const v=u[C];v>_&&(_=v,p=C)}),p===4&&u[4]>0&&u[2]>0&&u[2]>=u[4]/2&&(p=2)}return{insertSpaces:g,tabSize:p}}function er(s){return(s.metadata&1)>>>0}function ti(s,e){s.metadata=s.metadata&254|e<<0}function es(s){return(s.metadata&2)>>>1===1}function Zt(s,e){s.metadata=s.metadata&253|(e?1:0)<<1}function dJ(s){return(s.metadata&4)>>>2===1}function lj(s,e){s.metadata=s.metadata&251|(e?1:0)<<2}function fJ(s){return(s.metadata&64)>>>6===1}function cj(s,e){s.metadata=s.metadata&191|(e?1:0)<<6}function gJ(s){return(s.metadata&128)>>>7===1}function hj(s,e){s.metadata=s.metadata&127|(e?1:0)<<7}function LLe(s){return(s.metadata&24)>>>3}function uj(s,e){s.metadata=s.metadata&231|e<<3}function kLe(s){return(s.metadata&32)>>>5===1}function dj(s,e){s.metadata=s.metadata&223|(e?1:0)<<5}class mJ{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,ti(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,lj(this,!1),cj(this,!1),uj(this,1),dj(this,!1),hj(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,Zt(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;lj(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),cj(this,this.options.glyphMarginClassName!==null),uj(this,this.options.stickiness),dj(this,this.options.collapseOnReplaceEdit),hj(this,this.options.affectsFont??!1)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const Je=new mJ(null,0,0);Je.parent=Je;Je.left=Je;Je.right=Je;ti(Je,0);class ER{constructor(){this.root=Je,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,r,o,a){return this.root===Je?[]:MLe(this,e,t,i,n,r,o,a)}search(e,t,i,n,r){return this.root===Je?[]:ALe(this,e,t,i,n,r)}collectNodesFromOwner(e){return ILe(this,e)}collectNodesPostOrder(){return RLe(this)}insert(e){fj(this,e),this._normalizeDeltaIfNecessary()}delete(e){gj(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const r=i.start+n,o=i.end+n;i.setCachedOffsets(r,o,t)}acceptReplace(e,t,i,n){const r=TLe(this,e,e+t);for(let o=0,a=r.length;o<a;o++){const l=r[o];gj(this,l)}this._normalizeDeltaIfNecessary(),NLe(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let o=0,a=r.length;o<a;o++){const l=r[o];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,DLe(l,e,e+t,i,n),l.maxEnd=l.end,fj(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,ELe(this))}}function ELe(s){let e=s.root,t=0;for(;e!==Je;){if(e.left!==Je&&!es(e.left)){e=e.left;continue}if(e.right!==Je&&!es(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,pd(e),Zt(e,!0),Zt(e.left,!1),Zt(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}Zt(s.root,!1)}function Sp(s,e,t,i){return s<t?!0:s>t||i===1?!1:i===2?!0:e}function DLe(s,e,t,i,n){const r=LLe(s),o=r===0||r===2,a=r===1||r===2,l=t-e,c=i,u=Math.min(l,c),d=s.start;let g=!1;const p=s.end;let _=!1;e<=d&&p<=t&&kLe(s)&&(s.start=e,g=!0,s.end=e,_=!0);{const v=n?1:l>0?2:0;!g&&Sp(d,o,e,v)&&(g=!0),!_&&Sp(p,a,e,v)&&(_=!0)}if(u>0&&!n){const v=l>c?2:0;!g&&Sp(d,o,e+u,v)&&(g=!0),!_&&Sp(p,a,e+u,v)&&(_=!0)}{const v=n?1:0;!g&&Sp(d,o,t,v)&&(s.start=e+c,g=!0),!_&&Sp(p,a,t,v)&&(s.end=e+c,_=!0)}const C=c-l;g||(s.start=Math.max(0,d+C)),_||(s.end=Math.max(0,p+C)),s.start>s.end&&(s.end=s.start)}function TLe(s,e,t){let i=s.root,n=0,r=0,o=0,a=0;const l=[];let c=0;for(;i!==Je;){if(es(i)){Zt(i.left,!1),Zt(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!es(i.left)){if(r=n+i.maxEnd,r<e){Zt(i,!0);continue}if(i.left!==Je){i=i.left;continue}}if(o=n+i.start,o>t){Zt(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(o,a,0),l[c++]=i),Zt(i,!0),i.right!==Je&&!es(i.right)){n+=i.delta,i=i.right;continue}}return Zt(s.root,!1),l}function NLe(s,e,t,i){let n=s.root,r=0,o=0,a=0;const l=i-(t-e);for(;n!==Je;){if(es(n)){Zt(n.left,!1),Zt(n.right,!1),n===n.parent.right&&(r-=n.parent.delta),pd(n),n=n.parent;continue}if(!es(n.left)){if(o=r+n.maxEnd,o<e){Zt(n,!0);continue}if(n.left!==Je){n=n.left;continue}}if(a=r+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(s.requestNormalizeDelta=!0),Zt(n,!0);continue}if(Zt(n,!0),n.right!==Je&&!es(n.right)){r+=n.delta,n=n.right;continue}}Zt(s.root,!1)}function ILe(s,e){let t=s.root;const i=[];let n=0;for(;t!==Je;){if(es(t)){Zt(t.left,!1),Zt(t.right,!1),t=t.parent;continue}if(t.left!==Je&&!es(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),Zt(t,!0),t.right!==Je&&!es(t.right)){t=t.right;continue}}return Zt(s.root,!1),i}function RLe(s){let e=s.root;const t=[];let i=0;for(;e!==Je;){if(es(e)){Zt(e.left,!1),Zt(e.right,!1),e=e.parent;continue}if(e.left!==Je&&!es(e.left)){e=e.left;continue}if(e.right!==Je&&!es(e.right)){e=e.right;continue}t[i++]=e,Zt(e,!0)}return Zt(s.root,!1),t}function ALe(s,e,t,i,n,r){let o=s.root,a=0,l=0,c=0;const u=[];let d=0;for(;o!==Je;){if(es(o)){Zt(o.left,!1),Zt(o.right,!1),o===o.parent.right&&(a-=o.parent.delta),o=o.parent;continue}if(o.left!==Je&&!es(o.left)){o=o.left;continue}l=a+o.start,c=a+o.end,o.setCachedOffsets(l,c,n);let g=!0;if(e&&o.ownerId&&o.ownerId!==e&&(g=!1),t&&dJ(o)&&(g=!1),i&&gJ(o)&&(g=!1),r&&!fJ(o)&&(g=!1),g&&(u[d++]=o),Zt(o,!0),o.right!==Je&&!es(o.right)){a+=o.delta,o=o.right;continue}}return Zt(s.root,!1),u}function MLe(s,e,t,i,n,r,o,a){let l=s.root,c=0,u=0,d=0,g=0;const p=[];let _=0;for(;l!==Je;){if(es(l)){Zt(l.left,!1),Zt(l.right,!1),l===l.parent.right&&(c-=l.parent.delta),l=l.parent;continue}if(!es(l.left)){if(u=c+l.maxEnd,u<e){Zt(l,!0);continue}if(l.left!==Je){l=l.left;continue}}if(d=c+l.start,d>t){Zt(l,!0);continue}if(g=c+l.end,g>=e){l.setCachedOffsets(d,g,o);let C=!0;i&&l.ownerId&&l.ownerId!==i&&(C=!1),n&&dJ(l)&&(C=!1),r&&gJ(l)&&(C=!1),a&&!fJ(l)&&(C=!1),C&&(p[_++]=l)}if(Zt(l,!0),l.right!==Je&&!es(l.right)){c+=l.delta,l=l.right;continue}}return Zt(s.root,!1),p}function fj(s,e){if(s.root===Je)return e.parent=Je,e.left=Je,e.right=Je,ti(e,0),s.root=e,s.root;OLe(s,e),yu(e.parent);let t=e;for(;t!==s.root&&er(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;er(i)===1?(ti(t.parent,0),ti(i,0),ti(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,J0(s,t)),ti(t.parent,0),ti(t.parent.parent,1),eC(s,t.parent.parent))}else{const i=t.parent.parent.left;er(i)===1?(ti(t.parent,0),ti(i,0),ti(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,eC(s,t)),ti(t.parent,0),ti(t.parent.parent,1),J0(s,t.parent.parent))}return ti(s.root,0),e}function OLe(s,e){let t=0,i=s.root;const n=e.start,r=e.end;for(;;)if(FLe(n,r,i.start+t,i.end+t)<0)if(i.left===Je){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===Je){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=Je,e.right=Je,ti(e,1)}function gj(s,e){let t,i;if(e.left===Je?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Je?(t=e.left,i=e):(i=PLe(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(s.requestNormalizeDelta=!0)),i===s.root){s.root=t,ti(t,0),e.detach(),DR(),pd(t),s.root.parent=Je;return}const n=er(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,ti(i,er(e)),e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Je&&(i.left.parent=i),i.right!==Je&&(i.right.parent=i)),e.detach(),n){yu(t.parent),i!==e&&(yu(i),yu(i.parent)),DR();return}yu(t),yu(t.parent),i!==e&&(yu(i),yu(i.parent));let r;for(;t!==s.root&&er(t)===0;)t===t.parent.left?(r=t.parent.right,er(r)===1&&(ti(r,0),ti(t.parent,1),J0(s,t.parent),r=t.parent.right),er(r.left)===0&&er(r.right)===0?(ti(r,1),t=t.parent):(er(r.right)===0&&(ti(r.left,0),ti(r,1),eC(s,r),r=t.parent.right),ti(r,er(t.parent)),ti(t.parent,0),ti(r.right,0),J0(s,t.parent),t=s.root)):(r=t.parent.left,er(r)===1&&(ti(r,0),ti(t.parent,1),eC(s,t.parent),r=t.parent.left),er(r.left)===0&&er(r.right)===0?(ti(r,1),t=t.parent):(er(r.left)===0&&(ti(r.right,0),ti(r,1),J0(s,r),r=t.parent.left),ti(r,er(t.parent)),ti(t.parent,0),ti(r.left,0),eC(s,t.parent),t=s.root));ti(t,0),DR()}function PLe(s){for(;s.left!==Je;)s=s.left;return s}function DR(){Je.parent=Je,Je.delta=0,Je.start=0,Je.end=0}function J0(s,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Je&&(t.left.parent=e),t.parent=e.parent,e.parent===Je?s.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,pd(e),pd(t)}function eC(s,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(s.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Je&&(t.right.parent=e),t.parent=e.parent,e.parent===Je?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,pd(e),pd(t)}function pJ(s){let e=s.end;if(s.left!==Je){const t=s.left.maxEnd;t>e&&(e=t)}if(s.right!==Je){const t=s.right.maxEnd+s.delta;t>e&&(e=t)}return e}function pd(s){s.maxEnd=pJ(s)}function yu(s){for(;s!==Je;){const e=pJ(s);if(s.maxEnd===e)return;s.maxEnd=e,s=s.parent}}function FLe(s,e,t,i){return s===t?e-i:s-t}class A5{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Ue)return A6(this.right);let e=this;for(;e.parent!==Ue&&e.parent.left!==e;)e=e.parent;return e.parent===Ue?Ue:e.parent}prev(){if(this.left!==Ue)return _J(this.left);let e=this;for(;e.parent!==Ue&&e.parent.right!==e;)e=e.parent;return e.parent===Ue?Ue:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const Ue=new A5(null,0);Ue.parent=Ue;Ue.left=Ue;Ue.right=Ue;Ue.color=0;function A6(s){for(;s.left!==Ue;)s=s.left;return s}function _J(s){for(;s.right!==Ue;)s=s.right;return s}function M6(s){return s===Ue?0:s.size_left+s.piece.length+M6(s.right)}function O6(s){return s===Ue?0:s.lf_left+s.piece.lineFeedCnt+O6(s.right)}function TR(){Ue.parent=Ue}function tC(s,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Ue&&(t.left.parent=e),t.parent=e.parent,e.parent===Ue?s.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function iC(s,e){const t=e.left;e.left=t.right,t.right!==Ue&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Ue?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function ZS(s,e){let t,i;if(e.left===Ue?(i=e,t=i.right):e.right===Ue?(i=e,t=i.left):(i=A6(e.right),t=i.right),i===s.root){s.root=t,t.color=0,e.detach(),TR(),s.root.parent=Ue;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,x0(s,t)):(i.parent===e?t.parent=i:t.parent=i.parent,x0(s,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Ue&&(i.left.parent=i),i.right!==Ue&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,x0(s,i)),e.detach(),t.parent.left===t){const o=M6(t),a=O6(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,Hc(s,t.parent,l,c)}}if(x0(s,t.parent),n){TR();return}let r;for(;t!==s.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,tC(s,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,iC(s,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,tC(s,t.parent),t=s.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,iC(s,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,tC(s,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,iC(s,t.parent),t=s.root));t.color=0,TR()}function mj(s,e){for(x0(s,e);e!==s.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,tC(s,e)),e.parent.color=0,e.parent.parent.color=1,iC(s,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,iC(s,e)),e.parent.color=0,e.parent.parent.color=1,tC(s,e.parent.parent))}s.root.color=0}function Hc(s,e,t,i){for(;e!==s.root&&e!==Ue;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function x0(s,e){let t=0,i=0;if(e!==s.root){for(;e!==s.root&&e===e.parent.right;)e=e.parent;if(e!==s.root)for(e=e.parent,t=M6(e.left)-e.size_left,i=O6(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==s.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const Fc=65535;function bJ(s){let e;return s[s.length-1]<65536?e=new Uint16Array(s.length):e=new Uint32Array(s.length),e.set(s,0),e}class BLe{constructor(e,t,i,n,r){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=r}}function $c(s,e=!0){const t=[0];let i=1;for(let n=0,r=s.length;n<r;n++){const o=s.charCodeAt(n);o===13?n+1<r&&s.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:o===10&&(t[i++]=n+1)}return e?bJ(t):t}function VLe(s,e){s.length=0,s[0]=0;let t=1,i=0,n=0,r=0,o=!0;for(let l=0,c=e.length;l<c;l++){const u=e.charCodeAt(l);u===13?l+1<c&&e.charCodeAt(l+1)===10?(r++,s[t++]=l+2,l++):(i++,s[t++]=l+1):u===10?(n++,s[t++]=l+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new BLe(bJ(s),i,n,r,o);return s.length=0,a}class pr{constructor(e,t,i,n,r){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=r}}class kf{constructor(e,t){this.buffer=e,this.lineStarts=t}}class WLe{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Ue&&e.iterate(e.root,i=>(i!==Ue&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class HLe{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const r=i[n];if(r.node.parent===null||r.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const r of i)r!==null&&n.push(r);this._cache=n}}}class zLe{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new kf("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Ue,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let r=0,o=e.length;r<o;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=$c(e[r].buffer));const a=new pr(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),n=this.rbInsertRight(n,a)}this._searchCache=new HLe(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=Fc,i=t-Math.floor(t/3),n=i*2;let r="",o=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),u=c.length;if(o<=i||o+u<n)return r+=c,o+=u,!0;const d=r.replace(/\r\n|\r|\n/g,e);return a.push(new kf(d,$c(d))),r=c,o=u,!0}),o>0){const l=r.replace(/\r\n|\r|\n/g,e);a.push(new kf(l,$c(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new WLe(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==Ue;)if(n.left!==Ue&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const r=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=r+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==Ue;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const r=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+r.index,r.index===0){const o=this.getOffsetAt(i+1,1),a=n-o;return new Y(i+1,a+1)}return new Y(i+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===Ue){const r=this.getOffsetAt(i+1,1),o=n-e-r;return new Y(i+1,o+1)}else t=t.right;return new Y(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=n.substring(r+e.remainder,r+i.piece.length);for(i=i.next();i!==Ue;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,r=>{if(r===Ue)return!0;const o=r.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,d=o.end.line;let g=c[u]+o.start.column;if(n&&(l.charCodeAt(g)===10&&(g++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(u===d)return!this._EOLNormalized&&l.charCodeAt(g+a-1)===13?(n=!0,i+=l.substr(g,a-1)):i+=l.substr(g,a),!0;i+=this._EOLNormalized?l.substring(g,Math.max(g,c[u+1]-this._EOLLength)):l.substring(g,c[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let p=u+1;p<d;p++)i=this._EOLNormalized?l.substring(c[p],c[p+1]-this._EOLLength):l.substring(c[p],c[p+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[d]+o.end.column-1)===13?(n=!0,o.end.column===0?t--:i=l.substr(c[d],o.end.column-1)):i=l.substr(c[d],o.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===Ue)return"";const n=this._buffers[i.piece.bufferIndex],r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.substring(r,r+i.piece.length)}else{const i=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=n+t.remainder,o=n+t.node.piece.length;return i.buffer.substring(r,o)}}findMatchesInNode(e,t,i,n,r,o,a,l,c,u,d){const g=this._buffers[e.piece.bufferIndex],p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),_=this.offsetInBuffer(e.piece.bufferIndex,r),C=this.offsetInBuffer(e.piece.bufferIndex,o);let v;const x={line:0,column:0};let S,k;t._wordSeparators?(S=g.buffer.substring(_,C),k=E=>E+_,t.reset(0)):(S=g.buffer,k=E=>E,t.reset(_));do if(v=t.next(S),v){if(k(v.index)>=C)return u;this.positionInBuffer(e,k(v.index)-p,x);const E=this.getLineFeedCnt(e.piece.bufferIndex,r,x),T=x.line===r.line?x.column-r.column+n:x.column+1,R=T+v[0].length;if(d[u++]=pf(new H(i+E,T,i+E,R),v,l),k(v.index)+v[0].length>=C||u>=c)return u}while(v);return u}findMatchesLineByLine(e,t,i,n){const r=[];let o=0;const a=new Hp(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let u=this.positionInBuffer(l.node,l.remainder);const d=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,d,t,i,n,o,r),r;let g=e.startLineNumber,p=l.node;for(;p!==c.node;){const C=this.getLineFeedCnt(p.piece.bufferIndex,u,p.piece.end);if(C>=1){const x=this._buffers[p.piece.bufferIndex].lineStarts,S=this.offsetInBuffer(p.piece.bufferIndex,p.piece.start),k=x[u.line+C],E=g===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(p,a,g,E,u,this.positionInBuffer(p,k-S),t,i,n,o,r),o>=n)return r;g+=C}const v=g===e.startLineNumber?e.startColumn-1:0;if(g===e.endLineNumber){const x=this.getLineContent(g).substring(v,e.endColumn-1);return o=this._findMatchesInLine(t,a,x,e.endLineNumber,v,o,r,i,n),r}if(o=this._findMatchesInLine(t,a,this.getLineContent(g).substr(v),g,v,o,r,i,n),o>=n)return r;g++,l=this.nodeAt2(g,1),p=l.node,u=this.positionInBuffer(l.node,l.remainder)}if(g===e.endLineNumber){const C=g===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(g).substring(C,e.endColumn-1);return o=this._findMatchesInLine(t,a,v,e.endLineNumber,C,o,r,i,n),r}const _=g===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,g,_,u,d,t,i,n,o,r),r}_findMatchesInLine(e,t,i,n,r,o,a,l,c){const u=e.wordSeparators;if(!l&&e.simpleSearch){const g=e.simpleSearch,p=g.length,_=i.length;let C=-p;for(;(C=i.indexOf(g,C+p))!==-1;)if((!u||Q7(u,i,_,C,p))&&(a[o++]=new Sw(new H(n,C+1+r,n,C+1+p+r),null),o>=c))return o;return o}let d;t.reset(0);do if(d=t.next(i),d&&(a[o++]=pf(new H(n,d.index+1+r,n,d.index+1+d[0].length+r),d,l),o>=c))return o;while(d);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Ue){const{node:n,remainder:r,nodeStartOffset:o}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,c=this.positionInBuffer(n,r);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<Fc){this.appendToNode(n,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(o+n.piece.length>e){const u=[];let d=new pr(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,r)===10){const C={line:d.start.line+1,column:0};d=new pr(d.bufferIndex,C,d.end,this.getLineFeedCnt(d.bufferIndex,C,d.end),d.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,r-1)===13){const C=this.positionInBuffer(n,r-1);this.deleteNodeTail(n,C),t="\r"+t,n.piece.length===0&&u.push(n)}else this.deleteNodeTail(n,c);else this.deleteNodeTail(n,c);const g=this.createNewPieces(t);d.length>0&&this.rbInsertRight(n,d);let p=n;for(let _=0;_<g.length;_++)p=this.rbInsertRight(p,g[_]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let r=this.rbInsertLeft(null,n[0]);for(let o=1;o<n.length;o++)r=this.rbInsertRight(r,n[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Ue)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),r=i.node,o=n.node;if(r===o){const g=this.positionInBuffer(r,i.remainder),p=this.positionInBuffer(r,n.remainder);if(i.nodeStartOffset===e){if(t===r.piece.length){const _=r.next();ZS(this,r),this.validateCRLFWithPrevNode(_),this.computeBufferMetadata();return}this.deleteNodeHead(r,p),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(i.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,g),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,g,p),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(r,i.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);const c=this.positionInBuffer(o,n.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);const u=r.next();for(let g=u;g!==Ue&&g!==o;g=g.next())a.push(g);const d=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},l=new pr(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,Hc(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let r=this.rbInsertLeft(t,n[n.length-1]);for(let o=n.length-2;o>=0;o--)r=this.rbInsertLeft(r,n[o]);this.validateCRLFWithPrevNode(r),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let r=n;for(let o=1;o<i.length;o++)r=this.rbInsertRight(r,i[o]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,r=e.piece.bufferIndex,o=this._buffers[r].lineStarts,l=o[n.start.line]+n.start.column+t;let c=n.start.line,u=n.end.line,d=0,g=0,p=0;for(;c<=u&&(d=c+(u-c)/2|0,p=o[d],d!==u);)if(g=o[d+1],l<p)u=d-1;else if(l>=g)c=d+1;else break;return i?(i.line=d,i.column=l-p,null):{line:d,column:l-p}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const r=n[i.line+1],o=n[i.line]+i.column;if(r>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)ZS(this,e[t])}createNewPieces(e){if(e.length>Fc){const u=[];for(;e.length>Fc;){const g=e.charCodeAt(Fc-1);let p;g===13||g>=55296&&g<=56319?(p=e.substring(0,Fc-1),e=e.substring(Fc-1)):(p=e.substring(0,Fc),e=e.substring(Fc));const _=$c(p);u.push(new pr(this._buffers.length,{line:0,column:0},{line:_.length-1,column:p.length-_[_.length-1]},_.length-1,p.length)),this._buffers.push(new kf(p,_))}const d=$c(e);return u.push(new pr(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length)),this._buffers.push(new kf(e,d)),u}let t=this._buffers[0].buffer.length;const i=$c(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let u=0;u<i.length;u++)i[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<i.length;u++)i[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new pr(0,n,l,this.getLineFeedCnt(0,n,l),r-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,n="";const r=this._searchCache.get2(e);if(r){i=r.node;const o=this.getAccumulatedValue(i,e-r.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(r.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+o,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-r.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;i!==Ue;)if(i.left!==Ue&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),u=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),u.substring(d+l,d+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=c.substring(u+l,u+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==Ue;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=o.substring(l,l+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=o.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==Ue;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),r=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(o!==r)return{index:o,remainder:0}}return{index:r,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,r=i.start.line+t+1;return r>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[r]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),l=this.getLineFeedCnt(i.bufferIndex,i.start,o),c=l-n,u=a-r,d=i.length+u;e.piece=new pr(i.bufferIndex,i.start,o,l,d),Hc(this,e,u,c)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),l=this.offsetInBuffer(i.bufferIndex,o),c=a-n,u=r-l,d=i.length+u;e.piece=new pr(i.bufferIndex,o,i.end,a,d),Hc(this,e,u,c)}shrinkNode(e,t,i){const n=e.piece,r=n.start,o=n.end,a=n.length,l=n.lineFeedCnt,c=t,u=this.getLineFeedCnt(n.bufferIndex,n.start,c),d=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,r);e.piece=new pr(n.bufferIndex,n.start,c,u,d),Hc(this,e,d-a,u-l);const g=new pr(n.bufferIndex,i,o,this.getLineFeedCnt(n.bufferIndex,i,o),this.offsetInBuffer(n.bufferIndex,o)-this.offsetInBuffer(n.bufferIndex,i)),p=this.rbInsertRight(e,g);this.validateCRLFWithPrevNode(p)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const r=$c(t,!1);for(let p=0;p<r.length;p++)r[p]+=n;if(i){const p=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-p}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,u=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,l),g=d-u;e.piece=new pr(e.piece.bufferIndex,e.piece.start,l,d,c),this._lastChangeBufferPos=l,Hc(this,e,t.length,g)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==Ue;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==Ue;)if(i.left!==Ue&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(r+t-1,o),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2);if(r+t-1<=i.piece.length)return{node:i,remainder:r+t-1,nodeStartOffset:n};t-=i.piece.length-r;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==Ue;){if(i.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,r),nodeStartOffset:o}}else if(i.piece.length>=t-1){const r=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:r}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Ue||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,r=i[n]+t.start.column;return n===i.length-1||i[n+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Ue||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new pr(e.piece.bufferIndex,e.piece.start,r,a,o),Hc(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new pr(t.piece.bufferIndex,l,t.piece.end,u,c),Hc(this,t,-1,-1),t.piece.length===0&&i.push(t);const d=this.createNewPieces(`\r
`);this.rbInsertRight(e,d[0]);for(let g=0;g<i.length;g++)ZS(this,i[g])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)ZS(this,i);else{const n=i.piece,r={line:n.start.line+1,column:0},o=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,r,n.end);i.piece=new pr(n.bufferIndex,r,n.end,a,o),Hc(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Ue)return t(Ue);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Ue)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),r=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,r)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new A5(t,1);if(i.left=Ue,i.right=Ue,i.parent=Ue,i.size_left=0,i.lf_left=0,this.root===Ue)this.root=i,i.color=0;else if(e.right===Ue)e.right=i,i.parent=e;else{const r=A6(e.right);r.left=i,i.parent=r}return mj(this,i),i}rbInsertLeft(e,t){const i=new A5(t,1);if(i.left=Ue,i.right=Ue,i.parent=Ue,i.size_left=0,i.lf_left=0,this.root===Ue)this.root=i,i.color=0;else if(e.left===Ue)e.left=i,i.parent=e;else{const n=_J(e.left);n.right=i,i.parent=n}return mj(this,i),i}}class P_ extends ne{constructor(e,t,i,n,r,o,a){super(),this._onDidChangeContent=this._register(new $),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=r,this._pieceTree=new zLe(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),r=this.getPositionAt(i);return new H(n.lineNumber,n.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=e.endLineNumber-e.startLineNumber;r=l*c}return n-i+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,r=e.endLineNumber;for(let o=n;o<=r;o++){const a=this.getLineContent(o),l=o===n?e.startColumn-1:0,c=o===r?e.endColumn-1:a.length;for(let u=l;u<c;u++)hn(a.charCodeAt(u))?(i=i+1,u=u+1):i=i+1}return i+=this._getEndOfLine(t).length*(r-n),i}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=Lr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=rm(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let C=0;C<e.length;C++){const v=e[C];a&&v._isTracked&&(a=!1);const x=v.range;if(v.text){let R=!0;o||(R=!S7(v.text),o=R),!n&&R&&(n=gw(v.text)),!r&&R&&(r=RQ(v.text))}let S="",k=0,E=0,T=0;if(v.text){let R;[k,E,T,R]=S1(v.text);const N=this.getEOL();R===0||R===(N===`\r
`?2:1)?S=v.text:S=v.text.replace(/\r\n|\r|\n/g,N)}l[C]={sortIndex:C,identifier:v.identifier||null,range:x,rangeOffset:this.getOffsetAt(x.startLineNumber,x.startColumn),rangeLength:this.getValueLengthInRange(x),text:S,eolCount:k,firstLineLength:E,lastLineLength:T,forceMoveMarkers:!!v.forceMoveMarkers,isAutoWhitespaceEdit:v.isAutoWhitespaceEdit||!1}}l.sort(P_._sortOpsAscending);let c=!1;for(let C=0,v=l.length-1;C<v;C++){const x=l[C].range.getEndPosition(),S=l[C+1].range.getStartPosition();if(S.isBeforeOrEqual(x)){if(S.isBefore(x))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const u=i||t?P_._getInverseEditRanges(l):[],d=[];if(t)for(let C=0;C<l.length;C++){const v=l[C],x=u[C];if(v.isAutoWhitespaceEdit&&v.range.isEmpty())for(let S=x.startLineNumber;S<=x.endLineNumber;S++){let k="";S===x.startLineNumber&&(k=this.getLineContent(v.range.startLineNumber),Lr(k)!==-1)||d.push({lineNumber:S,oldContent:k})}}let g=null;if(i){let C=0;g=[];for(let v=0;v<l.length;v++){const x=l[v],S=u[v],k=this.getValueInRange(x.range),E=x.rangeOffset+C;C+=x.text.length-k.length,g[v]={sortIndex:x.sortIndex,identifier:x.identifier,range:S,text:k,textChange:new Yn(x.rangeOffset,k,E,x.text)}}c||g.sort((v,x)=>v.sortIndex-x.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=o;const p=this._doApplyEdits(l);let _=null;if(t&&d.length>0){d.sort((C,v)=>v.lineNumber-C.lineNumber),_=[];for(let C=0,v=d.length;C<v;C++){const x=d[C].lineNumber;if(C>0&&d[C-1].lineNumber===x)continue;const S=d[C].oldContent,k=this.getLineContent(x);k.length===0||k===S||Lr(k)!==-1||_.push(x)}}return this._onDidChangeContent.fire(),new rbe(g,p,_)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,r=new H(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let p=0,_=e.length;p<_;p++){const C=e[p],v=C.range;t=t||C.forceMoveMarkers,l.push(this.getValueInRange(new H(o,a,v.startLineNumber,v.startColumn))),C.text.length>0&&l.push(C.text),o=v.endLineNumber,a=v.endColumn}const c=l.join(""),[u,d,g]=S1(c);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:c,eolCount:u,firstLineLength:d,lastLineLength:g,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(P_._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(r===a&&o===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new H(r,o,a,l);t.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,r=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c,u;r?r.range.endLineNumber===l.range.startLineNumber?(c=i,u=n+(l.range.startColumn-r.range.endColumn)):(c=i+(l.range.startLineNumber-r.range.endLineNumber),u=l.range.startColumn):(c=l.range.startLineNumber,u=l.range.startColumn);let d;if(l.text.length>0){const g=l.eolCount+1;g===1?d=new H(c,u,c,u+l.firstLineLength):d=new H(c,u,c+g-1,l.lastLineLength+1)}else d=new H(c,u,c,u);i=d.endLineNumber,n=d.endColumn,t.push(d),r=l}return t}static _sortOpsAscending(e,t){const i=H.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=H.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class ULe{constructor(e,t,i,n,r,o,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=r,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,o=i.length;r<o;r++){const a=i[r].buffer.replace(/\r\n|\r|\n/g,t),l=$c(a);i[r]=new kf(a,l)}const n=new P_(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class CJ{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&L7(e)&&(this.BOM=Wme,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=VLe(this._tmpLineStarts,e);this.chunks.push(new kf(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=gw(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=RQ(e)))}finish(e=!0){return this._finish(),new ULe(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=$c(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}function Uw(s,e=hs.ofCaller()){return typeof s=="string"?new pj(s,void 0,e):new pj(void 0,s,e)}class pj extends W1{get debugName(){return new Us(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t,i){super(i),this._debugName=e,this._owner=t}trigger(e,t){if(!e){Vi(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this._observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}class jLe extends W1{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i,n){super(n),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){var e,t;if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const i of this._deltas){(e=rs())==null||e.handleObservableUpdated(this,{change:i,didChange:!0,oldValue:"(unknown)",newValue:this._value,hadValue:!0});for(const n of this._observers)n.handleChange(this,i)}this._deltas.length=0}else{(t=rs())==null||t.handleObservableUpdated(this,{change:void 0,didChange:!0,oldValue:"(unknown)",newValue:this._value,hadValue:!0});for(const i of this._observers)i.handleChange(this,void 0)}}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this._observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this._observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this._observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this._observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new Rv(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(r,o)=>{},handlePossibleChange:r=>{}},this),this._updateCounter>1)for(const r of this._observers)r.handlePossibleChange(this)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function nC(s,e,t=hs.ofCaller()){return s.lazy?new jLe(new Us(s.owner,s.debugName,void 0),e,s.equalsFn??Ka,t):new bw(new Us(s.owner,s.debugName,void 0),e,s.equalsFn??Ka,t)}class $Le{constructor(){this._onDidChangeVisibleRanges=new $,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set,this._viewsChanged=Uw(this),this.visibleLineRanges=Vl({owner:this,equalsFn:u4(bpe())},e=>(this._viewsChanged.read(e),He.joinMany([...this._views].map(i=>{var n;return((n=i.state.read(e))==null?void 0:n.visibleLineRanges)??[]}))))}attachView(){const e=new GLe(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),this._viewsChanged.trigger(void 0),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0}),this._viewsChanged.trigger(void 0)}}class qLe{constructor(e,t){this.visibleLineRanges=e,this.stabilized=t}equals(e){return this===e?!0:!(!sn(this.visibleLineRanges,e.visibleLineRanges,(t,i)=>t.equals(i))||this.stabilized!==e.stabilized)}}class GLe{get state(){return this._state}constructor(e){this.handleStateChange=e,this._state=nC({owner:this,equalsFn:C0((t,i)=>t.equals(i))},void 0)}setVisibleLines(e,t){const i=e.map(r=>new He(r.startLineNumber,r.endLineNumber+1)),n=new qLe(i,t);this._state.set(n,void 0,void 0),this.handleStateChange(n)}}class KLe extends ne{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new os(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){sn(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class wJ extends ne{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t){super(),this._languageIdCodec=e,this._textModel=t,this._onDidChangeTokens=this._register(new $),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}}function YLe(s,e){const t=s.gotoNextSibling(),i=e.gotoNextSibling();if(t!==i)throw new Error("Trees are out of sync");return t&&i}function vJ(s,e){const t=s.gotoParent(),i=e.gotoParent();if(t!==i)throw new Error("Trees are out of sync");return t&&i}function QLe(s,e,t){const i=s.gotoFirstChild(),n=e.gotoFirstChild();if(i!==n)throw new Error("Trees are out of sync");if(t===0)return i&&n;for(let r=1;r<=t;r++){const o=s.gotoNextSibling(),a=e.gotoNextSibling();if(o!==a)throw new Error("Trees are out of sync");if(!o||!a)return!1}return i&&n}function _j(s,e){do{if(s.currentNode.nextSibling)return YLe(s,e);s.currentNode.parent&&vJ(s,e)}while(s.currentNode.nextSibling||s.currentNode.parent);return!1}function XLe(s,e){const t=e.walk();t.resetTo(s);const i=s.currentNode;do if(t.currentNode.previousSibling&&t.currentNode.endIndex-t.currentNode.startIndex!==0)t.gotoPreviousSibling();else{for(;!t.currentNode.previousSibling&&t.currentNode.parent;)t.gotoParent();t.gotoPreviousSibling()}while(t.currentNode.endIndex>i.startIndex&&(t.currentNode.parent||t.currentNode.previousSibling)&&t.currentNode.id!==i.id);if(t.currentNode.id!==i.id&&t.currentNode.endIndex<=i.startIndex)return t.currentNode}var ZLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},bj=function(s,e){return function(t,i){e(t,i,s)}};let M5=class extends ne{constructor(e,t,i,n,r,o,a){super(),this.languageId=e,this._ranges=t,this._parser=i,this._parserClass=n,this.textModel=r,this._logService=o,this._telemetryService=a,this._tree=Qe(this,void 0),this.tree=this._tree,this._treeLastParsedVersion=Qe(this,-1),this.treeLastParsedVersion=this._treeLastParsedVersion,this._onDidChangeContentQueue=new npe,this._tree=Qe(this,void 0),this.tree=this._tree,this._register(Fe(()=>{var l,c,u;(l=this._tree.get())==null||l.delete(),(c=this._lastFullyParsed)==null||c.delete(),(u=this._lastFullyParsedWithEdits)==null||u.delete(),this._parser.delete()})),this.handleContentChange(void 0,this._ranges)}handleContentChange(e,t){const i=this.textModel.getVersionId();let n=[];t&&(n=this._setRanges(t)),e&&this._applyEdits(e.changes),this._onDidChangeContentQueue.clearPending(),this._onDidChangeContentQueue.schedule(async()=>{if(this._store.isDisposed)return;const r=this._lastFullyParsed;let o;this._lastFullyParsedWithEdits&&this._lastFullyParsed&&(o=this._findChangedNodes(this._lastFullyParsedWithEdits,this._lastFullyParsed));const a=await this._parseAndUpdateTree(i);if(a){let l;o?r&&o&&(l=this._findTreeChanges(a,o,n)):this._ranges&&(l=this._ranges.map(u=>({newRange:new H(u.startPosition.row+1,u.startPosition.column+1,u.endPosition.row+1,u.endPosition.column+1),oldRangeLength:u.endIndex-u.startIndex,newRangeStartOffset:u.startIndex,newRangeEndOffset:u.endIndex}))),l||(l=[{newRange:this.textModel.getFullModelRange(),newRangeStartOffset:0,newRangeEndOffset:this.textModel.getValueLength()}]);const c=this._tree.get();Vi(u=>{this._tree.set(a,u,{ranges:l,versionId:i}),this._treeLastParsedVersion.set(i,u)}),c==null||c.delete()}})}_applyEdits(e){var t,i;for(const n of e){const r=Dr.ofRange(H.lift(n.range)),o=Dr.ofText(n.text),a=n.text.length===0?o:r.add(o),l={startIndex:n.rangeOffset,oldEndIndex:n.rangeOffset+n.rangeLength,newEndIndex:n.rangeOffset+n.text.length,startPosition:{row:n.range.startLineNumber-1,column:n.range.startColumn-1},oldEndPosition:{row:n.range.endLineNumber-1,column:n.range.endColumn-1},newEndPosition:{row:n.range.startLineNumber+a.lineCount-1,column:a.lineCount?a.columnCount:n.range.endColumn+a.columnCount}};(t=this._tree.get())==null||t.edit(l),(i=this._lastFullyParsedWithEdits)==null||i.edit(l)}}_findChangedNodes(e,t){if(this._ranges&&this._ranges.every(a=>a.startPosition.row!==e.rootNode.startPosition.row)||e.rootNode.startPosition.row!==0)return[];const i=e.walk(),n=t.walk(),r=[];let o=!0;do if(i.currentNode.hasChanges){const a=i.currentNode.children,l=[],c=a.filter((u,d)=>u!=null&&u.hasChanges||n.currentNode.children.length<=d?(l.push(d),!0):!1);if(c.length===0||i.currentNode.hasError!==n.currentNode.hasError){for(;i.currentNode.parent&&o&&!i.currentNode.isNamed;)o=vJ(i,n);const u=i.currentNode,d=XLe(i,e)??u;r.push({startIndex:d.startIndex,endIndex:u.endIndex,startPosition:d.startPosition,endPosition:u.endPosition}),o=_j(i,n)}else c.length>=1&&(o=QLe(i,n,l[0]))}else o=_j(i,n);while(o);return i.delete(),n.delete(),r}_findTreeChanges(e,t,i){let n=0;const r=[];for(let o=0;o<t.length;o++){const a=t[o];if(r.length>0&&a.startIndex>=r[r.length-1].newRangeStartOffset&&a.endIndex<=r[r.length-1].newRangeEndOffset)continue;const l=e.walk(),c=()=>l.startIndex<a.startIndex&&l.endIndex>a.endIndex;for(;c();){let C=l.gotoFirstChild(),v=!1;for(;C;)if(c()&&l.currentNode.isNamed){v=!0;break}else C=l.gotoNextSibling();if(!v){l.gotoParent();break}if(l.currentNode.childCount===0)break}const u=l.currentNode.startPosition,d=l.currentNode.endPosition,g=l.currentNode.startIndex,p=l.currentNode.endIndex,_={newRange:new H(u.row+1,u.column+1,d.row+1,d.column+1),newRangeStartOffset:g,newRangeEndOffset:p};n<i.length&&Cj(i[n],{startIndex:g,endIndex:p})?(i[n].startIndex<_.newRangeStartOffset&&(_.newRange=_.newRange.setStartPosition(i[n].startPosition.row+1,i[n].startPosition.column+1),_.newRangeStartOffset=i[n].startIndex),i[n].endIndex>_.newRangeEndOffset&&(_.newRange=_.newRange.setEndPosition(i[n].endPosition.row+1,i[n].endPosition.column+1),_.newRangeEndOffset=i[n].endIndex),n++):n<i.length&&i[n].endIndex<_.newRangeStartOffset&&r.push({newRange:new H(i[n].startPosition.row+1,i[n].startPosition.column+1,i[n].endPosition.row+1,i[n].endPosition.column+1),newRangeStartOffset:i[n].startIndex,newRangeEndOffset:i[n].endIndex}),r.length>0&&r[r.length-1].newRangeEndOffset>=_.newRangeStartOffset?(r[r.length-1].newRange=H.fromPositions(r[r.length-1].newRange.getStartPosition(),_.newRange.getEndPosition()),r[r.length-1].newRangeEndOffset=_.newRangeEndOffset):r.push(_)}return this._constrainRanges(r)}_constrainRanges(e){if(!this._ranges)return e;const t=[];let i=0,n=0;for(;i<e.length&&n<this._ranges.length;){const r=e[i],o=this._ranges[n];if(r.newRangeEndOffset<o.startIndex)i++;else if(r.newRangeStartOffset>o.endIndex)n++;else{const a=Math.max(r.newRangeStartOffset,o.startIndex),l=Math.min(r.newRangeEndOffset,o.endIndex),c=r.newRange.intersectRanges(new H(o.startPosition.row+1,o.startPosition.column+1,o.endPosition.row+1,o.endPosition.column+1));t.push({newRange:c,newRangeEndOffset:l,newRangeStartOffset:a}),l<r.newRangeEndOffset?(r.newRange=H.fromPositions(c.getEndPosition(),r.newRange.getEndPosition()),r.newRangeStartOffset=l+1):i++}}return t}async _parseAndUpdateTree(e){var i,n;const t=await this._parse();if(t)return(i=this._lastFullyParsed)==null||i.delete(),this._lastFullyParsed=t.copy(),(n=this._lastFullyParsedWithEdits)==null||n.delete(),this._lastFullyParsedWithEdits=t.copy(),t;this._tree.get()||this._parser.reset()}_parse(){let e="fullParse";return this._tree.get()&&(e="incrementalParse"),this._parseAndYield(e)}async _parseAndYield(e){let t=0,i=0;const n=this.textModel.getVersionId();let r;const o=JLe();do{const a=performance.now();r=this._parser.parse((l,c)=>this._parseCallback(l),this._tree.get(),{progressCallback:o,includedRanges:this._ranges}),t+=performance.now()-a,i++,await new Promise(l=>Ev(l))}while(!this._store.isDisposed&&!r&&n===this.textModel.getVersionId());return this._sendParseTimeTelemetry(e,t,i),r&&n===this.textModel.getVersionId()?r:void 0}_parseCallback(e){try{return this.textModel.getTextBuffer().getNearestChunk(e)}catch(t){this._logService.debug("Error getting chunk for tree-sitter parsing",t)}}_setRanges(e){const t=[];if(this._ranges)for(const i of e){let n=!1;for(let r=0;r<this._ranges.length;r++){const o=this._ranges[r];if(eke(o,i)||Cj(o,i)){n=!0;break}}n||t.push(i)}else t.push(...e);return this._ranges=e,t}_sendParseTimeTelemetry(e,t,i){this._logService.debug(`Tree parsing (${e}) took ${t} ms and ${i} passes.`),e==="fullParse"?this._telemetryService.publicLog2("treeSitter.fullParse",{languageId:this.languageId,time:t,passes:i}):this._telemetryService.publicLog2("treeSitter.incrementalParse",{languageId:this.languageId,time:t,passes:i})}createParsedTreeSync(e){const t=new this._parserClass;t.setLanguage(this._parser.language);const i=t.parse(e);return t.delete(),i??void 0}};M5=ZLe([bj(5,Ks),bj(6,Bh)],M5);function JLe(){let s=performance.now();return function(t){const i=performance.now();return i-s>50?(s=i,!0):!1}}function eke(s,e){return s.startPosition.row===e.startPosition.row&&s.startPosition.column===e.startPosition.column&&s.endPosition.row===e.endPosition.row&&s.endPosition.column===e.endPosition.column&&s.startIndex===e.startIndex&&s.endIndex===e.endIndex}function Cj(s,e){return s.startIndex<=e.startIndex&&s.endIndex>=e.startIndex||e.startIndex<=s.startIndex&&e.endIndex>=s.startIndex}class tke{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const n=this._store.slice(0,e),r=this._store.slice(e+t),o=ike(i,this._default);this._store=n.concat(o,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=G2(this._store,e,i)}}function ike(s,e){const t=[];for(let i=0;i<s;i++)t[i]=e;return t}class nke{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class O5{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new nke(e,[t]))}finalize(){return this._tokens}}class ske{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new P5(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class rke extends ske{constructor(e,t,i,n){super(e,t),this._textModel=i,this._languageIdCodec=n}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const n=this.getFirstInvalidLine();if(!n||n.lineNumber>t)break;const r=this._textModel.getLineContent(n.lineNumber),o=s0(this._languageIdCodec,i,this.tokenizationSupport,r,!0,n.startState);e.add(n.lineNumber,o.tokens),this.store.setEndState(n.lineNumber,o.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const n=this._textModel.getLanguageId(),r=this._textModel.getLineContent(e.lineNumber),o=r.substring(0,e.column-1)+t+r.substring(e.column-1),a=s0(this._languageIdCodec,n,this.tokenizationSupport,o,!0,i),l=new gn(a.tokens,o,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLinesAt(e,t){const i=this.getStartState(e);if(!i)return null;const n=this._textModel.getLanguageId(),r=[];let o=i;for(const a of t){const l=s0(this._languageIdCodec,n,this.tokenizationSupport,a,!0,o);r.push(new gn(l.tokens,a,this._languageIdCodec)),o=l.endState}return r}hasAccurateTokensForLine(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let n=this.guessStartState(t);const r=this._textModel.getLanguageId();for(let o=t;o<=i;o++){const a=this._textModel.getLineContent(o),l=s0(this._languageIdCodec,r,this.tokenizationSupport,a,!0,n);e.add(o,l.tokens),n=l.endState}return{heuristicTokens:!0}}guessStartState(e){let{likelyRelevantLines:t,initialState:i}=yJ(this._textModel,e,this);i||(i=this.tokenizationSupport.getInitialState());const n=this._textModel.getLanguageId();let r=i;for(const o of t)r=s0(this._languageIdCodec,n,this.tokenizationSupport,o,!1,r).endState;return r}}function yJ(s,e,t){let i=s.getLineFirstNonWhitespaceColumn(e);const n=[];let r=null;for(let o=e-1;i>1&&o>=1;o--){const a=s.getLineFirstNonWhitespaceColumn(o);if(a!==0&&a<i&&(n.push(s.getLineContent(o)),i=a,r=t==null?void 0:t.getStartState(o),r))break}return n.reverse(),{likelyRelevantLines:n,initialState:r??void 0}}class P5{constructor(e){this.lineCount=e,this._tokenizationStateStore=new oke,this._invalidEndStatesLineNumbers=new ake,this._invalidEndStatesLineNumbers.addRange(new Re(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Pe("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Re(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Re(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=S1(t.text);this.acceptChange(new He(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Re(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new Pe("Start state must be defined");return{lineNumber:t,startState:i}}}class oke{constructor(){this._lineEndStates=new tke(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class ake{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Re(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new Re(i.start,e):this._ranges.splice(t,1,new Re(i.start,e),new Re(e+1,i.endExclusive))}}addRange(e){Re.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;const r=t-e.length;for(let o=n;o<this._ranges.length;o++)this._ranges[o]=this._ranges[o].delta(r);if(i===n){const o=new Re(e.start,e.start+t);o.isEmpty||this._ranges.splice(i,0,o)}else{const o=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new Re(o,a+r);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function s0(s,e,t,i,n,r){let o=null;if(t)try{o=t.tokenizeEncoded(i,n,r.clone())}catch(a){It(a)}return o||(o=i6(s.encodeLanguageId(e),r)),gn.convertToEndOffset(o.tokens,i.length),o}class lke{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,D7(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?Ev(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new O5,i=Ah.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){var i;const t=(i=this._tokenizerWithStateStore)==null?void 0:i.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new He(e,t))}}class Gg{get children(){return this._children}get length(){return this._length}constructor(e){this.height=e,this._children=[],this._length=0}static create(e,t){const i=new Gg(e.height+1);return i.appendChild(e),i.appendChild(t),i}canAppendChild(){return this._children.length<3}appendChild(e){if(!this.canAppendChild())throw new Error("Cannot insert more than 3 children in a ListNode");this._children.push(e),this._length+=e.length,this._updateParentLength(e.length),As(e)||(e.parent=this)}_updateParentLength(e){let t=this.parent;for(;t;)t._length+=e,t=t.parent}unappendChild(){const e=this._children.pop();return this._length-=e.length,this._updateParentLength(-e.length),e}prependChild(e){if(this._children.length>=3)throw new Error("Cannot prepend more than 3 children in a ListNode");this._children.unshift(e),this._length+=e.length,this._updateParentLength(e.length),As(e)||(e.parent=this)}unprependChild(){const e=this._children.shift();return this._length-=e.length,this._updateParentLength(-e.length),e}lastChild(){return this._children[this._children.length-1]}dispose(){this._children.splice(0,this._children.length)}}var Yr;(function(s){s[s.None=0]="None",s[s.ViewportGuess=1]="ViewportGuess",s[s.EditGuess=2]="EditGuess",s[s.Accurate=3]="Accurate"})(Yr||(Yr={}));function As(s){return s.token!==void 0}function SJ(s,e){let t=s;const i=[];let n;for(;;){if(e.height===t.height){n=e;break}if(As(t))throw new Error("unexpected");i.push(t),t=t.lastChild()}for(let r=i.length-1;r>=0;r--){const o=i[r];n&&(o.children.length>=3?n=Gg.create(o.unappendChild(),n):(o.appendChild(n),n=void 0))}if(n){const r=new Gg(n.height+1);return r.appendChild(s),r.appendChild(n),r}else return s}function cke(s,e){let t=s;const i=[];for(;e.height!==t.height;){if(As(t))throw new Error("unexpected");i.push(t),t=t.children[0]}let n=e;for(let r=i.length-1;r>=0;r--){const o=i[r];n&&(o.children.length>=3?n=Gg.create(n,o.unprependChild()):(o.prependChild(n),n=void 0))}return n?Gg.create(n,s):s}function hke(s,e){return s.height===e.height?Gg.create(s,e):s.height>e.height?SJ(s,e):cke(e,s)}class uke{constructor(e){this._textModel=e,this._root=this.createEmptyRoot()}createEmptyRoot(){return{length:this._textModel.getValueLength(),token:0,height:0,tokenQuality:Yr.None}}buildStore(e,t){this._root=this.createFromUpdates(e,t)}createFromUpdates(e,t){if(e.length===0)return this.createEmptyRoot();let i={length:e[0].length,token:e[0].token,height:0,tokenQuality:t};for(let n=1;n<e.length;n++)i=SJ(i,{length:e[n].length,token:e[n].token,height:0,tokenQuality:t});return i}update(e,t,i){t.length!==0&&this.replace(e,t[0].startOffsetInclusive,t,i)}delete(e,t){this.replace(e,t,[],Yr.EditGuess)}replace(e,t,i,n){const r=t+e,o=[],a=[],l=[{node:this._root,offset:0}];for(;l.length>0;){const d=l.pop(),g=d.offset;if(g<t&&g+d.node.length<=t){As(d.node)||(d.node.parent=void 0),o.push(d.node);continue}else As(d.node)&&g<t&&o.push({length:t-g,token:d.node.token,height:0,tokenQuality:d.node.tokenQuality});if(!(t<=g&&g+d.node.length<=r)){if(g>=r){As(d.node)||(d.node.parent=void 0),a.push(d.node);continue}else if(As(d.node)&&g+d.node.length>r){a.push({length:g+d.node.length-r,token:d.node.token,height:0,tokenQuality:d.node.tokenQuality});continue}if(!As(d.node)){let p=g+d.node.length;for(let _=d.node.children.length-1;_>=0;_--)p-=d.node.children[_].length,l.push({node:d.node.children[_],offset:p})}}}let c;i.length>0?c=o.concat(this.createFromUpdates(i,n),a):c=o.concat(a);let u=c[0];for(let d=1;d<c.length;d++)u=hke(u,c[d]);this._root=u??this.createEmptyRoot()}traverseInOrderInRange(e,t,i){const n=[{node:this._root,offset:0}];for(;n.length>0;){const{node:r,offset:o}=n.pop();if(!(o+r.length<=e||o>=t)){if(i(r,o))return;if(!As(r)){let l=o+r.length;for(let c=r.children.length-1;c>=0;c--)l-=r.children[c].length,n.push({node:r.children[c],offset:l})}}}}getTokenAt(e){let t;return this.traverseInOrderInRange(e,this._root.length,(i,n)=>As(i)?(t={token:i.token,startOffsetInclusive:n,length:i.length},!0):!1),t}getTokensInRange(e,t){const i=[];return this.traverseInOrderInRange(e,t,(n,r)=>{if(As(n)){let o=n.length,a=r;r<e&&r+n.length>t?(a=e,o=t-e):r<e?(o-=e-r,a=e):r+n.length>t&&(o-=r+n.length-t),i.push({token:n.token,startOffsetInclusive:a,length:o})}return!1}),i}markForRefresh(e,t){this.traverseInOrderInRange(e,t,i=>(As(i)&&(i.tokenQuality=Yr.None),!1))}rangeHasTokens(e,t,i){let n=!0;return this.traverseInOrderInRange(e,t,r=>(As(r)&&r.tokenQuality<i&&(n=!1),!1)),n}rangeNeedsRefresh(e,t){let i=!1;return this.traverseInOrderInRange(e,t,n=>(As(n)&&n.tokenQuality!==Yr.Accurate&&(i=!0),!1)),i}getNeedsRefresh(){const e=[];return this.traverseInOrderInRange(0,this._textModel.getValueLength(),(t,i)=>(As(t)&&t.tokenQuality!==Yr.Accurate&&(e.length>0&&e[e.length-1].endOffset===i?e[e.length-1].endOffset+=t.length:e.push({startOffset:i,endOffset:i+t.length})),!1)),e}dispose(){const e=[[this._root,!1]];for(;e.length>0;){const[t,i]=e.pop();if(!As(t))if(i)t.dispose(),t.parent=void 0;else{e.push([t,!0]);for(let n=t.children.length-1;n>=0;n--)e.push([t.children[n],!1])}}this._root=void 0}}const dke=tt("treeSitterThemeService");function fke(s){return{createChangeSummary:e=>({changes:[]}),handleChange(e,t){for(const i in s)e.didChange(s[i])&&t.changes.push({key:i,change:e.change});return!0},beforeUpdate(e,t){for(const i in s){if(i==="changes")throw new Pe('property name "changes" is reserved for change tracking');t[i]=s[i].read(e)}}}}var gke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},mke=function(s,e){return function(t,i){e(t,i,s)}};let F5=class extends ne{get _textModel(){return this._tree.textModel}constructor(e,t,i,n,r){super(),this._tree=e,this._highlightingQueries=t,this._languageIdCodec=i,this._visibleLineRanges=n,this._treeSitterThemeService=r,this._onDidChangeTokens=this._register(new $),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidCompleteBackgroundTokenization=this._register(new $),this.onDidChangeBackgroundTokenization=this._onDidCompleteBackgroundTokenization.event,this._encodedLanguageId=this._languageIdCodec.encodeLanguageId(this._tree.languageId),this._register(Q0(this._treeSitterThemeService.onChange,()=>{this._updateTheme()})),this._tokenStore=this._register(new uke(this._textModel)),this._accurateVersion=this._textModel.getVersionId(),this._guessVersion=this._textModel.getVersionId(),this._tokenStore.buildStore(this._createEmptyTokens(),Yr.None),this._register(ct(o=>{const a=this._visibleLineRanges.read(o);this._parseAndTokenizeViewPort(a)})),this._register(H1({owner:this,changeTracker:fke({tree:this._tree.tree})},(o,a)=>{var c;const l=(c=a.changes.at(0))==null?void 0:c.change;if(a.changes.length>1)throw new Pe("The tree changed twice in one transaction. This is currently not supported and should not happen.");if(!l)a.tree&&this._firstTreeUpdate(this._tree.treeLastParsedVersion.read(o));else{if(this.hasTokens())for(const u of l.ranges)this._markForRefresh(u.newRange);this.hasTokens()?this._handleTreeUpdate(l.ranges,l.versionId):this._firstTreeUpdate(l.versionId)}}))}handleContentChanged(e){this._guessVersion=e.versionId;for(const t of e.changes)if(t.text.length>t.rangeLength){const i=t.rangeOffset>0?t.rangeOffset-1:t.rangeOffset,n=this._tokenStore.getTokenAt(i);let r;n?(r={startOffsetInclusive:n.startOffsetInclusive,length:n.length+t.text.length-t.rangeLength,token:n.token},this._tokenStore.markForRefresh(i,t.rangeOffset+(t.text.length>t.rangeLength?t.text.length:t.rangeLength))):r={startOffsetInclusive:i,length:t.text.length,token:0},this._tokenStore.update((n==null?void 0:n.length)??0,[r],Yr.EditGuess)}else if(t.text.length<t.rangeLength){const i=t.rangeLength-t.text.length;this._tokenStore.delete(i,t.rangeOffset)}}getLineTokens(e){const t=this._textModel.getLineContent(e),i=this.getTokens(e);return new gn(i,t,this._languageIdCodec)}_createEmptyTokens(){const e=this._emptyToken(),t=this._textModel.getValueLength();return[this._emptyTokensForOffsetAndLength(0,t,e)]}_emptyToken(){return this._treeSitterThemeService.findMetadata([],this._encodedLanguageId,!1,void 0)}_emptyTokensForOffsetAndLength(e,t,i){return{token:i,length:e+t,startOffsetInclusive:0}}hasAccurateTokensForLine(e){return this.hasTokens(new H(e,1,e,this._textModel.getLineMaxColumn(e)))}tokenizeLinesAt(e,t){const i=this._guessTokensForLinesContent(e,t),n=[];if(!i)return null;for(let r=0;r<i.length;r++)n.push(new gn(i[r],t[r],this._languageIdCodec));return n}_rangeHasTokens(e,t){return this._tokenStore.rangeHasTokens(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()),t)}hasTokens(e){return!e||this._guessVersion===this._accurateVersion?!0:!this._tokenStore.rangeNeedsRefresh(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()))}getTokens(e){const t=this._textModel.getOffsetAt({lineNumber:e,column:1}),i=this._textModel.getOffsetAt({lineNumber:e,column:this._textModel.getLineLength(e)+1}),n=this._tokenStore.getTokensInRange(t,i),r=new Uint32Array(n.length*2);for(let o=0;o<n.length;o++)r[o*2]=n[o].startOffsetInclusive-t+n[o].length,r[o*2+1]=n[o].token;return r}getTokensInRange(e,t,i,n){const r=n?this._tokenizeCapturesWithMetadata(n,t,i):this._tokenize(e,t,i);if(r!=null&&r.endOffsetsAndMetadata)return this._rangeTokensAsUpdates(t,r.endOffsetsAndMetadata)}_updateTokensInStore(e,t,i){this._accurateVersion=e;for(const n of t){const r=n.newTokens.length>0?n.newTokens[n.newTokens.length-1]:void 0;let o;r&&this._guessVersion>=e?o=r.startOffsetInclusive+r.length-n.newTokens[0].startOffsetInclusive:n.oldRangeLength?o=n.oldRangeLength:o=0,this._tokenStore.update(o,n.newTokens,i)}}_markForRefresh(e){this._tokenStore.markForRefresh(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()))}_getNeedsRefresh(){const e=this._tokenStore.getNeedsRefresh();return e?e.map(t=>({range:H.fromPositions(this._textModel.getPositionAt(t.startOffset),this._textModel.getPositionAt(t.endOffset)),startOffset:t.startOffset,endOffset:t.endOffset})):[]}_parseAndTokenizeViewPort(e){const t=e.map(i=>i.toInclusiveRange()).filter(Io);for(const i of t){const n=this._textModel.getOffsetAt(i.getStartPosition()),r=this._textModel.getOffsetAt(i.getEndPosition()),o=this._textModel.getVersionId();if(this._rangeHasTokens(i,Yr.ViewportGuess))continue;const a=this._textModel.getValueInRange(i),l=this._forceParseAndTokenizeContent(i,n,r,a,!0);if(!l||this._rangeHasTokens(i,Yr.ViewportGuess)||l.length===0)continue;const c=l[l.length-1],u=c.startOffsetInclusive+c.length-l[0].startOffsetInclusive;this._updateTokensInStore(o,[{newTokens:l,oldRangeLength:u}],Yr.ViewportGuess),this._onDidChangeTokens.fire({changes:{semanticTokensApplied:!1,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]}})}}_guessTokensForLinesContent(e,t){if(t.length===0)return;const i=t.join(this._textModel.getEOL()),n=new H(1,1,e+t.length,t[t.length-1].length+1),r=this._textModel.getOffsetAt({lineNumber:e,column:1}),o=this._forceParseAndTokenizeContent(n,r,r+i.length,i,!1);if(!o)return;const a=new Array(t.length);let l=0,c=0,u=0;for(let d=0;d<t.length;d++){const g=[];let p=!1;for(let _=l;!p&&_<o.length;_++){const C=o[_],v=C.endOffset-u,x=c-u;if(v<=t[d].length)g.push({endOffset:v,metadata:C.metadata}),l++;else if(x<t[d].length){const S={endOffset:t[d].length,metadata:C.metadata};g.push(S),p=!0}else p=!0;c=C.endOffset}a[d]=this._endOffsetTokensToUint32Array(g),u+=t[d].length+this._textModel.getEOL().length}return a}_forceParseAndTokenizeContent(e,t,i,n,r){const o=yJ(this._textModel,e.startLineNumber).likelyRelevantLines,a=o.join(this._textModel.getEOL()),l=this._tree.createParsedTreeSync(`${a}${n}`);if(!l)return;const c=new H(1,1,e.endLineNumber-e.startLineNumber+1+o.length,e.endColumn),u=this.captureAtRange(c),d=this._tokenizeCapturesWithMetadata(u,a.length,i-t+a.length);if(l.delete(),!!d)return r?this._rangeTokensAsUpdates(t,d.endOffsetsAndMetadata,a.length):d.endOffsetsAndMetadata}_firstTreeUpdate(e){return this._setViewPortTokens(e)}_setViewPortTokens(e){const t=this._visibleLineRanges.get().map(i=>{const n=i.toInclusiveRange();if(!n)return;const r=this._textModel.getOffsetAt(n.getStartPosition()),o=this._textModel.getOffsetAt(n.getEndPosition());return{newRange:n,newRangeEndOffset:o,newRangeStartOffset:r}}).filter(Io);return this._handleTreeUpdate(t,e)}_handleTreeUpdate(e,t){const i=[];for(let o=0;o<e.length;o++)if(e[o].newRange.endLineNumber-e[o].newRange.startLineNumber>1e3){const l=e[o].newRange.endLineNumber;let c=e[o].newRange.startLineNumber,u=e[o].newRange.startColumn,d=c+1e3;do{const g=new Y(c,u),p=d===e[o].newRange.endLineNumber?e[o].newRange.endColumn:this._textModel.getLineMaxColumn(d),_=new Y(d,p),C=H.fromPositions(g,_);i.push({range:C,startOffset:this._textModel.getOffsetAt(C.getStartPosition()),endOffset:this._textModel.getOffsetAt(C.getEndPosition())}),c=d+1,u=1,d<l&&d+1e3>l?d=l:d=d+1e3}while(d<=l)}else if(o===0||i[o-1].endOffset<e[o].newRangeStartOffset)i.push({range:e[o].newRange,startOffset:e[o].newRangeStartOffset,endOffset:e[o].newRangeEndOffset});else if(i[o-1].endOffset<e[o].newRangeEndOffset){const l=this._textModel.getPositionAt(i[o-1].endOffset+1),c=new H(l.lineNumber,l.column,e[o].newRange.endLineNumber,e[o].newRange.endColumn);i.push({range:c,startOffset:i[o-1].endOffset+1,endOffset:e[o].newRangeEndOffset})}const r=i.map(o=>this._getCaptures(o.range));return this._updateTreeForRanges(i,t,r).then(()=>{!this._textModel.isDisposed()&&this._tree.treeLastParsedVersion.get()===this._textModel.getVersionId()&&this._refreshNeedsRefresh(t)})}async _updateTreeForRanges(e,t,i){let n;for(let r=0;r<e.length&&!(!this._textModel.isDisposed()&&t!==this._textModel.getVersionId());r++){const o=i[r],a=e[r],l=this.getTokensInRange(a.range,a.startOffset,a.endOffset,o);l?n={newTokens:l}:n={newTokens:[]},this._updateTokensInStore(t,[n],Yr.Accurate),this._onDidChangeTokens.fire({changes:{semanticTokensApplied:!1,ranges:[{fromLineNumber:a.range.getStartPosition().lineNumber,toLineNumber:a.range.getEndPosition().lineNumber}]}}),await new Promise(c=>Ev(c))}this._onDidCompleteBackgroundTokenization.fire()}_refreshNeedsRefresh(e){const t=this._getNeedsRefresh();if(t.length===0)return;const i=new Array(t.length);for(let n=0;n<t.length;n++){const r=t[n];i[n]={newRange:r.range,newRangeStartOffset:r.startOffset,newRangeEndOffset:r.endOffset}}this._handleTreeUpdate(i,e)}_rangeTokensAsUpdates(e,t,i){const n=[];let r=0;for(const o of t){if(o.endOffset<=r||i&&o.endOffset<i)continue;let a;i&&r<i?a={startOffsetInclusive:e+i,length:o.endOffset-i,token:o.metadata}:a={startOffsetInclusive:e+r,length:o.endOffset-r,token:o.metadata},n.push(a),r=o.endOffset}return n}_updateTheme(){const e=this._textModel.getFullModelRange();this._markForRefresh(e),this._parseAndTokenizeViewPort(this._visibleLineRanges.get())}captureAtRange(e){const t=this._tree.tree.get();return t?this._highlightingQueries.captures(t.rootNode,{startPosition:{row:e.startLineNumber-1,column:e.startColumn-1},endPosition:{row:e.endLineNumber-1,column:e.endColumn-1}}).map(i=>({name:i.name,text:i.node.text,node:{startIndex:i.node.startIndex,endIndex:i.node.endIndex,startPosition:{lineNumber:i.node.startPosition.row+1,column:i.node.startPosition.column+1},endPosition:{lineNumber:i.node.endPosition.row+1,column:i.node.endPosition.column+1}},encodedLanguageId:this._encodedLanguageId})):[]}captureAtRangeWithInjections(e){const t=this.captureAtRange(e);for(let i=0;i<t.length;i++){const n=t[i],r=n.node.startPosition.lineNumber,o=n.node.endPosition.lineNumber,a=n.node.startPosition.column,l=n.node.endPosition.column,c=r>e.startLineNumber&&r<e.endLineNumber?r:e.startLineNumber,u=o>e.startLineNumber&&o<e.endLineNumber?o:e.endLineNumber,d=r===e.startLineNumber?a<e.startColumn?e.startColumn:a:r<e.startLineNumber?e.startColumn:a,g=o===e.endLineNumber?l>e.endColumn?e.endColumn:l:o>e.endLineNumber?e.endColumn:l,p=new H(c,d,u,g),_=this._getInjectionCaptures(n,p);_&&_.length>0&&(t.splice(i+1,0,..._),i+=_.length)}return t}tokenizeEncoded(e){const t=this._tokenizeEncoded(e);if(!t)return;const i=this._rangeTokensAsUpdates(this._textModel.getOffsetAt({lineNumber:e,column:1}),t.result);t.versionId===this._textModel.getVersionId()&&this._updateTokensInStore(t.versionId,[{newTokens:i,oldRangeLength:this._textModel.getLineLength(e)}],Yr.Accurate)}_getCaptures(e){return this.captureAtRangeWithInjections(e)}_tokenize(e,t,i){const n=this._getCaptures(e),r=this._tokenizeCapturesWithMetadata(n,t,i);if(r)return{...r,versionId:this._tree.treeLastParsedVersion.get()}}_createTokensFromCaptures(e,t,i){const n=this._tree.tree.get(),r=Ah.create(),o=i-t,a=this._languageIdCodec.encodeLanguageId(this._tree.languageId),l=pke[this._tree.languageId]||"source";if(e.length===0)return n?(r.stop(),{endOffsets:[{endOffset:o,scopes:[],encodedLanguageId:a}],captureTime:r.elapsed()}):void 0;const c=Array(e.length);c.fill({endOffset:0,scopes:[l],encodedLanguageId:a});let u=0;const d=()=>{c.push({endOffset:0,scopes:[l],encodedLanguageId:a})},g=(C,v)=>C.name.includes("punctuation")&&C.text?Array.from(C.text.matchAll(_ke)).map(x=>v+x.index):void 0,p=(C,v,x,S)=>{if(S!==void 0){const k=c[S].scopes;let E=c[S].bracket;if((S>0?c[S-1].endOffset:0)!==v){let R;if(E&&E.length>0){R=[];const N=[];for(let A=0;A<E.length;A++){const O=E[A];O<v?R.push(O):O>x&&N.push(O)}R.length===0&&(R=void 0),N.length===0?E=void 0:E=N}c.splice(S,0,{endOffset:v,scopes:[...k],bracket:R,encodedLanguageId:C.encodedLanguageId}),S++,d(),u++}c.splice(S,0,{endOffset:x,scopes:[...k,C.name],bracket:g(C,v),encodedLanguageId:C.encodedLanguageId}),c[u].bracket=E}else c[u]={endOffset:x,scopes:[l,C.name],bracket:g(C,v),encodedLanguageId:C.encodedLanguageId};u++};for(let C=0;C<e.length;C++){const v=e[C],x=v.node.endIndex<i?v.node.endIndex<t?t:v.node.endIndex:i,S=v.node.startIndex<t?t:v.node.startIndex,k=x-t;let E;const T=x-S;C>0?E=c[u-1].endOffset:E=S-t-1;const R=k-T;if(E>=0&&E<R&&(c[u]={endOffset:R,scopes:[l],encodedLanguageId:this._encodedLanguageId},u++,d()),!(T<0))if(E>=k){let N=u-1,A=c[N].endOffset,O=N>=2?c[N-1].endOffset:0;do{if(O+T===A){if(O===R){c[N].scopes.push(v.name);const W=c[N].bracket;c[N].bracket=W&&W.length>0?W:g(v,R)}}else if(O<=R){p(v,R,k,N);break}N--,O=N>=1?c[N-1].endOffset:0,A=N>=0?c[N].endOffset:0}while(A>R)}else p(v,R,k)}c[u-1].endOffset<o&&o-c[u-1].endOffset>0&&(d(),c[u]={endOffset:o,scopes:c[u].scopes,encodedLanguageId:this._encodedLanguageId},u++);for(let C=0;C<c.length;C++)if(c[C].endOffset===0&&C!==0){c.splice(C,c.length-C);break}const _=r.elapsed();return{endOffsets:c,captureTime:_}}_getInjectionCaptures(e,t){return[]}_tokenizeCapturesWithMetadata(e,t,i){const n=Ah.create(),r=this._createTokensFromCaptures(e,t,i);if(!r)return;const o=r.endOffsets;for(let l=0;l<o.length;l++){const c=o[l];c.metadata=this._treeSitterThemeService.findMetadata(c.scopes,c.encodedLanguageId,!!c.bracket&&c.bracket.length>0,void 0)}const a=n.elapsed();return{endOffsetsAndMetadata:o,captureTime:r.captureTime,metadataTime:a}}_tokenizeEncoded(e){const t=this._textModel.getOffsetAt({lineNumber:e,column:1}),i=this._textModel.getLineCount(),n=e+1<=i?this._textModel.getOffsetAt({lineNumber:e+1,column:1}):this._textModel.getValueLength(),r=n-t,o=this._tokenize(new H(e,1,e,r+1),t,n);if(o)return{result:o.endOffsetsAndMetadata,captureTime:o.captureTime,metadataTime:o.metadataTime,versionId:o.versionId}}_endOffsetTokensToUint32Array(e){const t=new Uint32Array(e.length*2);for(let i=0;i<e.length;i++)t[i*2]=e[i].endOffset,t[i*2+1]=e[i].metadata;return t}};F5=gke([mke(4,dke)],F5);const pke={css:"source.css",typescript:"source.ts",ini:"source.ini",regex:"source.regex"},_ke=/[\{\}\[\]\<\>\(\)]/g,P6=tt("treeSitterLibraryService");class bke{constructor(e){this._value=Qe(this,void 0),this.promiseResult=this._value,this.promise=e.then(t=>(Vi(i=>{this._value.set(new wj(t,void 0),i)}),t),t=>{throw Vi(i=>{this._value.set(new wj(void 0,t),i)}),t})}}class wj{constructor(e,t){this.data=e,this.error=t}getDataOrThrow(){if(this.error)throw this.error;return this.data}}var Cke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},vj=function(s,e){return function(t,i){e(t,i,s)}};let B5=class extends wJ{constructor(e,t,i,n,r,o){super(t,i),this._languageIdObs=e,this._treeSitterLibraryService=r,this._instantiationService=o,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new $),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;const a=new bke(this._treeSitterLibraryService.getParserClass()),l=Ie(this,c=>{var d,g;return(g=(d=a.promiseResult)==null?void 0:d.read(c))==null?void 0:g.getDataOrThrow()});this._tree=Ie(this,c=>{const u=l.read(c);if(!u)return;const d=this._languageIdObs.read(c),g=this._treeSitterLibraryService.getLanguage(d,!1,c);if(!g)return;const p=new u;if(c.store.add(Fe(()=>{p.delete()})),p.setLanguage(g),this._treeSitterLibraryService.getInjectionQueries(d,c)!==void 0)return c.store.add(this._instantiationService.createInstance(M5,d,void 0,p,u,this._textModel))}),this._tokenizationImpl=Ie(this,c=>{const u=this._tree.read(c);if(!u)return;const d=this._treeSitterLibraryService.getHighlightingQueries(u.languageId,c);if(d)return c.store.add(this._instantiationService.createInstance(F5,u,d,this._languageIdCodec,n))}),this._register(ct(c=>{const u=this._tokenizationImpl.read(c);u&&(c.store.add(u.onDidChangeTokens(d=>{this._onDidChangeTokens.fire(d.changes)})),c.store.add(u.onDidChangeBackgroundTokenization(d=>{this._backgroundTokenizationState=2,this._onDidChangeBackgroundTokenizationState.fire()})))}))}getLineTokens(e){const t=this._tokenizationImpl.get();if(!t){const i=this._textModel.getLineContent(e);return gn.createEmpty(i,this._languageIdCodec)}return t.getLineTokens(e)}todo_resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}handleDidChangeAttached(){}handleDidChangeContent(e){if(e.isFlush)this.todo_resetTokenization(!1);else{const i=this._tokenizationImpl.get();i==null||i.handleContentChanged(e)}const t=this._tree.get();t==null||t.handleContentChange(e)}forceTokenization(e){const t=this._tokenizationImpl.get();t&&(t.hasAccurateTokensForLine(e)||t.tokenizeEncoded(e))}hasAccurateTokensForLine(e){const t=this._tokenizationImpl.get();return t?t.hasAccurateTokensForLine(e):!1}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,t,i){return 0}tokenizeLinesAt(e,t){const i=this._tokenizationImpl.get();return i?i.tokenizeLinesAt(e,t):null}get hasTokens(){const e=this._tokenizationImpl.get();return e?e.hasTokens():!1}};B5=Cke([vj(4,P6),vj(5,wt)],B5);class F6{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t,i=void 0){if(this._pieces=e||[],this._isComplete=t,i)for(const n of this._pieces)n.reportIfInvalid(i)}setPartial(e,t){let i=e;if(t.length>0){const r=t[0].getRange(),o=t[t.length-1].getRange();if(!r||!o)return e;i=e.plusRange(r).plusRange(o)}let n=null;for(let r=0,o=this._pieces.length;r<o;r++){const a=this._pieces[r];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:r};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(r,1),r--,o--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:r};continue}const[l,c]=a.split(i);if(l.isEmpty()){n=n||{index:r};continue}c.isEmpty()||(this._pieces.splice(r,1,l,c),r++,o++,n=n||{index:r})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=G2(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getTextLength()===0)return t;const i=this._pieces;if(i.length===0)return t;const n=F6._findFirstPieceWithLine(i,e),r=i[n].getLineTokens(e);if(!r)return t;const o=t.getCount(),a=r.getCount();let l=0;const c=[];let u=0,d=0;const g=(p,_)=>{p!==d&&(d=p,c[u++]=p,c[u++]=_)};for(let p=0;p<a;p++){const _=Math.min(r.getStartCharacter(p),t.getTextLength()),C=Math.min(r.getEndCharacter(p),t.getTextLength()),v=r.getMetadata(p),x=((v&1?2048:0)|(v&2?4096:0)|(v&4?8192:0)|(v&8?16384:0)|(v&16?16744448:0)|(v&32?4278190080:0))>>>0,S=~x>>>0;for(;l<o&&t.getEndOffset(l)<=_;)g(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<o&&t.getStartOffset(l)<_&&g(_,t.getMetadata(l));l<o&&t.getEndOffset(l)<C;)g(t.getEndOffset(l),t.getMetadata(l)&S|v&x),l++;if(l<o)g(C,t.getMetadata(l)&S|v&x),t.getEndOffset(l)===C&&l++;else{const k=Math.min(Math.max(0,l-1),o-1);g(C,t.getMetadata(k)&S|v&x)}}for(;l<o;)g(t.getEndOffset(l),t.getMetadata(l)),l++;return new gn(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let r=i+Math.floor((n-i)/2);if(e[r].endLineNumber<t)i=r+1;else if(e[r].startLineNumber>t)n=r-1;else{for(;r>i&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return i}acceptEdit(e,t,i,n,r){for(let o=0;o<this._pieces.length;o++){const a=this._pieces[o];a.acceptEdit(e,t,i,n,r),a.isEmpty()&&(this._pieces.splice(o,1),o--)}}}const qc=new Uint32Array(0).buffer;class Ll{static deleteBeginning(e,t){return e===null||e===qc?e:Ll.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===qc)return e;const i=dh(e),n=i[i.length-2];return Ll.delete(e,t,n)}static delete(e,t,i){if(e===null||e===qc||t===i)return e;const n=dh(e),r=n.length>>>1;if(t===0&&n[n.length-2]===i)return qc;const o=gn.findIndexInTokensArray(n,t),a=o>0?n[o-1<<1]:0,l=n[o<<1];if(i<l){const p=i-t;for(let _=o;_<r;_++)n[_<<1]-=p;return e}let c,u;a!==t?(n[o<<1]=t,c=o+1<<1,u=t):(c=o<<1,u=a);const d=i-t;for(let p=o+1;p<r;p++){const _=n[p<<1]-d;_>u&&(n[c++]=_,n[c++]=n[(p<<1)+1],u=_)}if(c===n.length)return e;const g=new Uint32Array(c);return g.set(n.subarray(0,c),0),g.buffer}static append(e,t){if(t===qc)return e;if(e===qc)return t;if(e===null)return e;if(t===null)return null;const i=dh(e),n=dh(t),r=n.length>>>1,o=new Uint32Array(i.length+n.length);o.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<r;c++)o[a++]=n[c<<1]+l,o[a++]=n[(c<<1)+1];return o.buffer}static insert(e,t,i){if(e===null||e===qc)return e;const n=dh(e),r=n.length>>>1;let o=gn.findIndexInTokensArray(n,t);o>0&&n[o-1<<1]===t&&o--;for(let a=o;a<r;a++)n[a<<1]+=i;return e}}function dh(s){return s instanceof Uint32Array?s:new Uint32Array(s)}class jw{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==qc)return new gn(dh(n),i,this._languageIdCodec);const r=new Uint32Array(2);return r[0]=i.length,r[1]=yj(this._languageIdCodec.encodeLanguageId(e)),new gn(r,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?dh(i):null;if(t===0){let r=!1;if(n&&n.length>1&&(r=Qr.getLanguageId(n[1])!==e),!r)return qc}if(!n||n.length===0){const r=new Uint32Array(2);return r[0]=t,r[1]=yj(e),r.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=G2(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,r){const o=jw._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=o,r?!jw._equals(a,o):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=dh(e),n=dh(t);if(i.length!==n.length)return!1;for(let r=0,o=i.length;r<o;r++)if(i[r]!==n[r])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new Y(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=Ll.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=Ll.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=Ll.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=Ll.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=Ll.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=Ll.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=Ll.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];let a=0,l=0,c=!1;for(let u=o.startLineNumber;u<=o.endLineNumber;u++)c?(this.setTokens(t.getLanguageId(),u-1,t.getLineLength(u),o.getLineTokens(u),!1),l=u):this.setTokens(t.getLanguageId(),u-1,t.getLineLength(u),o.getLineTokens(u),!0)&&(c=!0,a=u,l=u);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function yj(s){return(s<<0|0|0|32768|2<<24|1024)>>>0}class wke extends wJ{constructor(e,t,i,n){super(e,t),this.getLanguageId=i,this._tokenizer=null,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new $),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new kn),this._tokens=new jw(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new kn),this._attachedViewStates=this._register(new u7),this._register(qi.onDidChange(r=>{const o=this.getLanguageId();r.changedLanguages.indexOf(o)!==-1&&this.todo_resetTokenization()})),this.todo_resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:r,state:o})=>{if(o){let a=this._attachedViewStates.get(r);a||(a=new KLe(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(o)}else this._attachedViewStates.deleteAndDispose(r)}))}todo_resetTokenization(e=!0){var r;this._tokens.flush(),(r=this._debugBackgroundTokens)==null||r.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new P5(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const o=qi.get(this.getLanguageId());if(!o)return[null,null];let a;try{a=o.getInitialState()}catch(l){return It(l),[null,null]}return[o,a]},[i,n]=t();if(i&&n?this._tokenizer=new rke(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const o={setTokens:a=>{this.setTokens(a)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const a=2;this._backgroundTokenizationState=a,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(a,l)=>{var u;if(!this._tokenizer)return;const c=this._tokenizer.store.getFirstInvalidEndStateLineNumber();c!==null&&a>=c&&((u=this._tokenizer)==null||u.store.setEndState(a,l))}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new lke(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i!=null&&i.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new jw(this._languageIdCodec),this._debugBackgroundStates=new P5(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:a=>{var l;(l=this._debugBackgroundTokens)==null||l.setMultilineTokens(a,this._textModel)},backgroundTokenizationFinished(){},setEndState:(a,l)=>{var c;(c=this._debugBackgroundStates)==null||c.setEndState(a,l)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var e;(e=this._defaultBackgroundTokenizer)==null||e.handleChanges()}handleDidChangeContent(e){var t,i,n;if(e.isFlush)this.todo_resetTokenization(!1);else if(!e.isEolChange){for(const r of e.changes){const[o,a]=S1(r.text);this._tokens.acceptEdit(r.range,o,a),(t=this._debugBackgroundTokens)==null||t.acceptEdit(r.range,o,a)}(i=this._debugBackgroundStates)==null||i.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),(n=this._defaultBackgroundTokenizer)==null||n.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=He.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){var o,a;if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const i=new O5,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),r=this.setTokens(i.finalize());if(n)for(const l of r.changes)(o=this._backgroundTokenizer.value)==null||o.requestTokens(l.fromLineNumber,l.toLineNumber+1);(a=this._defaultBackgroundTokenizer)==null||a.checkFinished()}forceTokenization(e){var i,n;const t=new O5;(i=this._tokenizer)==null||i.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),(n=this._defaultBackgroundTokenizer)==null||n.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){var n;const t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const r=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(r)&&((n=this._debugBackgroundTokenizer.value)!=null&&n.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const n=this._textModel.validatePosition(new Y(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLinesAt(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLinesAt(e,t)):null}get hasTokens(){return this._tokens.hasTokens}}var vke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},JS=function(s,e){return function(t,i){e(t,i,s)}},Gx;let V5=Gx=class extends jZ{constructor(e,t,i,n,r,o,a,l){super(),this._textModel=e,this._bracketPairsTextModelPart=t,this._languageId=i,this._attachedViews=n,this._languageService=r,this._languageConfigurationService=o,this._instantiationService=a,this._treeSitterLibraryService=l,this._languageIdObs=Qe(this,this._languageId),this._useTreeSitter=Ie(this,u=>{const d=this._languageIdObs.read(u);return this._treeSitterLibraryService.supportsLanguage(d,u)}),this.tokens=Ie(this,u=>{let d;return this._useTreeSitter.read(u)?d=u.store.add(this._instantiationService.createInstance(B5,this._languageIdObs,this._languageService.languageIdCodec,this._textModel,this._attachedViews.visibleLineRanges)):d=u.store.add(new wke(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews)),u.store.add(d.onDidChangeTokens(g=>{this._emitModelTokensChangedEvent(g)})),u.store.add(d.onDidChangeBackgroundTokenizationState(g=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),d});let c=!1;this.tokens.recomputeInitiallyAndOnChange(this._store,u=>{c&&u.todo_resetTokenization(),c=!0}),this._semanticTokens=new F6(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new $),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new $),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new $),this.onDidChangeTokens=this._onDidChangeTokens.event}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,n,r]=S1(t.text);this._semanticTokens.acceptEdit(t.range,i,n,r,t.text.length>0?t.text.charCodeAt(0):0)}this.tokens.get().handleDidChangeContent(e)}handleDidChangeAttached(){this.tokens.get().handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this.tokens.get().getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new Pe("Illegal value for lineNumber")}get hasTokens(){return this.tokens.get().hasTokens}resetTokenization(){this.tokens.get().todo_resetTokenization()}get backgroundTokenizationState(){return this.tokens.get().backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this.tokens.get().forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this.tokens.get().hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this.tokens.get().isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this.tokens.get().tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this.tokens.get().getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLinesAt(e,t){return this.tokens.get().tokenizeLinesAt(e,t)}setSemanticTokens(e,t){this._semanticTokens.set(e,t,this._textModel),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),n=this.getLineTokens(t.lineNumber),r=n.findTokenIndexAtOffset(t.column-1),[o,a]=Gx._findLanguageBoundaries(n,r),l=dw(t.column,this.getLanguageConfiguration(n.getLanguageId(r)).getWordDefinition(),i.substring(o,a),o);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(r>0&&o===t.column-1){const[c,u]=Gx._findLanguageBoundaries(n,r-1),d=dw(t.column,this.getLanguageConfiguration(n.getLanguageId(r-1)).getWordDefinition(),i.substring(c,u),c);if(d&&d.startColumn<=e.column&&e.column<=d.endColumn)return d}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let o=t;o>=0&&e.getLanguageId(o)===i;o--)n=e.getStartOffset(o);let r=e.getLineContent().length;for(let o=t,a=e.getCount();o<a&&e.getLanguageId(o)===i;o++)r=e.getEndOffset(o);return[n,r]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new Y(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._languageIdObs.set(e,void 0),this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};V5=Gx=vke([JS(4,En),JS(5,rc),JS(6,wt),JS(7,P6)],V5);const B6=tt("undoRedoService");class xJ{constructor(e,t){this.resource=e,this.elements=t}}const c_=class c_{constructor(){this.id=c_._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};c_._ID=0,c_.None=new c_;let W5=c_;const h_=class h_{constructor(){this.id=h_._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};h_._ID=0,h_.None=new h_;let Ef=h_;var Sj;function yke(s,e){const t=[],i=[];for(const n of s)e.has(n)||t.push(n);for(const n of e)s.has(n)||i.push(n);return{removed:t,added:i}}function LJ(s,e){const t=new Set;for(const i of e)s.has(i)&&t.add(i);return t}class xj{constructor(e,t){this.toKey=t,this._map=new Map,this[Sj]="SetWithKey";for(const i of e)this.add(i)}get size(){return this._map.size}add(e){const t=this.toKey(e);return this._map.set(t,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(const e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,t){this._map.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}}Sj=Symbol.toStringTag;var Ske=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ex=function(s,e){return function(t,i){e(t,i,s)}},cf;function xke(s){const e=new CJ;return e.acceptChunk(s),e.finish()}function Lke(s){const e=new CJ;let t;for(;typeof(t=s.read())=="string";)e.acceptChunk(t);return e.finish()}function Lj(s,e){let t;return typeof s=="string"?t=xke(s):nbe(s)?t=Lke(s):t=s,t.create(e)}let tx=0;const kke=999,Eke=1e4,Dke=300;class Tke{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}}const r0=()=>{throw new Error("Invalid change accessor")};var Ba;let H5=(Ba=class extends ne{static resolveOptions(e,t){if(t.detectIndentation){const i=aj(e,t.tabSize,t.insertSpaces);return new Bx({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new Bx(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}get onDidChangeOptions(){return this._onDidChangeOptions.event}get onDidChangeAttached(){return this._onDidChangeAttached.event}get onDidChangeLineHeight(){return this._onDidChangeLineHeight.event}get onDidChangeFont(){return this._onDidChangeFont.event}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return Bl(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,n=null,r,o,a,l){super(),this._undoRedoService=r,this._languageService=o,this._languageConfigurationService=a,this.instantiationService=l,this._onWillDispose=this._register(new $),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new Oke((_,C,v)=>this.handleBeforeFireDecorationsChangedEvent(_,C,v))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new $),this._onDidChangeAttached=this._register(new $),this._onDidChangeInjectedText=this._register(new $),this._onDidChangeLineHeight=this._register(new $),this._onDidChangeFont=this._register(new $),this._eventEmitter=this._register(new Pke),this._languageSelectionListener=this._register(new kn),this._deltaDecorationCallCnt=0,this._attachedViews=new $Le,tx++,this.id="$model"+tx,this.isForSimpleWidget=i.isForSimpleWidget,typeof n>"u"||n===null?this._associatedResource=nt.parse("inmemory://model/"+tx):this._associatedResource=n,this._attachedEditorCount=0;const{textBuffer:c,disposable:u}=Lj(e,i.defaultEOL);this._buffer=c,this._bufferDisposable=u;const d=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new H(1,1,d,this._buffer.getLineLength(d)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>cf.LARGE_FILE_SIZE_THRESHOLD||d>cf.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>cf.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._options=cf.resolveOptions(this._buffer,i);const p=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new _Le(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new sSe(this,this._languageConfigurationService)),this._decorationProvider=this._register(new CLe(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(V5,this,this._bracketPairs,p,this._attachedViews),this._isTooLargeForSyncing=g>cf._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=AQ(tx),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new kj,this._commandManager=new R6(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(_=>{this._bracketPairs.handleLanguageConfigurationServiceChange(_),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(_)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new P_([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=ne.None}_assertNotDisposed(){if(this._isDisposed)throw new Pe("Model is disposed!")}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new cg(e,t)))}setValue(e,t=Do.setValue()){if(this._assertNotDisposed(),e==null)throw K2();const{textBuffer:i,disposable:n}=Lj(e,this._options.defaultEOL);this._setValueFromTextBuffer(i,n,t)}_createContentChanged2(e,t,i,n,r,o,a,l,c,u){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:c,versionId:this.getVersionId(),isUndoing:o,isRedoing:a,isFlush:l,detailedReasons:[u],detailedReasonsChangeLengths:[1]}}_setValueFromTextBuffer(e,t,i){this._assertNotDisposed();const n=this.getFullModelRange(),r=this.getValueLengthInRange(n),o=this.getLineCount(),a=this.getLineMaxColumn(o);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new kj,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new A_([new Fxe],this._versionId,!1,!1),this._createContentChanged2(new H(1,1,o,a),0,r,new Y(o,a),this.getValue(),!1,!1,!0,!1,i))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new A_([new zxe],this._versionId,!1,!1),this._createContentChanged2(new H(1,1,r,o),0,n,new Y(r,o),this.getValue(),!1,!1,!1,!0,Do.eolChange()))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const r=t[i],o=r.range,a=r.cachedAbsoluteStart-r.start,l=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),c=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);r.cachedAbsoluteStart=l,r.cachedAbsoluteEnd=c,r.cachedVersionId=e,r.start=l-a,r.end=c-a,pd(r)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const r=this._buffer.getLineLength(n);r>=Eke?t+=r:e+=r}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,n=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,r=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new Bx({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:r,bracketPairColorizationOptions:o});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=aj(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),yZ(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(IQ.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Pe("Operation would exceed heap memory limits");const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new Tke(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Pe("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Pe("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Pe("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Pe("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Pe("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Pe("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let r=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),o=Math.floor(typeof n=="number"&&!isNaN(n)?n:1);if(r<1)r=1,o=1;else if(r>t)r=t,o=this.getLineMaxColumn(r);else if(o<=1)o=1;else{const d=this.getLineMaxColumn(r);o>=d&&(o=d)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),u=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,u=1;else if(c>t)c=t,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{const d=this.getLineMaxColumn(c);u>=d&&(u=d)}return i===r&&n===o&&a===c&&l===u&&e instanceof H&&!(e instanceof gt)?e:new H(r,o,c,u)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const n=this._buffer.getLineCount();if(e>n)return!1;if(t===1)return!0;const r=this.getLineMaxColumn(e);if(t>r)return!1;if(i===1){const o=this._buffer.getLineCharCode(e,t-2);if(hn(o))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),o=this._buffer.getLineCount();if(n<1)return new Y(1,1);if(n>o)return new Y(o,this.getLineMaxColumn(o));if(r<=1)return new Y(n,1);const a=this.getLineMaxColumn(n);if(r>=a)return new Y(n,a);if(i===1){const l=this._buffer.getLineCharCode(n,r-2);if(hn(l))return new Y(n,r-1)}return new Y(n,r)}validatePosition(e){return this._assertNotDisposed(),e instanceof Y&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}isValidRange(e){return this._isValidRange(e,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(i,n,0)||!this._isValidPosition(r,o,0))return!1;if(t===1){const a=n>1?this._buffer.getLineCharCode(i,n-2):0,l=o>1&&o<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,o-2):0,c=hn(a),u=hn(l);return!c&&!u}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof H&&!(e instanceof gt)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),r=i.lineNumber,o=i.column,a=n.lineNumber,l=n.column;{const c=o>1?this._buffer.getLineCharCode(r,o-2):0,u=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,d=hn(c),g=hn(u);return!d&&!g?new H(r,o,a,l):r===a&&o===l?new H(r,o-1,a,l-1):d&&g?new H(r,o-1,a,l+1):d?new H(r,o-1,a,l):new H(r,o,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new H(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,r,o,a=kke){this._assertNotDisposed();let l=null;t!==null&&typeof t!="boolean"&&(Array.isArray(t)||(t=[t]),t.every(d=>H.isIRange(d))&&(l=t.map(d=>this.validateRange(d)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((d,g)=>d.startLineNumber-g.startLineNumber||d.startColumn-g.startColumn);const c=[];c.push(l.reduce((d,g)=>H.areIntersecting(d,g)?d.plusRange(g):(c.push(d),g)));let u;if(!i&&e.indexOf(`
`)<0){const g=new pp(e,i,n,r).parseSearchRequest();if(!g)return[];u=p=>this.findMatchesLineByLine(p,g,o,a)}else u=d=>WS.findMatches(this,new pp(e,i,n,r),d,o,a);return c.map(u).reduce((d,g)=>d.concat(g),[])}findNextMatch(e,t,i,n,r,o){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new pp(e,i,n,r).parseSearchRequest();if(!c)return null;const u=this.getLineCount();let d=new H(a.lineNumber,a.column,u,this.getLineMaxColumn(u)),g=this.findMatchesLineByLine(d,c,o,1);return WS.findNextMatch(this,new pp(e,i,n,r),a,o),g.length>0||(d=new H(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),g=this.findMatchesLineByLine(d,c,o,1),g.length>0)?g[0]:null}return WS.findNextMatch(this,new pp(e,i,n,r),a,o)}findPreviousMatch(e,t,i,n,r,o){this._assertNotDisposed();const a=this.validatePosition(t);return WS.findPreviousMatch(this,new pp(e,i,n,r),a,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof oR?e:new oR(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,n,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,n,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,n,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const o=t.map(l=>({range:this.validateRange(l.range),text:l.text}));let a=!0;if(e)for(let l=0,c=e.length;l<c;l++){const u=e[l];let d=!1;for(let g=0,p=o.length;g<p;g++){const _=o[g].range,C=_.startLineNumber>u.endLineNumber,v=u.startLineNumber>_.endLineNumber;if(!C&&!v){d=!0;break}}if(!d){a=!1;break}}if(a)for(let l=0,c=this._trimAutoWhitespaceLines.length;l<c;l++){const u=this._trimAutoWhitespaceLines[l],d=this.getLineMaxColumn(u);let g=!0;for(let p=0,_=o.length;p<_;p++){const C=o[p].range,v=o[p].text;if(!(u<C.startLineNumber||u>C.endLineNumber)&&!(u===C.startLineNumber&&C.startColumn===d&&C.isEmpty()&&v&&v.length>0&&v.charAt(0)===`
`)&&!(u===C.startLineNumber&&C.startColumn===1&&C.isEmpty()&&v&&v.length>0&&v.charAt(v.length-1)===`
`)){g=!1;break}}if(g){const p=new H(u,1,u,d);t.push(new oR(null,p,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,n,r)}_applyUndo(e,t,i,n){const r=e.map(o=>{const a=this.getPositionAt(o.newPosition),l=this.getPositionAt(o.newEnd);return{range:new H(a.lineNumber,a.column,l.lineNumber,l.column),text:o.oldText}});this._applyUndoRedoEdits(r,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const r=e.map(o=>{const a=this.getPositionAt(o.oldPosition),l=this.getPositionAt(o.oldEnd);return{range:new H(a.lineNumber,a.column,l.lineNumber,l.column),text:o.newText}});this._applyUndoRedoEdits(r,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,r,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(r)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t,i){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const n=this._validateEditOperations(e);return this._doApplyEdits(n,t??!1,i??Do.applyEdits())}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t,i){const n=this._buffer.getLineCount(),r=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),o=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let u=0,d=a.length;u<d;u++){const g=a[u];this._decorationsTree.acceptReplace(g.rangeOffset,g.rangeLength,g.text.length,g.forceMoveMarkers)}const l=[];this._increaseVersionId();let c=n;for(let u=0,d=a.length;u<d;u++){const g=a[u],[p]=S1(g.text);this._onDidChangeDecorations.fire();const _=g.range.startLineNumber,C=g.range.endLineNumber,v=C-_,x=p,S=Math.min(v,x),k=x-v,E=o-c-k+_,T=E,R=E+x,N=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new Y(T,1)),this.getOffsetAt(new Y(R,this.getLineMaxColumn(R))),0),A=Za.fromDecorations(N),O=new Rh(A);for(let W=S;W>=0;W--){const j=_+W,F=E+W;O.takeFromEndWhile(Z=>Z.lineNumber>F);const q=O.takeFromEndWhile(Z=>Z.lineNumber===F);l.push(new JU(j,this.getLineContent(F),q))}if(S<v){const W=_+S;l.push(new Wxe(W+1,C))}if(S<x){const W=new Rh(A),j=_+S,F=x-S,q=o-c-F+j+1,Z=[],K=[];for(let U=0;U<F;U++){const G=q+U;K[U]=this.getLineContent(G),W.takeWhile(Q=>Q.lineNumber<G),Z[U]=W.takeWhile(Q=>Q.lineNumber===G)}l.push(new Hxe(j+1,_+x,K,Z))}c+=k}this._emitContentChangedEvent(new A_(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1,detailedReasons:[i],detailedReasonsChangeLengths:[a.length]})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e,t,i){if(e&&e.size>0){const r=Array.from(e).map(o=>new JU(o,this.getLineContent(o),this._getInjectedTextInLine(o)));this._onDidChangeInjectedText.fire(new tJ(r))}if(t&&t.size>0){const r=Array.from(t).map(o=>new Bxe(o.ownerId,o.decorationId,o.lineNumber,o.lineHeight));this._onDidChangeLineHeight.fire(new iJ(r))}if(i&&i.size>0){const r=Array.from(i).map(o=>new Vxe(o.ownerId,o.lineNumber));this._onDidChangeFont.fire(new nJ(r))}}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(r,o)=>this._deltaDecorationsImpl(e,[],[{range:r,options:o}])[0],changeDecoration:(r,o)=>{this._changeDecorationImpl(e,r,o)},changeDecorationOptions:(r,o)=>{this._changeDecorationOptionsImpl(e,r,Dj(o))},removeDecoration:r=>{this._deltaDecorationsImpl(e,[r],[])},deltaDecorations:(r,o)=>r.length===0&&o.length===0?[]:this._deltaDecorationsImpl(e,r,o)};let n=null;try{n=t(i)}catch(r){It(r)}return i.addDecoration=r0,i.changeDecoration=r0,i.changeDecorationOptions=r0,i.removeDecoration=r0,i.deltaDecorations=r0,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),It(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:Ej[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const r=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),o,a,r),n.setOptions(Ej[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const r=t[i];this._decorationsTree.delete(r),delete this._decorations[r.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i,n)}getLinesDecorations(e,t,i=0,n=!1,r=!1,o=!1){const a=this.getLineCount(),l=Math.min(a,Math.max(1,e)),c=Math.min(a,Math.max(1,t)),u=this.getLineMaxColumn(c),d=new H(l,1,c,u),g=this._getDecorationsInRange(d,i,n,r,o);return jA(g,this._decorationProvider.getDecorationsInRange(d,i,n)),g}getDecorationsInRange(e,t=0,i=!1,n=!1,r=!1,o=!1){const a=this.validateRange(e),l=this._getDecorationsInRange(a,t,i,n,o);return jA(l,this._decorationProvider.getDecorationsInRange(a,t,i,r)),l}getOverviewRulerDecorations(e=0,t=!1,i=!1){return this._decorationsTree.getAll(this,e,t,i,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}getCustomLineHeightsDecorations(e=0){return this._decorationsTree.getAllCustomLineHeights(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return Za.fromDecorations(n).filter(r=>r.lineNumber===e)}getFontDecorationsInRange(e,t=0){const i=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),n=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getFontDecorationsInInterval(this,i,n,t)}getAllDecorations(e=0,t=!1,i=!1){let n=this._decorationsTree.getAll(this,e,t,i,!1,!1);return n=n.concat(this._decorationProvider.getAllDecorations(e,t)),n}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!1,!0)}_getDecorationsInRange(e,t,i,n,r){const o=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),a=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,o,a,t,i,n,r)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t,i){const n=this._decorations[t];if(!n)return;if(n.options.after){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(n.options.before){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}if(n.options.lineHeight!==null){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,l.startLineNumber,null)}if(n.options.affectsFont){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,n.id,l.startLineNumber)}const r=this._validateRangeRelaxedNoAllocations(i),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),o,a,r),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber),n.options.lineHeight!==null&&this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,r.startLineNumber,n.options.lineHeight),n.options.affectsFont&&this._onDidChangeDecorations.recordLineAffectedByFontChange(e,n.id,r.startLineNumber)}_changeDecorationOptionsImpl(e,t,i){const n=this._decorations[t];if(!n)return;const r=!!(n.options.overviewRuler&&n.options.overviewRuler.color),o=!!(i.overviewRuler&&i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(i),n.options.after||i.after){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(c.endLineNumber)}if(n.options.before||i.before){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(c.startLineNumber)}if(n.options.lineHeight!==null||i.lineHeight!==null){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,c.startLineNumber,i.lineHeight)}if(n.options.affectsFont||i.affectsFont){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,t,c.startLineNumber)}const a=r!==o,l=Ike(i)!==Kx(n);a||l?(this._decorationsTree.delete(n),n.setOptions(i),this._decorationsTree.insert(n)):n.setOptions(i)}_deltaDecorationsImpl(e,t,i,n=!1){const r=this.getVersionId(),o=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const u=new Array(l);for(;a<o||c<l;){let d=null;if(a<o){let g;do g=t[a++],d=this._decorations[g];while(!d&&a<o);if(d){if(d.options.after){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.endLineNumber)}if(d.options.before){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.startLineNumber)}if(d.options.lineHeight!==null){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,g,p.startLineNumber,null)}if(d.options.affectsFont){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,g,p.startLineNumber)}this._decorationsTree.delete(d),n||this._onDidChangeDecorations.checkAffectedAndFire(d.options)}}if(c<l){if(!d){const x=++this._lastDecorationId,S=`${this._instanceId};${x}`;d=new mJ(S,0,0),this._decorations[S]=d}const g=i[c],p=this._validateRangeRelaxedNoAllocations(g.range),_=Dj(g.options),C=this._buffer.getOffsetAt(p.startLineNumber,p.startColumn),v=this._buffer.getOffsetAt(p.endLineNumber,p.endColumn);d.ownerId=e,d.reset(r,C,v,p),d.setOptions(_),d.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.endLineNumber),d.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.startLineNumber),d.options.lineHeight!==null&&this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,d.id,p.startLineNumber,d.options.lineHeight),d.options.affectsFont&&this._onDidChangeDecorations.recordLineAffectedByFontChange(e,d.id,p.startLineNumber),n||this._onDidChangeDecorations.checkAffectedAndFire(_),this._decorationsTree.insert(d),u[c]=d.id,c++}else d&&delete this._decorations[d.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return Nke(this.getLineContent(e))+1}toString(){return`TextModel(${this.uri.toString()})`}},cf=Ba,Ba._MODEL_SYNC_LIMIT=50*1024*1024,Ba.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024,Ba.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3,Ba.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024,Ba.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Qn.tabSize,indentSize:Qn.indentSize,insertSpaces:Qn.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Qn.trimAutoWhitespace,largeFileOptimizations:Qn.largeFileOptimizations,bracketPairColorizationOptions:Qn.bracketPairColorizationOptions},Ba);H5=cf=Ske([ex(4,B6),ex(5,En),ex(6,rc),ex(7,wt)],H5);function Nke(s){let e=0;for(const t of s)if(t===" "||t==="	")e++;else break;return e}function NR(s){return!!(s.options.overviewRuler&&s.options.overviewRuler.color)}function Ike(s){return!!s.after||!!s.before}function Kx(s){return!!s.options.after||!!s.options.before}class kj{constructor(){this._decorationsTree0=new ER,this._decorationsTree1=new ER,this._injectedTextDecorationsTree=new ER}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,r,o,a){const l=e.getVersionId(),c=this._intervalSearch(t,i,n,r,o,l,a);return this._ensureNodesHaveRanges(e,c)}_intervalSearch(e,t,i,n,r,o,a){const l=this._decorationsTree0.intervalSearch(e,t,i,n,r,o,a),c=this._decorationsTree1.intervalSearch(e,t,i,n,r,o,a),u=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,r,o,a);return l.concat(c).concat(u)}getInjectedTextInInterval(e,t,i,n){const r=e.getVersionId(),o=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,!1,r,!1);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getFontDecorationsInInterval(e,t,i,n){const r=e.getVersionId(),o=this._decorationsTree0.intervalSearch(t,i,n,!1,!1,r,!1);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.affectsFont)}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAllCustomLineHeights(e,t){const i=e.getVersionId(),n=this._search(t,!1,!1,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(r=>typeof r.options.lineHeight=="number")}getAll(e,t,i,n,r,o){const a=e.getVersionId(),l=this._search(t,i,n,r,a,o);return this._ensureNodesHaveRanges(e,l)}_search(e,t,i,n,r,o){if(n)return this._decorationsTree1.search(e,t,i,r,o);{const a=this._decorationsTree0.search(e,t,i,r,o),l=this._decorationsTree1.search(e,t,i,r,o),c=this._injectedTextDecorationsTree.search(e,t,i,r,o);return a.concat(l).concat(c)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){Kx(e)?this._injectedTextDecorationsTree.insert(e):NR(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){Kx(e)?this._injectedTextDecorationsTree.delete(e):NR(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){Kx(e)?this._injectedTextDecorationsTree.resolveNode(e,t):NR(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function fl(s){return s.replace(/[^a-z0-9\-_]/gi," ")}class kJ{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class Rke extends kJ{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:ok.Center}getColor(e){return this._resolvedColor||(gm(e.type)&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class Ake{constructor(e){this.position=(e==null?void 0:e.position)??dd.Center,this.persistLane=e==null?void 0:e.persistLane}}class Mke extends kJ{constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(gm(e.type)&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?ae.fromHex(e):t.getColor(e.id)}}class $w{static from(e){return e instanceof $w?e:new $w(e)}constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class dn{static register(e){return new dn(e)}static createDynamic(e){return new dn(e)}constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?fl(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?fl(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.lineHeight=e.lineHeight?Math.min(e.lineHeight,Dke):null,this.fontSize=e.fontSize||null,this.affectsFont=!!e.fontSize||!!e.fontFamily||!!e.fontWeight||!!e.fontStyle,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new Rke(e.overviewRuler):null,this.minimap=e.minimap?new Mke(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new Ake(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?fl(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?fl(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?fl(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?Rme(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?fl(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?fl(e.marginClassName):null,this.inlineClassName=e.inlineClassName?fl(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?fl(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?fl(e.afterContentClassName):null,this.after=e.after?$w.from(e.after):null,this.before=e.before?$w.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1,this.textDirection=e.textDirection??null}}dn.EMPTY=dn.register({description:"empty"});const Ej=[dn.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),dn.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),dn.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),dn.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function Dj(s){return s instanceof dn?s:dn.createDynamic(s)}class Tj{static toKey(e){return`${e.ownerId};${e.decorationId};${e.lineNumber}`}constructor(e,t,i,n){this.ownerId=e,this.decorationId=t,this.lineNumber=i,this.lineHeight=n}}class Nj{static toKey(e){return`${e.ownerId};${e.decorationId};${e.lineNumber}`}constructor(e,t,i){this.ownerId=e,this.decorationId=t,this.lineNumber=i}}class Oke extends ne{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new $),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._affectedLineHeights=null,this._affectedFontLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e,t,i;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(e=this._affectedInjectedTextLines)==null||e.clear(),this._affectedInjectedTextLines=null,(t=this._affectedLineHeights)==null||t.clear(),this._affectedLineHeights=null,(i=this._affectedFontLines)==null||i.clear(),this._affectedFontLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}recordLineAffectedByLineHeightChange(e,t,i,n){this._affectedLineHeights||(this._affectedLineHeights=new xj([],Tj.toKey)),this._affectedLineHeights.add(new Tj(e,t,i,n))}recordLineAffectedByFontChange(e,t,i){this._affectedFontLines||(this._affectedFontLines=new xj([],Nj.toKey)),this._affectedFontLines.add(new Nj(e,t,i))}checkAffectedAndFire(e){var t,i;this._affectsMinimap||(this._affectsMinimap=!!((t=e.minimap)!=null&&t.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!((i=e.overviewRuler)!=null&&i.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!e.glyphMarginClassName),this._affectsLineNumber||(this._affectsLineNumber=!!e.lineNumberClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines,this._affectedLineHeights,this._affectedFontLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class Pke extends ne{constructor(){super(),this._fastEmitter=this._register(new $),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new $),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}class V6{static create(e){return new V6(e.get(151),e.get(150))}constructor(e,t){this.classifier=new Fke(e,t)}createLineBreaksComputer(e,t,i,n,r,o){const a=[],l=[],c=[];return{addRequest:(u,d,g)=>{a.push(u),l.push(d),c.push(g)},finalize:()=>{const u=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,d=[];for(let g=0,p=a.length;g<p;g++){const _=l[g],C=c[g],v=a[g],x=o&&v.includes('"')&&v.includes("\\n");C&&!C.injectionOptions&&!_&&!x?d[g]=Bke(this.classifier,C,v,t,i,u,n,r):d[g]=Vke(this.classifier,v,_,t,i,u,n,r,x)}return z5.length=0,U5.length=0,d}}}}class Fke extends Bv{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let z5=[],U5=[];function Bke(s,e,t,i,n,r,o,a){if(n===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",u=e.breakOffsets,d=e.breakOffsetsVisibleColumn,g=EJ(t,i,n,r,o),p=n-g,_=z5,C=U5;let v=0,x=0,S=0,k=n;const E=u.length;let T=0;if(T>=0){let R=Math.abs(d[T]-k);for(;T+1<E;){const N=Math.abs(d[T+1]-k);if(N>=R)break;R=N,T++}}for(;T<E;){let R=T<0?0:u[T],N=T<0?0:d[T];x>R&&(R=x,N=S);let A=0,O=0,W=0,j=0;if(N<=k){let q=N,Z=R===0?0:t.charCodeAt(R-1),K=R===0?0:s.get(Z),U=!0;for(let G=R;G<l;G++){const Q=G,le=t.charCodeAt(G);let ve,V;if(hn(le)?(G++,ve=0,V=2):(ve=s.get(le),V=sC(le,q,i,r)),Q>x&&j5(Z,K,le,ve,c)&&(A=Q,O=q),q+=V,q>k){Q>x?(W=Q,j=q-V):(W=G+1,j=q),q-O>p&&(A=0),U=!1;break}Z=le,K=ve}if(U){v>0&&(_[v]=u[u.length-1],C[v]=d[u.length-1],v++);break}}if(A===0){let q=N,Z=t.charCodeAt(R),K=s.get(Z),U=!1;for(let G=R-1;G>=x;G--){const Q=G+1,le=t.charCodeAt(G);if(le===9){U=!0;break}let ve,V;if(Pg(le)?(G--,ve=0,V=2):(ve=s.get(le),V=Mh(le)?r:1),q<=k){if(W===0&&(W=Q,j=q),q<=k-p)break;if(j5(le,ve,Z,K,c)){A=Q,O=q;break}}q-=V,Z=le,K=ve}if(A!==0){const G=p-(j-O);if(G<=i){const Q=t.charCodeAt(W);let le;hn(Q)?le=2:le=sC(Q,j,i,r),G-le<0&&(A=0)}}if(U){T--;continue}}if(A===0&&(A=W,O=j),A<=x){const q=t.charCodeAt(x);hn(q)?(A=x+2,O=S+2):(A=x+1,O=S+sC(q,S,i,r))}for(x=A,_[v]=A,S=O,C[v]=O,v++,k=O+p;T<0||T<E&&d[T]<O;)T++;let F=Math.abs(d[T]-k);for(;T+1<E;){const q=Math.abs(d[T+1]-k);if(q>=F)break;F=q,T++}}return v===0?null:(_.length=v,C.length=v,z5=e.breakOffsets,U5=e.breakOffsetsVisibleColumn,e.breakOffsets=_,e.breakOffsetsVisibleColumn=C,e.wrappedTextIndentLength=g,e)}function Vke(s,e,t,i,n,r,o,a,l){const c=Za.applyInjectedText(e,t);let u,d;if(t&&t.length>0?(u=t.map(W=>W.options),d=t.map(W=>W.column-1)):(u=null,d=null),n===-1)return u?new Z0(d,u,[c.length],[],0):null;const g=c.length;if(g<=1)return u?new Z0(d,u,[c.length],[],0):null;const p=a==="keepAll",_=EJ(c,i,n,r,o),C=n-_,v=[],x=[];let S=0,k=0,E=0,T=n,R=c.charCodeAt(0),N=s.get(R),A=sC(R,0,i,r),O=1;hn(R)&&(A+=1,R=c.charCodeAt(1),N=s.get(R),O++);for(let W=O;W<g;W++){const j=W,F=c.charCodeAt(W);let q,Z,K=!1;hn(F)?(W++,q=0,Z=2):(q=s.get(F),Z=sC(F,A,i,r)),l&&Wke(c,W)?(k=j,E=A,K=!0):j5(R,N,F,q,p)&&(k=j,E=A),A+=Z,(A>T||K)&&((k===0||A-E>C)&&(k=j,E=A-Z),v[S]=k,x[S]=E,S++,T=E+C,k=0),R=F,N=q}return S===0&&(!t||t.length===0)?null:(v[S]=g,x[S]=A,new Z0(d,u,v,x,_))}function sC(s,e,t,i){return s===9?t-e%t:Mh(s)||s<32?i:1}function Ij(s,e){return e-s%e}function Wke(s,e){if(e>=2&&s.charAt(e-1)==="n"){let t=0;for(let i=e-2;i>=0;i--)if(s.charAt(i)==="\\")t++;else return t%2===1}return!1}function j5(s,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function EJ(s,e,t,i,n){let r=0;if(n!==0){const o=Lr(s);if(o!==-1){for(let l=0;l<o;l++){const c=s.charCodeAt(l)===9?Ij(r,e):1;r+=c}const a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){const c=Ij(r,e);r+=c}r+i>t&&(r=0)}}return r}class Uk{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new In(new H(1,1,1,1),0,0,new Y(1,1),0),new In(new H(1,1,1,1),0,0,new Y(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new at(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?gt.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):gt.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),o=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,o),l=this._validatePositionWithCache(e,r,n,a);return i.equals(o)&&n.equals(a)&&r.equals(l)?t:new In(H.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,o,t.leftoverVisibleColumns+i.column-o.column)}_setState(e,t,i){if(i&&(i=Uk._validateViewState(e.viewModel,i)),t){const n=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,o=e.model.validatePosition(t.position),a=t.position.equals(o)?t.leftoverVisibleColumns:0;t=new In(n,t.selectionStartKind,r,o,a)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new In(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,r,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new In(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new Y(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new Y(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),o=new H(n.lineNumber,n.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new In(o,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class Rj{constructor(e){this.context=e,this.cursors=[new Uk(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return mbe(this.cursors,oo(e=>e.viewState.position,Y.compare)).viewState.position}getBottomMostViewPosition(){return gbe(this.cursors,oo(e=>e.viewState.position,Y.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(at.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const n=i-t;for(let r=0;r<n;r++)this._addSecondaryCursor()}else if(t>i){const n=t-i;for(let r=0;r<n;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Uk(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(oo(i=>i.selection,H.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1],o=n.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||o.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(o.getEndPosition()):l=a.getStartPosition().isBefore(o.getEndPosition()),l){const c=n.index<r.index?i:i+1,u=n.index<r.index?i+1:i,d=t[u].index,g=t[c].index,p=t[u].selection,_=t[c].selection;if(!p.equalsSelection(_)){const C=p.plusRange(_),v=p.selectionStartLineNumber===p.startLineNumber&&p.selectionStartColumn===p.startColumn,x=_.selectionStartLineNumber===_.startLineNumber&&_.selectionStartColumn===_.startColumn;let S;d===this.lastAddedCursorIndex?(S=v,this.lastAddedCursorIndex=g):S=x;let k;S?k=new gt(C.startLineNumber,C.startColumn,C.endLineNumber,C.endColumn):k=new gt(C.endLineNumber,C.endColumn,C.startLineNumber,C.startColumn),t[c].selection=k;const E=at.fromModelSelection(k);e[g].setState(this.context,E.modelState,E.viewState)}for(const C of t)C.index>d&&C.index--;e.splice(d,1),t.splice(u,1),this._removeSecondaryCursor(d-1),i--}}}}class Aj{constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class Hke{constructor(){this.type=0}}class zke{constructor(){this.type=1}}class Uke{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class jke{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class Xd{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class ix{constructor(){this.type=5}}class $ke{constructor(e){this.type=6,this.isFocused=e}}class qke{constructor(){this.type=7}}class nx{constructor(){this.type=8}}class DJ{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class $5{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class q5{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class rC{constructor(e,t,i,n,r,o,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=r,this.revealHorizontal=o,this.scrollType=a,this.type=12}}class Gke{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class Kke{constructor(e){this.theme=e,this.type=14}}class Yke{constructor(e){this.type=15,this.ranges=e}}class Qke{constructor(){this.type=16}}let Xke=class{constructor(){this.type=17}};class Zke extends ne{constructor(){super(),this._onEvent=this._register(new $),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new Jke),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class Jke{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class W6{constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new W6(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class MD{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new MD(this.oldHasFocus,e.hasFocus)}}class eEe{constructor(e,t){this.kind=2,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new MD(this.oldHasFocus,e.hasFocus)}}class H6{constructor(e,t,i,n,r,o,a,l){this.kind=3,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=r,this.scrollLeft=o,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new H6(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class tEe{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class iEe{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class jk{constructor(e,t,i,n,r,o,a){this.kind=7,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=r,this.reason=o,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,n=t.length;if(i!==n)return!1;for(let r=0;r<i;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return jk._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new jk(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class nEe{constructor(){this.kind=6}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class sEe{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class rEe{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class oEe{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class aEe{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class lEe{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class cEe{constructor(e){this.event=e,this.kind=13}isNoOp(){return!1}attemptToMerge(e){return null}}class hEe{constructor(e){this.event=e,this.kind=14}isNoOp(){return!1}attemptToMerge(e){return null}}class uEe{constructor(e){this.event=e,this.kind=15}isNoOp(){return!1}attemptToMerge(e){return null}}class dEe extends ne{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new Aj(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new Rj(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Zi(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new Aj(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let r=!1;const o=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>o&&(n=n.slice(0,o),r=!0);const a=oC.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,r,o){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=H.fromPositions(a[0],a[0]),e.emitViewEvent(new rC(t,i,l,c,n,r,o))}revealPrimary(e,t,i,n,r,o){const l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new rC(t,i,null,l,n,r,o))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const r=t[i];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];let a=1,l=1;o.position&&o.position.lineNumber&&(a=o.position.lineNumber),o.position&&o.position.column&&(l=o.position.column);let c=a,u=l;o.selectionStart&&o.selectionStart.lineNumber&&(c=o.selectionStart.lineNumber),o.selectionStart&&o.selectionStart.column&&(u=o.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:u,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,at.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof tJ){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new Rj(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const r=at.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{const r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,at.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,at.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const r=this._model.deltaDecorations([],i),o=this._model.deltaDecorations([],n);this._autoClosedActions.push(new Mj(this._model,r,o))}_executeEditOperation(e,t){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const i=fEe.executeCommands(this._model,this._cursors.getSelections(),e.commands,t);if(i){this._interpretCommandResult(i);const n=[],r=[];for(let o=0;o<e.commands.length;o++){const a=e.commands[o];a instanceof v6&&a.enclosingRange&&a.closeCharacterRange&&(n.push(a.closeCharacterRange),r.push(a.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,r),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,r){const o=oC.from(this._model,this);if(o.equals(n))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new jke(l,a,i)),!n||n.cursorState.length!==o.cursorState.length||o.cursorState.some((c,u)=>!c.modelState.equals(n.cursorState[u].modelState))){const c=n?n.cursorState.map(d=>d.modelState.selection):null,u=n?n.modelVersionId:0;e.emitOutgoingEvent(new jk(c,a,u,o.modelVersionId,t||"keyboard",i,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];if(!r.text||r.text.indexOf(`
`)>=0)return null;const o=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!o)return null;const a=o[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,u=r.text.length-o[2].length-1,d=r.text.lastIndexOf(c,u-1);if(d===-1)return null;t.push([d,u])}return t}executeEdits(e,t,i,n,r){let o=null;t==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);const a=[],l=[],c=this._model.pushEditOperations(this.getSelections(),i,u=>{if(o)for(let g=0,p=o.length;g<p;g++){const[_,C]=o[g],v=u[g],x=v.range.startLineNumber,S=v.range.startColumn-1+_,k=v.range.startColumn-1+C;a.push(new H(x,k+1,x,k+2)),l.push(new H(x,S+1,x,k+2))}const d=n(u);return d&&(this._isHandling=!0),d},void 0,r);c&&(this._isHandling=!1,this.setSelections(e,t,c,0)),a.length>0&&this._pushAutoClosedAction(a,l)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const r=oC.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(o){It(o)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,r,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return Mj.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new aC(this._model,this.getSelections())}endComposition(e,t){const i=Do.cursor({kind:"compositionEnd",detailedSource:t}),n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Sf.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()),i)},e,t)}type(e,t,i){const n=Do.cursor({kind:"type",detailedSource:i});this._executeEdit(()=>{if(i==="keyboard"){const r=t.length;let o=0;for(;o<r;){const a=y7(t,o),l=t.substr(o,a);this._executeEditOperation(Sf.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),l),n),o+=a}}else this._executeEditOperation(Sf.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t),n)},e,i)}compositionType(e,t,i,n,r,o){const a=Do.cursor({kind:"compositionType",detailedSource:o});if(t.length===0&&i===0&&n===0){if(r!==0){const l=this.getSelections().map(c=>{const u=c.getPosition();return new gt(u.lineNumber,u.column+r,u.lineNumber,u.column+r)});this.setSelections(e,o,l,0)}return}this._executeEdit(()=>{this._executeEditOperation(Sf.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,r),a)},e,o)}paste(e,t,i,n,r){const o=Do.cursor({kind:"paste",detailedSource:r});this._executeEdit(()=>{this._executeEditOperation(Sf.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]),o)},e,r,4)}cut(e,t){const i=Do.cursor({kind:"cut",detailedSource:t});this._executeEdit(()=>{this._executeEditOperation($g.cut(this.context.cursorConfig,this._model,this.getSelections()),i)},e,t)}executeCommand(e,t,i){const n=Do.cursor({kind:"executeCommand",detailedSource:i});this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new qs(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}),n)},e,i)}executeCommands(e,t,i){const n=Do.cursor({kind:"executeCommands",detailedSource:i});this._executeEdit(()=>{this._executeEditOperation(new qs(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}),n)},e,i)}}class oC{static from(e,t){return new oC(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class Mj{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(H.compareRangesUsingStarts),e.sort(H.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class fEe{static executeCommands(e,t,i,n=Do.unknown({name:"executeCommands"})){const r={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(r,i,n);for(let a=0,l=r.trackedRanges.length;a<l;a++)r.model._setTrackedRange(r.trackedRanges[a],null,0);return o}static _innerExecuteCommands(e,t,i){if(this._arrayIsEmpty(t))return null;const n=this._getEditOperations(e,t);if(n.operations.length===0)return null;const r=n.operations,o=this._getLoserCursorMap(r);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const a=[];for(let u=0,d=r.length;u<d;u++)o.hasOwnProperty(r[u].identifier.major.toString())||a.push(r[u]);n.hadTrackedEditOperation&&a.length>0&&(a[0]._isTracked=!0);let l=e.model.pushEditOperations(e.selectionsBefore,a,u=>{const d=[];for(let _=0;_<e.selectionsBefore.length;_++)d[_]=[];for(const _ of u)_.identifier&&d[_.identifier.major].push(_);const g=(_,C)=>_.identifier.minor-C.identifier.minor,p=[];for(let _=0;_<e.selectionsBefore.length;_++)d[_].length>0?(d[_].sort(g),p[_]=t[_].computeCursorState(e.model,{getInverseEditOperations:()=>d[_],getTrackedSelection:C=>{const v=parseInt(C,10),x=e.model._getTrackedRange(e.trackedRanges[v]);return e.trackedRangesDirection[v]===0?new gt(x.startLineNumber,x.startColumn,x.endLineNumber,x.endColumn):new gt(x.endLineNumber,x.endColumn,x.startLineNumber,x.startColumn)}})):p[_]=e.selectionsBefore[_];return p},void 0,i);l||(l=e.selectionsBefore);const c=[];for(const u in o)o.hasOwnProperty(u)&&c.push(parseInt(u,10));c.sort((u,d)=>d-u);for(const u of c)l.splice(u,1);return l}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(a){const l=this._getEditOperationsFromCommand(e,r,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let r=0;const o=(d,g,p=!1)=>{H.isEmpty(d)&&g===""||n.push({identifier:{major:t,minor:r++},range:d,text:g,forceMoveMarkers:p,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const u={addEditOperation:o,addTrackedEditOperation:(d,g,p)=>{a=!0,o(d,g,p)},trackSelection:(d,g)=>{const p=gt.liftSelection(d);let _;if(p.isEmpty())if(typeof g=="boolean")g?_=2:_=3;else{const x=e.model.getLineMaxColumn(p.startLineNumber);p.startColumn===x?_=2:_=3}else _=1;const C=e.trackedRanges.length,v=e.model._setTrackedRange(null,p,_);return e.trackedRanges[C]=v,e.trackedRangesDirection[C]=p.getDirection(),C.toString()}};try{i.getEditOperations(e.model,u)}catch(d){return It(d),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-H.compareRangesUsingEnds(i.range,n.range));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],r=e[i];if(H.getStartPosition(n.range).isBefore(H.getEndPosition(r.range))){let o;n.identifier.major>r.identifier.major?o=n.identifier.major:o=r.identifier.major,t[o.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===o&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class gEe{constructor(e,t,i,n){this.text=e,this.lineNumber=t,this.startSelectionOffset=i,this.endSelectionOffset=n}}class aC{static _capture(e,t){const i=[];for(const n of t){if(n.startLineNumber!==n.endLineNumber)return null;const r=n.startLineNumber;i.push(new gEe(e.getLineContent(r),r,n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=aC._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=aC._capture(e,t);if(!i||this._original.length!==i.length)return null;const n=[];for(let r=0,o=this._original.length;r<o;r++)n.push(aC._deduceOutcome(this._original[r],i[r]));return n}static _deduceOutcome(e,t){const i=Math.min(e.startSelectionOffset,t.startSelectionOffset,a1(e.text,t.text)),n=Math.min(e.text.length-e.endSelectionOffset,t.text.length-t.endSelectionOffset,l1(e.text,t.text)),r=e.text.substring(i,e.text.length-n),o=i,a=t.text.length-n,l=t.text.substring(o,a),c=new H(t.lineNumber,o+1,t.lineNumber,a+1);return new Zve(r,e.startSelectionOffset-i,e.endSelectionOffset-i,l,t.startSelectionOffset-i,t.endSelectionOffset-i,c)}}const Oj={getInitialState:()=>kw,tokenizeEncoded:(s,e,t)=>i6(0,t)};async function mEe(s,e,t){if(!t)return Pj(e,s.languageIdCodec,Oj);const i=await qi.getOrCreate(t);return Pj(e,s.languageIdCodec,i||Oj)}function pEe(s,e,t,i,n,r,o){let a="<div>",l=0,c=0,u=!0;for(let d=0,g=e.getCount();d<g;d++){const p=e.getEndOffset(d);let _="";for(;l<p&&l<n;l++){const C=s.charCodeAt(l),v=C===9;if(c+=Mh(C)?2:v?0:1,l<i){if(v){const x=c%r;c+=x===0?r:r-x}continue}switch(C){case 9:{const x=c%r,S=x===0?r:r-x;c+=S;let k=S;for(;k>0;)o&&u?(_+="&#160;",u=!1):(_+=" ",u=!0),k--;break}case 60:_+="&lt;",u=!1;break;case 62:_+="&gt;",u=!1;break;case 38:_+="&amp;",u=!1;break;case 0:_+="&#00;",u=!1;break;case 65279:case 8232:case 8233:case 133:_+="",u=!1;break;case 13:_+="&#8203",u=!1;break;case 32:o&&u?(_+="&#160;",u=!1):(_+=" ",u=!0);break;default:_+=String.fromCharCode(C),u=!1}}if(!(p<=i)&&(a+=`<span style="${e.getInlineStyle(d,t)}">${_}</span>`,p>n||l>=n||i>=n))break}return a+="</div>",a}function Pj(s,e,t){let i='<div class="monaco-tokenized-source">';const n=F1(s);let r=t.getInitialState();for(let o=0,a=n.length;o<a;o++){const l=n[o];o>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,r);gn.convertToEndOffset(c.tokens,l.length);const d=new gn(c.tokens,l,e).inflate();let g=0;for(let p=0,_=d.getCount();p<_;p++){const C=d.getClassName(p),v=d.getEndOffset(p);i+=`<span class="${C}">${ua(l.substring(g,v))}</span>`,g=v}r=c.endState}return i+="</div>",i}class _Ee{constructor(e,t,i,n,r){this.decorationId=e,this.index=t,this.lineNumber=i,this.specialHeight=n,this.prefixSum=r,this.maximumSpecialHeight=n,this.deleted=!1}}class Fj{constructor(e,t){if(this._decorationIDToCustomLine=new IR,this._orderedCustomLines=[],this._pendingSpecialLinesToInsert=[],this._invalidIndex=0,this._hasPending=!1,this._defaultLineHeight=e,t.length>0){for(const i of t)this.insertOrChangeCustomLineHeight(i.decorationId,i.startLineNumber,i.endLineNumber,i.lineHeight);this.commit()}}set defaultLineHeight(e){this._defaultLineHeight=e}get defaultLineHeight(){return this._defaultLineHeight}removeCustomLineHeight(e){const t=this._decorationIDToCustomLine.get(e);if(t){this._decorationIDToCustomLine.delete(e);for(const i of t)i.deleted=!0,this._invalidIndex=Math.min(this._invalidIndex,i.index);this._hasPending=!0}}insertOrChangeCustomLineHeight(e,t,i,n){this.removeCustomLineHeight(e);for(let r=t;r<=i;r++){const o=new _Ee(e,-1,r,n,0);this._pendingSpecialLinesToInsert.push(o)}this._hasPending=!0}heightForLineNumber(e){const t=this._binarySearchOverOrderedCustomLinesArray(e);return t>=0?this._orderedCustomLines[t].maximumSpecialHeight:this._defaultLineHeight}getAccumulatedLineHeightsIncludingLineNumber(e){const t=this._binarySearchOverOrderedCustomLinesArray(e);if(t>=0)return this._orderedCustomLines[t].prefixSum+this._orderedCustomLines[t].maximumSpecialHeight;if(t===-1)return this._defaultLineHeight*e;const i=-(t+1),n=this._orderedCustomLines[i-1];return n.prefixSum+n.maximumSpecialHeight+this._defaultLineHeight*(e-n.lineNumber)}onLinesDeleted(e,t){const i=t-e+1,n=this._orderedCustomLines.length,r=this._binarySearchOverOrderedCustomLinesArray(e);let o;if(r>=0){o=r;for(let d=r-1;d>=0&&this._orderedCustomLines[d].lineNumber===e;d--)o--}else o=r===-(n+1)&&r!==-1?n-1:-(r+1);const a=this._binarySearchOverOrderedCustomLinesArray(t);let l;if(a>=0){l=a;for(let d=a+1;d<n&&this._orderedCustomLines[d].lineNumber===t;d++)l++}else l=a===-(n+1)&&a!==-1?n-1:-(a+1);const c=l>o,u=l===o&&this._orderedCustomLines[o]&&this._orderedCustomLines[o].lineNumber>=e&&this._orderedCustomLines[o].lineNumber<=t;if(c||u){let d=0;for(let R=o;R<=l;R++)d=Math.max(d,this._orderedCustomLines[R].maximumSpecialHeight);let g=0;if(o>0){const R=this._orderedCustomLines[o-1];g=R.prefixSum+R.maximumSpecialHeight+this._defaultLineHeight*(e-R.lineNumber-1)}else g=e>0?(e-1)*this._defaultLineHeight:0;const p=this._orderedCustomLines[o],_=this._orderedCustomLines[l],C=this._orderedCustomLines[l+1],v=C&&C.lineNumber===t+1?C.maximumSpecialHeight:this._defaultLineHeight,x=_.prefixSum+_.maximumSpecialHeight-p.prefixSum+this._defaultLineHeight*(t-_.lineNumber)+this._defaultLineHeight*(p.lineNumber-e)+v-d,S=new Set,k=[],E=new IR;let T=0;for(let R=0;R<this._orderedCustomLines.length;R++){const N=this._orderedCustomLines[R];if(R<o)k.push(N),E.add(N.decorationId,N);else if(R>=o&&R<=l){const A=N.decorationId;S.has(A)?T++:(N.index-=T,N.lineNumber=e,N.prefixSum=g,N.maximumSpecialHeight=d,k.push(N),E.add(N.decorationId,N))}else R>l&&(N.index-=T,N.lineNumber-=i,N.prefixSum-=x,k.push(N),E.add(N.decorationId,N));S.add(N.decorationId)}this._orderedCustomLines=k,this._decorationIDToCustomLine=E}else{const d=i*this._defaultLineHeight;for(let g=l;g<this._orderedCustomLines.length;g++){const p=this._orderedCustomLines[g];p.lineNumber>t&&(p.lineNumber-=i,p.prefixSum-=d)}}}onLinesInserted(e,t){const i=t-e+1,n=this._binarySearchOverOrderedCustomLinesArray(e);let r;if(n>=0){r=n;for(let u=n-1;u>=0&&this._orderedCustomLines[u].lineNumber===e;u--)r--}else r=-(n+1);const o=[],a=new Set;for(let u=r;u<this._orderedCustomLines.length;u++)this._orderedCustomLines[u].lineNumber===e&&a.add(this._orderedCustomLines[u].decorationId);const l=new Set;for(let u=r-1;u>=0;u--)this._orderedCustomLines[u].lineNumber===e-1&&l.add(this._orderedCustomLines[u].decorationId);const c=LJ(l,a);for(let u=r;u<this._orderedCustomLines.length;u++)this._orderedCustomLines[u].lineNumber+=i,this._orderedCustomLines[u].prefixSum+=this._defaultLineHeight*i;if(c.size>0){for(const u of c){const d=this._decorationIDToCustomLine.get(u);if(d){const g=d.reduce((C,v)=>Math.min(C,v.lineNumber),e),p=d.reduce((C,v)=>Math.max(C,v.lineNumber),e),_=d.reduce((C,v)=>Math.max(C,v.specialHeight),0);o.push({decorationId:u,startLineNumber:g,endLineNumber:p,lineHeight:_})}}for(const u of o)this.insertOrChangeCustomLineHeight(u.decorationId,u.startLineNumber,u.endLineNumber,u.lineHeight);this.commit()}}commit(){if(!this._hasPending)return;for(const r of this._pendingSpecialLinesToInsert){const o=this._binarySearchOverOrderedCustomLinesArray(r.lineNumber),a=o>=0?o:-(o+1);this._orderedCustomLines.splice(a,0,r),this._invalidIndex=Math.min(this._invalidIndex,a)}this._pendingSpecialLinesToInsert=[];const e=new IR,t=[];for(let r=0;r<this._invalidIndex;r++){const o=this._orderedCustomLines[r];t.push(o),e.add(o.decorationId,o)}let i=0,n=this._invalidIndex>0?t[this._invalidIndex-1]:void 0;for(let r=this._invalidIndex;r<this._orderedCustomLines.length;r++){const o=this._orderedCustomLines[r];if(o.deleted){i++;continue}if(o.index=r-i,n&&n.lineNumber===o.lineNumber)o.maximumSpecialHeight=n.maximumSpecialHeight,o.prefixSum=n.prefixSum;else{let a=o.specialHeight;for(let c=r;c<this._orderedCustomLines.length;c++){const u=this._orderedCustomLines[c];if(!u.deleted){if(u.lineNumber!==o.lineNumber)break;a=Math.max(a,u.specialHeight)}}o.maximumSpecialHeight=a;let l;n?l=n.prefixSum+n.maximumSpecialHeight+this._defaultLineHeight*(o.lineNumber-n.lineNumber-1):l=this._defaultLineHeight*(o.lineNumber-1),o.prefixSum=l}n=o,t.push(o),e.add(o.decorationId,o)}this._orderedCustomLines=t,this._decorationIDToCustomLine=e,this._invalidIndex=1/0,this._hasPending=!1}_binarySearchOverOrderedCustomLinesArray(e){return QY(this._orderedCustomLines.length,t=>{const i=this._orderedCustomLines[t];return i.lineNumber===e?0:i.lineNumber<e?-1:1})}}class IR{constructor(){this._map=new Map}add(e,t){const i=this._map.get(e);i?i.push(t):this._map.set(e,[t])}get(e){return this._map.get(e)}delete(e){this._map.delete(e)}}class bEe{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class CEe{constructor(e,t,i,n,r){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=r,this.prefixSum=0}}var id;let wEe=(id=class{constructor(e,t,i,n,r){this._instanceId=AQ(++id.INSTANCE_COUNT),this._pendingChanges=new bEe,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._paddingTop=i,this._paddingBottom=n,this._lineHeightsManager=new Fj(t,r)}static findInsertionIndex(e,t,i){let n=0,r=e.length;for(;n<r;){const o=n+r>>>1;t===e[o].afterLineNumber?i<e[o].ordinal?r=o:n=o+1:t<e[o].afterLineNumber?r=o:n=o+1}return n}setDefaultLineHeight(e){this._lineHeightsManager.defaultLineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e,t){this._lineCount=e,this._lineHeightsManager=new Fj(this._lineHeightsManager.defaultLineHeight,t)}changeLineHeights(e){let t=!1;try{e({insertOrChangeCustomLineHeight:(n,r,o,a)=>{t=!0,this._lineHeightsManager.insertOrChangeCustomLineHeight(n,r,o,a)},removeCustomLineHeight:n=>{t=!0,this._lineHeightsManager.removeCustomLineHeight(n)}})}finally{this._lineHeightsManager.commit()}return t}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,r,o,a)=>{t=!0,n=n|0,r=r|0,o=o|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new CEe(l,n,r,o,a)),l},changeOneWhitespace:(n,r,o)=>{t=!0,r=r|0,o=o|0,this._pendingChanges.change({id:n,newAfterLineNumber:r,newHeight:o})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const n=new Set;for(const l of i)n.add(l.id);const r=new Map;for(const l of t)r.set(l.id,l);const o=l=>{const c=[];for(const u of l)if(!n.has(u.id)){if(r.has(u.id)){const d=r.get(u.id);u.afterLineNumber=d.newAfterLineNumber,u.height=d.newHeight}c.push(u)}return c},a=o(this._arr).concat(o(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_insertWhitespace(e){const t=id.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const r=this._arr[n];this._removeWhitespace(n),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const r=this._arr[i].afterLineNumber;e<=r&&r<=t?this._arr[i].afterLineNumber=e-1:r>t&&(this._arr[i].afterLineNumber-=t-e+1)}this._lineHeightsManager.onLinesDeleted(e,t)}onLinesInserted(e,t){e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const r=this._arr[i].afterLineNumber;e<=r&&(this._arr[i].afterLineNumber+=t-e+1)}this._lineHeightsManager.onLinesInserted(e,t)}getWhitespacesTotalHeight(){return this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){const e=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(this._lineCount),t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const o=(n-i|0)/2|0,a=i+o|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){e=e|0;let i;e>1?i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(e-1):i=0;const n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getLineHeightForLineNumber(e){return this._lineHeightsManager.heightForLineNumber(e)}getVerticalOffsetAfterLineNumber(e,t=!1){e=e|0;const i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(e),n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}getWhitespaceMinWidth(){if(this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:e<this._paddingTop}isInBottomPadding(e){if(this._paddingBottom===0)return!1;const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(e=e|0,e<0)return 1;const t=this._lineCount|0;let i=1,n=t;for(;i<n;){const r=(i+n)/2|0,o=this.getLineHeightForLineNumber(r),a=this.getVerticalOffsetForLineNumber(r)|0;if(e>=a+o)i=r+1;else{if(e>=a)return r;n=r}}return i>t?t:i}getLinesViewportData(e,t){e=e|0,t=t|0;const i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,n=this.getVerticalOffsetForLineNumber(i)|0;let r=this._lineCount|0,o=this.getFirstWhitespaceIndexAfterLineNumber(i)|0;const a=this.getWhitespacesCount()|0;let l,c;o===-1?(o=a,c=r+1,l=0):(c=this.getAfterLineNumberForWhitespaceIndex(o)|0,l=this.getHeightForWhitespaceIndex(o)|0);let u=n,d=u;const g=5e5;let p=0;n>=g&&(p=Math.floor(n/g)*g,p=Math.floor(p/this._lineHeightsManager.defaultLineHeight)*this._lineHeightsManager.defaultLineHeight,d-=p);const _=[],C=e+(t-e)/2;let v=-1;for(let E=i;E<=r;E++){const T=this.getLineHeightForLineNumber(E);if(v===-1){const R=u,N=u+T;(R<=C&&C<N||R>C)&&(v=E)}for(u+=T,_[E-i]=d,d+=T;c===E;)d+=l,u+=l,o++,o>=a?c=r+1:(c=this.getAfterLineNumberForWhitespaceIndex(o)|0,l=this.getHeightForWhitespaceIndex(o)|0);if(u>=t){r=E;break}}v===-1&&(v=r);const x=this.getVerticalOffsetForLineNumber(r)|0;let S=i,k=r;if(S<k&&n<e&&S++,S<k){const E=this.getLineHeightForLineNumber(r);x+E>t&&k--}return{bigNumbersDelta:p,startLineNumber:i,endLineNumber:r,relativeVerticalOffset:_,centeredLineNumber:v,completelyVisibleStartLineNumber:S,completelyVisibleEndLineNumber:k,lineHeight:this._lineHeightsManager.defaultLineHeight}}getVerticalOffsetForWhitespaceIndex(e){e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(t):i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const n=this.getVerticalOffsetForWhitespaceIndex(i),r=this.getHeightForWhitespaceIndex(i);if(e>=n+r)return-1;for(;t<i;){const o=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(e>=a+l)t=o+1;else{if(e>=a)return o;i=o}}return t}getWhitespaceAtVerticalOffset(e){e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),o=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:o,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const r=[];for(let o=i;o<=n;o++){const a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(o),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(o),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._arr.slice(0)}getWhitespacesCount(){return this._arr.length}getIdForWhitespaceIndex(e){return e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return e=e|0,this._arr[e].height}},id.INSTANCE_COUNT=0,id);const vEe=125;class L0{constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class yEe extends ne{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new $),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new L0(0,0,0,0),this._scrollable=this._register(new U1({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new W6(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class SEe extends ne{constructor(e,t,i,n){super(),this._configuration=e;const r=this._configuration.options,o=r.get(165),a=r.get(96);this._linesLayout=new wEe(t,r.get(75),a.top,a.bottom,i),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new yEe(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new L0(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(130)?vEe:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(75)&&this._linesLayout.setDefaultLineHeight(t.get(75)),e.hasChanged(96)){const i=t.get(96);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(165)){const i=t.get(165),n=i.contentWidth,r=i.height,o=this._scrollable.getScrollDimensions(),a=o.contentWidth;this._scrollable.setScrollDimensions(new L0(n,o.contentWidth,r,this._getContentHeight(n,r,a)))}else this._updateHeight();e.hasChanged(130)&&this._configureSmoothScrollDuration()}onFlushed(e,t){this._linesLayout.onFlushed(e,t)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(117);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let r=this._linesLayout.getLinesTotalHeight();return n.get(119)?r+=Math.max(0,t-n.get(75)-n.get(96).bottom):n.get(117).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,i)),r}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new L0(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new sU(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new sU(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(166),n=e.get(59),r=e.get(165);if(i.isViewportWrapping){const o=e.get(81);return t>r.contentWidth+n.typicalHalfwidthCharacterWidth&&o.enabled&&o.side==="right"?t+r.verticalScrollbarWidth:t}else{const o=e.get(118)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+o+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new L0(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}changeSpecialLineHeights(e){const t=this._linesLayout.changeLineHeights(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}getLineHeightForLineNumber(e){return this._linesLayout.getLineHeightForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class lC{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class xEe{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new lC(new H(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class LEe{constructor(e,t,i,n,r){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,r=e.options;let o;if(r.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new Y(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new Y(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);o=new H(a.lineNumber,a.column,l.lineNumber,l.column)}else o=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new qZ(o,r),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getDecorationsOnLine(e,t=!1,i=!1){const n=new H(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i)}_getDecorationsInRange(e,t,i){const n=this._linesCollection.getDecorationsInRange(e,this.editorId,jL(this.configuration.options),$L(this.configuration.options),t,i),r=e.startLineNumber,o=e.endLineNumber,a=[];let l=0;const c=[];for(let d=r;d<=o;d++)c[d-r]=[];let u=!1;for(let d=0,g=n.length;d<g;d++){const p=n[d],_=p.options;if(!gSe(this.model,p))continue;const C=this._getOrCreateViewModelDecoration(p),v=C.range;if(a[l++]=C,_.inlineClassName){const x=new lC(v,_.inlineClassName,_.inlineClassNameAffectsLetterSpacing?3:0),S=Math.max(r,v.startLineNumber),k=Math.min(o,v.endLineNumber);for(let E=S;E<=k;E++)c[E-r].push(x)}if(_.beforeContentClassName&&r<=v.startLineNumber&&v.startLineNumber<=o){const x=new lC(new H(v.startLineNumber,v.startColumn,v.startLineNumber,v.startColumn),_.beforeContentClassName,1);c[v.startLineNumber-r].push(x)}if(_.afterContentClassName&&r<=v.endLineNumber&&v.endLineNumber<=o){const x=new lC(new H(v.endLineNumber,v.endColumn,v.endLineNumber,v.endColumn),_.afterContentClassName,2);c[v.endLineNumber-r].push(x)}_.affectsFont&&(u=!0)}return{decorations:a,inlineDecorations:c,hasVariableFonts:u}}}function RR(s,e){return s===null?e?$k.INSTANCE:qk.INSTANCE:new kEe(s,e)}class kEe{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,r=this._projectionData.breakOffsets[i];let o;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,u)=>new Za(0,0,c+1,this._projectionData.injectionOptions[u],0));o=Za.applyInjectedText(e.getLineContent(t),a).substring(n,r)}else o=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:r+1});return i>0&&(o=Bj(this._projectionData.wrappedTextIndentLength)+o),o}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,r,o,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,u=l.injectionOptions;let d=null;if(c){d=[];let p=0,_=0;for(let C=0;C<l.getOutputLineCount();C++){const v=new Array;d[C]=v;const x=C>0?l.breakOffsets[C-1]:0,S=l.breakOffsets[C];for(;_<c.length;){const k=u[_].content.length,E=c[_]+p,T=E+k;if(E>S)break;if(x<T){const R=u[_];if(R.inlineClassName){const N=C>0?l.wrappedTextIndentLength:0,A=N+Math.max(E-x,0),O=N+Math.min(T-x,S-x);A!==O&&v.push(new xEe(A,O,R.inlineClassName,R.inlineClassNameAffectsLetterSpacing))}}if(T<=S)p+=k,_++;else break}}}let g;if(c){const p=[];for(let _=0;_<c.length;_++){const C=c[_],v=u[_].tokens;v?v.forEach((x,S)=>{p.push({offset:C,text:x.substring(u[_].content),tokenMetadata:S.metadata})}):p.push({offset:C,text:u[_].content,tokenMetadata:gn.defaultTokenMetadata})}g=e.tokenization.getLineTokens(t).withInserted(p)}else g=e.tokenization.getLineTokens(t);for(let p=i;p<i+n;p++){const _=r+p-i;if(!o[_]){a[_]=null;continue}a[_]=this._getViewLineData(g,d?d[p]:null,p)}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,r=i>0?n.wrappedTextIndentLength:0,o=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(o,a,r);let c=l.getLineContent();i>0&&(c=Bj(n.wrappedTextIndentLength)+c);const u=this._projectionData.getMinOutputOffset(i)+1,d=c.length+1,g=i+1<this.getViewLineCount(),p=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new s6(c,g,u,d,p,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}const s2=class s2{constructor(){}isVisible(){return!0}setVisible(e){return e?this:qk.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.tokenization.getLineTokens(t),r=n.getLineContent();return new s6(r,!1,1,r.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,r,o,a){if(!o[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new Y(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}};s2.INSTANCE=new s2;let $k=s2;const r2=class r2{constructor(){}isVisible(){return!1}setVisible(e){return e?$k.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,r,o,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}};r2.INSTANCE=new r2;let qk=r2;const AR=[""];function Bj(s){if(s>=AR.length)for(let e=1;e<=s;e++)AR[e]=EEe(e);return AR[s]}function EEe(s){return new Array(s+1).join(" ")}class DEe{constructor(e){this._model=e}_validPosition(e){return this._model.validatePosition(e)}_validRange(e){return this._model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}class TEe{constructor(e,t,i,n,r,o,a,l,c,u,d){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=r,this.tabSize=o,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=u,this.wrapOnEscapedLineFeeds=d,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new IEe(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),r=i.length,o=this.createLineBreaksComputer(),a=new Rh(Za.fromDecorations(n));for(let C=0;C<r;C++){const v=a.takeWhile(x=>x.lineNumber===C+1);o.addRequest(i[C],v,t?t[C]:null)}const l=o.finalize(),c=[],u=this.hiddenAreasDecorationIds.map(C=>this.model.getDecorationRange(C)).sort(H.compareRangesUsingStarts);let d=1,g=0,p=-1,_=p+1<u.length?g+1:r+2;for(let C=0;C<r;C++){const v=C+1;v===_&&(p++,d=u[p].startLineNumber,g=u[p].endLineNumber,_=p+1<u.length?g+1:r+2);const x=v>=d&&v<=g,S=RR(l[C],!x);c[C]=S.getViewLineCount(),this.modelLineProjections[C]=S}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new e0e(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(g=>this.model.validateRange(g)),i=NEe(t),n=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(H.compareRangesUsingStarts);if(i.length===n.length){let g=!1;for(let p=0;p<i.length;p++)if(!i[p].equalsRange(n[p])){g=!0;break}if(!g)return!1}const r=i.map(g=>({range:g,options:dn.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);const o=i;let a=1,l=0,c=-1,u=c+1<o.length?l+1:this.modelLineProjections.length+2,d=!1;for(let g=0;g<this.modelLineProjections.length;g++){const p=g+1;p===u&&(c++,a=o[c].startLineNumber,l=o[c].endLineNumber,u=c+1<o.length?l+1:this.modelLineProjections.length+2);let _=!1;if(p>=a&&p<=l?this.modelLineProjections[g].isVisible()&&(this.modelLineProjections[g]=this.modelLineProjections[g].setVisible(!1),_=!0):(d=!0,this.modelLineProjections[g].isVisible()||(this.modelLineProjections[g]=this.modelLineProjections[g].setVisible(!0),_=!0)),_){const C=this.modelLineProjections[g].getViewLineCount();this.projectedModelLineLineCounts.setValue(g,C)}}return d||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,r){const o=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===n,u=this.wordBreak===r;if(o&&a&&l&&c&&u)return!1;const d=o&&a&&!l&&c&&u;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=r;let g=null;if(d){g=[];for(let p=0,_=this.modelLineProjections.length;p<_;p++)g[p]=this.modelLineProjections[p].getProjectionData()}return this._constructLines(!1,g),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak,this.wrapOnEscapedLineFeeds)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new $5(n,r)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const r=t>2&&!this.modelLineProjections[t-2].isVisible(),o=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let u=0,d=n.length;u<d;u++){const g=RR(n[u],!r);l.push(g);const p=g.getViewLineCount();a+=p,c[u]=p}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new q5(o,o+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,r=this.modelLineProjections[n].getViewLineCount(),o=this.modelLineProjections[n].isVisible(),a=RR(i,o);this.modelLineProjections[n]=a;const l=this.modelLineProjections[n].getViewLineCount();let c=!1,u=0,d=-1,g=0,p=-1,_=0,C=-1;r>l?(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=u+l-1,_=d+1,C=_+(r-l)-1,c=!0):r<l?(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=u+r-1,g=d+1,p=g+(l-r)-1,c=!0):(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=u+l-1),this.projectedModelLineLineCounts.setValue(n,l);const v=u<=d?new DJ(u,d-u+1):null,x=g<=p?new q5(g,p):null,S=_<=C?new $5(_,C):null;return[c,v,x,S]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,r.lineNumber,o.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new Vj(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new Y(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new Y(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),r=new Array;let o=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const u=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,d=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let g=u;g<d;g++)a.push(new Vj(l,g))}if(!c.isVisible()&&o){const u=new Y(l-1,this.model.getLineMaxColumn(l-1)+1),d=H.fromPositions(o,u);r.push(new Wj(d,a)),a=[],o=null}else c.isVisible()&&!o&&(o=new Y(l,1))}if(o){const l=H.fromPositions(o,this.getModelEndPositionOfViewLine(n));r.push(new Wj(l,a))}return r}getViewLinesBracketGuides(e,t,i,n){const r=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,o=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,n);for(const u of a.viewLines){const g=c[u.modelLineNumber-l].map(p=>{if(p.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,p.forWrappedLinesAfterColumn).lineNumber>=u.modelLineWrappedLineIdx||p.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,p.forWrappedLinesBeforeOrAtColumn).lineNumber<u.modelLineWrappedLineIdx)return;if(!p.horizontalLine)return p;let _=-1;if(p.column!==-1){const x=this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,p.column);if(x.lineNumber===u.modelLineWrappedLineIdx)_=x.column;else if(x.lineNumber<u.modelLineWrappedLineIdx)_=this.getMinColumnOfViewLine(u);else if(x.lineNumber>u.modelLineWrappedLineIdx)return}const C=this.convertModelPositionToViewPosition(u.modelLineNumber,p.horizontalLine.endColumn),v=this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,p.horizontalLine.endColumn);return v.lineNumber===u.modelLineWrappedLineIdx?new Gf(p.visibleColumn,_,p.className,new G0(p.horizontalLine.top,C.column),-1,-1):v.lineNumber<u.modelLineWrappedLineIdx||p.visibleColumn!==-1?void 0:new Gf(p.visibleColumn,_,p.className,new G0(p.horizontalLine.top,this.getMaxColumnOfViewLine(u)),-1,-1)});o.push(g.filter(p=>!!p))}}return o}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let r=[];const o=[],a=[],l=i.lineNumber-1,c=n.lineNumber-1;let u=null;for(let _=l;_<=c;_++){const C=this.modelLineProjections[_];if(C.isVisible()){const v=C.getViewLineNumberOfModelPosition(0,_===l?i.column:1),x=C.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(_+1)),S=x-v+1;let k=0;S>1&&C.getViewLineMinColumn(this.model,_+1,x)===1&&(k=v===0?1:2),o.push(S),a.push(k),u===null&&(u=new Y(_+1,0))}else u!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(u.lineNumber,_)),u=null)}u!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(u.lineNumber,n.lineNumber)),u=null);const d=t-e+1,g=new Array(d);let p=0;for(let _=0,C=r.length;_<C;_++){let v=r[_];const x=Math.min(d-p,o[_]),S=a[_];let k;S===2?k=0:S===1?k=1:k=x;for(let E=0;E<x;E++)E===k&&(v=0),g[p++]=v}return g}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let r=e;const o=n.index,a=n.remainder,l=[];for(let c=o,u=this.model.getLineCount();c<u;c++){const d=this.modelLineProjections[c];if(!d.isVisible())continue;const g=c===o?a:0;let p=d.getViewLineCount()-g,_=!1;if(r+p>t&&(_=!0,p=t-r+1),d.getViewLinesData(this.model,c+1,g,p,r-e,i,l),r+=p,_)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),r=n.index,o=n.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,o),c=a.getViewLineMaxColumn(this.model,r+1,o);t<l&&(t=l),t>c&&(t=c);const u=a.getModelColumnOfViewPosition(o,t);return this.model.validatePosition(new Y(r+1,u)).equals(i)?new Y(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new H(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new Y(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new H(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,r=!1){const o=this.model.validatePosition(new Y(e,t)),a=o.lineNumber,l=o.column;let c=a-1,u=!1;if(r)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,u=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,u=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new Y(n?0:1,1);const d=1+this.projectedModelLineLineCounts.getPrefixSum(c);let g;return u?r?g=this.modelLineProjections[c].getViewPositionOfModelPosition(d,1,i):g=this.modelLineProjections[c].getViewPositionOfModelPosition(d,this.model.getLineMaxColumn(c+1),i):g=this.modelLineProjections[a-1].getViewPositionOfModelPosition(d,l,i),g}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return H.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new H(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const r=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(r,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,r,o){const a=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),l=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(l.lineNumber-a.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new H(a.lineNumber,1,l.lineNumber,l.column),t,i,n,r,o);let c=[];const u=a.lineNumber-1,d=l.lineNumber-1;let g=null;for(let v=u;v<=d;v++)if(this.modelLineProjections[v].isVisible())g===null&&(g=new Y(v+1,v===u?a.column:1));else if(g!==null){const S=this.model.getLineMaxColumn(v);c=c.concat(this.model.getDecorationsInRange(new H(g.lineNumber,g.column,v,S),t,i,n,r)),g=null}g!==null&&(c=c.concat(this.model.getDecorationsInRange(new H(g.lineNumber,g.column,l.lineNumber,l.column),t,i,n,r)),g=null),c.sort((v,x)=>{const S=H.compareRangesUsingStarts(v.range,x.range);return S===0?v.id<x.id?-1:v.id>x.id?1:0:S});const p=[];let _=0,C=null;for(const v of c){const x=v.id;C!==x&&(C=x,p[_++]=v)}return p}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function NEe(s){if(s.length===0)return[];const e=s.slice();e.sort(H.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,n=e[0].endLineNumber;for(let r=1,o=e.length;r<o;r++){const a=e[r];a.startLineNumber>n+1?(t.push(new H(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new H(i,1,n,1)),t}class Vj{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class Wj{constructor(e,t){this.modelRange=e,this.viewLines=t}}class IEe{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class REe{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new DEe(this.model)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new $5(t,i)}onModelLinesInserted(e,t,i,n){return new q5(t,i)}onModelLineChanged(e,t,i){return[!1,new DJ(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let r=0;r<i;r++)n[r]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new s6(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const r=[];for(let o=e;o<=t;o++){const a=o-e;r[a]=i[a]?this.getViewLineData(o):null}return r}getDecorationsInRange(e,t,i,n,r,o){return this.model.getDecorationsInRange(e,t,i,n,r,o)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}const Zd=dd.Right;class AEe{constructor(e){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((e+1)*Zd/8))}reset(e){const t=Math.ceil((e+1)*Zd/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const r=Zd*n+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){const t=[];let i=Zd*e;for(let n=0;n<Zd;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[dd.Center]}countAtLine(e){let t=Zd*e,i=0;for(let n=0;n<Zd;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}}let MEe=class extends ne{constructor(e,t,i,n,r,o,a,l,c,u){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this._transactionalTarget=u,this.hiddenAreasModel=new PEe,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new Zke,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Cp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new os(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=z6.create(this.model),this.glyphLanes=new AEe(0),this.model.isTooLargeForTokenization())this._lines=new REe(this.model);else{const d=this._configuration.options,g=d.get(59),p=d.get(156),_=d.get(166),C=d.get(155),v=d.get(146),x=d.get(160);this._lines=new TEe(this._editorId,this.model,n,r,g,this.model.getOptions().tabSize,p,_.wrappingColumn,C,v,x)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new dEe(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new SEe(this._configuration,this.getLineCount(),this._getCustomLineHeights(),o)),this._register(this.viewLayout.onDidScroll(d=>{d.scrollTopChanged&&this._handleVisibleLinesChanged(),d.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new Gke(d)),this._eventDispatcher.emitOutgoingEvent(new H6(d.oldScrollWidth,d.oldScrollLeft,d.oldScrollHeight,d.oldScrollTop,d.scrollWidth,d.scrollLeft,d.scrollHeight,d.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(d=>{this._eventDispatcher.emitOutgoingEvent(d)})),this._decorations=new LEe(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(d=>{try{const g=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(g,d)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Rk.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new Qke)})),this._register(this._themeService.onDidColorThemeChange(d=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new Kke(d))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_getCustomLineHeights(){return this._configuration.options.get(5)?this.model.getCustomLineHeightsDecorations(this._editorId).map(i=>{const n=i.range.startLineNumber,r=this.coordinatesConverter.convertModelRangeToViewRange(new H(n,1,n,this.model.getLineMaxColumn(n)));return{decorationId:i.id,startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,lineHeight:i.options.lineHeight||0}}):[]}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new H(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new $ke(e)),this._eventDispatcher.emitOutgoingEvent(new MD(!e,e))}setHasWidgetFocus(e){this._eventDispatcher.emitOutgoingEvent(new eEe(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new Hke)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new zke)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new Y(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new zj(t,this._viewportStart.startLineDelta)}return new zj(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),n=this._configuration.options,r=n.get(59),o=n.get(156),a=n.get(166),l=n.get(155),c=n.get(146);this._lines.setWrappingSettings(r,o,a.wrappingColumn,l,c)&&(e.emitViewEvent(new ix),e.emitViewEvent(new nx),e.emitViewEvent(new Xd(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(104)&&(this._decorations.reset(),e.emitViewEvent(new Xd(null))),t.hasChanged(112)&&(this._decorations.reset(),e.emitViewEvent(new Xd(null))),e.emitViewEvent(new Uke(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Cp.shouldRecreate(t)&&(this.cursorConfig=new Cp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(i=>{try{const r=this._eventDispatcher.beginEmitViewEvents();let o=!1,a=!1;const l=i instanceof cg?i.rawContentChangedEvent.changes:i.changes,c=i instanceof cg?i.rawContentChangedEvent.versionId:null,u=this._lines.createLineBreaksComputer();for(const p of l)switch(p.changeType){case 4:{for(let _=0;_<p.detail.length;_++){const C=p.detail[_];let v=p.injectedTexts[_];v&&(v=v.filter(x=>!x.ownerId||x.ownerId===this._editorId)),u.addRequest(C,v,null)}break}case 2:{let _=null;p.injectedText&&(_=p.injectedText.filter(C=>!C.ownerId||C.ownerId===this._editorId)),u.addRequest(p.detail,_,null);break}}const d=u.finalize(),g=new Rh(d);for(const p of l)switch(p.changeType){case 1:{this._lines.onModelFlushed(),r.emitViewEvent(new ix),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),o=!0;break}case 3:{const _=this._lines.onModelLinesDeleted(c,p.fromLineNumber,p.toLineNumber);_!==null&&(r.emitViewEvent(_),this.viewLayout.onLinesDeleted(_.fromLineNumber,_.toLineNumber)),o=!0;break}case 4:{const _=g.takeCount(p.detail.length),C=this._lines.onModelLinesInserted(c,p.fromLineNumber,p.toLineNumber,_);C!==null&&(r.emitViewEvent(C),this.viewLayout.onLinesInserted(C.fromLineNumber,C.toLineNumber)),o=!0;break}case 2:{const _=g.dequeue(),[C,v,x,S]=this._lines.onModelLineChanged(c,p.lineNumber,_);a=C,v&&r.emitViewEvent(v),x&&(r.emitViewEvent(x),this.viewLayout.onLinesInserted(x.fromLineNumber,x.toLineNumber)),S&&(r.emitViewEvent(S),this.viewLayout.onLinesDeleted(S.fromLineNumber,S.toLineNumber));break}case 5:break}c!==null&&this._lines.acceptVersionId(c),this.viewLayout.onHeightMaybeChanged(),!o&&a&&(r.emitViewEvent(new nx),r.emitViewEvent(new Xd(null)),this._cursor.onLineMappingChanged(r),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){const r=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(r){const o=this.coordinatesConverter.convertModelPositionToViewPosition(r.getStartPosition()),a=this.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber);this.viewLayout.setScrollPosition({scrollTop:a+this._viewportStart.startLineDelta},1)}}try{const r=this._eventDispatcher.beginEmitViewEvents();i instanceof cg&&r.emitOutgoingEvent(new aEe(i.contentChangedEvent)),this._cursor.onModelContentChanged(r,i)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._configuration.options.get(5)&&this._register(this.model.onDidChangeLineHeight(i=>{const n=i.changes.filter(r=>r.ownerId===this._editorId||r.ownerId===0);if(this.viewLayout.changeSpecialLineHeights(r=>{for(const o of n){const{decorationId:a,lineNumber:l,lineHeight:c}=o,u=this.coordinatesConverter.convertModelRangeToViewRange(new H(l,1,l,this.model.getLineMaxColumn(l)));c!==null?r.insertOrChangeCustomLineHeight(a,u.startLineNumber,u.endLineNumber,c):r.removeCustomLineHeight(a)}}),n.length>0){const r=new iJ(n);this._eventDispatcher.emitOutgoingEvent(new hEe(r))}})),this._configuration.options.get(172)&&this._register(this.model.onDidChangeFont(i=>{const n=i.changes.filter(r=>r.ownerId===this._editorId||r.ownerId===0);if(n.length>0){const r=new nJ(n);this._eventDispatcher.emitOutgoingEvent(new uEe(r))}})),this._register(this.model.onDidChangeTokens(i=>{const n=[];for(let r=0,o=i.ranges.length;r<o;r++){const a=i.ranges[r],l=this.coordinatesConverter.convertModelPositionToViewPosition(new Y(a.fromLineNumber,1)).lineNumber,c=this.coordinatesConverter.convertModelPositionToViewPosition(new Y(a.toLineNumber,this.model.getLineMaxColumn(a.toLineNumber))).lineNumber;n[r]={fromLineNumber:l,toLineNumber:c}}this._eventDispatcher.emitSingleViewEvent(new Yke(n)),this._eventDispatcher.emitOutgoingEvent(new cEe(i))})),this._register(this.model.onDidChangeLanguageConfiguration(i=>{this._eventDispatcher.emitSingleViewEvent(new qke),this.cursorConfig=new Cp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new oEe(i))})),this._register(this.model.onDidChangeLanguage(i=>{this.cursorConfig=new Cp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new rEe(i))})),this._register(this.model.onDidChangeOptions(i=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new ix),n.emitViewEvent(new nx),n.emitViewEvent(new Xd(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Cp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new lEe(i))})),this._register(this.model.onDidChangeDecorations(i=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Xd(i)),this._eventDispatcher.emitOutgoingEvent(new sEe(i))}))}getFontSizeAtPosition(e){if(!this._configuration.options.get(172))return null;const i=this.model.getFontDecorationsInRange(H.fromPositions(e),this._editorId);let n=this._configuration.options.get(59).fontSize+"px";for(const r of i)if(r.options.fontSize){n=r.options.fontSize;break}return n}setHiddenAreas(e,t,i){var a;this.hiddenAreasModel.setHiddenAreas(t,e);const n=this.hiddenAreasModel.getMergedRanges();if(n===this.previousHiddenAreas&&!i)return;this.previousHiddenAreas=n;const r=this._captureStableViewport();let o=!1;try{const l=this._eventDispatcher.beginEmitViewEvents();o=this._lines.setHiddenAreas(n),o&&(l.emitViewEvent(new ix),l.emitViewEvent(new nx),l.emitViewEvent(new Xd(null)),this._cursor.onLineMappingChanged(l),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),this.viewLayout.onHeightMaybeChanged());const c=(a=r.viewportStartModelPosition)==null?void 0:a.lineNumber;c&&n.some(d=>d.startLineNumber<=c&&c<=d.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),o&&this._eventDispatcher.emitOutgoingEvent(new iEe)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(165),t=this._configuration.options.get(75),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),r=Math.max(1,n.completelyVisibleStartLineNumber-i),o=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new H(r,this.getLineMinColumn(r),o,this.getLineMaxColumn(o)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const n=[];let r=0,o=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let u=0,d=i.length;u<d;u++){const g=i[u].startLineNumber,p=i[u].endLineNumber;p<o||g>l||(o<g&&(n[r++]=new H(o,a,g-1,this.model.getLineMaxColumn(g-1))),o=p+1,a=1)}return(o<l||o===l&&a<c)&&(n[r++]=new H(o,a,l,c)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new H(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new H(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new Y(i,this.getLineMinColumn(i))),r=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:r}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=Lr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=rm(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}_getTextDirection(e,t){let i=0;for(const n of t){const r=n.range;if(r.startLineNumber>e||r.endLineNumber<e)continue;const o=n.options.textDirection;o===no.RTL?i++:o===no.LTR&&i--}return i>0?no.RTL:no.LTR}getTextDirection(e){const t=this._decorations.getDecorationsOnLine(e);return this._getTextDirection(e,t.decorations)}getViewportViewLineRenderingData(e,t){const i=this._decorations.getDecorationsViewportData(e),n=i.inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,n,i.hasVariableFonts,i.decorations)}getViewLineRenderingData(e){const t=this._decorations.getDecorationsOnLine(e);return this._getViewLineRenderingData(e,t.inlineDecorations[0],t.hasVariableFonts,t.decorations)}_getViewLineRenderingData(e,t,i,n){const r=this.model.mightContainRTL(),o=this.model.mightContainNonBasicASCII(),a=this.getTabSize(),l=this._lines.getViewLineData(e);return l.inlineDecorations&&(t=[...t,...l.inlineDecorations.map(c=>c.toInlineDecoration(e))]),new co(l.minColumn,l.maxColumn,l.content,l.continuesWithWrappedLine,r,o,l.tokens,t,a,l.startVisibleColumn,this._getTextDirection(e,n),i)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new S0e(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,jL(this._configuration.options),$L(this._configuration.options)),i=new OEe;for(const n of t){const r=n.options,o=r.overviewRuler;if(!o)continue;const a=o.position;if(a===0)continue;const l=o.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(l,r.zIndex,c,u,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i==null||i.invalidateCachedColor();const n=t.options.minimap;n==null||n.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e),n=this.model.modifyPosition(i,t);return this.coordinatesConverter.convertModelPositionToViewPosition(n)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const o=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(o)}getPlainTextToCopy(e,t,i){const n=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(H.compareRangesUsingStarts);let r=!1,o=!1;for(const l of e)l.isEmpty()?r=!0:o=!0;if(!o){if(!t)return"";const l=e.map(u=>u.startLineNumber);let c="";for(let u=0;u<l.length;u++)u>0&&l[u-1]===l[u]||(c+=this.model.getLineContent(l[u])+n);return c}if(r&&t){const l=[];let c=0;for(const u of e){const d=u.startLineNumber;u.isEmpty()?d!==c&&l.push(this.model.getLineContent(d)):l.push(this.model.getValueInRange(u,i?2:0)),c=d}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===da||e.length!==1)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const u=n.startLineNumber;n=new H(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}const r=this._configuration.options.get(59),o=this._getColorMap(),l=/[:;\\\/<>]/.test(r.fontFamily)||r.fontFamily===Bo.fontFamily;let c;return l?c=Bo.fontFamily:(c=r.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Bo.fontFamily}`),{mode:i,html:`<div style="color: ${o[1]};background-color: ${o[2]};font-family: ${c};font-weight: ${r.fontWeight};font-size: ${r.fontSize}px;line-height: ${r.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,o)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=r;c++){const u=this.model.tokenization.getLineTokens(c),d=u.getLineContent(),g=c===i?n-1:0,p=c===r?o-1:d.length;d===""?l+="<br>":l+=pEe(d,u.inflate(),t,g,p,a,cr)}return l}_getColorMap(){const e=qi.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=ae.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(n=>this._cursor.setStates(n,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(n=>this._cursor.setSelections(n,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new nEe);return}this._withViewEventsCollector(e)}executeEdits(e,t,i,n){this._executeCursorEdit(r=>this._cursor.executeEdits(r,e,t,i,n))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,n,r){this._executeCursorEdit(o=>this._cursor.compositionType(o,e,t,i,n,r))}paste(e,t,i,n){this._executeCursorEdit(r=>this._cursor.paste(r,e,t,i,n))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealAllCursors(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealAll(n,e,i,0,t,0))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealPrimary(n,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new H(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new rC(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new H(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new rC(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,n,r){this._withViewEventsCollector(o=>o.emitViewEvent(new rC(e,!1,i,null,n,t,r)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new Xke),this._eventDispatcher.emitOutgoingEvent(new tEe))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class z6{static create(e){const t=e._setTrackedRange(null,new H(1,1,1,1),1);return new z6(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,n,r){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=n,this._startLineDelta=r}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new Y(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new H(i.lineNumber,i.column,i.lineNumber,i.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),o=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=o-r}invalidate(){this._isValid=!1}}class OEe{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,r){const o=this._asMap[e];if(o){const a=o.data,l=a[a.length-3],c=a[a.length-1];if(l===r&&c+1>=i){n>c&&(a[a.length-1]=n);return}a.push(r,i,n)}else{const a=new Ew(e,t,[r,i,n]);this._asMap[e]=a,this.asArray.push(a)}}}class PEe{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&Hj(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>FEe(t,i),[]);return Hj(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function FEe(s,e){const t=[];let i=0,n=0;for(;i<s.length&&n<e.length;){const r=s[i],o=e[n];if(r.endLineNumber<o.startLineNumber-1)t.push(s[i++]);else if(o.endLineNumber<r.startLineNumber-1)t.push(e[n++]);else{const a=Math.min(r.startLineNumber,o.startLineNumber),l=Math.max(r.endLineNumber,o.endLineNumber);t.push(new H(a,1,l,1)),i++,n++}}for(;i<s.length;)t.push(s[i++]);for(;n<e.length;)t.push(e[n++]);return t}function Hj(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].equalsRange(e[t]))return!1;return!0}class zj{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}}class $1{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}var BEe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Bc=function(s,e){return function(t,i){e(t,i,s)}},hf,_g;let Gk=(_g=class extends ne{get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}get contextKeyService(){return this._contextKeyService}constructor(e,t,i,n,r,o,a,l,c,u,d,g){super(),this.languageConfigurationService=d,this._deliveryQueue=Jfe(),this._contributions=this._register(new qxe),this._onDidDispose=this._register(new $),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeLineHeight=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeLineHeight=this._onDidChangeLineHeight.event,this._onDidChangeFont=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeFont=this._onDidChangeFont.event,this._onDidChangeModelTokens=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new gs(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new Uj({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new Uj({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new gs(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new gs(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new gs(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new gs(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new gs(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new gs(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new gs(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new gs(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new gs(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new gs(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new $({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onWillTriggerEditorOperationEvent=this._register(new $),this._onBeginUpdate=this._register(new $),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new $),this.onEndUpdate=this._onEndUpdate.event,this._onBeforeExecuteEdit=this._register(new $),this.onBeforeExecuteEdit=this._onBeforeExecuteEdit.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),this.inComposition=!1,r.willCreateCodeEditor();const p={...t};if(this._domElement=e,this._overflowWidgetsDomNode=p.overflowWidgetsDomNode,delete p.overflowWidgetsDomNode,this._id=++VEe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?rn.SimpleEditorContext:rn.EditorContext),p,u)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);const x=this._configuration.options;if(v.hasChanged(165)){const S=x.get(165);this._onDidLayoutChange.fire(S)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),i.contextKeyValues)for(const[v,x]of Object.entries(i.contextKeyValues))this._contextKeyService.createKey(v,x);this._notificationService=c,this._codeEditorService=r,this._commandService=o,this._themeService=l,this._register(new HEe(this,this._contextKeyService)),this._register(new zEe(this,this._contextKeyService,g)),this._instantiationService=this._register(n.createChild(new $1([St,this._contextKeyService]))),this._modelData=null,this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let _;Array.isArray(i.contributions)?_=i.contributions:_=L_.getEditorContributions(),this._contributions.initialize(this,_,this._instantiationService);for(const v of L_.getEditorActions()){if(this._actions.has(v.id)){It(new Error(`Cannot have two actions with the same id ${v.id}`));continue}const x=new sJ(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,S=>this._instantiationService.invokeFunction(k=>Promise.resolve(v.runEditorCommand(k,this,S))),this._contextKeyService);this._actions.set(x.id,x)}const C=()=>!this._configuration.options.get(104)&&this._configuration.options.get(43).enabled;this._register(new n_e(this._domElement,{onDragOver:v=>{if(!C())return;const x=this.getTargetAtClientPoint(v.clientX,v.clientY);x!=null&&x.position&&this.showDropIndicatorAt(x.position)},onDrop:async v=>{if(!C()||(this.removeDropIndicator(),!v.dataTransfer))return;const x=this.getTargetAtClientPoint(v.clientX,v.clientY);x!=null&&x.position&&this._onDropIntoEditor.fire({position:x.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;(t=this._modelData)==null||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i,n){return new $4(e,t,i,this._domElement,n)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return vD.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Mi.getWordAtPosition(this._modelData.model,this._configuration.options.get(148),this._configuration.options.get(147),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){var t;try{this._beginUpdate();const i=e;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;const n={oldModelUrl:((t=this._modelData)==null?void 0:t.model.uri)||null,newModelUrl:(i==null?void 0:i.uri)||null};this._onWillChangeModel.fire(n);const r=this.hasTextFocus(),o=this._detachModel();this._attachModel(i),this.hasModel()?r&&this.focus():(this._editorTextFocus.setValue(!1),this._editorWidgetFocus.setValue(!1)),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(o),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(o.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?hf._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?hf._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber,n)}getBottomForLineNumber(e,t=!1){if(!this._modelData)return-1;const i=this._modelData.model.getLineMaxColumn(e);return hf._getVerticalOffsetAfterPosition(this._modelData,e,i,t)}getLineHeightForPosition(e){if(!this._modelData)return-1;const t=this._modelData.viewModel,i=t.coordinatesConverter,n=Y.lift(e);if(i.modelPositionIsVisible(n)){const r=i.convertModelPositionToViewPosition(n);return t.viewLayout.getLineHeightForLineNumber(r.lineNumber)}return 0}setHiddenAreas(e,t,i){var n;(n=this._modelData)==null||n.viewModel.setHiddenAreas(e.map(r=>H.lift(r)),t,i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return _i.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!Y.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!H.isIRange(e))throw new Error("Invalid arguments");const r=this._modelData.model.validateRange(e),o=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(r);this._modelData.viewModel.revealRange("api",i,o,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new H(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!Y.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new H(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=gt.isISelection(e),n=H.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const r={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(r,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new gt(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new H(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!H.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(H.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let n=0,r=e.length;n<r;n++)if(!gt.isISelection(e[n]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const n=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(n)}}handleInitialized(){var e;(e=this._getViewModel())==null||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){i=i||{};try{switch(this._onWillTriggerEditorOperationEvent.fire({source:e,handlerId:t,payload:i}),this._beginUpdate(),t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const r=i;this._type(e,r.text||"");return}case"replacePreviousChar":{const r=i;this._compositionType(e,r.text||"",r.replaceCharCnt||0,0,0);return}case"compositionType":{const r=i;this._compositionType(e,r.text||"",r.replacePrevCharCnt||0,r.replaceNextCharCnt||0,r.positionDelta||0);return}case"paste":{const r=i;this._paste(e,r.text||"",r.pasteOnNewLine||!1,r.multicursorText||null,r.mode||null,r.clipboardEvent);return}case"cut":this._cut(e);return}const n=this.getAction(t);if(n){Promise.resolve(n.run(i)).then(void 0,It);return}if(!this._modelData||this._triggerEditorCommand(e,t,i))return;this._triggerCommand(t,i)}finally{this._endUpdate()}}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this.inComposition=!0,this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this.inComposition=!1,this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,n,r){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,r,e)}_paste(e,t,i,n,r,o){if(!this._modelData)return;const a=this._modelData.viewModel,l=a.getSelection().getStartPosition();a.paste(t,i,n,e);const c=a.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:o,range:new H(l.lineNumber,l.column,c.lineNumber,c.column),languageId:r})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=L_.getEditorCommand(t);return n?(i=i||{},Vs(i)&&(i.source=e),this._instantiationService.invokeFunction(r=>{Promise.resolve(n.runEditorCommand(r,this,i)).then(void 0,It)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(104)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(104)?!1:(this._modelData.model.popStackElement(),!0)}edit(e,t){return this.executeEdits(t,e.replacements.map(i=>({range:i.range,text:i.text})),void 0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(104))return!1;let n;i?Array.isArray(i)?n=()=>i:n=i:n=()=>null;let r,o;return e instanceof hJ?(o=e,r=e.metadata.source):(o=Do.unknown({name:r}),r=e),this._onBeforeExecuteEdit.fire({source:r??void 0}),this._modelData.viewModel.executeEdits(r,t,n,o),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new UEe(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){if(!this._modelData)return null;const t=this._configuration.options;return this._modelData.model.getLineDecorations(e,this._id,jL(t),$L(t))}getDecorationsInRange(e){if(!this._modelData)return null;const t=this._configuration.options;return this._modelData.model.getDecorationsInRange(e,this._id,jL(t),$L(t))}getFontSizeAtPosition(e){return this._modelData?this._modelData.viewModel.getFontSizeAtPosition(e):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.changeDecorations(i=>i.deltaDecorations(t,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(165)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,t=!1){this._configuration.observeContainer(e),t||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isWidgetFocused()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),n=this._configuration.options.get(165),r=hf._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),o=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft(),a=this.getLineHeightForPosition(t);return{top:r,left:o,height:a}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){Jn(e,this._configuration.options.get(59))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),n=new MEe(this._id,this._configuration,e,E6.create(Ae(this._domElement)),V6.create(this._configuration.options),a=>hr(Ae(this._domElement),a),this.languageConfigurationService,this._themeService,i,{batchChanges:a=>{try{return this._beginUpdate(),a()}finally{this._endUpdate()}}});t.push(e.onWillDispose(()=>this.setModel(null))),t.push(n.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._editorWidgetFocus.setValue(a.hasFocus);break;case 3:this._onDidScrollChange.fire(a);break;case 4:this._onDidChangeViewZones.fire();break;case 5:this._onDidChangeHiddenAreas.fire();break;case 6:this._onDidAttemptReadOnlyEdit.fire();break;case 7:{if(a.reachedMaxCursorCount){const d=this.getOption(89),g=w(83,"The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",d);this._notificationService.prompt(QZ.Warning,g,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:w(84,"Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let d=0,g=a.selections.length;d<g;d++)l[d]=a.selections[d].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const u={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(u);break}case 8:this._onDidChangeModelDecorations.fire(a.event);break;case 9:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 10:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 11:this._onDidChangeModelContent.fire(a.event);break;case 12:this._onDidChangeModelOptions.fire(a.event);break;case 13:this._onDidChangeModelTokens.fire(a.event);break;case 14:this._onDidChangeLineHeight.fire(a.event);break;case 15:this._onDidChangeFont.fire(a.event);break}}));const[r,o]=this._createView(n);if(o){this._domElement.appendChild(r.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const u=a[l];r.addContentWidget(this._contentWidgets[u])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const u=a[l];r.addOverlayWidget(this._overlayWidgets[u])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const u=a[l];r.addGlyphMarginWidget(this._glyphMarginWidgets[u])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new WEe(e,n,r,o,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(r,o,a,l)=>{this._paste("keyboard",r,o,a,l)},type:r=>{this._type("keyboard",r)},compositionType:(r,o,a,l)=>{this._compositionType("keyboard",r,o,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(r,o,a,l)=>{const c={text:r,pasteOnNewLine:o,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:r=>{const o={text:r};this._commandService.executeCommand("type",o)},compositionType:(r,o,a,l)=>{if(a||l){const c={text:r,replacePrevCharCnt:o,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:r,replaceCharCnt:o};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new RD(e.coordinatesConverter);return i.onKeyDown=r=>this._onKeyDown.fire(r),i.onKeyUp=r=>this._onKeyUp.fire(r),i.onContextMenu=r=>this._onContextMenu.fire(r),i.onMouseMove=r=>this._onMouseMove.fire(r),i.onMouseLeave=r=>this._onMouseLeave.fire(r),i.onMouseDown=r=>this._onMouseDown.fire(r),i.onMouseUp=r=>this._onMouseUp.fire(r),i.onMouseDrag=r=>this._onMouseDrag.fire(r),i.onMouseDrop=r=>this._onMouseDrop.fire(r),i.onMouseDropCanceled=r=>this._onMouseDropCanceled.fire(r),i.onMouseWheel=r=>this._onMouseWheel.fire(r),[new E5(this._domElement,this.getId(),t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e==null||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){var i;if((i=this._contributionsDisposable)==null||i.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&t.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new H(e.lineNumber,e.column,e.lineNumber,e.column),options:hf.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}},hf=_g,_g.dropIntoEditorDecorationOptions=dn.register({description:"workbench-dnd-target",className:"dnd-target"}),_g);Gk=hf=BEe([Bc(3,wt),Bc(4,fn),Bc(5,ho),Bc(6,St),Bc(7,Ir),Bc(8,_a),Bc(9,uo),Bc(10,rc),Bc(11,ei)],Gk);let VEe=0,WEe=class{constructor(e,t,i,n,r,o){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=r,this.attachedView=o}dispose(){Zi(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};class Uj extends ne{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new $(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new $(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class gs extends ${constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class HEe extends ne{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ke.editorSimpleInput.bindTo(t),this._editorFocus=ke.focus.bindTo(t),this._textInputFocus=ke.textInputFocus.bindTo(t),this._editorTextFocus=ke.editorTextFocus.bindTo(t),this._tabMovesFocus=ke.tabMovesFocus.bindTo(t),this._editorReadonly=ke.readOnly.bindTo(t),this._inDiffEditor=ke.inDiffEditor.bindTo(t),this._editorColumnSelection=ke.columnSelection.bindTo(t),this._hasMultipleSelections=ke.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ke.hasNonEmptySelection.bindTo(t),this._canUndo=ke.canUndo.bindTo(t),this._canRedo=ke.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(bk.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(e.get(164)||bk.getTabFocusMode()),this._editorReadonly.set(e.get(104)),this._inDiffEditor.set(e.get(70)),this._editorColumnSelection.set(e.get(28))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class zEe extends ne{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=ke.languageId.bindTo(t),this._hasCompletionItemProvider=ke.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=ke.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=ke.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=ke.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=ke.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=ke.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=ke.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=ke.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=ke.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=ke.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=ke.hasReferenceProvider.bindTo(t),this._hasRenameProvider=ke.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=ke.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=ke.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=ke.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=ke.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=ke.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=ke.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInEmbeddedEditor=ke.isInEmbeddedEditor.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===je.walkThroughSnippet||e.uri.scheme===je.vscodeChatCodeBlock)})}}class UEe{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}}const jEe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),$Ee=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function xp(s){return jEe+encodeURIComponent(s.toString())+$Ee}const qEe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),GEe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function jj(s){return qEe+encodeURIComponent(s.toString())+GEe}Vh((s,e)=>{const t=s.getColor(l6);t&&(e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${xp(t)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-error-decoration: url("data:image/svg+xml,${xp(t)}"); }`));const i=s.getColor(fd);i&&(e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${xp(i)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-warning-decoration: url("data:image/svg+xml,${xp(i)}"); }`));const n=s.getColor(Ug);n&&(e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${xp(n)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-info-decoration: url("data:image/svg+xml,${xp(n)}"); }`));const r=s.getColor(hCe);r&&(e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${jj(r)}") no-repeat bottom left; }`),e.addRule(`:root { --monaco-editor-hint-decoration: url("data:image/svg+xml,${jj(r)}"); }`));const o=s.getColor(Tye);o&&(e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${o.rgba.a}; }`),e.addRule(`:root { --monaco-editor-unnecessary-decoration-opacity: ${o.rgba.a}; }`))});var KEe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},YEe=function(s,e){return function(t,i){e(t,i,s)}};let G5=class extends ne{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new $),this._onCodeEditorAdd=this._register(new $),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new $),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new $),this._onDiffEditorAdd=this._register(new $),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new $),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new sr,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let r;this._modelProperties.has(n)?r=this._modelProperties.get(n):(r=new Map,this._modelProperties.set(n,r)),r.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const n of this._codeEditorOpenHandlers){const r=await n(e,t,i);if(r!==null)return r}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return Fe(t)}};G5=KEe([YEe(0,Ir)],G5);var QEe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$j=function(s,e){return function(t,i){e(t,i,s)}};let Kk=class extends G5{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,n,r)=>n?this.doOpenEditor(n,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const r=t.resource.scheme;if(r===je.http||r===je.https)return eX(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const r={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};Kk=QEe([$j(0,St),$j(1,Ir)],Kk);ut(fn,Kk,0);const Wh=tt("layoutService");var TJ=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},NJ=function(s,e){return function(t,i){e(t,i,s)}};let Yk=class{get mainContainer(){var e;return((e=this._codeEditorService.listCodeEditors().at(0))==null?void 0:e.getContainerDomNode())??Ut.document.body}get activeContainer(){const e=this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor();return(e==null?void 0:e.getContainerDomNode())??this.mainContainer}get mainContainerDimension(){return m4(this.mainContainer)}get activeContainerDimension(){return m4(this.activeContainer)}get containers(){return i7(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())==null||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=ge.None,this.onDidLayoutActiveContainer=ge.None,this.onDidLayoutContainer=ge.None,this.onDidChangeActiveContainer=ge.None,this.onDidAddContainer=ge.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};Yk=TJ([NJ(0,fn)],Yk);let K5=class extends Yk{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};K5=TJ([NJ(1,fn)],K5);ut(Wh,Yk,1);const IJ=tt("dialogService");var XEe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},qj=function(s,e){return function(t,i){e(t,i,s)}};function sx(s){return s.scheme===je.file?s.fsPath:s.path}let RJ=0;class rx{constructor(e,t,i,n,r,o,a){this.id=++RJ,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Gj{constructor(e,t){this.resourceLabel=e,this.reason=t}}class Kj{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(w(2030,"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(w(2031,"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class ZEe{constructor(e,t,i,n,r,o,a){this.id=++RJ,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new Kj),this.removedResources.has(t)||this.removedResources.set(t,new Gj(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new Kj),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new Gj(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class AJ{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new xJ(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,r=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,r=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}r!==-1&&(this._past=this._past.slice(0,r)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class MR{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const MJ=new AJ("","");MJ.locked=!0;let Y5=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=W5.None,i=Ef.None){if(e.type===0){const n=sx(e.resource),r=this.getUriComparisonKey(e.resource);this._pushElement(new rx(e,n,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,r=[],o=[];for(const a of e.resources){const l=sx(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),r.push(l),o.push(c))}r.length===1?this._pushElement(new rx(e,r[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new ZEe(e,r,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],r=e.strResources[t];let o;this._editStacks.has(r)?o=this._editStacks.get(r):(o=new AJ(n,r),this._editStacks.set(r,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const r of i){const o=sx(r.resource),a=this.getUriComparisonKey(r.resource),l=new rx(r,o,a,0,0,0,0);n.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const r of i){const o=sx(r.resource),a=this.getUriComparisonKey(r.resource),l=new rx(r,o,a,0,0,0,0);n.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new xJ(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=n)}return[t,i]}canUndo(e){if(e instanceof Ef){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){It(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,r){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),n.dispose(),r()),l=>(o(),n.dispose(),this._onError(l,e))):(o(),n.dispose(),r())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return ne.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?ne.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(ne.None);const i=e.actual.prepareUndoRedo();return i?Y2(i)?t(i):i.then(n=>t(n)):t(ne.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||MJ);return new MR(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new ox(this._undo(e,0,!0));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(n),new ox}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,w(2032,"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,w(2033,"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndUndo(e,t,null,w(2034,"Could not undo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,w(2035,"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,w(2036,"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),r=this._checkWorkspaceUndo(e,t,n,!1);return r?r.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,n){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(u){u[u.All=0]="All",u[u.This=1]="This",u[u.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:Fi.Info,message:w(2037,"Would you like to undo '{0}' across all files?",t.label),buttons:[{label:w(2038,"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:w(2039,"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;n=!0}let r;try{r=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return r.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,r,()=>this._continueUndoInGroup(t.groupId,n))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=w(2040,"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new MR([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof Ef){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),r=n.getClosestPastElement();if(!r)return;if(r.groupId){const[a,l]=this._findClosestUndoElementInGroup(r.groupId);if(r!==a&&l)return this._undo(l,t,i)}if((r.sourceId!==t||r.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,r);try{return r.type===1?this._workspaceUndo(e,r,i):this._resourceUndo(n,r,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:w(2041,"Would you like to undo '{0}'?",i.label),primaryButton:w(2042,"&&Yes"),cancelButton:w(2043,"No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=n)}return[t,i]}canRedo(e){if(e instanceof Ef){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new ox(this._redo(e));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(n),new ox}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,w(2044,"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,w(2045,"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndRedo(e,t,null,w(2046,"Could not redo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,w(2047,"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,w(2048,"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let n;try{n=await this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const r=this._checkWorkspaceRedo(e,t,i,!0);if(r)return n.dispose(),r.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=w(2049,"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new MR([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof Ef){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,r]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&r)return this._redo(r)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};Y5=XEe([qj(0,IJ),qj(1,_a)],Y5);class ox{constructor(e){this.returnValue=e}}ut(B6,Y5,1);function tr(s,e,t){return Math.min(Math.max(s,e),t)}class OJ{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class JEe{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const PJ=tt("environmentService");var e2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Yj=function(s,e){return function(t,i){e(t,i,s)}};const t2e=tt("ILanguageFeatureDebounceService");var Qk;(function(s){const e=new WeakMap;let t=0;function i(n){let r=e.get(n);return r===void 0&&(r=++t,e.set(n,r)),r}s.of=i})(Qk||(Qk={}));class i2e{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class n2e{constructor(e,t,i,n,r,o){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=r,this._max=o,this._cache=new Ov(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>iD(Qk.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?tr(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new JEe(6),this._cache.set(i,n));const r=tr(n.update(t),this._min,this._max);return T7(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){const e=new OJ;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return tr(e,this._min,this._max)}}let Q5=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){const n=(i==null?void 0:i.min)??50,r=(i==null?void 0:i.max)??n**2,o=(i==null?void 0:i.key)??void 0,a=`${Qk.of(e)},${n}${o?","+o:""}`;let l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new i2e(n*1.5)):l=new n2e(this._logService,t,e,this._overallAverage()|0||n*1.5,n,r),this._data.set(a,l)),l}_overallAverage(){const e=new OJ;for(const t of this._data.values())e.update(t.default());return e.value}};Q5=e2e([Yj(0,Ks),Yj(1,PJ)],Q5);ut(t2e,Q5,1);var s2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},OR=function(s,e){return function(t,i){e(t,i,s)}};let X5=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new Z5}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),r=this._hashTable.get(e,t,n);let o;if(r)o=r.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let d=0;c>0&&d<this._legend.tokenModifiers.length;d++)c&1&&l.push(this._legend.tokenModifiers[d]),c=c>>1;const u=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof u>"u")o=2147483647;else{if(o=0,typeof u.italic<"u"){const d=(u.italic?1:0)<<11;o|=d|1}if(typeof u.bold<"u"){const d=(u.bold?2:0)<<11;o|=d|2}if(typeof u.underline<"u"){const d=(u.underline?4:0)<<11;o|=d|4}if(typeof u.strikethrough<"u"){const d=(u.strikethrough?8:0)<<11;o|=d|8}if(u.foreground){const d=u.foreground<<15;o|=d|16}o===0&&(o=2147483647)}}else o=2147483647,a="not-in-legend";this._hashTable.add(e,t,n,o)}return o}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,n,r){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${n} is outside the previous data (length ${r}).`))}};X5=s2e([OR(1,Ir),OR(2,En),OR(3,Ks)],X5);class r2e{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}const Jc=class Jc{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=Jc._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Jc._SIZES.length?2/3*this._currentLength:0),this._elements=[],Jc._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let r=this._elements[n];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===i)return r;r=r.next}return null}add(e,t,i,n){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const r=this._elements;this._currentLengthIndex++,this._currentLength=Jc._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Jc._SIZES.length?2/3*this._currentLength:0),this._elements=[],Jc._nullOutEntries(this._elements,this._currentLength);for(const o of r){let a=o;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new r2e(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}};Jc._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];let Z5=Jc;const o2e=tt("semanticTokensStylingService");var a2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},PR=function(s,e){return function(t,i){e(t,i,s)}};let J5=class extends ne{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new X5(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};J5=a2e([PR(0,Ir),PR(1,Ks),PR(2,En)],J5);ut(o2e,J5,1);const ax="**",Qj="/",Yx="[/\\\\]",Qx="[^/\\\\]",l2e=/\//g;function Xj(s,e){switch(s){case 0:return"";case 1:return`${Qx}*?`;default:return`(?:${Yx}|${Qx}+${Yx}${e?`|${Yx}${Qx}+`:""})*?`}}function Zj(s,e){if(!s)return[];const t=[];let i=!1,n=!1,r="";for(const o of s){switch(o){case e:if(!i&&!n){t.push(r),r="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}r+=o}return r&&t.push(r),t}function FJ(s){if(!s)return"";let e="";const t=Zj(s,Qj);if(t.every(i=>i===ax))e=".*";else{let i=!1;t.forEach((n,r)=>{if(n===ax){if(i)return;e+=Xj(2,r===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const u of n){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!c?d="^":u===Qj?d="":d=Yl(u),c+=d;continue}switch(u){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const g=`(?:${Zj(a,",").map(p=>FJ(p)).join("|")})`;e+=g,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=Qx;continue;case"*":e+=Xj(1);continue;default:e+=Yl(u)}}r<t.length-1&&(t[r+1]!==ax||r+2<t.length)&&(e+=Yx)}i=n===ax})}return e}const c2e=/^\*\*\/\*\.[\w\.-]+$/,h2e=/^\*\*\/([\w\.-]+)\/?$/,u2e=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,d2e=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,f2e=/^\*\*((\/[\w\.-]+)+)\/?$/,g2e=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Jj=new Ov(1e4),e$=function(){return!1},Hl=function(){return null};function U6(s,e){if(!s)return Hl;let t;typeof s!="string"?t=s.pattern:t=s,t=t.trim();const i=e.ignoreCase??!1,n={...e,equals:i?zf:(l,c)=>l===c,endsWith:i?Ome:(l,c)=>l.endsWith(c),isEqualOrParent:(l,c)=>S4(l,c,!kr||i)},r=`${i?t.toLowerCase():t}_${!!e.trimForExclusions}_${i}`;let o=Jj.get(r);if(o)return t$(o,s,n);let a;return c2e.test(t)?o=m2e(t.substring(4),t,n):(a=h2e.exec(FR(t,n)))?o=p2e(a[1],t,n):(e.trimForExclusions?d2e:u2e).test(t)?o=_2e(t,n):(a=f2e.exec(FR(t,n)))?o=i$(a[1].substring(1),t,!0,n):(a=g2e.exec(FR(t,n)))?o=i$(a[1],t,!1,n):o=b2e(t,n),Jj.set(r,o),t$(o,s,n)}function t$(s,e,t){if(typeof e=="string")return s;const i=function(n,r){return t.isEqualOrParent(n,e.base)?s(Z2(n.substring(e.base.length),Xu),r):null};return i.allBasenames=s.allBasenames,i.allPaths=s.allPaths,i.basenames=s.basenames,i.patterns=s.patterns,i}function FR(s,e){return e.trimForExclusions&&s.endsWith("/**")?s.substring(0,s.length-2):s}function m2e(s,e,t){return function(i,n){return typeof i=="string"&&t.endsWith(i,s)?e:null}}function p2e(s,e,t){const i=`/${s}`,n=`\\${s}`,r=function(a,l){return typeof a!="string"?null:l?t.equals(l,s)?e:null:t.equals(a,s)||t.endsWith(a,i)||t.endsWith(a,n)?e:null},o=[s];return r.basenames=o,r.patterns=[e],r.allBasenames=o,r}function _2e(s,e){const t=VJ(s.slice(1,-1).split(",").map(a=>U6(a,e)).filter(a=>a!==Hl),s),i=t.length;if(!i)return Hl;if(i===1)return t[0];const n=function(a,l){for(let c=0,u=t.length;c<u;c++)if(t[c](a,l))return s;return null},r=t.find(a=>!!a.allBasenames);r&&(n.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function i$(s,e,t,i){const n=Xu===Gi.sep,r=n?s:s.replace(l2e,Xu),o=Xu+r,a=Gi.sep+s;let l;return t?l=function(c,u){return typeof c=="string"&&(i.equals(c,r)||i.endsWith(c,o)||!n&&(i.equals(c,s)||i.endsWith(c,a)))?e:null}:l=function(c,u){return typeof c=="string"&&(i.equals(c,r)||!n&&i.equals(c,s))?e:null},l.allPaths=[(t?"*/":"./")+s],l}function b2e(s,e){try{const t=new RegExp(`^${FJ(s)}$`,e.ignoreCase?"i":void 0);return function(i){return t.lastIndex=0,typeof i=="string"&&t.test(i)?s:null}}catch{return Hl}}function C2e(s,e,t){return!s||typeof e!="string"?!1:BJ(s,t)(e)}function BJ(s,e={}){if(!s)return e$;if(typeof s=="string"||w2e(s)){const t=U6(s,e);if(t===Hl)return e$;const i=function(n,r){return!!t(n,r)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return v2e(s,e)}function w2e(s){const e=s;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function v2e(s,e){const t=VJ(Object.getOwnPropertyNames(s).map(a=>y2e(a,s[a],e)).filter(a=>a!==Hl)),i=t.length;if(!i)return Hl;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,d){let g;for(let p=0,_=t.length;p<_;p++){const C=t[p](u,d);if(typeof C=="string")return C;r4(C)&&(g||(g=[]),g.push(C))}return g?(async()=>{for(const p of g){const _=await p;if(typeof _=="string")return _}return null})():null},l=t.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let u,d;for(let g=0,p=t.length;g<p;g++){const _=t[g];_.requiresSiblings&&c&&(l||(l=vQ(a)),u||(u=l.substring(0,l.length-dme(a).length)));const C=_(a,l,u,c);if(typeof C=="string")return C;r4(C)&&(d||(d=[]),d.push(C))}return d?(async()=>{for(const g of d){const p=await g;if(typeof p=="string")return p}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(n.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function y2e(s,e,t){if(e===!1)return Hl;const i=U6(s,t);if(i===Hl)return Hl;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const r=(o,a,l,c)=>{if(!c||!i(o,a))return null;const u=n.replace("$(basename)",()=>l),d=c(u);return r4(d)?d.then(g=>g?s:null):d?s:null};return r.requiresSiblings=!0,r}}return i}function VJ(s,e){const t=s.filter(a=>!!a.basenames);if(t.length<2)return s;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const r=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===47||d===92)break}l=a.substring(u)}const c=i.indexOf(l);return c!==-1?n[c]:null};r.basenames=i,r.patterns=n,r.allBasenames=i;const o=s.filter(a=>!a.basenames);return o.push(r),o}function WJ(s,e,t,i,n,r){if(Array.isArray(s)){let o=0;for(const a of s){const l=WJ(a,e,t,i,n,r);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof s=="string")return i?s==="*"?5:s===t?10:0:0;if(s){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=s;if(!i&&!c)return 0;u&&n&&(e=n);let d=0;if(l)if(l===e.scheme)d=10;else if(l==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===r)d=10;else if(u==="*"&&r!==void 0)d=Math.max(d,5);else return 0;if(a){let g;if(typeof a=="string"?g=a:g={...a,base:wQ(a.base)},g===e.fsPath||C2e(g,e.fsPath))d=10;else return 0}return d}else return 0}}function HJ(s){return typeof s=="string"?!1:Array.isArray(s)?s.every(HJ):!!s.exclusive}class n${constructor(e,t,i,n,r){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n,this.recursive=r}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)==null?void 0:t.toString())===((i=e.notebookUri)==null?void 0:i.toString())&&this.recursive===e.recursive}}class gi{get onDidChange(){return this._onDidChange.event}constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new $}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Fe(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,n=>i.push(n.provider)),i}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,!1,r=>{i&&n===r._score?i.push(r.provider):(n=r._score,i=[r.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const n of this._entries)n._score>0&&i(n)}_updateScores(e,t){var r,o;const i=(r=this._notebookInfoResolver)==null?void 0:r.call(this,e.uri),n=i?new n$(e.uri,e.getLanguageId(),i.uri,i.type,t):new n$(e.uri,e.getLanguageId(),void 0,void 0,t);if(!((o=this._lastCandidate)!=null&&o.equals(n))){this._lastCandidate=n;for(const a of this._entries)if(a._score=WJ(a.selector,n.uri,n.languageId,obe(e),n.notebookUri,n.notebookType),HJ(a.selector)&&a._score>0)if(t)a._score=0;else{for(const l of this._entries)l._score=0;a._score=1e3;break}this._entries.sort(gi._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:k0(e.selector)&&!k0(t.selector)?1:!k0(e.selector)&&k0(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function k0(s){return typeof s=="string"?!1:Array.isArray(s)?s.some(k0):!!s.isBuiltin}class S2e{constructor(){this.referenceProvider=new gi(this._score.bind(this)),this.renameProvider=new gi(this._score.bind(this)),this.newSymbolNamesProvider=new gi(this._score.bind(this)),this.codeActionProvider=new gi(this._score.bind(this)),this.definitionProvider=new gi(this._score.bind(this)),this.typeDefinitionProvider=new gi(this._score.bind(this)),this.declarationProvider=new gi(this._score.bind(this)),this.implementationProvider=new gi(this._score.bind(this)),this.documentSymbolProvider=new gi(this._score.bind(this)),this.inlayHintsProvider=new gi(this._score.bind(this)),this.colorProvider=new gi(this._score.bind(this)),this.codeLensProvider=new gi(this._score.bind(this)),this.documentFormattingEditProvider=new gi(this._score.bind(this)),this.documentRangeFormattingEditProvider=new gi(this._score.bind(this)),this.onTypeFormattingEditProvider=new gi(this._score.bind(this)),this.signatureHelpProvider=new gi(this._score.bind(this)),this.hoverProvider=new gi(this._score.bind(this)),this.documentHighlightProvider=new gi(this._score.bind(this)),this.multiDocumentHighlightProvider=new gi(this._score.bind(this)),this.selectionRangeProvider=new gi(this._score.bind(this)),this.foldingRangeProvider=new gi(this._score.bind(this)),this.linkProvider=new gi(this._score.bind(this)),this.inlineCompletionsProvider=new gi(this._score.bind(this)),this.completionProvider=new gi(this._score.bind(this)),this.linkedEditingRangeProvider=new gi(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new gi(this._score.bind(this)),this.documentSemanticTokensProvider=new gi(this._score.bind(this)),this.documentDropEditProvider=new gi(this._score.bind(this)),this.documentPasteEditProvider=new gi(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)==null?void 0:t.call(this,e)}}ut(ei,S2e,1);var x2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},s$=function(s,e){return function(t,i){e(t,i,s)}};const qv=tt("hoverService");let qw=class extends ne{get delay(){var e;return this.isInstantlyHovering()?0:(e=this.hoverOptions)!=null&&e.dynamicDelay?t=>{var i,n;return((n=(i=this.hoverOptions)==null?void 0:i.dynamicDelay)==null?void 0:n.call(i,t))??this._delay}:this._delay}constructor(e,t,i={},n,r){super(),this.placement=e,this.hoverOptions=t,this.overrideOptions=i,this.configurationService=n,this.hoverService=r,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new Ee),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(e,t){const i=typeof this.overrideOptions=="function"?this.overrideOptions(e,t):this.overrideOptions;this.hoverDisposables.clear();const n=Wi(e.target)?[e.target]:e.target.targetElements;for(const o of n)this.hoverDisposables.add(Xn(o,"keydown",a=>{a.equals(9)&&this.hoverService.hideHover()}));const r=Wi(e.content)?void 0:typeof e.content=="string"?e.content.toString():e.content.value;return this.hoverService.showInstantHover({...e,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:r,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},t)}isInstantlyHovering(){var e;return!!((e=this.hoverOptions)!=null&&e.instantHover)&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){var e;this.hoverDisposables.clear(),(e=this.hoverOptions)!=null&&e.instantHover&&(this.lastHoverHideTime=Date.now())}};qw=x2e([s$(3,ai),s$(4,qv)],qw);const Gv=tt("contextViewService"),Hh=tt("contextMenuService"),lx=Ve;let L2e=class extends ne{constructor(e){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.classList.toggle("fade-in",!!e),this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new m6(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class j6 extends ne{static render(e,t,i){return new j6(e,t,i)}constructor(e,t,i){super(),this.actionLabel=t.label,this.actionKeybindingLabel=i,this.actionContainer=De(e,lx("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=De(this.actionContainer,lx("a.action")),this.action.setAttribute("role","button"),t.iconClass&&De(this.action,lx("span.icon")).classList.add(...t.iconClass.split(" ")),this.actionRenderedLabel=i?`${t.label} (${i})`:t.label;const n=De(this.action,lx("span"));n.textContent=this.actionRenderedLabel,this._store.add(new E2e(this.actionContainer,t.run)),this._store.add(new D2e(this.actionContainer,t.run,[3,10])),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function k2e(s,e){return s&&e?w(7,"Inspect this in the accessible view with {0}.",e):s?w(8,"Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class E2e extends ne{constructor(e,t){super(),this._register(J(e,pe.CLICK,i=>{i.stopPropagation(),i.preventDefault(),t(e)}))}}class D2e extends ne{constructor(e,t,i){super(),this._register(J(e,pe.KEY_DOWN,n=>{const r=new jt(n);i.some(o=>r.equals(o))&&(n.stopPropagation(),n.preventDefault(),t(e))}))}}function zJ(...s){return function(e,t){for(let i=0,n=s.length;i<n;i++){const r=s[i](e,t);if(r)return r}return null}}UJ.bind(void 0,!1);const Xk=UJ.bind(void 0,!0);function UJ(s,e,t){if(!t||t.length<e.length)return null;let i;return s?i=C7(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function T2e(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t===-1?null:[{start:t,end:t+s.length}]}function N2e(s,e){return eO(s.toLowerCase(),e.toLowerCase(),0,0)}function eO(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]===e[i]){let n=null;return(n=eO(s,e,t+1,i+1))?$J({start:i,end:i+1},n):null}return eO(s,e,t,i+1)}function $6(s){return 97<=s&&s<=122}function OD(s){return 65<=s&&s<=90}function q6(s){return 48<=s&&s<=57}function I2e(s){return s===32||s===9||s===10||s===13}const R2e=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(s=>R2e.add(s.charCodeAt(0)));function jJ(s){return $6(s)||OD(s)||q6(s)}function $J(s,e){return e.length===0?e=[s]:s.end===e[0].start?e[0].start=s.start:e.unshift(s),e}function qJ(s,e){for(let t=e;t<s.length;t++){const i=s.charCodeAt(t);if(OD(i)||q6(i)||t>0&&!jJ(s.charCodeAt(t-1)))return t}return s.length}function tO(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]!==e[i].toLowerCase())return null;{let n=null,r=i+1;for(n=tO(s,e,t+1,i+1);!n&&(r=qJ(e,r))<e.length;)n=tO(s,e,t+1,r),r++;return n===null?null:$J({start:i,end:i+1},n)}}function A2e(s){let e=0,t=0,i=0,n=0,r=0;for(let u=0;u<s.length;u++)r=s.charCodeAt(u),OD(r)&&e++,$6(r)&&t++,jJ(r)&&i++,q6(r)&&n++;const o=e/s.length,a=t/s.length,l=i/s.length,c=n/s.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function M2e(s){const{upperPercent:e,lowerPercent:t}=s;return t===0&&e>.6}function O2e(s){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=s;return t>.2&&e<.8&&i>.6&&n<.2}function P2e(s){let e=0,t=0,i=0,n=0;for(let r=0;r<s.length;r++)i=s.charCodeAt(r),OD(i)&&e++,$6(i)&&t++,I2e(i)&&n++;return(e===0||t===0)&&n===0?s.length<=30:e<=5}function GJ(s,e){if(!e||(e=e.trim(),e.length===0)||!P2e(s))return null;e.length>60&&(e=e.substring(0,60));const t=A2e(e);if(!O2e(t)){if(!M2e(t))return null;e=e.toLowerCase()}let i=null,n=0;for(s=s.toLowerCase();n<e.length&&(i=tO(s,e,0,n))===null;)n=qJ(e,n+1);return i}const F2e=zJ(Xk,GJ,T2e),B2e=zJ(Xk,GJ,N2e),r$=new Ov(1e4);function o$(s,e,t=!1){if(typeof s!="string"||typeof e!="string")return null;let i=r$.get(s);i||(i=new RegExp(Mme(s),"i"),r$.set(s,i));const n=i.exec(e);return n?[{start:n.index,end:n.index+n[0].length}]:t?B2e(s,e):F2e(s,e)}function V2e(s,e){const t=QJ(s,s.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?W2e(t):null}function W2e(s){if(typeof s>"u")return[];const e=[],t=s[1];for(let i=s.length-1;i>1;i--){const n=s[i]+t,r=e[e.length-1];r&&r.end===n?r.end=n+1:e.push({start:n,end:n+1})}return e}const Hu=128;function G6(){const s=[],e=[];for(let t=0;t<=Hu;t++)e[t]=0;for(let t=0;t<=Hu;t++)s.push(e.slice(0));return s}function KJ(s){const e=[];for(let t=0;t<=s;t++)e[t]=0;return e}const YJ=KJ(2*Hu),iO=KJ(2*Hu),Vc=G6(),Jd=G6(),cx=G6();function hx(s,e){if(e<0||e>=s.length)return!1;const t=s.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!x7(t)}}function a$(s,e){if(e<0||e>=s.length)return!1;switch(s.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function Xx(s,e,t){return e[s]!==t[s]}function H2e(s,e,t,i,n,r,o=!1){for(;e<t&&n<r;)s[e]===i[n]&&(o&&(YJ[e]=n),e+=1),n+=1;return e===t}var ug;(function(s){s.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}s.isDefault=e})(ug||(ug={}));const U9=class U9{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};U9.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};let nO=U9;function QJ(s,e,t,i,n,r,o=nO.default){const a=s.length>Hu?Hu:s.length,l=i.length>Hu?Hu:i.length;if(t>=a||r>=l||a-t>l-r||!H2e(e,t,a,n,r,l,!0))return;z2e(a,l,t,r,e,n);let c=1,u=1,d=t,g=r;const p=[!1];for(c=1,d=t;d<a;c++,d++){const S=YJ[d],k=iO[d],E=d+1<a?iO[d+1]:l;for(u=S-r+1,g=S;g<E;u++,g++){let T=Number.MIN_SAFE_INTEGER,R=!1;g<=k&&(T=U2e(s,e,d,t,i,n,g,l,r,Vc[c-1][u-1]===0,p));let N=0;T!==Number.MIN_SAFE_INTEGER&&(R=!0,N=T+Jd[c-1][u-1]);const A=g>S,O=A?Jd[c][u-1]+(Vc[c][u-1]>0?-5:0):0,W=g>S+1&&Vc[c][u-1]>0,j=W?Jd[c][u-2]+(Vc[c][u-2]>0?-5:0):0;if(W&&(!A||j>=O)&&(!R||j>=N))Jd[c][u]=j,cx[c][u]=3,Vc[c][u]=0;else if(A&&(!R||O>=N))Jd[c][u]=O,cx[c][u]=2,Vc[c][u]=0;else if(R)Jd[c][u]=N,cx[c][u]=1,Vc[c][u]=Vc[c-1][u-1]+1;else throw new Error("not possible")}}if(!p[0]&&!o.firstMatchCanBeWeak)return;c--,u--;const _=[Jd[c][u],r];let C=0,v=0;for(;c>=1;){let S=u;do{const k=cx[c][S];if(k===3)S=S-2;else if(k===2)S=S-1;else break}while(S>=1);C>1&&e[t+c-1]===n[r+u-1]&&!Xx(S+r-1,i,n)&&C+1>Vc[c][S]&&(S=u),S===u?C++:C=1,v||(v=S),c--,u=S-1,_.push(u)}l-r===a&&o.boostFullMatch&&(_[0]+=2);const x=v-a;return _[0]-=x,_}function z2e(s,e,t,i,n,r){let o=s-1,a=e-1;for(;o>=t&&a>=i;)n[o]===r[a]&&(iO[o]=a,o--),a--}function U2e(s,e,t,i,n,r,o,a,l,c,u){if(e[t]!==r[o])return Number.MIN_SAFE_INTEGER;let d=1,g=!1;return o===t-i?d=s[t]===n[o]?7:5:Xx(o,n,r)&&(o===0||!Xx(o-1,n,r))?(d=s[t]===n[o]?7:5,g=!0):hx(r,o)&&(o===0||!hx(r,o-1))?d=5:(hx(r,o-1)||a$(r,o-1))&&(d=5,g=!0),d>1&&t===i&&(u[0]=!0),g||(g=Xx(o,n,r)||hx(r,o-1)||a$(r,o-1)),t===i?o>l&&(d-=g?3:5):c?d+=g?2:0:d+=g?0:1,o+1===a&&(d-=g?3:5),d}const j2e="$(",K6=new RegExp(`\\$\\(${ht.iconNameExpression}(?:${ht.iconModifierExpression})?\\)`,"g"),$2e=new RegExp(`(\\\\)?${K6.source}`,"g");function q2e(s){return s.replace($2e,(e,t)=>t?e:`\\${e}`)}const G2e=new RegExp(`\\\\${K6.source}`,"g");function K2e(s){return s.replace(G2e,e=>`\\${e}`)}const Y2e=new RegExp(`(\\s)?(\\\\)?${K6.source}(\\s)?`,"g");function XJ(s){return s.indexOf(j2e)===-1?s:s.replace(Y2e,(e,t,i,n)=>i?e:t||n||"")}function ZJ(s){return s?s.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const BR=new RegExp(`\\$\\(${ht.iconNameCharacter}+\\)`,"g");function Yf(s){BR.lastIndex=0;let e="";const t=[];let i=0;for(;;){const n=BR.lastIndex,r=BR.exec(s),o=s.substring(n,r==null?void 0:r.index);if(o.length>0){e+=o;for(let a=0;a<o.length;a++)t.push(i)}if(!r)break;i+=r[0].length}return{text:e,iconOffsets:t}}function cC(s,e,t=!1){const{text:i,iconOffsets:n}=e;if(!n||n.length===0)return o$(s,i,t);const r=Z2(i," "),o=i.length-r.length,a=o$(s,r,t);if(a)for(const l of a){const c=n[l.start+o]+o;l.start+=c,l.end+=c}return a}class JJ{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw K2("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1,this.supportAlertSyntax=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1,this.supportAlertSyntax=t.supportAlertSyntax??!1)}appendText(e,t=0){return this.value+=X2e(this.supportThemeIcons?q2e(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${Z2e(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(Yl(t),"g");return e.replace(i,(n,r)=>e.charAt(r-1)!=="\\"?`\\${n}`:n)}}function hC(s){return s instanceof JJ?!0:s&&typeof s=="object"?typeof s.value=="string"&&(typeof s.isTrusted=="boolean"||typeof s.isTrusted=="object"||s.isTrusted===void 0)&&(typeof s.supportThemeIcons=="boolean"||s.supportThemeIcons===void 0)&&(typeof s.supportAlertSyntax=="boolean"||s.supportAlertSyntax===void 0):!1}function Q2e(s,e){return s===e?!0:!s||!e?!1:s.value===e.value&&s.isTrusted===e.isTrusted&&s.supportThemeIcons===e.supportThemeIcons&&s.supportHtml===e.supportHtml&&s.supportAlertSyntax===e.supportAlertSyntax&&(s.baseUri===e.baseUri||!!s.baseUri&&!!e.baseUri&&z_e(nt.from(s.baseUri),nt.from(e.baseUri)))}function X2e(s){return s.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Z2e(s,e){var n;const t=((n=s.match(/^`+/gm))==null?void 0:n.reduce((r,o)=>r.length>o.length?r:o).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,s,`${"`".repeat(i)}`].join(`
`)}function ux(s){return s.replace(/"/g,"&quot;")}function VR(s){return s&&s.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function J2e(s){const e=[],t=s.split("|").map(n=>n.trim());s=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),r=/width=(\d+)/.exec(i),o=n?n[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:s,dimensions:e}}class eee{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const l$=new eee("id#");function Y6(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let pm=Y6();function tee(s){pm=s}const iee=/[&<>"']/,eDe=new RegExp(iee.source,"g"),nee=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,tDe=new RegExp(nee.source,"g"),iDe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c$=s=>iDe[s];function To(s,e){if(e){if(iee.test(s))return s.replace(eDe,c$)}else if(nee.test(s))return s.replace(tDe,c$);return s}const nDe=/(^|[^\[])\^/g;function Ti(s,e){let t=typeof s=="string"?s:s.source;e=e||"";const i={replace:(n,r)=>{let o=typeof r=="string"?r:r.source;return o=o.replace(nDe,"$1"),t=t.replace(n,o),i},getRegex:()=>new RegExp(t,e)};return i}function h$(s){try{s=encodeURI(s).replace(/%25/g,"%")}catch{return null}return s}const uC={exec:()=>null};function u$(s,e){const t=s.replace(/\|/g,(r,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=t.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function o0(s,e,t){const i=s.length;if(i===0)return"";let n=0;for(;n<i&&s.charAt(i-n-1)===e;)n++;return s.slice(0,i-n)}function sDe(s,e){if(s.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<s.length;i++)if(s[i]==="\\")i++;else if(s[i]===e[0])t++;else if(s[i]===e[1]&&(t--,t<0))return i;return-1}function d$(s,e,t,i){const n=e.href,r=e.title?To(e.title):null,o=s[1].replace(/\\([\[\]])/g,"$1");if(s[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:n,title:r,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:t,href:n,title:r,text:To(o)}}function rDe(s,e){const t=s.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(n=>{const r=n.match(/^\s+/);if(r===null)return n;const[o]=r;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}class Zk{constructor(e){Ui(this,"options");Ui(this,"rules");Ui(this,"lexer");this.options=e||pm}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:o0(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],n=rDe(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const n=o0(i,"#");(this.options.pedantic||!n||/ $/.test(n))&&(i=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:o0(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=o0(t[0],`
`).split(`
`),n="",r="";const o=[];for(;i.length>0;){let a=!1;const l=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))l.push(i[c]),a=!0;else if(!a)l.push(i[c]);else break;i=i.slice(c);const u=l.join(`
`),d=u.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");n=n?`${n}
${u}`:u,r=r?`${r}
${d}`:d;const g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=g,i.length===0)break;const p=o[o.length-1];if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const _=p,C=_.raw+`
`+i.join(`
`),v=this.blockquote(C);o[o.length-1]=v,n=n.substring(0,n.length-_.raw.length)+v.raw,r=r.substring(0,r.length-_.text.length)+v.text;break}else if((p==null?void 0:p.type)==="list"){const _=p,C=_.raw+`
`+i.join(`
`),v=this.list(C);o[o.length-1]=v,n=n.substring(0,n.length-p.raw.length)+v.raw,r=r.substring(0,r.length-_.raw.length)+v.raw,i=C.substring(o[o.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:o,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const n=i.length>1,r={type:"list",raw:"",ordered:n,start:n?+i.slice(0,-1):"",loose:!1,items:[]};i=n?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=n?i:"[*+-]");const o=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(/^\t+/,x=>" ".repeat(3*x.length)),g=e.split(`
`,1)[0],p=!d.trim(),_=0;if(this.options.pedantic?(_=2,u=d.trimStart()):p?_=t[1].length+1:(_=t[2].search(/[^ ]/),_=_>4?1:_,u=d.slice(_),_+=t[1].length),p&&/^ *$/.test(g)&&(c+=g+`
`,e=e.substring(g.length+1),l=!0),!l){const x=new RegExp(`^ {0,${Math.min(3,_-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),S=new RegExp(`^ {0,${Math.min(3,_-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),k=new RegExp(`^ {0,${Math.min(3,_-1)}}(?:\`\`\`|~~~)`),E=new RegExp(`^ {0,${Math.min(3,_-1)}}#`);for(;e;){const T=e.split(`
`,1)[0];if(g=T,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),k.test(g)||E.test(g)||x.test(g)||S.test(e))break;if(g.search(/[^ ]/)>=_||!g.trim())u+=`
`+g.slice(_);else{if(p||d.search(/[^ ]/)>=4||k.test(d)||E.test(d)||S.test(d))break;u+=`
`+g}!p&&!g.trim()&&(p=!0),c+=T+`
`,e=e.substring(T.length+1),d=g.slice(_)}}r.loose||(a?r.loose=!0:/\n *\n *$/.test(c)&&(a=!0));let C=null,v;this.options.gfm&&(C=/^\[[ xX]\] /.exec(u),C&&(v=C[0]!=="[ ] ",u=u.replace(/^\[[ xX]\] +/,""))),r.items.push({type:"list_item",raw:c,task:!!C,checked:v,loose:!1,text:u,tokens:[]}),r.raw+=c}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd(),r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd(),r.raw=r.raw.trimEnd();for(let l=0;l<r.items.length;l++)if(this.lexer.state.top=!1,r.items[l].tokens=this.lexer.blockTokens(r.items[l].text,[]),!r.loose){const c=r.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>/\n.*\n/.test(d.raw));r.loose=u}if(r.loose)for(let l=0;l<r.items.length;l++)r.items[l].loose=!0;return r}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=u$(t[1]),n=t[2].replace(/^\||\| *$/g,"").split("|"),r=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===n.length){for(const a of n)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<i.length;a++)o.header.push({text:i[a],tokens:this.lexer.inline(i[a]),header:!0,align:o.align[a]});for(const a of r)o.rows.push(u$(a,o.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[c]})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:To(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=o0(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=sDe(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],r=o[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),d$(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const n=(i[2]||i[1]).replace(/\s+/g," "),r=t[n.toLowerCase()];if(!r){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return d$(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(n[1]||n[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const o=[...n[0]].length-1;let a,l,c=o,u=0;const d=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(n=d.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(l=[...a].length,n[3]||n[4]){c+=l;continue}else if((n[5]||n[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const g=[...n[0]][0].length,p=e.slice(0,o+n.index+g+l);if(Math.min(o,l)%2){const C=p.slice(1,-1);return{type:"em",raw:p,text:C,tokens:this.lexer.inlineTokens(C)}}const _=p.slice(2,-2);return{type:"strong",raw:p,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const n=/[^ ]/.test(i),r=/^ /.test(i)&&/ $/.test(i);return n&&r&&(i=i.substring(1,i.length-1)),i=To(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,n;return t[2]==="@"?(i=To(t[1]),n="mailto:"+i):(i=To(t[1]),n=i),{type:"link",raw:t[0],text:i,href:n,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=To(t[0]),r="mailto:"+n;else{let o;do o=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(o!==t[0]);n=To(t[0]),t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=To(t[0]),{type:"text",raw:t[0],text:i}}}}const oDe=/^(?: *(?:\n|$))+/,aDe=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,lDe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Kv=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,cDe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,see=/(?:[*+-]|\d{1,9}[.)])/,ree=Ti(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,see).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Q6=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,hDe=/^[^\n]+/,X6=/(?!\s*\])(?:\\.|[^\[\]\\])+/,uDe=Ti(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",X6).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),dDe=Ti(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,see).getRegex(),PD="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Z6=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,fDe=Ti("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Z6).replace("tag",PD).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),oee=Ti(Q6).replace("hr",Kv).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",PD).getRegex(),gDe=Ti(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",oee).getRegex(),J6={blockquote:gDe,code:aDe,def:uDe,fences:lDe,heading:cDe,hr:Kv,html:fDe,lheading:ree,list:dDe,newline:oDe,paragraph:oee,table:uC,text:hDe},f$=Ti("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Kv).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",PD).getRegex(),mDe={...J6,table:f$,paragraph:Ti(Q6).replace("hr",Kv).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",f$).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",PD).getRegex()},pDe={...J6,html:Ti(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Z6).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:uC,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ti(Q6).replace("hr",Kv).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ree).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},aee=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,_De=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,lee=/^( {2,}|\\)\n(?!\s*$)/,bDe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Yv="\\p{P}\\p{S}",CDe=Ti(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Yv).getRegex(),wDe=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,vDe=Ti(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Yv).getRegex(),yDe=Ti("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Yv).getRegex(),SDe=Ti("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Yv).getRegex(),xDe=Ti(/\\([punct])/,"gu").replace(/punct/g,Yv).getRegex(),LDe=Ti(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),kDe=Ti(Z6).replace("(?:-->|$)","-->").getRegex(),EDe=Ti("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",kDe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Jk=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,DDe=Ti(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Jk).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),cee=Ti(/^!?\[(label)\]\[(ref)\]/).replace("label",Jk).replace("ref",X6).getRegex(),hee=Ti(/^!?\[(ref)\](?:\[\])?/).replace("ref",X6).getRegex(),TDe=Ti("reflink|nolink(?!\\()","g").replace("reflink",cee).replace("nolink",hee).getRegex(),e9={_backpedal:uC,anyPunctuation:xDe,autolink:LDe,blockSkip:wDe,br:lee,code:_De,del:uC,emStrongLDelim:vDe,emStrongRDelimAst:yDe,emStrongRDelimUnd:SDe,escape:aee,link:DDe,nolink:hee,punctuation:CDe,reflink:cee,reflinkSearch:TDe,tag:EDe,text:bDe,url:uC},NDe={...e9,link:Ti(/^!?\[(label)\]\((.*?)\)/).replace("label",Jk).getRegex(),reflink:Ti(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Jk).getRegex()},sO={...e9,escape:Ti(aee).replace("])","~|])").getRegex(),url:Ti(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},IDe={...sO,br:Ti(lee).replace("{2,}","*").getRegex(),text:Ti(sO.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},dx={normal:J6,gfm:mDe,pedantic:pDe},a0={normal:e9,gfm:sO,breaks:IDe,pedantic:NDe};class Ol{constructor(e){Ui(this,"tokens");Ui(this,"options");Ui(this,"state");Ui(this,"tokenizer");Ui(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||pm,this.options.tokenizer=this.options.tokenizer||new Zk,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:dx.normal,inline:a0.normal};this.options.pedantic?(t.block=dx.pedantic,t.inline=a0.pedantic):this.options.gfm&&(t.block=dx.gfm,this.options.breaks?t.inline=a0.breaks:t.inline=a0.gfm),this.tokenizer.rules=t}static get rules(){return{block:dx,inline:a0}}static lex(e,t){return new Ol(t).lex(e)}static lexInline(e,t){return new Ol(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let n,r,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(o=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o))){r=t[t.length-1],i&&(r==null?void 0:r.type)==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),i=o.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,n,r,o=e,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,c)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(r=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let g;this.options.extensions.startInline.forEach(p=>{g=p.call({lexer:this},d),typeof g=="number"&&g>=0&&(u=Math.min(u,g))}),u<1/0&&u>=0&&(r=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(r)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,n=t[t.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}}class Gw{constructor(e){Ui(this,"options");Ui(this,"parser");this.options=e||pm}space(e){return""}code({text:e,lang:t,escaped:i}){var o;const n=(o=(t||"").match(/^\S*/))==null?void 0:o[0],r=e.replace(/\n$/,"")+`
`;return n?'<pre><code class="language-'+To(n)+'">'+(i?r:To(r,!0))+`</code></pre>
`:"<pre><code>"+(i?r:To(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let n="";for(let a=0;a<e.items.length;a++){const l=e.items[a];n+=this.listitem(l)}const r=t?"ol":"ul",o=t&&i!==1?' start="'+i+'"':"";return"<"+r+o+`>
`+n+"</"+r+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let r=0;r<e.header.length;r++)i+=this.tablecell(e.header[r]);t+=this.tablerow({text:i});let n="";for(let r=0;r<e.rows.length;r++){const o=e.rows[r];i="";for(let a=0;a<o.length;a++)i+=this.tablecell(o[a]);n+=this.tablerow({text:i})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const n=this.parser.parseInline(i),r=h$(e);if(r===null)return n;e=r;let o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>",o}image({href:e,title:t,text:i}){const n=h$(e);if(n===null)return i;e=n;let r=`<img src="${e}" alt="${i}"`;return t&&(r+=` title="${t}"`),r+=">",r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class t9{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Pl{constructor(e){Ui(this,"options");Ui(this,"renderer");Ui(this,"textRenderer");this.options=e||pm,this.options.renderer=this.options.renderer||new Gw,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new t9}static parse(e,t){return new Pl(t).parse(e)}static parseInline(e,t){return new Pl(t).parseInline(e)}parse(e,t=!0){let i="";for(let n=0;n<e.length;n++){const r=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=r,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){i+=l||"";continue}}const o=r;switch(o.type){case"space":{i+=this.renderer.space(o);continue}case"hr":{i+=this.renderer.hr(o);continue}case"heading":{i+=this.renderer.heading(o);continue}case"code":{i+=this.renderer.code(o);continue}case"table":{i+=this.renderer.table(o);continue}case"blockquote":{i+=this.renderer.blockquote(o);continue}case"list":{i+=this.renderer.list(o);continue}case"html":{i+=this.renderer.html(o);continue}case"paragraph":{i+=this.renderer.paragraph(o);continue}case"text":{let a=o,l=this.renderer.text(a);for(;n+1<e.length&&e[n+1].type==="text";)a=e[++n],l+=`
`+this.renderer.text(a);t?i+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):i+=l;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let n=0;n<e.length;n++){const r=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=this.options.extensions.renderers[r.type].call({parser:this},r);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){i+=a||"";continue}}const o=r;switch(o.type){case"escape":{i+=t.text(o);break}case"html":{i+=t.html(o);break}case"link":{i+=t.link(o);break}case"image":{i+=t.image(o);break}case"strong":{i+=t.strong(o);break}case"em":{i+=t.em(o);break}case"codespan":{i+=t.codespan(o);break}case"br":{i+=t.br(o);break}case"del":{i+=t.del(o);break}case"text":{i+=t.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}}class dC{constructor(e){Ui(this,"options");this.options=e||pm}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}Ui(dC,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class uee{constructor(...e){Ui(this,"defaults",Y6());Ui(this,"options",this.setOptions);Ui(this,"parse",this.parseMarkdown(Ol.lex,Pl.parse));Ui(this,"parseInline",this.parseMarkdown(Ol.lexInline,Pl.parseInline));Ui(this,"Parser",Pl);Ui(this,"Renderer",Gw);Ui(this,"TextRenderer",t9);Ui(this,"Lexer",Ol);Ui(this,"Tokenizer",Zk);Ui(this,"Hooks",dC);this.use(...e)}walkTokens(e,t){var n,r;let i=[];for(const o of e)switch(i=i.concat(t.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)i=i.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const c of l)i=i.concat(this.walkTokens(c.tokens,t));break}case"list":{const a=o;i=i.concat(this.walkTokens(a.items,t));break}default:{const a=o;(r=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&r[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);i=i.concat(this.walkTokens(c,t))}):a.tokens&&(i=i.concat(this.walkTokens(a.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const n={...i};if(n.async=this.defaults.async||n.async||!1,i.extensions&&(i.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const o=t.renderers[r.name];o?t.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[r.level];o?o.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),n.extensions=t),i.renderer){const r=this.defaults.renderer||new Gw(this.defaults);for(const o in i.renderer){if(!(o in r))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o,l=i.renderer[a],c=r[a];r[a]=(...u)=>{let d=l.apply(r,u);return d===!1&&(d=c.apply(r,u)),d||""}}n.renderer=r}if(i.tokenizer){const r=this.defaults.tokenizer||new Zk(this.defaults);for(const o in i.tokenizer){if(!(o in r))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,l=i.tokenizer[a],c=r[a];r[a]=(...u)=>{let d=l.apply(r,u);return d===!1&&(d=c.apply(r,u)),d}}n.tokenizer=r}if(i.hooks){const r=this.defaults.hooks||new dC;for(const o in i.hooks){if(!(o in r))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,l=i.hooks[a],c=r[a];dC.passThroughHooks.has(o)?r[a]=u=>{if(this.defaults.async)return Promise.resolve(l.call(r,u)).then(g=>c.call(r,g));const d=l.call(r,u);return c.call(r,d)}:r[a]=(...u)=>{let d=l.apply(r,u);return d===!1&&(d=c.apply(r,u)),d}}n.hooks=r}if(i.walkTokens){const r=this.defaults.walkTokens,o=i.walkTokens;n.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),r&&(l=l.concat(r.call(this,a))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ol.lex(e,t??this.defaults)}parser(e,t){return Pl.parse(e,t??this.defaults)}parseMarkdown(e,t){return(n,r)=>{const o={...r},a={...this.defaults,...o},l=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&o.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>t(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(l);try{a.hooks&&(n=a.hooks.preprocess(n));let c=e(n,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let u=t(c,a);return a.hooks&&(u=a.hooks.postprocess(u)),u}catch(c){return l(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const n="<p>An error occurred:</p><pre>"+To(i.message+"",!0)+"</pre>";return t?Promise.resolve(n):n}if(t)return Promise.reject(i);throw i}}}const Kg=new uee;function vi(s,e){return Kg.parse(s,e)}vi.options=vi.setOptions=function(s){return Kg.setOptions(s),vi.defaults=Kg.defaults,tee(vi.defaults),vi};vi.getDefaults=Y6;vi.defaults=pm;vi.use=function(...s){return Kg.use(...s),vi.defaults=Kg.defaults,tee(vi.defaults),vi};vi.walkTokens=function(s,e){return Kg.walkTokens(s,e)};vi.parseInline=Kg.parseInline;vi.Parser=Pl;vi.parser=Pl.parse;vi.Renderer=Gw;vi.TextRenderer=t9;vi.Lexer=Ol;vi.lexer=Ol.lex;vi.Tokenizer=Zk;vi.Hooks=dC;vi.parse=vi;vi.options;vi.setOptions;vi.use;vi.walkTokens;vi.parseInline;const RDe=vi;Pl.parse;const Kw=Ol.lex;function ADe(s){return JSON.stringify(s,MDe)}function rO(s){let e=JSON.parse(s);return e=oO(e),e}function MDe(s,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function oO(s,e=0){if(!s||e>200)return s;if(typeof s=="object"){switch(s.$mid){case 1:return nt.revive(s);case 2:return new RegExp(s.source,s.flags);case 17:return new Date(s.source)}if(s instanceof tD||s instanceof Uint8Array)return s;if(Array.isArray(s))for(let t=0;t<s.length;++t)s[t]=oO(s[t],e+1);else for(const t in s)Object.hasOwnProperty.call(s,t)&&(s[t]=oO(s[t],e+1))}return s}/*! @license DOMPurify 3.2.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.7/LICENSE */const{entries:dee,setPrototypeOf:g$,isFrozen:ODe,getPrototypeOf:PDe,getOwnPropertyDescriptor:FDe}=Object;let{freeze:Tr,seal:ma,create:fee}=Object,{apply:aO,construct:lO}=typeof Reflect<"u"&&Reflect;Tr||(Tr=function(e){return e});ma||(ma=function(e){return e});aO||(aO=function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return e.apply(t,n)});lO||(lO=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return new e(...i)});const fx=Nr(Array.prototype.forEach),BDe=Nr(Array.prototype.lastIndexOf),m$=Nr(Array.prototype.pop),l0=Nr(Array.prototype.push),VDe=Nr(Array.prototype.splice),Zx=Nr(String.prototype.toLowerCase),WR=Nr(String.prototype.toString),HR=Nr(String.prototype.match),c0=Nr(String.prototype.replace),WDe=Nr(String.prototype.indexOf),HDe=Nr(String.prototype.trim),Ta=Nr(Object.prototype.hasOwnProperty),_r=Nr(RegExp.prototype.test),h0=zDe(TypeError);function Nr(s){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return aO(s,e,i)}}function zDe(s){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return lO(s,t)}}function Ht(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zx;g$&&g$(s,null);let i=e.length;for(;i--;){let n=e[i];if(typeof n=="string"){const r=t(n);r!==n&&(ODe(e)||(e[i]=r),n=r)}s[n]=!0}return s}function UDe(s){for(let e=0;e<s.length;e++)Ta(s,e)||(s[e]=null);return s}function zc(s){const e=fee(null);for(const[t,i]of dee(s))Ta(s,t)&&(Array.isArray(i)?e[t]=UDe(i):i&&typeof i=="object"&&i.constructor===Object?e[t]=zc(i):e[t]=i);return e}function u0(s,e){for(;s!==null;){const i=FDe(s,e);if(i){if(i.get)return Nr(i.get);if(typeof i.value=="function")return Nr(i.value)}s=PDe(s)}function t(){return null}return t}const p$=Tr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),zR=Tr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","slot","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),UR=Tr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),jDe=Tr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jR=Tr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),$De=Tr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_$=Tr(["#text"]),b$=Tr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),$R=Tr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),C$=Tr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),gx=Tr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qDe=ma(/\{\{[\w\W]*|[\w\W]*\}\}/gm),GDe=ma(/<%[\w\W]*|[\w\W]*%>/gm),KDe=ma(/\$\{[\w\W]*/gm),YDe=ma(/^data-[\-\w.\u00B7-\uFFFF]+$/),QDe=ma(/^aria-[\-\w]+$/),gee=ma(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),XDe=ma(/^(?:\w+script|data):/i),ZDe=ma(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mee=ma(/^html$/i),JDe=ma(/^[a-z][.\w]*(-[.\w]+)+$/i);var w$=Object.freeze({__proto__:null,ARIA_ATTR:QDe,ATTR_WHITESPACE:ZDe,CUSTOM_ELEMENT:JDe,DATA_ATTR:YDe,DOCTYPE_NAME:mee,ERB_EXPR:GDe,IS_ALLOWED_URI:gee,IS_SCRIPT_OR_DATA:XDe,MUSTACHE_EXPR:qDe,TMPLIT_EXPR:KDe});const d0={element:1,text:3,progressingInstruction:7,comment:8,document:9},eTe=function(){return typeof window>"u"?null:window},tTe=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}},v$=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function pee(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eTe();const e=Ze=>pee(Ze);if(e.version="3.2.7",e.removed=[],!s||!s.document||s.document.nodeType!==d0.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const i=t,n=i.currentScript,{DocumentFragment:r,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:d,DOMParser:g,trustedTypes:p}=s,_=l.prototype,C=u0(_,"cloneNode"),v=u0(_,"remove"),x=u0(_,"nextSibling"),S=u0(_,"childNodes"),k=u0(_,"parentNode");if(typeof o=="function"){const Ze=t.createElement("template");Ze.content&&Ze.content.ownerDocument&&(t=Ze.content.ownerDocument)}let E,T="";const{implementation:R,createNodeIterator:N,createDocumentFragment:A,getElementsByTagName:O}=t,{importNode:W}=i;let j=v$();e.isSupported=typeof dee=="function"&&typeof k=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:F,ERB_EXPR:q,TMPLIT_EXPR:Z,DATA_ATTR:K,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:le}=w$;let{IS_ALLOWED_URI:ve}=w$,V=null;const ce=Ht({},[...p$,...zR,...UR,...jR,..._$]);let oe=null;const Se=Ht({},[...b$,...$R,...C$,...gx]);let me=Object.seal(fee(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,it=null,Xe=!0,lt=!0,xs=!1,nl=!0,zi=!1,Rr=!0,fr=!1,Dd=!1,Td=!1,jh=!1,Nd=!1,$h=!1,vm=!0,ym=!1;const ZD="user-content-";let K1=!0,ts=!1,qh={},cc=null;const Y1=Ht({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Id=null;const sy=Ht({},["audio","video","img","source","image","track"]);let Sm=null;const ry=Ht({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xm="http://www.w3.org/1998/Math/MathML",sl="http://www.w3.org/2000/svg",on="http://www.w3.org/1999/xhtml";let gr=on,Ls=!1,Q1=null;const JD=Ht({},[xm,sl,on],WR);let Lm=Ht({},["mi","mo","mn","ms","mtext"]),hc=Ht({},["annotation-xml"]);const km=Ht({},["title","style","font","a","script"]);let rl=null;const uc=["application/xhtml+xml","text/html"],Em="text/html";let Ji=null,Gh=null;const oy=t.createElement("form"),Dm=function(te){return te instanceof RegExp||te instanceof Function},dc=function(){let te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Gh&&Gh===te)){if((!te||typeof te!="object")&&(te={}),te=zc(te),rl=uc.indexOf(te.PARSER_MEDIA_TYPE)===-1?Em:te.PARSER_MEDIA_TYPE,Ji=rl==="application/xhtml+xml"?WR:Zx,V=Ta(te,"ALLOWED_TAGS")?Ht({},te.ALLOWED_TAGS,Ji):ce,oe=Ta(te,"ALLOWED_ATTR")?Ht({},te.ALLOWED_ATTR,Ji):Se,Q1=Ta(te,"ALLOWED_NAMESPACES")?Ht({},te.ALLOWED_NAMESPACES,WR):JD,Sm=Ta(te,"ADD_URI_SAFE_ATTR")?Ht(zc(ry),te.ADD_URI_SAFE_ATTR,Ji):ry,Id=Ta(te,"ADD_DATA_URI_TAGS")?Ht(zc(sy),te.ADD_DATA_URI_TAGS,Ji):sy,cc=Ta(te,"FORBID_CONTENTS")?Ht({},te.FORBID_CONTENTS,Ji):Y1,Oe=Ta(te,"FORBID_TAGS")?Ht({},te.FORBID_TAGS,Ji):zc({}),it=Ta(te,"FORBID_ATTR")?Ht({},te.FORBID_ATTR,Ji):zc({}),qh=Ta(te,"USE_PROFILES")?te.USE_PROFILES:!1,Xe=te.ALLOW_ARIA_ATTR!==!1,lt=te.ALLOW_DATA_ATTR!==!1,xs=te.ALLOW_UNKNOWN_PROTOCOLS||!1,nl=te.ALLOW_SELF_CLOSE_IN_ATTR!==!1,zi=te.SAFE_FOR_TEMPLATES||!1,Rr=te.SAFE_FOR_XML!==!1,fr=te.WHOLE_DOCUMENT||!1,jh=te.RETURN_DOM||!1,Nd=te.RETURN_DOM_FRAGMENT||!1,$h=te.RETURN_TRUSTED_TYPE||!1,Td=te.FORCE_BODY||!1,vm=te.SANITIZE_DOM!==!1,ym=te.SANITIZE_NAMED_PROPS||!1,K1=te.KEEP_CONTENT!==!1,ts=te.IN_PLACE||!1,ve=te.ALLOWED_URI_REGEXP||gee,gr=te.NAMESPACE||on,Lm=te.MATHML_TEXT_INTEGRATION_POINTS||Lm,hc=te.HTML_INTEGRATION_POINTS||hc,me=te.CUSTOM_ELEMENT_HANDLING||{},te.CUSTOM_ELEMENT_HANDLING&&Dm(te.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(me.tagNameCheck=te.CUSTOM_ELEMENT_HANDLING.tagNameCheck),te.CUSTOM_ELEMENT_HANDLING&&Dm(te.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(me.attributeNameCheck=te.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),te.CUSTOM_ELEMENT_HANDLING&&typeof te.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(me.allowCustomizedBuiltInElements=te.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),zi&&(lt=!1),Nd&&(jh=!0),qh&&(V=Ht({},_$),oe=[],qh.html===!0&&(Ht(V,p$),Ht(oe,b$)),qh.svg===!0&&(Ht(V,zR),Ht(oe,$R),Ht(oe,gx)),qh.svgFilters===!0&&(Ht(V,UR),Ht(oe,$R),Ht(oe,gx)),qh.mathMl===!0&&(Ht(V,jR),Ht(oe,C$),Ht(oe,gx))),te.ADD_TAGS&&(V===ce&&(V=zc(V)),Ht(V,te.ADD_TAGS,Ji)),te.ADD_ATTR&&(oe===Se&&(oe=zc(oe)),Ht(oe,te.ADD_ATTR,Ji)),te.ADD_URI_SAFE_ATTR&&Ht(Sm,te.ADD_URI_SAFE_ATTR,Ji),te.FORBID_CONTENTS&&(cc===Y1&&(cc=zc(cc)),Ht(cc,te.FORBID_CONTENTS,Ji)),K1&&(V["#text"]=!0),fr&&Ht(V,["html","head","body"]),V.table&&(Ht(V,["tbody"]),delete Oe.tbody),te.TRUSTED_TYPES_POLICY){if(typeof te.TRUSTED_TYPES_POLICY.createHTML!="function")throw h0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof te.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw h0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=te.TRUSTED_TYPES_POLICY,T=E.createHTML("")}else E===void 0&&(E=tTe(p,n)),E!==null&&typeof T=="string"&&(T=E.createHTML(""));Tr&&Tr(te),Gh=te}},ay=Ht({},[...zR,...UR,...jDe]),X1=Ht({},[...jR,...$De]),ly=function(te){let Te=k(te);(!Te||!Te.tagName)&&(Te={namespaceURI:gr,tagName:"template"});const ze=Zx(te.tagName),di=Zx(Te.tagName);return Q1[te.namespaceURI]?te.namespaceURI===sl?Te.namespaceURI===on?ze==="svg":Te.namespaceURI===xm?ze==="svg"&&(di==="annotation-xml"||Lm[di]):!!ay[ze]:te.namespaceURI===xm?Te.namespaceURI===on?ze==="math":Te.namespaceURI===sl?ze==="math"&&hc[di]:!!X1[ze]:te.namespaceURI===on?Te.namespaceURI===sl&&!hc[di]||Te.namespaceURI===xm&&!Lm[di]?!1:!X1[ze]&&(km[ze]||!ay[ze]):!!(rl==="application/xhtml+xml"&&Q1[te.namespaceURI]):!1},fo=function(te){l0(e.removed,{element:te});try{k(te).removeChild(te)}catch{v(te)}},Ca=function(te,Te){try{l0(e.removed,{attribute:Te.getAttributeNode(te),from:Te})}catch{l0(e.removed,{attribute:null,from:Te})}if(Te.removeAttribute(te),te==="is")if(jh||Nd)try{fo(Te)}catch{}else try{Te.setAttribute(te,"")}catch{}},Tm=function(te){let Te=null,ze=null;if(Td)te="<remove></remove>"+te;else{const Ii=HR(te,/^[\r\n\t ]+/);ze=Ii&&Ii[0]}rl==="application/xhtml+xml"&&gr===on&&(te='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+te+"</body></html>");const di=E?E.createHTML(te):te;if(gr===on)try{Te=new g().parseFromString(di,rl)}catch{}if(!Te||!Te.documentElement){Te=R.createDocument(gr,"template",null);try{Te.documentElement.innerHTML=Ls?T:di}catch{}}const mn=Te.body||Te.documentElement;return te&&ze&&mn.insertBefore(t.createTextNode(ze),mn.childNodes[0]||null),gr===on?O.call(Te,fr?"html":"body")[0]:fr?Te.documentElement:mn},Z1=function(te){return N.call(te.ownerDocument||te,te,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Nm=function(te){return te instanceof d&&(typeof te.nodeName!="string"||typeof te.textContent!="string"||typeof te.removeChild!="function"||!(te.attributes instanceof u)||typeof te.removeAttribute!="function"||typeof te.setAttribute!="function"||typeof te.namespaceURI!="string"||typeof te.insertBefore!="function"||typeof te.hasChildNodes!="function")},wa=function(te){return typeof a=="function"&&te instanceof a};function Ni(Ze,te,Te){fx(Ze,ze=>{ze.call(e,te,Te,Gh)})}const ks=function(te){let Te=null;if(Ni(j.beforeSanitizeElements,te,null),Nm(te))return fo(te),!0;const ze=Ji(te.nodeName);if(Ni(j.uponSanitizeElement,te,{tagName:ze,allowedTags:V}),Rr&&te.hasChildNodes()&&!wa(te.firstElementChild)&&_r(/<[/\w!]/g,te.innerHTML)&&_r(/<[/\w!]/g,te.textContent)||te.nodeType===d0.progressingInstruction||Rr&&te.nodeType===d0.comment&&_r(/<[/\w]/g,te.data))return fo(te),!0;if(!V[ze]||Oe[ze]){if(!Oe[ze]&&Im(ze)&&(me.tagNameCheck instanceof RegExp&&_r(me.tagNameCheck,ze)||me.tagNameCheck instanceof Function&&me.tagNameCheck(ze)))return!1;if(K1&&!cc[ze]){const di=k(te)||te.parentNode,mn=S(te)||te.childNodes;if(mn&&di){const Ii=mn.length;for(let ni=Ii-1;ni>=0;--ni){const zo=C(mn[ni],!0);zo.__removalCount=(te.__removalCount||0)+1,di.insertBefore(zo,x(te))}}}return fo(te),!0}return te instanceof l&&!ly(te)||(ze==="noscript"||ze==="noembed"||ze==="noframes")&&_r(/<\/no(script|embed|frames)/i,te.innerHTML)?(fo(te),!0):(zi&&te.nodeType===d0.text&&(Te=te.textContent,fx([F,q,Z],di=>{Te=c0(Te,di," ")}),te.textContent!==Te&&(l0(e.removed,{element:te.cloneNode()}),te.textContent=Te)),Ni(j.afterSanitizeElements,te,null),!1)},fc=function(te,Te,ze){if(vm&&(Te==="id"||Te==="name")&&(ze in t||ze in oy))return!1;if(!(lt&&!it[Te]&&_r(K,Te))){if(!(Xe&&_r(U,Te))){if(!oe[Te]||it[Te]){if(!(Im(te)&&(me.tagNameCheck instanceof RegExp&&_r(me.tagNameCheck,te)||me.tagNameCheck instanceof Function&&me.tagNameCheck(te))&&(me.attributeNameCheck instanceof RegExp&&_r(me.attributeNameCheck,Te)||me.attributeNameCheck instanceof Function&&me.attributeNameCheck(Te,te))||Te==="is"&&me.allowCustomizedBuiltInElements&&(me.tagNameCheck instanceof RegExp&&_r(me.tagNameCheck,ze)||me.tagNameCheck instanceof Function&&me.tagNameCheck(ze))))return!1}else if(!Sm[Te]){if(!_r(ve,c0(ze,Q,""))){if(!((Te==="src"||Te==="xlink:href"||Te==="href")&&te!=="script"&&WDe(ze,"data:")===0&&Id[te])){if(!(xs&&!_r(G,c0(ze,Q,"")))){if(ze)return!1}}}}}}return!0},Im=function(te){return te!=="annotation-xml"&&HR(te,le)},cy=function(te){Ni(j.beforeSanitizeAttributes,te,null);const{attributes:Te}=te;if(!Te||Nm(te))return;const ze={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:oe,forceKeepAttr:void 0};let di=Te.length;for(;di--;){const mn=Te[di],{name:Ii,namespaceURI:ni,value:zo}=mn,gc=Ji(Ii),va=zo;let en=Ii==="value"?va:HDe(va);if(ze.attrName=gc,ze.attrValue=en,ze.keepAttr=!0,ze.forceKeepAttr=void 0,Ni(j.uponSanitizeAttribute,te,ze),en=ze.attrValue,ym&&(gc==="id"||gc==="name")&&(Ca(Ii,te),en=ZD+en),Rr&&_r(/((--!?|])>)|<\/(style|title|textarea)/i,en)){Ca(Ii,te);continue}if(gc==="attributename"&&HR(en,"href")){Ca(Ii,te);continue}if(ze.forceKeepAttr)continue;if(!ze.keepAttr){Ca(Ii,te);continue}if(!nl&&_r(/\/>/i,en)){Ca(Ii,te);continue}zi&&fx([F,q,Z],J1=>{en=c0(en,J1," ")});const hy=Ji(te.nodeName);if(!fc(hy,gc,en)){Ca(Ii,te);continue}if(E&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!ni)switch(p.getAttributeType(hy,gc)){case"TrustedHTML":{en=E.createHTML(en);break}case"TrustedScriptURL":{en=E.createScriptURL(en);break}}if(en!==va)try{ni?te.setAttributeNS(ni,Ii,en):te.setAttribute(Ii,en),Nm(te)?fo(te):m$(e.removed)}catch{Ca(Ii,te)}}Ni(j.afterSanitizeAttributes,te,null)},eT=function Ze(te){let Te=null;const ze=Z1(te);for(Ni(j.beforeSanitizeShadowDOM,te,null);Te=ze.nextNode();)Ni(j.uponSanitizeShadowNode,Te,null),ks(Te),cy(Te),Te.content instanceof r&&Ze(Te.content);Ni(j.afterSanitizeShadowDOM,te,null)};return e.sanitize=function(Ze){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Te=null,ze=null,di=null,mn=null;if(Ls=!Ze,Ls&&(Ze="<!-->"),typeof Ze!="string"&&!wa(Ze))if(typeof Ze.toString=="function"){if(Ze=Ze.toString(),typeof Ze!="string")throw h0("dirty is not a string, aborting")}else throw h0("toString is not a function");if(!e.isSupported)return Ze;if(Dd||dc(te),e.removed=[],typeof Ze=="string"&&(ts=!1),ts){if(Ze.nodeName){const zo=Ji(Ze.nodeName);if(!V[zo]||Oe[zo])throw h0("root node is forbidden and cannot be sanitized in-place")}}else if(Ze instanceof a)Te=Tm("<!---->"),ze=Te.ownerDocument.importNode(Ze,!0),ze.nodeType===d0.element&&ze.nodeName==="BODY"||ze.nodeName==="HTML"?Te=ze:Te.appendChild(ze);else{if(!jh&&!zi&&!fr&&Ze.indexOf("<")===-1)return E&&$h?E.createHTML(Ze):Ze;if(Te=Tm(Ze),!Te)return jh?null:$h?T:""}Te&&Td&&fo(Te.firstChild);const Ii=Z1(ts?Ze:Te);for(;di=Ii.nextNode();)ks(di),cy(di),di.content instanceof r&&eT(di.content);if(ts)return Ze;if(jh){if(Nd)for(mn=A.call(Te.ownerDocument);Te.firstChild;)mn.appendChild(Te.firstChild);else mn=Te;return(oe.shadowroot||oe.shadowrootmode)&&(mn=W.call(i,mn,!0)),mn}let ni=fr?Te.outerHTML:Te.innerHTML;return fr&&V["!doctype"]&&Te.ownerDocument&&Te.ownerDocument.doctype&&Te.ownerDocument.doctype.name&&_r(mee,Te.ownerDocument.doctype.name)&&(ni="<!DOCTYPE "+Te.ownerDocument.doctype.name+`>
`+ni),zi&&fx([F,q,Z],zo=>{ni=c0(ni,zo," ")}),E&&$h?E.createHTML(ni):ni},e.setConfig=function(){let Ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};dc(Ze),Dd=!0},e.clearConfig=function(){Gh=null,Dd=!1},e.isValidAttribute=function(Ze,te,Te){Gh||dc({});const ze=Ji(Ze),di=Ji(te);return fc(ze,di,Te)},e.addHook=function(Ze,te){typeof te=="function"&&l0(j[Ze],te)},e.removeHook=function(Ze,te){if(te!==void 0){const Te=BDe(j[Ze],te);return Te===-1?void 0:VDe(j[Ze],Te,1)[0]}return m$(j[Ze])},e.removeHooks=function(Ze){j[Ze]=[]},e.removeAllHooks=function(){j=v$()},e}var Tp=pee();const _ee=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","s","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),bee=Object.freeze(["href","target","src","alt","title","for","name","role","tabindex","x-dispatch","required","checked","placeholder","type","start","width","height","align"]),qR="vscode-relative-path";function y$(s,e){if(e.override==="*")return!0;try{const t=new URL(s,qR+"://");return!!(e.override.includes(t.protocol.replace(/:$/,""))||e.allowRelativePaths&&t.protocol===qR+":"&&!s.trim().toLowerCase().startsWith(qR))}catch{return!1}}function iTe(s,e){Tp.addHook("afterSanitizeAttributes",t=>{for(const i of["href","src"])if(t.hasAttribute(i)){const n=t.getAttribute(i);i==="href"?!n.startsWith("#")&&!y$(n,s)&&t.removeAttribute(i):y$(n,e)||t.removeAttribute(i)}})}const nTe=Object.freeze({ALLOWED_TAGS:[..._ee],ALLOWED_ATTR:[...bee],ALLOW_UNKNOWN_PROTOCOLS:!0});function sTe(s,e){return Cee(s,e,"trusted")}function Cee(s,e,t){var i,n;try{const r={...nTe};e!=null&&e.allowedTags&&(e.allowedTags.override&&(r.ALLOWED_TAGS=[...e.allowedTags.override]),e.allowedTags.augment&&(r.ALLOWED_TAGS=[...r.ALLOWED_TAGS??[],...e.allowedTags.augment]));let o=[...bee];e!=null&&e.allowedAttributes&&(e.allowedAttributes.override&&(o=[...e.allowedAttributes.override]),e.allowedAttributes.augment&&(o=[...o,...e.allowedAttributes.augment])),o=o.map(c=>typeof c=="string"?c.toLowerCase():{attributeName:c.attributeName.toLowerCase(),shouldKeep:c.shouldKeep});const a=new Set(o.map(c=>typeof c=="string"?c:c.attributeName)),l=new Map;for(const c of o)typeof c=="string"?l.delete(c):l.set(c.attributeName,c);return r.ALLOWED_ATTR=Array.from(a),iTe({override:((i=e==null?void 0:e.allowedLinkProtocols)==null?void 0:i.override)??[je.http,je.https],allowRelativePaths:(e==null?void 0:e.allowRelativeLinkPaths)??!1},{override:((n=e==null?void 0:e.allowedMediaProtocols)==null?void 0:n.override)??[je.http,je.https],allowRelativePaths:(e==null?void 0:e.allowRelativeMediaPaths)??!1}),e!=null&&e.replaceWithPlaintext&&Tp.addHook("uponSanitizeElement",oTe),l.size&&Tp.addHook("uponSanitizeAttribute",(c,u)=>{const d=l.get(u.attrName);if(d){const g=d.shouldKeep(c,u);typeof g=="string"?(u.keepAttr=!0,u.attrValue=g):u.keepAttr=g}else u.keepAttr=a.has(u.attrName)}),t==="dom"?Tp.sanitize(s,{...r,RETURN_DOM_FRAGMENT:!0}):Tp.sanitize(s,{...r,RETURN_TRUSTED_TYPE:!0})}finally{Tp.removeAllHooks()}}const rTe=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],oTe=(s,e,t)=>{var i,n;if(!e.allowedTags[e.tagName]&&e.tagName!=="body"){const r=wee(s);r&&(s.nodeType===Node.COMMENT_NODE?(i=s.parentElement)==null||i.insertBefore(r,s):(n=s.parentElement)==null||n.replaceChild(r,s))}};function wee(s){if(!s.ownerDocument)return;let e,t;if(s.nodeType===Node.COMMENT_NODE)e=`<!--${s.textContent}-->`;else if(s instanceof Element){const o=s.tagName.toLowerCase(),a=rTe.includes(o),l=s.attributes.length?" "+Array.from(s.attributes).map(c=>`${c.name}="${c.value}"`).join(" "):"";e=`<${o}${l}>`,a||(t=`</${o}>`)}else return;const i=document.createDocumentFragment(),n=s.ownerDocument.createTextNode(e);for(i.appendChild(n);s.firstChild;)i.appendChild(s.firstChild);const r=t?s.ownerDocument.createTextNode(t):void 0;return r&&i.appendChild(r),i}function vee(s,e,t){const i=Cee(e,t,"dom");as(s,i)}const aTe=new RegExp(`(\\\\)?\\$\\((${ht.iconNameExpression}(?:${ht.iconModifierExpression})?)\\)`,"g");function dg(s){const e=new Array;let t,i=0,n=0;for(;(t=aTe.exec(s))!==null;){n=t.index||0,i<n&&e.push(s.substring(i,n)),i=(t.index||0)+t[0].length;const[,r,o]=t;e.push(r?`$(${o})`:Yw({id:o}))}return i<s.length&&e.push(s.substring(i)),e}function Yw(s){const e=Ve("span");return e.classList.add(...ht.asClassNameArray(s)),e}const GR=Object.freeze({image:({href:s,title:e,text:t})=>{let i=[],n=[];return s&&({href:s,dimensions:i}=J2e(s),n.push(`src="${ux(s)}"`)),t&&n.push(`alt="${ux(t)}"`),e&&n.push(`title="${ux(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>`},link({href:s,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof s!="string"?"":(s===i&&(i=VR(i)),e=typeof e=="string"?ux(VR(e)):"",s=VR(s),s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${s}" title="${e||s}" draggable="false">${i}</a>`)}});function lTe(s){return function(e){const{tokens:t}=e,i=t[0];if((i==null?void 0:i.type)!=="paragraph")return s.call(this,e);const n=i.tokens;if(!n||n.length===0)return s.call(this,e);const r=n[0];if((r==null?void 0:r.type)!=="text")return s.call(this,e);const o=/^\s*\[!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]\s*?\n*/i,a=r.raw.match(o);if(!a)return s.call(this,e);r.raw=r.raw.replace(o,""),r.text=r.text.replace(o,"");const l={note:"info",tip:"light-bulb",important:"comment",warning:"alert",caution:"stop"},c=a[1],u=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),d=c.toLowerCase(),g=Yw({id:l[d]}).outerHTML,p=this.parser.parse(t);return`<blockquote data-severity="${d}"><p><span>${g}${u}</span>${p.substring(3)}</blockquote>
`}}function i9(s,e={},t){var _,C,v;const i=new Ee;let n=!1;const r=new uee(...e.markedExtensions??[]),{renderer:o,codeBlocks:a,syncCodeBlocks:l}=hTe(r,e,s),c=uTe(s);let u;if(e.fillInIncompleteTokens){const x={...r.defaults,...e.markedOptions,renderer:o},S=r.lexer(c,x),k=xTe(S);u=r.parser(k,x)}else u=r.parse(c,{...e==null?void 0:e.markedOptions,renderer:o,async:!1});s.supportThemeIcons&&(u=dg(u).map(S=>typeof S=="string"?S:S.outerHTML).join(""));const d=document.createElement("div"),g=yee(s,e.sanitizerConfig??{});vee(d,u,g),cTe(s,e,d);let p;if(t?(p=t,as(t,...d.children)):p=d,a.length>0)Promise.all(a).then(x=>{var E;if(n)return;const S=new Map(x),k=p.querySelectorAll("div[data-code]");for(const T of k){const R=S.get(T.dataset.code??"");R&&as(T,R)}(E=e.asyncRenderCallback)==null||E.call(e)});else if(l.length>0){const x=new Map(l),S=p.querySelectorAll("div[data-code]");for(const k of S){const E=x.get(k.dataset.code??"");E&&as(k,E)}}if(e.asyncRenderCallback)for(const x of p.getElementsByTagName("img")){const S=i.add(J(x,"load",()=>{S.dispose(),e.asyncRenderCallback()}))}if(e.actionHandler){const x=S=>{const k=new io(Ae(p),S);!k.leftButton&&!k.middleButton||S$(s,e,k)};i.add(J(p,"click",x)),i.add(J(p,"auxclick",x)),i.add(J(p,"keydown",S=>{const k=new jt(S);!k.equals(10)&&!k.equals(3)||S$(s,e,k)}))}for(const x of[...p.getElementsByTagName("input")])if(((_=x.attributes.getNamedItem("type"))==null?void 0:_.value)==="checkbox")x.setAttribute("disabled","");else if((C=e.sanitizerConfig)!=null&&C.replaceWithPlaintext){const S=wee(x);S?(v=x.parentElement)==null||v.replaceChild(S,x):x.remove()}else x.remove();return{element:p,dispose:()=>{n=!0,i.dispose()}}}function cTe(s,e,t){var i;for(const n of t.querySelectorAll("img, audio, video, source")){const r=n.getAttribute("src");if(r){let o=r;try{s.baseUri&&(o=cO(nt.from(s.baseUri),o))}catch{}if(n.setAttribute("src",x$(s,o,!0)),(i=e.sanitizerConfig)!=null&&i.remoteImageIsAllowed){const a=nt.parse(o);a.scheme!==je.file&&a.scheme!==je.data&&!e.sanitizerConfig.remoteImageIsAllowed(a)&&n.replaceWith(Ve("",void 0,n.outerHTML))}}}for(const n of t.querySelectorAll("a")){const r=n.getAttribute("href");if(n.setAttribute("href",""),!r||/^data:|javascript:/i.test(r)||/^command:/i.test(r)&&!s.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(r))n.replaceWith(...n.childNodes);else{let o=x$(s,r,!1);s.baseUri&&(o=cO(nt.from(s.baseUri),r)),n.dataset.href=o}}}function hTe(s,e,t){const i=new s.Renderer(e.markedOptions);i.image=GR.image,i.link=GR.link,i.paragraph=GR.paragraph,t.supportAlertSyntax&&(i.blockquote=lTe(i.blockquote));const n=[],r=[];return e.codeBlockRendererSync?i.code=({text:o,lang:a,raw:l})=>{const c=l$.nextId(),u=e.codeBlockRendererSync(L$(a),o,l);return r.push([c,u]),`<div class="code" data-code="${c}">${ua(o)}</div>`}:e.codeBlockRenderer&&(i.code=({text:o,lang:a})=>{const l=l$.nextId(),c=e.codeBlockRenderer(L$(a),o);return n.push(c.then(u=>[l,u])),`<div class="code" data-code="${l}">${ua(o)}</div>`}),t.supportHtml||(i.html=({text:o})=>{var l;return(l=e.sanitizerConfig)!=null&&l.replaceWithPlaintext?ua(o):(t.isTrusted?o.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?o:""}),{renderer:i,codeBlocks:n,syncCodeBlocks:r}}function uTe(s){let e=s.value;return e.length>1e5&&(e=`${e.substr(0,1e5)}`),s.supportThemeIcons&&(e=K2e(e)),e}function S$(s,e,t){var n;const i=t.target.closest("a[data-href]");if(Wi(i))try{let r=i.dataset.href;r&&(s.baseUri&&(r=cO(nt.from(s.baseUri),r)),(n=e.actionHandler)==null||n.call(e,r,s))}catch(r){It(r)}finally{t.preventDefault()}}function dTe(s,e){let t;try{t=rO(decodeURIComponent(e))}catch{}return t?(t=tQ(t,i=>{if(s.uris&&s.uris[i])return nt.revive(s.uris[i])}),encodeURIComponent(JSON.stringify(t))):e}function x$(s,e,t){const i=s.uris&&s.uris[e];let n=nt.revive(i);return t?e.startsWith(je.data+":")?e:(n||(n=nt.parse(e)),VQ.uriToBrowserUri(n).toString(!0)):!n||nt.parse(e).toString()===n.toString()?e:(n.query&&(n=n.with({query:dTe(s,n.query)})),n.toString())}function L$(s){if(!s)return"";const e=s.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:s}function cO(s,e){return/^\w[\w\d+.-]*:/.test(e)?e:s.path.endsWith("/")?gz(s,e).toString():gz(U_e(s),e).toString()}function fTe(s,e,t={}){const i=yee(e,t);return sTe(s,i)}const gTe=Object.freeze([..._ee,"input"]),mTe=Object.freeze(["align","autoplay","alt","colspan","controls","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","target","title","type","width","start","checked","disabled","value","data-code","data-href","data-severity",{attributeName:"style",shouldKeep:(s,e)=>s.tagName==="SPAN"&&e.attrName==="style"?/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(e.attrValue):!1},{attributeName:"class",shouldKeep:(s,e)=>s.tagName==="SPAN"&&e.attrName==="class"?/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(e.attrValue):!1}]);function yee(s,e){var n,r,o;const t=s.isTrusted??!1,i=[je.http,je.https,je.mailto,je.file,je.vscodeFileResource,je.vscodeRemote,je.vscodeRemoteResource,je.vscodeNotebookCell];return t&&i.push(je.command),(n=e.allowedLinkSchemes)!=null&&n.augment&&i.push(...e.allowedLinkSchemes.augment),{allowedTags:{override:((r=e.allowedTags)==null?void 0:r.override)??gTe},allowedAttributes:{override:((o=e.allowedAttributes)==null?void 0:o.override)??mTe},allowedLinkProtocols:{override:i},allowRelativeLinkPaths:!!s.baseUri,allowedMediaProtocols:{override:[je.http,je.https,je.data,je.file,je.vscodeFileResource,je.vscodeRemote,je.vscodeRemoteResource]},allowRelativeMediaPaths:!!s.baseUri,replaceWithPlaintext:e.replaceWithPlaintext}}function pTe(s,e){if(typeof s=="string")return s;let t=s.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}`);const i=RDe(t,{async:!1,renderer:bTe.value});return fTe(i,{isTrusted:!1},{}).toString().replace(/&(#\d+|[a-zA-Z]+);/g,n=>_Te.get(n)??n).trim()}const _Te=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function See(){const s=new Gw;return s.code=({text:e})=>ua(e),s.blockquote=({text:e})=>e+`
`,s.html=e=>"",s.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.hr=()=>"",s.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},s.listitem=({text:e})=>e+`
`,s.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},s.tablerow=({text:e})=>e,s.tablecell=function({tokens:e}){return this.parser.parseInline(e)},s.strong=({text:e})=>e,s.em=({text:e})=>e,s.codespan=({text:e})=>ua(e),s.br=e=>`
`,s.del=({text:e})=>e,s.image=e=>"",s.text=({text:e})=>e,s.link=({text:e})=>e,s}const bTe=new Ws(See);new Ws(()=>{const s=See();return s.code=({text:e})=>`
\`\`\`
${ua(e)}
\`\`\`
`,s});function Qw(s){let e="";return s.forEach(t=>{e+=t.raw}),e}function xee(s){var e,t;if(s.tokens)for(let i=s.tokens.length-1;i>=0;i--){const n=s.tokens[i];if(n.type==="text"){const r=n.raw.split(`
`),o=r[r.length-1];if(o.includes("`"))return kTe(s);if(o.includes("**"))return RTe(s);if(o.match(/\*\w/))return ETe(s);if(o.match(/(^|\s)__\w/))return ATe(s);if(o.match(/(^|\s)_\w/))return DTe(s);if(CTe(o)||wTe(o)&&s.tokens.slice(0,i).some(a=>a.type==="text"&&a.raw.match(/\[[^\]]*$/))){const a=s.tokens.slice(i+1);return((e=a[0])==null?void 0:e.type)==="link"&&((t=a[1])==null?void 0:t.type)==="text"&&a[1].raw.match(/^ *"[^"]*$/)||o.match(/^[^"]* +"[^"]*$/)?NTe(s):TTe(s)}else if(o.match(/(^|\s)\[\w*[^\]]*$/))return ITe(s)}}}function CTe(s){return!!s.match(/(^|\s)\[.*\]\(\w*/)}function wTe(s){return!!s.match(/^[^\[]*\]\([^\)]*$/)}function vTe(s){var c;const e=s.items[s.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,i=u=>{const d=u.items.at(-1),g=d==null?void 0:d.tokens.at(-1);return(g==null?void 0:g.type)==="heading"||(g==null?void 0:g.type)==="list"&&i(g)};let n;if((t==null?void 0:t.type)==="text"&&!("inRawBlock"in e))n=xee(t);else if(i(s)){const u=Kw(s.raw.trim()+" &nbsp;")[0];return u.type!=="list"?void 0:u}if(!n||n.type!=="paragraph")return;const r=Qw(s.items.slice(0,-1)),o=(c=e.raw.match(/^(\s*(-|\d+\.|\*) +)/))==null?void 0:c[0];if(!o)return;const a=o+Qw(e.tokens.slice(0,-1))+n.raw,l=Kw(r+a)[0];if(l.type==="list")return l}function yTe(s,e){if(s.raw.match(/-\s*$/))return Kw(e+" &nbsp;")}const STe=3;function xTe(s){for(let e=0;e<STe;e++){const t=LTe(s);if(t)s=t;else break}return s}function LTe(s){let e,t;for(e=0;e<s.length;e++){const n=s[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=MTe(s.slice(e));break}}const i=s.at(-1);if(!t&&(i==null?void 0:i.type)==="list"){const n=vTe(i);n&&(t=[n],e=s.length-1)}if(!t&&(i==null?void 0:i.type)==="paragraph"){const n=xee(i);n&&(t=[n],e=s.length-1)}if(t){const n=[...s.slice(0,e),...t];return n.links=s.links,n}if((i==null?void 0:i.type)==="heading"){const n=yTe(i,Qw(s));if(n)return n}return null}function kTe(s){return xd(s,"`")}function ETe(s){return xd(s,"*")}function DTe(s){return xd(s,"_")}function TTe(s){return xd(s,")",!1)}function NTe(s){return xd(s,'")',!1)}function ITe(s){return xd(s,"](https://microsoft.com)",!1)}function RTe(s){return xd(s,"**")}function ATe(s){return xd(s,"__")}function xd(s,e,t=!0){const i=Qw(Array.isArray(s)?s:[s]),n=t?i.trimEnd():i;return Kw(n+e)[0]}function MTe(s){const e=Qw(s),t=e.split(`
`);let i,n=!1;for(let r=0;r<t.length;r++){const o=t[r].trim();if(typeof i>"u"&&o.match(/^\s*\|/)){const a=o.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(o.match(/^\s*\|/)){if(r!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){const r=n?t.slice(0,-1).join(`
`):e,o=!!r.match(/\|\s*$/),a=r+(o?"":"|")+`
|${" --- |".repeat(i)}`;return Kw(a)}}const FD=tt("openerService");function OTe(s){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(s.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},s=s.with({fragment:""})),{selection:e,uri:s}}var PTe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},FTe=function(s,e){return function(t,i){e(t,i,s)}};const BD=tt("markdownRendererService");let hO=class{constructor(e){this._openerService=e}render(e,t,i){const n={...t};n.actionHandler||(n.actionHandler=(o,a)=>BTe(this._openerService,o,a.isTrusted)),n.codeBlockRenderer||(n.codeBlockRenderer=(o,a)=>{var l;return((l=this._defaultCodeBlockRenderer)==null?void 0:l.renderCodeBlock(o,a,n??{}))??Promise.resolve(document.createElement("span"))});const r=i9(e,n,i);return r.element.classList.add("rendered-markdown"),r}setDefaultCodeBlockRenderer(e){this._defaultCodeBlockRenderer=e}};hO=PTe([FTe(0,FD)],hO);async function BTe(s,e,t,i){try{return await s.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:VTe(t),skipValidation:i})}catch(n){return It(n),!1}}function VTe(s){return s===!0?!0:s&&Array.isArray(s.enabledCommands)?s.enabledCommands:!1}ut(BD,hO,1);var WTe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},mx=function(s,e){return function(t,i){e(t,i,s)}};const gl=Ve;let uO=class extends oc{get _targetWindow(){return Ae(this._target.targetElements[0])}get _targetDocumentElement(){return Ae(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,n,r){var g,p,_,C,v,x,S,k,E,T,R;if(super(),this._keybindingService=t,this._configurationService=i,this._markdownRenderer=n,this._accessibilityService=r,this._messageListeners=new Ee,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._maxHeightRatioRelativeToWindow=.5,this._onDispose=this._register(new $),this._onRequestLayout=this._register(new $),this._linkHandler=e.linkHandler,this._target="targetElements"in e.target?e.target:new HTe(e.target),e.style)switch(e.style){case 1:{e.appearance??(e.appearance={}),(g=e.appearance).compact??(g.compact=!0),(p=e.appearance).showPointer??(p.showPointer=!0);break}case 2:{e.appearance??(e.appearance={}),(_=e.appearance).compact??(_.compact=!0);break}}this._hoverPointer=(C=e.appearance)!=null&&C.showPointer?gl("div.workbench-hover-pointer"):void 0,this._hover=this._register(new L2e(!((v=e.appearance)!=null&&v.skipFadeInAnimation))),this._hover.containerDomNode.classList.add("workbench-hover"),(x=e.appearance)!=null&&x.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),(S=e.position)!=null&&S.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0);const o=(k=e.appearance)==null?void 0:k.maxHeightRatio;o!==void 0&&o>0&&o<=1&&(this._maxHeightRatioRelativeToWindow=o),this._hoverPosition=((E=e.position)==null?void 0:E.hoverPosition)===void 0?3:nm(e.position.hoverPosition)?e.position.hoverPosition:2,this.onmousedown(this._hover.containerDomNode,N=>N.stopPropagation()),this.onkeydown(this._hover.containerDomNode,N=>{N.equals(9)&&this.dispose()}),this._register(J(this._targetWindow,"blur",()=>this.dispose()));const a=gl("div.hover-row.markdown-hover"),l=gl("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(Wi(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const N=e.content,{element:A}=this._register(this._markdownRenderer.render(N,{actionHandler:this._linkHandler,asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}}));l.appendChild(A)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const N=gl("div.hover-row.status-bar"),A=gl("div.actions");e.actions.forEach(O=>{const W=this._keybindingService.lookupKeybinding(O.commandId),j=W?W.getLabel():null;this._register(j6.render(A,{label:O.label,commandId:O.commandId,run:F=>{O.run(F),this.dispose()},iconClass:O.iconClass},j))}),N.appendChild(A),this._hover.containerDomNode.appendChild(N)}this._hoverContainer=gl("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:((T=e.persistence)==null?void 0:T.hideOnHover)===void 0?c=typeof e.content=="string"||hC(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,(R=e.appearance)!=null&&R.showHoverHint){const N=gl("div.hover-row.status-bar"),A=gl("div.info");A.textContent=w(1699,"Hold {0} key to mouse over",rt?"Option":"Alt"),N.appendChild(A),this._hover.containerDomNode.appendChild(N)}const u=[...this._target.targetElements];c||u.push(this._hoverContainer);const d=this._register(new k$(u));if(this._register(d.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const N=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new k$(N)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=d}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=rD(this._hoverContainer,gl("div")),n=De(this._hoverContainer,gl("div"));i.tabIndex=0,n.tabIndex=0,this._register(J(n,"focus",r=>{e.focus(),r.preventDefault()})),this._register(J(i,"focus",r=>{t.focus(),r.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const r=i;if(typeof r.tabIndex=="number"&&r.tabIndex>=0)return r}const n=this.findLastFocusableChild(i);if(n)return n}}render(e){var n;e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&k2e(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(n=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:n.getAriaLabel());i&&mk(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=u=>{const d=KQ(u),g=u.getBoundingClientRect();return{top:g.top*d,bottom:g.bottom*d,right:g.right*d,left:g.left*d}},t=this._target.targetElements.map(u=>e(u)),{top:i,right:n,bottom:r,left:o}=t[0],a=n-o,l=r-i,c={top:i,right:n,bottom:r,left:o,width:a,height:l,center:{x:o+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.offsetHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight*this._maxHeightRatioRelativeToWindow;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const n=this._x+i;(n<e.left||n>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){var e,t;this._isDisposed||(this._onDispose.fire(),(t=(e=this._target).dispose)==null||t.call(e),this._hoverContainer.remove(),this._messageListeners.dispose(),super.dispose()),this._isDisposed=!0}};uO=WTe([mx(1,Bn),mx(2,ai),mx(3,BD),mx(4,uo)],uO);class k$ extends oc{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e,t=200){super(),this._elements=e,this._eventDebounceDelay=t,this._isMouseIn=!0,this._mouseTimer=this._register(new kn),this._onMouseOut=this._register(new $);for(const i of this._elements)this.onmouseover(i,()=>this._onTargetMouseOver()),this.onmouseleave(i,()=>this._onTargetMouseLeave())}_onTargetMouseOver(){this._isMouseIn=!0,this._mouseTimer.clear()}_onTargetMouseLeave(){this._isMouseIn=!1,this._mouseTimer.value=new Ql(()=>this._fireIfMouseOutside(),this._eventDebounceDelay)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class HTe{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}var ns;(function(s){function e(r,o){if(r.start>=o.end||o.start>=r.end)return{start:0,end:0};const a=Math.max(r.start,o.start),l=Math.min(r.end,o.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}s.intersect=e;function t(r){return r.end-r.start<=0}s.isEmpty=t;function i(r,o){return!t(e(r,o))}s.intersects=i;function n(r,o){const a=[],l={start:r.start,end:Math.min(o.start,r.end)},c={start:Math.max(o.end,r.start),end:r.end};return t(l)||a.push(l),t(c)||a.push(c),a}s.relativeComplement=n})(ns||(ns={}));function zTe(s){const e=s;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var zu;(function(s){s[s.AVOID=0]="AVOID",s[s.ALIGN=1]="ALIGN"})(zu||(zu={}));function Qp(s,e,t){const i=t.mode===zu.ALIGN?t.offset:t.offset+t.size,n=t.mode===zu.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=s-i?i:e<=n?n-e:Math.max(s-e,0):e<=n?n-e:e<=s-i?i:0}const u_=class u_ extends ne{constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=ne.None,this.toDisposeOnSetContainer=ne.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=Ve(".context-view"),JH(this.view),this.setContainer(e,t),this._register(Fe(()=>this.setContainer(null,1)))}setContainer(e,t){var n;this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,(n=this.shadowRootHostElement)==null||n.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=Ve(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=UTe,this.shadowRoot.appendChild(o),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(Ve("slot"))}else this.container.appendChild(this.view);const r=new Ee;u_.BUBBLE_UP_EVENTS.forEach(o=>{r.add(Xn(this.container,o,a=>{this.onDOMEvent(a,!1)}))}),u_.BUBBLE_DOWN_EVENTS.forEach(o=>{r.add(Xn(this.container,o,a=>{this.onDOMEvent(a,!0)},!0))}),this.toDisposeOnSetContainer=r}}show(e){var t,i;this.isVisible()&&this.hide(),Ya(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",JQ(this.view),this.toDisposeOnClean=e.render(this.view)||ne.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)==null||i.call(t)}getViewElement(){return this.view}layout(){var e,t;if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Gl&&Nv.pointerEvents)){this.hide();return}(t=(e=this.delegate)==null?void 0:e.layout)==null||t.call(e),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(Wi(e)){const _=Mo(e),C=KQ(e);t={top:_.top*C,left:_.left*C,width:_.width*C,height:_.height*C}}else zTe(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=W7(this.view),n=p4(this.view),r=this.delegate.anchorPosition??0,o=this.delegate.anchorAlignment??0,a=this.delegate.anchorAxisAlignment??0;let l,c;const u=At();if(a===0){const _={offset:t.top-u.pageYOffset,size:t.height,position:r===0?0:1},C={offset:t.left,size:t.width,position:o===0?0:1,mode:zu.ALIGN};l=Qp(u.innerHeight,n,_)+u.pageYOffset,ns.intersects({start:l,end:l+n},{start:_.offset,end:_.offset+_.size})&&(C.mode=zu.AVOID),c=Qp(u.innerWidth,i,C)}else{const _={offset:t.left,size:t.width,position:o===0?0:1},C={offset:t.top,size:t.height,position:r===0?0:1,mode:zu.ALIGN};c=Qp(u.innerWidth,i,_),ns.intersects({start:c,end:c+i},{start:_.offset,end:_.offset+_.size})&&(C.mode=zu.AVOID),l=Qp(u.innerHeight,n,C)+u.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(r===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const d=Mo(this.container),g=this.container.scrollTop||0,p=this.container.scrollLeft||0;this.view.style.top=`${l-(this.useFixedPosition?Mo(this.view).top:d.top)+g}px`,this.view.style.left=`${c-(this.useFixedPosition?Mo(this.view).left:d.left)+p}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),JH(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,Ae(e).document.activeElement):t&&!xn(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}};u_.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],u_.BUBBLE_DOWN_EVENTS=["click"];let dO=u_;const UTe=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Nanum Gothic", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var jTe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$Te=function(s,e){return function(t,i){e(t,i,s)}};let eE=class extends ne{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new dO(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let n;t?t===this.layoutService.getContainer(Ae(t))?n=1:i?n=3:n=2:n=1,this.contextView.setContainer(t??this.layoutService.activeContainer,n),this.contextView.show(e);const r={close:()=>{this.openContextView===r&&this.hideContextView()}};return this.openContextView=r,r}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};eE=jTe([$Te(0,Wh)],eE);class qTe extends eE{getContextViewElement(){return this.contextView.getViewElement()}}function Lee(s){const e=s;return typeof e=="object"&&"markdown"in e&&"markdownNotSupportedFallback"in e}class GTe{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(Pn(e)||Wi(e)||e===void 0)n=e;else{this._cancellationTokenSource=new sm;const r=this._cancellationTokenSource.token;let o;if(Lee(e)?o1(e.markdown)?o=e.markdown(r).then(a=>a??e.markdownNotSupportedFallback):o=e.markdown??e.markdownNotSupportedFallback:o=e.element(r),o instanceof Promise?(this._hoverWidget||this.show(w(1700,"Loading..."),t,i),n=await o):n=o,this.isDisposed||r.isCancellationRequested)return}this.show(n,t,i)}show(e,t,i){var r;const n=this._hoverWidget;if(this.hasContent(e)){const o={content:e,target:this.target,actions:i==null?void 0:i.actions,linkHandler:i==null?void 0:i.linkHandler,trapFocus:i==null?void 0:i.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!n,showHoverHint:(r=i==null?void 0:i.appearance)==null?void 0:r.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(o,t)}n==null||n.dispose()}hasContent(e){return e?hC(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)==null?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)==null||e.dispose(),(t=this._cancellationTokenSource)==null||t.dispose(!0),this._cancellationTokenSource=void 0}}var KTe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Lp=function(s,e){return function(t,i){e(t,i,s)}};let fO=class extends ne{constructor(e,t,i,n,r,o){super(),this._instantiationService=e,this._configurationService=t,this._keybindingService=n,this._layoutService=r,this._accessibilityService=o,this._currentDelayedHoverWasShown=!1,this._delayedHovers=new Map,this._managedHovers=new Map,this._register(i.onDidShowContextMenu(()=>this.hideHover())),this._contextViewHandler=this._register(new eE(this._layoutService)),this._register(vd.registerCommandAndKeybindingRule({id:"workbench.action.showHover",weight:0,primary:_Q(2089,2087),handler:()=>{this._showAndFocusHoverForActiveElement()}}))}showInstantHover(e,t,i,n){const r=this._createHover(e,i);if(r)return this._showHover(r,e,t),r}showDelayedHover(e,t){var n;if(e.id===void 0&&(e.id=E$(e.content)),!this._currentDelayedHover||this._currentDelayedHoverWasShown){if((n=this._currentHover)!=null&&n.isLocked)return;if(bu(this._currentHoverOptions)===bu(e))return this._currentHover;if(this._currentHover&&!this._currentHover.isDisposed&&this._currentDelayedHoverGroupId!==void 0&&this._currentDelayedHoverGroupId===(t==null?void 0:t.groupId))return this.showInstantHover({...e,appearance:{...e.appearance,skipFadeInAnimation:!0}})}else if(this._currentDelayedHover&&bu(this._currentHoverOptions)===bu(e))return this._currentDelayedHover;const i=this._createHover(e,void 0);if(!i){this._currentDelayedHover=void 0,this._currentDelayedHoverWasShown=!1,this._currentDelayedHoverGroupId=void 0;return}return this._currentDelayedHover=i,this._currentDelayedHoverWasShown=!1,this._currentDelayedHoverGroupId=t==null?void 0:t.groupId,c1(this._configurationService.getValue("workbench.hover.delay")).then(()=>{i&&!i.isDisposed&&(this._currentDelayedHoverWasShown=!0,this._showHover(i,e))}),i}setupDelayedHover(e,t,i){const n=()=>({...typeof t=="function"?t():t,target:e});return this._setupDelayedHover(e,n,i)}setupDelayedHoverAtMouse(e,t,i){const n=r=>({...typeof t=="function"?t():t,target:{targetElements:[e],x:r!==void 0?r.x+10:void 0}});return this._setupDelayedHover(e,n,i)}_setupDelayedHover(e,t,i){const n=new Ee;return n.add(J(e,pe.MOUSE_OVER,r=>{this.showDelayedHover(t(r),{groupId:i==null?void 0:i.groupId})})),i!=null&&i.setupKeyboardEvents&&n.add(J(e,pe.KEY_DOWN,r=>{const o=new jt(r);(o.equals(10)||o.equals(3))&&this.showInstantHover(t(),!0)})),this._delayedHovers.set(e,{show:r=>{this.showInstantHover(t(),r)}}),n.add(Fe(()=>this._delayedHovers.delete(e))),n}_createHover(e,t){var a,l,c,u;if(this._currentDelayedHover=void 0,e.content===""||(a=this._currentHover)!=null&&a.isLocked||(e.id===void 0&&(e.id=E$(e.content)),bu(this._currentHoverOptions)===bu(e)))return;this._currentHoverOptions=e,this._lastHoverOptions=e;const i=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),n=Ln();t||(i&&n?n.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=n):this._lastFocusedElementBeforeOpen=void 0);const r=new Ee,o=this._instantiationService.createInstance(uO,e);if((l=e.persistence)!=null&&l.sticky&&(o.isLocked=!0),(c=e.position)!=null&&c.hoverPosition&&!nm(e.position.hoverPosition)&&(e.target={targetElements:Wi(e.target)?[e.target]:e.target.targetElements,x:e.position.hoverPosition.x+10}),o.onDispose(()=>{var g,p;((g=this._currentHover)==null?void 0:g.domNode)&&QQ(this._currentHover.domNode)&&((p=this._lastFocusedElementBeforeOpen)==null||p.focus()),bu(this._currentHoverOptions)===bu(e)&&this.doHideHover(),r.dispose()},void 0,r),!e.container){const d=Wi(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(Ae(d))}if(o.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,r),(u=e.persistence)!=null&&u.sticky)r.add(J(Ae(e.container).document,pe.MOUSE_DOWN,d=>{xn(d.target,o.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const g of e.target.targetElements)r.add(J(g,pe.CLICK,()=>this.hideHover()));else r.add(J(e.target,pe.CLICK,()=>this.hideHover()));const d=Ln();if(d){const g=Ae(d).document;r.add(J(d,pe.KEY_DOWN,p=>{var _;return this._keyDown(p,o,!!((_=e.persistence)!=null&&_.hideOnKeyDown))})),r.add(J(g,pe.KEY_DOWN,p=>{var _;return this._keyDown(p,o,!!((_=e.persistence)!=null&&_.hideOnKeyDown))})),r.add(J(d,pe.KEY_UP,p=>this._keyUp(p,o))),r.add(J(g,pe.KEY_UP,p=>this._keyUp(p,o)))}}if("IntersectionObserver"in Ut){const d=new IntersectionObserver(p=>this._intersectionChange(p,o),{threshold:0}),g="targetElements"in e.target?e.target.targetElements[0]:e.target;d.observe(g),r.add(Fe(()=>d.disconnect()))}return this._currentHover=o,o}_showHover(e,t,i){this._contextViewHandler.showContextView(new QTe(e,i),t.container)}hideHover(e){var t;!e&&((t=this._currentHover)!=null&&t.isLocked)||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showInstantHover(this._lastHoverOptions,!0,!0)}_showAndFocusHoverForActiveElement(){let e=Ln();for(;e;){const t=this._delayedHovers.get(e)??this._managedHovers.get(e);if(t){t.show(!0);return}e=e.parentElement}}_keyDown(e,t,i){var o,a;if(e.key==="Alt"){t.isLocked=!0;return}const n=new jt(e);this._keybindingService.resolveKeyboardEvent(n).getSingleModifierDispatchChords().some(l=>!!l)||this._keybindingService.softDispatch(n,n.target).kind!==0||i&&(!((o=this._currentHoverOptions)!=null&&o.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(a=this._lastFocusedElementBeforeOpen)==null||a.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}setupManagedHover(e,t,i,n){if(e.showNativeHover)return YTe(t,i);t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let r,o;const a=(p,_)=>{var v;const C=o!==void 0;p&&(o==null||o.dispose(),o=void 0),_&&(r==null||r.dispose(),r=void 0),C&&((v=e.onDidHideHover)==null||v.call(e),o=void 0)},l=(p,_,C,v)=>new Ql(async()=>{(!o||o.isDisposed)&&(o=new GTe(e,C||t,p>0),await o.update(typeof i=="function"?i():i,_,{...n,trapFocus:v}))},p),c=new Ee;let u=!1;c.add(J(t,pe.MOUSE_DOWN,()=>{u=!0,a(!0,!0)},!0)),c.add(J(t,pe.MOUSE_UP,()=>{u=!1},!0)),c.add(J(t,pe.MOUSE_LEAVE,p=>{u=!1,a(!1,p.fromElement===t)},!0)),c.add(J(t,pe.MOUSE_OVER,p=>{if(r)return;const _=new Ee,C={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const v=x=>{C.x=x.x+10,KR(x,t)||a(!0,!0)};_.add(J(t,pe.MOUSE_MOVE,v,!0))}r=_,KR(p,t)&&_.add(l(typeof e.delay=="function"?e.delay(i):e.delay,!1,C))},!0));const d=p=>{if(u||r||!KR(p,t))return;const _={targetElements:[t],dispose:()=>{}},C=new Ee,v=()=>a(!0,!0);C.add(J(t,pe.BLUR,v,!0)),C.add(l(typeof e.delay=="function"?e.delay(i):e.delay,!1,_)),r=C};qa(t)||c.add(J(t,pe.FOCUS,d,!0));const g={show:p=>{a(!1,!0),l(0,p,void 0,p)},hide:()=>{a(!0,!0)},update:async(p,_)=>{i=p,await(o==null?void 0:o.update(i,void 0,_))},dispose:()=>{this._managedHovers.delete(t),c.dispose(),a(!0,!0)}};return this._managedHovers.set(t,g),g}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};fO=KTe([Lp(0,wt),Lp(1,ai),Lp(2,Hh),Lp(3,Bn),Lp(4,Wh),Lp(5,uo)],fO);function bu(s){if(s!==void 0)return(s==null?void 0:s.id)??s}function E$(s){if(!Wi(s))return typeof s=="string"?s.toString():s.value}function D$(s){const e=typeof s=="function"?s():s;if(Pn(e))return XJ(e);if(Lee(e))return e.markdownNotSupportedFallback}function YTe(s,e){function t(i){i?s.setAttribute("title",i):s.removeAttribute("title")}return t(D$(e)),{update:i=>t(D$(i)),show:()=>{},hide:()=>{},dispose:()=>t(void 0)}}class QTe{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function KR(s,e){return Wi(s.target)&&XTe(s.target,e)===e}function XTe(s,e){for(e=e??Ae(s).document.body;!s.hasAttribute("custom-hover")&&s!==e;)s=s.parentElement;return s}ut(qv,fO,1);Vh((s,e)=>{const t=s.getColor(dCe);t&&(e.addRule(`.monaco-hover.workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-hover.workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const ZTe={ctrlCmd:!1,alt:!1};var Xw;(function(s){s[s.Blur=1]="Blur",s[s.Gesture=2]="Gesture",s[s.Other=3]="Other"})(Xw||(Xw={}));var kl;(function(s){s[s.NONE=0]="NONE",s[s.FIRST=1]="FIRST",s[s.SECOND=2]="SECOND",s[s.LAST=3]="LAST"})(kl||(kl={}));var Yt;(function(s){s[s.First=1]="First",s[s.Second=2]="Second",s[s.Last=3]="Last",s[s.Next=4]="Next",s[s.Previous=5]="Previous",s[s.NextPage=6]="NextPage",s[s.PreviousPage=7]="PreviousPage",s[s.NextSeparator=8]="NextSeparator",s[s.PreviousSeparator=9]="PreviousSeparator"})(Yt||(Yt={}));var tE;(function(s){s[s.Title=1]="Title",s[s.Inline=2]="Inline",s[s.Input=3]="Input"})(tE||(tE={}));const _m=tt("quickInputService");var F_;(function(s){s[s.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",s[s.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(F_||(F_={}));var Df;(function(s){s[s.None=0]="None",s[s.Initialized=1]="Initialized",s[s.Closed=2]="Closed"})(Df||(Df={}));const o2=class o2 extends ne{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new uw),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=Df.None,this.cache=new Map,this.flushDelayer=this._register(new FQ(o2.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)==null||t.forEach((n,r)=>this.acceptExternal(r,n)),(i=e.deleted)==null||i.forEach(n=>this.acceptExternal(n,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===Df.Closed)return;let i=!1;Ro(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return Ro(i)?t:i}getBoolean(e,t){const i=this.get(e);return Ro(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return Ro(i)?t:parseInt(i,10)}async set(e,t,i=!1){if(this.state===Df.Closed)return;if(Ro(t))return this.delete(e,i);const n=Vs(t)||Array.isArray(t)?ADe(t):String(t);if(this.cache.get(e)!==n)return this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===Df.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())==null||t()})}async flush(e){if(!(this.state===Df.Closed||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===F_.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}};o2.DEFAULT_FLUSH_DELAY=100;let fC=o2;class YR{constructor(){this.onDidChangeItemsExternal=ge.None,this.items=new Map}async updateItems(e){var t,i;(t=e.insert)==null||t.forEach((n,r)=>this.items.set(r,n)),(i=e.delete)==null||i.forEach(n=>this.items.delete(n))}}const Jx="__$__targetStorageMarker",Qv=tt("storageService");var gC;(function(s){s[s.NONE=0]="NONE",s[s.SHUTDOWN=1]="SHUTDOWN"})(gC||(gC={}));function JTe(s){const e=s.get(Jx);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const a2=class a2 extends ne{constructor(e={flushInterval:a2.DEFAULT_FLUSH_INTERVAL}){super(),this._onDidChangeValue=this._register(new uw),this._onDidChangeTarget=this._register(new uw),this._onWillSaveState=this._register(new $),this.onWillSaveState=this._onWillSaveState.event,this.runFlushWhenIdle=this._register(new kn),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0,this.flushWhenIdleScheduler=this._register(new os(()=>this.doFlushWhenIdle(),e.flushInterval))}onDidChangeValue(e,t,i){return ge.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=D7(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}emitDidChangeValue(e,t){const{key:i,external:n}=t;if(i===Jx){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:n})}get(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.get(e,i)}getBoolean(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getBoolean(e,i)}getNumber(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getNumber(e,i)}store(e,t,i,n,r=!1){if(Ro(t)){this.remove(e,i,r);return}this.withPausedEmitters(()=>{var o;this.updateKeyTarget(e,i,n),(o=this.getStorage(i))==null||o.set(e,t,r)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var n;this.updateKeyTarget(e,t,void 0),(n=this.getStorage(t))==null||n.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,n=!1){var o,a;const r=this.getKeyTargets(t);typeof i=="number"?r[e]!==i&&(r[e]=i,(o=this.getStorage(t))==null||o.set(Jx,JSON.stringify(r),n)):typeof r[e]=="number"&&(delete r[e],(a=this.getStorage(t))==null||a.set(Jx,JSON.stringify(r),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?JTe(t):Object.create(null)}async flush(e=gC.NONE){this._onWillSaveState.fire({reason:e});const t=this.getStorage(-1),i=this.getStorage(0),n=this.getStorage(1);switch(e){case gC.NONE:await pw.settled([(t==null?void 0:t.whenFlushed())??Promise.resolve(),(i==null?void 0:i.whenFlushed())??Promise.resolve(),(n==null?void 0:n.whenFlushed())??Promise.resolve()]);break;case gC.SHUTDOWN:await pw.settled([(t==null?void 0:t.flush(0))??Promise.resolve(),(i==null?void 0:i.flush(0))??Promise.resolve(),(n==null?void 0:n.flush(0))??Promise.resolve()]);break}}};a2.DEFAULT_FLUSH_INTERVAL=60*1e3;let gO=a2;class eNe extends gO{constructor(){super(),this.applicationStorage=this._register(new fC(new YR,{hint:F_.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new fC(new YR,{hint:F_.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new fC(new YR,{hint:F_.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}shouldFlushWhenIdle(){return!1}}var tNe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},T$=function(s,e){return function(t,i){e(t,i,s)}};const iNe=tt("IInlineCompletionsService"),nNe=new Ne("inlineCompletions.snoozed",!1,w(79,"Whether inline completions are currently snoozed"));let mO=class extends ne{get snoozeTimeLeft(){return this._snoozeTimeEnd===void 0?0:Math.max(0,this._snoozeTimeEnd-Date.now())}constructor(e,t){super(),this._contextKeyService=e,this._telemetryService=t,this._onDidChangeIsSnoozing=this._register(new $),this.onDidChangeIsSnoozing=this._onDidChangeIsSnoozing.event,this._snoozeTimeEnd=void 0,this._recentCompletionIds=[],this._timer=this._register(new Ql);const i=nNe.bindTo(this._contextKeyService);this._register(this.onDidChangeIsSnoozing(()=>i.set(this.isSnoozing())))}setSnoozeDuration(e){if(e<0)throw new Pe(`Invalid snooze duration: ${e}. Duration must be non-negative.`);if(e===0){this.cancelSnooze();return}const t=this.isSnoozing(),i=this.snoozeTimeLeft;this._snoozeTimeEnd=Date.now()+e,t||this._onDidChangeIsSnoozing.fire(!0),this._timer.cancelAndSet(()=>{if(!this.isSnoozing())this._onDidChangeIsSnoozing.fire(!1);else throw new Pe("Snooze timer did not fire as expected")},this.snoozeTimeLeft+1),this._reportSnooze(e-i,e)}isSnoozing(){return this.snoozeTimeLeft>0}cancelSnooze(){this.isSnoozing()&&(this._reportSnooze(-this.snoozeTimeLeft,0),this._snoozeTimeEnd=void 0,this._timer.cancel(),this._onDidChangeIsSnoozing.fire(!1))}reportNewCompletion(e){this._lastCompletionId=e,this._recentCompletionIds.unshift(e),this._recentCompletionIds.length>5&&this._recentCompletionIds.pop()}_reportSnooze(e,t){const i=Math.round(e/1e3),n=Math.round(t/1e3);this._telemetryService.publicLog2("inlineCompletions.snooze",{deltaSeconds:i,totalSeconds:n,lastCompletionId:this._lastCompletionId,recentCompletionIds:this._recentCompletionIds})}};mO=tNe([T$(0,St),T$(1,Bh)],mO);ut(iNe,mO,1);const sNe=tt("IWorkspaceEditService");class n9{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(fg.is(t))return fg.lift(t);if(B_.is(t))return B_.lift(t);throw new Error("Unsupported edit")})}}class fg extends n9{static is(e){return e instanceof fg?!0:Vs(e)&&nt.isUri(e.resource)&&Vs(e.textEdit)}static lift(e){return e instanceof fg?e:new fg(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class B_ extends n9{static is(e){return e instanceof B_?!0:Vs(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof B_?e:new B_(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const Un={enableSplitViewResizing:!0,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},rNe=Object.freeze({id:"editor",order:5,type:"object",title:w(147,"Editor"),scope:6}),iE={...rNe,properties:{"editor.tabSize":{type:"number",default:Qn.tabSize,minimum:1,maximum:100,markdownDescription:w(148,"The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:w(149,'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:Qn.insertSpaces,markdownDescription:w(150,"Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:Qn.detectIndentation,markdownDescription:w(151,"Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:Qn.trimAutoWhitespace,description:w(152,"Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:Qn.largeFileOptimizations,description:w(153,"Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[w(154,"Turn off Word Based Suggestions."),w(155,"Only suggest words from the active document."),w(156,"Suggest words from all open documents of the same language."),w(157,"Suggest words from all open documents.")],description:w(158,"Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[w(159,"Semantic highlighting enabled for all color themes."),w(160,"Semantic highlighting disabled for all color themes."),w(161,"Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:w(162,"Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:w(163,"Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:w(164,"Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:w(165,"Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:w(166,"Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:w(167,"Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:w(168,"Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `#editor.experimental.preferTreeSitter#` for specific languages will take precedence."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.css":{type:"boolean",default:!1,markdownDescription:w(169,"Controls whether tree sitter parsing should be turned on for css. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for css."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.typescript":{type:"boolean",default:!1,markdownDescription:w(170,"Controls whether tree sitter parsing should be turned on for typescript. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for typescript."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.ini":{type:"boolean",default:!1,markdownDescription:w(171,"Controls whether tree sitter parsing should be turned on for ini. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for ini."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.regex":{type:"boolean",default:!1,markdownDescription:w(172,"Controls whether tree sitter parsing should be turned on for regex. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for regex."),tags:["experimental"],experiment:{mode:"auto"}},"editor.language.brackets":{type:["array","null"],default:null,description:w(173,"Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:w(174,"The opening bracket character or string sequence.")},{type:"string",description:w(175,"The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:w(176,"Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:w(177,"The opening bracket character or string sequence.")},{type:"string",description:w(178,"The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:Un.maxComputationTime,description:w(179,"Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:Un.maxFileSize,description:w(180,"Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:Un.renderSideBySide,description:w(181,"Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:Un.renderSideBySideInlineBreakpoint,description:w(182,"If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:Un.useInlineViewWhenSpaceIsLimited,description:w(183,"If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:Un.renderMarginRevertIcon,description:w(184,"When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:Un.renderGutterMenu,description:w(185,"When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:Un.ignoreTrimWhitespace,description:w(186,"When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:Un.renderIndicators,description:w(187,"Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:Un.diffCodeLens,description:w(188,"Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:Un.diffWordWrap,markdownEnumDescriptions:[w(189,"Lines will never wrap."),w(190,"Lines will wrap at the viewport width."),w(191,"Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:Un.diffAlgorithm,markdownEnumDescriptions:[w(192,"Uses the legacy diffing algorithm."),w(193,"Uses the advanced diffing algorithm.")]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:Un.hideUnchangedRegions.enabled,markdownDescription:w(194,"Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:Un.hideUnchangedRegions.revealLineCount,markdownDescription:w(195,"Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:Un.hideUnchangedRegions.minimumLineCount,markdownDescription:w(196,"Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:Un.hideUnchangedRegions.contextLineCount,markdownDescription:w(197,"Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:Un.experimental.showMoves,markdownDescription:w(198,"Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:Un.experimental.showEmptyDecorations,description:w(199,"Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:Un.experimental.useTrueInlineView,description:w(200,"If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function oNe(s){return typeof s.type<"u"||typeof s.anyOf<"u"}for(const s of Pp){const e=s.schema;if(typeof e<"u")if(oNe(e))iE.properties[`editor.${s.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(iE.properties[t]=e[t])}let px=null;function kee(){return px===null&&(px=Object.create(null),Object.keys(iE.properties).forEach(s=>{px[s]=!0})),px}function aNe(s){return kee()[`editor.${s}`]||!1}function lNe(s){return kee()[`diffEditor.${s}`]||!1}const cNe=Fn.as(hm.Configuration);cNe.registerConfiguration(iE);class hNe{static insert(e,t){return{range:new H(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function _x(s){return Object.isFrozen(s)?s:Afe(s)}class An{static createEmptyModel(e){return new An({},[],[],void 0,e)}constructor(e,t,i,n,r){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=r,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw){const e=(Array.isArray(this.raw)?this.raw:[this.raw]).map(t=>{if(t instanceof An)return t;const i=new uNe("",this.logService);return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?wz(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return _x(i.rawConfiguration.getValue(e))},get override(){return t?_x(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return _x(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:r,identifiers:o,keys:a}of i.rawConfiguration.overrides){const l=new An(r,a,[],void 0,i.logService).getValue(e);l!==void 0&&n.push({identifiers:o,value:l})}return n.length?_x(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?wz(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=eh(this.contents),i=eh(this.overrides),n=[...this.keys],r=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(const o of e)if(r.push(...o.raw?Array.isArray(o.raw)?o.raw:[o.raw]:[o]),!o.isEmpty()){this.mergeContents(t,o.contents);for(const a of o.overrides){const[l]=i.filter(c=>sn(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=Ag(l.keys)):i.push(eh(a))}for(const a of o.keys)n.indexOf(a)===-1&&n.push(a)}return new An(t,n,i,!r.length||r.every(o=>o instanceof An)?void 0:r,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of Ag([...Object.keys(this.contents),...Object.keys(t)])){let r=this.contents[n];const o=t[n];o&&(typeof r=="object"&&typeof o=="object"?(r=eh(r),this.mergeContents(r,o)):r=o),i[n]=r}return new An(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Vs(e[i])&&Vs(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=eh(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=r=>{r&&(i?this.mergeContents(i,r):i=eh(r))};for(const r of this.overrides)r.identifiers.length===1&&r.identifiers[0]===e?t=r.contents:r.identifiers.includes(e)&&n(r.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),T1e(this.contents,e),ud.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>sn(i.identifiers,nk(e))),1))}updateValue(e,t,i){if(wX(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),ud.test(e)){const n=nk(e),r={identifiers:n,keys:Object.keys(this.contents[e]),contents:D4(this.contents[e],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>sn(a.identifiers,n));o!==-1?this.overrides[o]=r:this.overrides.push(r)}}}class uNe{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||An.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new An(i,n,r,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseRaw(e,t){const i=Fn.as(hm.Configuration),n=i.getConfigurationProperties(),r=i.getExcludedConfigurationProperties(),o=this.filter(e,n,r,!0,t);e=o.raw;const a=D4(e,u=>this.logService.error(`Conflict in settings file ${this._name}: ${u}`)),l=Object.keys(e),c=this.toOverrides(e,u=>this.logService.error(`Conflict in settings file ${this._name}: ${u}`));return{contents:a,keys:l,overrides:c,restricted:o.restricted,hasExcludedProperties:o.hasExcludedProperties}}filter(e,t,i,n,r){var c;let o=!1;if(!(r!=null&&r.scopes)&&!(r!=null&&r.skipRestricted)&&!(r!=null&&r.skipUnregistered)&&!((c=r==null?void 0:r.exclude)!=null&&c.length))return{raw:e,restricted:[],hasExcludedProperties:o};const a={},l=[];for(const u in e)if(ud.test(u)&&n){const d=this.filter(e[u],t,i,!1,r);a[u]=d.raw,o=o||d.hasExcludedProperties,l.push(...d.restricted)}else{const d=t[u];d!=null&&d.restricted&&l.push(u),this.shouldInclude(u,d,i,r)?a[u]=e[u]:o=!0}return{raw:a,restricted:l,hasExcludedProperties:o}}shouldInclude(e,t,i,n){var a,l;if((a=n.exclude)!=null&&a.includes(e))return!1;if((l=n.include)!=null&&l.includes(e))return!0;if(n.skipRestricted&&(t!=null&&t.restricted)||n.skipUnregistered&&!t)return!1;const r=t??i[e],o=r?typeof r.scope<"u"?r.scope:4:void 0;return o===void 0||n.scopes===void 0?!0:n.scopes.includes(o)}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(ud.test(n)){const r={};for(const o in e[n])r[o]=e[n][o];i.push({identifiers:nk(n),keys:Object.keys(r),contents:D4(r,t)})}return i}}class dNe{constructor(e,t,i,n,r,o,a,l,c,u,d,g,p){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=r,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=u,this.workspaceConfiguration=d,this.folderConfigurationModel=g,this.memoryConfigurationModel=p}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class VD{constructor(e,t,i,n,r,o,a,l,c,u){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=r,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=u,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new ls,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=An.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),r=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(e,c)!==void 0&&a.add(c);return new dNe(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,r||void 0,o)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration)if(this._remoteUserConfiguration.isEmpty())this._userConfiguration=this._localUserConfiguration;else{const e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new An(e.contents,e.keys,e.overrides,void 0,this.logService)}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);if(t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){n=n.merge();for(const r of this._policyConfiguration.keys)n.setValue(r,this._policyConfiguration.getValue(r))}return n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const r=this._memoryConfigurationByResource.get(e);r&&(i=i.merge(r))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:r}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),r=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.userLocal,t),a=this.parseConfigurationModel(e.userRemote,t),l=this.parseConfigurationModel(e.workspace,t),c=e.folders.reduce((u,d)=>(u.set(nt.revive(d[0]),this.parseConfigurationModel(d[1],t)),u),new ls);return new VD(i,n,r,o,a,l,c,An.createEmptyModel(t),new ls,t)}static parseConfigurationModel(e,t){return new An(e.contents,e.keys,e.overrides,e.raw,t)}}class fNe{constructor(e,t,i,n,r){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=r,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=VD.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const r=n+i.length;if(r>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(r);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!xr(l,c)}return!0}}const nE={kind:0},gNe={kind:1};function mNe(s,e,t){return{kind:2,commandId:s,commandArgs:e,isBubble:t}}class mC{constructor(e,t,i){var n;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const r of e){const o=r.command;o&&o.charAt(0)!=="-"&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=mC.handleRemovals([].concat(e).concat(t));for(let r=0,o=this._keybindings.length;r<o;r++){const a=this._keybindings[r];if(a.chords.length===0)continue;const l=(n=a.when)==null?void 0:n.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let n=0;n<t.length;n++)if(t[n]!==e.chords[n])return!1}return!(i&&i.type!==1&&(!e.when||!E_e(i,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,r=e.length;n<r;n++){const o=e[n];if(o.command&&o.command.charAt(0)==="-"){const a=o.command.substring(1);t.has(a)?t.get(a).push(o):t.set(a,[o])}}if(t.size===0)return e;const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];if(!o.command||o.command.length===0){i.push(o);continue}if(o.command.charAt(0)==="-")continue;const a=t.get(o.command);if(!a||!o.isDefault){i.push(o);continue}let l=!1;for(const c of a){const u=c.when;if(this._isTargetedForRemoval(o,c.chords,u)){l=!0;break}}if(!l){i.push(o);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const r=i[n];if(r.command===t.command)continue;let o=!0;for(let a=1;a<r.chords.length&&a<t.chords.length;a++)if(r.chords[a]!==t.chords[a]){o=!1;break}o&&mC.whenIsEntirelyIncluded(r.when,t.when)&&this._removeFromLookupMap(r)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:y4(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t,i=!1){const n=this._lookupMap.get(e);if(typeof n>"u"||n.length===0)return null;if(n.length===1&&!i)return n[0];for(let r=n.length-1;r>=0;r--){const o=n[r];if(t.contextMatchesRules(o.when))return o}return i?null:n[n.length-1]}resolve(e,t,i){const n=[...t,i];this._log(`| Resolving ${n}`);const r=this._map.get(n[0]);if(r===void 0)return this._log("\\ No keybinding entries."),nE;let o=null;if(n.length<2)o=r;else{o=[];for(let l=0,c=r.length;l<c;l++){const u=r[l];if(n.length>u.chords.length)continue;let d=!0;for(let g=1;g<n.length;g++)if(u.chords[g]!==n[g]){d=!1;break}d&&o.push(u)}}const a=this._findCommand(e,o);return a?n.length<a.chords.length?(this._log(`\\ From ${o.length} keybinding entries, awaiting ${a.chords.length-n.length} more chord(s), when: ${N$(a.when)}, source: ${I$(a)}.`),gNe):(this._log(`\\ From ${o.length} keybinding entries, matched ${a.command}, when: ${N$(a.when)}, source: ${I$(a)}.`),mNe(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${o.length} keybinding entries, no when clauses matched the context.`),nE)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(mC._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function N$(s){return s?`${s.serialize()}`:"no when condition"}function I$(s){return s.extensionId?s.isBuiltinExtension?`built-in extension ${s.extensionId}`:`user extension ${s.extensionId}`:s.isDefault?"built-in":"user"}const pNe=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class _Ne extends ne{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:ge.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,n,r){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=r,this._onDidUpdateKeybindings=this._register(new $),this._currentChords=[],this._currentChordChecker=new E7,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=Xp.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new Ql,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t,i=!1){const n=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService,i);if(n)return n.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),nE;const[n]=i.getDispatchChords();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),nE;const r=this._contextKeyService.getContext(t),o=this._currentChords.map((({keypress:a})=>a));return this._getResolver().resolve(r,o,n)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw HL("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(w(1701,"({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:n})=>n).join(", ");this._currentChordStatusMessage=this._notificationService.status(w(1702,"({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),Wl.enabled&&Wl.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.close(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],Wl.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchChords();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=Xp.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=Xp.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[r]=i.getChords();return this._ignoreSingleModifiers=new Xp(r),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let r=null,o=null;if(i){const[u]=e.getSingleModifierDispatchChords();r=u,o=u?[u]:[]}else[r]=e.getDispatchChords(),o=this._currentChords.map(({keypress:u})=>u);if(r===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,o,r);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const u=this._currentChords.map(({label:d})=>d).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${u}, ${l}".`),this._notificationService.status(w(1703,"The key combination ({0}, {1}) is not a command.",u,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}return n}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(r,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const u=this._currentChords.map(({label:d})=>d).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${u}, ${l}".`),this._notificationService.status(w(1704,"The key combination ({0}, {1}) is not a command.",u,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,u=>this._notificationService.warn(u)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,u=>this._notificationService.warn(u))}finally{this._currentlyDispatchingCommandId=null}pNe.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return n}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}const l2=class l2{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}};l2.EMPTY=new l2(null);let Xp=l2;class R${constructor(e,t,i,n,r,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?pO(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=pO(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=r,this.extensionId=o,this.isBuiltinExtension=a}}function pO(s){const e=[];for(let t=0,i=s.length;t<i;t++){const n=s[t];if(!n)return[];e.push(n)}return e}class WD{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=i(a);if(l===null)return null;n[r]=vNe(a,l,this.modifierLabels[e])}return n.join(" ")}}const s9=new WD({ctrlKey:"",shiftKey:"",altKey:"",metaKey:"",separator:""},{ctrlKey:w(35,"Ctrl"),shiftKey:w(36,"Shift"),altKey:w(37,"Alt"),metaKey:w(38,"Windows"),separator:"+"},{ctrlKey:w(39,"Ctrl"),shiftKey:w(40,"Shift"),altKey:w(41,"Alt"),metaKey:w(42,"Super"),separator:"+"}),bNe=new WD({ctrlKey:w(43,"Control"),shiftKey:w(44,"Shift"),altKey:w(45,"Option"),metaKey:w(46,"Command"),separator:"+"},{ctrlKey:w(47,"Control"),shiftKey:w(48,"Shift"),altKey:w(49,"Alt"),metaKey:w(50,"Windows"),separator:"+"},{ctrlKey:w(51,"Control"),shiftKey:w(52,"Shift"),altKey:w(53,"Alt"),metaKey:w(54,"Super"),separator:"+"}),CNe=new WD({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),wNe=new WD({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function vNe(s,e,t){if(e===null)return"";const i=[];return s.ctrlKey&&i.push(t.ctrlKey),s.shiftKey&&i.push(t.shiftKey),s.altKey&&i.push(t.altKey),s.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class yNe extends qme{constructor(e,t){if(super(),t.length===0)throw K2("chords");this._os=e,this._chords=t}getLabel(){return s9.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return bNe.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:CNe.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return wNe.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new $me(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class Zw extends yNe{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"";case 16:return"";case 17:return"";case 18:return""}return oh.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":oh.toString(e.keyCode)}_getElectronAccelerator(e){return oh.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=oh.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return Zw.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=oh.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=p7[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof Bg)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new Bg(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=pO(e.chords.map(n=>this._toKeyCodeChord(n)));return i.length>0?[new Zw(i,t)]:[]}}const SNe=tt("labelService"),xNe=tt("progressService"),r9=tt("editorProgressService");class LNe{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class kNe{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?b7(e,this._value,0,e.length,this._from,this._to):B1(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class ENe{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?b7(e,this._value,0,e.length,this._from,this._to):B1(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class DNe{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new ENe(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return OH(e,this._value.scheme);if(this._states[this._stateIdx]===2)return OH(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return t4(e,this._value.query);if(this._states[this._stateIdx]===5)return t4(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}const IC=class IC{static wrap(e){return e===void 0?IC.Val:e}static unwrap(e){return e===IC.Val?void 0:e}};IC.Val=Symbol("undefined_placeholder");let Gc=IC;class bx{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}class pC{static forUris(e=()=>!1,t=()=>!1){return new pC(new DNe(e,t))}static forStrings(){return new pC(new LNe)}static forConfigKeys(){return new pC(new kNe)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new bx,this._root.segment=i.value());const r=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new bx,n.left.segment=i.value()),r.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new bx,n.right.segment=i.value()),r.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new bx,n.mid.segment=i.value()),r.push([0,n]),n=n.mid;else break}const o=Gc.unwrap(n.value);n.value=Gc.wrap(t),n.key=e;for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=r[a][0],d=r[a+1][0];if(u===1&&d===1)r[a][1]=l.rotateLeft();else if(u===-1&&d===-1)r[a][1]=l.rotateRight();else if(u===1&&d===-1)l.right=r[a+1][1]=r[a+1][1].rotateRight(),r[a][1]=l.rotateLeft();else if(u===-1&&d===1)l.left=r[a+1][1]=r[a+1][1].rotateLeft(),r[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}return o}get(e){var t;return Gc.unwrap((t=this._getNode(e))==null?void 0:t.value)}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let r=this._root;for(;r;){const o=i.cmp(r.segment);if(o>0)n.push([-1,r]),r=r.left;else if(o<0)n.push([1,r]),r=r.right;else if(i.hasNext())i.next(),n.push([0,r]),r=r.mid;else break}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){const o=[[1,r]],a=this._min(r.right,o);if(a.key){r.key=a.key,r.value=a.value,r.segment=a.segment;const l=a.right;if(o.length>1){const[u,d]=o[o.length-1];switch(u){case-1:d.left=l;break;case 0:zL(!1);case 1:zL(!1)}}else r.right=l;const c=this._balanceByStack(o);if(n.length>0){const[u,d]=n[n.length-1];switch(u){case-1:d.left=c;break;case 0:d.mid=c;break;case 1:d.right=c;break}}else this._root=c}}else{const o=r.left??r.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=o;break;case 0:l.mid=o;break;case 1:l.right=o;break}}else this._root=o}this._root=this._balanceByStack(n)??this._root}}_min(e,t){for(;e.left;)t.push([-1,e]),e=e.left;return e}_balanceByStack(e){for(let t=e.length-1;t>=0;t--){const i=e[t][1];i.updateHeight();const n=i.balanceFactor();if(n>1?(i.right.balanceFactor()>=0||(i.right=i.right.rotateRight()),e[t][1]=i.rotateLeft()):n<-1&&(i.left.balanceFactor()<=0||(i.left=i.left.rotateLeft()),e[t][1]=i.rotateRight()),t>0)switch(e[t-1][0]){case-1:e[t-1][1].left=e[t][1];break;case 1:e[t-1][1].right=e[t][1];break;case 0:e[t-1][1].mid=e[t][1];break}else return e[0][1]}}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),n=Gc.unwrap(i.value)||n,i=i.mid;else break}return i&&Gc.unwrap(i.value)||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const r=i.cmp(n.segment);if(r>0)n=n.left;else if(r<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?Gc.unwrap(n.value):void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value!==void 0&&t.push([e.key,Gc.unwrap(e.value)]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const TNe=tt("contextService");class NNe{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const INe="code-workspace";w(2050,"Code Workspace");const RNe="4064f6ec-cb38-4ad0-af64-ee6467e63c82";var A$;(function(s){s.inspectTokensAction=w(786,"Developer: Inspect Tokens")})(A$||(A$={}));var M$;(function(s){s.gotoLineActionLabel=w(787,"Go to Line/Column...")})(M$||(M$={}));var O$;(function(s){s.helpQuickAccessActionLabel=w(788,"Show all Quick Access Providers")})(O$||(O$={}));var P$;(function(s){s.quickCommandActionLabel=w(789,"Command Palette"),s.quickCommandHelp=w(790,"Show And Run Commands")})(P$||(P$={}));var F$;(function(s){s.quickOutlineActionLabel=w(791,"Go to Symbol..."),s.quickOutlineByCategoryActionLabel=w(792,"Go to Symbol by Category...")})(F$||(F$={}));var _O;(function(s){s.editorViewAccessibleLabel=w(793,"Editor content")})(_O||(_O={}));var B$;(function(s){s.toggleHighContrast=w(794,"Toggle High Contrast Theme")})(B$||(B$={}));var bO;(function(s){s.bulkEditServiceSummary=w(795,"Made {0} edits in {1} files")})(bO||(bO={}));const ANe=tt("workspaceTrustManagementService");let x1=[],o9=[],Eee=[];function Cx(s,e=!1){MNe(s,!1,e)}function MNe(s,e,t){const i=ONe(s,e);x1.push(i),i.userConfigured?Eee.push(i):o9.push(i),t&&!i.userConfigured&&x1.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function ONe(s,e){return{id:s.id,mime:s.mime,filename:s.filename,extension:s.extension,filepattern:s.filepattern,firstline:s.firstline,userConfigured:e,filenameLowercase:s.filename?s.filename.toLowerCase():void 0,extensionLowercase:s.extension?s.extension.toLowerCase():void 0,filepatternLowercase:s.filepattern?BJ(s.filepattern.toLowerCase()):void 0,filepatternOnPath:s.filepattern?s.filepattern.indexOf(Gi.sep)>=0:!1}}function PNe(){x1=x1.filter(s=>s.userConfigured),o9=[]}function FNe(s,e){return BNe(s,e).map(t=>t.id)}function BNe(s,e){let t;if(s)switch(s.scheme){case je.file:t=s.fsPath;break;case je.data:{t=tk.parseMetaData(s).get(tk.META_DATA_LABEL);break}case je.vscodeNotebookCell:t=void 0;break;default:t=s.path}if(!t)return[{id:"unknown",mime:ch.unknown}];t=t.toLowerCase();const i=vQ(t),n=V$(t,i,Eee);if(n)return[n,{id:da,mime:ch.text}];const r=V$(t,i,o9);if(r)return[r,{id:da,mime:ch.text}];if(e){const o=VNe(e);if(o)return[o,{id:da,mime:ch.text}]}return[{id:"unknown",mime:ch.unknown}]}function V$(s,e,t){var o;let i,n,r;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){i=l;break}if(l.filepattern&&(!n||l.filepattern.length>n.filepattern.length)){const c=l.filepatternOnPath?s:e;(o=l.filepatternLowercase)!=null&&o.call(l,c)&&(n=l)}l.extension&&(!r||l.extension.length>r.extension.length)&&e.endsWith(l.extensionLowercase)&&(r=l)}if(i)return i;if(n)return n;if(r)return r}function VNe(s){if(L7(s)&&(s=s.substr(1)),s.length>0)for(let e=x1.length-1;e>=0;e--){const t=x1[e];if(!t.firstline)continue;const i=s.match(t.firstline);if(i&&i.length>0)return t}}const wx=Object.prototype.hasOwnProperty,W$="vs.editor.nullLanguage";class WNe{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(W$,0),this._register(da,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||W$}}const RC=class RC extends ne{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,RC.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new WNe,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(d1.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){RC.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},PNe();const e=[].concat(d1.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),Fn.as(hm.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;wx.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)Cx({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)Cx({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)Cx({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);TQ(l)||Cx({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let r=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?r=[null]:r=t.aliases),r!==null)for(const a of r)!a||a.length===0||e.aliases.push(a);const o=r!==null&&r.length>0;if(!(o&&r[0]===null)){const a=(o?r[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?wx.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return wx.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&wx.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:FNe(e,t)}};RC.instanceCount=0;let CO=RC;const AC=class AC extends ne{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new $),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new $),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new $({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,AC.instanceCount++,this._registry=this._register(new CO(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){AC.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){return this._registry.guessLanguageIdByFilepathOrFirstLine(e,t).at(0)??null}createById(e){return new H$(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new H$(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=da),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),qi.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}};AC.instanceCount=0;let wO=AC;class H${constructor(e,t){this._value=mi(this,e,()=>t()),this.onDidChange=ge.fromObservable(this._value)}get languageId(){return this._value.get()}}function Th(s,e){if(s!==void 0){const t=s.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=Th(i[1].trim(),e)),`var(${i[0]}, ${e})`}return s}return e}function z$(s){const e=s.replaceAll(/[^_\-a-z0-9]/gi,"");return e!==s&&console.warn(`CSS ident value ${s} modified to ${e} to be safe for CSS`),e}function Cu(s){return`'${s.replaceAll(/'/g,"\\000027")}'`}function Jl(s){return s?br`url('${CSS.escape(VQ.uriToBrowserUri(s).toString(!0))}')`:"url('')"}function vx(s,e=!1){const t=CSS.escape(s);return!e&&t!==s&&console.warn(`CSS class name ${s} modified to ${t} to be safe for CSS`),t}function br(s,...e){return s.reduce((t,i,n)=>{const r=e[n]||"";return t+i+r},"")}class QR{constructor(){this._parts=[]}push(...e){this._parts.push(...e)}join(e=`
`){return this._parts.join(e)}}const Dee={TEXT:ch.text},HNe=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let HD=HNe;const zNe=new Ws(()=>HD("mouse",!1)),UNe=new Ws(()=>HD("element",!1));function jNe(s){HD=s}function Ld(s){return s==="element"?UNe.value:zNe.value}function Tee(){return HD("element",!0)}let Nee={showInstantHover:()=>{},showDelayedHover:()=>{},setupDelayedHover:()=>ne.None,setupDelayedHoverAtMouse:()=>ne.None,hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>({dispose:()=>{},show:()=>{},hide:()=>{},update:()=>{}}),showManagedHover:()=>{}};function $Ne(s){Nee=s}function tl(){return Nee}class qNe{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}class ef extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function U$(s,e){const t=[];for(const i of e){if(s.start>=i.range.end)continue;if(s.end<i.range.start)break;const n=ns.intersect(s,i.range);ns.isEmpty(n)||t.push({range:n,size:i.size})}return t}function vO({start:s,end:e},t){return{start:s+t,end:e+t}}function GNe(s){const e=[];let t=null;for(const i of s){const n=i.range.start,r=i.range.end,o=i.size;if(t&&o===t.size){t.range.end=r;continue}t={range:{start:n,end:r},size:o},e.push(t)}return e}function KNe(...s){return GNe(s.reduce((e,t)=>e.concat(t),[]))}class YNe{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const n=i.length-t,r=U$({start:0,end:e},this.groups),o=U$({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:vO(l.range,n),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=KNe(r,a,o),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const n of this.groups){const r=n.range.end-n.range.start,o=i+r*n.size;if(e<o)return t+Math.floor((e-i)/n.size);t+=r,i=o}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const n of this.groups){const r=n.range.end-n.range.start,o=i+r;if(e<o)return this._paddingTop+t+(e-i)*n.size;t+=r*n.size,i=o}return-1}}class QNe{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const n=Ve(".monaco-list-row"),o=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:o}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}function XNe(s,e,t,i=[]){if(!s.dataTransfer)return;const n=Ve(".monaco-drag-image");n.textContent=t,n.classList.add(...i),(a=>{for(;a&&!a.classList.contains("monaco-workbench");)a=a.parentElement;return a||e.ownerDocument.body})(e).appendChild(n),s.dataTransfer.setDragImage(n,-10,-10),setTimeout(()=>n.remove(),0)}var zh=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};const tf={CurrentDragAndDropData:void 0},ml={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(s){return[s]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class Xv{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class ZNe{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class JNe{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function eIe(s,e){return Array.isArray(s)&&Array.isArray(e)?sn(s,e):s===e}class tIe{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}const c2=class c2{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:YI(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,n=ml){var o,a;if(this.virtualDelegate=t,this.domId=`list_id_${++c2.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new Iv(50),this.splicing=!1,this.dragOverAnimationStopDisposable=ne.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=ne.None,this.onDragLeaveTimeout=ne.None,this.currentSelectionDisposable=ne.None,this.disposables=new Ee,this._onDidChangeContentHeight=new $,this._onDidChangeContentWidth=new $,this.onDidChangeContentHeight=ge.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(const l of i)this.renderers.set(l.templateId,l);if(this.cache=this.disposables.add(new QNe(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??ml.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new tIe(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??ml.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add($s.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new U1({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:l=>hr(Ae(this.domNode),l)})),this.scrollableElement=this.disposables.add(new ND(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??ml.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??ml.verticalScrollMode,useShadows:n.useShadows??ml.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(J(this.rowsContainer,Qt.Change,l=>this.onTouchChange(l))),this.disposables.add(J(this.scrollableElement.getDomNode(),"scroll",l=>{const c=l.target,u=c.scrollTop;c.scrollTop=0,n.scrollToActiveElement&&this.setScrollTop(this.scrollTop+u)})),this.disposables.add(J(this.domNode,"dragover",l=>this.onDragOver(this.toDragEvent(l)))),this.disposables.add(J(this.domNode,"drop",l=>this.onDrop(this.toDragEvent(l)))),this.disposables.add(J(this.domNode,"dragleave",l=>this.onDragLeave(this.toDragEvent(l)))),this.disposables.add(J(this.domNode,"dragend",l=>this.onDragEnd(l))),n.userSelection){if(n.dnd)throw new Error("DND and user selection cannot be used simultaneously");this.disposables.add(J(this.domNode,"mousedown",l=>this.onPotentialSelectionStart(l)))}this.setRowLineHeight=n.setRowLineHeight??ml.setRowLineHeight,this.setRowHeight=n.setRowHeight??ml.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??ml.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(ml.dnd),this.layout((o=n.initialSize)==null?void 0:o.height,(a=n.initialSize)==null?void 0:a.width),n.scrollToActiveElement&&this._setupFocusObserver(e)}_setupFocusObserver(e){this.disposables.add(J(e,"focus",()=>{const t=Ln();this.activeElement!==t&&t!==null&&(this.activeElement=t,this._scrollToActiveElement(this.activeElement,e))},!0))}_scrollToActiveElement(e,t){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect().top-i.top;r<0&&this.setScrollTop(this.scrollTop+r)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(e){return new YNe(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},o=ns.intersect(n,r),a=new Map;for(let T=o.end-1;T>=o.start;T--){const R=this.items[T];if(R.dragStartDisposable.dispose(),R.checkedDisposable.dispose(),R.row){let N=a.get(R.templateId);N||(N=[],a.set(R.templateId,N));const A=this.renderers.get(R.templateId);A&&A.disposeElement&&A.disposeElement(R.element,T,R.row.templateData,{height:R.size}),N.unshift(R.row)}R.row=null,R.stale=!0}const l={start:e+t,end:this.items.length},c=ns.intersect(l,n),u=ns.relativeComplement(l,n),d=i.map(T=>({id:String(this.itemId++),element:T,templateId:this.virtualDelegate.getTemplateId(T),size:this.virtualDelegate.getHeight(T),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(T),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:ne.None,checkedDisposable:ne.None,stale:!1}));let g;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,d),g=this.items,this.items=d):(this.rangeMap.splice(e,t,d),g=BL(this.items,e,t,d));const p=i.length-t,_=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),C=vO(c,p),v=ns.intersect(_,C);for(let T=v.start;T<v.end;T++)this.updateItemInDOM(this.items[T],T);const x=ns.relativeComplement(C,_);for(const T of x)for(let R=T.start;R<T.end;R++)this.removeItemFromDOM(R);const S=u.map(T=>vO(T,p)),E=[{start:e,end:e+i.length},...S].map(T=>ns.intersect(_,T)).reverse();for(const T of E)for(let R=T.end-1;R>=T.start;R--){const N=this.items[R],A=a.get(N.templateId),O=A==null?void 0:A.pop();this.insertItemInDOM(R,O)}for(const T of a.values())for(const R of T)this.cache.release(R);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),g.map(T=>T.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=hr(Ae(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getVisibleRange(this.lastRenderTop,this.lastRenderHeight).start}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:Gpe(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:YI(this.domNode)})}render(e,t,i,n,r,o=!1,a=!1){const l=this.getRenderRange(t,i),c=ns.relativeComplement(l,e).reverse(),u=ns.relativeComplement(e,l);if(o){const d=ns.intersect(e,l);for(let g=d.start;g<d.end;g++)this.updateItemInDOM(this.items[g],g)}this.cache.transact(()=>{for(const d of u)for(let g=d.start;g<d.end;g++)this.removeItemFromDOM(g,a);for(const d of c)for(let g=d.end-1;g>=d.start;g--)this.insertItemInDOM(g)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){var c,u;const i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{const d=this.cache.alloc(i.templateId);i.row=d.row,i.stale||(i.stale=d.isReusingConnectedDomNode)}const n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);const r=this.accessibilityProvider.isChecked(i.element),o=d=>d==="mixed"?"mixed":String(!!d);if(typeof r=="boolean"||r==="mixed")i.row.domNode.setAttribute("aria-checked",o(r));else if(r){const d=g=>i.row.domNode.setAttribute("aria-checked",o(g));d(r.value),i.checkedDisposable=r.onDidChange(()=>d(r.value))}if(i.stale||!i.row.domNode.parentElement){const d=((u=(c=this.items.at(e+1))==null?void 0:c.row)==null?void 0:u.domNode)??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==d)&&this.rowsContainer.insertBefore(i.row.domNode,d),i.stale=!1}this.updateItemInDOM(i,e);const a=this.renderers.get(i.templateId);if(!a)throw new Error(`No renderer found for template id ${i.templateId}`);a==null||a.renderElement(i.element,e,i.row.templateData,{height:i.size});const l=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!l,l&&(i.dragStartDisposable=J(i.row.domNode,"dragstart",d=>this.onDragStart(i.element,l,d))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=YI(e.row.domNode);const t=Ae(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e,t){const i=this.items[e];if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const n=this.renderers.get(i.templateId);n&&n.disposeElement&&n.disposeElement(i.element,e,i.row.templateData,{height:i.size,onScroll:t}),this.cache.release(i.row),i.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return ge.map(this.disposables.add(new Nt(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return ge.map(this.disposables.add(new Nt(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return ge.filter(ge.map(this.disposables.add(new Nt(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return ge.map(this.disposables.add(new Nt(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return ge.map(this.disposables.add(new Nt(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return ge.map(this.disposables.add(new Nt(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return ge.any(ge.map(this.disposables.add(new Nt(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),ge.map(this.disposables.add(new Nt(this.domNode,Qt.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return ge.map(this.disposables.add(new Nt(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return ge.map(this.disposables.add(new Nt(this.rowsContainer,Qt.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:r}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth,void 0,!0),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){var o,a;if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(Dee.TEXT,t);let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(n,i)),typeof r>"u"&&(r=String(n.length)),XNe(i,this.domNode,r,[this.domId]),this.domNode.classList.add("dragging"),this.currentDragData=new Xv(n),tf.CurrentDragAndDropData=new ZNe(n),(a=(o=this.dnd).onDragStart)==null||a.call(o,this.currentDragData,i)}onPotentialSelectionStart(e){this.currentSelectionDisposable.dispose();const t=Fpe(this.domNode),i=this.currentSelectionDisposable=new Ee,n=i.add(new Ee);n.add(J(this.domNode,"selectstart",()=>{n.add(J(t,"mousemove",r=>{var o;((o=t.getSelection())==null?void 0:o.isCollapsed)===!1&&this.setupDragAndDropScrollTopAnimation(r)})),i.add(Fe(()=>{const r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.currentSelectionBounds=void 0,this.render(r,this.lastRenderTop,this.lastRenderHeight,void 0,void 0)})),i.add(J(t,"selectionchange",()=>{const r=t.getSelection();if(!r||r.isCollapsed){n.isDisposed&&i.dispose();return}let o=this.getIndexOfListElement(r.anchorNode),a=this.getIndexOfListElement(r.focusNode);o!==void 0&&a!==void 0&&(a<o&&([o,a]=[a,o]),this.currentSelectionBounds={start:o,end:a})}))})),n.add(J(t,"mouseup",()=>{var r;n.dispose(),this.teardownDragAndDropScrollTopAnimation(),((r=t.getSelection())==null?void 0:r.isCollapsed)!==!1&&i.dispose()}))}getIndexOfListElement(e){var t;if(!(!e||!this.domNode.contains(e)))for(;e&&e!==this.domNode;){if((t=e.dataset)!=null&&t.index)return Number(e.dataset.index);e=e.parentElement}}onDragOver(e){var r,o;if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),tf.CurrentDragAndDropData&&tf.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(tf.CurrentDragAndDropData)this.currentDragData=tf.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new JNe}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&((r=t.effect)==null?void 0:r.type)===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=Ag(i).filter(a=>a>=-1&&a<this.length).sort((a,l)=>a-l),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(eIe(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=Fe(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(const a of i){const l=this.items[a];l.dropTarget=!0,(o=l.row)==null||o.domNode.classList.add(n)}this.currentDragFeedbackDisposable=Fe(()=>{var a;for(const l of i){const c=this.items[l];c.dropTarget=!1,(a=c.row)==null||a.domNode.classList.remove(n)}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=a4(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&((i=(t=this.dnd).onDragLeave)==null||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,tf.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){var t,i;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,tf.CurrentDragAndDropData=void 0,(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=ne.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=qpe(this.domNode).top;this.dragOverAnimationDisposable=i_e(Ae(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=a4(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;const i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return tr(n,0,3)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;(Wi(i)||XQ(i))&&i!==this.rowsContainer&&t.contains(i);){const n=i.getAttribute("data-index");if(n){const r=Number(n);if(!isNaN(r))return r}i=i.parentElement}}getVisibleRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}getRenderRange(e,t){const i=this.getVisibleRange(e,t);if(this.currentSelectionBounds){const n=this.rangeMap.count;i.start=Math.min(i.start,this.currentSelectionBounds.start,n),i.end=Math.min(Math.max(i.end,this.currentSelectionBounds.end+1),n)}return i}_rerender(e,t,i){const n=this.getRenderRange(e,t);let r,o;e===this.elementTop(n.start)?(r=n.start,o=0):n.end-n.start>1&&(r=n.start+1,o=this.elementTop(r)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let u=l.start;u<l.end;u++){const d=this.probeDynamicHeight(u);d!==0&&this.rangeMap.splice(u,1,[this.items[u]]),a+=d,c=c||d!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const u=ns.relativeComplement(n,l);for(const g of u)for(let p=g.start;p<g.end;p++)this.items[p].row&&this.removeItemFromDOM(p);const d=ns.relativeComplement(l,n).reverse();for(const g of d)for(let p=g.end-1;p>=g.start;p--)this.insertItemInDOM(p);for(let g=l.start;g<l.end;g++)this.items[g].row&&this.updateItemInDOM(this.items[g],g);if(typeof r=="number"){const g=this.scrollable.getFutureScrollPosition().scrollTop-e,p=this.elementTop(r)-o+g;this.setScrollTop(p,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){var o,a,l;const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const c=this.virtualDelegate.getDynamicHeight(t.element);if(c!==null){const u=t.size;return t.size=c,t.lastDynamicHeightWidth=this.renderWidth,c-u}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!xn(t.row.domNode,Ae(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;const{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const r=this.renderers.get(t.templateId);if(!r)throw new Pe("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,n.templateData),t.size=n.domNode.offsetHeight,(o=r.disposeElement)==null||o.call(r,t.element,e,n.templateData),(l=(a=this.virtualDelegate).setDynamicHeight)==null||l.call(a,t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){var e,t,i;for(const n of this.items)if(n.dragStartDisposable.dispose(),n.checkedDisposable.dispose(),n.row){const r=this.renderers.get(n.row.templateId);r&&((e=r.disposeElement)==null||e.call(r,n.element,-1,n.row.templateData,void 0),r.disposeTemplate(n.row.templateData))}this.items=[],(t=this.domNode)==null||t.remove(),(i=this.dragOverAnimationDisposable)==null||i.dispose(),this.disposables.dispose()}};c2.InstanceCount=0;let pa=c2;zh([Si],pa.prototype,"onMouseClick",null);zh([Si],pa.prototype,"onMouseDblClick",null);zh([Si],pa.prototype,"onMouseMiddleClick",null);zh([Si],pa.prototype,"onMouseDown",null);zh([Si],pa.prototype,"onMouseOver",null);zh([Si],pa.prototype,"onMouseOut",null);zh([Si],pa.prototype,"onContextMenu",null);zh([Si],pa.prototype,"onTouchStart",null);zh([Si],pa.prototype,"onTap",null);function Jw(s){return new iIe(s)}class iIe extends zQ{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}var kd=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class nIe{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex(r=>r.templateData===i);if(n>=0){const r=this.renderedElements[n];this.trait.unrender(i),r.index=t}else{const r={index:t,templateData:i};this.renderedElements.push(r)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const r of this.renderedElements)r.index<e?n.push(r):r.index>=e+t&&n.push({index:r.index+i-t,templateData:r.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let sE=class{get onChange(){return this._onChange.event}get name(){return this._trait}get renderer(){return new nIe(this)}constructor(e){this._trait=e,this.indexes=[],this.sortedIndexes=[],this._onChange=new $}splice(e,t,i){const n=i.length-t,r=e+t,o=[];let a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)o.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&o.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)o.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(o,o)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort($$),t)}_set(e,t,i){const n=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const o=yO(r,e);return this.renderer.renderIndexes(o),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return wfe(this.sortedIndexes,e,$$)>=0}dispose(){Zi(this._onChange)}};kd([Si],sE.prototype,"renderer",null);class sIe extends sE{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class XR{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const r=new Set(n),o=i.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,o)}}function Zv(s,e){return s.classList.contains(e)?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:Zv(s.parentElement,e)}function E0(s){return Zv(s,"monaco-editor")}function rIe(s){return Zv(s,"monaco-custom-toggle")}function oIe(s){return Zv(s,"action-item")}function _C(s){return Zv(s,"monaco-tree-sticky-row")}function ev(s){return s.classList.contains("monaco-tree-sticky-container")}function Iee(s){return s.tagName==="A"&&s.classList.contains("monaco-button")||s.tagName==="DIV"&&s.classList.contains("monaco-button-dropdown")?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:Iee(s.parentElement)}class Ree{get onKeyDown(){return ge.chain(this.disposables.add(new Nt(this.view.domNode,"keydown")).event,e=>e.filter(t=>!qa(t.target)).map(t=>new jt(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new Ee,this.multipleSelectionDisposables=new Ee,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(rt?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Ms(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}kd([Si],Ree.prototype,"onKeyDown",null);var Rl;(function(s){s[s.Automatic=0]="Automatic",s[s.Trigger=1]="Trigger"})(Rl||(Rl={}));var Zp;(function(s){s[s.Idle=0]="Idle",s[s.Typing=1]="Typing"})(Zp||(Zp={}));const aIe=new class{mightProducePrintableCharacter(s){return s.ctrlKey||s.metaKey||s.altKey?!1:s.keyCode>=31&&s.keyCode<=56||s.keyCode>=21&&s.keyCode<=30||s.keyCode>=98&&s.keyCode<=107||s.keyCode>=85&&s.keyCode<=95}};class lIe{constructor(e,t,i,n,r){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=n,this.delegate=r,this.enabled=!1,this.state=Zp.Idle,this.mode=Rl.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new Ee,this.disposables=new Ee,this.updateOptions(e.options)}updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??Rl.Automatic}enable(){if(this.enabled)return;let e=!1;const t=ge.chain(this.enabledDisposables.add(new Nt(this.view.domNode,"keydown")).event,r=>r.filter(o=>!qa(o.target)).filter(()=>this.mode===Rl.Automatic||this.triggered).map(o=>new jt(o)).filter(o=>e||this.keyboardNavigationEventFilter(o)).filter(o=>this.delegate.mightProducePrintableCharacter(o)).forEach(o=>vt.stop(o,!0)).map(o=>o.browserEvent.key)),i=ge.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);ge.reduce(ge.any(t,i),(r,o)=>o===null?null:(r||"")+o,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var t;const e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){const i=(t=this.list.options.accessibilityProvider)==null?void 0:t.getAriaLabel(this.list.element(e[0]));typeof i=="string"?Nw(i):i&&Nw(i.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=Zp.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===Zp.Idle?1:0;this.state=Zp.Typing;for(let r=0;r<this.list.length;r++){const o=(i+r+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(o)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Xk(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}const c=V2e(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}else if(typeof l>"u"||Xk(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class cIe{constructor(e,t){this.list=e,this.view=t,this.disposables=new Ee;const i=ge.chain(this.disposables.add(new Nt(t.domNode,"keydown")).event,r=>r.filter(o=>!qa(o.target)).map(o=>new jt(o)));ge.chain(i,r=>r.filter(o=>o.keyCode===2&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!n||!Wi(n)||n.tabIndex===-1)return;const r=Ae(n).getComputedStyle(n);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function Aee(s){return rt?s.browserEvent.metaKey:s.browserEvent.ctrlKey}function Mee(s){return s.browserEvent.shiftKey}function hIe(s){return z7(s)&&s.button===2}const j$={isSelectionSingleChangeEvent:Aee,isSelectionRangeChangeEvent:Mee};class Oee{get onPointer(){return this._onPointer.event}constructor(e){this.list=e,this.disposables=new Ee,this._onPointer=this.disposables.add(new $),e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||j$),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add($s.addTarget(e.getHTMLElement()))),ge.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||j$))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){E0(e.browserEvent.target)||Ln()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(qa(e.browserEvent.target)||E0(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||qa(e.browserEvent.target)||E0(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),hIe(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(qa(e.browserEvent.target)||E0(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));const n=Math.min(i,t),r=Math.max(i,t),o=Ms(n,r+1),a=this.list.getSelection(),l=gIe(yO(a,[i]),i);if(l.length===0)return;const c=yO(o,mIe(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),r=n.filter(o=>o!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}}class uIe{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const n=Th(e.listFocusAndSelectionOutline,Th(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.focused,
				.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const r=Th(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-enable-motion .monaco-table:hover > .monaco-split-view2,
				.monaco-enable-motion .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-enable-motion .monaco-table > .monaco-split-view2,
				.monaco-enable-motion .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}}const dIe={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:ae.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:ae.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:ae.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},fIe={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function gIe(s,e){const t=s.indexOf(e);if(t===-1)return[];const i=[];let n=t-1;for(;n>=0&&s[n]===e-(t-n);)i.push(s[n--]);for(i.reverse(),n=t;n<s.length&&s[n]===e+(n-t);)i.push(s[n++]);return i}function yO(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){t.push(s[i]),i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):t.push(e[n++]);return t}function mIe(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):n++;return t}const $$=(s,e)=>s-e;class pIe{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let r=0;for(const o of this.renderers)o.renderElement(e,t,i[r++],n)}disposeElement(e,t,i,n){var o;let r=0;for(const a of this.renderers)(o=a.disposeElement)==null||o.call(a,e,t,i[r],n),r+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class _Ie{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return{container:e,disposables:new Ee}}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e),r=n&&typeof n!="string"?n:Jw(n);i.disposables.add(ct(a=>{this.setAriaLabel(a.readObservable(r),i.container)}));const o=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof o=="number"?i.container.setAttribute("aria-level",`${o}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}}class bIe{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,e,t)}onDragOver(e,t,i,n,r){return this.dnd.onDragOver(e,t,i,n,r)}onDragLeave(e,t,i,n){var r,o;(o=(r=this.dnd).onDragLeave)==null||o.call(r,e,t,i,n)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}drop(e,t,i,n,r){this.dnd.drop(e,t,i,n,r)}dispose(){this.dnd.dispose()}}class il{get onDidChangeFocus(){return ge.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return ge.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=ge.chain(this.disposables.add(new Nt(this.view.domNode,"keydown")).event,r=>r.map(o=>new jt(o)).filter(o=>e=o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>vt.stop(o,!0)).filter(()=>!1)),i=ge.chain(this.disposables.add(new Nt(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(o=>new jt(o)).filter(o=>o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>vt.stop(o,!0)).map(({browserEvent:o})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,u=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:u,browserEvent:o}})),n=ge.chain(this.view.onContextMenu,r=>r.filter(o=>!e).map(({element:o,index:a,browserEvent:l})=>({element:o,index:a,anchor:new io(Ae(this.view.domNode),l),browserEvent:l})));return ge.any(t,i,n)}get onKeyDown(){return this.disposables.add(new Nt(this.view.domNode,"keydown")).event}get onDidFocus(){return ge.signal(this.disposables.add(new Nt(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return ge.signal(this.disposables.add(new Nt(this.view.domNode,"blur",!0)).event)}constructor(e,t,i,n,r=fIe){var c,u,d;this.user=e,this._options=r,this.focus=new sE("focused"),this.anchor=new sE("anchor"),this.eventBufferer=new Dv,this._ariaLabel="",this.disposables=new Ee,this._onDidDispose=new $,this.onDidDispose=this._onDidDispose.event;const o=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(c=this._options.accessibilityProvider)==null?void 0:c.getWidgetRole():"list";this.selection=new sIe(o!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new _Ie(this.accessibilityProvider)),(d=(u=this.accessibilityProvider).onDidChangeActiveDescendant)==null||d.call(u,this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(g=>new pIe(g.templateId,[...a,g]));const l={...r,dnd:r.dnd&&new bIe(this,r.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",o),r.styleController)this.styleController=r.styleController(this.view.domId);else{const g=Qa(this.view.domNode);this.styleController=new uIe(g,this.view.domId)}if(this.spliceable=new qNe([new XR(this.focus,this.view,r.identityProvider),new XR(this.selection,this.view,r.identityProvider),new XR(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new cIe(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new Ree(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){const g=r.keyboardNavigationDelegate||aIe;this.typeNavigationController=new lIe(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),g),this.disposables.add(this.typeNavigationController)}if(this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider){const g=this.accessibilityProvider.getWidgetAriaLabel(),p=g&&typeof g!="string"?g:Jw(g);this.disposables.add(ct(_=>{this.ariaLabel=_.readObservable(p)}))}this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,n){return new pa(e,t,i,n)}createMouseController(e){return new Oee(this)}updateOptions(e={}){var t,i;this._options={...this._options,...e},(t=this.typeNavigationController)==null||t.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(i=this.keyboardController)==null||i.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new ef(this.user,`Invalid start index: ${e}`);if(t<0)throw new ef(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new ef(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new ef(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new ef(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;const r=this.focus.get(),o=this.findNextIndex(r.length>0?r[0]+e:0,t,n);o>-1&&this.setFocus([o],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;const r=this.focus.get(),o=this.findPreviousIndex(r.length>0?r[0]-e:0,t,n);o>-1&&this.setFocus([o],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){const r=this.findPreviousIndex(i,!1,t);r>-1&&n!==r?this.setFocus([r],e):this.setFocus([i],e)}else{const r=this.view.getScrollTop();let o=r+this.view.renderHeight;i>n&&(o-=this.view.elementHeight(i)),this.view.setScrollTop(o),this.view.getScrollTop()!==r&&(this.setFocus([]),await c1(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n;const r=i(),o=this.view.getScrollTop()+r;o===0?n=this.view.indexAt(o):n=this.view.indexAfter(o-1);const a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){const l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{const l=o;this.view.setScrollTop(o-this.view.renderHeight-r),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await c1(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new ef(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),r=this.view.elementTop(e),o=this.view.elementHeight(e);if(nm(t)){const a=o-this.view.renderHeight+i;this.view.setScrollTop(a*tr(t,0,1)+r-i)}else{const a=r+o,l=n+this.view.renderHeight;r<n+i&&a>=l||(r<n+i||a>=l&&o>=this.view.renderHeight?this.view.setScrollTop(r-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new ef(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),r=this.view.elementHeight(e);if(n<i+t||n+r>i+this.view.renderHeight)return null;const o=r-this.view.renderHeight+t;return Math.abs((i+t-n)/o)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var t;const e=this.focus.get();if(e.length>0){let i;(t=this.accessibilityProvider)!=null&&t.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}kd([Si],il.prototype,"onDidChangeFocus",null);kd([Si],il.prototype,"onDidChangeSelection",null);kd([Si],il.prototype,"onContextMenu",null);kd([Si],il.prototype,"onKeyDown",null);kd([Si],il.prototype,"onDidFocus",null);kd([Si],il.prototype,"onDidBlur",null);const Qf=Ve,Pee="selectOption.entry.template";class CIe{get templateId(){return Pee}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=De(e,Qf(".option-text")),t.detail=De(e,Qf(".option-detail")),t.decoratorRight=De(e,Qf(".option-decorator-right")),t}renderElement(e,t,i){const n=i,r=e.text,o=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=r,n.detail.textContent=o||"",n.decoratorRight.textContent=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}}const xl=class xl extends ne{constructor(e,t,i,n,r){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._selectionDetailsDisposables=this._register(new Ee),this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=n,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=xl.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new $,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(tl().setupManagedHover(Ld("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return Pee}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=Ve(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=De(this.selectDropDownContainer,Qf(".select-box-details-pane"));const t=De(this.selectDropDownContainer,Qf(".select-box-dropdown-container-width-control")),i=De(t,Qf(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",De(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Qa(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(J(this.selectDropDownContainer,pe.DRAG_START,n=>{vt.stop(n,!0)}))}registerListeners(){this._register(Xn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(J(this.selectElement,pe.CLICK,t=>{vt.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(J(this.selectElement,pe.MOUSE_DOWN,t=>{vt.stop(t)}));let e;this._register(J(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(J(this.selectElement,"touchend",t=>{vt.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(J(this.selectElement,pe.KEY_DOWN,t=>{const i=new jt(t);let n=!1;rt?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),vt.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){sn(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){var e;(e=this.selectList)==null||e.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){const e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){const e=this.styles.selectBackground??"",t=Th(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;const i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.textContent="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=Ae(this.selectElement),i=Mo(this.selectElement),n=Ae(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),o=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-xl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),u=Math.max(c,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=u,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let d=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const g=this._hasDetails?this._cachedMaxDetailsHeight:0,p=d+r+g,_=Math.floor((o-r-g)/this.getHeight()),C=Math.floor((a-r-g)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<xl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||_<1&&C<1?!1:(_<xl.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&C>_&&this.options.length>_?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<xl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&_<1||this._dropDownPosition===1&&C<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&_+C<1)return this.hideSelectDropDown(!0),!1;p>o&&(d=_*this.getHeight())}else p>a&&(d=C*this.getHeight());return this.selectList.layout(d),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=d+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=d+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=u,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((r,o)=>{const a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,c=r.text.length+a+l;c>n&&(i=o,n=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=W7(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=De(e,Qf(".select-box-dropdown-list-container")),this.listRenderer=new CIe,this.selectList=this._register(new il("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let r=n.text;return n.detail&&(r+=`. ${n.detail}`),n.decoratorRight&&(r+=`. ${n.decoratorRight}`),n.description&&(r+=`. ${n.description}`),r},getWidgetAriaLabel:()=>w(16,"Select Box"),getRole:()=>rt?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new Nt(this.selectDropDownListContainer,"keydown")),i=ge.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(r=>new jt(r)));this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(ge.chain(i,n=>n.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(J(this.selectList.getHTMLElement(),pe.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(J(this.selectDropDownContainer,pe.FOCUS_OUT,n=>{!this._isVisible||xn(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;vt.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const n=Number(i.getAttribute("data-index")),r=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!r&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=r=>{for(let o=0;o<r.childNodes.length;o++){const a=r.childNodes.item(o);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=i9({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this._selectionDetailsDisposables.clear(),this.selectionDetailsPane.textContent="";const t=this.options[e],i=(t==null?void 0:t.description)??"",n=(t==null?void 0:t.descriptionIsMarkdown)??!1;if(i){if(n){const r=t.descriptionMarkdownActionHandler,o=this._selectionDetailsDisposables.add(this.renderDescriptionMarkdown(i,r));this.selectionDetailsPane.appendChild(o.element)}else this.selectionDetailsPane.textContent=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){vt.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){vt.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){vt.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(vt.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){vt.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){vt.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){vt.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){vt.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=oh.toString(e.keyCode);let i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),vt.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};xl.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32,xl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2,xl.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;let SO=xl;class wIe extends ne{constructor(e,t,i,n){super(),this.selected=0,this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new $),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register($s.addTarget(this.selectElement)),[Qt.Tap].forEach(e=>{this._register(J(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Xn(this.selectElement,"click",e=>{vt.stop(e,!0)})),this._register(Xn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Xn(this.selectElement,"keydown",e=>{let t=!1;rt?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!sn(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}}class vIe extends oc{constructor(e,t,i,n,r){super(),rt&&!(r!=null&&r.useCustomDrawn)?this.selectBoxDelegate=new wIe(e,t,n,r):this.selectBoxDelegate=new SO(e,t,i,n,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class Pa extends ne{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof Zu&&this._register(t.onDidChange(n=>{this.element&&this.handleActionChangeEvent(n)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Hg)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register($s.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,Er&&this._register(J(e,pe.DRAG_START,n=>{var r;return(r=n.dataTransfer)==null?void 0:r.setData(Dee.TEXT,this._action.label)}))),this._register(J(t,Qt.Tap,n=>this.onClick(n,!0))),this._register(J(t,pe.MOUSE_DOWN,n=>{i||vt.stop(n,!0),this._action.enabled&&n.button===0&&t.classList.add("active")})),rt&&this._register(J(t,pe.CONTEXT_MENU,n=>{n.button===0&&n.ctrlKey===!0&&this.onClick(n)})),this._register(J(t,pe.CLICK,n=>{vt.stop(n,!0),this.options&&this.options.isMenu||this.onClick(n)})),this._register(J(t,pe.DBLCLICK,n=>{vt.stop(n,!0)})),[pe.MOUSE_UP,pe.MOUSE_OUT].forEach(n=>{this._register(J(t,n,r=>{vt.stop(r),t.classList.remove("active")}))})}onClick(e,t=!1){var n;vt.stop(e,!0);const i=Ro(this._context)?(n=this.options)!=null&&n.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}getHoverContents(){return this.getTooltip()}updateTooltip(){if(!this.element)return;const e=this.getHoverContents()??"";if(this.updateAriaLabel(),!this.customHover&&e!==""){const t=this.options.hoverDelegate??Ld("element");this.customHover=this._store.add(tl().setupManagedHover(t,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){const e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class a9 extends Pa{constructor(e,t,i){i={...i,icon:i.icon!==void 0?i.icon:!1,label:i.label!==void 0?i.label:!0},super(e,t,i),this.options=i,this.cssClass=""}render(e){super.render(e),Qu(this.element);const t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding&&!this.options.keybindingNotRenderedWithLabel){const i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===On.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label,this.options.keybinding&&(e=w(0,"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){var e;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(e=this.label)==null||e.classList.remove("codicon")}updateEnabled(){var e,t;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(e=this.element)==null||e.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(t=this.element)==null||t.classList.add("disabled"))}updateAriaLabel(){if(this.label){const e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class yIe extends Pa{constructor(e,t,i,n,r,o,a){super(e,t),this.selectBox=new vIe(i,n,r,o,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){var e;(e=this.selectBox)==null||e.focus()}blur(){var e;(e=this.selectBox)==null||e.blur()}render(e){this.selectBox.render(e)}}class SIe extends Hg{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new $),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=De(e,Ve(".monaco-dropdown")),this._label=De(this._element,Ve(".dropdown-label"));let i=t.labelRenderer;i||(i=r=>(r.textContent=t.label||"",null));for(const r of[pe.CLICK,pe.MOUSE_DOWN,Qt.Tap])this._register(J(this.element,r,o=>vt.stop(o,!0)));for(const r of[pe.MOUSE_DOWN,Qt.Tap])this._register(J(this._label,r,o=>{z7(o)&&o.button!==0||(this.visible?this.hide():this.show())}));this._register(J(this._label,pe.KEY_DOWN,r=>{const o=new jt(r);(o.equals(3)||o.equals(10))&&(vt.stop(r,!0),this.visible?this.hide():this.show())}));const n=i(this._label);n&&this._register(n),this._register($s.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class xIe extends SIe{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class rE extends Pa{get onDidChangeVisibility(){return this._onDidChangeVisibility.event}constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new $),this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=r=>(this.element=De(r,Ve("a.action-label")),this.renderLabel(this.element)),i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new xIe(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{var o;(o=this.element)==null||o.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}renderLabel(e){let t=[];return typeof this.options.classNames=="string"?t=this.options.classNames.split(/\s+/g).filter(i=>!!i):this.options.classNames&&(t=this.options.classNames),t.find(i=>i==="icon")||t.push("codicon"),e.classList.add(...t),this._action.label&&this._register(tl().setupManagedHover(this.options.hoverDelegate??Ld("mouse"),e,this._action.label)),null}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){var e;(e=this.dropdownMenu)==null||e.show()}updateEnabled(){var t,i;const e=!this.action.enabled;(t=this.actionItem)==null||t.classList.toggle("disabled",e),(i=this.element)==null||i.classList.toggle("disabled",e)}}function LIe(s){return s?s.condition!==void 0:!1}function kIe(s,e){const t={...e};for(const i in s){const n=s[i];t[i]=n!==void 0?Ce(n):void 0}return t}const EIe={keybindingLabelBackground:Ce(swe),keybindingLabelForeground:Ce(rwe),keybindingLabelBorder:Ce(owe),keybindingLabelBottomBorder:Ce(awe),keybindingLabelShadow:Ce(Hv)},DIe={buttonForeground:Ce(rZ),buttonSeparator:Ce(jCe),buttonBackground:Ce(v0),buttonHoverBackground:Ce($Ce),buttonSecondaryForeground:Ce(GCe),buttonSecondaryBackground:Ce(J4),buttonSecondaryHoverBackground:Ce(KCe),buttonBorder:Ce(qCe)},TIe={progressBarBackground:Ce(lCe)},Fee={inputActiveOptionBorder:Ce(iZ),inputActiveOptionForeground:Ce(sZ),inputActiveOptionBackground:Ce(nZ)};Ce(y0),Ce(YCe),Ce(QCe),Ce(XCe),Ce(ZCe),Ce(JCe),Ce(ewe);const l9={checkboxBackground:Ce(d6),checkboxBorder:Ce(twe),checkboxForeground:Ce(f6),checkboxDisabledBackground:Ce(iwe),checkboxDisabledForeground:Ce(nwe)};Ce(ha),Ce(kD),Ce(Hv),Ce(eZ),Ce(vCe),Ce(yCe),Ce(SCe),Ce(oCe);const Bee={inputBackground:Ce(NCe),inputForeground:Ce(ICe),inputBorder:Ce(RCe),inputValidationInfoBorder:Ce(PCe),inputValidationInfoBackground:Ce(MCe),inputValidationInfoForeground:Ce(OCe),inputValidationWarningBorder:Ce(VCe),inputValidationWarningBackground:Ce(FCe),inputValidationWarningForeground:Ce(BCe),inputValidationErrorBorder:Ce(zCe),inputValidationErrorBackground:Ce(WCe),inputValidationErrorForeground:Ce(HCe)},NIe={listFilterWidgetBackground:Ce(Cwe),listFilterWidgetOutline:Ce(wwe),listFilterWidgetNoMatchesOutline:Ce(vwe),listFilterWidgetShadow:Ce(ywe),inputBoxStyles:Bee,toggleStyles:Fee},IIe={badgeBackground:Ce(zx),badgeForeground:Ce(aCe),badgeBorder:Ce(Ct)};Ce(CCe),Ce(bCe),Ce(mU),Ce(mU),Ce(wCe);const Jv={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:Ce(lwe),listFocusForeground:Ce(cwe),listFocusOutline:Ce(hwe),listActiveSelectionBackground:Ce(jg),listActiveSelectionForeground:Ce(Rw),listActiveSelectionIconForeground:Ce(oZ),listFocusAndSelectionOutline:Ce(uwe),listFocusAndSelectionBackground:Ce(jg),listFocusAndSelectionForeground:Ce(Rw),listInactiveSelectionBackground:Ce(dwe),listInactiveSelectionIconForeground:Ce(gwe),listInactiveSelectionForeground:Ce(fwe),listInactiveFocusBackground:Ce(mwe),listInactiveFocusOutline:Ce(pwe),listHoverBackground:Ce(aZ),listHoverForeground:Ce(lZ),listDropOverBackground:Ce(_we),listDropBetweenBackground:Ce(bwe),listSelectionOutline:Ce(Hi),listHoverOutline:Ce(Hi),treeIndentGuidesStroke:Ce(cZ),treeInactiveIndentGuidesStroke:Ce(Swe),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:Ce(a6),tableColumnsBorder:Ce(xwe),tableOddRowsBackgroundColor:Ce(Lwe)};function ey(s){return kIe(s,Jv)}const RIe={selectBackground:Ce(ED),selectListBackground:Ce(UCe),selectForeground:Ce(h6),decoratorRightForeground:Ce(hZ),selectBorder:Ce(u6),focusBorder:Ce(Xl),listFocusBackground:Ce(t5),listInactiveSelectionIconForeground:Ce(uZ),listFocusForeground:Ce(e5),listFocusOutline:eCe(Hi,ae.transparent.toString()),listHoverBackground:Ce(aZ),listHoverForeground:Ce(lZ),listHoverOutline:Ce(Hi),selectListBorder:Ce(YX),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},AIe={shadowColor:Ce(Hv),borderColor:Ce(kwe),foregroundColor:Ce(Ewe),backgroundColor:Ce(Dwe),selectionForegroundColor:Ce(Twe),selectionBackgroundColor:Ce(Nwe),selectionBorderColor:Ce(Iwe),separatorColor:Ce(Rwe),scrollbarShadow:Ce(a6),scrollbarSliderBackground:Ce(qX),scrollbarSliderHoverBackground:Ce(GX),scrollbarSliderActiveBackground:Ce(KX)};function MIe(s,e){if(Fh)return!1;const t=OIe(s,e),i=s.getValue("window");return(i==null?void 0:i.menuStyle)==="native"?!(!rt&&!t):(i==null?void 0:i.menuStyle)==="custom"?!1:t}function OIe(s,e){return e||(e=Vee(s)),e==="native"}function Vee(s){if(Fh)return"custom";const e=s.getValue("window");if(e){if(rt&&e.nativeTabs===!0||rt&&e.nativeFullScreen===!1)return"native";const n=e.titleBarStyle;if(n==="native"||n==="custom")return n}return"custom"}function PIe(s){if(Fh||rt||Vee(s)==="native")return"native";const e=s.getValue("window"),t=e==null?void 0:e.controlsStyle;return t==="custom"||t==="hidden"?t:"native"}var zD=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Fs=function(s,e){return function(t,i){e(t,i,s)}};function FIe(s,e){const t=[];return BIe(s,t),t}function BIe(s,e,t){const i=Ou.getInstance(),n=i.keyStatus.altKey||(cr||kr)&&i.keyStatus.shiftKey;Wee(s,e,n,r=>r==="navigation")}function VIe(s,e,t,i){const n={primary:[],secondary:[]};return WIe(s,n,e,t,i),n}function WIe(s,e,t,i,n){Wee(s,e,!1,typeof t=="string"?o=>o===t:t,i,n)}function Wee(s,e,t,i=o=>o==="navigation",n=()=>!1,r=!1){let o,a;Array.isArray(e)?(o=e,a=e):(o=e.primary,a=e.secondary);const l=new Set;for(const[c,u]of s){let d;i(c)?(d=o,d.length>0&&r&&d.push(new On)):(d=a,d.length>0&&d.push(new On));for(let g of u){t&&(g=g instanceof Lh&&g.alt?g.alt:g);const p=d.push(g);g instanceof aD&&l.add({group:c,action:g,index:p-1})}}for(const{group:c,action:u,index:d}of l){const g=i(c)?o:a,p=u.actions;n(u,c,g.length)&&g.splice(d,1,...p)}}let tv=class extends a9{constructor(e,t,i,n,r,o,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable,keybinding:t==null?void 0:t.keybinding,hoverDelegate:t==null?void 0:t.hoverDelegate,keybindingNotRenderedWithLabel:t==null?void 0:t.keybindingNotRenderedWithLabel}),this._options=t,this._keybindingService=i,this._notificationService=n,this._contextKeyService=r,this._themeService=o,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new kn),this._altKey=Ou.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{var r;const n=!!((r=this._menuItemAction.alt)!=null&&r.enabled)&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);n!==this._wantsAltCommand&&(this._wantsAltCommand=n,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(J(e,"mouseleave",n=>{t=!1,i()})),this._register(J(e,"mouseenter",n=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var r;const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?w(1644,"{0} ({1})",i,t):i;if(!this._wantsAltCommand&&((r=this._menuItemAction.alt)!=null&&r.enabled)){const o=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),c=l?w(1645,"{0} ({1})",o,l):o;n=w(1646,`{0}
[{1}] {2}`,n,s9.modifierLabels[ca].altKey,c)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const n=this._commandAction.checked&&LIe(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(n)if(ht.isThemeIcon(n)){const r=ht.asClassNameArray(n);i.classList.add(...r),this._itemClassDispose.value=Fe(()=>{i.classList.remove(...r)})}else i.style.backgroundImage=gm(this._themeService.getColorTheme().type)?Jl(n.dark):Jl(n.light),i.classList.add("icon"),this._itemClassDispose.value=Bl(Fe(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};tv=zD([Fs(2,Bn),Fs(3,_a),Fs(4,St),Fs(5,Ir),Fs(6,Hh),Fs(7,uo)],tv);let xO=class extends rE{constructor(e,t,i,n,r){const o={...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!1,classNames:(t==null?void 0:t.classNames)??(ht.isThemeIcon(e.item.icon)?ht.asClassName(e.item.icon):void 0),keybindingProvider:(t==null?void 0:t.keybindingProvider)??(a=>i.lookupKeybinding(a.id))};super(e,{getActions:()=>e.actions},n,o),this._keybindingService=i,this._contextMenuService=n,this._themeService=r}render(e){super.render(e),Qu(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!ht.isThemeIcon(i)){this.element.classList.add("icon");const n=()=>{this.element&&(this.element.style.backgroundImage=gm(this._themeService.getColorTheme().type)?Jl(i.dark):Jl(i.light))};n(),this._register(this._themeService.onDidColorThemeChange(()=>{n()}))}}};xO=zD([Fs(2,Bn),Fs(3,Hh),Fs(4,Ir)],xO);let LO=class extends Pa{constructor(e,t,i,n,r,o,a,l){super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=r,this._menuService=o,this._instaService=a,this._storageService=l,this._defaultActionDisposables=this._register(new Ee),this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c;const u=t!=null&&t.togglePrimaryAction?l.get(this._storageKey,1):void 0;u&&(c=e.actions.find(g=>u===g.id)),c||(c=e.actions[0]),this._defaultAction=this._defaultActionDisposables.add(this._instaService.createInstance(tv,c,{keybinding:this._getDefaultActionKeybindingLabel(c)}));const d={keybindingProvider:g=>this._keybindingService.lookupKeybinding(g.id),...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!0,classNames:(t==null?void 0:t.classNames)??["codicon","codicon-chevron-down"],actionRunner:(t==null?void 0:t.actionRunner)??this._register(new Hg)};this._dropdown=this._register(new rE(e,e.actions,this._contextMenuService,d)),t!=null&&t.togglePrimaryAction&&this._register(this._dropdown.actionRunner.onDidRun(g=>{g.action instanceof Lh&&this.update(g.action)}))}update(e){var t;(t=this._options)!=null&&t.togglePrimaryAction&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultActionDisposables.clear(),this._defaultAction=this._defaultActionDisposables.add(this._instaService.createInstance(tv,e,{keybinding:this._getDefaultActionKeybindingLabel(e)})),this._defaultAction.actionRunner=this._defaultActionDisposables.add(new class extends Hg{async runAction(i,n){await i.run(void 0)}}),this._container&&this._defaultAction.render(rD(this._container,Ve(".action-container")))}_getDefaultActionKeybindingLabel(e){var i;let t;if((i=this._options)!=null&&i.renderKeybindingWithDefaultActionLabel){const n=this._keybindingService.lookupKeybinding(e.id);n&&(t=`(${n.getLabel()})`)}return t}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}set actionRunner(e){super.actionRunner=e,this._defaultAction.actionRunner=e,this._dropdown.actionRunner=e}get actionRunner(){return super.actionRunner}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=Ve(".action-container");this._defaultAction.render(De(this._container,t)),this._register(J(t,pe.KEY_DOWN,n=>{const r=new jt(n);r.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),r.stopPropagation())}));const i=Ve(".dropdown-action-container");this._dropdown.render(De(this._container,i)),this._register(J(i,pe.KEY_DOWN,n=>{var o;const r=new jt(n);r.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(o=this._defaultAction.element)==null||o.focus(),r.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}};LO=zD([Fs(2,Bn),Fs(3,_a),Fs(4,Hh),Fs(5,cm),Fs(6,wt),Fs(7,Qv)],LO);let kO=class extends yIe{constructor(e,t,i){super(null,e,e.actions.map(n=>({text:n.id===On.ID?"":n.label,isDisabled:!n.enabled})),0,t,RIe,{ariaLabel:e.tooltip,optionsAsChildren:!0,useCustomDrawn:!MIe(i)}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=Ce(u6)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};kO=zD([Fs(1,Gv),Fs(2,ai)],kO);function Hee(s,e,t){return e instanceof Lh?s.createInstance(tv,e,t):e instanceof x_?e.item.isSelection?s.createInstance(kO,e):e.item.isSplitButton?s.createInstance(LO,e,{...t,togglePrimaryAction:typeof e.item.isSplitButton!="boolean"?e.item.isSplitButton.togglePrimaryAction:!1}):s.createInstance(xO,e,t):void 0}class zl extends ne{get onDidBlur(){return this._onDidBlur.event}get onDidCancel(){return this._onDidCancel.event}get onDidRun(){return this._onDidRun.event}get onWillRun(){return this._onWillRun.event}constructor(e,t={}){var r,o;super(),this._actionRunnerDisposables=this._register(new Ee),this.viewItemDisposables=this._register(new u7),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new $),this._onDidCancel=this._register(new $({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.cancelHasListener=!1,this._onDidRun=this._register(new $),this._onWillRun=this._register(new $),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:((r=this.options.triggerKeys)==null?void 0:r.keyDown)??!1,keys:((o=this.options.triggerKeys)==null?void 0:o.keys)??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Tee()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Hg,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(a=>this._onDidRun.fire(a))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(a=>this._onWillRun.fire(a))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(J(this.domNode,pe.KEY_DOWN,a=>{const l=new jt(a);let c=!0;const u=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(l.equals(i[0])||l.equals(i[1]))?c=this.focusPrevious():n&&(l.equals(n[0])||l.equals(n[1]))?c=this.focusNext():l.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():l.equals(14)?c=this.focusFirst():l.equals(13)?c=this.focusLast():l.equals(2)&&u instanceof Pa&&u.trapsArrowNavigation?c=this.focusNext(void 0,!0):this.isTriggerKeyEvent(l)?this._triggerKeys.keyDown?this.doTrigger(l):this.triggerKeyDown=!0:c=!1,c&&(l.preventDefault(),l.stopPropagation())})),this._register(J(this.domNode,pe.KEY_UP,a=>{const l=new jt(a);this.isTriggerKeyEvent(l)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(l)),l.preventDefault(),l.stopPropagation()):(l.equals(2)||l.equals(1026)||l.equals(16)||l.equals(18)||l.equals(15)||l.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(h1(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Ln()===this.domNode||!xn(Ln(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof Pa&&i.isEnabled());t instanceof Pa&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof Pa&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){var e,t;for(let i=0;i<this.actionsList.children.length;i++){const n=this.actionsList.children[i];if(xn(Ln(),n)){this.focusedItem=i,(t=(e=this.viewItems[this.focusedItem])==null?void 0:e.showHover)==null||t.call(e);break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){var t;if(typeof e=="number")return(t=this.viewItems[e])==null?void 0:t.action;if(Wi(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===e)return this.viewItems[i].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=nm(t.index)?t.index:null;if(i.forEach(r=>{const o=document.createElement("li");o.className="action-item",o.setAttribute("role","presentation");let a;const l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new a9(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,J(o,pe.CONTEXT_MENU,c=>{vt.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(o),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(o),this.viewItems.push(a)):(this.actionsList.insertBefore(o,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),this.focusable){let r=!1;for(const o of this.viewItems){if(!(o instanceof Pa))continue;let a;r||o.action.id===On.ID||!o.isEnabled()&&this.options.focusOnlyEnabledItems?a=!1:a=!0,a?(o.setFocusable(!0),r=!0):o.setFocusable(!1)}}typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){const t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),Zi(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=Zi(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),Ya(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const n=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===On.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===On.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var r,o;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((r=this.viewItems[this.previouslyFocusedItem])==null||r.blur());const n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let a=!0;o1(n.focus)||(a=!1),this.options.focusOnlyEnabledItems&&o1(n.isEnabled)&&!n.isEnabled()&&(a=!1),n.action.id===On.ID&&(a=!1),a?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),a&&((o=n.showHover)==null||o.call(n))}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof Pa){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=Zi(this.viewItems),this.getContainer().remove(),super.dispose()}}const EO=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,ZR=/(&amp;)?(&amp;)([^\s&])/g;var oE;(function(s){s[s.Right=0]="Right",s[s.Left=1]="Left"})(oE||(oE={}));var DO;(function(s){s[s.Above=0]="Above",s[s.Below=1]="Below"})(DO||(DO={}));class V_ extends zl{constructor(e,t,i,n){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const r=document.createElement("div");r.classList.add("monaco-menu"),r.setAttribute("role","presentation"),super(r,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,o),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...rt||kr?[10]:[]],keyDown:!0}}),this.menuStyles=n,this.menuElement=r,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,n),this._register($s.addTarget(r)),this._register(J(r,pe.KEY_DOWN,c=>{new jt(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(J(r,pe.KEY_DOWN,c=>{const u=c.key.toLocaleLowerCase();if(this.mnemonics.has(u)){vt.stop(c,!0);const d=this.mnemonics.get(u);if(d.length===1&&(d[0]instanceof q$&&d[0].container&&this.focusItemByElement(d[0].container),d[0].onClick(c)),d.length>1){const g=d.shift();g&&g.container&&(this.focusItemByElement(g.container),d.push(g)),this.mnemonics.set(u,d)}}})),kr&&this._register(J(r,pe.KEY_DOWN,c=>{const u=new jt(c);u.equals(14)||u.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),vt.stop(c,!0)):(u.equals(13)||u.equals(12))&&(this.focusedItem=0,this.focusPrevious(),vt.stop(c,!0))})),this._register(J(this.domNode,pe.MOUSE_OUT,c=>{const u=c.relatedTarget;xn(u,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(J(this.actionsList,pe.MOUSE_OVER,c=>{let u=c.target;if(!(!u||!xn(u,this.actionsList)||u===this.actionsList)){for(;u.parentElement!==this.actionsList&&u.parentElement!==null;)u=u.parentElement;if(u.classList.contains("action-item")){const d=this.focusedItem;this.setFocusedItem(u),d!==this.focusedItem&&this.updateFocus()}}})),this._register($s.addTarget(this.actionsList)),this._register(J(this.actionsList,Qt.Tap,c=>{let u=c.initialTarget;if(!(!u||!xn(u,this.actionsList)||u===this.actionsList)){for(;u.parentElement!==this.actionsList&&u.parentElement!==null;)u=u.parentElement;if(u.classList.contains("action-item")){const d=this.focusedItem;this.setFocusedItem(u),d!==this.focusedItem&&this.updateFocus()}}}));const o={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new m6(r,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,n),this._register(J(r,Qt.Change,c=>{vt.stop(c,!0);const u=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:u-c.translationY})})),this._register(J(a,pe.MOUSE_UP,c=>{c.preventDefault()}));const l=Ae(e);r.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,u)=>{var d;return(d=i.submenuIds)!=null&&d.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof On&&(u===t.length-1||u===0||t[u-1]instanceof On))}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof G$)).forEach((c,u,d)=>{c.updatePositionInSet(u+1,d.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(_4(e)?this.styleSheet=Qa(e):(V_.globalStyleSheet||(V_.globalStyleSheet=Qa()),this.styleSheet=V_.globalStyleSheet)),this.styleSheet.textContent=zIe(t,_4(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",n=t.backgroundColor??"",r=t.borderColor?`1px solid ${t.borderColor}`:"",o="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=r,e.style.borderRadius=o,e.style.color=i,e.style.backgroundColor=n,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){var n,r;if(e instanceof On)return new G$(t.context,e,{icon:!0},this.menuStyles);if(e instanceof aD){const o=new q$(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const a=o.getMnemonic();if(a&&o.isEnabled()){let l=[];this.mnemonics.has(a)&&(l=this.mnemonics.get(a)),l.push(o),this.mnemonics.set(a,l)}}return o}else{const o=(r=(n=t.getKeyBinding)==null?void 0:n.call(t,e))==null?void 0:r.getLabel(),a={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext,keybinding:o},l=new zee(t.context,e,a,this.menuStyles);if(t.enableMnemonics){const c=l.getMnemonic();if(c&&l.isEnabled()){let u=[];this.mnemonics.has(c)&&(u=this.mnemonics.get(c)),u.push(l),this.mnemonics.set(c,u)}}return l}}}class zee extends Pa{constructor(e,t,i,n){if(i={...i,isMenu:!0,icon:i.icon!==void 0?i.icon:!1,label:i.label!==void 0?i.label:!0},super(t,t,i),this.menuStyle=n,this.options=i,this.cssClass="",this.options.label&&i.enableMnemonics){const r=this.action.label;if(r){const o=EO.exec(r);o&&(this.mnemonic=(o[1]?o[1]:o[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new os(()=>{this.element&&(this._register(J(this.element,pe.MOUSE_UP,r=>{if(vt.stop(r,!0),Er){if(new io(Ae(this.element),r).rightButton)return;this.onClick(r)}else setTimeout(()=>{this.onClick(r)},0)})),this._register(J(this.element,pe.CONTEXT_MENU,r=>{vt.stop(r,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=De(this.element,Ve("a.action-menu-item")),this._action.id===On.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=De(this.item,Ve("span.menu-item-check"+ht.asCSSSelector(xe.menuSelection))),this.check.setAttribute("role","none"),this.label=De(this.item,Ve("span.action-label")),this.options.label&&this.options.keybinding&&(De(this.item,Ve("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)==null||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){Ya(this.label);let t=XJ(this.action.label);if(t){const i=HIe(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const n=EO.exec(t);if(n){t=ua(t),ZR.lastIndex=0;let r=ZR.exec(t);for(;r&&r[1];)r=ZR.exec(t);const o=a=>a.replace(/&amp;&amp;/g,"&amp;");r?this.label.append(Z2(o(t.substr(0,r.index))," "),Ve("u",{"aria-hidden":"true"},r[3]),Ame(o(t.substr(r.index+r[0].length))," ")):this.label.textContent=o(t).trim(),(e=this.item)==null||e.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.textContent=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",r=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=n,this.item.style.outlineOffset=r),this.check&&(this.check.style.color=t??"")}}class q$ extends zee{constructor(e,t,i,n,r){super(e,e,n,r),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new Ee),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:{horizontal:oE.Right,vertical:DO.Below},this.showScheduler=new os(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new os(()=>{this.element&&!xn(Ln(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=De(this.item,Ve("span.submenu-indicator"+ht.asCSSSelector(xe.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(J(this.element,pe.KEY_UP,t=>{const i=new jt(t);(i.equals(17)||i.equals(3))&&(vt.stop(t,!0),this.createSubmenu(!0))})),this._register(J(this.element,pe.KEY_DOWN,t=>{const i=new jt(t);Ln()===this.item&&(i.equals(17)||i.equals(3))&&vt.stop(t,!0)})),this._register(J(this.element,pe.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(J(this.element,pe.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(J(this.element,pe.FOCUS_OUT,t=>{this.element&&!xn(Ln(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){vt.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const r={top:0,left:0};return r.left=Qp(e.width,t.width,{position:n.horizontal===oE.Right?0:1,offset:i.left,size:i.width}),r.left>=i.left&&r.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(r.left=i.left+10),i.top+=10,i.height=0),r.top=Qp(e.height,t.height,{position:0,offset:i.top,size:0}),r.top+t.height===i.top&&r.top+i.height+t.height<=e.height&&(r.top+=i.height),r}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=De(this.element,Ve("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=Ae(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.submenuContainer.style.zIndex="1",this.parentData.submenu=new V_(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new w4],this.submenuOptions,this.menuStyle);const n=this.element.getBoundingClientRect(),r={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},o=this.submenuContainer.getBoundingClientRect(),a=Ae(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new ah(a.innerWidth,a.innerHeight),ah.lift(o),r,this.expandDirection);this.submenuContainer.style.left=`${c-o.left}px`,this.submenuContainer.style.top=`${l-o.top}px`,this.submenuDisposables.add(J(this.submenuContainer,pe.KEY_UP,u=>{new jt(u).equals(15)&&(vt.stop(u,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(J(this.submenuContainer,pe.KEY_DOWN,u=>{new jt(u).equals(15)&&vt.stop(u,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)==null||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class G$ extends a9{constructor(e,t,i,n){super(e,t,i),this.menuStyles=n}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function HIe(s){const e=EO,t=e.exec(s);if(!t)return s;const i=!t[1];return s.replace(e,i?"$2$3":"").trim()}function K$(s){const e=LQ()[s.id];return`.codicon-${s.id}:before { content: '\\${e.toString(16)}'; }`}function zIe(s,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${K$(xe.menuSelection)}
${K$(xe.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
	opacity: 0.7;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
			/* Fix for https://github.com/microsoft/vscode/issues/103170 */
			.monaco-menu .action-item .monaco-submenu {
				z-index: 1;
			}
		`;const i=s.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=s.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const r=s.scrollbarSliderHoverBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${r};
				}
			`);const o=s.scrollbarSliderActiveBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${o};
				}
			`)}return t}class UIe{constructor(e,t,i,n){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=Ln();let i;const n=Wi(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,layer:e.layer,render:r=>{var u;this.lastContainer=r;const o=e.getMenuClassName?e.getMenuClassName():"";o&&(r.className+=" "+o),this.options.blockMouse&&(this.block=r.appendChild(Ve(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(u=this.blockDisposable)==null||u.dispose(),this.blockDisposable=J(this.block,pe.MOUSE_DOWN,d=>d.stopPropagation()));const a=new Ee,l=e.actionRunner||a.add(new Hg);l.onWillRun(d=>this.onActionRun(d,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new V_(r,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:d=>this.keybindingService.lookupKeybinding(d.id)},AIe),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=Ae(r);return a.add(J(c,pe.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(J(c,pe.MOUSE_DOWN,d=>{if(d.defaultPrevented)return;const g=new io(c,d);let p=g.target;if(!g.rightButton){for(;p;){if(p===r)return;p=p.parentElement}this.contextViewService.hideContextView(!0)}})),Bl(a,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:r=>{var o,a,l;(o=e.onHide)==null||o.call(e,!!r),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)==null||a.dispose(),this.blockDisposable=null,this.lastContainer&&(Ln()===this.lastContainer||xn(Ln(),this.lastContainer))&&((l=this.focusToReturn)==null||l.focus()),this.lastContainer=null}},n,!!n)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!kv(e.error)&&this.notificationService.error(e.error)}}var jIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},kp=function(s,e){return function(t,i){e(t,i,s)}};let TO=class extends ne{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new UIe(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,n,r,o){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=n,this.menuService=r,this.contextKeyService=o,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new $),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new $),this.onDidHideContextMenu=this._onDidHideContextMenu.event}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=NO.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{var i;(i=e.onHide)==null||i.call(e,t),this._onDidHideContextMenu.fire()}}),Ou.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};TO=jIe([kp(0,Bh),kp(1,_a),kp(2,Gv),kp(3,Bn),kp(4,cm),kp(5,St)],TO);var NO;(function(s){function e(i){return i&&i.menuId instanceof rn}function t(i,n,r){if(!e(i))return i;const{menuId:o,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{let c=[];if(o){const u=n.getMenuActions(o,l??r,a);c=FIe(u)}return i.getActions?On.join(i.getActions(),c):c}}}s.transform=t})(NO||(NO={}));var aE;(function(s){s[s.API=0]="API",s[s.USER=1]="USER"})(aE||(aE={}));var c9=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lE=function(s,e){return function(t,i){e(t,i,s)}};let IO=class{constructor(e){this._commandService=e}async open(e,t){if(!T7(e,je.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=nt.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=rO(decodeURIComponent(e.query))}catch{try{i=rO(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};IO=c9([lE(0,ho)],IO);let RO=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=nt.parse(e));const{selection:i,uri:n}=OTe(e);return e=n,e.scheme===je.file&&(e=$_e(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t!=null&&t.fromUserGesture?aE.USER:aE.API,...t==null?void 0:t.editorOptions}},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0}};RO=c9([lE(0,fn)],RO);let AO=class{constructor(e,t){this._openers=new sr,this._validators=new sr,this._resolvers=new sr,this._resolvedUriTargets=new ls(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new sr,this._defaultExternalOpener={openExternal:async i=>(WH(i,je.http,je.https)?eX(i):Ut.location.href=i,!0)},this._openers.push({open:async(i,n)=>n!=null&&n.openExternal||WH(i,je.mailto,je.http,je.https,je.vsls)?(await this._doOpenExternal(i,n),!0):!1}),this._openers.push(new IO(t)),this._openers.push(new RO(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){if(!(t!=null&&t.skipValidation)){const i=typeof e=="string"?nt.parse(e):e,n=this._resolvedUriTargets.get(i)??e;for(const r of this._validators)if(!await r.shouldOpen(n,t))return!1}for(const i of this._openers)if(await i.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const n=await i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?nt.parse(e):e;let n;try{n=(await this.resolveExternalUri(i,t)).resolved}catch{n=i}let r;if(typeof e=="string"&&i.toString()===n.toString()?r=e:r=encodeURI(n.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(r,{sourceUri:i,preferredOpenerId:o},lo.None))return!0}return this._defaultExternalOpener.openExternal(r,{sourceUri:i},lo.None)}dispose(){this._validators.clear()}};AO=c9([lE(0,fn),lE(1,ho)],AO);const ty=tt("editorWorkerService");var Xr;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(Xr||(Xr={}));(function(s){function e(l,c){return c-l}s.compare=e;const t=Object.create(null);t[s.Error]=w(1732,"Error"),t[s.Warning]=w(1733,"Warning"),t[s.Info]=w(1734,"Info");function i(l){return t[l]||""}s.toString=i;const n=Object.create(null);n[s.Error]=w(1735,"Errors"),n[s.Warning]=w(1736,"Warnings"),n[s.Info]=w(1737,"Infos");function r(l){return n[l]||""}s.toStringPlural=r;function o(l){switch(l){case Fi.Error:return s.Error;case Fi.Warning:return s.Warning;case Fi.Info:return s.Info;case Fi.Ignore:return s.Hint}}s.fromSeverity=o;function a(l){switch(l){case s.Error:return Fi.Error;case s.Warning:return Fi.Warning;case s.Info:return Fi.Info;case s.Hint:return Fi.Ignore}}s.toSeverity=a})(Xr||(Xr={}));var Y$;(function(s){function t(n){return i(n,!0)}s.makeKey=t;function i(n,r){const o=[""];return n.source?o.push(n.source.replace("","\\")):o.push(""),n.code?typeof n.code=="string"?o.push(n.code.replace("","\\")):o.push(n.code.value.replace("","\\")):o.push(""),n.severity!==void 0&&n.severity!==null?o.push(Xr.toString(n.severity)):o.push(""),n.message&&r?o.push(n.message.replace("","\\")):o.push(""),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(""),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(""),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(""),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(""),o.push(""),o.join("")}s.makeKeyOptionalMessage=i})(Y$||(Y$={}));const bm=tt("markerService");var $Ie=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Q$=function(s,e){return function(t,i){e(t,i,s)}};let MO=class extends ne{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new $),this._suppressedRanges=new ls,this._markerDecorations=new ls,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new qIe(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var i;const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===je.inMemory||e.uri.scheme===je.internal||e.uri.scheme===je.vscode)&&((i=this._markerService)==null||i.read({resource:e.uri}).map(n=>n.owner).forEach(n=>this._markerService.remove(n,[e.uri])))}_updateDecorations(e){let t=this._markerService.read({resource:e.model.uri,take:500});const i=this._suppressedRanges.get(e.model.uri);i&&(t=t.filter(n=>!_t.some(i,r=>H.areIntersectingOrTouching(r,n)))),e.update(t)&&this._onDidChangeMarker.fire(e.model)}};MO=$Ie([Q$(0,Gs),Q$(1,bm)],MO);class qIe extends ne{constructor(e){super(),this.model=e,this._map=new B_e,this._register(Fe(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=yke(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const n=i.map(a=>this._map.get(a)),r=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),o=this.model.deltaDecorations(n,r);for(const a of i)this._map.delete(a);for(let a=0;a<o.length;a++)this._map.set(t[a],o[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=H.lift(t);if(t.severity===Xr.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const r=e.getWordAtPosition(i.getStartPosition());r&&(i=new H(i.startLineNumber,r.startColumn,i.endLineNumber,r.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new H(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,r,o;switch(e.severity){case Xr.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case Xr.Info:t="squiggly-info",i=wp(Aye),n=10,o={color:wp(LCe),position:1};break;case Xr.Warning:t="squiggly-warning",i=wp(Rye),n=20,o={color:wp(kCe),position:1};break;case Xr.Error:default:t="squiggly-error",i=wp(Iye),n=30,o={color:wp(ECe),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(r="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(r="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:ok.Right},minimap:o,zIndex:n,inlineClassName:r}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}var GIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yx=function(s,e){return function(t,i){e(t,i,s)}},Np;function nf(s){return s.toString()}class KIe{constructor(e,t,i){this.model=e,this._modelEventListeners=new Ee,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(n=>i(e,n)))}dispose(){this._modelEventListeners.dispose()}}const YIe=kr||rt?1:2;class QIe{constructor(e,t,i,n,r,o,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=r,this.sha1=o,this.versionId=a,this.alternativeVersionId=l}}var bg;let OO=(bg=class extends ne{constructor(e,t,i,n){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=n,this._onModelAdded=this._register(new $),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new $),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new $),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(r=>this._updateModelOptions(r))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var g;let i=Qn.tabSize;e.editor&&typeof e.editor.tabSize<"u"&&(i=th(e.editor.tabSize,Qn.tabSize,1,100));let n="tabSize";e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"&&(n=th(e.editor.indentSize,"tabSize",1,100));let r=Qn.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(r=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let o=YIe;const a=e.eol;a===`\r
`?o=2:a===`
`&&(o=1);let l=Qn.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=Qn.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let u=Qn.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(u=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let d=Qn.bracketPairColorizationOptions;if((g=e.editor)!=null&&g.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"){const p=e.editor.bracketPairColorization;d={enabled:!!p.enabled,independentColorPoolPerBracketType:!!p.independentColorPoolPerBracketType}}return{isForSimpleWidget:t,tabSize:i,indentSize:n,insertSpaces:r,detectIndentation:c,defaultEOL:o,trimAutoWhitespace:l,largeFileOptimizations:u,bracketPairColorizationOptions:d}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:ca===3||ca===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const n=typeof e=="string"?e:e.languageId;let r=this._modelCreationOptionsByLanguageAndResource[n+t];if(!r){const o=this._configurationService.getValue("editor",{overrideIdentifier:n,resource:t}),a=this._getEOL(t,n);r=Np._readModelOptions({editor:o,eol:a},i),this._modelCreationOptionsByLanguageAndResource[n+t]=r}return r}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,r=i.length;n<r;n++){const o=i[n],a=this._models[o],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const u=t[l+c],d=this.getCreationOptions(l,c,a.model.isForSimpleWidget);Np._setModelOptionsForModel(a.model,d,u)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&xr(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(nf(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(nf(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(nf(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,n)=>i.time-n.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const r=this.getCreationOptions(t,i,n),o=this._instantiationService.createInstance(H5,e,t,r,i);if(i&&this._disposedModels.has(nf(i))){const c=this._removeDisposedModel(i),u=this._undoRedoService.getElements(i),d=this._getSHA1Computer(),g=d.canComputeSHA1(o)?d.computeSHA1(o)===c.sha1:!1;if(g||c.sharesUndoRedoStack){for(const p of u.past)sh(p)&&p.matchesResource(i)&&p.setModel(o);for(const p of u.future)sh(p)&&p.matchesResource(i)&&p.setModel(o);this._undoRedoService.setElementsValidFlag(i,!0,p=>sh(p)&&p.matchesResource(i)),g&&(o._overwriteVersionId(c.versionId),o._overwriteAlternativeVersionId(c.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=nf(o.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new KIe(o,c=>this._onWillDispose(c),(c,u)=>this._onDidChangeLanguage(c,u));return this._models[a]=l,l}createModel(e,t,i,n=!1){let r;return t?r=this._createModelData(e,t,i,n):r=this._createModelData(e,da,i,n),this._onModelAdded.fire(r.model),r.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const r=t[i];e.push(this._models[r].model)}return e}getModel(e){const t=nf(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===je.file||e.scheme===je.vscodeRemote||e.scheme===je.vscodeUserData||e.scheme===je.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=nf(e.uri),i=this._models[t],n=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let r=!1,o=0;if(n||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const u of c.past)sh(u)&&u.matchesResource(e.uri)&&(r=!0,o+=u.heapSize(e.uri),u.setModel(e.uri));for(const u of c.future)sh(u)&&u.matchesResource(e.uri)&&(r=!0,o+=u.heapSize(e.uri),u.setModel(e.uri))}}const a=Np.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(r)if(!n&&(o>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-o),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>sh(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new QIe(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),n,o,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!n){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,n=e.getLanguageId(),r=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),o=this.getCreationOptions(n,e.uri,e.isForSimpleWidget);Np._setModelOptionsForModel(e,o,r),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new PO}},Np=bg,bg.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024,bg);OO=Np=GIe([yx(0,ai),yx(1,MX),yx(2,B6),yx(3,wt)],OO);const h2=class h2{canComputeSHA1(e){return e.getValueLength()<=h2.MAX_MODEL_SIZE}computeSHA1(e){const t=new h4,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}};h2.MAX_MODEL_SIZE=10*1024*1024;let PO=h2;var FO;(function(s){s[s.PRESERVE=0]="PRESERVE",s[s.LAST=1]="LAST"})(FO||(FO={}));const Uee={Quickaccess:"workbench.contributions.quickaccess"};class XIe{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),Fe(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return i7([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}Fn.add(Uee.Quickaccess,new XIe);var ZIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},X$=function(s,e){return function(t,i){e(t,i,s)}};let BO=class extends ne{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=Fn.as(Uee.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0,this._register(Fe(()=>{var i;for(const n of this.mapProviderToDescriptor.values())Y2(n)&&n.dispose();(i=this.visibleQuickAccess)==null||i.picker.dispose()}))}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var _,C;const[n,r]=this.getOrInstantiateProvider(e,i==null?void 0:i.enabledProviderPrefixes),o=this.visibleQuickAccess,a=o==null?void 0:o.descriptor;if(o&&r&&a===r){e!==r.prefix&&!(i!=null&&i.preserveValue)&&(o.picker.value=e),this.adjustValueSelection(o.picker,r,i);return}if(r&&!(i!=null&&i.preserveValue)){let v;if(o&&a&&a!==r){const x=o.value.substr(a.prefix.length);x&&(v=`${r.prefix}${x}`)}if(!v){const x=n==null?void 0:n.defaultFilterValue;x===FO.LAST?v=this.lastAcceptedPickerValues.get(r):typeof x=="string"&&(v=`${r.prefix}${x}`)}typeof v=="string"&&(e=v)}const l=(_=o==null?void 0:o.picker)==null?void 0:_.valueSelection,c=(C=o==null?void 0:o.picker)==null?void 0:C.value,u=new Ee,d=u.add(this.quickInputService.createQuickPick({useSeparators:!0}));d.value=e,this.adjustValueSelection(d,r,i),d.placeholder=(i==null?void 0:i.placeholder)??(r==null?void 0:r.placeholder),d.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,d.hideInput=!!d.quickNavigate&&!o,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(d.itemActivation=(i==null?void 0:i.itemActivation)??kl.SECOND),d.contextKey=r==null?void 0:r.contextKey,d.filterValue=v=>v.substring(r?r.prefix.length:0);let g;t&&(g=new eD,u.add(ge.once(d.onWillAccept)(v=>{v.veto(),d.hide()}))),u.add(this.registerPickerListeners(d,n,r,e,i));const p=u.add(new sm);if(n&&u.add(n.provide(d,p.token,i==null?void 0:i.providerOptions)),ge.once(d.onDidHide)(()=>{d.selectedItems.length===0&&p.cancel(),u.dispose(),g==null||g.complete(d.selectedItems.slice(0))}),d.show(),l&&c===e&&(d.valueSelection=l),t)return g==null?void 0:g.p}adjustValueSelection(e,t,i){let n;i!=null&&i.preserveValue?n=[e.value.length,e.value.length]:n=[(t==null?void 0:t.prefix.length)??0,e.value.length],e.valueSelection=n}registerPickerListeners(e,t,i,n,r){const o=new Ee,a=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return o.add(Fe(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),o.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,r==null?void 0:r.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:r==null?void 0:r.enabledProviderPrefixes,preserveValue:!0,providerOptions:r==null?void 0:r.providerOptions}):a.value=l})),i&&o.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),o}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!(t!=null&&t.includes(i.prefix)))return[void 0,void 0];let n=this.mapProviderToDescriptor.get(i);return n||(n=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,n)),[n,i]}};BO=ZIe([X$(0,_m),X$(1,wt)],BO);const jee={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};class q1 extends oc{get onChange(){return this._onChange.event}get onKeyDown(){return this._onKeyDown.event}constructor(e){super(),this._onChange=this._register(new $),this._onKeyDown=this._register(new $),this._opts=e,this._title=this._opts.title,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...ht.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._register(tl().setupDelayedHover(this.domNode,()=>({content:this._title,style:1}),this._opts.hoverLifecycleOptions)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.setTitle(this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(this.enabled){if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)}})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...ht.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...ht.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1)),this.domNode.classList.remove("disabled")}disable(){this.domNode.setAttribute("aria-disabled",String(!0)),this.domNode.classList.add("disabled")}setTitle(e){this._title=e,this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}}const j9=class j9 extends oc{constructor(e,t,i){super(),this.checkbox=e,this.domNode=t,this.styles=i,this._onChange=this._register(new $),this.onChange=this._onChange.event,this.applyStyles()}get enabled(){return this.checkbox.enabled}enable(){this.checkbox.enable(),this.applyStyles(!0)}disable(){this.checkbox.disable(),this.applyStyles(!1)}setTitle(e){this.checkbox.setTitle(e)}applyStyles(e=this.enabled){this.domNode.style.color=(e?this.styles.checkboxForeground:this.styles.checkboxDisabledForeground)||"",this.domNode.style.backgroundColor=(e?this.styles.checkboxBackground:this.styles.checkboxDisabledBackground)||"",this.domNode.style.borderColor=(e?this.styles.checkboxBorder:this.styles.checkboxDisabledBackground)||"";const t=this.styles.size||18;this.domNode.style.width=this.domNode.style.height=this.domNode.style.fontSize=`${t}px`,this.domNode.style.fontSize=`${t-2}px`}};j9.CLASS_NAME="monaco-checkbox";let iv=j9;class $ee extends iv{constructor(e,t,i){const n=new q1({title:e,isChecked:t,icon:xe.check,actionClassName:iv.CLASS_NAME,hoverLifecycleOptions:i.hoverLifecycleOptions,...jee});super(n,n.domNode,i),this._register(n),this._register(this.checkbox.onChange(r=>{this.applyStyles(),this._onChange.fire(r)}))}get checked(){return this.checkbox.checked}set checked(e){this.checkbox.checked=e,this.applyStyles()}applyStyles(e){this.checkbox.checked?this.checkbox.setIcon(xe.check):this.checkbox.setIcon(void 0),super.applyStyles(e)}}class qee extends iv{constructor(e,t,i){let n;switch(t){case!0:n=xe.check;break;case"mixed":n=xe.dash;break;case!1:n=void 0;break}const r=new q1({title:e,isChecked:t===!0,icon:n,actionClassName:$ee.CLASS_NAME,hoverLifecycleOptions:i.hoverLifecycleOptions,...jee});super(r,r.domNode,i),this._state=t,this._register(r),this._register(this.checkbox.onChange(o=>{this._state=this.checkbox.checked,this.applyStyles(),this._onChange.fire(o)}))}get checked(){return this._state}set checked(e){this._state!==e&&(this._state=e,this.checkbox.checked=e===!0,this.applyStyles())}applyStyles(e){switch(this._state){case!0:this.checkbox.setIcon(xe.check);break;case"mixed":this.checkbox.setIcon(xe.dash);break;case!1:this.checkbox.setIcon(void 0);break}super.applyStyles(e)}}var JIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class Gee{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}JIe([Si],Gee.prototype,"toString",null);const eRe=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function tRe(s){const e=[];let t=0,i;for(;i=eRe.exec(s);){i.index-t>0&&e.push(s.substring(t,i.index));const[,n,r,,o]=i;o?e.push({label:n,href:r,title:o}):e.push({label:n,href:r}),t=i.index+i[0].length}return t<s.length&&e.push(s.substring(t)),new Gee(e)}const JR={},iRe=new eee("quick-input-button-icon-");function nRe(s){if(!s)return;let e;const t=s.dark.toString();return JR[t]?e=JR[t]:(e=iRe.nextId(),q4(`.${e}, .hc-light .${e}`,`background-image: ${Jl(s.light||s.dark)}`),q4(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${Jl(s.dark)}`),JR[t]=e),e}function W_(s,e,t){let i=s.iconClass||nRe(s.iconPath);return s.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:s.tooltip||"",class:i,enabled:!0,run:t}}function sRe(s,e,t){as(e);const i=tRe(s);let n=0;for(const r of i.nodes)if(typeof r=="string")e.append(...dg(r));else{let o=r.title;!o&&r.href.startsWith("command:")?o=w(1771,"Click to execute command '{0}'",r.href.substring(8)):o||(o=r.href);const a=Ve("a",{href:r.href,title:o,tabIndex:n++},r.label);a.style.textDecoration="underline";const l=p=>{Qpe(p)&&vt.stop(p,!0),t.callback(r.href)},c=t.disposables.add(new Nt(a,pe.CLICK)).event,u=t.disposables.add(new Nt(a,pe.KEY_DOWN)).event,d=ge.chain(u,p=>p.filter(_=>{const C=new jt(_);return C.equals(10)||C.equals(3)}));t.disposables.add($s.addTarget(a));const g=t.disposables.add(new Nt(a,Qt.Tap)).event;ge.any(c,g,d)(l,null,t.disposables),e.appendChild(a)}}var rRe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Z$=function(s,e){return function(t,i){e(t,i,s)}};const Kee="inQuickInput",oRe=new Ne(Kee,!1,w(1748,"Whether keyboard focus is inside the quick input control")),UD=ft.has(Kee),aRe="quickInputAlignment",lRe=new Ne(aRe,"top",w(1749,"The alignment of the quick input")),nv="quickInputType",cRe=new Ne(nv,void 0,w(1750,"The type of the currently visible quick input")),Yee="cursorAtEndOfQuickInputBox",hRe=new Ne(Yee,!1,w(1751,"Whether the cursor in the quick input is at the end of the input box")),uRe=ft.has(Yee),VO={iconClass:ht.asClassName(xe.quickInputBack),tooltip:w(1752,"Back")},u2=class u2 extends ne{constructor(e){super(),this.ui=e,this._visible=Qe("visible",!1),this._widgetUpdated=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=u2.noPromptMessage,this._severity=Fi.Ignore,this.onDidTriggerButtonEmitter=this._register(new $),this.onDidHideEmitter=this._register(new $),this.onWillHideEmitter=this._register(new $),this.onDisposeEmitter=this._register(new $),this.visibleDisposables=this._register(new Ee),this.onDidHide=this.onDidHideEmitter.event}get visible(){return this._visible.get()}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Gl;this._ignoreFocusOut=e&&!Gl,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===VO),this._rightButtons=e.filter(t=>t!==VO&&t.location!==tE.Inline),this._inlineButtons=e.filter(t=>t.location===tE.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this._visible.set(!0,void 0),this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=Xw.Other){this._visible.set(!1,void 0),this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=Xw.Other){this.onWillHideEmitter.fire({reason:e})}update(){var n;if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText="");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?as(this.ui.widget,this._widget):as(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new Ql,this.busyDelay.setIfNotSet(()=>{this.visible&&(this.ui.progressBar.infinite(),this.ui.progressBar.getContainer().removeAttribute("aria-hidden"))},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.ui.progressBar.getContainer().setAttribute("aria-hidden","true"),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const r=this._leftButtons.map((l,c)=>W_(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.leftActionBar.push(r,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const o=this._rightButtons.map((l,c)=>W_(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.rightActionBar.push(o,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const a=this._inlineButtons.map((l,c)=>W_(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.inlineActionBar.push(a,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const r=((n=this.toggles)==null?void 0:n.filter(a=>a instanceof q1))??[];this.ui.inputBox.toggles=r;const o=r.length*22;this.ui.countContainer.style.right=o>0?`${4+o}px`:"4px",this.ui.visibleCountContainer.style.right=o>0?`${4+o}px`:"4px"}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,as(this.ui.message),i&&sRe(i,this.ui.message,{callback:r=>{this.ui.linkOpenerDelegate(r)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?w(1754,"{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Fi.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}};u2.noPromptMessage=w(1753,"Press 'Enter' to confirm your input or 'Escape' to cancel");let sv=u2;const d2=class d2 extends sv{constructor(e){super(e),this._value="",this.onDidChangeValueEmitter=this._register(new $),this.onWillAcceptEmitter=this._register(new $),this.onDidAcceptEmitter=this._register(new $),this.onDidCustomEmitter=this._register(new $),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=kl.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new $),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new $),this.onDidTriggerItemButtonEmitter=this._register(new $),this.onDidTriggerSeparatorButtonEmitter=this._register(new $),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new Dv,this.type="quickPick",this.filterValue=t=>t,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event,this.noValidationMessage=void 0}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get prompt(){return this.noValidationMessage}set prompt(e){this.noValidationMessage=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?ZTe:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get okLabel(){return this._okLabel??w(1756,"OK")}set okLabel(e){this._okLabel=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(Yt.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&sn(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany&&!e.some(i=>i.pickable===!1)){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&sn(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(z7(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&sn(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return J(this.ui.container,pe.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new jt(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const a=o.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage||!!this.prompt,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;!n&&i.inputBox&&(n=this.placeholder,this.title&&(n=n?`${n} - ${this.title}`:this.title),n||(n=d2.DEFAULT_ARIA_LABEL)),this.ui.list.ariaLabel!==n&&(this.ui.list.ariaLabel=n??null),this.ui.inputBox.ariaLabel!==n&&(this.ui.inputBox.ariaLabel=n??"input"),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case kl.NONE:this._itemActivation=kl.FIRST;break;case kl.SECOND:this.ui.list.focus(Yt.Second),this._itemActivation=kl.FIRST;break;case kl.LAST:this.ui.list.focus(Yt.Last),this._itemActivation=kl.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.ok.label=this.okLabel||"",this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(Yt.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||(this.activeItems[0]&&!this._canSelectMany&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(e??!1))}};d2.DEFAULT_ARIA_LABEL=w(1755,"Type to narrow down results.");let bC=d2,dRe=class extends sv{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new $),this.onDidAcceptEmitter=this._register(new $),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}get prompt(){return this._prompt}set prompt(e){this._prompt=e,this.noValidationMessage=e?w(1757,"{0} (Press 'Enter' to confirm or 'Escape' to cancel)",e):sv.noPromptMessage,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}accept(){this.onDidAcceptEmitter.fire()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password);let t=this.ariaLabel;!t&&e.inputBox&&(t=this.placeholder?this.title?`${this.placeholder} - ${this.title}`:this.placeholder:this.title?this.title:"input"),this.ui.inputBox.ariaLabel!==t&&(this.ui.inputBox.ariaLabel=t||"input")}},WO=class extends qw{constructor(e,t){super("mouse",void 0,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(Wi(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};WO=rRe([Z$(0,ai),Z$(1,qv)],WO);ae.white.toString(),ae.white.toString();const fRe=Object.freeze({allowedTags:{override:["b","i","u","code","span"]},allowedAttributes:{override:["class"]}});class HO extends ne{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new $),this._onDidEscape=this._register(new $),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this.enabled=!t.disabled,this._register($s.addTarget(this._element)),[pe.CLICK,Qt.Tap].forEach(r=>{this._register(J(this._element,r,o=>{if(!this.enabled){vt.stop(o);return}this._onDidClick.fire(o)}))}),this._register(J(this._element,pe.KEY_DOWN,r=>{const o=new jt(r);let a=!1;this.enabled&&(o.equals(3)||o.equals(10))?(this._onDidClick.fire(r),a=!0):o.equals(9)&&(this._onDidEscape.fire(r),this._element.blur(),a=!0),a&&vt.stop(o,!0)})),this._register(J(this._element,pe.MOUSE_OVER,r=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(J(this._element,pe.MOUSE_OUT,r=>{this.updateBackground(!1)})),this.focusTracker=this._register(h1(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of dg(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var n;if(this._label===e||hC(this._label)&&hC(e)&&Q2e(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(hC(e)){const r=i9(e,void 0,document.createElement("span"));r.dispose();const o=(n=r.element.querySelector("p"))==null?void 0:n.innerHTML;o?vee(t,o,fRe):as(t)}else this.options.supportIcons?as(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=pTe(e)),this.setTitle(i),this._setAriaLabel(),this._label=e}get label(){return this._label}_setAriaLabel(){typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):typeof this.options.title=="string"&&this._element.setAttribute("aria-label",this.options.title)}set icon(e){this._setAriaLabel();const t=Array.from(this._element.classList).filter(i=>i.startsWith("codicon-"));this._element.classList.remove(...t),this._element.classList.add(...ht.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(tl().setupManagedHover(this.options.hoverDelegate??Ld("element"),this._element,e)):this._hover&&this._hover.update(e)}}class J$ extends ne{constructor(e,t,i){super(),this.options=t,this.styles=i,this.count=0,this.hover=this._register(new kn),this.element=De(e,Ve(".monaco-count-badge")),this._register(Fe(()=>e.removeChild(this.element))),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0),this.updateHover()}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.updateHover(),this.render()}updateHover(){this.titleFormat!==""&&!this.hover.value?this.hover.value=tl().setupDelayedHoverAtMouse(this.element,()=>({content:e4(this.titleFormat,this.count),appearance:{compact:!0}})):this.titleFormat===""&&this.hover.value&&(this.hover.value=void 0)}render(){this.element.textContent=e4(this.countFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const eq="done",tq="active",eA="infinite",tA="infinite-long-running",iq="discrete",f2=class f2 extends ne{constructor(e,t){super(),this.progressSignal=this._register(new kn),this.workedVal=0,this.showDelayedScheduler=this._register(new os(()=>JQ(this.element),0)),this.longRunningScheduler=this._register(new os(()=>this.infiniteLongRunning(),f2.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(tq,eA,tA,iq),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(eq),this.element.classList.contains(eA)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(iq,eq,tA),this.element.classList.add(tq,eA),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(tA)}getContainer(){return this.element}};f2.LONG_RUNNING_INFINITE_THRESHOLD=1e4;let zO=f2;const gRe=w(2,"Match Case"),mRe=w(3,"Match Whole Word"),pRe=w(4,"Use Regular Expression");class _Re extends q1{constructor(e){super({icon:xe.caseSensitive,title:gRe+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class bRe extends q1{constructor(e){super({icon:xe.wholeWord,title:mRe+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class CRe extends q1{constructor(e){super({icon:xe.regex,title:pRe+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}function wRe(s,e,t){const i=t??document.createElement("div");return i.textContent=s,i}function vRe(s,e,t){const i=t??document.createElement("div");return i.textContent="",Qee(i,SRe(s),e==null?void 0:e.actionHandler,e==null?void 0:e.renderCodeSegments),i}class yRe{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function Qee(s,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){const r=document.createElement("a");t.disposables.add(Xn(r,"click",o=>{t.callback(String(e.index),o)})),n=r}else e.type===8?n=document.createElement("br"):e.type===1&&(n=s);n&&s!==n&&s.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(r=>{Qee(n,r,t,i)})}function SRe(s,e){const t={type:1,children:[]};let i=0,n=t;const r=[],o=new yRe(s);for(;!o.eos();){let a=o.next();const l=a==="\\"&&UO(o.peek())!==0;if(l&&(a=o.next()),!l&&xRe(a)&&a===o.peek()){o.advance(),n.type===2&&(n=r.pop());const c=UO(a);if(n.type===c||n.type===5&&c===6)n=r.pop();else{const u={type:c,children:[]};c===5&&(u.index=i,i++),n.children.push(u),r.push(n),n=u}}else if(a===`
`)n.type===2&&(n=r.pop()),n.children.push({type:8});else if(n.type!==2){const c={type:2,content:a};n.children.push(c),r.push(n),n=c}else n.content+=a}return n.type===2&&(n=r.pop()),t}function xRe(s,e){return UO(s)!==0}function UO(s,e){switch(s){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return 0;default:return 0}}class LRe{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class kRe{constructor(e=new Set,t=10){this._history=e,this._limit=t,this._onChange(),this._history.onDidChange&&(this._disposable=this._history.onDidChange(()=>this._onChange()))}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new LRe(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;if(e.length>this._limit){const t=e.slice(e.length-this._limit);this._history.replace?this._history.replace(t):this._history=new Set(t)}}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}dispose(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0)}}const Ep=Ve;class ERe extends oc{get onDidChange(){return this._onDidChange.event}get onDidHeightChange(){return this._onDidHeightChange.event}constructor(e,t,i){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this.hover=this._register(new kn),this._onDidChange=this._register(new $),this._onDidHeightChange=this._register(new $),this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=De(e,Ep(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",r=De(this.element,Ep(".ibwrapper"));if(this.input=De(r,Ep(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=De(r,Ep("div.mirror")),this.mirror.innerText="",this.scrollableElement=new cve(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),De(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));const o=this._register(new Nt(e.ownerDocument,"selectionchange")),a=ge.filter(o.event,()=>{const l=e.ownerDocument.getSelection();return(l==null?void 0:l.anchorNode)===r});this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new zl(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover.value||(this.hover.value=this._register(tl().setupDelayedHoverAtMouse(this.input,()=>({content:this.tooltip,appearance:{compact:!0}}))))}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:p4(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return H7(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const e=this.input.selectionStart;if(e===null)return null;const t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&xr(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Th(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=W7(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=De(n,Ep(".monaco-inputbox-container")),t();const r=Ep("span.monaco-inputbox-message");this.message.formatContent?vRe(this.message.content,void 0,r):wRe(this.message.content,void 0,r),r.classList.add(this.classForType(this.message.type));const o=this.stylesForType(this.message.type);return r.style.backgroundColor=o.background??"",r.style.color=o.foreground??"",r.style.border=o.border?`1px solid ${o.border}`:"",De(e,r),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=w(9,"Error: {0}",this.message.content):this.message.type===2?i=w(10,"Warning: {0}",this.message.content):i=w(11,"Info: {0}",this.message.content),Nw(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText="",this.layout()}applyStyles(){const e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Th(n,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=p4(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,r=t.value;i!==null&&n!==null&&(this.value=r.substr(0,i)+e+r.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){var e;this._hideMessage(),this.message=null,(e=this.actionbar)==null||e.dispose(),super.dispose()}}class DRe extends ERe{constructor(e,t,i){const n=w(12," or {0} for history",""),r=w(13," ({0} for history)","");super(e,t,i),this._onDidFocus=this._register(new $),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new $),this.onDidBlur=this._onDidBlur.event,this.history=this._register(new kRe(i.history,100));const o=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){const a=this.placeholder.endsWith(")")?n:r,l=this.placeholder+a;i.showPlaceholderOnFocus&&!H7(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(c=>{c.target.textContent||o()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>o()),this.onblur(this.input,()=>{const a=l=>{if(this.placeholder.endsWith(l)){const c=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=c:this.setPlaceHolder(c),!0}else return!1};a(r)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",mk(this.value?this.value:w(14,"Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,mk(this.value))}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const TRe=w(1,"input");class NRe extends oc{get onDidOptionChange(){return this._onDidOptionChange.event}get onKeyDown(){return this._onKeyDown.event}get onMouseDown(){return this._onMouseDown.event}get onCaseSensitiveKeyDown(){return this._onCaseSensitiveKeyDown.event}get onRegexKeyDown(){return this._onRegexKeyDown.event}constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new kn),this.additionalToggles=[],this._onDidOptionChange=this._register(new $),this._onKeyDown=this._register(new $),this._onMouseDown=this._register(new $),this._onInput=this._register(new $),this._onKeyUp=this._register(new $),this._onCaseSensitiveKeyDown=this._register(new $),this._onRegexKeyDown=this._register(new $),this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||TRe,this.showCommonFindToggles=!!i.showCommonFindToggles;const n=i.appendCaseSensitiveLabel||"",r=i.appendWholeWordsLabel||"",o=i.appendRegexLabel||"",a=!!i.flexibleHeight,l=!!i.flexibleWidth,c=i.flexibleMaxHeight;if(this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new DRe(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},showHistoryHint:i.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:i.inputBoxStyles,history:i.history})),this.showCommonFindToggles){const u=(i==null?void 0:i.hoverLifecycleOptions)||{groupId:"find-input"};this.regex=this._register(new CRe({appendTitle:o,isChecked:!1,hoverLifecycleOptions:u,...i.toggleStyles})),this._register(this.regex.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(g=>{this._onRegexKeyDown.fire(g)})),this.wholeWords=this._register(new bRe({appendTitle:r,isChecked:!1,hoverLifecycleOptions:u,...i.toggleStyles})),this._register(this.wholeWords.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new _Re({appendTitle:n,isChecked:!1,hoverLifecycleOptions:u,...i.toggleStyles})),this._register(this.caseSensitive.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(g=>{this._onCaseSensitiveKeyDown.fire(g)}));const d=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,g=>{if(g.equals(15)||g.equals(17)||g.equals(9)){const p=d.indexOf(this.domNode.ownerDocument.activeElement);if(p>=0){let _=-1;g.equals(17)?_=(p+1)%d.length:g.equals(15)&&(p===0?_=d.length-1:_=p-1),g.equals(9)?(d[p].blur(),this.inputBox.focus()):_>=0&&d[_].focus(),vt.stop(g,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i==null?void 0:i.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e==null||e.appendChild(this.domNode),this._register(J(this.inputBox.inputElement,"compositionstart",u=>{this.imeSessionInProgress=!0})),this._register(J(this.inputBox.inputElement,"compositionend",u=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){var e,t,i;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(e=this.regex)==null||e.enable(),(t=this.wholeWords)==null||t.enable(),(i=this.caseSensitive)==null||i.enable();for(const n of this.additionalToggles)n.enable()}disable(){var e,t,i;this.domNode.classList.add("disabled"),this.inputBox.disable(),(e=this.regex)==null||e.disable(),(t=this.wholeWords)==null||t.disable(),(i=this.caseSensitive)==null||i.disable();for(const n of this.additionalToggles)n.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new Ee;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){var t,i,n;e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(((t=this.caseSensitive)==null?void 0:t.width())??0)+(((i=this.wholeWords)==null?void 0:i.width())??0)+(((n=this.regex)==null?void 0:n.width())??0)+this.additionalToggles.reduce((r,o)=>r+o.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var e;return((e=this.caseSensitive)==null?void 0:e.checked)??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){var e;return((e=this.wholeWords)==null?void 0:e.checked)??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){var e;return((e=this.regex)==null?void 0:e.checked)??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){var e;(e=this.caseSensitive)==null||e.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}const IRe=Ve;class RRe extends ne{constructor(e,t,i){super(),this.parent=e,this.onDidChange=r=>this.findInput.onDidChange(r),this.container=De(this.parent,IRe(".quick-input-box")),this.findInput=this._register(new NRe(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const n=this.findInput.inputBox.inputElement;n.role="textbox",n.ariaHasPopup="menu",n.ariaAutoComplete="list"}get onKeyDown(){return this.findInput.onKeyDown}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}get ariaLabel(){return this.findInput.inputBox.inputElement.getAttribute("aria-label")||""}set ariaLabel(e){this.findInput.inputBox.inputElement.setAttribute("aria-label",e)}hasFocus(){return this.findInput.inputBox.hasFocus()}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.findInput.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===Fi.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===Fi.Info?1:e===Fi.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===Fi.Info?1:e===Fi.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class gg extends ne{constructor(e,t){super(),this.options=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.domNode=De(e,Ve("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n,r){e||(e=""),n&&(e=gg.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&xr(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render(r))}render(e){var n;const t=[];let i=0;for(const r of this.highlights){if(r.end===r.start)continue;if(i<r.start){const l=this.text.substring(i,r.start);e?t.push(...dg(l)):t.push(l),i=r.start}const o=this.text.substring(i,r.end),a=Ve("span.highlight",void 0,...e?dg(o):[o]);r.extraClasses&&a.classList.add(...r.extraClasses),t.push(a),i=r.end}if(i<this.text.length){const r=this.text.substring(i);e?t.push(...dg(r)):t.push(r)}if(as(this.domNode,...t),!this.customHover&&this.title!==""){const r=((n=this.options)==null?void 0:n.hoverDelegate)??Ld("mouse");this.customHover=this._register(tl().setupManagedHover(r,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,(r,o)=>{n=r===`\r
`?-1:0,o+=i;for(const a of t)a.end<=o||(a.start>=o&&(a.start+=n),a.end>=o&&(a.end+=n));return i+=n,""})}}class f0{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||xr(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class jO extends ne{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new f0(De(e,Ve(".monaco-icon-label")))),this.labelContainer=De(this.domNode.element,Ve(".monaco-icon-label-container")),this.nameContainer=De(this.labelContainer,Ve("span.monaco-icon-name-container")),t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=this._register(new ORe(this.nameContainer,!!t.supportIcons)):this.nameNode=new ARe(this.nameContainer),this.hoverDelegate=(t==null?void 0:t.hoverDelegate)??Ld("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){var l;const n=["monaco-icon-label"],r=["monaco-icon-label-container"];let o="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.bold&&n.push("bold"),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&r.push("disabled"),i.title&&(typeof i.title=="string"?o+=i.title:o+=e));const a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i!=null&&i.iconPath){let c;if(!a||!Wi(a)?(c=Ve(".monaco-icon-label-iconpath"),this.domNode.element.prepend(c)):c=a,ht.isThemeIcon(i.iconPath)){const u=ht.asClassName(i.iconPath);c.className=`monaco-icon-label-iconpath ${u}`,c.style.backgroundImage=""}else c.style.backgroundImage=Jl(i==null?void 0:i.iconPath);c.style.backgroundRepeat="no-repeat",c.style.backgroundPosition="center",c.style.backgroundSize="contain"}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",o),this.labelContainer.classList.value="",this.labelContainer.classList.add(...r),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const c=this.getOrCreateDescriptionNode();if(c instanceof gg){const u=(i==null?void 0:i.supportIcons)??((l=this.creationOptions)==null?void 0:l.supportIcons);c.set(t||"",i?i.descriptionMatches:void 0,void 0,i==null?void 0:i.labelEscapeNewLines,u),this.setupHover(c.element,i==null?void 0:i.descriptionTitle)}else c.textContent=t&&(i!=null&&i.labelEscapeNewLines)?gg.escapeNewLines(t,[]):t||"",this.setupHover(c.element,(i==null?void 0:i.descriptionTitle)||""),c.empty=!t}if(i!=null&&i.suffix||this.suffixNode){const c=this.getOrCreateSuffixNode();c.textContent=(i==null?void 0:i.suffix)??""}}setupHover(e,t){var o;const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}let n=e;if((o=this.creationOptions)!=null&&o.hoverTargetOverride){if(!xn(e,this.creationOptions.hoverTargetOverride))throw new Error("hoverTargetOverrride must be an ancestor of the htmlElement");n=this.creationOptions.hoverTargetOverride}const r=tl().setupManagedHover(this.hoverDelegate,n,t);r&&this.customHovers.set(e,r)}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new f0(e_e(this.nameContainer,Ve("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new f0(De(e.element,Ve("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){var e;if(!this.descriptionNode){const t=this._register(new f0(De(this.labelContainer,Ve("span.monaco-icon-description-container"))));(e=this.creationOptions)!=null&&e.supportDescriptionHighlights?this.descriptionNode=this._register(new gg(De(t.element,Ve("span.label-description")))):this.descriptionNode=this._register(new f0(De(t.element,Ve("span.label-description"))))}return this.descriptionNode}}class ARe{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&xr(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.textContent="",this.container.classList.remove("multiple"),this.singleLabel=De(this.container,Ve("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.textContent="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],r=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;De(this.container,Ve("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&De(this.container,Ve("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function MRe(s,e,t){if(!t)return;let i=0;return s.map(n=>{const r={start:i,end:i+n.length},o=t.map(a=>ns.intersect(r,a)).filter(a=>!ns.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=r.end+e.length,o})}class ORe extends ne{constructor(e,t){super(),this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label===e&&xr(this.options,t))return;this.label=e,this.options=t;const i=(t==null?void 0:t.supportIcons)??this.supportIcons;if(typeof e=="string")this.singleLabel||(this.container.textContent="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new gg(De(this.container,Ve("a.label-name",{id:t==null?void 0:t.domId}))))),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines,i);else{this.container.textContent="",this.container.classList.add("multiple"),this.singleLabel=void 0;const n=(t==null?void 0:t.separator)||"/",r=MRe(e,n,t==null?void 0:t.matches);for(let o=0;o<e.length;o++){const a=e[o],l=r?r[o]:void 0,c=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${o}`,u=Ve("a.label-name",{id:c,"data-icon-label-count":e.length,"data-icon-label-index":o,role:"treeitem"});this._register(new gg(De(this.container,u))).set(a,l,void 0,t==null?void 0:t.labelEscapeNewLines,i),o<e.length-1&&De(u,Ve("span.label-separator",void 0,n))}}}}const Sx=Ve;class h9 extends ne{constructor(e,t,i){super(),this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const n=this.options.keybindingLabelForeground;this.domNode=De(e,Sx(".monaco-keybinding")),n&&(this.domNode.style.color=n),this.hover=this._register(tl().setupManagedHover(Ld("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}set(e,t){this.didEverRender&&this.keybinding===e&&h9.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let i=1;i<e.length;i++)De(this.domNode,Sx("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[i],this.matches?this.matches.chordPart:null);const t=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(t),this.domNode.setAttribute("aria-label",t||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){Ya(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const n=s9.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,!!(i!=null&&i.ctrlKey),n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,!!(i!=null&&i.shiftKey),n.separator),t.altKey&&this.renderKey(e,n.altKey,!!(i!=null&&i.altKey),n.separator),t.metaKey&&this.renderKey(e,n.metaKey,!!(i!=null&&i.metaKey),n.separator);const r=t.keyLabel;r&&this.renderKey(e,r,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,n){De(e,this.createKeyElement(t,i?".highlight":"")),n&&De(e,Sx("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){De(e,this.createKeyElement(w(15,"Unbound")))}createKeyElement(e,t=""){const i=Sx("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&xr(e.firstPart,t.firstPart)&&xr(e.chordPart,t.chordPart)}}var $r;(function(s){s[s.Expanded=0]="Expanded",s[s.Collapsed=1]="Collapsed",s[s.PreserveOrExpanded=2]="PreserveOrExpanded",s[s.PreserveOrCollapsed=3]="PreserveOrCollapsed"})($r||($r={}));var Xf;(function(s){s[s.Unknown=0]="Unknown",s[s.Twistie=1]="Twistie",s[s.Element=2]="Element",s[s.Filter=3]="Filter"})(Xf||(Xf={}));class Zr extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class u9{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function iy(s){return!!s&&s.visibility!==void 0}function Yg(s){switch(s){case!0:return 1;case!1:return 0;default:return s}}function iA(s){return"collapsible"in s}class PRe{constructor(e,t,i={}){this.user=e,this.rootRef=[],this.eventBufferer=new Dv,this._onDidSpliceModel=new $,this.onDidSpliceModel=this._onDidSpliceModel.event,this._onDidSpliceRenderedNodes=new $,this.onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event,this._onDidChangeCollapseState=new $,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new $,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this.refilterDelayer=new Iv(PQ),this.collapseByDefault=typeof i.collapseByDefault>"u"?!1:i.collapseByDefault,this.allowNonCollapsibleParents=i.allowNonCollapsibleParents??!1,this.filter=i.filter,this.autoExpandSingleChildren=typeof i.autoExpandSingleChildren>"u"?!1:i.autoExpandSingleChildren,this.root={parent:void 0,element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=_t.empty(),n={}){if(e.length===0)throw new Zr(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=_t.empty(),r,o=r.diffDepth??0){const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,r);const l=[...n],c=t[t.length-1],u=new hh({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+i)].map(C=>e.getId(C.element).toString())}).ComputeDiff(!1);if(u.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,r);const d=t.slice(0,-1),g=(C,v,x)=>{if(o>0)for(let S=0;S<x;S++)C--,v--,this.spliceSmart(e,[...d,C,0],Number.MAX_SAFE_INTEGER,l[v].children,r,o-1)};let p=Math.min(a.children.length,c+i),_=l.length;for(const C of u.changes.sort((v,x)=>x.originalStart-v.originalStart))g(p,_,p-(C.originalStart+C.originalLength)),p=C.originalStart,_=C.modifiedStart-c,this.spliceSimple([...d,p],C.originalLength,_t.slice(l,_,_+C.modifiedLength),r);g(p,_,p)}spliceSimple(e,t,i=_t.empty(),{onDidCreateNode:n,onDidDeleteNode:r,diffIdentityProvider:o}){const{parentNode:a,listIndex:l,revealed:c,visible:u}=this.getParentNodeWithListIndex(e),d=[],g=_t.map(i,T=>this.createTreeNode(T,a,a.visible?1:0,c,d,n)),p=e[e.length-1];let _=0;for(let T=p;T>=0&&T<a.children.length;T--){const R=a.children[T];if(R.visible){_=R.visibleChildIndex;break}}const C=[];let v=0,x=0;for(const T of g)C.push(T),x+=T.renderNodeCount,T.visible&&(T.visibleChildIndex=_+v++);const S=BL(a.children,p,t,C);o?a.lastDiffIds?BL(a.lastDiffIds,p,t,C.map(T=>o.getId(T.element).toString())):a.lastDiffIds=a.children.map(T=>o.getId(T.element).toString()):a.lastDiffIds=void 0;let k=0;for(const T of S)T.visible&&k++;if(k!==0)for(let T=p+C.length;T<a.children.length;T++){const R=a.children[T];R.visible&&(R.visibleChildIndex-=k)}if(a.visibleChildrenCount+=v-k,S.length>0&&r){const T=R=>{r(R),R.children.forEach(T)};S.forEach(T)}if(c&&u){const T=S.reduce((R,N)=>R+(N.visible?N.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,x-T),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:T,elements:d})}this._onDidSpliceModel.fire({insertedNodes:C,deletedNodes:S});let E=a;for(;E;){if(E.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}E=E.parent}}rerender(e){if(e.length===0)throw new Zr(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this._onDidSpliceRenderedNodes.fire({start:i,deleteCount:1,elements:[t]})}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);const r={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:r}=this.getTreeNodeWithListIndex(e),o=this._setListNodeCollapseState(i,n,r,t);if(i!==this.root&&this.autoExpandSingleChildren&&o&&!iA(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return o}_setListNodeCollapseState(e,t,i,n){const r=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!r)return r;const o=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=o-(t===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:t+1,deleteCount:l,elements:a.slice(1)}),r}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(iA(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!iA(t)&&t.recursive)for(const r of e.children)n=this._setNodeCollapseState(r,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:e,elements:t}),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,r,o){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&r.push(a);const c=e.children||_t.empty(),u=n&&l!==0&&!a.collapsed;let d=0,g=1;for(const p of c){const _=this.createTreeNode(p,a,l,u,r,o);a.children.push(_),g+=_.renderNodeCount,_.visible&&(_.visibleChildIndex=d++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=d,a.visible=l===2?d>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=g):(a.renderNodeCount=0,n&&r.pop()),o==null||o(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),r===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const o=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||r!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,r,i,n&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=r===2?a:r===1,e.visibility=r),e.visible?e.collapsed||(e.renderNodeCount+=i.length-o):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):iy(i)?(e.filterData=i.data,Yg(i.visibility)):(e.filterData=void 0,Yg(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new Zr(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:r}=this.getParentNodeWithListIndex(e),o=e[e.length-1];if(o<0||o>t.children.length)throw new Zr(this.user,"Invalid tree location");const a=t.children[o];return{node:a,listIndex:i,revealed:n,visible:r&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,r=!0){const[o,...a]=e;if(o<0||o>t.children.length)throw new Zr(this.user,"Invalid tree location");for(let l=0;l<o;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,r=r&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:r}:this.getParentNodeWithListIndex(a,t.children[o],i+1,n,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:bfe(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class FRe extends Xv{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function nA(s){return s instanceof Xv?new FRe(s):s}class BRe{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=ne.None,this.disposables=new Ee}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,nA(e),t)}onDragOver(e,t,i,n,r,o=!0){const a=this.dnd.onDragOver(nA(e),t&&t.element,i,n,r),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=a4(()=>{const p=this.modelProvider(),_=p.getNodeLocation(t);p.isCollapsed(_)&&p.setCollapsed(_,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!o){const p=typeof a=="boolean"?a:a.accept,_=typeof a=="boolean"?void 0:a.effect;return{accept:p,effect:_,feedback:[i]}}return a}if(a.bubble===1){const p=this.modelProvider(),_=p.getNodeLocation(t),C=p.getParentNodeLocation(_),v=p.getNode(C),x=C&&p.getListIndex(C);return this.onDragOver(e,v,x,n,r,!1)}const c=this.modelProvider(),u=c.getNodeLocation(t),d=c.getListIndex(u),g=c.getListRenderCount(u);return{...a,feedback:Ms(d,d+g)}}drop(e,t,i,n,r){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(nA(e),t&&t.element,i,n,r)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function VRe(s,e,t){return t&&{...t,identityProvider:t.identityProvider&&{getId(i){return t.identityProvider.getId(i.element)}},dnd:t.dnd&&e.add(new BRe(s,t.dnd)),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent(i){return t.multipleSelectionController.isSelectionSingleChangeEvent({...i,element:i.element})},isSelectionRangeChangeEvent(i){return t.multipleSelectionController.isSelectionRangeChangeEvent({...i,element:i.element})}},accessibilityProvider:t.accessibilityProvider&&{...t.accessibilityProvider,getSetSize(i){const n=s(),r=n.getNodeLocation(i),o=n.getParentNodeLocation(r);return n.getNode(o).visibleChildrenCount},getPosInSet(i){return i.visibleChildIndex+1},isChecked:t.accessibilityProvider&&t.accessibilityProvider.isChecked?i=>t.accessibilityProvider.isChecked(i.element):void 0,getRole:t.accessibilityProvider&&t.accessibilityProvider.getRole?i=>t.accessibilityProvider.getRole(i.element):()=>"treeitem",getAriaLabel(i){return t.accessibilityProvider.getAriaLabel(i.element)},getWidgetAriaLabel(){return t.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:t.accessibilityProvider&&t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider&&t.accessibilityProvider.getAriaLevel?i=>t.accessibilityProvider.getAriaLevel(i.element):i=>i.depth,getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(i=>t.accessibilityProvider.getActiveDescendantId(i.element))},keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(i){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(i.element)}}}}class d9{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,n;(n=(i=this.delegate).setDynamicHeight)==null||n.call(i,e.element,t)}}var Qg;(function(s){s.None="none",s.OnHover="onHover",s.Always="always"})(Qg||(Qg={}));class WRe{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new Ee,this.onDidChange=ge.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}const d_=class d_{constructor(e,t,i,n,r,o={}){var a;this.renderer=e,this.model=t,this.activeNodes=n,this.renderedIndentGuides=r,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=d_.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=ne.None,this.disposables=new Ee,this.templateId=e.templateId,this.updateOptions(o),ge.map(i,l=>l.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(a=e.onDidChangeTwistieState)==null||a.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=tr(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,n]of this.renderedNodes)n.indentSize=d_.DefaultIndent+(i.depth-1)*this.indent,this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==Qg.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){const i=new Ee;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=De(e,Ve(".monaco-tl-row")),i=De(t,Ve(".monaco-tl-indent")),n=De(t,Ve(".monaco-tl-twistie")),r=De(t,Ve(".monaco-tl-contents")),o=this.renderer.renderTemplate(r);return{container:e,indent:i,twistie:n,indentGuidesDisposable:ne.None,indentSize:0,templateData:o}}renderElement(e,t,i,n){i.indentSize=d_.DefaultIndent+(e.depth-1)*this.indent,this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,{...n,indent:i.indentSize})}disposeElement(e,t,i,n){var r,o;i.indentGuidesDisposable.dispose(),(o=(r=this.renderer).disposeElement)==null||o.call(r,e,t,i.templateData,{...n,indent:i.indentSize}),typeof(n==null?void 0:n.height)=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){t.twistie.style.paddingLeft=`${t.indentSize}px`,t.indent.style.width=`${t.indentSize+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...ht.asClassNameArray(xe.treeItemExpanded));let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...ht.asClassNameArray(xe.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(Ya(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new Ee;for(;;){const n=this.model.getNodeLocation(e),r=this.model.getParentNodeLocation(n);if(!r)break;const o=this.model.getNode(r),a=Ve(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(o)&&a.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(o,a),i.add(Fe(()=>this.renderedIndentGuides.delete(o,a))),e=o}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set;e.forEach(i=>{const n=this.model.getNodeLocation(i);try{const r=this.model.getParentNodeLocation(n);i.collapsible&&i.children.length>0&&!i.collapsed?t.add(i):r&&t.add(this.model.getNode(r))}catch{}}),this.activeIndentNodes.forEach(i=>{t.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.remove("active"))}),t.forEach(i=>{this.activeIndentNodes.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),Zi(this.disposables)}};d_.DefaultIndent=8;let $O=d_;function HRe(s,e){const t=e.toLowerCase().indexOf(s);let i;if(t>-1){i=[Number.MAX_SAFE_INTEGER,0];for(let n=s.length;n>0;n--)i.push(t+n-1)}return i}class Xee{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set findMatchType(e){this._findMatchType=e}get findMatchType(){return this._findMatchType}set findMode(e){this._findMode=e}get findMode(){return this._findMode}constructor(e,t,i){this._keyboardNavigationLabelProvider=e,this._filter=t,this._defaultFindVisibility=i,this._totalCount=0,this._matchCount=0,this._findMatchType=Wa.Fuzzy,this._findMode=Jr.Highlight,this._pattern="",this._lowercasePattern="",this.disposables=new Ee}filter(e,t){let i=1;if(this._filter){const o=this._filter.filter(e,t);if(typeof o=="boolean"?i=o?1:0:iy(o)?i=Yg(o.visibility):i=o,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:ug.Default,visibility:i};const n=this._keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(n)?n:[n];for(const o of r){const a=o&&o.toString();if(typeof a>"u")return{data:ug.Default,visibility:i};let l;if(this._findMatchType===Wa.Contiguous?l=HRe(this._lowercasePattern,a.toLowerCase()):l=QJ(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0}),l)return this._matchCount++,r.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this._findMode===Jr.Filter?typeof this._defaultFindVisibility=="number"?this._defaultFindVisibility:this._defaultFindVisibility?this._defaultFindVisibility(e):2:{data:ug.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){Zi(this.disposables)}}class zRe{constructor(e){this.stateMap=new Map(e.map(t=>[t.id,{...t}]))}get(e){const t=this.stateMap.get(e);if(t===void 0)throw new Error(`No state found for toggle id ${e}`);return t.isChecked}set(e,t){const i=this.stateMap.get(e);if(i===void 0)throw new Error(`No state found for toggle id ${e}`);return i.isChecked===t?!1:(i.isChecked=t,!0)}}var Jr;(function(s){s[s.Highlight=0]="Highlight",s[s.Filter=1]="Filter"})(Jr||(Jr={}));var Wa;(function(s){s[s.Fuzzy=0]="Fuzzy",s[s.Contiguous=1]="Contiguous"})(Wa||(Wa={}));var xu;(function(s){s.Mode="mode",s.MatchType="matchType"})(xu||(xu={}));class URe{get pattern(){return this._pattern}get placeholder(){return this._placeholder}set placeholder(e){var t;this._placeholder=e,(t=this.widget)==null||t.setPlaceHolder(e)}constructor(e,t,i,n={}){this.tree=e,this.filter=t,this.contextViewProvider=i,this.options=n,this._pattern="",this._onDidChangePattern=new $,this._onDidChangeOpenState=new $,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new Ee,this.disposables=new Ee,this.toggles=new zRe(n.toggles??[]),this._placeholder=n.placeholder??w(20,"Type to search")}isOpened(){return!!this.widget}updateToggleState(e,t){var i;this.toggles.set(e,t),(i=this.widget)==null||i.setToggleState(e,t)}renderMessage(e,t){var i,n,r;e?this.tree.options.showNotFoundMessage??!0?(i=this.widget)==null||i.showMessage({type:2,content:t??w(21,"No results found.")}):(n=this.widget)==null||n.showMessage({type:2}):(r=this.widget)==null||r.clearMessage()}alertResults(e){Nw(e?w(23,"{0} results",e):w(22,"No results"))}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class Zee extends URe{get mode(){return this.toggles.get(xu.Mode)?Jr.Filter:Jr.Highlight}set mode(e){if(e===this.mode)return;const t=e===Jr.Filter;this.updateToggleState(xu.Mode,t),this.placeholder=t?w(24,"Type to filter"):w(25,"Type to search"),this.filter.findMode=e,this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e)}get matchType(){return this.toggles.get(xu.MatchType)?Wa.Fuzzy:Wa.Contiguous}set matchType(e){e!==this.matchType&&(this.updateToggleState(xu.MatchType,e===Wa.Fuzzy),this.filter.findMatchType=e,this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,n={}){const r=n.defaultFindMode??Jr.Highlight,o=n.defaultFindMatchType??Wa.Fuzzy,a=[{id:xu.Mode,icon:xe.listFilter,title:w(26,"Filter"),isChecked:r===Jr.Filter},{id:xu.MatchType,icon:xe.searchFuzzy,title:w(27,"Fuzzy Match"),isChecked:o===Wa.Fuzzy}];t.findMatchType=o,t.findMode=r,super(e,t,i,{...n,toggles:a}),this.filter=t,this._onDidChangeMode=new $,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new $,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this.disposables.add(this.tree.onDidChangeModel(()=>{this.isOpened()&&(this.pattern.length!==0&&this.tree.refilter(),this.render())})),this.disposables.add(this.tree.onWillRefilter(()=>this.filter.reset()))}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}shouldAllowFocus(e){return!this.isOpened()||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!ug.isDefault(e.filterData)}render(){const t=this.filter.matchCount===0&&this.filter.totalCount>0&&this.pattern.length>0;this.renderMessage(t),this.pattern.length&&this.alertResults(this.filter.matchCount)}}function jRe(s,e){return s.position===e.position&&Jee(s,e)}function Jee(s,e){return s.node.element===e.node.element&&s.startIndex===e.startIndex&&s.height===e.height&&s.endIndex===e.endIndex}class $Re{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return sn(this.stickyNodes,e.stickyNodes,jRe)}contains(e){return this.stickyNodes.some(t=>t.node.element===e.element)}lastNodePartiallyVisible(){if(this.count===0)return!1;const e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!sn(this.stickyNodes,e.stickyNodes,Jee)||this.count===0)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class qRe{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){const r=e[n];if(r.position+r.height>i||n>=t)return e.slice(0,n)}return e}}class nq extends ne{constructor(e,t,i,n,r,o={}){super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=r,this.maxWidgetViewRatio=.4;const a=this.validateStickySettings(o);this.stickyScrollMaxItemCount=a.stickyScrollMaxItemCount,this.stickyScrollDelegate=o.stickyScrollDelegate??new qRe,this.paddingTop=o.paddingTop??0,this._widget=this._register(new GRe(i.getScrollableElement(),i,e,n,r,o.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this._register(t.onDidSpliceRenderedNodes(l=>{const c=this._widget.state;if(!c)return;if(l.deleteCount>0&&c.stickyNodes.some(g=>!this.model.has(this.model.getNodeLocation(g.node)))){this.update();return}c.stickyNodes.some(g=>{const p=this.model.getListIndex(this.model.getNodeLocation(g.node));return p>=l.start&&p<l.start+l.deleteCount&&c.contains(g.node)})&&this._widget.rerender()})),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(e===0?t=this.view.firstVisibleIndex:t=this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(this.paddingTop);if(!e||this.tree.scrollTop<=this.paddingTop){this._widget.setState(void 0);return}const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,n=0,r=this.getNextStickyNode(i,void 0,n);for(;r&&(t.push(r),n+=r.height,!(t.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(r),!i)));)r=this.getNextStickyNode(i,r.node,n);const o=this.constrainStickyNodes(t);return o.length?new $Re(o):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const n=this.getAncestorUnderPrevious(e,t);if(n&&!(n===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,i))))return this.createStickyScrollNode(n,i)}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),n=this.view.getElementTop(i),r=t;return this.view.scrollTop===n-r}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:n,endIndex:r}=this.getNodeRange(e),o=this.calculateStickyNodePosition(r,t,i);return{node:e,position:o,height:i,startIndex:n,endIndex:r}}getAncestorUnderPrevious(e,t=void 0){let i=e,n=this.getParentNode(i);for(;n;){if(n===t)return i;i=n,n=this.getParentNode(i)}if(t===void 0)return i}calculateStickyNodePosition(e,t,i){let n=this.view.getRelativeTop(e);if(n===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const c=this.treeDelegate.getHeight(this.view.element(e)),u=this.view.getRelativeTop(e+1);n=u?u-c/this.view.renderHeight:null}if(n===null)return t;const r=this.view.element(e),o=this.treeDelegate.getHeight(r),l=n*this.view.renderHeight+o;return t+i>l&&t<=l?l-i:t}constrainStickyNodes(e){if(e.length===0)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const n=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!n.length)return[];const r=n[n.length-1];if(n.length>this.stickyScrollMaxItemCount||r.position+r.height>t)throw new Error("stickyScrollDelegate violates constraints");return n}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");const n=this.model.getListRenderCount(t),r=i+n-1;return{startIndex:i,endIndex:r}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let n=0;for(let r=0;r<t.length&&r<this.stickyScrollMaxItemCount;r++)n+=this.treeDelegate.getHeight(t[r]);return n}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(e.paddingTop!==void 0&&(this.paddingTop=e.paddingTop),e.stickyScrollMaxItemCount!==void 0){const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}}validateStickySettings(e){let t=7;return typeof e.stickyScrollMaxItemCount=="number"&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}}class GRe{get state(){return this._previousState}constructor(e,t,i,n,r,o){this.view=t,this.tree=i,this.treeRenderers=n,this.treeDelegate=r,this.accessibilityProvider=o,this._previousElements=[],this._previousStateDisposables=new Ee,this._rootDomNode=Ve(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const a=Ve(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new KRe(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const n=e.stickyNodes[e.count-1];this._previousState&&e.animationStateChanged(this._previousState)?this._previousElements[this._previousState.count-1].style.top=`${n.position}px`:this.renderState(e),this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}renderState(e){this._previousStateDisposables.clear();const t=Array(e.count);for(let i=e.count-1;i>=0;i--){const n=e.stickyNodes[i],{element:r,disposable:o}=this.createElement(n,i,e.count);t[i]=r,this._rootDomNode.appendChild(r),this._previousStateDisposables.add(o)}this.stickyScrollFocus.updateElements(t,e),this._previousElements=t}rerender(){this._previousState&&this.renderState(this._previousState)}createElement(e,t,i){const n=e.startIndex,r=document.createElement("div");r.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(r.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(r.style.lineHeight=`${e.height}px`),r.classList.add("monaco-tree-sticky-row"),r.classList.add("monaco-list-row"),r.setAttribute("data-index",`${n}`),r.setAttribute("data-parity",n%2===0?"even":"odd"),r.setAttribute("id",this.view.getElementID(n));const o=this.setAccessibilityAttributes(r,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(g=>g.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let c=e.node;c===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(c=new Proxy(e.node,{}));const u=l.renderTemplate(r);l.renderElement(c,e.startIndex,u,{height:e.height});const d=Fe(()=>{o.dispose(),l.disposeElement(c,e.startIndex,u,{height:e.height}),l.disposeTemplate(u),r.remove()});return{element:r,disposable:d}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return ne.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");const r=this.accessibilityProvider.getAriaLabel(t),o=r&&typeof r!="string"?r:Jw(r),a=ct(c=>{const u=c.readObservable(o);u?e.setAttribute("aria-label",u):e.removeAttribute("aria-label")});typeof r=="string"||r&&e.setAttribute("aria-label",r.get());const l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}}class KRe extends ne{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new $,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new $,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(J(this.container,"focus",()=>this.onFocus())),this._register(J(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}handleContextMenu(e){const t=e.browserEvent.target;if(!ev(t)&&!_C(t)){this.focusedLast()&&this.view.domFocus();return}if(!ih(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const o=this.state.stickyNodes.findIndex(a=>{var l;return a.node.element===((l=e.element)==null?void 0:l.element)});if(o===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(o);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const n=this.state.stickyNodes[this.focusedIndex].node.element,r=this.elements[this.focusedIndex];this._onContextMenu.fire({element:n,anchor:r,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){const t=e.browserEvent.target;!ev(t)&&!_C(t)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&t.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const n=tr(i,0,t.count-1);this.setFocus(n)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],n=t.count>1?t.stickyNodes[t.count-2]:void 0,r=this.view.getElementTop(e),o=n?n.position+n.height+i.height:i.height;this.view.scrollTop=r-o}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function xx(s){let e=Xf.Unknown;return QI(s.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=Xf.Twistie:QI(s.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=Xf.Element:QI(s.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=Xf.Filter),{browserEvent:s.browserEvent,element:s.element?s.element.element:null,target:e}}function YRe(s){const e=ev(s.browserEvent.target);return{element:s.element?s.element.element:null,browserEvent:s.browserEvent,anchor:s.anchor,isStickyScroll:e}}function eL(s,e){e(s),s.children.forEach(t=>eL(t,e))}class sA{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new $,this.onDidChange=this._onDidChange.event}set(e,t){const i=t;!(i!=null&&i.__forceEvent)&&sn(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=u=>l.delete(u);t.forEach(u=>eL(u,c)),this.set([...l.values()]);return}const i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>eL(l,n));const r=new Map,o=l=>r.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>eL(l,o));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const d=r.get(c);d&&d.visible&&a.push(d)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class QRe extends Oee{constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if(Iee(e.browserEvent.target)||qa(e.browserEvent.target)||E0(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,r=_C(e.browserEvent.target);let o=!1;if(r?o=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?o=this.tree.expandOnlyOnTwistieClick(t.element):o=!!this.tree.expandOnlyOnTwistieClick,r)this.handleStickyScrollMouseEvent(e,t);else{if(o&&!n&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(t.collapsible&&(!r||n)){const a=this.tree.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),this.tree.toggleCollapsed(a,l),n){e.browserEvent.isHandledByList=!0;return}}r||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if(rIe(e.browserEvent.target)||oIe(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const n=this.list.indexOf(t),r=this.list.getElementTop(n),o=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=r-o,this.list.domFocus(),this.list.setFocus([n]),this.list.setSelection([n])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){const t=e.browserEvent.target;if(!ev(t)&&!_C(t)){super.onMouseDown(e);return}}onContextMenu(e){const t=e.browserEvent.target;if(!ev(t)&&!_C(t)){super.onContextMenu(e);return}}}class XRe extends il{constructor(e,t,i,n,r,o,a,l){super(e,t,i,n,l),this.focusTrait=r,this.selectionTrait=o,this.anchorTrait=a}createMouseController(e){return new QRe(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const n=[],r=[];let o;i.forEach((a,l)=>{this.focusTrait.has(a)&&n.push(e+l),this.selectionTrait.has(a)&&r.push(e+l),this.anchorTrait.has(a)&&(o=e+l)}),n.length>0&&super.setFocus(Ag([...super.getFocus(),...n])),r.length>0&&super.setSelection(Ag([...super.getSelection(),...r])),typeof o=="number"&&super.setAnchor(o)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(n=>this.element(n)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(n=>this.element(n)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class ete{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return ge.filter(ge.map(this.view.onMouseDblClick,xx),e=>e.target!==Xf.Filter)}get onMouseOver(){return ge.map(this.view.onMouseOver,xx)}get onMouseOut(){return ge.map(this.view.onMouseOut,xx)}get onContextMenu(){var e;return ge.any(ge.filter(ge.map(this.view.onContextMenu,YRe),t=>!t.isStickyScroll),((e=this.stickyScrollController)==null?void 0:e.onContextMenu)??ge.None)}get onPointer(){return ge.map(this.view.onPointer,xx)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return ge.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.onDidChangeCollapseStateRelay.event}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,n,r={}){this._user=e,this._options=r,this.eventBufferer=new Dv,this.onDidChangeFindOpenState=ge.None,this.onDidChangeStickyScrollFocused=ge.None,this.disposables=new Ee,this.onDidSwapModel=this.disposables.add(new $),this.onDidChangeModelRelay=this.disposables.add(new Gb),this.onDidSpliceModelRelay=this.disposables.add(new Gb),this.onDidChangeCollapseStateRelay=this.disposables.add(new Gb),this.onDidChangeRenderNodeCountRelay=this.disposables.add(new Gb),this.onDidChangeActiveNodesRelay=this.disposables.add(new Gb),this._onWillRefilter=new $,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new $,this.modelDisposables=new Ee,r.keyboardNavigationLabelProvider&&(r.findWidgetEnabled??!0)&&(this.findFilter=new Xee(r.keyboardNavigationLabelProvider,r.filter,r.defaultFindVisibility),r={...r,filter:this.findFilter},this.disposables.add(this.findFilter)),this.model=this.createModel(e,r),this.treeDelegate=new d9(i);const o=this.disposables.add(new WRe(this.onDidChangeActiveNodesRelay.event)),a=new oX;this.renderers=n.map(l=>new $O(l,this.model,this.onDidChangeCollapseStateRelay.event,o,a,r));for(const l of this.renderers)this.disposables.add(l);if(this.focus=new sA(()=>this.view.getFocusedElements()[0],r.identityProvider),this.selection=new sA(()=>this.view.getSelectedElements()[0],r.identityProvider),this.anchor=new sA(()=>this.view.getAnchorElement(),r.identityProvider),this.view=new XRe(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...VRe(()=>this.model,this.disposables,r),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),r.keyboardSupport!==!1){const l=ge.chain(this.view.onKeyDown,c=>c.filter(u=>!qa(u.target)).map(u=>new jt(u)));ge.chain(l,c=>c.filter(u=>u.keyCode===15))(this.onLeftArrow,this,this.disposables),ge.chain(l,c=>c.filter(u=>u.keyCode===17))(this.onRightArrow,this,this.disposables),ge.chain(l,c=>c.filter(u=>u.keyCode===10))(this.onSpace,this,this.disposables)}if((r.findWidgetEnabled??!0)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider){const l={styles:r.findWidgetStyles,defaultFindMode:r.defaultFindMode,defaultFindMatchType:r.defaultFindMatchType,showNotFoundMessage:r.showNotFoundMessage};this.findController=this.disposables.add(new Zee(this,this.findFilter,r.contextViewProvider,l)),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=ge.None,this.onDidChangeFindMatchType=ge.None;r.enableStickyScroll&&(this.stickyScrollController=new nq(this,this.model,this.view,this.renderers,this.treeDelegate,r),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Qa(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Qg.Always)}updateOptions(e={}){var t;this._options={...this._options,...e};for(const i of this.renderers)i.updateOptions(e);this.view.updateOptions(this._options),(t=this.findController)==null||t.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Qg.Always)}get options(){return this._options}updateStickyScroll(e){var t;!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new nq(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=ge.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),(t=this.stickyScrollController)==null||t.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){var e;(e=this.stickyScrollController)!=null&&e.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){this.view.layout(e,t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { opacity: 1; border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { opacity: 1; border-color: ${e.treeIndentGuidesStroke}; }`));const n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const r=Th(e.listFocusAndSelectionOutline,Th(e.listSelectionOutline,e.listFocusOutline??""));r&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(r=>this.model.getNode(r));this.selection.set(i,t);const n=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(r=>this.model.getNode(r));this.focus.set(i,t);const n=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=ih(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=ih(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=ih(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=ih(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>{var i;return((i=this.stickyScrollController)==null?void 0:i.height)??0})}focusLast(e,t=ih(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=ih(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{const n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const o=this.model.getParentNodeLocation(n);if(!o)return;const a=this.model.getListIndex(o);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;const[o]=this.view.getFocus(),a=o+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i),r=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,r)}setupModel(e){this.modelDisposables.clear(),this.modelDisposables.add(e.onDidSpliceRenderedNodes(({start:r,deleteCount:o,elements:a})=>this.view.splice(r,o,a)));const t=ge.forEach(e.onDidSpliceModel,r=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(r),this.selection.onDidModelSplice(r)})},this.modelDisposables);t(()=>null,null,this.modelDisposables);const i=this.modelDisposables.add(new $),n=this.modelDisposables.add(new Iv(0));this.modelDisposables.add(ge.any(t,this.focus.onDidChange,this.selection.onDidChange)(()=>{n.trigger(()=>{const r=new Set;for(const o of this.focus.getNodes())r.add(o);for(const o of this.selection.getNodes())r.add(o);i.fire([...r.values()])})})),this.onDidChangeActiveNodesRelay.input=i.event,this.onDidChangeModelRelay.input=ge.signal(e.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=e.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=e.onDidChangeRenderNodeCount,this.onDidSpliceModelRelay.input=e.onDidSpliceModel}dispose(){var e;Zi(this.disposables),(e=this.stickyScrollController)==null||e.dispose(),this.view.dispose(),this.modelDisposables.dispose()}}const sq=new Ws(()=>{const s=Vv.Collator(void 0,{numeric:!0,sensitivity:"base"}).value;return{collator:s,collatorIsNumeric:s.resolvedOptions().numeric}});new Ws(()=>({collator:Vv.Collator(void 0,{numeric:!0}).value}));new Ws(()=>({collator:Vv.Collator(void 0,{numeric:!0,sensitivity:"accent"}).value}));function ZRe(s,e,t=!1){const i=s||"",n=e||"",r=sq.value.collator.compare(i,n);return sq.value.collatorIsNumeric&&r===0&&i!==n?i<n?-1:1:r}function JRe(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),r=eAe(s,e,t);if(r)return r;const o=i.endsWith(t),a=n.endsWith(t);if(o!==a)return o?-1:1;const l=ZRe(i,n);return l!==0?l:i.localeCompare(n)}function eAe(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),r=i.startsWith(t),o=n.startsWith(t);if(r!==o)return r?-1:1;if(r&&o){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}class tAe{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:ne.None}}renderElement(e,t,i,n){var l;if((l=i.disposable)==null||l.dispose(),!i.data)return;const r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,i.data,n);const o=new sm,a=r.resolve(e,o.token);i.disposable={dispose:()=>o.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(c=>this.renderer.renderElement(c,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class iAe{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function nAe(s,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new iAe(s,e.accessibilityProvider)}}class sAe{constructor(e,t,i,n,r={}){this.modelDisposables=new Ee;const o=()=>this.model,a=n.map(l=>new tAe(l,o));this.list=new il(e,t,i,a,nAe(o,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return ge.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return ge.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return ge.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this.modelDisposables.clear(),this._model=e,this.list.splice(0,this.list.length,Ms(e.length)),this.modelDisposables.add(e.onDidIncrementLength(t=>this.list.splice(this.list.length,0,Ms(this.list.length,t))))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose(),this.modelDisposables.dispose()}}var G1=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};const rAe=!1;var rq;(function(s){s.North="north",s.South="south",s.East="east",s.West="west"})(rq||(rq={}));let oAe=4;const aAe=new $;let lAe=300;const cAe=new $;class f9{constructor(e){this.el=e,this.disposables=new Ee}get onPointerMove(){return this.disposables.add(new Nt(Ae(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Nt(Ae(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}G1([Si],f9.prototype,"onPointerMove",null);G1([Si],f9.prototype,"onPointerUp",null);class g9{get onPointerMove(){return this.disposables.add(new Nt(this.el,Qt.Change)).event}get onPointerUp(){return this.disposables.add(new Nt(this.el,Qt.End)).event}constructor(e){this.el=e,this.disposables=new Ee}dispose(){this.disposables.dispose()}}G1([Si],g9.prototype,"onPointerMove",null);G1([Si],g9.prototype,"onPointerUp",null);class cE{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}G1([Si],cE.prototype,"onPointerMove",null);G1([Si],cE.prototype,"onPointerUp",null);const oq="pointer-events-disabled";class ko extends ne{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}get onDidStart(){return this._onDidStart.event}get onDidChange(){return this._onDidChange.event}get onDidReset(){return this._onDidReset.event}get onDidEnd(){return this._onDidEnd.event}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=De(this.el,Ve(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Fe(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(J(this._orthogonalStartDragHandle,"mouseenter",()=>ko.onMouseEnter(e))),this.orthogonalStartDragHandleDisposables.add(J(this._orthogonalStartDragHandle,"mouseleave",()=>ko.onMouseLeave(e))))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=De(this.el,Ve(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Fe(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(J(this._orthogonalEndDragHandle,"mouseenter",()=>ko.onMouseEnter(e))),this.orthogonalEndDragHandleDisposables.add(J(this._orthogonalEndDragHandle,"mouseleave",()=>ko.onMouseLeave(e))))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=lAe,this.hoverDelayer=this._register(new Iv(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new $),this._onDidStart=this._register(new $),this._onDidChange=this._register(new $),this._onDidReset=this._register(new $),this._onDidEnd=this._register(new $),this.orthogonalStartSashDisposables=this._register(new Ee),this.orthogonalStartDragHandleDisposables=this._register(new Ee),this.orthogonalEndSashDisposables=this._register(new Ee),this.orthogonalEndDragHandleDisposables=this._register(new Ee),this.linkedSash=void 0,this.el=De(e,Ve(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),rt&&this.el.classList.add("mac"),this._register(J(this.el,"mousedown",r=>this.onPointerStart(r,new f9(e)))),this._register(J(this.el,"dblclick",r=>this.onPointerDoublePress(r))),this._register(J(this.el,"mouseenter",()=>ko.onMouseEnter(this))),this._register(J(this.el,"mouseleave",()=>ko.onMouseLeave(this))),this._register($s.addTarget(this.el)),this._register(J(this.el,Qt.Start,r=>this.onPointerStart(r,new g9(this.el))));let n;this._register(J(this.el,Qt.Tap,r=>{if(n){clearTimeout(n),n=void 0,this.onPointerDoublePress(r);return}clearTimeout(n),n=setTimeout(()=>n=void 0,250)})),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=oAe,this._register(aAe.event(r=>{this.size=r,this.layout()}))),this._register(cAe.event(r=>this.hoverDelay=r)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",rAe),this.layout()}onPointerStart(e,t){vt.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const _=this.getOrthogonalSash(e);_&&(i=!0,e.__orthogonalSashEvent=!0,_.onPointerStart(e,new cE(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new cE(t))),!this.state)return;const n=this.el.ownerDocument.getElementsByTagName("iframe");for(const _ of n)_.classList.add(oq);const r=e.pageX,o=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:o,currentY:o,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=Qa(this.el),u=()=>{let _="";i?_="all-scroll":this.orientation===1?this.state===1?_="s-resize":this.state===2?_="n-resize":_=rt?"row-resize":"ns-resize":this.state===1?_="e-resize":this.state===2?_="w-resize":_=rt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${_} !important; }`},d=new Ee;u(),i||this.onDidEnablementChange.event(u,null,d);const g=_=>{vt.stop(_,!1);const C={startX:r,currentX:_.pageX,startY:o,currentY:_.pageY,altKey:a};this._onDidChange.fire(C)},p=_=>{vt.stop(_,!1),c.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),d.dispose();for(const C of n)C.classList.remove(oq)};t.onPointerMove(g,null,d),t.onPointerUp(p,null,d),d.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&ko.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&ko.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){ko.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){const t=e.initialTarget??e.target;if(!(!t||!Wi(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const hAe={separatorBorder:ae.transparent};class tte{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){var i,n;if(e!==this.visible){e?(this.size=tr(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{(n=(i=this.view).setVisible)==null||n.call(i,e)}catch(r){console.error("Splitview: Failed to set visible view"),console.error(r)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}}class uAe extends tte{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class dAe extends tte{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var Kc;(function(s){s[s.Idle=0]="Idle",s[s.Busy=1]="Busy"})(Kc||(Kc={}));var aq;(function(s){s.Distribute={type:"distribute"};function e(n){return{type:"split",index:n}}s.Split=e;function t(n){return{type:"auto",index:n}}s.Auto=t;function i(n){return{type:"invisible",cachedVisibleSize:n}}s.Invisible=i})(aq||(aq={}));class fAe extends ne{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=Kc.Idle,this._onDidSashChange=this._register(new $),this._onDidSashReset=this._register(new $),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=De(this.el,Ve(".sash-container")),this.viewContainer=Ve(".split-view-container"),this.scrollable=this._register(new U1({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>hr(Ae(this.el),n)})),this.scrollableElement=this._register(new ND(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));const i=this._register(new Nt(this.viewContainer,"scroll")).event;this._register(i(n=>{const r=this.scrollableElement.getScrollPosition(),o=Math.abs(this.viewContainer.scrollLeft-r.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-r.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(o!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:o,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),De(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||hAe),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,r)=>{const o=to(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,o,r,!0)}),this._contentSize=this.viewItems.reduce((n,r)=>n+r.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"?n+=a:e-=o.size}for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&n>0&&(o.size=tr(Math.round(a*e/n),o.minimumSize,o.maximumSize))}}else{const n=Ms(this.viewItems.length),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,r,o)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const n=this.sashItems.findIndex(a=>a.sash===e),r=Bl(J(this.el.ownerDocument.body,"keydown",a=>o(this.sashDragState.current,a.altKey)),J(this.el.ownerDocument.body,"keyup",()=>o(this.sashDragState.current,!1))),o=(a,l)=>{const c=this.viewItems.map(_=>_.size);let u=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){const C=this.viewItems[n];u=(C.minimumSize-C.size)/2,d=(C.maximumSize-C.size)/2}else{const C=this.viewItems[n+1];u=(C.size-C.maximumSize)/2,d=(C.size-C.minimumSize)/2}let g,p;if(!l){const _=Ms(n,-1),C=Ms(n+1,this.viewItems.length),v=_.reduce((A,O)=>A+(this.viewItems[O].minimumSize-c[O]),0),x=_.reduce((A,O)=>A+(this.viewItems[O].viewMaximumSize-c[O]),0),S=C.length===0?Number.POSITIVE_INFINITY:C.reduce((A,O)=>A+(c[O]-this.viewItems[O].minimumSize),0),k=C.length===0?Number.NEGATIVE_INFINITY:C.reduce((A,O)=>A+(c[O]-this.viewItems[O].viewMaximumSize),0),E=Math.max(v,k),T=Math.min(S,x),R=this.findFirstSnapIndex(_),N=this.findFirstSnapIndex(C);if(typeof R=="number"){const A=this.viewItems[R],O=Math.floor(A.viewMinimumSize/2);g={index:R,limitDelta:A.visible?E-O:E+O,size:A.size}}if(typeof N=="number"){const A=this.viewItems[N],O=Math.floor(A.viewMinimumSize/2);p={index:N,limitDelta:A.visible?T+O:T-O,size:A.size}}}this.sashDragState={start:a,current:a,index:n,sizes:c,minDelta:u,maxDelta:d,alt:l,snapBefore:g,snapAfter:p,disposable:r}};o(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:r,minDelta:o,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const u=e-i,d=this.resize(t,u,n,void 0,void 0,o,a,l,c);if(r){const g=t===this.sashItems.length-1,p=this.viewItems.map(k=>k.size),_=g?t:t+1,C=this.viewItems[_],v=C.size-C.maximumSize,x=C.size-C.minimumSize,S=g?t-1:t+1;this.resize(S,-d,p,void 0,void 0,v,x)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=tr(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==Kc.Idle)throw new Error("Cant modify splitview");this.state=Kc.Busy;try{const i=Ms(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],r=i.filter(a=>this.viewItems[a].priority===2),o=this.viewItems[e];t=Math.round(t),t=tr(t,o.minimumSize,Math.min(o.maximumSize,this.size)),o.size=t,this.relayout(n,r)}finally{this.state=Kc.Idle}}}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=tr(i,a.minimumSize,a.maximumSize);const n=Ms(this.viewItems.length),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);this.relayout(r,o)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==Kc.Idle)throw new Error("Cant modify splitview");this.state=Kc.Busy;try{const r=Ve(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(i));const o=e.onDidChange(g=>this.onViewChange(u,g)),a=Fe(()=>r.remove()),l=Bl(o,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const u=this.orientation===0?new uAe(r,e,c,l):new dAe(r,e,c,l);if(this.viewItems.splice(i,0,u),this.viewItems.length>1){const g={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},p=this.orientation===0?new ko(this.sashContainer,{getHorizontalSashTop:A=>this.getSashPosition(A),getHorizontalSashWidth:this.getSashOrthogonalSize},{...g,orientation:1}):new ko(this.sashContainer,{getVerticalSashLeft:A=>this.getSashPosition(A),getVerticalSashHeight:this.getSashOrthogonalSize},{...g,orientation:0}),_=this.orientation===0?A=>({sash:p,start:A.startY,current:A.currentY,alt:A.altKey}):A=>({sash:p,start:A.startX,current:A.currentX,alt:A.altKey}),v=ge.map(p.onDidStart,_)(this.onSashStart,this),S=ge.map(p.onDidChange,_)(this.onSashChange,this),E=ge.map(p.onDidEnd,()=>this.sashItems.findIndex(A=>A.sash===p))(this.onSashEnd,this),T=p.onDidReset(()=>{const A=this.sashItems.findIndex(q=>q.sash===p),O=Ms(A,-1),W=Ms(A+1,this.viewItems.length),j=this.findFirstSnapIndex(O),F=this.findFirstSnapIndex(W);typeof j=="number"&&!this.viewItems[j].visible||typeof F=="number"&&!this.viewItems[F].visible||this._onDidSashReset.fire(A)}),R=Bl(v,S,E,T,p),N={sash:p,disposable:R};this.sashItems.splice(i-1,0,N)}r.appendChild(e.element);let d;typeof t!="number"&&t.type==="split"&&(d=[t.index]),n||this.relayout([i],d),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=Kc.Idle}}relayout(e,t){const i=this.viewItems.reduce((n,r)=>n+r.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(u=>u.size),n,r,o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const u=Ms(e,-1),d=Ms(e+1,this.viewItems.length);if(r)for(const N of r)PI(u,N),PI(d,N);if(n)for(const N of n)IS(u,N),IS(d,N);const g=u.map(N=>this.viewItems[N]),p=u.map(N=>i[N]),_=d.map(N=>this.viewItems[N]),C=d.map(N=>i[N]),v=u.reduce((N,A)=>N+(this.viewItems[A].minimumSize-i[A]),0),x=u.reduce((N,A)=>N+(this.viewItems[A].maximumSize-i[A]),0),S=d.length===0?Number.POSITIVE_INFINITY:d.reduce((N,A)=>N+(i[A]-this.viewItems[A].minimumSize),0),k=d.length===0?Number.NEGATIVE_INFINITY:d.reduce((N,A)=>N+(i[A]-this.viewItems[A].maximumSize),0),E=Math.max(v,k,o),T=Math.min(S,x,a);let R=!1;if(l){const N=this.viewItems[l.index],A=t>=l.limitDelta;R=A!==N.visible,N.setVisible(A,l.size)}if(!R&&c){const N=this.viewItems[c.index],A=t<c.limitDelta;R=A!==N.visible,N.setVisible(A,c.size)}if(R)return this.resize(e,t,i,n,r,o,a);t=tr(t,E,T);for(let N=0,A=t;N<g.length;N++){const O=g[N],W=tr(p[N]+A,O.minimumSize,O.maximumSize),j=W-p[N];A-=j,O.size=W}for(let N=0,A=t;N<_.length;N++){const O=_[N],W=tr(C[N]-A,O.minimumSize,O.maximumSize),j=W-C[N];A+=j,O.size=W}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const n=Ms(this.viewItems.length-1,-1),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);for(const a of o)PI(n,a);for(const a of r)IS(n,a);typeof e=="number"&&IS(n,e);for(let a=0;i!==0&&a<n.length;a++){const l=this.viewItems[n[a]],c=tr(l.size+i,l.minimumSize,l.maximumSize),u=c-l.size;i-=u,l.size=c}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;const r=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const o=n.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],u=this.viewItems[l];a+=u.size;const d=!(t[l]&&o[l+1]),g=!(i[l]&&r[l+1]);if(d&&g){const p=Ms(l,-1),_=Ms(l+1,this.viewItems.length),C=this.findFirstSnapIndex(p),v=this.findFirstSnapIndex(_),x=typeof C=="number"&&!this.viewItems[C].visible,S=typeof v=="number"&&!this.viewItems[v].visible;x&&r[l]&&(a>0||this.startSnappingEnabled)?c.state=1:S&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else d&&!g?c.state=1:!d&&g?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){var e;(e=this.sashDragState)==null||e.disposable.dispose(),Zi(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}}const g2=class g2{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=g2.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map(r=>[r.templateId,r]));this.renderers=[];for(const r of e){const o=n.get(r.templateId);if(!o)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(o)}}renderTemplate(e){const t=De(e,Ve(".monaco-table-tr")),i=[],n=[];for(let o=0;o<this.columns.length;o++){const a=this.renderers[o],l=De(t,Ve(".monaco-table-td",{"data-col-index":o}));l.style.width=`${this.getColumnSize(o)}px`,i.push(l),n.push(a.renderTemplate(l))}const r={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(r),r}renderElement(e,t,i,n){for(let r=0;r<this.columns.length;r++){const a=this.columns[r].project(e);this.renderers[r].renderElement(a,t,i.cellTemplateData[r],n)}}disposeElement(e,t,i,n){for(let r=0;r<this.columns.length;r++){const o=this.renderers[r];if(o.disposeElement){const l=this.columns[r].project(e);o.disposeElement(l,t,i.cellTemplateData[r],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);Ya(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}};g2.TemplateId="row";let hE=g2;function gAe(s){return{getHeight(e){return s.getHeight(e)},getTemplateId(){return hE.TemplateId}}}class mAe extends ne{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??ge.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new $,this.onDidLayout=this._onDidLayout.event,this.element=Ve(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register(tl().setupManagedHover(Ld("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}const m2=class m2{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,n,r,o){this.virtualDelegate=i,this.columns=n,this.domId=`table_id_${++m2.InstanceCount}`,this.disposables=new Ee,this.cachedWidth=0,this.cachedHeight=0,this.domNode=De(t,Ve(`.monaco-table.${this.domId}`));const a=n.map((u,d)=>this.disposables.add(new mAe(u,d))),l={size:a.reduce((u,d)=>u+d.column.weight,0),views:a.map(u=>({size:u.column.weight,view:u}))};this.splitview=this.disposables.add(new fAe(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new hE(n,r,u=>this.splitview.getViewSize(u));this.list=this.disposables.add(new il(e,this.domNode,gAe(i),[c],o)),ge.any(...a.map(u=>u.onDidLayout))(([u,d])=>c.layoutColumn(u,d),null,this.disposables),this.splitview.onDidSashReset(u=>{const d=n.reduce((p,_)=>p+_.weight,0),g=n[u].weight/d*this.cachedWidth;this.splitview.resizeView(u,g)},null,this.disposables),this.styleElement=Qa(this.domNode),this.style(dIe)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}};m2.InstanceCount=0;let qO=m2;class m9{constructor(e,t={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new PRe(e,null,t),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,t.sorter&&(this.sorter={compare(i,n){return t.sorter.compare(i.element,n.element)}}),this.identityProvider=t.identityProvider}setChildren(e,t=_t.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=_t.empty(),i){const n=new Set,r=new Set,o=l=>{var u;if(l.element===null)return;const c=l;if(n.add(c.element),this.nodes.set(c.element,c),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();r.add(d),this.nodesByIdentity.set(d,c)}(u=i.onDidCreateNode)==null||u.call(i,c)},a=l=>{var u;if(l.element===null)return;const c=l;if(n.has(c.element)||this.nodes.delete(c.element),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();r.has(d)||this.nodesByIdentity.delete(d)}(u=i.onDidDeleteNode)==null||u.call(i,c)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:o,onDidDeleteNode:a})}preserveCollapseState(e=_t.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),_t.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const o=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(o)}if(!i){let o;return typeof t.collapsed>"u"?o=void 0:t.collapsed===$r.Collapsed||t.collapsed===$r.PreserveOrCollapsed?o=!0:t.collapsed===$r.Expanded||t.collapsed===$r.PreserveOrExpanded?o=!1:o=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:o}}const n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let r;return typeof t.collapsed>"u"||t.collapsed===$r.PreserveOrCollapsed||t.collapsed===$r.PreserveOrExpanded?r=i.collapsed:t.collapsed===$r.Collapsed?r=!0:t.collapsed===$r.Expanded?r=!1:r=!!t.collapsed,{...t,collapsible:n,collapsed:r,children:this.preserveCollapseState(t.children)}})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}resort(e=null,t=!0){if(!this.sorter)return;const i=this.getElementLocation(e),n=this.model.getNode(i);this._setChildren(i,this.resortChildren(n,t),{})}resortChildren(e,t,i=!0){let n=[...e.children];return(t||i)&&(n=n.sort(this.sorter.compare.bind(this.sorter))),_t.map(n,r=>({element:r.element,collapsible:r.collapsible,collapsed:r.collapsed,children:this.resortChildren(r,t,!1)}))}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new Zr(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new Zr(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new Zr(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new Zr(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function tL(s){const e=[s.element],t=s.incompressible||!1;return{element:{elements:e,incompressible:t},children:_t.map(_t.from(s.children),tL),collapsible:s.collapsible,collapsed:s.collapsed}}function iL(s){const e=[s.element],t=s.incompressible||!1;let i,n;for(;[n,i]=_t.consume(_t.from(s.children),2),!(n.length!==1||n[0].incompressible);)s=n[0],e.push(s.element);return{element:{elements:e,incompressible:t},children:_t.map(_t.concat(n,i),iL),collapsible:s.collapsible,collapsed:s.collapsed}}function GO(s,e=0){let t;return e<s.element.elements.length-1?t=[GO(s,e+1)]:t=_t.map(_t.from(s.children),i=>GO(i,0)),e===0&&s.element.incompressible?{element:s.element.elements[e],children:t,incompressible:!0,collapsible:s.collapsible,collapsed:s.collapsed}:{element:s.element.elements[e],children:t,collapsible:s.collapsible,collapsed:s.collapsed}}function lq(s){return GO(s,0)}function ite(s,e,t){return s.element===e?{...s,children:t}:{...s,children:_t.map(_t.from(s.children),i=>ite(i,e,t))}}const pAe=s=>({getId(e){return e.elements.map(t=>s.getId(t).toString()).join("\0")}});class _Ae{get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new m9(e,t),this.enabled=typeof t.compressionEnabled>"u"?!0:t.compressionEnabled,this.identityProvider=t.identityProvider}setChildren(e,t=_t.empty(),i){const n=i.diffIdentityProvider&&pAe(i.diffIdentityProvider);if(e===null){const _=_t.map(t,this.enabled?iL:tL);this._setChildren(null,_,{diffIdentityProvider:n,diffDepth:1/0});return}const r=this.nodes.get(e);if(!r)throw new Zr(this.user,"Unknown compressed tree node");const o=this.model.getNode(r),a=this.model.getParentNodeLocation(r),l=this.model.getNode(a),c=lq(o),u=ite(c,e,t),d=(this.enabled?iL:tL)(u),g=i.diffIdentityProvider?((_,C)=>i.diffIdentityProvider.getId(_)===i.diffIdentityProvider.getId(C)):void 0;if(sn(d.element.elements,o.element.elements,g)){this._setChildren(r,d.children||_t.empty(),{diffIdentityProvider:n,diffDepth:1});return}const p=l.children.map(_=>_===o?d:_);this._setChildren(l.element,p,{diffIdentityProvider:n,diffDepth:o.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,n=_t.map(i,lq),r=_t.map(n,e?iL:tL);this._setChildren(null,r,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const n=new Set,r=a=>{for(const l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},o=a=>{for(const l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:r,onDidDeleteNode:o})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}resort(e=null,t=!0){const i=this.getCompressedNode(e);this.model.resort(i,t)}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new Zr(this.user,`Tree element not found: ${e}`);return t}}const bAe=s=>s[s.length-1];class p9{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new p9(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function CAe(s,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(s(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){const n=t.elements;for(let r=0;r<n.length-1;r++){const o=e.filter.filter(n[r],i);i=Yg(iy(o)?o.visibility:o)}return e.filter.filter(n[n.length-1],i)}}}}class wAe{get onDidSpliceModel(){return ge.map(this.model.onDidSpliceModel,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidSpliceRenderedNodes(){return ge.map(this.model.onDidSpliceRenderedNodes,({start:e,deleteCount:t,elements:i})=>({start:e,deleteCount:t,elements:i.map(n=>this.nodeMapper.map(n))}))}get onDidChangeCollapseState(){return ge.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return ge.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t={}){this.rootRef=null,this.elementMapper=t.elementMapper||bAe;const i=n=>this.elementMapper(n.elements);this.nodeMapper=new u9(n=>new p9(i,n)),this.model=new _Ae(e,CAe(i,t))}setChildren(e,t=_t.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}resort(e=null,t=!0){return this.model.resort(e,t)}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var vAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class _9 extends ete{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,n,r={}){super(e,t,i,n,r),this.user=e}setChildren(e,t=_t.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}resort(e,t=!0){this.model.resort(e,t)}hasElement(e){return this.model.has(e)}createModel(e,t){return new m9(e,t)}}class nte{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t,i){this._compressedTreeNodeProvider=e,this.stickyScrollDelegate=t,this.renderer=i,this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let r=this.stickyScrollDelegate.getCompressedNode(e);r||(r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),r.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,i.data,n))}disposeElement(e,t,i,n){var r,o,a,l;i.compressedTreeNode?(o=(r=this.renderer).disposeCompressedElements)==null||o.call(r,i.compressedTreeNode,t,i.data,n):(l=(a=this.renderer).disposeElement)==null||l.call(a,e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){var i,n;return((n=(i=this.renderer).renderTwistie)==null?void 0:n.call(i,e,t))??!1}}vAe([Si],nte.prototype,"compressedTreeNodeProvider",null);class yAe{constructor(e){this.modelProvider=e,this.compressedStickyNodes=new Map}getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){const r=e[n],o=r.position+r.height;if(n+1<e.length&&o+e[n+1].height>i||n>=t-1&&t<e.length){const l=e.slice(0,n),c=e.slice(n),u=this.compressStickyNodes(c);return[...l,u]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");const t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];const i=[];for(let c=0;c<e.length;c++){const u=e[c],d=t.getCompressedTreeNode(u.node.element);if(d.element){if(c!==0&&d.element.incompressible)break;i.push(...d.element.elements)}}if(i.length<2)return e[0];const n=e[e.length-1],r={elements:i,incompressible:!1},o={...n.node,children:[],element:r},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,o),l}}function SAe(s,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=s().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}class ste extends _9{constructor(e,t,i,n,r={}){const o=()=>this,a=new yAe(()=>this.model),l=n.map(c=>new nte(o,a,c));super(e,t,i,l,{...SAe(o,r),stickyScrollDelegate:a})}setChildren(e,t=_t.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t){return new wAe(e,t)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}function rA(s){return{...s,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function KO(s,e){return e.parent?e.parent===s?!0:KO(s,e.parent):!1}function xAe(s,e){return s===e||KO(s,e)||KO(e,s)}class b9{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new b9(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class LAe{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...ht.asClassNameArray(xe.treeItemLoading)),!0):(t.classList.remove(...ht.asClassNameArray(xe.treeItemLoading)),!1)}disposeElement(e,t,i,n){var r,o;(o=(r=this.renderer).disposeElement)==null||o.call(r,this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function cq(s){return{browserEvent:s.browserEvent,elements:s.elements.map(e=>e.element)}}function hq(s){return{browserEvent:s.browserEvent,element:s.element&&s.element.element,target:s.target}}class kAe extends Xv{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function oA(s){return s instanceof Xv?new kAe(s):s}class EAe{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,oA(e),t)}onDragOver(e,t,i,n,r,o=!0){return this.dnd.onDragOver(oA(e),t&&t.element,i,n,r)}drop(e,t,i,n,r){this.dnd.drop(oA(e),t&&t.element,i,n,r)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.dnd.dispose()}}class DAe extends Xee{constructor(e,t,i){super(t,i),this.findProvider=e,this.isFindSessionActive=!1}filter(e,t){const i=super.filter(e,t);if(!this.isFindSessionActive||this.findMode===Jr.Highlight||!this.findProvider.isVisible)return i;const n=iy(i)?i.visibility:i;return Yg(n)===0?0:this.findProvider.isVisible(e)?i:0}}class TAe extends Zee{constructor(e,t,i,n,r){super(e,i,n,r),this.findProvider=t,this.filter=i,this.activeSession=!1,this.asyncWorkInProgress=!1,this.disposables.add(Fe(async()=>{var o,a;this.activeSession&&await((a=(o=this.findProvider).endSession)==null?void 0:a.call(o))}))}render(){if(this.asyncWorkInProgress||!this.activeFindMetadata)return;const e=this.activeFindMetadata.matchCount===0&&this.pattern.length>0;this.renderMessage(e),this.pattern.length&&this.alertResults(this.activeFindMetadata.matchCount)}shouldAllowFocus(e){return this.shouldFocusWhenNavigating(e)}shouldFocusWhenNavigating(e){var i;if(!this.activeSession||!this.activeFindMetadata)return!0;const t=(i=e.element)==null?void 0:i.element;return t&&this.activeFindMetadata.isMatch(t)?!0:!ug.isDefault(e.filterData)}}function rte(s){return s&&{...s,collapseByDefault:!0,identityProvider:s.identityProvider&&{getId(e){return s.identityProvider.getId(e.element)}},dnd:s.dnd&&new EAe(s.dnd),multipleSelectionController:s.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return s.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return s.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:s.accessibilityProvider&&{...s.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:s.accessibilityProvider.getRole?e=>s.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:s.accessibilityProvider.isChecked?e=>{var t;return!!((t=s.accessibilityProvider)!=null&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return s.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return s.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:s.accessibilityProvider.getWidgetRole?()=>s.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:s.accessibilityProvider.getAriaLevel&&(e=>s.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:s.accessibilityProvider.getActiveDescendantId&&(e=>s.accessibilityProvider.getActiveDescendantId(e.element))},filter:s.filter&&{filter(e,t){return s.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:s.keyboardNavigationLabelProvider&&{...s.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return s.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof s.expandOnlyOnTwistieClick>"u"?void 0:typeof s.expandOnlyOnTwistieClick!="function"?s.expandOnlyOnTwistieClick:(e=>s.expandOnlyOnTwistieClick(e.element)),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof s.defaultFindVisibility=="number"?s.defaultFindVisibility:typeof s.defaultFindVisibility>"u"?2:s.defaultFindVisibility(e.element),stickyScrollDelegate:s.stickyScrollDelegate}}function YO(s,e){e(s),s.children.forEach(t=>YO(t,e))}class ote{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return ge.map(this.tree.onDidChangeFocus,cq)}get onDidChangeSelection(){return ge.map(this.tree.onDidChangeSelection,cq)}get onMouseDblClick(){return ge.map(this.tree.onMouseDblClick,hq)}get onPointer(){return ge.map(this.tree.onPointer,hq)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,n,r,o={}){this.user=e,this.dataSource=r,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new $,this._onDidChangeNodeSlowState=new $,this.nodeMapper=new u9(c=>new b9(c)),this.disposables=new Ee,this.identityProvider=o.identityProvider,this.autoExpandSingleChildren=typeof o.autoExpandSingleChildren>"u"?!1:o.autoExpandSingleChildren,this.sorter=o.sorter,this.getDefaultCollapseState=c=>o.collapseByDefault?o.collapseByDefault(c)?$r.PreserveOrCollapsed:$r.PreserveOrExpanded:void 0;let a=!1,l;if(o.findProvider&&(o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider&&(a=!0,l=new DAe(o.findProvider,o.keyboardNavigationLabelProvider,o.filter)),this.tree=this.createTree(e,t,i,n,{...o,findWidgetEnabled:!a,filter:l??o.filter}),this.root=rA({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables),a){const c={styles:o.findWidgetStyles,showNotFoundMessage:o.showNotFoundMessage,defaultFindMatchType:o.defaultFindMatchType,defaultFindMode:o.defaultFindMode};this.findController=this.disposables.add(new TAe(this.tree,o.findProvider,l,this.tree.options.contextViewProvider,c)),this.focusNavigationFilter=u=>this.findController.shouldFocusWhenNavigating(u),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindOpenState=this.tree.onDidChangeFindOpenState,this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType}createTree(e,t,i,n,r){const o=new d9(i),a=n.map(c=>new LAe(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=rte(r)||{};return new _9(e,t,o,a,l)}updateOptions(e={}){this.findController&&(e.defaultFindMode!==void 0&&(this.findController.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.findController.matchType=e.defaultFindMatchType)),this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.cancelAllRefreshPromises(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}cancelAllRefreshPromises(e=!1){this.refreshPromises.forEach(t=>t.cancel()),this.refreshPromises.clear(),e&&(this.subTreeRefreshPromises.forEach(t=>t.cancel()),this.subTreeRefreshPromises.clear())}async _updateChildren(e=this.root.element,t=!0,i=!1,n,r){if(typeof this.root.element>"u")throw new Zr(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await ge.toPromise(this._onDidRender.event));const o=this.getDataNode(e);if(await this.refreshAndRenderNode(o,t,n,r),i)try{this.tree.rerender(o)}catch{}}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new Zr(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await ge.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await i.refreshPromise,await ge.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await i.refreshPromise,await ge.toPromise(this._onDidRender.event)),n}setSelection(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){var i;const t=this.nodes.get(e===this.root.element?null:e);if(!t){const n=(i=this.identityProvider)==null?void 0:i.getId(e).toString();throw new Zr(this.user,`Data tree node not found${n?`: ${n}`:""}`)}return t}async refreshAndRenderNode(e,t,i,n){this.disposables.isDisposed||(await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n))}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((r,o)=>{!n&&xAe(o,e)&&(n=r.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){const n=o4(async()=>{const r=await this.doRefreshNode(e,t,i);e.stale=!1,await pw.settled(r.map(o=>this.doRefreshSubTree(o,t,i)))});return e.refreshPromise=n,this.subTreeRefreshPromises.set(e,n),n.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)}),n}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(_t.empty());else{const r=this.doGetChildren(e);if(qA(r))n=Promise.resolve(r);else{const o=c1(800);o.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=r.finally(()=>o.cancel())}}try{const r=await n;return this.setChildren(e,r,t,i)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),kv(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return qA(i)?this.processChildren(i):(t=o4(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(It))}setChildren(e,t,i,n){const r=[...t];if(e.children.length===0&&r.length===0)return[];const o=new Map,a=new Map;for(const u of e.children)o.set(u.element,u),this.identityProvider&&a.set(u.id,{node:u,collapsed:this.tree.hasElement(u)&&this.tree.isCollapsed(u)});const l=[],c=r.map(u=>{const d=!!this.dataSource.hasChildren(u);if(!this.identityProvider){const C=rA({element:u,parent:e,hasChildren:d,defaultCollapseState:this.getDefaultCollapseState(u)});return d&&C.defaultCollapseState===$r.PreserveOrExpanded&&l.push(C),C}const g=this.identityProvider.getId(u).toString(),p=a.get(g);if(p){const C=p.node;return o.delete(C.element),this.nodes.delete(C.element),this.nodes.set(u,C),C.element=u,C.hasChildren=d,i?p.collapsed?(C.children.forEach(v=>YO(v,x=>this.nodes.delete(x.element))),C.children.splice(0,C.children.length),C.stale=!0):l.push(C):d&&!p.collapsed&&l.push(C),C}const _=rA({element:u,parent:e,id:g,hasChildren:d,defaultCollapseState:this.getDefaultCollapseState(u)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(g)>-1&&n.focus.push(_),n&&n.viewState.selection&&n.viewState.selection.indexOf(g)>-1&&n.selection.push(_),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(g)>-1||d&&_.defaultCollapseState===$r.PreserveOrExpanded)&&l.push(_),_});for(const u of o.values())YO(u,d=>this.nodes.delete(d.element));for(const u of c)this.nodes.set(u.element,u);return BL(e.children,0,e.children.length,c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].forceExpanded=!0,l.push(c[0])),l}render(e,t,i){const n=e.children.map(o=>this.asTreeElement(o,t)),r=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(o){return i.diffIdentityProvider.getId(o.element)}}};this.tree.setChildren(e===this.root?null:e,n,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?_t.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class C9{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new C9(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class NAe{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...ht.asClassNameArray(xe.treeItemLoading)),!0):(t.classList.remove(...ht.asClassNameArray(xe.treeItemLoading)),!1)}disposeElement(e,t,i,n){var r,o;(o=(r=this.renderer).disposeElement)==null||o.call(r,this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){var r,o;(o=(r=this.renderer).disposeCompressedElements)==null||o.call(r,this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=Zi(this.disposables)}}function IAe(s){const e=s&&rte(s);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return s.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}},stickyScrollDelegate:e.stickyScrollDelegate}}class RAe extends ote{constructor(e,t,i,n,r,o,a={}){super(e,t,i,r,o,a),this.compressionDelegate=n,this.compressibleNodeMapper=new u9(l=>new C9(l)),this.filter=a.filter}createTree(e,t,i,n,r){const o=new d9(i),a=n.map(c=>new NAe(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=IAe(r)||{};return new ste(e,t,o,a,l)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const n=p=>this.identityProvider.getId(p).toString(),r=p=>{const _=new Set;for(const C of p){const v=this.tree.getCompressedTreeNode(C===this.root?null:C);if(v.element)for(const x of v.element.elements)_.add(n(x.element))}return _},o=r(this.tree.getSelection()),a=r(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let c=!1;const u=this.getFocus();let d=!1;const g=p=>{const _=p.element;if(_)for(let C=0;C<_.elements.length;C++){const v=n(_.elements[C].element),x=_.elements[_.elements.length-1].element;o.has(v)&&l.indexOf(x)===-1&&(l.push(x),c=!0),a.has(v)&&u.indexOf(x)===-1&&(u.push(x),d=!0)}p.children.forEach(g)};g(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(l),d&&this.setFocus(u)}processChildren(e){return this.filter&&(e=_t.filter(e,t=>{const i=this.filter.filter(t,1),n=AAe(i);if(n===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return n===1})),super.processChildren(e)}}function AAe(s){return typeof s=="boolean"?s?1:0:iy(s)?Yg(s.visibility):Yg(s)}class MAe extends ete{constructor(e,t,i,n,r,o={}){super(e,t,i,n,o),this.user=e,this.dataSource=r,this.identityProvider=o.identityProvider}createModel(e,t){return new m9(e,t)}}new Ne("isMac",rt,w(1684,"Whether the operating system is macOS"));new Ne("isLinux",kr,w(1685,"Whether the operating system is Linux"));new Ne("isWindows",cr,w(1686,"Whether the operating system is Windows"));new Ne("isWeb",Fh,w(1687,"Whether the platform is a web browser"));new Ne("isMacNative",rt&&!Fh,w(1688,"Whether the operating system is macOS on a non-browser platform"));new Ne("isIOS",Gl,w(1689,"Whether the operating system is iOS"));new Ne("isMobile",rQ,w(1690,"Whether the platform is a mobile web browser"));new Ne("isDevelopment",!1,!0);new Ne("productQualityType","",w(1691,"Quality type of VS Code"));const ate="inputFocus",lte=new Ne(ate,!1,w(1692,"Whether keyboard focus is inside an input box"));var Uh=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Jt=function(s,e){return function(t,i){e(t,i,s)}};const ac=tt("listService");class OAe{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new Ee,this.lists=[],this._lastFocusedWidget=void 0}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&((t=this._lastFocusedWidget)==null||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,(i=this._lastFocusedWidget)==null||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this.lists.some(n=>n.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),H7(e.getHTMLElement())&&this.setLastFocusedList(e),Bl(e.onDidFocus(()=>this.setLastFocusedList(e)),Fe(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(n=>n!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const rv=new Ne("listScrollAtBoundary","none");ft.or(rv.isEqualTo("top"),rv.isEqualTo("both"));ft.or(rv.isEqualTo("bottom"),rv.isEqualTo("both"));const cte=new Ne("listFocus",!0),hte=new Ne("treestickyScrollFocused",!1),jD=new Ne("listSupportsMultiselect",!0);ft.and(cte,ft.not(ate),hte.negate());const w9=new Ne("listHasSelectionOrFocus",!1),v9=new Ne("listDoubleSelection",!1),y9=new Ne("listMultiSelection",!1),$D=new Ne("listSelectionNavigation",!1),PAe=new Ne("listSupportsFind",!0),FAe=new Ne("treeElementCanCollapse",!1),BAe=new Ne("treeElementHasParent",!1),VAe=new Ne("treeElementCanExpand",!1),WAe=new Ne("treeElementHasChild",!1),HAe=new Ne("treeFindOpen",!1),ute="listTypeNavigationMode",dte="listAutomaticKeyboardNavigation";function qD(s,e){const t=s.createScoped(e.getHTMLElement());return cte.bindTo(t),t}function GD(s,e){const t=rv.bindTo(s),i=()=>{const n=e.scrollTop===0,r=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&r?t.set("both"):n?t.set("top"):r?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const Cm="workbench.list.multiSelectModifier",nL="workbench.list.openMode",Wo="workbench.list.horizontalScrolling",S9="workbench.list.defaultFindMode",x9="workbench.list.typeNavigationMode",uE="workbench.list.keyboardNavigation",Ja="workbench.list.scrollByPage",L9="workbench.list.defaultFindMatchType",ov="workbench.tree.indent",dE="workbench.tree.renderIndentGuides",el="workbench.list.smoothScrolling",ec="workbench.list.mouseWheelScrollSensitivity",tc="workbench.list.fastScrollSensitivity",fE="workbench.tree.expandMode",gE="workbench.tree.enableStickyScroll",mE="workbench.tree.stickyScrollMaxItemCount";function ic(s){return s.getValue(Cm)==="alt"}class zAe extends ne{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=ic(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Cm)&&(this.useAltAsMultipleSelectionModifier=ic(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:Aee(e)}isSelectionRangeChangeEvent(e){return Mee(e)}}function KD(s,e){const t=s.get(ai),i=s.get(Bn),n=new Ee;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(o){return i.mightProducePrintableCharacter(o)}},smoothScrolling:!!t.getValue(el),mouseWheelScrollSensitivity:t.getValue(ec),fastScrollSensitivity:t.getValue(tc),multipleSelectionController:e.multipleSelectionController??n.add(new zAe(t)),keyboardNavigationEventFilter:$Ae(i),scrollByPage:!!t.getValue(Ja)},n]}let uq=class extends il{constructor(e,t,i,n,r,o,a,l,c){const u=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Wo),[d,g]=c.invokeFunction(KD,r);super(e,t,i,n,{keyboardSupport:!1,...d,horizontalScrolling:u}),this.disposables.add(g),this.contextKeyService=qD(o,this),this.disposables.add(GD(this.contextKeyService,this)),this.listSupportsMultiSelect=jD.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),$D.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=w9.bindTo(this.contextKeyService),this.listDoubleSelection=v9.bindTo(this.contextKeyService),this.listMultiSelection=y9.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=ic(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const _=this.getSelection(),C=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(_.length>0||C.length>0),this.listMultiSelection.set(_.length>1),this.listDoubleSelection.set(_.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const _=this.getSelection(),C=this.getFocus();this.listHasSelectionOrFocus.set(_.length>0||C.length>0)})),this.disposables.add(l.onDidChangeConfiguration(_=>{_.affectsConfiguration(Cm)&&(this._useAltAsMultipleSelectionModifier=ic(l));let C={};if(_.affectsConfiguration(Wo)&&this.horizontalScrolling===void 0){const v=!!l.getValue(Wo);C={...C,horizontalScrolling:v}}if(_.affectsConfiguration(Ja)){const v=!!l.getValue(Ja);C={...C,scrollByPage:v}}if(_.affectsConfiguration(el)){const v=!!l.getValue(el);C={...C,smoothScrolling:v}}if(_.affectsConfiguration(ec)){const v=l.getValue(ec);C={...C,mouseWheelScrollSensitivity:v}}if(_.affectsConfiguration(tc)){const v=l.getValue(tc);C={...C,fastScrollSensitivity:v}}Object.keys(C).length>0&&this.updateOptions(C)})),this.navigator=new fte(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?ey(e):Jv)}};uq=Uh([Jt(5,St),Jt(6,ac),Jt(7,ai),Jt(8,wt)],uq);let dq=class extends sAe{constructor(e,t,i,n,r,o,a,l,c){const u=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Wo),[d,g]=c.invokeFunction(KD,r);super(e,t,i,n,{keyboardSupport:!1,...d,horizontalScrolling:u}),this.disposables=new Ee,this.disposables.add(g),this.contextKeyService=qD(o,this),this.disposables.add(GD(this.contextKeyService,this.widget)),this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=jD.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),$D.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this._useAltAsMultipleSelectionModifier=ic(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(_=>{_.affectsConfiguration(Cm)&&(this._useAltAsMultipleSelectionModifier=ic(l));let C={};if(_.affectsConfiguration(Wo)&&this.horizontalScrolling===void 0){const v=!!l.getValue(Wo);C={...C,horizontalScrolling:v}}if(_.affectsConfiguration(Ja)){const v=!!l.getValue(Ja);C={...C,scrollByPage:v}}if(_.affectsConfiguration(el)){const v=!!l.getValue(el);C={...C,smoothScrolling:v}}if(_.affectsConfiguration(ec)){const v=l.getValue(ec);C={...C,mouseWheelScrollSensitivity:v}}if(_.affectsConfiguration(tc)){const v=l.getValue(tc);C={...C,fastScrollSensitivity:v}}Object.keys(C).length>0&&this.updateOptions(C)})),this.navigator=new fte(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?ey(e):Jv)}dispose(){this.disposables.dispose(),super.dispose()}};dq=Uh([Jt(5,St),Jt(6,ac),Jt(7,ai),Jt(8,wt)],dq);let fq=class extends qO{constructor(e,t,i,n,r,o,a,l,c,u){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!c.getValue(Wo),[g,p]=u.invokeFunction(KD,o);super(e,t,i,n,r,{keyboardSupport:!1,...g,horizontalScrolling:d}),this.disposables.add(p),this.contextKeyService=qD(a,this),this.disposables.add(GD(this.contextKeyService,this)),this.listSupportsMultiSelect=jD.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),$D.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=w9.bindTo(this.contextKeyService),this.listDoubleSelection=v9.bindTo(this.contextKeyService),this.listMultiSelection=y9.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=ic(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const C=this.getSelection(),v=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(C.length>0||v.length>0),this.listMultiSelection.set(C.length>1),this.listDoubleSelection.set(C.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const C=this.getSelection(),v=this.getFocus();this.listHasSelectionOrFocus.set(C.length>0||v.length>0)})),this.disposables.add(c.onDidChangeConfiguration(C=>{C.affectsConfiguration(Cm)&&(this._useAltAsMultipleSelectionModifier=ic(c));let v={};if(C.affectsConfiguration(Wo)&&this.horizontalScrolling===void 0){const x=!!c.getValue(Wo);v={...v,horizontalScrolling:x}}if(C.affectsConfiguration(Ja)){const x=!!c.getValue(Ja);v={...v,scrollByPage:x}}if(C.affectsConfiguration(el)){const x=!!c.getValue(el);v={...v,smoothScrolling:x}}if(C.affectsConfiguration(ec)){const x=c.getValue(ec);v={...v,mouseWheelScrollSensitivity:x}}if(C.affectsConfiguration(tc)){const x=c.getValue(tc);v={...v,fastScrollSensitivity:x}}Object.keys(v).length>0&&this.updateOptions(v)})),this.navigator=new UAe(this,{configurationService:c,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?ey(e):Jv)}dispose(){this.disposables.dispose(),super.dispose()}};fq=Uh([Jt(6,St),Jt(7,ac),Jt(8,ai),Jt(9,wt)],fq);class k9 extends ne{constructor(e,t){super(),this.widget=e,this._onDidOpen=this._register(new $),this.onDidOpen=this._onDidOpen.event,this._register(ge.filter(this.widget.onDidChangeSelection,i=>ih(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(nL))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(nL)&&(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(nL))!=="doubleClick")}))):this.openOnSingleClick=(t==null?void 0:t.openOnSingleClick)??!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,n=typeof t.pinned=="boolean"?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const n=t.button===1,r=!0,o=n,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const r=!1,o=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}_open(e,t,i,n,r){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:r})}}class fte extends k9{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class UAe extends k9{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class jAe extends k9{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function $Ae(s){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=s.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let pE=class extends _9{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,r,o,a,l,c){const{options:u,getTypeNavigationMode:d,disposable:g}=o.invokeFunction(ny,r);super(e,t,i,n,u),this.disposables.add(g),this.internals=new Xg(this,r,d,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};pE=Uh([Jt(5,wt),Jt(6,St),Jt(7,ac),Jt(8,ai)],pE);let gq=class extends ste{constructor(e,t,i,n,r,o,a,l,c){const{options:u,getTypeNavigationMode:d,disposable:g}=o.invokeFunction(ny,r);super(e,t,i,n,u),this.disposables.add(g),this.internals=new Xg(this,r,d,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};gq=Uh([Jt(5,wt),Jt(6,St),Jt(7,ac),Jt(8,ai)],gq);let mq=class extends MAe{constructor(e,t,i,n,r,o,a,l,c,u){const{options:d,getTypeNavigationMode:g,disposable:p}=a.invokeFunction(ny,o);super(e,t,i,n,r,d),this.disposables.add(p),this.internals=new Xg(this,o,g,o.overrideStyles,l,c,u),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};mq=Uh([Jt(6,wt),Jt(7,St),Jt(8,ac),Jt(9,ai)],mq);let pq=class extends ote{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,r,o,a,l,c,u){const{options:d,getTypeNavigationMode:g,disposable:p}=a.invokeFunction(ny,o);super(e,t,i,n,r,d),this.disposables.add(p),this.internals=new Xg(this,o,g,o.overrideStyles,l,c,u),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};pq=Uh([Jt(6,wt),Jt(7,St),Jt(8,ac),Jt(9,ai)],pq);let _q=class extends RAe{constructor(e,t,i,n,r,o,a,l,c,u,d){const{options:g,getTypeNavigationMode:p,disposable:_}=l.invokeFunction(ny,a);super(e,t,i,n,r,o,g),this.disposables.add(_),this.internals=new Xg(this,a,p,a.overrideStyles,c,u,d),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};_q=Uh([Jt(7,wt),Jt(8,St),Jt(9,ac),Jt(10,ai)],_q);function gte(s){const e=s.getValue(S9);if(e==="highlight")return Jr.Highlight;if(e==="filter")return Jr.Filter;const t=s.getValue(uE);if(t==="simple"||t==="highlight")return Jr.Highlight;if(t==="filter")return Jr.Filter}function mte(s){const e=s.getValue(L9);if(e==="fuzzy")return Wa.Fuzzy;if(e==="contiguous")return Wa.Contiguous}function ny(s,e){const t=s.get(ai),i=s.get(Gv),n=s.get(St),r=s.get(wt),o=()=>{const g=n.getContextKeyValue(ute);if(g==="automatic")return Rl.Automatic;if(g==="trigger"||n.getContextKeyValue(dte)===!1)return Rl.Trigger;const _=t.getValue(x9);if(_==="automatic")return Rl.Automatic;if(_==="trigger")return Rl.Trigger},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(Wo),[l,c]=r.invokeFunction(KD,e),u=e.paddingBottom,d=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(dE);return{getTypeNavigationMode:o,disposable:c,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(ov)=="number"?t.getValue(ov):void 0,renderIndentGuides:d,smoothScrolling:!!t.getValue(el),defaultFindMode:e.defaultFindMode??gte(t),defaultFindMatchType:e.defaultFindMatchType??mte(t),horizontalScrolling:a,scrollByPage:!!t.getValue(Ja),paddingBottom:u,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(fE)==="doubleClick",contextViewProvider:i,findWidgetStyles:NIe,enableStickyScroll:!!t.getValue(gE),stickyScrollMaxItemCount:Number(t.getValue(mE))}}}let Xg=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,r,o,a){this.tree=e,this.disposables=[],this.contextKeyService=qD(r,e),this.disposables.push(GD(this.contextKeyService,e)),this.listSupportsMultiSelect=jD.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),$D.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=PAe.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=w9.bindTo(this.contextKeyService),this.hasDoubleSelection=v9.bindTo(this.contextKeyService),this.hasMultiSelection=y9.bindTo(this.contextKeyService),this.treeElementCanCollapse=FAe.bindTo(this.contextKeyService),this.treeElementHasParent=BAe.bindTo(this.contextKeyService),this.treeElementCanExpand=VAe.bindTo(this.contextKeyService),this.treeElementHasChild=WAe.bindTo(this.contextKeyService),this.treeFindOpen=HAe.bindTo(this.contextKeyService),this.treeStickyScrollFocused=hte.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=ic(a),this.updateStyleOverrides(n);const c=()=>{const d=e.getFocus()[0];if(!d)return;const g=e.getNode(d);this.treeElementCanCollapse.set(g.collapsible&&!g.collapsed),this.treeElementHasParent.set(!!e.getParentElement(d)),this.treeElementCanExpand.set(g.collapsible&&g.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(d))},u=new Set;u.add(ute),u.add(dte),this.disposables.push(this.contextKeyService,o.register(e),e.onDidChangeSelection(()=>{const d=e.getSelection(),g=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(d.length>0||g.length>0),this.hasMultiSelection.set(d.length>1),this.hasDoubleSelection.set(d.length===2)})}),e.onDidChangeFocus(()=>{const d=e.getSelection(),g=e.getFocus();this.hasSelectionOrFocus.set(d.length>0||g.length>0),c()}),e.onDidChangeCollapseState(c),e.onDidChangeModel(c),e.onDidChangeFindOpenState(d=>this.treeFindOpen.set(d)),e.onDidChangeStickyScrollFocused(d=>this.treeStickyScrollFocused.set(d)),a.onDidChangeConfiguration(d=>{let g={};if(d.affectsConfiguration(Cm)&&(this._useAltAsMultipleSelectionModifier=ic(a)),d.affectsConfiguration(ov)){const p=a.getValue(ov);g={...g,indent:p}}if(d.affectsConfiguration(dE)&&t.renderIndentGuides===void 0){const p=a.getValue(dE);g={...g,renderIndentGuides:p}}if(d.affectsConfiguration(el)){const p=!!a.getValue(el);g={...g,smoothScrolling:p}}if(d.affectsConfiguration(S9)||d.affectsConfiguration(uE)){const p=gte(a);g={...g,defaultFindMode:p}}if(d.affectsConfiguration(x9)||d.affectsConfiguration(uE)){const p=i();g={...g,typeNavigationMode:p}}if(d.affectsConfiguration(L9)){const p=mte(a);g={...g,defaultFindMatchType:p}}if(d.affectsConfiguration(Wo)&&t.horizontalScrolling===void 0){const p=!!a.getValue(Wo);g={...g,horizontalScrolling:p}}if(d.affectsConfiguration(Ja)){const p=!!a.getValue(Ja);g={...g,scrollByPage:p}}if(d.affectsConfiguration(fE)&&t.expandOnlyOnTwistieClick===void 0&&(g={...g,expandOnlyOnTwistieClick:a.getValue(fE)==="doubleClick"}),d.affectsConfiguration(gE)){const p=a.getValue(gE);g={...g,enableStickyScroll:p}}if(d.affectsConfiguration(mE)){const p=Math.max(1,a.getValue(mE));g={...g,stickyScrollMaxItemCount:p}}if(d.affectsConfiguration(ec)){const p=a.getValue(ec);g={...g,mouseWheelScrollSensitivity:p}}if(d.affectsConfiguration(tc)){const p=a.getValue(tc);g={...g,fastScrollSensitivity:p}}Object.keys(g).length>0&&e.updateOptions(g)}),this.contextKeyService.onDidChangeContext(d=>{d.affectsSome(u)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new jAe(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?ey(e):Jv)}dispose(){this.disposables=Zi(this.disposables)}};Xg=Uh([Jt(4,St),Jt(5,ac),Jt(6,ai)],Xg);const qAe=Fn.as(hm.Configuration);qAe.registerConfiguration({id:"workbench",order:7,title:w(1705,"Workbench"),type:"object",properties:{[Cm]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[w(1706,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),w(1707,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:w(1708,"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[nL]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:w(1709,"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Wo]:{type:"boolean",default:!1,description:w(1710,"Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Ja]:{type:"boolean",default:!1,description:w(1711,"Controls whether clicks in the scrollbar scroll page by page.")},[ov]:{type:"number",default:8,minimum:4,maximum:40,description:w(1712,"Controls tree indentation in pixels.")},[dE]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:w(1713,"Controls whether the tree should render indent guides.")},[el]:{type:"boolean",default:!1,description:w(1714,"Controls whether lists and trees have smooth scrolling.")},[ec]:{type:"number",default:1,markdownDescription:w(1715,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[tc]:{type:"number",default:5,markdownDescription:w(1716,"Scrolling speed multiplier when pressing `Alt`.")},[S9]:{type:"string",enum:["highlight","filter"],enumDescriptions:[w(1717,"Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),w(1718,"Filter elements when searching.")],default:"highlight",description:w(1719,"Controls the default find mode for lists and trees in the workbench.")},[uE]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[w(1720,"Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),w(1721,"Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),w(1722,"Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:w(1723,"Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:w(1724,"Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[L9]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[w(1725,"Use fuzzy matching when searching."),w(1726,"Use contiguous matching when searching.")],default:"fuzzy",description:w(1727,"Controls the type of matching used when searching lists and trees in the workbench.")},[fE]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:w(1728,"Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[gE]:{type:"boolean",default:!0,description:w(1729,"Controls whether sticky scrolling is enabled in trees.")},[mE]:{type:"number",minimum:1,default:7,markdownDescription:w(1730,"Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[x9]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:w(1731,"Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var YD=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},QO=function(s,e){return function(t,i){e(t,i,s)}},XO;const bl=Ve;class pte{constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new Ws(()=>{const n=i.label??"",r=Yf(n).text.trim(),o=i.ariaLabel||[n,this.saneDescription,this.saneDetail].map(a=>ZJ(a)).filter(a=>!!a).join(", ");return{saneLabel:n,saneSortLabel:r,saneAriaLabel:o}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class $n extends pte{constructor(e,t,i,n,r,o,a){var l,c,u;super(e,i,o),this.childIndex=t,this.fireButtonTriggered=n,this._onChecked=r,this.item=o,this._separator=a,this._checked=!1,this.onChecked=i?ge.map(ge.filter(this._onChecked.event,d=>d.element===this),d=>d.checked):ge.None,this._saneDetail=o.detail,this._labelHighlights=(l=o.highlights)==null?void 0:l.label,this._descriptionHighlights=(c=o.highlights)==null?void 0:c.description,this._detailHighlights=(u=o.highlights)==null?void 0:u.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var El;(function(s){s[s.NONE=0]="NONE",s[s.MOUSE_HOVER=1]="MOUSE_HOVER",s[s.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(El||(El={}));class uf extends pte{constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=El.NONE}}class GAe{getHeight(e){return e instanceof uf?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof $n?_E.ID:bE.ID}}class KAe{getWidgetAriaLabel(){return w(1770,"Quick Input")}getAriaLabel(e){var t;return(t=e.separator)!=null&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof $n)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class _te{constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new Ee,t.toDisposeTemplate=new Ee,t.entry=De(e,bl(".quick-input-list-entry"));const i=De(t.entry,bl("label.quick-input-list-label"));t.outerLabel=i,t.checkbox=t.toDisposeTemplate.add(new kn),t.toDisposeTemplate.add(Xn(i,pe.CLICK,c=>{if(t.checkbox.value&&!c.defaultPrevented&&t.checkbox.value.enabled){const u=!t.checkbox.value.checked;t.checkbox.value.checked=u,t.element.checked=u}}));const n=De(i,bl(".quick-input-list-rows")),r=De(n,bl(".quick-input-list-row")),o=De(n,bl(".quick-input-list-row"));t.label=new jO(r,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=rD(t.label.element,bl(".quick-input-list-icon"));const a=De(r,bl(".quick-input-list-entry-keybinding"));t.keybinding=new h9(a,ca),t.toDisposeTemplate.add(t.keybinding);const l=De(o,bl(".quick-input-list-label-meta"));return t.detail=new jO(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=De(t.entry,bl(".quick-input-list-separator")),t.actionBar=new zl(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}var Cg;let _E=(Cg=class extends _te{constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return XO.ID}ensureCheckbox(e,t){var n;if(!e.hasCheckbox){(n=t.checkbox.value)==null||n.domNode.remove(),t.checkbox.clear();return}let i=t.checkbox.value;i?i.setTitle(e.saneLabel):(i=new $ee(e.saneLabel,e.checked,{...l9,size:15}),t.checkbox.value=i,t.outerLabel.prepend(i.domNode)),e.checkboxDisabled?i.disable():i.enable(),i.checked=e.checked,t.toDisposeElement.add(e.onChecked(r=>i.checked=r)),t.toDisposeElement.add(i.onChange(()=>e.checked=i.checked))}renderElement(e,t,i){var g;const n=e.element;i.element=n,n.element=i.entry??void 0;const r=n.item;n.element.classList.toggle("not-pickable",n.item.pickable===!1),this.ensureCheckbox(n,i);const{labelHighlights:o,descriptionHighlights:a,detailHighlights:l}=n;if(r.iconPath){const p=gm(this.themeService.getColorTheme().type)?r.iconPath.dark:r.iconPath.light??r.iconPath.dark,_=nt.revive(p);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=Jl(_)}else i.icon.style.backgroundImage="",i.icon.className=r.iconClass?`quick-input-list-icon ${r.iconClass}`:"";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:ua(n.saneDescription),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const u={matches:o||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(u.extraClasses=r.iconClasses,u.italic=r.italic,u.strikethrough=r.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,u),i.keybinding.set(r.keybinding),n.saneDetail){let p;n.saneTooltip||(p={markdown:{value:ua(n.saneDetail),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:p,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";(g=n.separator)!=null&&g.label?(i.separator.textContent=n.separator.label,i.separator.style.display="",this.addItemWithSeparator(n)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!n.separator&&n.childIndex!==0);const d=r.buttons;d&&d.length?(i.actionBar.push(d.map((p,_)=>W_(p,`id-${_}`,()=>n.fireButtonTriggered({button:p,item:n.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}},XO=Cg,Cg.ID="quickpickitem",Cg);_E=XO=YD([QO(1,Ir)],_E);const p2=class p2 extends _te{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return p2.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const r=n.separator,{labelHighlights:o,descriptionHighlights:a}=n;i.icon.style.backgroundImage="",i.icon.className="";let l;!n.saneTooltip&&n.saneDescription&&(l={markdown:{value:ua(n.saneDescription),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const c={matches:o||[],descriptionTitle:l,descriptionMatches:a||[],labelEscapeNewLines:!0};i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,c),i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const u=r.buttons;u&&u.length?(i.actionBar.push(u.map((d,g)=>W_(d,`id-${g}`,()=>n.fireSeparatorButtonTriggered({button:d,separator:n.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(e,t,i){var n;this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||(n=e.element.element)==null||n.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}};p2.ID="quickpickseparator";let bE=p2,av=class extends ne{constructor(e,t,i,n,r,o){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=o,this._onKeyDown=new $,this._onLeave=new $,this.onLeave=this._onLeave.event,this._visibleCountObservable=Qe("VisibleCount",0),this.onChangedVisibleCount=ge.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=Qe("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=ge.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=Qe("CheckedCount",0),this.onChangedCheckedCount=ge.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=nC({equalsFn:sn},new Array),this.onChangedCheckedElements=ge.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new $,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new $,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new $,this._elementCheckedEventBufferer=new Dv,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new Ee),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=De(this.parent,bl(".quick-input-list")),this._separatorRenderer=new bE(t),this._itemRenderer=r.createInstance(_E,t),this._tree=this._register(r.createInstance(pE,"QuickInput",this._container,new GAe,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof uf?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return QAe(a,l,c)}},accessibilityProvider:new KAe,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:Qg.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=n,this._registerListeners()}get onDidChangeFocus(){return ge.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof $n).map(t=>t.item),this._store)}get onDidChangeSelection(){return ge.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof $n).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new jt(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(J(this._container,pe.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(J(this._container,pe.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new FQ(typeof this.hoverDelegate.delay=="function"?this.hoverDelegate.delay():this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{var i;if(ZH(t.browserEvent.target)){e.cancel();return}if(!(!ZH(t.browserEvent.relatedTarget)&&xn(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)))try{await e.trigger(async()=>{t.element instanceof $n&&this.showHover(t.element)})}catch(n){if(!kv(n))throw n}})),this._register(this._tree.onMouseOut(t=>{var i;xn(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const n=i===t;!!(i.focusInsideSeparator&El.ACTIVE_ITEM)!==n&&(n?i.focusInsideSeparator|=El.ACTIVE_ITEM:i.focusInsideSeparator&=~El.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&El.MOUSE_HOVER)||(i.focusInsideSeparator|=El.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&El.MOUSE_HOVER)&&(i.focusInsideSeparator&=~El.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof $n);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof uf&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&t.item.pickable!==!1&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,n,r)=>{let o;if(n.type==="separator"){if(!n.buttons)return i;t=new uf(r,a=>this._onSeparatorButtonTriggered.fire(a),n),o=t}else{const a=r>0?e[r-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(l=a);const c=new $n(r,t!=null&&t.children?t.children.length:r,this._hasCheckboxes&&n.pickable!==!1,u=>this._onButtonTriggered.fire(u),this._elementChecked,n,l);if(this._itemElements.push(c),t)return t.children.push(c),i;o=c}return i.push(o),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),n=i==null?void 0:i.parentNode;if(i&&n){const r=i.nextSibling;i.remove(),n.insertBefore(i,r)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){var t;if(this._itemElements.length)switch(e===Yt.Second&&this._itemElements.length<2&&(e=Yt.First),e){case Yt.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,i=>i.element instanceof $n);break;case Yt.Second:{this._tree.scrollTop=0;let i=!1;this._tree.focusFirst(void 0,n=>n.element instanceof $n?i?!0:(i=!i,!1):!1);break}case Yt.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,i=>i.element instanceof $n);break;case Yt.Next:{const i=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,r=>r.element instanceof $n?(this._tree.reveal(r.element),!0):!1);const n=this._tree.getFocus();i.length&&i[0]===n[0]&&this._onLeave.fire();break}case Yt.Previous:{const i=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,r=>{if(!(r.element instanceof $n))return!1;const o=this._tree.getParentElement(r.element);return o===null||o.children[0]!==r.element?this._tree.reveal(r.element):this._tree.reveal(o),!0});const n=this._tree.getFocus();i.length&&i[0]===n[0]&&this._onLeave.fire();break}case Yt.NextPage:this._tree.focusNextPage(void 0,i=>i.element instanceof $n?(this._tree.reveal(i.element),!0):!1);break;case Yt.PreviousPage:this._tree.focusPreviousPage(void 0,i=>{if(!(i.element instanceof $n))return!1;const n=this._tree.getParentElement(i.element);return n===null||n.children[0]!==i.element?this._tree.reveal(i.element):this._tree.reveal(n),!0});break;case Yt.NextSeparator:{let i=!1;const n=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,o=>{if(i)return!0;if(o.element instanceof uf)i=!0,this._separatorRenderer.isSeparatorVisible(o.element)?this._tree.reveal(o.element.children[0]):this._tree.reveal(o.element,0);else if(o.element instanceof $n){if(o.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),!0;if(o.element===this._elementTree[0])return this._tree.reveal(o.element,0),!0}return!1});const r=this._tree.getFocus()[0];n===r&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,o=>o.element instanceof $n));break}case Yt.PreviousSeparator:{let i,n=!!((t=this._tree.getFocus()[0])!=null&&t.separator);this._tree.focusPrevious(void 0,!0,void 0,r=>{if(r.element instanceof uf)n?i||(this._separatorRenderer.isSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element.children[0]):n=!0;else if(r.element instanceof $n&&!i){if(r.element.separator)this._itemRenderer.isItemWithSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element;else if(r.element===this._elementTree[0])return this._tree.reveal(r.element,0),!0}return!1}),i&&this._tree.setFocus([i]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const n=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=n&&n.type==="separator"&&!n.buttons?n:void 0)});else{let i;this._itemElements.forEach(n=>{let r;this.matchOnLabelMode==="fuzzy"?r=this.matchOnLabel?cC(e,Yf(n.saneLabel))??void 0:void 0:r=this.matchOnLabel?YAe(t,Yf(n.saneLabel))??void 0:void 0;const o=this.matchOnDescription?cC(e,Yf(n.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?cC(e,Yf(n.saneDetail||""))??void 0:void 0;if(r||o||a?(n.labelHighlights=r,n.descriptionHighlights=o,n.detailHighlights=a,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=n.item?!n.item.alwaysShow:!0),n.item?n.separator=void 0:n.separator&&(n.hidden=!0),!this.sortByLabel){const l=n.index&&this._inputElements[n.index-1]||void 0;(l==null?void 0:l.type)==="separator"&&!l.buttons&&(i=l),i&&!n.hidden&&(n.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof $n),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!(e!=null&&e.saneTooltip)||!(e instanceof $n))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new Ee;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof $n&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof uf?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(n=>({element:n,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const r=e[i];if(!r.hidden&&r.item.pickable!==!1)if(r.checked)t=!0;else return!1}return t}_updateCheckedObservables(){Vi(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){var t,i,n;this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.hoverDelegate).onDidHideHover)==null||i.call(t),(n=this._lastHover)==null||n.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:r=>{this.linkOpenerDelegate(r)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};YD([Si],av.prototype,"onDidChangeFocus",null);YD([Si],av.prototype,"onDidChangeSelection",null);av=YD([QO(4,wt),QO(5,uo)],av);function YAe(s,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return bq(s,t);const n=Z2(t," "),r=t.length-n.length,o=bq(s,n);if(o)for(const a of o){const l=i[a.start+r]+r;a.start+=l,a.end+=l}return o}function bq(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t!==-1?[{start:t,end:t+s.length}]:null}function QAe(s,e,t){const i=s.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:JRe(s.saneSortLabel,e.saneSortLabel,t)}function XAe(s,e={}){vd.registerCommandAndKeybindingRule({weight:200,when:UD,metadata:{description:w(1758,"Used while in the context of any kind of quick input. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},...s,secondary:E9(s.primary,s.secondary??[],e)})}function ir(s,e={}){vd.registerCommandAndKeybindingRule({weight:200,when:ft.and(ft.or(ft.equals(nv,"quickPick"),ft.equals(nv,"quickTree")),UD),metadata:{description:w(1759,"Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},...s,secondary:E9(s.primary,s.secondary??[],e)})}const lv=rt?256:2048;function E9(s,e,t={}){return t.withAltMod&&e.push(512+s),t.withCtrlMod&&(e.push(lv+s),t.withAltMod&&e.push(512+lv+s)),t.withCmdMod&&rt&&(e.push(2048+s),t.withCtrlMod&&e.push(2304+s),t.withAltMod&&(e.push(2560+s),t.withCtrlMod&&e.push(2816+s))),e}function qr(s,e){return t=>{const i=t.get(_m).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(s)}}ir({id:"quickInput.pageNext",primary:12,handler:qr(Yt.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});ir({id:"quickInput.pagePrevious",primary:11,handler:qr(Yt.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});ir({id:"quickInput.first",primary:lv+14,handler:qr(Yt.First)},{withAltMod:!0,withCmdMod:!0});ir({id:"quickInput.last",primary:lv+13,handler:qr(Yt.Last)},{withAltMod:!0,withCmdMod:!0});ir({id:"quickInput.next",primary:18,handler:qr(Yt.Next)},{withCtrlMod:!0});ir({id:"quickInput.previous",primary:16,handler:qr(Yt.Previous)},{withCtrlMod:!0});const Cq=w(1760,"If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),wq=w(1761,"If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");rt?(ir({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:qr(Yt.NextSeparator,Yt.Next),metadata:{description:Cq}}),ir({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:qr(Yt.NextSeparator)},{withCtrlMod:!0}),ir({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:qr(Yt.PreviousSeparator,Yt.Previous),metadata:{description:wq}}),ir({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:qr(Yt.PreviousSeparator)},{withCtrlMod:!0})):(ir({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:qr(Yt.NextSeparator,Yt.Next),metadata:{description:Cq}}),ir({id:"quickInput.nextSeparator",primary:2578,handler:qr(Yt.NextSeparator)}),ir({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:qr(Yt.PreviousSeparator,Yt.Previous),metadata:{description:wq}}),ir({id:"quickInput.previousSeparator",primary:2576,handler:qr(Yt.PreviousSeparator)}));vd.registerCommandAndKeybindingRule({id:"quickInput.accept",primary:3,weight:200,when:ft.and(ft.notEquals(nv,"quickWidget"),UD,ft.not("isComposing")),metadata:{description:w(1762,"Used while in the context of some quick input. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},handler:s=>{const e=s.get(_m).currentQuickInput;e==null||e.accept()},secondary:E9(3,[],{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0})});ir({id:"quickInput.acceptInBackground",when:ft.and(UD,ft.equals(nv,"quickPick"),ft.or(lte.negate(),uRe)),primary:17,weight:250,handler:s=>{const e=s.get(_m).currentQuickInput;e==null||e.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});XAe({id:"quickInput.hide",primary:9,handler:s=>{const e=s.get(_m).currentQuickInput;e==null||e.hide()}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});ir({id:"quickInput.toggleHover",primary:lv|10,handler:s=>{s.get(_m).toggleHover()}});var ZAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},JAe=function(s,e){return function(t,i){e(t,i,s)}},ZO;const g0=Ve;var wg;let CE=(wg=class extends ne{constructor(e,t,i,n){super(),this._hoverDelegate=e,this._buttonTriggeredEmitter=t,this.onCheckedEvent=i,this._themeService=n,this.templateId=ZO.ID}renderTemplate(e){const t=new Ee,i=De(e,g0(".quick-input-tree-entry")),n=t.add(new qee("",!1,{...l9,size:15}));i.appendChild(n.domNode);const r=De(i,g0("label.quick-input-tree-label")),o=De(r,g0(".quick-input-tree-rows")),a=De(o,g0(".quick-input-tree-row")),l=rD(a,g0(".quick-input-tree-icon")),c=t.add(new jO(a,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this._hoverDelegate})),u=t.add(new zl(i,this._hoverDelegate?{hoverDelegate:this._hoverDelegate}:void 0));return u.domNode.classList.add("quick-input-tree-entry-action-bar"),{toDisposeTemplate:t,entry:i,checkbox:n,icon:l,label:c,actionBar:u,toDisposeElement:new Ee}}renderElement(e,t,i,n){const r=i.toDisposeElement,o=e.element;if(o.pickable===!1?i.checkbox.domNode.style.display="none":(i.checkbox.domNode.style.display="",i.checkbox.checked=o.checked??!1,r.add(ge.filter(this.onCheckedEvent,d=>d.item===o)(d=>i.checkbox.checked=d.checked)),o.disabled&&i.checkbox.disable()),o.iconPath){const d=gm(this._themeService.getColorTheme().type)?o.iconPath.dark:o.iconPath.light??o.iconPath.dark,g=nt.revive(d);i.icon.className="quick-input-tree-icon",i.icon.style.backgroundImage=Jl(g)}else i.icon.style.backgroundImage="",i.icon.className=o.iconClass?`quick-input-tree-icon ${o.iconClass}`:"";const{labelHighlights:a,descriptionHighlights:l}=e.filterData||{};let c;o.description&&(c={markdown:{value:ua(o.description),supportThemeIcons:!0},markdownNotSupportedFallback:o.description}),i.label.setLabel(o.label,o.description,{matches:a,descriptionMatches:l,extraClasses:o.iconClasses,italic:o.italic,strikethrough:o.strikethrough,labelEscapeNewLines:!0,descriptionTitle:c});const u=o.buttons;u&&u.length?(i.actionBar.push(u.map((d,g)=>W_(d,`tree-${g}`,()=>this._buttonTriggeredEmitter.fire({item:o,button:d}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i,n){i.toDisposeElement.clear(),i.actionBar.clear()}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}},ZO=wg,wg.ID="quickInputTreeElement",wg);CE=ZO=ZAe([JAe(3,Ir)],CE);class eMe{getHeight(e){return 22}getTemplateId(e){return CE.ID}}function tMe(s){var r;let e=!1,t=!1,i=!1;for(const o of s){switch((r=o.element)==null?void 0:r.checked){case"mixed":i=!0;break;case!0:e=!0;break;default:t=!0;break}if(e&&t&&i)break}return t?i||e?"mixed":!1:i?"mixed":e}class iMe{constructor(e){this.onCheckedEvent=e}getWidgetAriaLabel(){return w(1772,"Quick Tree")}getAriaLabel(e){return e.ariaLabel||[e.label,e.description].map(t=>ZJ(t)).filter(t=>!!t).join(", ")}getWidgetRole(){return"tree"}getRole(e){return"checkbox"}isChecked(e){return{get value(){return e.checked==="mixed"?"mixed":!!e.checked},onDidChange:t=>ge.filter(this.onCheckedEvent,i=>i.item===e)(i=>t())}}}class nMe{constructor(){this.filterValue="",this.matchOnLabel=!0,this.matchOnDescription=!1}filter(e,t){if(!this.filterValue||!(this.matchOnLabel||this.matchOnDescription))return e.children?{visibility:2,data:{}}:{visibility:1,data:{}};const i=this.matchOnLabel?cC(this.filterValue,Yf(e.label))??void 0:void 0,n=this.matchOnDescription?cC(this.filterValue,Yf(e.description||""))??void 0:void 0;return{visibility:t===1||i||n?1:e.children?2:0,data:{labelHighlights:i,descriptionHighlights:n}}}}class sMe extends ne{constructor(){super(...arguments),this._sortByLabel=!0}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}compare(e,t){if(!this._sortByLabel)return 0;if(e.label<t.label)return-1;if(e.label>t.label)return 1;if(e.description&&t.description){if(e.description<t.description)return-1;if(e.description>t.description)return 1}else{if(e.description)return-1;if(t.description)return 1}return 0}}var rMe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},oMe=function(s,e){return function(t,i){e(t,i,s)}};const aMe=Ve;let JO=class extends ne{constructor(e,t,i){super(),this.instantiationService=i,this._onDidTriggerButton=this._register(new $),this._onDidChangeCheckboxState=this._register(new $),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidCheckedLeafItemsChange=this._register(new $),this._onLeave=new $,this.onLeave=this._onLeave.event,this._onDidAccept=this._register(new $),this.onDidAccept=this._onDidAccept.event,this._container=De(e,aMe(".quick-input-tree")),this._renderer=this._register(this.instantiationService.createInstance(CE,t,this._onDidTriggerButton,this.onDidChangeCheckboxState)),this._filter=this.instantiationService.createInstance(nMe),this._sorter=this._register(new sMe),this._tree=this._register(this.instantiationService.createInstance(pE,"QuickInputTree",this._container,new eMe,[this._renderer],{accessibilityProvider:new iMe(this.onDidChangeCheckboxState),horizontalScrolling:!1,multipleSelectionSupport:!1,findWidgetEnabled:!1,alwaysConsumeMouseWheel:!0,hideTwistiesOfChildlessElements:!0,renderIndentGuides:Qg.None,expandOnDoubleClick:!0,expandOnlyOnTwistieClick:!0,disableExpandOnSpacebar:!0,sorter:this._sorter,filter:this._filter})),this.registerOnOpenListener()}get tree(){return this._tree}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get sortByLabel(){return this._sorter.sortByLabel}set sortByLabel(e){this._sorter.sortByLabel=e,this._tree.resort(null,!0)}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}updateFilterOptions(e){e.matchOnLabel!==void 0&&(this._filter.matchOnLabel=e.matchOnLabel),e.matchOnDescription!==void 0&&(this._filter.matchOnDescription=e.matchOnDescription),this._tree.refilter()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}registerOnOpenListener(){this._register(this._tree.onDidOpen(e=>{const t=e.element;if(!t||t.disabled)return;if(t.pickable===!1){this._tree.setFocus([t]),this._onDidAccept.fire();return}const i=t.checked!==!0;if((t.checked??!1)===i)return;t.checked=i,this._tree.rerender(t);const n=new Set,r=[...this._tree.getNode(t).children];for(;r.length;){const a=r.shift();a!=null&&a.element&&!n.has(a.element)&&(n.add(a.element),(a.element.checked??!1)!==t.checked&&(a.element.checked=t.checked,this._tree.rerender(a.element)),r.push(...a.children))}let o=this._tree.getParentElement(t);for(;o;){const a=[...this._tree.getNode(o).children],l=tMe(a);(o.checked??!1)!==l&&(o.checked=l,this._tree.rerender(o)),o=this._tree.getParentElement(o)}this._onDidChangeCheckboxState.fire({item:t,checked:t.checked??!1}),this._onDidCheckedLeafItemsChange.fire(this.getCheckedLeafItems())}))}getCheckedLeafItems(){const e=new Set,t=[...this._tree.getNode().children],i=new Array;for(;t.length;){const n=t.shift();!(n!=null&&n.element)||e.has(n.element)||n.element.checked&&(e.add(n.element),t.push(...n.children),n.element.children||i.push(n.element))}return i}};JO=rMe([oMe(2,wt)],JO);var bte=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Zf=function(s,e){return function(t,i){e(t,i,s)}},e3;const Vr=Ve,aA="workbench.quickInput.viewState";var vg;let t3=(vg=class extends ne{get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,n,r){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.storageService=r,this.enabled=!0,this.onDidAcceptEmitter=this._register(new $),this.onDidCustomEmitter=this._register(new $),this.onDidTriggerButtonEmitter=this._register(new $),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new $),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new $),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=oRe.bindTo(n),this.quickInputTypeContext=cRe.bindTo(n),this.endOfQuickInputBoxContext=hRe.bindTo(n),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(ge.runAndSubscribe(Av,({window:o,disposables:a})=>this.registerKeyModsListeners(o,a),{window:Ut,disposables:this._store})),this._register(Vpe(o=>{this.ui&&Ae(this.ui.container)===o&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))})),this.viewState=this.loadViewState()}registerKeyModsListeners(e,t){const i=n=>{this.keyMods.ctrlCmd=n.ctrlKey||n.metaKey,this.keyMods.alt=n.altKey};for(const n of[pe.KEY_DOWN,pe.KEY_UP,pe.MOUSE_DOWN])t.add(J(e,n,i,!0))}getUI(e){if(this.ui)return e&&Ae(this._container)!==Ae(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=De(this._container,Vr(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=Qa(t),n=De(t,Vr(".quick-input-titlebar")),r=this._register(new zl(n,{hoverDelegate:this.options.hoverDelegate}));r.domNode.classList.add("quick-input-left-action-bar");const o=De(n,Vr(".quick-input-title")),a=this._register(new zl(n,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=De(t,Vr(".quick-input-header")),c=this._register(new qee(w(1763,"Toggle all checkboxes"),!1,{...l9,size:15}));De(l,c.domNode),this._register(c.onChange(()=>{const K=c.checked;F.setAllVisibleChecked(K===!0)})),this._register(J(c.domNode,pe.CLICK,K=>{(K.x||K.y)&&p.setFocus()}));const u=De(l,Vr(".quick-input-description")),d=De(l,Vr(".quick-input-and-message")),g=De(d,Vr(".quick-input-filter")),p=this._register(new RRe(g,this.styles.inputBox,this.styles.toggle));p.setAttribute("aria-describedby",`${this.idPrefix}message`);const _=De(g,Vr(".quick-input-visible-count"));_.setAttribute("aria-live","polite"),_.setAttribute("aria-atomic","true");const C=this._register(new J$(_,{countFormat:w(1764,"{0} Results")},this.styles.countBadge)),v=De(g,Vr(".quick-input-count"));v.setAttribute("aria-live","polite");const x=this._register(new J$(v,{countFormat:w(1765,"{0} Selected")},this.styles.countBadge)),S=this._register(new zl(l,{hoverDelegate:this.options.hoverDelegate}));S.domNode.classList.add("quick-input-inline-action-bar");const k=De(l,Vr(".quick-input-action")),E=this._register(new HO(k,this.styles.button));E.label=w(1766,"OK"),this._register(E.onDidClick(K=>{this.onDidAcceptEmitter.fire()}));const T=De(l,Vr(".quick-input-action")),R=this._register(new HO(T,{...this.styles.button,supportIcons:!0}));R.label=w(1767,"Custom"),this._register(R.onDidClick(K=>{this.onDidCustomEmitter.fire()}));const N=De(d,Vr(`#${this.idPrefix}message.quick-input-message`)),A=this._register(new zO(t,this.styles.progressBar));A.getContainer().classList.add("quick-input-progress");const O=De(t,Vr(".quick-input-html-widget"));O.tabIndex=-1;const W=De(t,Vr(".quick-input-description")),j=this.idPrefix+"list",F=this._register(this.instantiationService.createInstance(av,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,j));p.setAttribute("aria-controls",j),this._register(F.onDidChangeFocus(()=>{p.hasFocus()&&p.setAttribute("aria-activedescendant",F.getActiveDescendant()??"")})),this._register(F.onChangedAllVisibleChecked(K=>{c.checked=K})),this._register(F.onChangedVisibleCount(K=>{C.setCount(K)})),this._register(F.onChangedCheckedCount(K=>{Ev(()=>x.setCount(K))})),this._register(F.onLeave(()=>{setTimeout(()=>{this.controller&&(p.setFocus(),this.controller instanceof bC&&this.controller.canSelectMany&&F.clearFocus())},0)}));const q=this._register(this.instantiationService.createInstance(JO,t,this.options.hoverDelegate));this._register(q.tree.onDidChangeFocus(()=>{p.hasFocus()&&p.setAttribute("aria-activedescendant",q.getActiveDescendant()??"")})),this._register(q.onLeave(()=>{setTimeout(()=>{this.controller&&(p.setFocus(),q.tree.setFocus([]))},0)})),this._register(q.onDidAccept(()=>{this.onDidAcceptEmitter.fire()})),this._register(q.tree.onDidChangeContentHeight(()=>this.updateLayout()));const Z=h1(t);return this._register(Z),this._register(J(t,pe.FOCUS,K=>{const U=this.getUI();if(xn(K.relatedTarget,U.inputContainer)){const G=U.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==G&&this.endOfQuickInputBoxContext.set(G)}xn(K.relatedTarget,U.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=Wi(K.relatedTarget)?K.relatedTarget:void 0)},!0)),this._register(Z.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(Xw.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(p.onKeyDown(K=>{const U=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==U&&this.endOfQuickInputBoxContext.set(U),p.removeAttribute("aria-activedescendant")})),this._register(J(t,pe.FOCUS,K=>{p.setFocus()})),this.dndController=this._register(this.instantiationService.createInstance(i3,this._container,t,[{node:n,includeChildren:!0},{node:l,includeChildren:!1}],this.viewState)),this._register(ct(K=>{var G;const U=(G=this.dndController)==null?void 0:G.dndViewState.read(K);U&&(U.top!==void 0&&U.left!==void 0?this.viewState={...this.viewState,top:U.top,left:U.left}:this.viewState=void 0,this.updateLayout(),U.done&&this.saveViewState(this.viewState))})),this.ui={container:t,styleSheet:i,leftActionBar:r,titleBar:n,title:o,description1:W,description2:u,widget:O,rightActionBar:a,inlineActionBar:S,checkAll:c,inputContainer:d,filterContainer:g,inputBox:p,visibleCountContainer:_,visibleCount:C,countContainer:v,count:x,okContainer:k,ok:E,message:N,customButtonContainer:T,customButton:R,list:F,tree:q,progressBar:A,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:K=>this.show(K),hide:()=>this.hide(),setVisibilities:K=>this.setVisibilities(K),setEnabled:K=>this.setEnabled(K),setContextKey:K=>this.options.setContextKey(K),linkOpenerDelegate:K=>this.options.linkOpenerDelegate(K)},this.updateStyles(),this.ui}reparentUI(e){var t;this.ui&&(this._container=e,De(this._container,this.ui.container),(t=this.dndController)==null||t.reparentUI(this._container))}pick(e,t={},i=lo.None){return new Promise((n,r)=>{let o=u=>{var d;o=n,(d=t.onKeyMods)==null||d.call(t,a.keyMods),n(u)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const u=a.activeItems[0];u&&(o(u),a.hide())}}),a.onDidChangeActive(u=>{const d=u[0];d&&t.onDidFocus&&t.onDidFocus(d)}),a.onDidChangeSelection(u=>{if(!a.canSelectMany){const d=u[0];d&&(o(d),a.hide())}}),a.onDidTriggerItemButton(u=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...u,removeItem:()=>{const d=a.items.indexOf(u.item);if(d!==-1){const g=a.items.slice(),p=g.splice(d,1),_=a.activeItems.filter(v=>v!==p[0]),C=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=g,_&&(a.activeItems=_),a.keepScrollPosition=C}}})),a.onDidTriggerSeparatorButton(u=>{var d;return(d=t.onDidTriggerSeparatorButton)==null?void 0:d.call(t,u)}),a.onDidChangeValue(u=>{l&&!u&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{Zi(c),o(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.prompt=t.prompt,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,t.sortByLabel!==void 0&&(a.sortByLabel=t.sortByLabel),a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([u,d])=>{l=d,a.busy=!1,a.items=u,a.canSelectMany&&(a.selectedItems=u.filter(g=>g.type!=="separator"&&g.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,u=>{r(u),a.hide()})})}setValidationOnInput(e,t){t&&Pn(t)?(e.severity=Fi.Error,e.validationMessage=t):t&&!Pn(t)?(e.severity=t.severity,e.validationMessage=t.content):(e.severity=Fi.Ignore,e.validationMessage=void 0)}input(e={},t=lo.None){return new Promise(i=>{if(t.isCancellationRequested){i(void 0);return}const n=this.createInputBox(),r=e.validateInput||(()=>Promise.resolve(void 0)),o=ge.debounce(n.onDidChangeValue,(u,d)=>d,100);let a=e.value||"",l=Promise.resolve(r(a));const c=[n,o(u=>{u!==a&&(l=Promise.resolve(r(u)),a=u),l.then(d=>{u===a&&this.setValidationOnInput(n,d)})}),n.onDidAccept(()=>{const u=n.value;u!==a&&(l=Promise.resolve(r(u)),a=u),l.then(d=>{!d||!Pn(d)&&d.severity!==Fi.Error?(i(u),n.hide()):u===a&&this.setValidationOnInput(n,d)})}),t.onCancellationRequested(()=>{n.hide()}),n.onDidHide(()=>{Zi(c),i(void 0)})];n.title=e.title,n.value=e.value||"",n.valueSelection=e.valueSelection,n.prompt=e.prompt,n.placeholder=e.placeHolder,n.password=!!e.password,n.ignoreFocusOut=!!e.ignoreFocusLost,n.show()})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new bC(t)}createInputBox(){const e=this.getUI(!0);return new dRe(e)}show(e){var r;const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",as(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Fi.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),as(t.message),t.progressBar.stop(),t.progressBar.getContainer().setAttribute("aria-hidden","true"),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.tree.updateFilterOptions({matchOnDescription:!1,matchOnLabel:!0}),t.tree.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const n=this.options.backKeybindingLabel();VO.tooltip=n?w(1768,"Back ({0})",n):w(1769,"Back"),t.container.style.display="",this.updateLayout(),(r=this.dndController)==null||r.layoutContainer(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.domNode.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.tree.displayed=!!e.tree,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;const t=this.getUI();for(const i of t.leftActionBar.viewItems)i.action.enabled=e;for(const i of t.rightActionBar.viewItems)i.action.enabled=e;e?t.checkAll.enable():t.checkAll.disable(),t.inputBox.enabled=e,t.ok.enabled=e,t.list.enabled=e}}hide(e){var r;const t=this.controller;if(!t)return;t.willHide(e);const i=(r=this.ui)==null?void 0:r.container,n=i&&!QQ(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!n){let o=this.previousFocusElement;for(;o&&!o.offsetParent;)o=o.parentElement??void 0;o!=null&&o.offsetParent?(o.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}toggleHover(){this.isVisible()&&this.controller instanceof bC&&this.getUI().list.toggleHover()}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){var e,t;if(this.ui&&this.isVisible()){const i=this.ui.container.style,n=Math.min(this.dimension.width*.62,e3.MAX_WIDTH);i.width=n+"px",i.top=`${(e=this.viewState)!=null&&e.top?Math.round(this.dimension.height*this.viewState.top):this.titleBarOffset}px`,i.left=`${Math.round(this.dimension.width*(((t=this.viewState)==null?void 0:t.left)??.5)-n/2)}px`,this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4),this.ui.tree.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:n,widgetShadow:r}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=r?`0 0 8px 2px ${r}`:"",this.ui.list.style(this.styles.list),this.ui.tree.tree.style(this.styles.list);const o=[];this.styles.pickerGroup.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}loadViewState(){try{const e=JSON.parse(this.storageService.get(aA,-1,"{}"));if(e.top!==void 0||e.left!==void 0)return e}catch{}}saveViewState(e){this.layoutService.activeContainer===this.layoutService.mainContainer&&(e!==void 0?this.storageService.store(aA,JSON.stringify(e),-1,1):this.storageService.remove(aA,-1))}},e3=vg,vg.MAX_WIDTH=600,vg);t3=e3=bte([Zf(1,Wh),Zf(2,wt),Zf(3,St),Zf(4,Qv)],t3);let i3=class extends ne{constructor(e,t,i,n,r,o,a){super(),this._container=e,this._quickInputContainer=t,this._quickInputDragAreas=i,this._layoutService=r,this.configurationService=a,this.dndViewState=Qe(this,void 0),this._snapThreshold=20,this._snapLineHorizontalRatio=.25,this._quickInputAlignmentContext=lRe.bindTo(o);const l=PIe(this.configurationService)==="custom";this._controlsOnLeft=l&&VI===1,this._controlsOnRight=l&&(VI===3||VI===2),this._registerLayoutListener(),this.registerMouseListeners(),this.dndViewState.set({...n,done:!0},void 0)}reparentUI(e){this._container=e}layoutContainer(e=this._layoutService.activeContainerDimension){const t=this.dndViewState.get(),i=this._quickInputContainer.getBoundingClientRect();if(t!=null&&t.top&&(t!=null&&t.left)){const n=Math.round(t.left*100)/100,r=e.width,o=i.width,a=n*r-o/2;this._layout(t.top*e.height,a)}}_registerLayoutListener(){this._register(ge.filter(this._layoutService.onDidLayoutContainer,e=>e.container===this._container)(e=>this.layoutContainer(e.dimension)))}registerMouseListeners(){const e=this._quickInputContainer;this._register(XH(e,t=>{const i=new io(Ae(e),t);i.detail===2&&this._quickInputDragAreas.some(({node:n,includeChildren:r})=>r?xn(i.target,n):i.target===n)&&this.dndViewState.set({top:void 0,left:void 0,done:!0},void 0)})),this._register(jpe(e,t=>{const i=Ae(this._layoutService.activeContainer),n=new io(i,t);if(!this._quickInputDragAreas.some(({node:d,includeChildren:g})=>g?xn(n.target,d):n.target===d))return;const r=this._quickInputContainer.getBoundingClientRect(),o=n.browserEvent.clientX-r.left,a=n.browserEvent.clientY-r.top;let l=!1;const c=$pe(i,d=>{new io(i,d).preventDefault(),l||(l=!0),this._layout(d.clientY-a,d.clientX-o)}),u=XH(i,d=>{if(l){const g=this.dndViewState.get();this.dndViewState.set({top:g==null?void 0:g.top,left:g==null?void 0:g.left,done:!0},void 0)}c.dispose(),u.dispose()})}))}_layout(e,t){const i=this._getTopSnapValue(),n=this._getCenterYSnapValue(),r=this._getCenterXSnapValue();e=Math.max(0,Math.min(e,this._container.clientHeight-this._quickInputContainer.clientHeight)),e<this._layoutService.activeContainerOffset.top&&(this._controlsOnLeft?t=Math.max(t,80/n4(At())):this._controlsOnRight&&(t=Math.min(t,this._container.clientWidth-this._quickInputContainer.clientWidth-140/n4(At()))));const o=Math.abs(e-i)<this._snapThreshold;e=o?i:e;const a=Math.abs(e-n)<this._snapThreshold;e=a?n:e;const l=e/this._container.clientHeight;t=Math.max(0,Math.min(t,this._container.clientWidth-this._quickInputContainer.clientWidth));const c=Math.abs(t-r)<this._snapThreshold;t=c?r:t;const u=this._container.clientWidth,d=this._quickInputContainer.clientWidth,p=(t+d/2)/u;if(this.dndViewState.set({top:l,left:p,done:!1},void 0),c){if(o){this._quickInputAlignmentContext.set("top");return}else if(a){this._quickInputAlignmentContext.set("center");return}}this._quickInputAlignmentContext.set(void 0)}_getTopSnapValue(){return this._layoutService.activeContainerOffset.quickPickTop}_getCenterYSnapValue(){return Math.round(this._container.clientHeight*this._snapLineHorizontalRatio)}_getCenterXSnapValue(){return Math.round(this._container.clientWidth/2)-Math.round(this._quickInputContainer.clientWidth/2)}};i3=bte([Zf(4,Wh),Zf(5,St),Zf(6,ai)],i3);var lMe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},m0=function(s,e){return function(t,i){e(t,i,s)}};let n3=class extends lye{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(BO))),this._quickAccess}constructor(e,t,i,n,r){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=n,this.configurationService=r,this._onShow=this._register(new $),this._onHide=this._register(new $),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:r=>this.setContextKey(r),linkOpenerDelegate:r=>{this.instantiationService.invokeFunction(o=>{o.get(FD).open(r,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(WO))},n=this._register(this.instantiationService.createInstance(t3,{...i,...t}));return n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(r=>{Ae(e.activeContainer)===Ae(n.container)&&n.layout(r,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{n.isVisible()||n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(n.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(n.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Ne(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=lo.None){return this.controller.pick(e,t,i)}input(e={},t=lo.None){return this.controller.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}toggleHover(){this.hasController&&this.controller.toggleHover()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:Ce(hR),quickInputForeground:Ce(Awe),quickInputTitleBackground:Ce(Mwe),widgetBorder:Ce(eZ),widgetShadow:Ce(Hv)},inputBox:Bee,toggle:Fee,countBadge:IIe,button:DIe,progressBar:TIe,keybindingLabel:EIe,list:ey({listBackground:hR,listFocusBackground:t5,listFocusForeground:e5,listInactiveFocusForeground:e5,listInactiveSelectionIconForeground:uZ,listInactiveFocusBackground:t5,listFocusOutline:Hi,listInactiveFocusOutline:Hi,treeStickyScrollBackground:hR}),pickerGroup:{pickerGroupBorder:Ce(Owe),pickerGroupForeground:Ce(hZ)}}}};n3=lMe([m0(0,wt),m0(1,St),m0(2,Ir),m0(3,Wh),m0(4,ai)],n3);var Cte=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Tf=function(s,e){return function(t,i){e(t,i,s)}};let s3=class extends n3{constructor(e,t,i,n,r,o){super(t,i,n,new K5(e.getContainerDomNode(),r),o),this.host=void 0;const a=cv.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return ge.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return ge.None},get onDidAddContainer(){return ge.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};s3=Cte([Tf(1,wt),Tf(2,St),Tf(3,Ir),Tf(4,fn),Tf(5,ai)],s3);let r3=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(s3,e);this.mapEditorToService.set(e,t),hw(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=lo.None){return this.activeService.pick(e,t,i)}input(e,t){return this.activeService.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}toggleHover(){return this.activeService.toggleHover()}};r3=Cte([Tf(0,wt),Tf(1,fn)],r3);const _2=class _2{static get(e){return e.getContribution(_2.ID)}constructor(e){this.editor=e,this.widget=new o3(this.editor)}dispose(){this.widget.dispose()}};_2.ID="editor.controller.quickInput";let cv=_2;const b2=class b2{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return b2.ID}getDomNode(){return this.domNode}getPosition(){return{preference:{top:0,left:0}}}dispose(){this.codeEditor.removeOverlayWidget(this)}};b2.ID="editor.contrib.quickInputWidget";let o3=b2;uX(cv.ID,cv,4);class cMe{constructor(e,t,i,n,r){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=r}}function hMe(s){if(!s||!Array.isArray(s))return[];const e=[];let t=0;for(let i=0,n=s.length;i<n;i++){const r=s[i];let o=-1;if(typeof r.fontStyle=="string"){o=0;const c=r.fontStyle.split(" ");for(let u=0,d=c.length;u<d;u++)switch(c[u]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break;case"strikethrough":o=o|8;break}}let a=null;typeof r.foreground=="string"&&(a=r.foreground);let l=null;typeof r.background=="string"&&(l=r.background),e[t++]=new cMe(r.token||"",i,o,a,l)}return e}function uMe(s,e){s.sort((u,d)=>{const g=pMe(u.token,d.token);return g!==0?g:u.index-d.index});let t=0,i="000000",n="ffffff";for(;s.length>=1&&s[0].token==="";){const u=s.shift();u.fontStyle!==-1&&(t=u.fontStyle),u.foreground!==null&&(i=u.foreground),u.background!==null&&(n=u.background)}const r=new fMe;for(const u of e)r.getId(u);const o=r.getId(i),a=r.getId(n),l=new D9(t,o,a),c=new T9(l);for(let u=0,d=s.length;u<d;u++){const g=s[u];c.insert(g.token,g.fontStyle,r.getId(g.foreground),r.getId(g.background))}return new wte(r,c)}const dMe=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class fMe{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(dMe);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=ae.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class wte{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(hMe(e),t)}static createFromParsedTokenTheme(e,t){return uMe(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),r=mMe(t);i=(n.metadata|r<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const gMe=/\b(comment|string|regex|regexp)\b/;function mMe(s){const e=s.match(gMe);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function pMe(s,e){return s<e?-1:s>e?1:0}class D9{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new D9(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class T9{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const r=this._children.get(i);return typeof r<"u"?r.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const r=e.indexOf(".");let o,a;r===-1?(o=e,a=""):(o=e.substring(0,r),a=e.substring(r+1));let l=this._children.get(o);typeof l>"u"&&(l=new T9(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,n)}}function _Me(s){const e=[];for(let t=1,i=s.length;t<i;t++){const n=s[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const bMe={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[ga]:"#FFFFFE",[Wv]:"#000000",[QX]:"#E5EBF1",[jv]:"#D3D3D3",[$v]:"#939393",[XX]:"#ADD6FF4D"}},CMe={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[ga]:"#1E1E1E",[Wv]:"#D4D4D4",[QX]:"#3A3D41",[jv]:"#404040",[$v]:"#707070",[XX]:"#ADD6FF26"}},wMe={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[ga]:"#000000",[Wv]:"#FFFFFF",[jv]:"#FFFFFF",[$v]:"#FFFFFF"}},vMe={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[ga]:"#FFFFFF",[Wv]:"#292929",[jv]:"#292929",[$v]:"#292929"}},yMe={IconContribution:"base.contributions.icons"};var vq;(function(s){function e(t,i){let n=t.defaults;for(;ht.isThemeIcon(n);){const r=wm.getIcon(n.id);if(!r)return;n=r.defaults}return n}s.getDefinition=e})(vq||(vq={}));var yq;(function(s){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}s.toJSONObject=e;function t(i){const n=r=>Pn(r)?r:void 0;if(i&&Array.isArray(i.src)&&i.src.every(r=>Pn(r.format)&&Pn(r.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(r=>({format:r.format,location:nt.parse(r.location)}))}}s.fromJSONObject=t})(yq||(yq={}));const SMe=/^([\w_-]+)$/,xMe=w(2024,"The font ID must only contain letters, numbers, underscores and dashes.");class LMe extends ne{constructor(){super(),this._onDidChange=this._register(new $),this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:w(2025,"The id of the font to use. If not set, the font that is defined first is used."),pattern:SMe.source,patternErrorMessage:xMe},fontCharacter:{type:"string",description:w(2026,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${ht.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const r=this.iconsById[e];if(r){if(i&&!r.description){r.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return r}const o={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(r,o)=>r.id.localeCompare(o.id),t=r=>{for(;ht.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(const r of n.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|${ht.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const r of n.filter(o=>!ht.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|`);return i.join(`
`)}}const wm=new LMe;Fn.add(yMe.IconContribution,wm);function Ed(s,e,t,i){return wm.registerIcon(s,e,t,i)}function vte(){return wm}function kMe(){const s=LQ();for(const e in s){const t="\\"+s[e].toString(16);wm.registerIcon(e,{fontCharacter:t})}}kMe();const yte="vscode://schemas/icons",Ste=Fn.as(CD.JSONContribution);Ste.registerSchema(yte,wm.getIconSchema());const Sq=new os(()=>Ste.notifySchemaChanged(yte),200);wm.onDidChange(()=>{Sq.isScheduled()||Sq.schedule()});Ed("widget-close",xe.close,w(2027,"Icon for the close action in widgets."));Ed("goto-previous-location",xe.arrowUp,w(2028,"Icon for goto previous editor location."));Ed("goto-next-location",xe.arrowDown,w(2029,"Icon for goto next editor location."));ht.modify(xe.sync,"spin");ht.modify(xe.loading,"spin");function EMe(s){const e=new Ee,t=e.add(new $),i=vte();return e.add(i.onDidChange(()=>t.fire())),s&&e.add(s.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const n=s?s.getProductIconTheme():new xte,r={},o=new QR,a=new QR;for(const l of i.getIcons()){const c=n.getIcon(l);if(!c)continue;const u=c.font,d=br`--vscode-icon-${vx(l.id)}-font-family`,g=br`--vscode-icon-${vx(l.id)}-content`;u?(r[u.id]=u.definition,a.push(br`${d}: ${Cu(u.id)};`,br`${g}: ${Cu(c.fontCharacter)};`),o.push(br`.codicon-${vx(l.id)}:before { content: ${Cu(c.fontCharacter)}; font-family: ${Cu(u.id)}; }`)):(a.push(br`${g}: ${Cu(c.fontCharacter)}; ${d}: 'codicon';`),o.push(br`.codicon-${vx(l.id)}:before { content: ${Cu(c.fontCharacter)}; }`))}for(const l in r){const c=r[l],u=c.weight?br`font-weight: ${z$(c.weight)};`:br``,d=c.style?br`font-style: ${z$(c.style)};`:br``,g=new QR;for(const p of c.src)g.push(br`${Jl(p.location)} format(${Cu(p.format)})`);o.push(br`@font-face { src: ${g.join(", ")}; font-family: ${Cu(l)};${u}${d} font-display: block; }`)}return o.push(br`:root { ${a.join(" ")} }`),o.join(`
`)}}}class xte{getIcon(e){const t=vte();let i=e.defaults;for(;ht.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const Au="vs",CC="vs-dark",H_="hc-black",z_="hc-light",Lte=Fn.as(UX.ColorContribution),DMe=Fn.as(IZ.ThemingContribution);class kte{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(sL(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,ae.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=a3(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,ae.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=Lte.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case Au:return Po.LIGHT;case H_:return Po.HIGH_CONTRAST_DARK;case z_:return Po.HIGH_CONTRAST_LIGHT;default:return Po.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const r=a3(this.themeData.base);e=r.rules,r.encodedTokensColors&&(t=r.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const r={token:""};i&&(r.foreground=i),n&&(r.background=n),e.push(r)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=wte.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const r=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=Qr.getForeground(r),a=Qr.getFontStyle(r);return{foreground:o,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}get tokenColorMap(){return[]}}function sL(s){return s===Au||s===CC||s===H_||s===z_}function a3(s){switch(s){case Au:return bMe;case CC:return CMe;case H_:return wMe;case z_:return vMe}}function Lx(s){const e=a3(s);return new kte(s,e)}class TMe extends ne{constructor(){super(),this._onColorThemeChange=this._register(new $),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new $),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new xte,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Au,Lx(Au)),this._knownThemes.set(CC,Lx(CC)),this._knownThemes.set(H_,Lx(H_)),this._knownThemes.set(z_,Lx(z_));const e=this._register(EMe(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Au),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),MQ(Ut,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return _4(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Qa(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),ne.None}_registerShadowDomContainer(e){const t=Qa(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!sL(t.base)&&!sL(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new kte(e,t)),sL(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Au),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=Ut.matchMedia("(forced-colors: active)").matches;if(e!==T_(this._theme.type)){let t;gm(this._theme.type)?t=e?H_:CC:t=e?z_:Au,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:o=>{t[o]||(e.push(o),t[o]=!0)}};DMe.getThemingParticipants().forEach(o=>o(this._theme,i,this._environment));const n=[];for(const o of Lte.getColors()){const a=this._theme.getColor(o.id,!0);a&&n.push(`${o6(o.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${n.join(`
`)} }`);const r=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(_Me(r)),i.addRule(".monaco-editor, .monaco-diff-editor, .monaco-component { forced-color-adjust: none; }"),this._themeCSS=e.join(`
`),this._updateCSS(),qi.setColorMap(r),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const ba=tt("themeService");var NMe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lA=function(s,e){return function(t,i){e(t,i,s)}};let l3=class extends ne{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new $,this._onDidChangeReducedMotion=new $,this._onDidChangeLinkUnderline=new $,this._accessibilityModeEnabledContext=U0e.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),o.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const r=Ut.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=r.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(r),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(J(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("monaco-reduce-motion",i),this._layoutService.mainContainer.classList.toggle("monaco-enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};l3=NMe([lA(0,St),lA(1,Wh),lA(2,ai)],l3);var QD=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ul=function(s,e){return function(t,i){e(t,i,s)}},Ip,D0;let c3=class{constructor(e,t,i){this._commandService=e,this._keybindingService=t,this._hiddenStates=new h3(i)}createMenu(e,t,i){return new wE(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){const n=new wE(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),r=n.getActions(i);return n.dispose(),r}resetHiddenStates(e){this._hiddenStates.reset(e)}};c3=QD([Ul(0,ho),Ul(1,Bn),Ul(2,Qv)],c3);var yg;let h3=(yg=class{constructor(e){this._storageService=e,this._disposables=new Ee,this._onDidChange=new $,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(Ip._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,Ip._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(Ip._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){var r;const i=this._isHiddenByDefault(e,t),n=((r=this._data[e.id])==null?void 0:r.includes(t))??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const r=this._data[e.id];if(i)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){const o=r.indexOf(t);o>=0&&Cfe(r,o),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(Ip._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}},Ip=yg,yg._key="menu.hiddenCommands",yg);h3=Ip=QD([Ul(0,Qv)],h3);class wC{constructor(e,t){this._id=e,this._collectContextKeysForSubmenus=t,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=this._sort(u1.getMenuItems(this._id));let t;for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(wC._fillInKbExprKeys(e.when,this._structureContextKeys),U0(e)){if(e.command.precondition&&wC._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;wC._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(u1.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}}let u3=D0=class extends wC{constructor(e,t,i,n,r,o){super(e,i),this._hiddenStates=t,this._commandService=n,this._keybindingService=r,this._contextKeyService=o,this.refresh()}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[n,r]=i;let o;for(const a of r)if(this._contextKeyService.contextMatchesRules(a.when)){const l=U0(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=IMe(this._id,l?a.command:a,this._hiddenStates);if(l){const u=Ete(this._commandService,this._keybindingService,a.command.id,a.when);(o??(o=[])).push(new Lh(a.command,a.alt,e,c,u,this._contextKeyService,this._commandService))}else{const u=new D0(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),d=On.join(...u.map(g=>g[1]));d.length>0&&(o??(o=[])).push(new x_(a,c,d))}}o&&o.length>0&&t.push([n,o])}return t}_sort(e){return e.sort(D0._compareMenuItems)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const r=e.order||0,o=t.order||0;return r<o?-1:r>o?1:D0._compareTitles(U0(e)?e.command.title:e.title,U0(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};u3=D0=QD([Ul(3,ho),Ul(4,Bn),Ul(5,St)],u3);let wE=class{constructor(e,t,i,n,r,o){this._disposables=new Ee,this._menuInfo=new u3(e,t,i.emitEventsForSubmenuChanges,n,r,o);const a=new os(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(u1.onDidChangeMenu(d=>{for(const g of this._menuInfo.allMenuIds)if(d.has(g)){a.schedule();break}}));const l=this._disposables.add(new Ee),c=d=>{let g=!1,p=!1,_=!1;for(const C of d)if(g=g||C.isStructuralChange,p=p||C.isEnablementChange,_=_||C.isToggleChange,g&&p&&_)break;return{menu:this,isStructuralChange:g,isEnablementChange:p,isToggleChange:_}},u=()=>{l.add(o.onDidChangeContext(d=>{const g=d.affectsSome(this._menuInfo.structureContextKeys),p=d.affectsSome(this._menuInfo.preconditionContextKeys),_=d.affectsSome(this._menuInfo.toggledContextKeys);(g||p||_)&&this._onDidChange.fire({menu:this,isStructuralChange:g,isEnablementChange:p,isToggleChange:_})})),l.add(t.onDidChange(d=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new lQ({onWillAddFirstListener:u,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:c}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};wE=QD([Ul(3,ho),Ul(4,Bn),Ul(5,St)],wE);function IMe(s,e,t){const i=R_e(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,r=sg({id:`hide/${s.id}/${i}`,label:w(1651,"Hide '{0}'",n),run(){t.updateHidden(s,i,!0)}}),o=sg({id:`toggle/${s.id}/${i}`,label:n,get checked(){return!t.isHidden(s,i)},run(){t.updateHidden(s,i,!!this.checked)}});return{hide:r,toggle:o,get isHidden(){return!o.checked}}}function Ete(s,e,t,i=void 0,n=!0){return sg({id:`configureKeybinding/${t}`,label:w(1652,"Configure Keybinding"),enabled:n,run(){const o=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;s.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(o?` +when:${o}`:""))}})}var RMe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xq=function(s,e){return function(t,i){e(t,i,s)}},d3;const Lq="application/vnd.code.resources";var Sg;let f3=(Sg=class extends ne{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(Fg||OQ)&&this.installWebKitWriteTextWorkaround(),this._register(ge.runAndSubscribe(Av,({window:i,disposables:n})=>{n.add(J(i.document,"copy",()=>this.clearResourcesState()))},{window:Ut,disposables:this._store}))}triggerPaste(){this.logService.trace("BrowserClipboardService#triggerPaste")}installWebKitWriteTextWorkaround(){const e=()=>{const t=new eD;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,At().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(ge.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(J(t,"click",e)),i.add(J(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.logService.trace("BrowserClipboardService#writeText called with type:",t," text.length:",e.length),this.clearResourcesState(),t){this.mapTextToType.set(t,e),this.logService.trace("BrowserClipboardService#writeText");return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return this.logService.trace("before navigator.clipboard.writeText"),await At().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){this.logService.trace("BrowserClipboardService#fallbackWriteText");const t=sD(),i=t.activeElement,n=t.body.appendChild(Ve("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),t.execCommand("copy"),Wi(i)&&i.focus(),n.remove()}async readText(e){if(this.logService.trace("BrowserClipboardService#readText called with type:",e),e){const t=this.mapTextToType.get(e)||"";return this.logService.trace("BrowserClipboardService#readText text.length:",t.length),t}try{const t=await At().navigator.clipboard.readText();return this.logService.trace("BrowserClipboardService#readText text.length:",t.length),t}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}async readResources(){try{const t=await At().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${Lq}`)){const n=await i.getType(`web ${Lq}`);return JSON.parse(await n.text()).map(o=>nt.from(o))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return N7(e.substring(0,d3.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}},d3=Sg,Sg.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,Sg);f3=d3=RMe([xq(0,Wh),xq(1,Ks)],f3);const N9=tt("clipboardService");var AMe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},MMe=function(s,e){return function(t,i){e(t,i,s)}};const vC="data-keybinding-context";class I9{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}}const C2=class C2 extends I9{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}};C2.INSTANCE=new C2;let L1=C2;const MC=class MC extends I9{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=pC.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const r=Array.from(this._values,([o])=>o);this._values.clear(),i.fire(new Eq(r))}else{const r=[];for(const o of n.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(r.push(..._t.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(r.push(a),this._values.delete(a))}i.fire(new Eq(r))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(MC._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(MC._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}};MC._keyPrefix="config.";let g3=MC;class OMe{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class kq{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class Eq{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class PMe{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function FMe(s,e){return s.allKeysContainedIn(new Set(Object.keys(e)))}class Dte extends ne{get onDidChangeContext(){return this._onDidChangeContext.event}constructor(e){super(),this._onDidChangeContext=this._register(new uw({merge:t=>new PMe(t)})),this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new OMe(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new BMe(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new kq(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new kq(e))}getContext(e){return this._isDisposed?L1.INSTANCE:this.getContextValuesContainer(VMe(e))}dispose(){super.dispose(),this._isDisposed=!0}}let m3=class extends Dte{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0,this.inputFocusedContext=lte.bindTo(this);const t=this._register(new g3(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t),this._register(ge.runAndSubscribe(Av,({window:i,disposables:n})=>{const r=n.add(new kn);n.add(J(i,pe.FOCUS_IN,()=>{r.value=new Ee,this.updateInputContextKeys(i.document,r.value)},!0))},{window:Ut,disposables:this._store}))}updateInputContextKeys(e,t){function i(){return!!e.activeElement&&qa(e.activeElement)}const n=i();if(this.inputFocusedContext.set(n),n){const r=t.add(h1(e.activeElement));ge.once(r.onDidBlur)(()=>{At().document===e&&this.inputFocusedContext.set(i()),r.dispose()},void 0,t)}}getContextValuesContainer(e){return this._isDisposed?L1.INSTANCE:this._contexts.get(e)||L1.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new I9(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};m3=AMe([MMe(0,ai)],m3);class BMe extends Dte{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new kn),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(vC)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(vC,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;FMe(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(vC),super.dispose())}getContextValuesContainer(e){return this._isDisposed?L1.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function VMe(s){for(;s;){if(s.hasAttribute(vC)){const e=s.getAttribute(vC);return e?parseInt(e,10):NaN}s=s.parentElement}return 0}function WMe(s,e,t){s.get(St).createKey(String(e),HMe(t))}function HMe(s){return tQ(s,e=>{if(typeof e=="object"&&e.$mid===1)return nt.revive(e).toString();if(e instanceof nt)return e.toString()})}dr.registerCommand("_setContext",WMe);dr.registerCommand({id:"getContextKeyInfo",handler(){return[...Ne.all()].sort((s,e)=>s.key.localeCompare(e.key))},metadata:{description:w(1674,"A command that returns information about context keys"),args:[]}});dr.registerCommand("_generateContextKeyInfo",function(){const s=[],e=new Set;for(const t of Ne.all())e.has(t.key)||(e.add(t.key),s.push(t));s.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(s,void 0,2))});let zMe=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class Dq{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new zMe(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this._findCycle(n,t);if(r)return r;t.delete(i)}}}const UMe=!1;class Tq extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class vE{constructor(e=new $1,t=!1,i,n=UMe){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(wt,this),this._globalGraph=n?(i==null?void 0:i._globalGraph)??new Dq(r=>r):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Zi(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)Y2(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,n=new class extends vE{dispose(){i._children.delete(n),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(n),t==null||t.add(n),n}invokeFunction(e,...t){this._throwIfDisposed();const i=yC.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:o=>{if(n)throw HL("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a},getIfExists:o=>{if(n)throw HL("service accessor is only valid during the invocation of its target method");return this._getOrCreateServiceInstance(o,i)}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof Dl?(i=yC.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=yC.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=za.getServiceDependencies(e).sort((a,l)=>a.index-l.index),r=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),r.push(l)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(r))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof Dl)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Dl?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var l;const n=new Dq(c=>c.id.toString());let r=0;const o=[{id:e,desc:t,_trace:i}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),n.lookupOrInsertNode(c),r++>1e3)throw new Tq(n);for(const u of za.getServiceDependencies(c.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(u.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(u.id)),d instanceof Dl){const g={id:u.id,desc:d,_trace:c._trace.branch(u.id,!0)};n.insertEdge(c,g),o.push(g)}}}}for(;;){const c=n.roots();if(c.length===0){if(!n.isEmpty())throw new Tq(n);break}for(const{data:u}of c){if(this._getServiceInstanceOrDescriptor(u.id)instanceof Dl){const g=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,g)}n.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,r){if(this._services.get(e)instanceof Dl)return this._createServiceInstance(e,t,i,n,r,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,r);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,r,o){if(n){const a=new vE(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new rpe(()=>{const u=a._createInstance(t,i,r);for(const[d,g]of l){const p=u[d];if(typeof p=="function")for(const _ of g)_.disposable=p.apply(u,_.listener)}return l.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,d){if(!c.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let _=l.get(d);return _||(_=new sr,l.set(d,_)),(v,x,S)=>{if(c.isInitialized)return c.value[d](v,x,S);{const k={listener:[v,x,S],disposable:void 0},E=_.push(k);return Fe(()=>{var R;E(),(R=k.disposable)==null||R.dispose()})}}}if(d in u)return u[d];const g=c.value;let p=g[d];return typeof p!="function"||(p=p.bind(g),u[d]=p),p},set(u,d,g){return c.value[d]=g,!0},getPrototypeOf(u){return t.prototype}})}else{const a=this._createInstance(t,i,r);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const Ur=class Ur{static traceInvocation(e,t){return e?new Ur(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Ur._None}static traceCreation(e,t){return e?new Ur(1,t.name):Ur._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new Ur(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;Ur._totals+=e;let t=!1;function i(r,o){const a=[],l=new Array(r+1).join("	");for(const[c,u,d]of o._dep)if(u&&d){t=!0,a.push(`${l}CREATES -> ${c}`);const g=i(r+1,d);g&&a.push(g)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${Ur._totals.toFixed(2)}ms)`];(e>2||t)&&Ur.all.add(n.join(`
`))}};Ur.all=new Set,Ur._None=new class extends Ur{constructor(){super(0,null)}stop(){}branch(){return this}},Ur._totals=0;let yC=Ur;const jMe=new Set([je.inMemory,je.vscodeSourceControl,je.walkThrough,je.walkThroughSnippet,je.vscodeChatCodeBlock,je.vscodeTerminal]);class $Me{constructor(){this._byResource=new ls,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let r=this._byOwner.get(t);r||(r=new ls,this._byOwner.set(t,r)),r.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,n=!1;const r=this._byResource.get(e);r&&(i=r.delete(t));const o=this._byOwner.get(t);if(o&&(n=o.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){var t,i;return typeof e=="string"?((t=this._byOwner.get(e))==null?void 0:t.values())??_t.empty():nt.isUri(e)?((i=this._byResource.get(e))==null?void 0:i.values())??_t.empty():_t.map(_t.concat(...this._byOwner.values()),n=>n[1])}}class qMe{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new ls,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(jMe.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===Xr.Error?t.errors+=1:i===Xr.Warning?t.warnings+=1:i===Xr.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class Nf{constructor(){this._onMarkerChanged=new lQ({delay:0,merge:Nf._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new $Me,this._stats=new qMe(this),this._filteredResources=new ls}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(yfe(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const r of i){const o=Nf._toMarker(e,t,r);o&&n.push(o)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:u,endColumn:d,relatedInformation:g,tags:p,origin:_}=i;if(o)return l=l>0?l:1,c=c>0?c:1,u=u>=l?u:l,d=d>0?d:c,{resource:t,owner:e,code:n,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:u,endColumn:d,relatedInformation:g,tags:p,origin:_}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const r of n){const o=_t.first(r);o&&(i.push(o.resource),this._data.delete(o.resource,e))}if(q2(t)){const r=new ls;for(const{resource:o,marker:a}of t){const l=Nf._toMarker(e,o,a);if(!l)continue;const c=r.get(o);c?c.push(l):(r.set(o,[l]),i.push(o))}for(const[o,a]of r)this._data.set(o,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}_createFilteredMarker(e,t){const i=t.length===1?w(1738,'Problems are paused because: "{0}"',t[0]):w(1739,'Problems are paused because: "{0}" and {1} more',t[0],t.length-1);return{owner:"markersFilter",resource:e,severity:Xr.Info,message:i,startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1}}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:r}=e;if((!r||r<0)&&(r=-1),t&&i){const o=e.ignoreResourceFilters?void 0:this._filteredResources.get(i);if(o!=null&&o.length)return[this._createFilteredMarker(i,o)];const a=this._data.get(i,t);if(!a)return[];const l=[];for(const c of a){if(r>0&&l.length===r)break;const u=e.ignoreResourceFilters?void 0:this._filteredResources.get(i);u!=null&&u.length?l.push(this._createFilteredMarker(i,u)):Nf._accept(c,n)&&l.push(c)}return l}else{const o=!t&&!i?this._data.values():this._data.values(i??t),a=[],l=new O_e;for(const c of o)for(const u of c){if(l.has(u.resource))continue;if(r>0&&a.length===r)break;const d=e.ignoreResourceFilters?void 0:this._filteredResources.get(u.resource);d!=null&&d.length?(a.push(this._createFilteredMarker(u.resource,d)),l.add(u.resource)):Nf._accept(u,n)&&a.push(u)}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new ls;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}class GMe extends ne{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=An.createEmptyModel(e)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=An.createEmptyModel(this.logService);const e=Fn.as(hm.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const n of e){const r=i[n],o=t[n];r!==void 0?this._configurationModel.setValue(n,r):o?this._configurationModel.setValue(n,eh(o.default)):this._configurationModel.removeValue(n)}}}const XD=tt("accessibilitySignalService"),qe=class qe{static register(e){return new qe(e.fileName)}constructor(e){this.fileName=e}};qe.error=qe.register({fileName:"error.mp3"}),qe.warning=qe.register({fileName:"warning.mp3"}),qe.success=qe.register({fileName:"success.mp3"}),qe.foldedArea=qe.register({fileName:"foldedAreas.mp3"}),qe.break=qe.register({fileName:"break.mp3"}),qe.quickFixes=qe.register({fileName:"quickFixes.mp3"}),qe.taskCompleted=qe.register({fileName:"taskCompleted.mp3"}),qe.taskFailed=qe.register({fileName:"taskFailed.mp3"}),qe.terminalBell=qe.register({fileName:"terminalBell.mp3"}),qe.diffLineInserted=qe.register({fileName:"diffLineInserted.mp3"}),qe.diffLineDeleted=qe.register({fileName:"diffLineDeleted.mp3"}),qe.diffLineModified=qe.register({fileName:"diffLineModified.mp3"}),qe.requestSent=qe.register({fileName:"requestSent.mp3"}),qe.responseReceived1=qe.register({fileName:"responseReceived1.mp3"}),qe.responseReceived2=qe.register({fileName:"responseReceived2.mp3"}),qe.responseReceived3=qe.register({fileName:"responseReceived3.mp3"}),qe.responseReceived4=qe.register({fileName:"responseReceived4.mp3"}),qe.clear=qe.register({fileName:"clear.mp3"}),qe.save=qe.register({fileName:"save.mp3"}),qe.format=qe.register({fileName:"format.mp3"}),qe.voiceRecordingStarted=qe.register({fileName:"voiceRecordingStarted.mp3"}),qe.voiceRecordingStopped=qe.register({fileName:"voiceRecordingStopped.mp3"}),qe.progress=qe.register({fileName:"progress.mp3"}),qe.chatEditModifiedFile=qe.register({fileName:"chatEditModifiedFile.mp3"}),qe.editsKept=qe.register({fileName:"editsKept.mp3"}),qe.editsUndone=qe.register({fileName:"editsUndone.mp3"}),qe.nextEditSuggestion=qe.register({fileName:"nextEditSuggestion.mp3"}),qe.terminalCommandSucceeded=qe.register({fileName:"terminalCommandSucceeded.mp3"}),qe.chatUserActionRequired=qe.register({fileName:"chatUserActionRequired.mp3"}),qe.codeActionTriggered=qe.register({fileName:"codeActionTriggered.mp3"}),qe.codeActionApplied=qe.register({fileName:"codeActionApplied.mp3"});let Rt=qe;class KMe{constructor(e){this.randomOneOf=e}}const We=class We{constructor(e,t,i,n,r,o,a=!1){this.sound=e,this.name=t,this.legacySoundSettingsKey=i,this.settingsKey=n,this.legacyAnnouncementSettingsKey=r,this.announcementMessage=o,this.managesOwnEnablement=a}static register(e){const t=new KMe("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new We(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage,e.managesOwnEnablement);return We._signals.add(i),i}};We._signals=new Set,We.errorAtPosition=We.register({name:w(1576,"Error at Position"),sound:Rt.error,announcementMessage:w(1577,"Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"}),We.warningAtPosition=We.register({name:w(1578,"Warning at Position"),sound:Rt.warning,announcementMessage:w(1579,"Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"}),We.errorOnLine=We.register({name:w(1580,"Error on Line"),sound:Rt.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:w(1581,"Error on Line"),settingsKey:"accessibility.signals.lineHasError"}),We.warningOnLine=We.register({name:w(1582,"Warning on Line"),sound:Rt.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:w(1583,"Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"}),We.foldedArea=We.register({name:w(1584,"Folded Area on Line"),sound:Rt.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:w(1585,"Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"}),We.break=We.register({name:w(1586,"Breakpoint on Line"),sound:Rt.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:w(1587,"Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"}),We.inlineSuggestion=We.register({name:w(1588,"Inline Suggestion on Line"),sound:Rt.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"}),We.nextEditSuggestion=We.register({name:w(1589,"Next Edit Suggestion on Line"),sound:Rt.nextEditSuggestion,legacySoundSettingsKey:"audioCues.nextEditSuggestion",settingsKey:"accessibility.signals.nextEditSuggestion",announcementMessage:w(1590,"Next Edit Suggestion")}),We.terminalQuickFix=We.register({name:w(1591,"Terminal Quick Fix"),sound:Rt.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:w(1592,"Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"}),We.onDebugBreak=We.register({name:w(1593,"Debugger Stopped on Breakpoint"),sound:Rt.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:w(1594,"Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"}),We.noInlayHints=We.register({name:w(1595,"No Inlay Hints on Line"),sound:Rt.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:w(1596,"No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"}),We.taskCompleted=We.register({name:w(1597,"Task Completed"),sound:Rt.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:w(1598,"Task Completed"),settingsKey:"accessibility.signals.taskCompleted"}),We.taskFailed=We.register({name:w(1599,"Task Failed"),sound:Rt.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:w(1600,"Task Failed"),settingsKey:"accessibility.signals.taskFailed"}),We.terminalCommandFailed=We.register({name:w(1601,"Terminal Command Failed"),sound:Rt.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:w(1602,"Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"}),We.terminalCommandSucceeded=We.register({name:w(1603,"Terminal Command Succeeded"),sound:Rt.terminalCommandSucceeded,announcementMessage:w(1604,"Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"}),We.terminalBell=We.register({name:w(1605,"Terminal Bell"),sound:Rt.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:w(1606,"Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"}),We.notebookCellCompleted=We.register({name:w(1607,"Notebook Cell Completed"),sound:Rt.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:w(1608,"Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"}),We.notebookCellFailed=We.register({name:w(1609,"Notebook Cell Failed"),sound:Rt.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:w(1610,"Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"}),We.diffLineInserted=We.register({name:w(1611,"Diff Line Inserted"),sound:Rt.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"}),We.diffLineDeleted=We.register({name:w(1612,"Diff Line Deleted"),sound:Rt.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"}),We.diffLineModified=We.register({name:w(1613,"Diff Line Modified"),sound:Rt.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"}),We.chatEditModifiedFile=We.register({name:w(1614,"Chat Edit Modified File"),sound:Rt.chatEditModifiedFile,announcementMessage:w(1615,"File Modified from Chat Edits"),settingsKey:"accessibility.signals.chatEditModifiedFile"}),We.chatRequestSent=We.register({name:w(1616,"Chat Request Sent"),sound:Rt.requestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:w(1617,"Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"}),We.chatResponseReceived=We.register({name:w(1618,"Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Rt.responseReceived1,Rt.responseReceived2,Rt.responseReceived3,Rt.responseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"}),We.codeActionTriggered=We.register({name:w(1619,"Code Action Request Triggered"),sound:Rt.codeActionTriggered,legacySoundSettingsKey:"audioCues.codeActionRequestTriggered",legacyAnnouncementSettingsKey:"accessibility.alert.codeActionRequestTriggered",announcementMessage:w(1620,"Code Action Request Triggered"),settingsKey:"accessibility.signals.codeActionTriggered"}),We.codeActionApplied=We.register({name:w(1621,"Code Action Applied"),legacySoundSettingsKey:"audioCues.codeActionApplied",sound:Rt.codeActionApplied,settingsKey:"accessibility.signals.codeActionApplied"}),We.progress=We.register({name:w(1622,"Progress"),sound:Rt.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:w(1623,"Progress"),settingsKey:"accessibility.signals.progress"}),We.clear=We.register({name:w(1624,"Clear"),sound:Rt.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:w(1625,"Clear"),settingsKey:"accessibility.signals.clear"}),We.save=We.register({name:w(1626,"Save"),sound:Rt.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:w(1627,"Save"),settingsKey:"accessibility.signals.save"}),We.format=We.register({name:w(1628,"Format"),sound:Rt.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:w(1629,"Format"),settingsKey:"accessibility.signals.format"}),We.voiceRecordingStarted=We.register({name:w(1630,"Voice Recording Started"),sound:Rt.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"}),We.voiceRecordingStopped=We.register({name:w(1631,"Voice Recording Stopped"),sound:Rt.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"}),We.editsKept=We.register({name:w(1632,"Edits Kept"),sound:Rt.editsKept,announcementMessage:w(1633,"Edits Kept"),settingsKey:"accessibility.signals.editsKept"}),We.editsUndone=We.register({name:w(1634,"Undo Edits"),sound:Rt.editsUndone,announcementMessage:w(1635,"Edits Undone"),settingsKey:"accessibility.signals.editsUndone"}),We.chatUserActionRequired=We.register({name:w(1636,"Chat User Action Required"),sound:Rt.chatUserActionRequired,announcementMessage:w(1637,"Chat User Action Required"),settingsKey:"accessibility.signals.chatUserActionRequired",managesOwnEnablement:!0});let Nl=We;class YMe extends ne{constructor(e,t=[]){super(),this.logger=new Y_e([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const QMe=[];function XMe(){return QMe.slice(0)}class ZMe{getParserClass(){throw new Error("not implemented in StandaloneTreeSitterLibraryService")}supportsLanguage(e,t){return!1}getLanguage(e,t,i){}getInjectionQueries(e,t){return null}getHighlightingQueries(e,t){return null}}const JMe=tt("dataChannelService");class e4e{getDataChannel(e){return{sendData:()=>{}}}}var lc=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Bi=function(s,e){return function(t,i){e(t,i,s)}};class t4e{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new $}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let p3=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new Gfe(new t4e(t))):Promise.reject(new Error("Model not found"))}};p3=lc([Bi(0,Gs)],p3);const w2=class w2{show(){return w2.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}};w2.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};let _3=w2;class i4e{withProgress(e,t,i){return t({report:()=>{}})}}class n4e{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class s4e{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),Ut.confirm(i)}async prompt(e){var n;let t;if(this.doConfirm(e.message,e.detail)){const r=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&r.push(e.cancelButton),t=await((n=r[0])==null?void 0:n.run({checkboxChecked:!1}))}return{result:t}}async error(e,t){await this.prompt({type:Fi.Error,message:e,detail:t})}}const OC=class OC{info(e){return this.notify({severity:Fi.Info,message:e})}warn(e){return this.notify({severity:Fi.Warning,message:e})}error(e){return this.notify({severity:Fi.Error,message:e})}notify(e){switch(e.severity){case Fi.Error:console.error(e.message);break;case Fi.Warning:console.warn(e.message);break;default:console.log(e.message);break}return OC.NO_OP}prompt(e,t,i,n){return OC.NO_OP}status(e,t){return{close:()=>{}}}};OC.NO_OP=new KSe;let b3=OC,C3=class{constructor(e){this._onWillExecuteCommand=new $,this._onDidExecuteCommand=new $,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=dr.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};C3=lc([Bi(0,wt)],C3);let k1=class extends _Ne{constructor(e,t,i,n,r,o){super(e,t,i,n,r),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=p=>{const _=new Ee;_.add(J(p,pe.KEY_DOWN,C=>{const v=new jt(C);this._dispatch(v,v.target)&&(v.preventDefault(),v.stopPropagation())})),_.add(J(p,pe.KEY_UP,C=>{const v=new jt(C);this._singleModifierDispatch(v,v.target)&&v.preventDefault()})),this._domNodeListeners.push(new r4e(p,_))},l=p=>{for(let _=0;_<this._domNodeListeners.length;_++){const C=this._domNodeListeners[_];C.domNode===p&&(this._domNodeListeners.splice(_,1),C.dispose())}},c=p=>{p.getOption(70)||a(p.getContainerDomNode())},u=p=>{p.getOption(70)||l(p.getContainerDomNode())};this._register(o.onCodeEditorAdd(c)),this._register(o.onCodeEditorRemove(u)),o.listCodeEditors().forEach(c);const d=p=>{a(p.getContainerDomNode())},g=p=>{l(p.getContainerDomNode())};this._register(o.onDiffEditorAdd(d)),this._register(o.onDiffEditorRemove(g)),o.listDiffEditors().forEach(d)}addDynamicKeybinding(e,t,i,n){return Bl(dr.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:s4(i.keybinding,ca),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),Fe(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(vd.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new mC(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return Ut.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const r of e){const o=r.when||void 0,a=r.keybinding;if(!a)i[n++]=new R$(void 0,r.command,r.commandArgs,o,t,null,!1);else{const l=Zw.resolveKeybinding(a,ca);for(const c of l)i[n++]=new R$(c,r.command,r.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new Bg(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new Zw([t],ca)}};k1=lc([Bi(0,St),Bi(1,ho),Bi(2,Bh),Bi(3,_a),Bi(4,Ks),Bi(5,fn)],k1);class r4e extends ne{constructor(e,t){super(),this.domNode=e,this._register(t)}}function Nq(s){return!!s&&typeof s=="object"&&(!s.overrideIdentifier||typeof s.overrideIdentifier=="string")&&(!s.resource||s.resource instanceof nt)}let yE=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new $,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new GMe(e);this._configuration=new VD(t.reload(),An.createEmptyModel(e),An.createEmptyModel(e),An.createEmptyModel(e),An.createEmptyModel(e),An.createEmptyModel(e),new ls,An.createEmptyModel(e),new ls,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,n=Nq(e)?e:Nq(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[r,o]=n;this.getValue(r)!==o&&(this._configuration.updateValue(r,o),i.push(r))}if(i.length>0){const n=new fNe({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);n.source=8,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};yE=lc([Bi(0,Ks)],yE);let w3=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new $,this.configurationService.onDidChangeConfiguration(n=>{this._onDidChangeConfiguration.fire({affectedKeys:n.affectedKeys,affectsConfiguration:(r,o)=>n.affectsConfiguration(o)})})}getValue(e,t,i){const n=Y.isIPosition(t)?t:null,r=n?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,o=e?this.getLanguage(e,n):void 0;return typeof r>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:o}):this.configurationService.getValue(r,{resource:e,overrideIdentifier:o})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};w3=lc([Bi(0,ai),Bi(1,Gs),Bi(2,En)],w3);let v3=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:kr||rt?`
`:`\r
`}};v3=lc([Bi(0,ai)],v3);class o4e{publicLog2(){}}const PC=class PC{constructor(){const e=nt.from({scheme:PC.SCHEME,authority:"model",path:"/"});this.workspace={id:RNe,folders:[new NNe({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===PC.SCHEME?this.workspace.folders[0]:null}};PC.SCHEME="inmemory";let y3=PC;function SE(s,e,t){if(!e||!(s instanceof yE))return;const i=[];Object.keys(e).forEach(n=>{aNe(n)&&i.push([`editor.${n}`,e[n]]),t&&lNe(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&s.updateValues(i)}let S3=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:n9.convert(e),n=new Map;for(const a of i){if(!(a instanceof fg))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=n.get(l);c||(c=[],n.set(l,c)),c.push(hNe.replaceMove(H.lift(a.textEdit.range),a.textEdit.text))}let r=0,o=0;for(const[a,l]of n)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),o+=1,r+=l.length;return{ariaSummary:e4(bO.bulkEditServiceSummary,r,o),isApplied:r>0}}};S3=lc([Bi(0,Gs)],S3);class a4e{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return G7(e)}}let x3=class extends qTe{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};x3=lc([Bi(0,Wh),Bi(1,fn)],x3);class l4e{constructor(){this._neverEmitter=new $,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class c4e extends wO{constructor(){super()}}class h4e extends YMe{constructor(){super(new K_e)}}let L3=class extends TO{constructor(e,t,i,n,r,o){super(e,t,i,n,r,o),this.configure({blockMouse:!1})}};L3=lc([Bi(0,Bh),Bi(1,_a),Bi(2,Gv),Bi(3,Bn),Bi(4,cm),Bi(5,St)],L3);const u4e={esmModuleLocation:void 0,label:"editorWorkerService"};let k3=class extends B4{constructor(e,t,i,n,r){super(u4e,e,t,i,n,r)}};k3=lc([Bi(0,Gs),Bi(1,e6),Bi(2,Ks),Bi(3,rc),Bi(4,ei)],k3);class d4e{async playSignal(e,t){}}ut(Ks,h4e,0);ut(ai,yE,0);ut(e6,w3,0);ut(MX,v3,0);ut(TNe,y3,0);ut(SNe,a4e,0);ut(Bh,o4e,0);ut(IJ,s4e,0);ut(PJ,n4e,0);ut(_a,b3,0);ut(bm,Nf,0);ut(En,c4e,0);ut(ba,TMe,0);ut(Gs,OO,0);ut(WX,MO,0);ut(St,m3,0);ut(xNe,i4e,0);ut(r9,_3,0);ut(Qv,eNe,0);ut(ty,k3,0);ut(sNe,S3,0);ut(ANe,l4e,0);ut(oD,p3,0);ut(uo,l3,0);ut(ac,OAe,0);ut(ho,C3,0);ut(Bn,k1,0);ut(_m,r3,0);ut(Gv,x3,0);ut(FD,AO,0);ut(N9,f3,0);ut(Hh,L3,0);ut(cm,c3,0);ut(XD,d4e,0);ut(P6,ZMe,0);ut(q_e,Z_e,0);ut(JMe,e4e,0);var Be;(function(s){const e=new $1;for(const[l,c]of vz())e.set(l,c);const t=new vE(e,!0);e.set(wt,t);function i(l){n||o({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof Dl?t.invokeFunction(u=>u.get(l)):c}s.get=i;let n=!1;const r=new $;function o(l){if(n)return t;n=!0;for(const[u,d]of vz())e.get(u)||e.set(u,d);for(const u in l)if(l.hasOwnProperty(u)){const d=tt(u);e.get(d)instanceof Dl&&e.set(d,l[u])}const c=XMe();for(const u of c)try{t.createInstance(u)}catch(d){It(d)}return r.fire(),t}s.initialize=o;function a(l){if(n)return l();const c=new Ee,u=c.add(r.event(()=>{u.dispose(),c.add(l())}));return c}s.withServices=a})(Be||(Be={}));function Uc(s,e){return s}function Wc(s,e,t,i=hs.ofCaller()){const n=s.bindTo(e),r=new Ee;return Vl({debugName:()=>`Set Context Key "${s.key}"`},o=>{const a=t(o);return n.set(a),a},i).recomputeInitiallyAndOnChange(r),r}class xE{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new xE(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const r=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-r}return new xE(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,n,r){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=n,this._cursorPosition=r}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}}function f4e(s,e,t,i){if(s.length===0)return e;if(e.length===0)return s;const n=[];let r=0,o=0;for(;r<s.length&&o<e.length;){const a=s[r],l=e[o],c=t(a),u=t(l);c<u?(n.push(a),r++):c>u?(n.push(l),o++):(n.push(i(a,l)),r++,o++)}for(;r<s.length;)n.push(s[r]),r++;for(;o<e.length;)n.push(e[o]),o++;return n}function LE(s,e){const t=new Ee,i=s.createDecorationsCollection();return t.add(O7({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}function T0(s,e){return s.appendChild(e),Fe(()=>{e.remove()})}function g4e(s,e){return s.prepend(e),Fe(()=>{e.remove()})}class Tte extends ne{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new HX(e,t)),this._width=Qe(this,this.elementSizeObserver.getWidth()),this._height=Qe(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>Vi(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function Iq(s,e,t){let i=e.get(),n=i,r=i;const o=Qe("animatedValue",i);let a=-1;const l=300;let c;t.add(H1({changeTracker:{createChangeSummary:()=>({animate:!1}),handleChange:(d,g)=>(d.didChange(e)&&(g.animate=g.animate||d.change),!0)}},(d,g)=>{c!==void 0&&(s.cancelAnimationFrame(c),c=void 0),n=r,i=e.read(d),a=Date.now()-(g.animate?0:l),u()}));function u(){const d=Date.now()-a;r=Math.floor(m4e(d,n,i-n,l)),d<l?c=s.requestAnimationFrame(u):r=i,o.set(r,void 0)}return o}function m4e(s,e,t,i){return s===i?e+t:t*(-Math.pow(2,-10*s/i)+1)+e}class R9 extends ne{constructor(e,t,i){super(),this._register(new E3(e,i)),this._register(_d(i,{height:t.actualHeight,top:t.actualTop}))}}class Jp{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=Qe(this,void 0),this._actualHeight=Qe(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}const v2=class v2{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${v2._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};v2._counter=0;let E3=v2;function _d(s,e){return ct(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),s.style[i]=n})}function kE(s,e,t,i){const n=new Ee,r=[];return n.add($a((o,a)=>{const l=e.read(o),c=new Map,u=new Map;t&&t(!0),s.changeViewZones(d=>{for(const g of r)d.removeZone(g),i==null||i.delete(g);r.length=0;for(const g of l){const p=d.addZone(g);g.setZoneId&&g.setZoneId(p),r.push(p),i==null||i.add(p),c.set(g,p)}}),t&&t(!1),a.add(H1({changeTracker:{createChangeSummary(){return{zoneIds:[]}},handleChange(d,g){const p=u.get(d.changedObservable);return p!==void 0&&g.zoneIds.push(p),!0}}},(d,g)=>{for(const p of l)p.onChange&&(u.set(p.onChange,c.get(p)),p.onChange.read(d));t&&t(!0),s.changeViewZones(p=>{for(const _ of g.zoneIds)p.layoutZone(_)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),s.changeViewZones(o=>{for(const a of r)o.removeZone(a)}),i==null||i.clear(),t&&t(!1)}}),n}function Rq(s,e){const t=ak(e,n=>n.original.startLineNumber<=s.lineNumber);if(!t)return H.fromPositions(s);if(t.original.endLineNumberExclusive<=s.lineNumber){const n=s.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return H.fromPositions(new Y(n,s.column))}if(!t.innerChanges)return H.fromPositions(new Y(t.modified.startLineNumber,1));const i=ak(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(s));if(!i){const n=s.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return H.fromPositions(new Y(n,s.column))}if(i.originalRange.containsPosition(s))return i.modifiedRange;{const n=p4e(i.originalRange.getEndPosition(),s);return H.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function p4e(s,e){return s.lineNumber===e.lineNumber?new Dr(0,e.column-s.column):new Dr(e.lineNumber-s.lineNumber,e.column-1)}function _4e(s,e){let t;return s.filter(i=>{const n=e(i,t);return t=i,n})}class EE{static create(e,t=void 0){return new Aq(e,e,t)}static createWithDisposable(e,t,i=void 0){const n=new Ee;return n.add(t),n.add(e),new Aq(e,n,i)}}class Aq extends EE{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new b4e(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class b4e extends EE{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var A9=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},M9=function(s,e){return function(t,i){e(t,i,s)}};const C4e=Ed("diff-review-insert",xe.add,w(97,"Icon for 'Insert' in accessible diff viewer.")),w4e=Ed("diff-review-remove",xe.remove,w(98,"Icon for 'Remove' in accessible diff viewer.")),v4e=Ed("diff-review-close",xe.close,w(99,"Icon for 'Close' in accessible diff viewer."));var q_;let Jf=(q_=class extends ne{constructor(e,t,i,n,r,o,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=r,this._height=o,this._diffs=a,this._models=l,this._instantiationService=c,this._state=Ie(this,u=>{const d=this._visible.read(u);if(this._parentNode.style.visibility=d?"visible":"hidden",!d)return null;const g=u.store.add(this._instantiationService.createInstance(D3,this._diffs,this._models,this._setVisible,this._canClose)),p=u.store.add(this._instantiationService.createInstance(T3,this._parentNode,g,this._width,this._height,this._models));return{model:g,view:p}}).recomputeInitiallyAndOnChange(this._store)}next(){Vi(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){Vi(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){Vi(e=>{this._setVisible(!1,e)})}},q_._ttPolicy=yd("diffReview",{createHTML:e=>e}),q_);Jf=A9([M9(8,wt)],Jf);let D3=class extends ne{constructor(e,t,i,n,r){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=n,this._accessibilitySignalService=r,this._groups=Qe(this,[]),this._currentGroupIdx=Qe(this,0),this._currentElementIdx=Qe(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((o,a)=>this._groups.read(a)[o]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((o,a)=>{var l;return(l=this.currentGroup.read(a))==null?void 0:l.lines[o]}),this._register(ct(o=>{const a=this._diffs.read(o);if(!a){this._groups.set([],void 0);return}const l=y4e(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());Vi(c=>{const u=this._models.getModifiedPosition();if(u){const d=l.findIndex(g=>(u==null?void 0:u.lineNumber)<g.range.modified.endLineNumberExclusive);d!==-1&&this._currentGroupIdx.set(d,c)}this._groups.set(l,c)})})),this._register(ct(o=>{const a=this.currentElement.read(o);(a==null?void 0:a.type)===Bs.Deleted?this._accessibilitySignalService.playSignal(Nl.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===Bs.Added&&this._accessibilitySignalService.playSignal(Nl.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(ct(o=>{const a=this.currentElement.read(o);if(a&&a.type!==Bs.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(H.fromPositions(new Y(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||P7(t,n=>{this._currentGroupIdx.set(Re.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),n),this._currentElementIdx.set(0,n)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||Vi(i=>{this._currentElementIdx.set(Re.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&Vi(n=>{this._currentElementIdx.set(i,n)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===Bs.Deleted?this._models.originalReveal(H.fromPositions(new Y(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==Bs.Header?H.fromPositions(new Y(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};D3=A9([M9(4,XD)],D3);const p0=3;function y4e(s,e,t){const i=[];for(const n of t7(s,(r,o)=>o.modified.startLineNumber-r.modified.endLineNumberExclusive<2*p0)){const r=[];r.push(new x4e);const o=new He(Math.max(1,n[0].original.startLineNumber-p0),Math.min(n[n.length-1].original.endLineNumberExclusive+p0,e+1)),a=new He(Math.max(1,n[0].modified.startLineNumber-p0),Math.min(n[n.length-1].modified.endLineNumberExclusive+p0,t+1));XY(n,(u,d)=>{const g=new He(u?u.original.endLineNumberExclusive:o.startLineNumber,d?d.original.startLineNumber:o.endLineNumberExclusive),p=new He(u?u.modified.endLineNumberExclusive:a.startLineNumber,d?d.modified.startLineNumber:a.endLineNumberExclusive);g.forEach(_=>{r.push(new E4e(_,p.startLineNumber+(_-g.startLineNumber)))}),d&&(d.original.forEach(_=>{r.push(new L4e(d,_))}),d.modified.forEach(_=>{r.push(new k4e(d,_))}))});const l=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);i.push(new S4e(new Ss(l,c),r))}return i}var Bs;(function(s){s[s.Header=0]="Header",s[s.Unchanged=1]="Unchanged",s[s.Deleted=2]="Deleted",s[s.Added=3]="Added"})(Bs||(Bs={}));class S4e{constructor(e,t){this.range=e,this.lines=t}}class x4e{constructor(){this.type=Bs.Header}}class L4e{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=Bs.Deleted,this.modifiedLineNumber=void 0}}class k4e{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=Bs.Added,this.originalLineNumber=void 0}}class E4e{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=Bs.Unchanged}}let T3=class extends ne{constructor(e,t,i,n,r,o){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._models=r,this._languageService=o,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new zl(a)),this._register(ct(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(sg({id:"diffreview.close",label:w(100,"Close"),class:"close-diff-review "+ht.asClassName(v4e),enabled:!0,run:async()=>t.close()}),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new m6(this._content,{})),as(this.domNode,this._scrollbar.getDomNode(),a),this._register(ct(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(Fe(()=>{as(this.domNode)})),this._register(_d(this.domNode,{width:this._width,height:this._height})),this._register(_d(this._content,{width:this._width,height:this._height})),this._register($a((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(Xn(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",w(101,"Accessible Diff Viewer. Use arrow up and down to navigate.")),Jn(n,i.get(59)),as(this._content,n);const r=this._models.getOriginalModel(),o=this._models.getModifiedModel();if(!r||!o)return;const a=r.getOptions(),l=o.getOptions(),c=i.get(75),u=this._model.currentGroup.get();for(const d of(u==null?void 0:u.lines)||[]){if(!u)break;let g;if(d.type===Bs.Header){const _=document.createElement("div");_.className="diff-review-row",_.setAttribute("role","listitem");const C=u.range,v=this._model.currentGroupIndex.get(),x=this._model.groups.get().length,S=R=>R===0?w(102,"no lines changed"):R===1?w(103,"1 line changed"):w(104,"{0} lines changed",R),k=S(C.original.length),E=S(C.modified.length);_.setAttribute("aria-label",w(105,"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",v+1,x,C.original.startLineNumber,k,C.modified.startLineNumber,E));const T=document.createElement("div");T.className="diff-review-cell diff-review-summary",T.appendChild(document.createTextNode(`${v+1}/${x}: @@ -${C.original.startLineNumber},${C.original.length} +${C.modified.startLineNumber},${C.modified.length} @@`)),_.appendChild(T),g=_}else g=this._createRow(d,c,this._width.get(),t,r,a,i,o,l);n.appendChild(g);const p=Ie(_=>this._model.currentElement.read(_)===d);e.add(ct(_=>{const C=p.read(_);g.tabIndex=C?0:-1,C&&g.focus()})),e.add(J(g,"focus",()=>{this._model.goToLine(d)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,r,o,a,l,c){const u=n.get(165),d=u.glyphMarginWidth+u.lineNumbersWidth,g=a.get(165),p=10+g.glyphMarginWidth+g.lineNumbersWidth;let _="diff-review-row",C="";const v="diff-review-spacer";let x=null;switch(e.type){case Bs.Added:_="diff-review-row line-insert",C=" char-insert",x=C4e;break;case Bs.Deleted:_="diff-review-row line-delete",C=" char-delete",x=w4e;break}const S=document.createElement("div");S.style.minWidth=i+"px",S.className=_,S.setAttribute("role","listitem"),S.ariaLevel="";const k=document.createElement("div");k.className="diff-review-cell",k.style.height=`${t}px`,S.appendChild(k);const E=document.createElement("span");E.style.width=d+"px",E.style.minWidth=d+"px",E.className="diff-review-line-number"+C,e.originalLineNumber!==void 0?E.appendChild(document.createTextNode(String(e.originalLineNumber))):E.innerText="",k.appendChild(E);const T=document.createElement("span");T.style.width=p+"px",T.style.minWidth=p+"px",T.style.paddingRight="10px",T.className="diff-review-line-number"+C,e.modifiedLineNumber!==void 0?T.appendChild(document.createTextNode(String(e.modifiedLineNumber))):T.innerText="",k.appendChild(T);const R=document.createElement("span");if(R.className=v,x){const O=document.createElement("span");O.className=ht.asClassName(x),O.innerText="",R.appendChild(O)}else R.innerText="";k.appendChild(R);let N;if(e.modifiedLineNumber!==void 0){let O=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);Jf._ttPolicy&&(O=Jf._ttPolicy.createHTML(O)),k.insertAdjacentHTML("beforeend",O),N=l.getLineContent(e.modifiedLineNumber)}else{let O=this._getLineHtml(r,n,o.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);Jf._ttPolicy&&(O=Jf._ttPolicy.createHTML(O)),k.insertAdjacentHTML("beforeend",O),N=r.getLineContent(e.originalLineNumber)}N.length===0&&(N=w(106,"blank"));let A="";switch(e.type){case Bs.Unchanged:e.originalLineNumber===e.modifiedLineNumber?A=w(107,"{0} unchanged line {1}",N,e.originalLineNumber):A=w(108,"{0} original line {1} modified line {2}",N,e.originalLineNumber,e.modifiedLineNumber);break;case Bs.Added:A=w(109,"+ {0} modified line {1}",N,e.modifiedLineNumber);break;case Bs.Deleted:A=w(110,"- {0} original line {1}",N,e.originalLineNumber);break}return S.setAttribute("aria-label",A),S}_getLineHtml(e,t,i,n,r){const o=e.getLineContent(n),a=t.get(59),l=t.get(117).verticalScrollbarSize,c=gn.createEmpty(o,r),u=co.isBasicASCII(o,e.mightContainNonBasicASCII()),d=co.containsRTL(o,u,e.mightContainRTL());return SD(new um(a.isMonospace&&!t.get(40),a.canUseHalfwidthRightwardsArrow,o,!1,u,d,0,c,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(133),t.get(113),t.get(108),t.get(60)!==hd.OFF,null,null,l)).html}};T3=A9([M9(5,En)],T3);class D4e{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}B("diffEditor.move.border","#8b8b8b9c",w(137,"The border color for text that got moved in the diff editor."));B("diffEditor.moveActive.border","#FFA500",w(138,"The active border color for text that got moved in the diff editor."));B("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},w(139,"The color of the shadow around unchanged region widgets."));const T4e=Ed("diff-insert",xe.add,w(140,"Line decoration for inserts in the diff editor.")),Nte=Ed("diff-remove",xe.remove,w(141,"Line decoration for removals in the diff editor.")),Mq=dn.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+ht.asClassName(T4e),marginClassName:"gutter-insert"}),Oq=dn.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+ht.asClassName(Nte),marginClassName:"gutter-delete"}),Pq=dn.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),Fq=dn.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),Bq=dn.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),N4e=dn.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),I4e=dn.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),N3=dn.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),R4e=dn.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),A4e=dn.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var Ite=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},I3=function(s,e){return function(t,i){e(t,i,s)}},df;const Rte=tt("diffProviderFactoryService");let R3=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance(A3,e)}};R3=Ite([I3(0,wt)],R3);ut(Rte,R3,1);var xg;let A3=(xg=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new $,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)==null||e.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new ao(new He(1,2),new He(1,t.getLineCount()+1),[new Cr(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const r=JSON.stringify([e.uri.toString(),t.uri.toString()]),o=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=df.diffCache.get(r);if(a&&a.context===o)return a.result;const l=Ah.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),u=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:u,timedOut:(c==null?void 0:c.quitEarly)??!0,detectedMoves:i.computeMoves?(c==null?void 0:c.moves.length)??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return df.diffCache.size>10&&df.diffCache.delete(df.diffCache.keys().next().value),df.diffCache.set(r,{result:c,context:o}),c}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((i=this.diffAlgorithmOnDidChangeSubscription)==null||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}},df=xg,xg.diffCache=new Map,xg);A3=df=Ite([I3(1,ty),I3(2,Bh)],A3);function M4e(s,e,t,i){return e||(e=n=>n!=null),new Promise((n,r)=>{let o=!0,a=!1;const l=s.map(u=>({isFinished:e(u),error:!1,state:u})),c=ct(u=>{const{isFinished:d,error:g,state:p}=l.read(u);(d||g)&&(o?a=!0:c.dispose(),g?r(g===!0?p:g):n(p))});o=!1,a&&c.dispose()})}function aa(s,e,t=hs.ofCaller()){return new O4e(typeof s=="string"?s:new Us(s,void 0,void 0),e,t)}class O4e extends W1{constructor(e,t,i){super(i),this.event=t,this.handleEvent=()=>{Vi(n=>{for(const r of this._observers)n.updateObserver(r,this),r.handleChange(this,void 0)},()=>this.debugName)},this.debugName=typeof e=="string"?e:e.getDebugName(this)??"Observable Signal From Event"}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}var P4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},F4e=function(s,e){return function(t,i){e(t,i,s)}};let M3=class extends ne{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=Qe(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=Qe(this,void 0),this.diff=this._diff,this._unchangedRegions=Qe(this,void 0),this.unchangedRegions=Ie(this,a=>{var l;return this._options.hideUnchangedRegions.read(a)?((l=this._unchangedRegions.read(a))==null?void 0:l.regions)??[]:(Vi(c=>{var u;for(const d of((u=this._unchangedRegions.read(void 0))==null?void 0:u.regions)||[])d.collapseAll(c)}),[])}),this.movedTextToCompare=Qe(this,void 0),this._activeMovedText=Qe(this,void 0),this._hoveredMovedText=Qe(this,void 0),this.activeMovedText=Ie(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new sm,this._diffProvider=Ie(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=aa("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(Fe(()=>this._cancellationTokenSource.cancel()));const n=Uw("contentChangedSignal"),r=this._register(new os(()=>n.trigger(void 0),200));this._register(ct(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(_=>_.isDragged.read(a)))return;const c=l.originalDecorationIds.map(_=>e.original.getDecorationRange(_)).map(_=>_?He.fromRangeInclusive(_):void 0),u=l.modifiedDecorationIds.map(_=>e.modified.getDecorationRange(_)).map(_=>_?He.fromRangeInclusive(_):void 0),d=l.regions.map((_,C)=>!c[C]||!u[C]?void 0:new Uu(c[C].startLineNumber,u[C].startLineNumber,c[C].length,_.visibleLineCountTop.read(a),_.visibleLineCountBottom.read(a))).filter(Io),g=[];let p=!1;for(const _ of t7(d,(C,v)=>C.getHiddenModifiedRange(a).endLineNumberExclusive===v.getHiddenModifiedRange(a).startLineNumber))if(_.length>1){p=!0;const C=_.reduce((x,S)=>x+S.lineCount,0),v=new Uu(_[0].originalLineNumber,_[0].modifiedLineNumber,C,_[0].visibleLineCountTop.read(void 0),_[_.length-1].visibleLineCountBottom.read(void 0));g.push(v)}else g.push(_[0]);if(p){const _=e.original.deltaDecorations(l.originalDecorationIds,g.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),C=e.modified.deltaDecorations(l.modifiedDecorationIds,g.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));Vi(v=>{this._unchangedRegions.set({regions:g,originalDecorationIds:_,modifiedDecorationIds:C},v)})}}));const o=(a,l,c)=>{const u=Uu.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let d;const g=this._unchangedRegions.get();if(g){const v=g.originalDecorationIds.map(E=>e.original.getDecorationRange(E)).map(E=>E?He.fromRangeInclusive(E):void 0),x=g.modifiedDecorationIds.map(E=>e.modified.getDecorationRange(E)).map(E=>E?He.fromRangeInclusive(E):void 0);let k=_4e(g.regions.map((E,T)=>{if(!v[T]||!x[T])return;const R=v[T].length;return new Uu(v[T].startLineNumber,x[T].startLineNumber,R,Math.min(E.visibleLineCountTop.get(),R),Math.min(E.visibleLineCountBottom.get(),R-E.visibleLineCountTop.get()))}).filter(Io),(E,T)=>!T||E.modifiedLineNumber>=T.modifiedLineNumber+T.lineCount&&E.originalLineNumber>=T.originalLineNumber+T.lineCount).map(E=>new Ss(E.getHiddenOriginalRange(c),E.getHiddenModifiedRange(c)));k=Ss.clip(k,He.ofLength(1,e.original.getLineCount()),He.ofLength(1,e.modified.getLineCount())),d=Ss.inverse(k,e.original.getLineCount(),e.modified.getLineCount())}const p=[];if(d)for(const v of u){const x=d.filter(S=>S.original.intersectsStrict(v.originalUnchangedRange)&&S.modified.intersectsStrict(v.modifiedUnchangedRange));p.push(...v.setVisibleRanges(x,l))}else p.push(...u);const _=e.original.deltaDecorations((g==null?void 0:g.originalDecorationIds)||[],p.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),C=e.modified.deltaDecorations((g==null?void 0:g.modifiedDecorationIds)||[],p.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:p,originalDecorationIds:_,modifiedDecorationIds:C},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=_h.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=_h.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register($a(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),r.cancel(),n.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),this._isDiffUpToDate.set(!1,void 0);let u=[];l.add(e.original.onDidChangeContent(p=>{const _=_h.fromModelContentChanges(p.changes);u=Hk(u,_)}));let d=[];l.add(e.modified.onDidChangeContent(p=>{const _=_h.fromModelContentChanges(p.changes);d=Hk(d,_)}));let g=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(g=B4e(g,e.original,e.modified),g=(e.original,e.modified,void 0)??g,g=(e.original,e.modified,void 0)??g,Vi(p=>{o(g,p),this._lastDiff=g;const _=O9.fromDiffResult(g);this._diff.set(_,p),this._isDiffUpToDate.set(!0,p);const C=this.movedTextToCompare.read(void 0);this.movedTextToCompare.set(C?this._lastDiff.moves.find(v=>v.lineRangeMapping.modified.intersect(C.lineRangeMapping.modified)):void 0,p)}))}))}ensureModifiedLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const n=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of n)if(a.getHiddenModifiedRange(void 0).contains(e)){a.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const n=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of n)if(a.getHiddenOriginalRange(void 0).contains(e)){a.showOriginalLine(e,t,i);return}}async waitForDiff(){await M4e(this.isDiffUpToDate,e=>e)}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e==null?void 0:e.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){var n;const t=(n=e.collapsedRegions)==null?void 0:n.map(r=>He.deserialize(r.range)),i=this._unchangedRegions.get();!i||!t||Vi(r=>{for(const o of i.regions)for(const a of t)if(o.modifiedUnchangedRange.intersect(a)){o.setHiddenModifiedRange(a,r);break}})}};M3=P4e([F4e(2,Rte)],M3);function B4e(s,e,t){return{changes:s.changes.map(i=>new ao(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>V4e(n,e,t)):void 0)),moves:s.moves,identical:s.identical,quitEarly:s.quitEarly}}function V4e(s,e,t){let i=s.originalRange,n=s.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new Cr(i,n)}class O9{static fromDiffResult(e){return new O9(e.changes.map(t=>new Ate(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class Ate{constructor(e){this.lineRangeMapping=e}}class Uu{static fromDiffs(e,t,i,n,r){const o=ao.inverse(e,t,i),a=[];for(const l of o){let c=l.original.startLineNumber,u=l.modified.startLineNumber,d=l.original.length;const g=c===1&&u===1,p=c+d===t+1&&u+d===i+1;(g||p)&&d>=r+n?(g&&!p&&(d-=r),p&&!g&&(c+=r,u+=r,d-=r),a.push(new Uu(c,u,d,0,0))):d>=r*2+n&&(c+=r,u+=r,d-=r*2,a.push(new Uu(c,u,d,0,0)))}return a}get originalUnchangedRange(){return He.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return He.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,r){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=Qe(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=Qe(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=Ie(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=Qe(this,void 0);const o=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(r,this.lineCount-n),0);dH(n===o),dH(r===a),this._visibleLineCountTop.set(o,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],n=new Ao(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let r=this.originalLineNumber,o=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of n.ranges){const u=l===n.ranges.length-1;l++;const d=(u?a:c.endLineNumberExclusive)-o,g=new Uu(r,o,d,0,0);g.setHiddenModifiedRange(c,t),i.push(g),r=g.originalUnchangedRange.endLineNumberExclusive,o=g.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return He.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return He.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),r=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<r||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+r,i)}showOriginalLine(e,t,i){const n=e-this.originalLineNumber,r=this.originalLineNumber+this.lineCount-e;t===0&&n<r||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+r-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-r,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}function W4e(s){const{domNode:e,renderLinesResult:t,diffEntry:i,originalModel:n,clipboardService:r}=s,o=new Ee;return o.add(J(e,"copy",a=>{a.preventDefault();const l=e.ownerDocument.getSelection();if(!l||l.rangeCount===0)return;const c=l.getRangeAt(0);if(!c||c.collapsed)return;const u=c.startContainer.nodeType===Node.TEXT_NODE?c.startContainer.parentElement:c.startContainer,d=c.endContainer.nodeType===Node.TEXT_NODE?c.endContainer.parentElement:c.endContainer;if(!u||!d)return;const g=t.getModelPositionAt(u,c.startOffset),p=t.getModelPositionAt(d,c.endOffset);if(!g||!p)return;const _=g.delta(i.original.startLineNumber-1),C=p.delta(i.original.startLineNumber-1),v=C.isBefore(_)?H.fromPositions(C,_):H.fromPositions(_,C),x=n.getValueInRange(v);r.writeText(x)})),o}class H4e extends ne{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,n,r,o,a,l,c,u){super(),this._getViewZoneId=e,this._marginDomNode=t,this._deletedCodeDomNode=i,this._modifiedEditor=n,this._diff=r,this._editor=o,this._renderLinesResult=a,this._originalTextModel=l,this._contextMenuService=c,this._clipboardService=u,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=ht.asClassName(xe.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(75);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let g=0;const p=n.getOption(144)&&!Gl,_=(C,v,x)=>{this._contextMenuService.showContextMenu({domForShadowRoot:p?n.getDomNode()??void 0:void 0,getAnchor:()=>C,onHide:x,getActions:()=>{const S=[],k=r.modified.isEmpty;return S.push(new Zu("diff.clipboard.copyDeletedContent",k?r.original.length>1?w(112,"Copy deleted lines"):w(113,"Copy deleted line"):r.original.length>1?w(114,"Copy changed lines"):w(115,"Copy changed line"),void 0,!0,async()=>{const T=this._originalTextModel.getValueInRange(r.original.toExclusiveRange());await this._clipboardService.writeText(T)})),r.original.length>1&&S.push(new Zu("diff.clipboard.copyDeletedLineContent",k?w(116,"Copy deleted line ({0})",r.original.startLineNumber+g):w(117,"Copy changed line ({0})",r.original.startLineNumber+g),void 0,!0,async()=>{let T=this._originalTextModel.getLineContent(r.original.startLineNumber+g);T===""&&(T=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(T)})),n.getOption(104)||S.push(new Zu("diff.inline.revertChange",w(118,"Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),S},autoSelectFirstItem:!0})};this._register(Xn(this._diffActions,"mousedown",C=>{if(!C.leftButton)return;const{top:v,height:x}=Mo(this._diffActions),S=Math.floor(d/3);C.preventDefault(),_({x:C.posx,y:v+x+S})})),this._register(n.onMouseMove(C=>{(C.target.type===8||C.target.type===5)&&C.target.detail.viewZoneId===this._getViewZoneId()?(g=this._updateLightBulbPosition(this._marginDomNode,C.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(W4e({domNode:this._deletedCodeDomNode,diffEntry:r,originalModel:this._originalTextModel,renderLinesResult:this._renderLinesResult,clipboardService:u}))}_updateLightBulbPosition(e,t,i){const{top:n}=Mo(e),r=t-n,o=Math.floor(r/i),a=o*i;if(this._diffActions.style.top=`${a}px`,this._renderLinesResult.viewLineCounts){let l=0;for(let c=0;c<this._renderLinesResult.viewLineCounts.length;c++)if(l+=this._renderLinesResult.viewLineCounts[c],o<l)return c}return o}}const Vq=yd("diffEditorWidget",{createHTML:s=>s});function z4e(s,e,t,i,n=!1){Jn(i,e.fontInfo);const r=t.length>0,o=new z1(1e4);let a=0,l=0;const c=[],u=[];for(let _=0;_<s.lineTokens.length;_++){const C=_+1,v=s.lineTokens[_],x=s.lineBreakData[_],S=Oo.filter(t,C,1,Number.MAX_SAFE_INTEGER);if(x){let k=0;for(const E of x.breakOffsets){const T=v.sliceAndInflate(k,E,0),R=Hq(l,T,Oo.extractWrapped(S,k,E),r,s.mightContainNonBasicASCII,s.mightContainRTL,e,o,n);a=Math.max(a,R.maxCharWidth),u.push(new Wq(R.output.characterMapping,R.output.containsForeignElements,k)),l++,k=E}c.push(x.breakOffsets.length)}else{c.push(1);const k=Hq(l,v,S,r,s.mightContainNonBasicASCII,s.mightContainRTL,e,o,n);a=Math.max(a,k.maxCharWidth),u.push(new Wq(k.output.characterMapping,k.output.containsForeignElements,0)),l++}}a+=e.scrollBeyondLastColumn;const d=o.build(),g=Vq?Vq.createHTML(d):d;i.innerHTML=g;const p=a*e.typicalHalfwidthCharacterWidth;return new j4e(l,p,c,u,s)}class U4e{constructor(e,t=e.map(r=>null),i=!0,n=!0){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class SC{static fromEditor(e){var r;const t=e.getOptions(),i=t.get(59),n=t.get(165);return new SC(((r=e.getModel())==null?void 0:r.getOptions().tabSize)||0,i,t.get(40),i.typicalHalfwidthCharacterWidth,t.get(118),t.get(75),n.decorationsWidth,t.get(133),t.get(113),t.get(108),t.get(60),t.get(117).verticalScrollbarSize)}constructor(e,t,i,n,r,o,a,l,c,u,d,g,p=!0){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=r,this.lineHeight=o,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=u,this.fontLigatures=d,this.verticalScrollbarSize=g,this.setWidth=p}withSetWidth(e){return new SC(this.tabSize,this.fontInfo,this.disableMonospaceOptimizations,this.typicalHalfwidthCharacterWidth,this.scrollBeyondLastColumn,this.lineHeight,this.lineDecorationsWidth,this.stopRenderingLineAfter,this.renderWhitespace,this.renderControlCharacters,this.fontLigatures,this.verticalScrollbarSize,e)}withScrollBeyondLastColumn(e){return new SC(this.tabSize,this.fontInfo,this.disableMonospaceOptimizations,this.typicalHalfwidthCharacterWidth,e,this.lineHeight,this.lineDecorationsWidth,this.stopRenderingLineAfter,this.renderWhitespace,this.renderControlCharacters,this.fontLigatures,this.verticalScrollbarSize,this.setWidth)}}class j4e{constructor(e,t,i,n,r){this.heightInLines=e,this.minWidthInPx=t,this.viewLineCounts=i,this._renderOutputs=n,this._source=r}getModelPositionAt(e,t){let i=e;for(;i&&!i.classList.contains("view-line");)i=i.parentElement;if(!i)return;const n=i.parentElement;if(!n)return;const r=n.querySelectorAll(".view-line");let o=-1;for(let d=0;d<r.length;d++)if(r[d]===i){o=d;break}if(o===-1||o>=this._renderOutputs.length)return;let a=1,l=o;for(let d=0;d<this.viewLineCounts.length;d++){if(l<this.viewLineCounts[d]){a=d+1;break}l-=this.viewLineCounts[d]}if(a>this._source.lineTokens.length)return;const c=this._renderOutputs[o];if(!c)return;const u=Aw(c.characterMapping,e,t)+c.offset;return new Y(a,u)}}class Wq extends fk{constructor(e,t,i){super(e,t),this.offset=i}}function Hq(s,e,t,i,n,r,o,a,l){a.appendString('<div class="view-line'),!l&&!i&&a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(s*o.lineHeight)),o.setWidth?a.appendString('px;width:1000000px;">'):a.appendString('px;">');const c=e.getLineContent(),u=co.isBasicASCII(c,n),d=co.containsRTL(c,u,r),g=yD(new um(o.fontInfo.isMonospace&&!o.disableMonospaceOptimizations,o.fontInfo.canUseHalfwidthRightwardsArrow,c,!1,u,d,0,e,t,o.tabSize,0,o.fontInfo.spaceWidth,o.fontInfo.middotWidth,o.fontInfo.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==hd.OFF,null,null,o.verticalScrollbarSize),a);a.appendString("</div>");const p=g.characterMapping.getHorizontalOffset(g.characterMapping.length);return{output:g,maxCharWidth:p}}var $4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},zq=function(s,e){return function(t,i){e(t,i,s)}};let O3=class extends ne{constructor(e,t,i,n,r,o,a,l,c,u){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=n,this._diffEditorWidget=r,this._canIgnoreViewZoneUpdateEvent=o,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=u,this._originalTopPadding=Qe(this,0),this._originalScrollOffset=Qe(this,0),this._originalScrollOffsetAnimated=Iq(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=Qe(this,0),this._modifiedScrollOffset=Qe(this,0),this._modifiedScrollOffsetAnimated=Iq(this._targetWindow,this._modifiedScrollOffset,this._store);const d=Qe("invalidateAlignmentsState",0),g=this._register(new os(()=>{d.set(d.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(k=>{this._canIgnoreViewZoneUpdateEvent()||g.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(k=>{this._canIgnoreViewZoneUpdateEvent()||g.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(k=>{(k.hasChanged(166)||k.hasChanged(75))&&g.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(k=>{(k.hasChanged(166)||k.hasChanged(75))&&g.schedule()}));const p=this._diffModel.map(k=>k?mi(this,k.model.original.onDidChangeTokens,()=>k.model.original.tokenization.backgroundTokenizationState===2):void 0).map((k,E)=>k==null?void 0:k.read(E)),_=Ie(k=>{const E=this._diffModel.read(k),T=E==null?void 0:E.diff.read(k);if(!E||!T)return null;d.read(k);const N=this._options.renderSideBySide.read(k);return Uq(this._editors.original,this._editors.modified,T.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,N)}),C=Ie(k=>{var R;const E=(R=this._diffModel.read(k))==null?void 0:R.movedTextToCompare.read(k);if(!E)return null;d.read(k);const T=E.changes.map(N=>new Ate(N));return Uq(this._editors.original,this._editors.modified,T,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function v(){const k=document.createElement("div");return k.className="diagonal-fill",k}const x=this._register(new Ee);this.viewZones=Ie(this,k=>{var le,ve,V,ce;x.clear();const E=_.read(k)||[],T=[],R=[],N=this._modifiedTopPadding.read(k);N>0&&R.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:N,showInHiddenAreas:!0,suppressMouseDown:!0});const A=this._originalTopPadding.read(k);A>0&&T.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:A,showInHiddenAreas:!0,suppressMouseDown:!0});const O=this._options.renderSideBySide.read(k),W=O||(le=this._editors.modified._getViewModel())==null?void 0:le.createLineBreaksComputer();if(W){const oe=this._editors.original.getModel();for(const Se of E)if(Se.diff)for(let me=Se.originalRange.startLineNumber;me<Se.originalRange.endLineNumberExclusive;me++){if(me>oe.getLineCount())return{orig:T,mod:R};W==null||W.addRequest(oe.getLineContent(me),null,null)}}const j=(W==null?void 0:W.finalize())??[];let F=0;const q=this._editors.modified.getOption(75),Z=(ve=this._diffModel.read(k))==null?void 0:ve.movedTextToCompare.read(k),K=((V=this._editors.original.getModel())==null?void 0:V.mightContainNonBasicASCII())??!1,U=((ce=this._editors.original.getModel())==null?void 0:ce.mightContainRTL())??!1,G=SC.fromEditor(this._editors.modified);for(const oe of E)if(oe.diff&&!O&&(!this._options.useTrueInlineDiffRendering.read(k)||!P9(oe.diff))){if(!oe.originalRange.isEmpty){p.read(k);const me=document.createElement("div");me.classList.add("view-lines","line-delete","line-delete-selectable","monaco-mouse-cursor-text");const Oe=this._editors.original.getModel();if(oe.originalRange.endLineNumberExclusive-1>Oe.getLineCount())return{orig:T,mod:R};const it=new U4e(oe.originalRange.mapToLineArray(zi=>Oe.tokenization.getLineTokens(zi)),oe.originalRange.mapToLineArray(zi=>j[F++]),K,U),Xe=[];for(const zi of oe.diff.innerChanges||[])Xe.push(new lC(zi.originalRange.delta(-(oe.diff.original.startLineNumber-1)),N3.className,0));const lt=z4e(it,G,Xe,me),xs=document.createElement("div");if(xs.className="inline-deleted-margin-view-zone",Jn(xs,G.fontInfo),this._options.renderIndicators.read(k))for(let zi=0;zi<lt.heightInLines;zi++){const Rr=document.createElement("div");Rr.className=`delete-sign ${ht.asClassName(Nte)}`,Rr.setAttribute("style",`position:absolute;top:${zi*q}px;width:${G.lineDecorationsWidth}px;height:${q}px;right:0;`),xs.appendChild(Rr)}let nl;x.add(new H4e(()=>JY(nl),xs,me,this._editors.modified,oe.diff,this._diffEditorWidget,lt,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let zi=0;zi<lt.viewLineCounts.length;zi++){const Rr=lt.viewLineCounts[zi];Rr>1&&T.push({afterLineNumber:oe.originalRange.startLineNumber+zi,domNode:v(),heightInPx:(Rr-1)*q,showInHiddenAreas:!0,suppressMouseDown:!0})}R.push({afterLineNumber:oe.modifiedRange.startLineNumber-1,domNode:me,heightInPx:lt.heightInLines*q,minWidthInPx:lt.minWidthInPx,marginDomNode:xs,setZoneId(zi){nl=zi},showInHiddenAreas:!0,suppressMouseDown:!1})}const Se=document.createElement("div");Se.className="gutter-delete",T.push({afterLineNumber:oe.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:oe.modifiedHeightInPx,marginDomNode:Se,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const Se=oe.modifiedHeightInPx-oe.originalHeightInPx;if(Se>0){if(Z!=null&&Z.lineRangeMapping.original.delta(-1).deltaLength(2).contains(oe.originalRange.endLineNumberExclusive-1))continue;T.push({afterLineNumber:oe.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Se,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let me=function(){const it=document.createElement("div");return it.className="arrow-revert-change "+ht.asClassName(xe.arrowRight),k.store.add(J(it,"mousedown",Xe=>Xe.stopPropagation())),k.store.add(J(it,"click",Xe=>{Xe.stopPropagation(),r.revert(oe.diff)})),Ve("div",{},it)};var Q=me;if(Z!=null&&Z.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(oe.modifiedRange.endLineNumberExclusive-1))continue;let Oe;oe.diff&&oe.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(k)&&(Oe=me()),R.push({afterLineNumber:oe.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-Se,marginDomNode:Oe,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const oe of C.read(k)??[]){if(!(Z!=null&&Z.lineRangeMapping.original.intersect(oe.originalRange))||!(Z!=null&&Z.lineRangeMapping.modified.intersect(oe.modifiedRange)))continue;const Se=oe.modifiedHeightInPx-oe.originalHeightInPx;Se>0?T.push({afterLineNumber:oe.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Se,showInHiddenAreas:!0,suppressMouseDown:!0}):R.push({afterLineNumber:oe.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-Se,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:T,mod:R}});let S=!1;this._register(this._editors.original.onDidScrollChange(k=>{k.scrollLeftChanged&&!S&&(S=!0,this._editors.modified.setScrollLeft(k.scrollLeft),S=!1)})),this._register(this._editors.modified.onDidScrollChange(k=>{k.scrollLeftChanged&&!S&&(S=!0,this._editors.original.setScrollLeft(k.scrollLeft),S=!1)})),this._originalScrollTop=mi(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=mi(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(ct(k=>{const E=this._originalScrollTop.read(k)-(this._originalScrollOffsetAnimated.read(void 0)-this._modifiedScrollOffsetAnimated.read(k))-(this._originalTopPadding.read(void 0)-this._modifiedTopPadding.read(k));E!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(E,1)})),this._register(ct(k=>{const E=this._modifiedScrollTop.read(k)-(this._modifiedScrollOffsetAnimated.read(void 0)-this._originalScrollOffsetAnimated.read(k))-(this._modifiedTopPadding.read(void 0)-this._originalTopPadding.read(k));E!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(E,1)})),this._register(ct(k=>{var R;const E=(R=this._diffModel.read(k))==null?void 0:R.movedTextToCompare.read(k);let T=0;if(E){const N=this._editors.original.getTopForLineNumber(E.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.read(void 0);T=this._editors.modified.getTopForLineNumber(E.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.read(void 0)-N}T>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(T,void 0)):T<0?(this._modifiedTopPadding.set(-T,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.read(void 0)-T,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.read(void 0)+T,void 0,!0)}))}};O3=$4e([zq(8,N9),zq(9,Hh)],O3);function Uq(s,e,t,i,n,r){const o=new Rh(jq(s,i)),a=new Rh(jq(e,n)),l=s.getOption(75),c=e.getOption(75),u=[];let d=0,g=0;function p(C,v){for(;;){let x=o.peek(),S=a.peek();if(x&&x.lineNumber>=C&&(x=void 0),S&&S.lineNumber>=v&&(S=void 0),!x&&!S)break;const k=x?x.lineNumber-d:Number.MAX_VALUE,E=S?S.lineNumber-g:Number.MAX_VALUE;k<E?(o.dequeue(),S={lineNumber:x.lineNumber-d+g,heightInPx:0}):k>E?(a.dequeue(),x={lineNumber:S.lineNumber-g+d,heightInPx:0}):(o.dequeue(),a.dequeue()),u.push({originalRange:He.ofLength(x.lineNumber,1),modifiedRange:He.ofLength(S.lineNumber,1),originalHeightInPx:l+x.heightInPx,modifiedHeightInPx:c+S.heightInPx,diff:void 0})}}for(const C of t){let E=function(T,R,N=!1){var F,q;if(T<k||R<S)return;if(x)x=!1;else if(!N&&(T===k||R===S))return;const A=new He(k,T),O=new He(S,R);if(A.isEmpty&&O.isEmpty)return;const W=((F=o.takeWhile(Z=>Z.lineNumber<T))==null?void 0:F.reduce((Z,K)=>Z+K.heightInPx,0))??0,j=((q=a.takeWhile(Z=>Z.lineNumber<R))==null?void 0:q.reduce((Z,K)=>Z+K.heightInPx,0))??0;u.push({originalRange:A,modifiedRange:O,originalHeightInPx:A.length*l+W,modifiedHeightInPx:O.length*c+j,diff:C.lineRangeMapping}),k=T,S=R};var _=E;const v=C.lineRangeMapping;p(v.original.startLineNumber,v.modified.startLineNumber);let x=!0,S=v.modified.startLineNumber,k=v.original.startLineNumber;if(r)for(const T of v.innerChanges||[]){T.originalRange.startColumn>1&&T.modifiedRange.startColumn>1&&E(T.originalRange.startLineNumber,T.modifiedRange.startLineNumber);const R=s.getModel(),N=T.originalRange.endLineNumber<=R.getLineCount()?R.getLineMaxColumn(T.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;T.originalRange.endColumn<N&&E(T.originalRange.endLineNumber,T.modifiedRange.endLineNumber)}E(v.original.endLineNumberExclusive,v.modified.endLineNumberExclusive,!0),d=v.original.endLineNumberExclusive,g=v.modified.endLineNumberExclusive}return p(Number.MAX_VALUE,Number.MAX_VALUE),u}function jq(s,e){const t=[],i=[],n=s.getOption(166).wrappingColumn!==-1,r=s._getViewModel().coordinatesConverter,o=s.getOption(75);if(n)for(let l=1;l<=s.getModel().getLineCount();l++){const c=r.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:o*(c-1)})}for(const l of s.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new Y(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return f4e(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function P9(s){return s.innerChanges?s.innerChanges.every(e=>$q(e.modifiedRange)&&$q(e.originalRange)||e.originalRange.equalsRange(new H(1,1,1,1))):!1}function $q(s){return s.startLineNumber===s.endLineNumber}const FC=class FC extends ne{constructor(e,t,i,n,r){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=r,this._originalScrollTop=mi(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=mi(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=aa("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=Qe(this,0),this._modifiedViewZonesChangedSignal=aa("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=aa("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=Ie(this,u=>{var R;this._element.replaceChildren();const d=this._diffModel.read(u),g=(R=d==null?void 0:d.diff.read(u))==null?void 0:R.movedTexts;if(!g||g.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(u);const p=this._originalEditorLayoutInfo.read(u),_=this._modifiedEditorLayoutInfo.read(u);if(!p||!_){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(u),this._originalViewZonesChangedSignal.read(u);const C=g.map(N=>{function A(G,Q){const le=Q.getTopForLineNumber(G.startLineNumber,!0),ve=Q.getTopForLineNumber(G.endLineNumberExclusive,!0);return(le+ve)/2}const O=A(N.lineRangeMapping.original,this._editors.original),W=this._originalScrollTop.read(u),j=A(N.lineRangeMapping.modified,this._editors.modified),F=this._modifiedScrollTop.read(u),q=O-W,Z=j-F,K=Math.min(O,j),U=Math.max(O,j);return{range:new Re(K,U),from:q,to:Z,fromWithoutScroll:O,toWithoutScroll:j,move:N}});C.sort(xfe(oo(N=>N.fromWithoutScroll>N.toWithoutScroll,Lfe),oo(N=>N.fromWithoutScroll>N.toWithoutScroll?N.fromWithoutScroll:-N.toWithoutScroll,Sh)));const v=F9.compute(C.map(N=>N.range)),x=10,S=p.verticalScrollbarWidth,k=(v.getTrackCount()-1)*10+x*2,E=S+k+(_.contentLeft-FC.movedCodeBlockPadding);let T=0;for(const N of C){const A=v.getTrack(T),O=S+x+A*10,W=15,j=15,F=E,q=_.glyphMarginWidth+_.lineNumbersWidth,Z=18,K=document.createElementNS("http://www.w3.org/2000/svg","rect");K.classList.add("arrow-rectangle"),K.setAttribute("x",`${F-q}`),K.setAttribute("y",`${N.to-Z/2}`),K.setAttribute("width",`${q}`),K.setAttribute("height",`${Z}`),this._element.appendChild(K);const U=document.createElementNS("http://www.w3.org/2000/svg","g"),G=document.createElementNS("http://www.w3.org/2000/svg","path");G.setAttribute("d",`M 0 ${N.from} L ${O} ${N.from} L ${O} ${N.to} L ${F-j} ${N.to}`),G.setAttribute("fill","none"),U.appendChild(G);const Q=document.createElementNS("http://www.w3.org/2000/svg","polygon");Q.classList.add("arrow"),u.store.add(ct(le=>{G.classList.toggle("currentMove",N.move===d.activeMovedText.read(le)),Q.classList.toggle("currentMove",N.move===d.activeMovedText.read(le))})),Q.setAttribute("points",`${F-j},${N.to-W/2} ${F},${N.to} ${F-j},${N.to+W/2}`),U.appendChild(Q),this._element.appendChild(U),T++}this.width.set(k,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(Fe(()=>this._element.remove())),this._register(ct(u=>{const d=this._originalEditorLayoutInfo.read(u),g=this._modifiedEditorLayoutInfo.read(u);!d||!g||(this._element.style.left=`${d.width-d.verticalScrollbarWidth}px`,this._element.style.height=`${d.height}px`,this._element.style.width=`${d.verticalScrollbarWidth+d.contentLeft-FC.movedCodeBlockPadding+this.width.read(u)}px`)})),this._register(nD(this._state));const o=Ie(u=>{const d=this._diffModel.read(u),g=d==null?void 0:d.diff.read(u);return g?g.movedTexts.map(p=>({move:p,original:new Jp(Jw(p.lineRangeMapping.original.startLineNumber-1),18),modified:new Jp(Jw(p.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(kE(this._editors.original,o.map(u=>u.map(d=>d.original)))),this._register(kE(this._editors.modified,o.map(u=>u.map(d=>d.modified)))),this._register($a((u,d)=>{const g=o.read(u);for(const p of g)d.add(new qq(this._editors.original,p.original,p.move,"original",this._diffModel.get())),d.add(new qq(this._editors.modified,p.modified,p.move,"modified",this._diffModel.get()))}));const a=aa("original.onDidFocusEditorWidget",u=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),l=aa("modified.onDidFocusEditorWidget",u=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0)));let c="modified";this._register(H1({changeTracker:{createChangeSummary:()=>{},handleChange:(u,d)=>(u.didChange(a)&&(c="original"),u.didChange(l)&&(c="modified"),!0)}},u=>{a.read(u),l.read(u);const d=this._diffModel.read(u);if(!d)return;const g=d.diff.read(u);let p;if(g&&c==="original"){const _=this._editors.originalCursor.read(u);_&&(p=g.movedTexts.find(C=>C.lineRangeMapping.original.contains(_.lineNumber)))}if(g&&c==="modified"){const _=this._editors.modifiedCursor.read(u);_&&(p=g.movedTexts.find(C=>C.lineRangeMapping.modified.contains(_.lineNumber)))}p!==d.movedTextToCompare.read(void 0)&&d.movedTextToCompare.set(void 0,void 0),d.setActiveMovedText(p)}))}};FC.movedCodeBlockPadding=4;let U_=FC;class F9{static compute(e){const t=[],i=[];for(const n of e){let r=t.findIndex(o=>!o.intersectsStrict(n));r===-1&&(t.length>=6?r=pbe(t,oo(a=>a.intersectWithRangeLength(n),Sh)):(r=t.length,t.push(new X7))),t[r].addRange(n),i.push(r)}return new F9(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class qq extends R9{constructor(e,t,i,n,r){const o=pt("div.diff-hidden-lines-widget");super(e,t,o.root),this._editor=e,this._move=i,this._kind=n,this._diffModel=r,this._nodes=pt("div.diff-moved-code-block",{style:{marginRight:"4px"}},[pt("div.text-content@textContent"),pt("div.action-bar@actionBar")]),o.root.appendChild(this._nodes.root);const a=mi(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(_d(this._nodes.root,{paddingRight:a.map(g=>g.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?w(131,"Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):w(132,"Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?w(133,"Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):w(134,"Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new zl(this._nodes.actionBar,{highlightToggledItems:!0})),u=new Zu("",l,"",!1);c.push(u,{icon:!1,label:!0});const d=new Zu("","Compare",ht.asClassName(xe.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(ct(g=>{const p=this._diffModel.movedTextToCompare.read(g)===i;d.checked=p})),c.push(d,{icon:!1,label:!0})}}class q4e extends ne{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=Ie(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return null;const l=this._diffModel.read(r).movedTextToCompare.read(r),c=this._options.renderIndicators.read(r),u=this._options.showEmptyDecorations.read(r),d=[],g=[];if(!l)for(const _ of a.mappings)if(_.lineRangeMapping.original.isEmpty||d.push({range:_.lineRangeMapping.original.toInclusiveRange(),options:c?Oq:Fq}),_.lineRangeMapping.modified.isEmpty||g.push({range:_.lineRangeMapping.modified.toInclusiveRange(),options:c?Mq:Pq}),_.lineRangeMapping.modified.isEmpty||_.lineRangeMapping.original.isEmpty)_.lineRangeMapping.original.isEmpty||d.push({range:_.lineRangeMapping.original.toInclusiveRange(),options:R4e}),_.lineRangeMapping.modified.isEmpty||g.push({range:_.lineRangeMapping.modified.toInclusiveRange(),options:N4e});else{const C=this._options.useTrueInlineDiffRendering.read(r)&&P9(_.lineRangeMapping);for(const v of _.lineRangeMapping.innerChanges||[])if(_.lineRangeMapping.original.contains(v.originalRange.startLineNumber)&&d.push({range:v.originalRange,options:v.originalRange.isEmpty()&&u?A4e:N3}),_.lineRangeMapping.modified.contains(v.modifiedRange.startLineNumber)&&g.push({range:v.modifiedRange,options:v.modifiedRange.isEmpty()&&u&&!C?I4e:Bq}),C){const x=o.model.original.getValueInRange(v.originalRange);g.push({range:v.modifiedRange,options:{description:"deleted-text",before:{content:x,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const _ of l.changes){const C=_.original.toInclusiveRange();C&&d.push({range:C,options:c?Oq:Fq});const v=_.modified.toInclusiveRange();v&&g.push({range:v,options:c?Mq:Pq});for(const x of _.innerChanges||[])d.push({range:x.originalRange,options:N3}),g.push({range:x.modifiedRange,options:Bq})}const p=this._diffModel.read(r).activeMovedText.read(r);for(const _ of a.movedTexts)d.push({range:_.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(_===p?" currentMove":""),blockPadding:[U_.movedCodeBlockPadding,0,U_.movedCodeBlockPadding,U_.movedCodeBlockPadding]}}),g.push({range:_.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(_===p?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:d,modifiedDecorations:g}}),this._register(LE(this._editors.original,this._decorations.map(r=>(r==null?void 0:r.originalDecorations)||[]))),this._register(LE(this._editors.modified,this._decorations.map(r=>(r==null?void 0:r.modifiedDecorations)||[])))}}class Fa{static equals(e,t){return e.x===t.x&&e.y===t.y}constructor(e,t){this.x=e,this.y=t}add(e){return new Fa(this.x+e.x,this.y+e.y)}deltaX(e){return new Fa(this.x+e,this.y)}deltaY(e){return new Fa(this.x,this.y+e)}toString(){return`(${this.x},${this.y})`}subtract(e){return new Fa(this.x-e.x,this.y-e.y)}scale(e){return new Fa(this.x*e,this.y*e)}mapComponents(e){return new Fa(e(this.x),e(this.y))}isZero(){return this.x===0&&this.y===0}withThreshold(e){return this.mapComponents(t=>t>e?t-e:t<-e?t+e:0)}}function eg(s){return P3.get(s)}const ku=class ku extends ne{static get(e){let t=ku._map.get(e);if(!t){t=new ku(e),ku._map.set(e,t);const i=e.onDidDispose(()=>{const n=ku._map.get(e);n&&(ku._map.delete(e),n.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new Rv(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){var t;super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=Qe(this,this.editor.getModel()),this.model=this._model,this.isReadonly=mi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(104)),this._versionId=nC({owner:this,lazy:!0},((t=this.editor.getModel())==null?void 0:t.getVersionId())??null),this.versionId=this._versionId,this._selections=nC({owner:this,equalsFn:C0(u4(gt.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.positions=Vl({owner:this,equalsFn:C0(u4(Y.equals))},i=>{var n;return((n=this.selections.read(i))==null?void 0:n.map(r=>r.getStartPosition()))??null}),this.isFocused=mi(this,i=>{const n=this.editor.onDidFocusEditorWidget(i),r=this.editor.onDidBlurEditorWidget(i);return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.hasWidgetFocus()),this.isTextFocused=mi(this,i=>{const n=this.editor.onDidFocusEditorText(i),r=this.editor.onDidBlurEditorText(i);return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.hasTextFocus()),this.inComposition=mi(this,i=>{const n=this.editor.onDidCompositionStart(()=>{i(void 0)}),r=this.editor.onDidCompositionEnd(()=>{i(void 0)});return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.inComposition),this.value=M7(this,i=>{var n;return this.versionId.read(i),((n=this.model.read(i))==null?void 0:n.getValue())??""},(i,n)=>{const r=this.model.get();r!==null&&i!==r.getValue()&&r.setValue(i)}),this.valueIsEmpty=Ie(this,i=>{var n;return this.versionId.read(i),((n=this.editor.getModel())==null?void 0:n.getValueLength())===0}),this.cursorSelection=Vl({owner:this,equalsFn:C0(gt.selectionsEqual)},i=>{var n;return((n=this.selections.read(i))==null?void 0:n[0])??null}),this.cursorPosition=Vl({owner:this,equalsFn:Y.equals},i=>{var n,r;return((r=(n=this.selections.read(i))==null?void 0:n[0])==null?void 0:r.getPosition())??null}),this.cursorLineNumber=Ie(this,i=>{var n;return((n=this.cursorPosition.read(i))==null?void 0:n.lineNumber)??null}),this.onDidType=Uw(this),this.onDidPaste=Uw(this),this.scrollTop=mi(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=mi(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=mi(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(i=>i.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(i=>i.decorationsLeft),this.layoutInfoWidth=this.layoutInfo.map(i=>i.width),this.layoutInfoHeight=this.layoutInfo.map(i=>i.height),this.layoutInfoMinimap=this.layoutInfo.map(i=>i.minimap),this.layoutInfoVerticalScrollbarWidth=this.layoutInfo.map(i=>i.verticalScrollbarWidth),this.contentWidth=mi(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this.contentHeight=mi(this.editor.onDidContentSizeChange,()=>this.editor.getContentHeight()),this._widgetCounter=0,this.openedPeekWidgets=Qe(this,0),this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidPaste(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidPaste.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{var n;this._beginUpdate();try{this._versionId.set(((n=this.editor.getModel())==null?void 0:n.getVersionId())??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this.domNode=Ie(i=>(this.model.read(i),this.editor.getDomNode()))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){var e;this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(((e=this.editor.getModel())==null?void 0:e.getVersionId())??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e,t=hs.ofCaller()){return mi(this,i=>this.editor.onDidChangeConfiguration(n=>{n.hasChanged(e)&&i(void 0)}),()=>this.editor.getOption(e),t)}setDecorations(e){const t=new Ee,i=this.editor.createDecorationsCollection();return t.add(O7({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._widgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const n=ct(r=>{e.position.read(r),e.minContentWidthInPx.read(r),this.editor.layoutOverlayWidget(i)});return Fe(()=>{n.dispose(),this.editor.removeOverlayWidget(i)})}createContentWidget(e){const t="observableContentWidget"+this._widgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow};this.editor.addContentWidget(i);const n=ct(r=>{e.position.read(r),this.editor.layoutContentWidget(i)});return Fe(()=>{n.dispose(),this.editor.removeContentWidget(i)})}observeLineOffsetRange(e,t){const i=this.observePosition(e.map(r=>new Y(r.startLineNumber,1)),t),n=this.observePosition(e.map(r=>new Y(r.endLineNumberExclusive+1,1)),t);return Ie(r=>{var u;i.read(r),n.read(r);const o=e.read(r),a=(u=this.model.read(r))==null?void 0:u.getLineCount(),l=(typeof a<"u"&&o.startLineNumber>a?this.editor.getBottomForLineNumber(a):this.editor.getTopForLineNumber(o.startLineNumber))-this.scrollTop.read(r),c=o.isEmpty?l:this.editor.getBottomForLineNumber(o.endLineNumberExclusive-1)-this.scrollTop.read(r);return new Re(l,c)})}observePosition(e,t){let i=e.get();const n=nC({owner:this,debugName:()=>`topLeftOfPosition${i==null?void 0:i.toString()}`,equalsFn:C0(Fa.equals)},new Fa(0,0)),r="observablePositionWidget"+this._widgetCounter++,o=document.createElement("div"),a={getDomNode:()=>o,getPosition:()=>i?{preference:[0],position:e.get()}:null,getId:()=>r,allowEditorOverflow:!1,afterRender:(l,c)=>{const u=this._model.get();u&&i&&i.lineNumber>u.getLineCount()?n.set(new Fa(0,this.editor.getBottomForLineNumber(u.getLineCount())-this.scrollTop.get()),void 0):n.set(c?new Fa(c.left,c.top):null,void 0)}};return this.editor.addContentWidget(a),t.add(ct(l=>{i=e.read(l),this.editor.layoutContentWidget(a)})),t.add(Fe(()=>{this.editor.removeContentWidget(a)})),n}isTargetHovered(e,t){const i=Qe("isInjectedTextHovered",!1);return t.add(this.editor.onMouseMove(n=>{const r=e(n);i.set(r,void 0)})),t.add(this.editor.onMouseLeave(n=>{i.set(!1,void 0)})),i}observeLineHeightForPosition(e){return Ie(t=>{const i=e instanceof Y?e:e.read(t);return i===null?null:(this.getOption(75).read(t),this.editor.getLineHeightForPosition(i))})}observeLineHeightForLine(e){return typeof e=="number"?this.observeLineHeightForPosition(new Y(e,1)):Ie(t=>{const i=e.read(t);return i===null?null:this.observeLineHeightForPosition(new Y(i,1)).read(t)})}observeLineHeightsForLineRange(e){return Ie(t=>{const i=e instanceof He?e:e.read(t),n=[];for(let r=i.startLineNumber;r<i.endLineNumberExclusive;r++)n.push(this.observeLineHeightForLine(r).read(t));return n})}};ku._map=new Map;let P3=ku;var G4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},K4e=function(s,e){return function(t,i){e(t,i,s)}},Da,wh;let hv=(wh=class extends ne{constructor(e,t,i,n,r,o,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=n,this._rootHeight=r,this._modifiedEditorLayoutInfo=o,this._themeService=a,this.width=Da.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=mi(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=Ie(g=>{const p=l.read(g),_=p.getColor(pCe)||(p.getColor(gCe)||K4).transparent(2),C=p.getColor(_Ce)||(p.getColor(mCe)||Y4).transparent(2);return{insertColor:_,removeColor:C}}),u=bt(document.createElement("div"));u.setClassName("diffViewport"),u.setPosition("absolute");const d=pt("div.diffOverview",{style:{position:"absolute",top:"0px",width:Da.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(T0(d,u.domNode)),this._register(Xn(d,pe.POINTER_DOWN,g=>{this._editors.modified.delegateVerticalScrollbarPointerDown(g)})),this._register(J(d,pe.MOUSE_WHEEL,g=>{this._editors.modified.delegateScrollFromMouseWheelEvent(g)},{passive:!1})),this._register(T0(this._rootElement,d)),this._register($a((g,p)=>{const _=this._diffModel.read(g),C=this._editors.original.createOverviewRuler("original diffOverviewRuler");C&&(p.add(C),p.add(T0(d,C.getDomNode())));const v=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(v&&(p.add(v),p.add(T0(d,v.getDomNode()))),!C||!v)return;const x=aa("viewZoneChanged",this._editors.original.onDidChangeViewZones),S=aa("viewZoneChanged",this._editors.modified.onDidChangeViewZones),k=aa("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),E=aa("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);p.add(ct(T=>{var j;x.read(T),S.read(T),k.read(T),E.read(T);const R=c.read(T),N=(j=_==null?void 0:_.diff.read(T))==null?void 0:j.mappings;function A(F,q,Z){const K=Z._getViewModel();return K?F.filter(U=>U.length>0).map(U=>{const G=K.coordinatesConverter.convertModelPositionToViewPosition(new Y(U.startLineNumber,1)),Q=K.coordinatesConverter.convertModelPositionToViewPosition(new Y(U.endLineNumberExclusive,1)),le=Q.lineNumber-G.lineNumber;return new KZ(G.lineNumber,Q.lineNumber,le,q.toString())}):[]}const O=A((N||[]).map(F=>F.lineRangeMapping.original),R.removeColor,this._editors.original),W=A((N||[]).map(F=>F.lineRangeMapping.modified),R.insertColor,this._editors.modified);C==null||C.setZones(O),v==null||v.setZones(W)})),p.add(ct(T=>{const R=this._rootHeight.read(T),N=this._rootWidth.read(T),A=this._modifiedEditorLayoutInfo.read(T);if(A){const O=Da.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Da.ONE_OVERVIEW_WIDTH;C.setLayout({top:0,height:R,right:O+Da.ONE_OVERVIEW_WIDTH,width:Da.ONE_OVERVIEW_WIDTH}),v.setLayout({top:0,height:R,right:0,width:Da.ONE_OVERVIEW_WIDTH});const W=this._editors.modifiedScrollTop.read(T),j=this._editors.modifiedScrollHeight.read(T),F=this._editors.modified.getOption(117),q=new v1(F.verticalHasArrows?F.arrowSize:0,F.verticalScrollbarSize,0,A.height,j,W);u.setTop(q.getSliderPosition()),u.setHeight(q.getSliderSize())}else u.setTop(0),u.setHeight(0);d.style.height=R+"px",d.style.left=N-Da.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",u.setWidth(Da.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}},Da=wh,wh.ONE_OVERVIEW_WIDTH=15,wh.ENTIRE_DIFF_OVERVIEW_WIDTH=wh.ONE_OVERVIEW_WIDTH*2,wh);hv=Da=G4e([K4e(6,Ir)],hv);var Y4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},cA=function(s,e){return function(t,i){e(t,i,s)}};let F3=class extends ne{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,n,r,o,a,l){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=n,this._createInnerEditor=r,this._contextKeyService=o,this._instantiationService=a,this._keybindingService=l,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new $),this.modifiedScrollTop=mi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=mi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=eg(this.modified),this.originalObs=eg(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=mi(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=Vl({owner:this,equalsFn:Y.equals},c=>{var u;return((u=this.modifiedSelections.read(c)[0])==null?void 0:u.getPosition())??new Y(1,1)}),this.originalCursor=mi(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new Y(1,1)),this.isOriginalFocused=eg(this.original).isFocused,this.isModifiedFocused=eg(this.modified).isFocused,this.isFocused=Ie(this,c=>this.isOriginalFocused.read(c)||this.isModifiedFocused.read(c)),this._argCodeEditorWidgetOptions=null,this._register(H1({changeTracker:{createChangeSummary:()=>({}),handleChange:(c,u)=>(c.didChange(i.editorOptions)&&Object.assign(u,c.change.changedOptions),!0)}},(c,u)=>{i.editorOptions.read(c),this._options.renderSideBySide.read(c),this.modified.updateOptions(this._adjustOptionsForRightHandSide(c,u)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(c,u))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t),r=this._contextKeyService.createKey("isInDiffLeftEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget(()=>r.set(!0))),this._register(n.onDidBlurEditorWidget(()=>r.set(!1))),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t),r=this._contextKeyService.createKey("isInDiffRightEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget(()=>r.set(!0))),this._register(n.onDidBlurEditorWidget(()=>r.set(!1))),n}_constructInnerEditor(e,t,i,n){const r=this._createInnerEditor(e,t,i,n);return this._register(r.onDidContentSizeChange(o=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+hv.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:o.contentHeightChanged,contentWidthChanged:o.contentWidthChanged})})),r}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Kr.revealHorizontalRightPadding.defaultValue+hv.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.allowVariableLineHeights=!1,t.allowVariableFonts=!1,t.allowVariableFontsInAccessibilityMode=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var i;e||(e="");const t=w(111," use {0} to open the accessibility help.",(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))==null?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};F3=Y4e([cA(5,St),cA(6,wt),cA(7,Bn)],F3);class Q4e{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=M7(this,i=>{const n=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(n,i)},(i,n)=>{const r=this.dimensions.width.get();this._sashRatio.set(i/r,n)}),this._sashRatio=Qe(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,o=100;return i<=o*2?n:r<o?o:r>i-o?i-o:r}}class Mte extends ne{constructor(e,t,i,n,r,o){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=n,this.sashLeft=r,this._resetSash=o,this._sash=this._register(new ko(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(ct(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register(ct(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}const y2=class y2 extends ne{constructor(){super(...arguments),this._id=++y2.idCounter,this._onDidDispose=this._register(new $),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};y2.idCounter=0;let B3=y2;function X4e(s,e){return Npe(s,(t,i)=>i??e(t))}var Z4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},J4e=function(s,e){return function(t,i){e(t,i,s)}};let V3=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=Qe(this,0),this._screenReaderMode=mi(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=Ie(this,n=>this._options.read(n).renderSideBySide&&this._diffEditorWidth.read(n)<=this._options.read(n).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=Ie(this,n=>this._options.read(n).renderOverviewRuler),this.renderSideBySide=Ie(this,n=>this.compactMode.read(n)&&this.shouldRenderInlineViewInSmartMode.read(n)?!1:this._options.read(n).renderSideBySide&&!(this._options.read(n).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(n)&&!this._screenReaderMode.read(n))),this.readOnly=Ie(this,n=>this._options.read(n).readOnly),this.shouldRenderOldRevertArrows=Ie(this,n=>!(!this._options.read(n).renderMarginRevertIcon||!this.renderSideBySide.read(n)||this.readOnly.read(n)||this.shouldRenderGutterMenu.read(n))),this.shouldRenderGutterMenu=Ie(this,n=>this._options.read(n).renderGutterMenu),this.renderIndicators=Ie(this,n=>this._options.read(n).renderIndicators),this.enableSplitViewResizing=Ie(this,n=>this._options.read(n).enableSplitViewResizing),this.splitViewDefaultRatio=Ie(this,n=>this._options.read(n).splitViewDefaultRatio),this.ignoreTrimWhitespace=Ie(this,n=>this._options.read(n).ignoreTrimWhitespace),this.maxComputationTimeMs=Ie(this,n=>this._options.read(n).maxComputationTime),this.showMoves=Ie(this,n=>this._options.read(n).experimental.showMoves&&this.renderSideBySide.read(n)),this.isInEmbeddedEditor=Ie(this,n=>this._options.read(n).isInEmbeddedEditor),this.diffWordWrap=Ie(this,n=>this._options.read(n).diffWordWrap),this.originalEditable=Ie(this,n=>this._options.read(n).originalEditable),this.diffCodeLens=Ie(this,n=>this._options.read(n).diffCodeLens),this.accessibilityVerbose=Ie(this,n=>this._options.read(n).accessibilityVerbose),this.diffAlgorithm=Ie(this,n=>this._options.read(n).diffAlgorithm),this.showEmptyDecorations=Ie(this,n=>this._options.read(n).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=Ie(this,n=>this._options.read(n).onlyShowAccessibleDiffViewer),this.compactMode=Ie(this,n=>this._options.read(n).compactMode),this.trueInlineDiffRenderingEnabled=Ie(this,n=>this._options.read(n).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=Ie(this,n=>!this.renderSideBySide.read(n)&&this.trueInlineDiffRenderingEnabled.read(n)),this.hideUnchangedRegions=Ie(this,n=>this._options.read(n).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=Ie(this,n=>this._options.read(n).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=Ie(this,n=>this._options.read(n).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=Ie(this,n=>this._options.read(n).hideUnchangedRegions.minimumLineCount),this._model=Qe(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,n=>X4e(this,r=>{const o=n==null?void 0:n.diff.read(r);return o?e5e(o,this.trueInlineDiffRenderingEnabled.read(r)):void 0})).flatten().map(this,n=>!!n),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...Gq(e,Un)};this._options=Qe(this,i)}updateOptions(e){const t=Gq(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};V3=Z4e([J4e(1,uo)],V3);function e5e(s,e){return s.mappings.every(t=>t5e(t.lineRangeMapping)||i5e(t.lineRangeMapping)||e&&P9(t.lineRangeMapping))}function t5e(s){return s.original.length===0}function i5e(s){return s.modified.length===0}function Gq(s,e){var t,i,n,r,o,a,l,c;return{enableSplitViewResizing:Le(s.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:cge(s.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:Le(s.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:Le(s.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:th(s.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:th(s.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:Le(s.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:Le(s.renderIndicators,e.renderIndicators),originalEditable:Le(s.originalEditable,e.originalEditable),diffCodeLens:Le(s.diffCodeLens,e.diffCodeLens),renderOverviewRuler:Le(s.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:Xt(s.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:Xt(s.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:Le(s.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:Le((t=s.experimental)==null?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:Le((i=s.experimental)==null?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:Le((n=s.experimental)==null?void 0:n.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:Le(((r=s.hideUnchangedRegions)==null?void 0:r.enabled)??((o=s.experimental)==null?void 0:o.collapseUnchangedRegions),e.hideUnchangedRegions.enabled),contextLineCount:th((a=s.hideUnchangedRegions)==null?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:th((l=s.hideUnchangedRegions)==null?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:th((c=s.hideUnchangedRegions)==null?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:Le(s.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:Le(s.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:th(s.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:Le(s.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:Le(s.renderGutterMenu,e.renderGutterMenu),compactMode:Le(s.compactMode,e.compactMode)}}const Kq=24;class n5e extends ne{get onDidChangeDropdownVisibility(){return this._onDidChangeDropdownVisibility.event}constructor(e,t,i={orientation:0}){if(super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new tge),this.originalPrimaryActions=[],this.originalSecondaryActions=[],this.hiddenActions=[],this.disposables=this._register(new Ee),i.hoverDelegate=i.hoverDelegate??this._register(Tee()),this.options=i,this.toggleMenuAction=this._register(new uv(()=>{var n;return(n=this.toggleMenuActionViewItem)==null?void 0:n.show()},i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new zl(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,r)=>{if(n.id===uv.ID)return this.toggleMenuActionViewItem=new rE(n,{getActions:()=>this.toggleMenuAction.menuActions},t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:ht.asClassNameArray(i.moreIcon??xe.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const o=i.actionViewItemProvider(n,r);if(o)return o}if(n instanceof aD){const o=new rE(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return o.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(o),this.disposables.add(this._onDidChangeDropdownVisibility.add(o.onDidChangeVisibility)),o}}})),this.options.responsive){this.element.classList.add("responsive");const n=new ResizeObserver(()=>{this.setToolbarMaxWidth(this.element.getBoundingClientRect().width)});n.observe(this.element),this._store.add(Fe(()=>n.disconnect()))}}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){var t;this.actionBar.context=e,(t=this.toggleMenuActionViewItem)==null||t.setActionContext(e);for(const i of this.submenuActionViewItems)i.setActionContext(e)}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}setActions(e,t){this.clear(),this.originalPrimaryActions=e?e.slice(0):[],this.originalSecondaryActions=t?t.slice(0):[];const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.length>0&&this.options.trailingSeparator&&i.push(new On),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})}),this.options.responsive&&(this.hiddenActions.length=0,this.setToolbarMaxWidth(this.element.getBoundingClientRect().width))}getKeybindingLabel(e){var i,n;const t=(n=(i=this.options).getKeyBinding)==null?void 0:n.call(i,e);return(t==null?void 0:t.getLabel())??void 0}getItemsWidthResponsive(){return this.actionBar.length()*Kq}setToolbarMaxWidth(e){if(this.actionBar.isEmpty()||this.getItemsWidthResponsive()<=e&&this.hiddenActions.length===0)return;if(this.getItemsWidthResponsive()>e)for(;this.getItemsWidthResponsive()>e&&this.actionBar.length()>0;){const i=this.originalPrimaryActions.length-this.hiddenActions.length-1;if(i<0)break;const n=Math.min(Kq,this.getItemWidth(i)),r=this.originalPrimaryActions[i];this.hiddenActions.unshift({action:r,size:n}),this.actionBar.pull(i),this.originalSecondaryActions.length===0&&this.hiddenActions.length===1&&this.actionBar.push(this.toggleMenuAction,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(this.toggleMenuAction)})}else for(;this.hiddenActions.length>0;){const i=this.hiddenActions.shift();if(this.getItemsWidthResponsive()+i.size>e){this.hiddenActions.unshift(i);break}this.actionBar.push(i.action,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i.action),index:this.originalPrimaryActions.length-this.hiddenActions.length-1}),this.originalSecondaryActions.length===0&&this.hiddenActions.length===1&&(this.toggleMenuAction.menuActions=[],this.actionBar.pull(this.actionBar.length()-1))}const t=this.hiddenActions.map(i=>i.action);if(this.originalSecondaryActions.length>0||t.length>0){const i=this.originalSecondaryActions.slice(0);this.toggleMenuAction.menuActions=On.join(t,i)}}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}const S2=class S2 extends Zu{constructor(e,t){t=t||w(17,"More Actions..."),super(S2.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};S2.ID="toolbar.toggle.more";let uv=S2;const Ote=tt("IActionViewItemService");class s5e{constructor(){this._providers=new Map,this._onDidChange=new $,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}lookUp(e,t){return this._providers.get(this._makeKey(e,t))}_makeKey(e,t){return`${e.id}/${t instanceof rn?t.id:t}`}}ut(Ote,s5e,1);var Pte=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Gr=function(s,e){return function(t,i){e(t,i,s)}};let W3=class extends n5e{constructor(e,t,i,n,r,o,a,l){super(e,r,{getKeyBinding:u=>o.lookupKeybinding(u.id)??void 0,...t,allowContextMenu:!0,skipTelemetry:typeof(t==null?void 0:t.telemetrySource)=="string"}),this._options=t,this._menuService=i,this._contextKeyService=n,this._contextMenuService=r,this._keybindingService=o,this._commandService=a,this._sessionDisposables=this._store.add(new Ee);const c=t==null?void 0:t.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>l.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}setActions(e,t=[],i){var u,d,g;this._sessionDisposables.clear();const n=e.slice(),r=t.slice(),o=[];let a=0;const l=[];let c=!1;if(((u=this._options)==null?void 0:u.hiddenItemStrategy)!==-1)for(let p=0;p<n.length;p++){const _=n[p];!(_ instanceof Lh)&&!(_ instanceof x_)||_.hideActions&&(o.push(_.hideActions.toggle),_.hideActions.toggle.checked&&a++,_.hideActions.isHidden&&(c=!0,n[p]=void 0,((d=this._options)==null?void 0:d.hiddenItemStrategy)!==0&&(l[p]=_)))}if(((g=this._options)==null?void 0:g.overflowBehavior)!==void 0){const p=LJ(new Set(this._options.overflowBehavior.exempted),_t.map(n,v=>v==null?void 0:v.id)),_=this._options.overflowBehavior.maxItems-p.size;let C=0;for(let v=0;v<n.length;v++){const x=n[v];x&&(C++,!p.has(x.id)&&C>=_&&(n[v]=void 0,l[v]=x))}}uH(n),uH(l),super.setActions(n,On.join(l,r)),(o.length>0||n.length>0)&&this._sessionDisposables.add(J(this.getElement(),"contextmenu",p=>{var S,k,E,T,R;const _=new io(Ae(this.getElement()),p),C=this.getItemAction(_.target);if(!C)return;_.preventDefault(),_.stopPropagation();const v=[];if(C instanceof Lh&&C.menuKeybinding)v.push(C.menuKeybinding);else if(!(C instanceof x_||C instanceof uv)){const N=!!this._keybindingService.lookupKeybinding(C.id);v.push(Ete(this._commandService,this._keybindingService,C.id,void 0,N))}if(o.length>0){let N=!1;if(a===1&&((S=this._options)==null?void 0:S.hiddenItemStrategy)===0){N=!0;for(let A=0;A<o.length;A++)if(o[A].checked){o[A]=sg({id:C.id,label:C.label,checked:!0,enabled:!1,run(){}});break}}if(!N&&(C instanceof Lh||C instanceof x_)){if(!C.hideActions)return;v.push(C.hideActions.hide)}else v.push(sg({id:"label",label:w(1649,"Hide"),enabled:!1,run(){}}))}const x=On.join(v,o);(k=this._options)!=null&&k.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(x.push(new On),x.push(sg({id:"resetThisMenu",label:w(1650,"Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),x.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>_,getActions:()=>x,menuId:(E=this._options)==null?void 0:E.contextMenu,menuActionOptions:{renderShortTitle:!0,...(T=this._options)==null?void 0:T.menuOptions},skipTelemetry:typeof((R=this._options)==null?void 0:R.telemetrySource)=="string",contextKeyService:this._contextKeyService})}))}};W3=Pte([Gr(2,cm),Gr(3,St),Gr(4,Hh),Gr(5,Bn),Gr(6,ho),Gr(7,Bh)],W3);let DE=class extends W3{get onDidChangeMenuItems(){return this._onDidChangeMenuItems.event}constructor(e,t,i,n,r,o,a,l,c,u,d){super(e,{resetMenu:t,...i,actionViewItemProvider:(_,C)=>{let v=u.lookUp(t,_ instanceof x_?_.item.submenu.id:_.id);v||(v=i==null?void 0:i.actionViewItemProvider);const x=v==null?void 0:v(_,C,d,Ae(e).vscodeWindowId);return x||Hee(d,_,C)}},n,r,o,a,l,c),this._onDidChangeMenuItems=this._store.add(new $);const g=this._store.add(n.createMenu(t,r,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:i==null?void 0:i.eventDebounceDelay})),p=()=>{var v,x,S;const{primary:_,secondary:C}=VIe(g.getActions(i==null?void 0:i.menuOptions),(v=i==null?void 0:i.toolbarOptions)==null?void 0:v.primaryGroup,(x=i==null?void 0:i.toolbarOptions)==null?void 0:x.shouldInlineSubmenu,(S=i==null?void 0:i.toolbarOptions)==null?void 0:S.useSeparatorsInPrimaryActions);e.classList.toggle("has-no-actions",_.length===0&&C.length===0),super.setActions(_,C)};this._store.add(g.onDidChange(()=>{p(),this._onDidChangeMenuItems.fire(this)})),this._store.add(u.onDidChange(_=>{_===t&&p()})),p()}setActions(){throw new Pe("This toolbar is populated from a menu.")}};DE=Pte([Gr(3,cm),Gr(4,St),Gr(5,Hh),Gr(6,Bn),Gr(7,ho),Gr(8,Bh),Gr(9,Ote),Gr(10,wt)],DE);class Yq extends Z7{constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}getLineLength(e){return this._textModel.getLineLength(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new Dr(e-1,t)}}class Fte extends Hg{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class r5e extends ne{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=mi(this,this._editor.onDidScrollChange,o=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(o=>o===0),this.modelAttached=mi(this,this._editor.onDidChangeModel,o=>this._editor.hasModel()),this.editorOnDidChangeViewZones=aa("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=aa("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=Uw("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const n=this._domNode.appendChild(pt("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),r=new ResizeObserver(()=>{Vi(o=>{this.domNodeSizeChanged.trigger(o)})});r.observe(this._domNode),this._register(Fe(()=>r.disconnect())),this._register(ct(o=>{n.className=this.isScrollTopZero.read(o)?"":"scroll-decoration"})),this._register(ct(o=>this.render(o)))}dispose(){super.dispose(),as(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),n=new Set(this.views.keys()),r=Re.ofStartAndLength(0,this._domNode.clientHeight);if(!r.isEmpty)for(const o of i){const a=new He(o.startLineNumber,o.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);Vi(c=>{for(const u of l){if(!u.range.intersect(a))continue;n.delete(u.id);let d=this.views.get(u.id);if(d)d.item.set(u,c);else{const C=document.createElement("div");this._domNode.appendChild(C);const v=Qe("item",u),x=this.itemProvider.createView(v,C);d=new o5e(v,x,C),this.views.set(u.id,d)}const g=u.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(u.range.startLineNumber,!0)-t:u.range.startLineNumber>1?this._editor.getBottomForLineNumber(u.range.startLineNumber-1,!1)-t:0,_=(u.range.endLineNumberExclusive===1?Math.max(g,this._editor.getTopForLineNumber(u.range.startLineNumber,!1)-t):Math.max(g,this._editor.getBottomForLineNumber(u.range.endLineNumberExclusive-1,!0)-t))-g;d.domNode.style.top=`${g}px`,d.domNode.style.height=`${_}px`,d.gutterItemView.layout(Re.ofStartAndLength(g,_),r)}})}for(const o of n){const a=this.views.get(o);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(o)}}}class o5e{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}var Bte=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},rL=function(s,e){return function(t,i){e(t,i,s)}};const hA=[],kx=35;let H3=class extends ne{constructor(e,t,i,n,r,o,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=n,this._sashLayout=r,this._boundarySashes=o,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(rn.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=mi(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(d=>d.length>0),this._showSash=Ie(this,d=>this._options.renderSideBySide.read(d)&&this._hasActions.read(d)),this.width=Ie(this,d=>this._hasActions.read(d)?kx:0),this.elements=pt("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:kx+"px"}},[]),this._currentDiff=Ie(this,d=>{var C;const g=this._diffModel.read(d);if(!g)return;const p=(C=g.diff.read(d))==null?void 0:C.mappings,_=this._editors.modifiedCursor.read(d);if(_)return p==null?void 0:p.find(v=>v.lineRangeMapping.modified.contains(_.lineNumber))}),this._selectedDiffs=Ie(this,d=>{const g=this._diffModel.read(d),p=g==null?void 0:g.diff.read(d);if(!p)return hA;const _=this._editors.modifiedSelections.read(d);if(_.every(S=>S.isEmpty()))return hA;const C=new Ao(_.map(S=>He.fromRangeInclusive(S))),x=p.mappings.filter(S=>S.lineRangeMapping.innerChanges&&C.intersects(S.lineRangeMapping.modified)).map(S=>({mapping:S,rangeMappings:S.lineRangeMapping.innerChanges.filter(k=>_.some(E=>H.areIntersecting(k.modifiedRange,E)))}));return x.length===0||x.every(S=>S.rangeMappings.length===0)?hA:x}),this._register(g4e(e,this.elements.root)),this._register(J(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(_d(this.elements.root,{display:this._hasActions.map(d=>d?"block":"none")})),Cl(this,d=>this._showSash.read(d)?new Mte(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,M7(this,p=>this._sashLayout.sashLeft.read(p)-kx,(p,_)=>this._sashLayout.sashLeft.set(p+kx,_)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);const u=Ie(this,d=>{const g=this._diffModel.read(d);if(!g)return[];const p=g.diff.read(d);if(!p)return[];const _=this._selectedDiffs.read(d);if(_.length>0){const v=ao.fromRangeMappings(_.flatMap(x=>x.rangeMappings));return[new Qq(v,!0,rn.DiffEditorSelectionToolbar,void 0,g.model.original.uri,g.model.modified.uri)]}const C=this._currentDiff.read(d);return p.mappings.map(v=>new Qq(v.lineRangeMapping.withInnerChangesFromLineRanges(),v.lineRangeMapping===(C==null?void 0:C.lineRangeMapping),rn.DiffEditorHunkToolbar,void 0,g.model.original.uri,g.model.modified.uri))});this._register(new r5e(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(d,g)=>u.read(g),createView:(d,g)=>this._instantiationService.createInstance(z3,d,g,this)})),this._register(J(this.elements.gutter,pe.MOUSE_WHEEL,d=>{this._editors.modified.getOption(117).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(d)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new Yq(this._editors.modifiedModel.get()),n=new Yq(this._editors.original.getModel());return new xw(t.map(a=>a.toTextEdit(i))).apply(n)}layout(e){this.elements.gutter.style.left=e+"px"}};H3=Bte([rL(6,wt),rL(7,St),rL(8,cm)],H3);class Qq{constructor(e,t,i,n,r,o){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=n,this.originalUri=r,this.modifiedUri=o}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let z3=class extends ne{constructor(e,t,i,n){super(),this._item=e,this._elements=pt("div.gutterItem",{style:{height:"20px",width:"34px"}},[pt("div.background@background",{},[]),pt("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,o=>o.showAlways),this._menuId=this._item.map(this,o=>o.menuId),this._isSmall=Qe(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const r=this._register(n.createInstance(qw,"element",{instantHover:!0},{position:{hoverPosition:1}}));this._register(T0(t,this._elements.root)),this._register(ct(o=>{const a=this._showAlways.read(o);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register($a((o,a)=>{this._elements.buttons.replaceChildren();const l=a.add(n.createInstance(DE,this._elements.buttons,this._menuId.read(o),{orientation:1,hoverDelegate:r,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(o)?1:3},hiddenItemStrategy:0,actionRunner:a.add(new Fte(()=>{const c=this._item.read(void 0),u=c.mapping;return{mapping:u,originalWithModifiedChanges:i.computeStagedValue(u),originalUri:c.originalUri,modifiedUri:c.modifiedUri}})),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const n=e.length/2-i/2,r=i;let o=e.start+n;const a=Re.tryCreate(r,t.endExclusive-r-i),l=Re.tryCreate(e.start+r,e.endExclusive-i-r);l&&a&&l.start<l.endExclusive&&(o=a.clip(o),o=l.clip(o)),this._elements.buttons.style.top=`${o-e.start}px`}};z3=Bte([rL(3,wt)],z3);var a5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},l5e=function(s,e){return function(t,i){e(t,i,s)}},U3,nd;let j3=(nd=class extends ne{static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=n,this._modifiedOutlineSource=Cl(this,l=>{const c=this._editors.modifiedModel.read(l),u=U3._breadcrumbsSourceFactory.read(l);return!c||!u?void 0:u(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();Vi(u=>{for(const d of this._editors.original.getSelections()||[])c==null||c.ensureOriginalLineIsVisible(d.getStartPosition().lineNumber,0,u),c==null||c.ensureOriginalLineIsVisible(d.getEndPosition().lineNumber,0,u)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();Vi(u=>{for(const d of this._editors.modified.getSelections()||[])c==null||c.ensureModifiedLineIsVisible(d.getStartPosition().lineNumber,0,u),c==null||c.ensureModifiedLineIsVisible(d.getEndPosition().lineNumber,0,u)})}));const r=this._diffModel.map((l,c)=>{var d;const u=(l==null?void 0:l.unchangedRegions.read(c))??[];return u.length===1&&u[0].modifiedLineNumber===1&&u[0].lineCount===((d=this._editors.modifiedModel.read(c))==null?void 0:d.getLineCount())?[]:u});this.viewZones=Ie(this,l=>{const c=this._modifiedOutlineSource.read(l);if(!c)return{origViewZones:[],modViewZones:[]};const u=[],d=[],g=this._options.renderSideBySide.read(l),p=this._options.compactMode.read(l),_=r.read(l);for(let C=0;C<_.length;C++){const v=_[C];if(!v.shouldHideControls(l)&&!(p&&(C===0||C===_.length-1)))if(p){{const x=Ie(this,k=>v.getHiddenOriginalRange(k).startLineNumber-1),S=new Jp(x,12);u.push(S),l.store.add(new Xq(this._editors.original,S,v,!g))}{const x=Ie(this,k=>v.getHiddenModifiedRange(k).startLineNumber-1),S=new Jp(x,12);d.push(S),l.store.add(new Xq(this._editors.modified,S,v))}}else{{const x=Ie(this,k=>v.getHiddenOriginalRange(k).startLineNumber-1),S=new Jp(x,24);u.push(S),l.store.add(new Zq(this._editors.original,S,v,v.originalUnchangedRange,!g,c,k=>this._diffModel.get().ensureModifiedLineIsVisible(k,2,void 0),this._options))}{const x=Ie(this,k=>v.getHiddenModifiedRange(k).startLineNumber-1),S=new Jp(x,24);d.push(S),l.store.add(new Zq(this._editors.modified,S,v,v.modifiedUnchangedRange,!1,c,k=>this._diffModel.get().ensureModifiedLineIsVisible(k,2,void 0),this._options))}}}return{origViewZones:u,modViewZones:d}});const o={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new JJ(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(w(124,"Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+ht.asClassName(xe.fold),zIndex:10001};this._register(LE(this._editors.original,Ie(this,l=>{const c=r.read(l),u=c.map(d=>({range:d.originalUnchangedRange.toInclusiveRange(),options:o}));for(const d of c)d.shouldHideControls(l)&&u.push({range:H.fromPositions(new Y(d.originalLineNumber,1)),options:a});return u}))),this._register(LE(this._editors.modified,Ie(this,l=>{const c=r.read(l),u=c.map(d=>({range:d.modifiedUnchangedRange.toInclusiveRange(),options:o}));for(const d of c)d.shouldHideControls(l)&&u.push({range:He.ofLength(d.modifiedLineNumber,1).toInclusiveRange(),options:a});return u}))),this._register(ct(l=>{const c=r.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(u=>u.getHiddenOriginalRange(l).toInclusiveRange()).filter(Io)),this._editors.modified.setHiddenAreas(c.map(u=>u.getHiddenModifiedRange(l).toInclusiveRange()).filter(Io))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const u=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const g=d.unchangedRegions.get().find(p=>p.modifiedUnchangedRange.contains(u));if(!g)return;g.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const u=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const g=d.unchangedRegions.get().find(p=>p.originalUnchangedRange.contains(u));if(!g)return;g.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}},U3=nd,nd._breadcrumbsSourceFactory=Qe(nd,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}})),nd);j3=U3=a5e([l5e(3,wt)],j3);class Xq extends R9{constructor(e,t,i,n=!1){const r=pt("div.diff-hidden-lines-widget");super(e,t,r.root),this._unchangedRegion=i,this._hide=n,this._nodes=pt("div.diff-hidden-lines-compact",[pt("div.line-left",[]),pt("div.text@text",[]),pt("div.line-right",[])]),r.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(ct(o=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(o).length,l=w(125,"{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class Zq extends R9{constructor(e,t,i,n,r,o,a,l){const c=pt("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=n,this._hide=r,this._modifiedOutlineSource=o,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=pt("div.diff-hidden-lines",[pt("div.top@top",{title:w(126,"Click or drag to show more above")}),pt("div.center@content",{style:{display:"flex"}},[pt("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[Ve("a",{title:w(127,"Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...dg("$(unfold)"))]),pt("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),pt("div.bottom@bottom",{title:w(128,"Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?as(this._nodes.first):this._register(_d(this._nodes.first,{width:eg(this._editor).layoutInfoContentLeft})),this._register(ct(d=>{const g=this._unchangedRegion.visibleLineCountTop.read(d)+this._unchangedRegion.visibleLineCountBottom.read(d)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!g),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(d)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(d)>0),this._nodes.top.classList.toggle("canMoveBottom",!g);const p=this._unchangedRegion.isDragged.read(d),_=this._editor.getDomNode();_&&(_.classList.toggle("draggingUnchangedRegion",!!p),p==="top"?(_.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(d)>0),_.classList.toggle("canMoveBottom",!g)):p==="bottom"?(_.classList.toggle("canMoveTop",!g),_.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(d)>0)):(_.classList.toggle("canMoveTop",!1),_.classList.toggle("canMoveBottom",!1)))}));const u=this._editor;this._register(J(this._nodes.top,"mousedown",d=>{if(d.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),d.preventDefault();const g=d.clientY;let p=!1;const _=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const C=Ae(this._nodes.top),v=J(C,"mousemove",S=>{const E=S.clientY-g;p=p||Math.abs(E)>2;const T=Math.round(E/u.getOption(75)),R=Math.max(0,Math.min(_+T,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(R,void 0)}),x=J(C,"mouseup",S=>{p||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),v.dispose(),x.dispose()})})),this._register(J(this._nodes.bottom,"mousedown",d=>{if(d.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),d.preventDefault();const g=d.clientY;let p=!1;const _=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const C=Ae(this._nodes.bottom),v=J(C,"mousemove",S=>{const E=S.clientY-g;p=p||Math.abs(E)>2;const T=Math.round(E/u.getOption(75)),R=Math.max(0,Math.min(_-T,this._unchangedRegion.getMaxVisibleLineCountBottom())),N=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(R,void 0);const A=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(A-N))}),x=J(C,"mouseup",S=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!p){const k=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const E=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(E-k))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),v.dispose(),x.dispose()})})),this._register(ct(d=>{const g=[];if(!this._hide){const p=i.getHiddenModifiedRange(d).length,_=w(129,"{0} hidden lines",p),C=Ve("span",{title:w(130,"Double click to unfold")},_);C.addEventListener("dblclick",S=>{S.button===0&&(S.preventDefault(),this._unchangedRegion.showAll(void 0))}),g.push(C);const v=this._unchangedRegion.getHiddenModifiedRange(d),x=this._modifiedOutlineSource.getBreadcrumbItems(v,d);if(x.length>0){g.push(Ve("span",void 0,"|"));for(let S=0;S<x.length;S++){const k=x[S],E=sM.toIcon(k.kind),T=pt("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Yw(E),"",k.name,...S===x.length-1?[]:[Yw(xe.chevronRight)]]).root;g.push(T),T.onclick=()=>{this._revealModifiedHiddenLine(k.startLineNumber)}}}}as(this._nodes.others,...g)}))}}const uA=[];class c5e extends ne{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=n,this._selectedDiffs=Ie(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return uA;const l=this._editors.modifiedSelections.read(r);if(l.every(g=>g.isEmpty()))return uA;const c=new Ao(l.map(g=>He.fromRangeInclusive(g))),d=a.mappings.filter(g=>g.lineRangeMapping.innerChanges&&c.intersects(g.lineRangeMapping.modified)).map(g=>({mapping:g,rangeMappings:g.lineRangeMapping.innerChanges.filter(p=>l.some(_=>H.areIntersecting(p.modifiedRange,_)))}));return d.length===0||d.every(g=>g.rangeMappings.length===0)?uA:d}),this._register($a((r,o)=>{if(!this._options.shouldRenderOldRevertArrows.read(r))return;const a=this._diffModel.read(r),l=a==null?void 0:a.diff.read(r);if(!a||!l||a.movedTextToCompare.read(r))return;const c=[],u=this._selectedDiffs.read(r),d=new Set(u.map(g=>g.mapping));if(u.length>0){const g=this._editors.modifiedSelections.read(r),p=o.add(new TE(g[g.length-1].positionLineNumber,this._widget,u.flatMap(_=>_.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(p),c.push(p)}for(const g of l.mappings)if(!d.has(g)&&!g.lineRangeMapping.modified.isEmpty&&g.lineRangeMapping.innerChanges){const p=o.add(new TE(g.lineRangeMapping.modified.startLineNumber,this._widget,g.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(p),c.push(p)}o.add(Fe(()=>{for(const g of c)this._editors.modified.removeGlyphMarginWidget(g)}))}))}}const x2=class x2 extends ne{getId(){return this._id}constructor(e,t,i,n){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=n,this._id=`revertButton${x2.counter++}`,this._domNode=pt("div.revertButton",{title:this._revertSelection?w(135,"Revert Selected Changes"):w(136,"Revert Change")},[Yw(xe.arrowRight)]).root,this._register(J(this._domNode,pe.MOUSE_DOWN,r=>{r.button!==2&&(r.stopPropagation(),r.preventDefault())})),this._register(J(this._domNode,pe.MOUSE_UP,r=>{r.stopPropagation(),r.preventDefault()})),this._register(J(this._domNode,pe.CLICK,r=>{this._diffs instanceof Ss?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),r.stopPropagation(),r.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:dd.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};x2.counter=0;let TE=x2;var h5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_0=function(s,e){return function(t,i){e(t,i,s)}};let NE=class extends B3{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,n,r,o,a,l){super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=r,this._codeEditorService=o,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=pt("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[pt("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),pt("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),pt("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register($Q(this,void 0)),this._diffModel=Ie(this,E=>{var T;return(T=this._diffModelSrc.read(E))==null?void 0:T.object}),this.onDidChangeModel=ge.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new $1([St,this._contextKeyService]))),this._boundarySashes=Qe(this,void 0),this._accessibleDiffViewerShouldBeVisible=Qe(this,!1),this._accessibleDiffViewerVisible=Ie(this,E=>this._options.onlyShowAccessibleDiffViewer.read(E)?!0:this._accessibleDiffViewerShouldBeVisible.read(E)),this._movedBlocksLinesPart=Qe(this,void 0),this._layoutInfo=Ie(this,E=>{var G,Q;const T=this._rootSizeObserver.width.read(E),R=this._rootSizeObserver.height.read(E);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=R+"px";const N=this._sash.read(E),A=this._gutter.read(E),O=(A==null?void 0:A.width.read(E))??0,W=((G=this._overviewRulerPart.read(E))==null?void 0:G.width)??0;let j,F,q,Z,K;if(!!N){const le=N.sashLeft.read(E),ve=((Q=this._movedBlocksLinesPart.read(E))==null?void 0:Q.width.read(E))??0;j=0,F=le-O-ve,K=le-O,q=le,Z=T-q-W}else{K=0;const le=this._options.inlineViewHideOriginalLineNumbers.read(E);j=O,le?F=0:F=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(E)),q=O+F,Z=T-q-W}return this.elements.original.style.left=j+"px",this.elements.original.style.width=F+"px",this._editors.original.layout({width:F,height:R},!0),A==null||A.layout(K),this.elements.modified.style.left=q+"px",this.elements.modified.style.width=Z+"px",this._editors.modified.layout({width:Z,height:R},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((E,T)=>E==null?void 0:E.diff.read(T)),this.onDidUpdateDiff=ge.fromObservableLight(this._diffValue),this._codeEditorService.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(Fe(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new Tte(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(V3,t),this._register(ct(E=>{this._options.setWidth(this._rootSizeObserver.width.read(E))})),this._contextKeyService.createKey(ke.isEmbeddedDiffEditor.key,!1),this._register(Wc(ke.isEmbeddedDiffEditor,this._contextKeyService,E=>this._options.isInEmbeddedEditor.read(E))),this._register(Wc(ke.comparingMovedCode,this._contextKeyService,E=>{var T;return!!((T=this._diffModel.read(E))!=null&&T.movedTextToCompare.read(E))})),this._register(Wc(ke.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,E=>this._options.couldShowInlineViewBecauseOfSize.read(E))),this._register(Wc(ke.diffEditorInlineMode,this._contextKeyService,E=>!this._options.renderSideBySide.read(E))),this._register(Wc(ke.hasChanges,this._contextKeyService,E=>{var T,R;return(((R=(T=this._diffModel.read(E))==null?void 0:T.diff.read(E))==null?void 0:R.mappings.length)??0)>0})),this._editors=this._register(this._instantiationService.createInstance(F3,this.elements.original,this.elements.modified,this._options,i,(E,T,R,N)=>this._createInnerEditor(E,T,R,N))),this._register(Wc(ke.diffEditorOriginalWritable,this._contextKeyService,E=>this._options.originalEditable.read(E))),this._register(Wc(ke.diffEditorModifiedWritable,this._contextKeyService,E=>!this._options.readOnly.read(E))),this._register(Wc(ke.diffEditorOriginalUri,this._contextKeyService,E=>{var T;return((T=this._diffModel.read(E))==null?void 0:T.model.original.uri.toString())??""})),this._register(Wc(ke.diffEditorModifiedUri,this._contextKeyService,E=>{var T;return((T=this._diffModel.read(E))==null?void 0:T.model.modified.uri.toString())??""})),this._overviewRulerPart=Cl(this,E=>this._options.renderOverviewRuler.read(E)?this._instantiationService.createInstance(Uc(hv),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(T=>T.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((E,T)=>{var R;return E-(((R=this._overviewRulerPart.read(T))==null?void 0:R.width)??0)})};this._sashLayout=new Q4e(this._options,c),this._sash=Cl(this,E=>{const T=this._options.renderSideBySide.read(E);return this.elements.root.classList.toggle("side-by-side",T),T?new Mte(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const u=Cl(this,E=>this._instantiationService.createInstance(Uc(j3),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Cl(this,E=>this._instantiationService.createInstance(Uc(q4e),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const d=new Set,g=new Set;let p=!1;const _=Cl(this,E=>this._instantiationService.createInstance(Uc(O3),Ae(this._domElement),this._editors,this._diffModel,this._options,this,()=>p||u.read(void 0).isUpdatingHiddenAreas,d,g)).recomputeInitiallyAndOnChange(this._store),C=Ie(this,E=>{const T=_.read(E).viewZones.read(E).orig,R=u.read(E).viewZones.read(E).origViewZones;return T.concat(R)}),v=Ie(this,E=>{const T=_.read(E).viewZones.read(E).mod,R=u.read(E).viewZones.read(E).modViewZones;return T.concat(R)});this._register(kE(this._editors.original,C,E=>{p=E},d));let x;this._register(kE(this._editors.modified,v,E=>{p=E,p?x=xE.capture(this._editors.modified):(x==null||x.restore(this._editors.modified),x=void 0)},g)),this._accessibleDiffViewer=Cl(this,E=>this._instantiationService.createInstance(Uc(Jf),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(T,R)=>this._accessibleDiffViewerShouldBeVisible.set(T,R),this._options.onlyShowAccessibleDiffViewer.map(T=>!T),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((T,R)=>{var N;return(N=T==null?void 0:T.diff.read(R))==null?void 0:N.mappings.map(A=>A.lineRangeMapping)}),new D4e(this._editors))).recomputeInitiallyAndOnChange(this._store);const S=this._accessibleDiffViewerVisible.map(E=>E?"hidden":"visible");this._register(_d(this.elements.modified,{visibility:S})),this._register(_d(this.elements.original,{visibility:S})),this._createDiffEditorContributions(),this._codeEditorService.addDiffEditor(this),this._register(Fe(()=>{this._codeEditorService.removeDiffEditor(this)})),this._gutter=Cl(this,E=>this._options.shouldRenderGutterMenu.read(E)?this._instantiationService.createInstance(Uc(H3),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(nD(this._layoutInfo)),Cl(this,E=>new(Uc(U_))(this.elements.root,this._diffModel,this._layoutInfo.map(T=>T.originalEditor),this._layoutInfo.map(T=>T.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,E=>{this._movedBlocksLinesPart.set(E,void 0)}),this._register(ge.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,E=>this._handleCursorPositionChange(E,!0))),this._register(ge.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,E=>this._handleCursorPositionChange(E,!1)));const k=this._diffModel.map(this,(E,T)=>{if(E)return E.diff.read(T)===void 0&&!E.isDiffUpToDate.read(T)});this._register($a((E,T)=>{if(k.read(E)===!0){const R=this._editorProgressService.show(!0,1e3);T.add(Fe(()=>R.done()))}})),this._register($a((E,T)=>{T.add(new(Uc(c5e))(this._editors,this._diffModel,this._options,this))})),this._register($a((E,T)=>{const R=this._diffModel.read(E);if(R)for(const N of[R.model.original,R.model.modified])T.add(N.onWillDispose(A=>{It(new Pe("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(ct(E=>{this._options.setModel(this._diffModel.read(E))}))}_createInnerEditor(e,t,i,n){return e.createInstance(Gk,t,i,n)}_createDiffEditorContributions(){const e=L_.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){It(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return vD.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var i;const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:(i=this._diffModel.get())==null?void 0:i.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())==null||t.restoreSerializedState(i.modelState))}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(M3,e,this._options)}getModel(){var e;return((e=this._diffModel.get())==null?void 0:e.model)??null}setModel(e){const t=e?"model"in e?EE.create(e).createNewRef(this):EE.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==(e==null?void 0:e.object)&&P7(t,n=>{var a;const r=e==null?void 0:e.object;mi.batchEventsGlobally(n,()=>{this._editors.original.setModel(r?r.model.original:null),this._editors.modified.setModel(r?r.model.modified:null)});const o=(a=this._diffModelSrc.get())==null?void 0:a.createNewRef(this);this._diffModelSrc.set(e==null?void 0:e.createNewRef(this),n),setTimeout(()=>{o==null||o.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?u5e(e):null}getDiffComputationResult(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?{changes:this.getLineChanges(),changes2:e.mappings.map(i=>i.lineRangeMapping),identical:e.identical,quitEarly:e.quitEarly}:null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||(this._editors.modified.pushUndoStop(),this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}]),this._editors.modified.pushUndoStop())}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(n=>({range:n.modifiedRange,text:t.model.original.getValueInRange(n.originalRange)}));this._editors.modified.pushUndoStop(),this._editors.modified.executeEdits("diffEditor",i),this._editors.modified.pushUndoStop()}revertFocusedRangeMappings(){var l,c;const e=this._diffModel.get();if(!e||!e.isDiffUpToDate.get())return;const t=(c=(l=this._diffModel.get())==null?void 0:l.diff.get())==null?void 0:c.mappings;if(!t||t.length===0)return;const i=this._editors.modified;if(!i.hasTextFocus())return;const n=i.getPosition().lineNumber,r=i.getSelection(),o=He.fromRange(r||new H(n,0,n,0)),a=t.filter(u=>u.lineRangeMapping.modified.intersect(o));i.pushUndoStop(),i.executeEdits("diffEditor",a.map(u=>({range:u.lineRangeMapping.modified.toExclusiveRange(),text:e.model.original.getValueInRange(u.lineRangeMapping.original.toExclusiveRange())}))),i.pushUndoStop()}_goTo(e){this._editors.modified.setPosition(new Y(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){var r,o;const t=(o=(r=this._diffModel.get())==null?void 0:r.diff.get())==null?void 0:o.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let n;e==="next"?this._editors.modified.getModel().getLineCount()===i?n=t[0]:n=t.find(l=>l.lineRangeMapping.modified.startLineNumber>i)??t[0]:n=ak(t,a=>a.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(n),n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(Nl.diffLineDeleted,{source:"diffEditor.goToDiff"}):n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(Nl.diffLineInserted,{source:"diffEditor.goToDiff"}):n&&this._accessibilitySignalService.playSignal(Nl.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{var i;const t=(i=e.diff.get())==null?void 0:i.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){var o,a;const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let n;const r=t.getSelection();if(r){const l=(a=(o=this._diffModel.get())==null?void 0:o.diff.get())==null?void 0:a.mappings.map(c=>e?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=Rq(r.getStartPosition(),l),u=Rq(r.getEndPosition(),l);n=H.plusRange(c,u)}}return{destination:i,destinationSelection:n}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&Vi(i=>{for(const n of e)n.collapseAll(i)})}showAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&Vi(i=>{for(const n of e)n.showAll(i)})}_handleCursorPositionChange(e,t){var i,n;if((e==null?void 0:e.reason)===3){const r=(n=(i=this._diffModel.get())==null?void 0:i.diff.get())==null?void 0:n.mappings.find(o=>t?o.lineRangeMapping.modified.contains(e.position.lineNumber):o.lineRangeMapping.original.contains(e.position.lineNumber));r!=null&&r.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(Nl.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):r!=null&&r.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(Nl.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):r&&this._accessibilitySignalService.playSignal(Nl.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};NE=h5e([_0(3,St),_0(4,wt),_0(5,fn),_0(6,XD),_0(7,r9)],NE);function u5e(s){return s.mappings.map(e=>{const t=e.lineRangeMapping;let i,n,r,o,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,o=0,a=void 0):(r=t.modified.startLineNumber,o=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:r,modifiedEndLineNumber:o,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}function d5e(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===vD.ICodeEditor:!1}var f5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Jq=function(s,e){return function(t,i){e(t,i,s)}},oL,Lg;let $3=(Lg=class{constructor(e,t){this._configurationService=e,this._languageService=t}async renderCodeBlock(e,t,i){var u;const n=d5e(i.context)?i.context:void 0;let r;e?r=this._languageService.getLanguageIdByLanguageName(e):n&&(r=(u=n.getModel())==null?void 0:u.getLanguageId()),r||(r=da);const o=await mEe(this._languageService,t,r),a=oL._ttpTokenizer?oL._ttpTokenizer.createHTML(o)??o:o,l=document.createElement("span");l.innerHTML=a;const c=l.querySelector(".monaco-tokenized-source");return Wi(c)?(Jn(c,this.getFontInfo(n)),l):document.createElement("span")}getFontInfo(e){return e?e.getOption(59):z0e({fontFamily:this._configurationService.getValue("editor").fontFamily},1)}},oL=Lg,Lg._ttpTokenizer=yd("tokenizeToString",{createHTML(e){return e}}),Lg);$3=oL=f5e([Jq(0,ai),Jq(1,En)],$3);var B9=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},zt=function(s,e){return function(t,i){e(t,i,s)}};let g5e=0,eG=!1;function m5e(s){if(!s){if(eG)return;eG=!0}O0e(s||Ut.document.body)}let IE=class extends Gk{constructor(e,t,i,n,r,o,a,l,c,u,d,g,p,_){const C={...t};C.ariaLabel=C.ariaLabel||_O.editorViewAccessibleLabel,super(e,C,{},i,n,r,o,c,u,d,g,p),l instanceof k1?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,m5e(C.ariaContainerElement),jNe((v,x)=>i.createInstance(qw,v,{instantHover:x},{})),$Ne(a),_.setDefaultCodeBlockRenderer(i.createInstance($3))}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++g5e,r=ft.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,r),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),ne.None;const t=e.id,i=e.label,n=ft.and(ft.equals("editorId",this.getId()),ft.deserialize(e.precondition)),r=e.keybindings,o=ft.and(n,ft.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(p,..._)=>Promise.resolve(e.run(this,..._)),u=new Ee,d=this.getId()+":"+t;if(u.add(dr.registerCommand(d,c)),a){const p={command:{id:d,title:i},when:n,group:a,order:l};u.add(u1.appendMenuItem(rn.EditorContext,p))}if(Array.isArray(r))for(const p of r)u.add(this._standaloneKeybindingService.addDynamicKeybinding(d,p,c,o));const g=new sJ(d,i,i,void 0,n,(...p)=>Promise.resolve(e.run(this,...p)),this._contextKeyService);return this._actions.set(t,g),u.add(Fe(()=>{this._actions.delete(t)})),u}_triggerCommand(e,t){if(this._codeEditorService instanceof Kk)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};IE=B9([zt(2,wt),zt(3,fn),zt(4,ho),zt(5,St),zt(6,qv),zt(7,Bn),zt(8,Ir),zt(9,_a),zt(10,uo),zt(11,rc),zt(12,ei),zt(13,BD)],IE);let q3=class extends IE{constructor(e,t,i,n,r,o,a,l,c,u,d,g,p,_,C,v,x){const S={...t};SE(d,S,!1);const k=c.registerEditorContainer(e);typeof S.theme=="string"&&c.setTheme(S.theme),typeof S.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!S.autoDetectHighContrast);const E=S.model;delete S.model,super(e,S,i,n,r,o,a,l,c,u,g,C,v,x),this._configurationService=d,this._standaloneThemeService=c,this._register(k);let T;if(typeof E>"u"){const R=_.getLanguageIdByMimeType(S.language)||S.language||da;T=Vte(p,_,S.value||"",R,void 0),this._ownsModel=!0}else T=E,this._ownsModel=!1;if(this._attachModel(T),T){const R={oldModelUrl:null,newModelUrl:T.uri};this._onDidChangeModel.fire(R)}}dispose(){super.dispose()}updateOptions(e){SE(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};q3=B9([zt(2,wt),zt(3,fn),zt(4,ho),zt(5,St),zt(6,qv),zt(7,Bn),zt(8,ba),zt(9,_a),zt(10,ai),zt(11,uo),zt(12,Gs),zt(13,En),zt(14,rc),zt(15,ei),zt(16,BD)],q3);let G3=class extends NE{constructor(e,t,i,n,r,o,a,l,c,u,d,g){const p={...t};SE(l,p,!0);const _=o.registerEditorContainer(e);typeof p.theme=="string"&&o.setTheme(p.theme),typeof p.autoDetectHighContrast<"u"&&o.setAutoDetectHighContrast(!!p.autoDetectHighContrast),super(e,p,{},n,i,r,g,u),this._configurationService=l,this._standaloneThemeService=o,this._register(_)}dispose(){super.dispose()}updateOptions(e){SE(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(IE,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};G3=B9([zt(2,wt),zt(3,St),zt(4,fn),zt(5,ba),zt(6,_a),zt(7,ai),zt(8,Hh),zt(9,r9),zt(10,N9),zt(11,XD)],G3);function Vte(s,e,t,i,n){if(t=t||"",!i){const r=t.indexOf(`
`);let o=t;return r!==-1&&(o=t.substring(0,r)),tG(s,t,e.createByFilepathOrFirstLine(n||null,o),n)}return tG(s,t,e.createById(i),n)}function tG(s,e,t,i){return s.createModel(e,t,i)}B("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},w(142,"The background color of the diff editor's header"));B("multiDiffEditor.background",ga,w(143,"The background color of the multi file diff editor"));B("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},w(144,"The border color of the multi file diff editor"));var p5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},iG=function(s,e){return function(t,i){e(t,i,s)}};class _5e{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let K3=class extends ne{constructor(e,t,i,n,r){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=Qe(this,void 0),this._collapsed=Ie(this,l=>{var c;return(c=this._viewModel.read(l))==null?void 0:c.collapsed.read(l)}),this._editorContentHeight=Qe(this,500),this.contentHeight=Ie(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=Qe(this,0),this._modifiedWidth=Qe(this,0),this._originalContentWidth=Qe(this,0),this._originalWidth=Qe(this,0),this.maxScroll=Ie(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),u=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>u?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:u,width:this._originalWidth.read(l)}}),this._elements=pt("div.multiDiffEntry",[pt("div.header@header",[pt("div.header-content",[pt("div.collapse-button@collapseButton"),pt("div.file-path",[pt("div.title.modified.show-file-icons@primaryPath",[]),pt("div.status.deleted@status",["R"]),pt("div.title.original.show-file-icons@secondaryPath",[])]),pt("div.actions@actions")])]),pt("div.editorParent",[pt("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(NE,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode,fixedOverflowWidgets:!0},{})),this.isModifedFocused=eg(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=eg(this.editor.getOriginalEditor()).isFocused,this.isFocused=Ie(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new Ee),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const o=new HO(this._elements.collapseButton,{});this._register(ct(l=>{o.element.className="",o.icon=this._collapsed.read(l)?xe.chevronRight:xe.chevronDown})),this._register(o.onDidClick(()=>{var l;(l=this._viewModel.get())==null||l.collapsed.set(!this._collapsed.get(),void 0)})),this._register(ct(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{w0(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register(ct(l=>{var u;const c=(u=this._viewModel.read(l))==null?void 0:u.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(r.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new $1([St,this._contextKeyService])));this._register(a.createInstance(DE,this._elements.actions,rn.MultiDiffEditorFileToolbar,{actionRunner:this._register(new Fte(()=>{var l,c;return((l=this._viewModel.get())==null?void 0:l.modifiedUri)??((c=this._viewModel.get())==null?void 0:c.originalUri)})),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>Hee(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(n){return{...n,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){w0(n=>{this._viewModel.set(void 0,n),this.editor.setDiffModel(null,n),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(w0(n=>{var c,u;(c=this._resourceLabel)==null||c.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let r=!1,o=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",r=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",o=!0),this._elements.status.classList.toggle("renamed",r),this._elements.status.classList.toggle("deleted",o),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,(u=this._resourceLabel2)==null||u.setUri(r?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,n),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,n=>{n||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[n,r]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(n,r)}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const r=e.length-this._headerHeight,o=Math.max(0,Math.min(n.start-e.start,r));this._elements.header.style.transform=`translateY(${o}px)`,w0(a=>{this.editor.layout({width:t-16-2,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",o>0||i>0),this._elements.header.classList.toggle("collapsed",o===r)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};K3=p5e([iG(3,wt),iG(4,St)],K3);class b5e{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(n=>this._itemData.get(n).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var C5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},nG=function(s,e){return function(t,i){e(t,i,s)}};let Y3=class extends ne{constructor(e,t,i,n,r,o){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=r,this._parentInstantiationService=o,this._scrollableElements=pt("div.scrollContent",[pt("div@content",{style:{overflow:"hidden"}}),pt("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new U1({forceIntegerValues:!1,scheduleAtNextAnimationFrame:c=>hr(Ae(this._element),c),smoothScrollDuration:100})),this._scrollableElement=this._register(new ND(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=pt("div.monaco-component.multiDiffEditor",{},[pt("div",{},[this._scrollableElement.getDomNode()]),pt("div.placeholder@placeholder",{},[pt("div")])]),this._sizeObserver=this._register(new Tte(this._element,void 0)),this._objectPool=this._register(new b5e(c=>{const u=this._instantiationService.createInstance(K3,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return u.setData(c),u})),this.scrollTop=mi(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=mi(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=Ie(this,c=>{const u=this._viewModel.read(c);if(!u)return{items:[],getItem:_=>{throw new Pe}};const d=u.items.read(c),g=new Map;return{items:d.map(_=>{var x;const C=c.store.add(new v5e(_,this._objectPool,this.scrollLeft,S=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+S})})),v=(x=this._lastDocStates)==null?void 0:x[C.getKey()];return v&&Vi(S=>{C.setViewState(v,S)}),g.set(_,C),C}),getItem:_=>g.get(_)}}),this._viewItems=this._viewItemsInfo.map(this,c=>c.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(c,u)=>c.reduce((d,g)=>d+g.contentHeight.read(u)+this._spaceBetweenPx,0)),this.activeControl=Ie(this,c=>{var g,p;const u=(g=this._viewModel.read(c))==null?void 0:g.activeDiffItem.read(c);return u?(p=this._viewItemsInfo.read(c).getItem(u).template.read(c))==null?void 0:p.editor:void 0}),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new $1([St,this._contextKeyService]))),this._contextKeyService.createKey(ke.inMultiDiffEditor.key,!0),this._lastDocStates={},this._register($a((c,u)=>{const d=this._viewModel.read(c);if(d&&d.contextKeys)for(const[g,p]of Object.entries(d.contextKeys)){const _=this._contextKeyService.createKey(g,void 0);_.set(p),u.add(Fe(()=>_.reset()))}}));const a=this._parentContextKeyService.createKey(ke.multiDiffEditorAllCollapsed.key,!1);this._register(ct(c=>{const u=this._viewModel.read(c);if(u){const d=u.items.read(c).every(g=>g.collapsed.read(c));a.set(d)}})),this._register(ct(c=>{const u=this._dimension.read(c);this._sizeObserver.observe(u)}));const l=Ie(c=>{if(this._viewItems.read(c).length>0)return;const d=this._viewModel.read(c);return!d||d.isLoading.read(c)?w(145,"Loading..."):w(146,"No Changed Files")});this._register(ct(c=>{const u=l.read(c);this._elements.placeholder.innerText=u??"",this._elements.placeholder.classList.toggle("visible",!!u)})),this._scrollableElements.content.style.position="relative",this._register(ct(c=>{const u=this._sizeObserver.height.read(c);this._scrollableElements.root.style.height=`${u}px`;const d=this._totalHeight.read(c);this._scrollableElements.content.style.height=`${d}px`;const g=this._sizeObserver.width.read(c);let p=g;const _=this._viewItems.read(c),C=TX(_,oo(v=>v.maxScroll.read(c).maxScroll,Sh));if(C){const v=C.maxScroll.read(c);p=g+v.maxScroll}this._scrollableElement.setScrollDimensions({width:g,height:u,scrollHeight:d,scrollWidth:p})})),e.replaceChildren(this._elements.root),this._register(Fe(()=>{e.replaceChildren()})),this._register(ct(c=>{const u=this._viewModel.read(c);if(u&&!u.isLoading.read(c)){if(u.items.read(c).length===0||u.activeDiffItem.read(c))return;this.goToNextChange()}})),this._register(this._register(ct(c=>{w0(u=>{this.render(c)})})))}reveal(e,t){var c;const i=this._viewItems.get(),n=i.findIndex(u=>{var d,g,p,_;return((d=u.viewModel.originalUri)==null?void 0:d.toString())===((g=e.original)==null?void 0:g.toString())&&((p=u.viewModel.modifiedUri)==null?void 0:p.toString())===((_=e.modified)==null?void 0:_.toString())});if(n===-1)throw new Pe("Resource not found in diff editor");const r=i[n];this._viewModel.get().activeDiffItem.setCache(r.viewModel,void 0);let o=0;for(let u=0;u<n;u++)o+=i[u].contentHeight.get()+this._spaceBetweenPx;this._scrollableElement.setScrollPosition({scrollTop:o});const a=(c=r.template.get())==null?void 0:c.editor,l="original"in e?a==null?void 0:a.getOriginalEditor():a==null?void 0:a.getModifiedEditor();l&&(t!=null&&t.range)&&(l.revealRangeInCenter(t.range),w5e(l,t.range))}goToNextChange(){this._navigateToChange("next")}_navigateToChange(e){var l,c,u,d,g;const t=this._viewItems.get();if(t.length===0)return;const i=(l=this._viewModel.get())==null?void 0:l.activeDiffItem.get(),n=i?t.findIndex(p=>p.viewModel===i):-1;if(n===-1){this._goToFile(0,"first");return}const r=t[n];r.viewModel.collapsed.get()&&r.viewModel.collapsed.set(!1,void 0);const o=(c=r.template.get())==null?void 0:c.editor;if((d=(u=o==null?void 0:o.getDiffComputationResult())==null?void 0:u.changes2)!=null&&d.length){const p=((g=o.getModifiedEditor().getPosition())==null?void 0:g.lineNumber)||1,_=o.getDiffComputationResult().changes2;if(e==="next"?_.some(v=>v.modified.startLineNumber>p):_.some(v=>v.modified.endLineNumberExclusive<=p)){o.goToDiff(e);return}}const a=(n+(e==="next"?1:-1)+t.length)%t.length;this._goToFile(a,e==="next"?"first":"last")}_goToFile(e,t){var r,o,a;const i=this._viewItems.get()[e];i.viewModel.collapsed.get()&&i.viewModel.collapsed.set(!1,void 0),this.reveal({original:i.viewModel.originalUri,modified:i.viewModel.modifiedUri});const n=(r=i.template.get())==null?void 0:r.editor;if((a=(o=n==null?void 0:n.getDiffComputationResult())==null?void 0:o.changes2)!=null&&a.length)if(t==="first")n.revealFirstDiff();else{const l=n.getDiffComputationResult().changes2.at(-1),c=n.getModifiedEditor();c.setPosition({lineNumber:l.modified.startLineNumber,column:1}),c.revealLineInCenter(l.modified.startLineNumber)}n==null||n.focus()}render(e){const t=this.scrollTop.read(e);let i=0,n=0,r=0;const o=this._sizeObserver.height.read(e),a=Re.ofStartAndLength(t,o),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const u=c.contentHeight.read(e),d=Math.min(u,o),g=Re.ofStartAndLength(n,d),p=Re.ofStartAndLength(r,u);if(p.isBefore(a))i-=u-d,c.hide();else if(p.isAfter(a))c.hide();else{const _=Math.max(0,Math.min(a.start-p.start,u-d));i-=_;const C=Re.ofStartAndLength(t+i,o);c.render(g,_,l,C)}n+=d+this._spaceBetweenPx,r+=u+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};Y3=C5e([nG(4,St),nG(5,wt)],Y3);function w5e(s,e){const t=s.getModel(),i=s.createDecorationsCollection([{range:e,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{s.getModel()===t&&i.clear()},350)}class v5e extends ne{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register($Q(this,void 0)),this.contentHeight=Ie(this,r=>{var o,a;return((a=(o=this._templateRef.read(r))==null?void 0:o.object.contentHeight)==null?void 0:a.read(r))??this.viewModel.lastTemplateData.read(r).contentHeight}),this.maxScroll=Ie(this,r=>{var o;return((o=this._templateRef.read(r))==null?void 0:o.object.maxScroll.read(r))??{maxScroll:0,scrollWidth:0}}),this.template=Ie(this,r=>{var o;return(o=this._templateRef.read(r))==null?void 0:o.object}),this._isHidden=Qe(this,!1),this._isFocused=Ie(this,r=>{var o;return((o=this.template.read(r))==null?void 0:o.isFocused.read(r))??!1}),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(ct(r=>{var a;const o=this._scrollLeft.read(r);(a=this._templateRef.read(r))==null||a.object.setScrollLeft(o)})),this._register(ct(r=>{const o=this._templateRef.read(r);!o||!this._isHidden.read(r)||o.object.isFocused.read(r)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){var e;return`VirtualViewItem(${(e=this.viewModel.documentDiffItem.modified)==null?void 0:e.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){var o;this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=(o=e.selections)==null?void 0:o.map(gt.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const r=this._templateRef.get();r&&n&&r.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&Vi(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let r=this._templateRef.get();if(!r){r=this._objectPool.getUnusedObj(new _5e(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(r,void 0);const o=this.viewModel.lastTemplateData.get().selections;o&&r.object.editor.setSelections(o)}r.object.render(e,i,t,n)}}var y5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},S5e=function(s,e){return function(t,i){e(t,i,s)}};let Q3=class extends ne{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=Qe(this,void 0),this._viewModel=Qe(this,void 0),this._widgetImpl=Ie(this,n=>n.store.add(this._instantiationService.createInstance(Uc(Y3),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory))),this._register(nD(this._widgetImpl))}};Q3=y5e([S5e(2,wt)],Q3);function x5e(s,e,t){return Be.initialize(t||{}).createInstance(q3,s,e)}function L5e(s){return Be.get(fn).onCodeEditorAdd(t=>{s(t)})}function k5e(s){return Be.get(fn).onDiffEditorAdd(t=>{s(t)})}function E5e(){return Be.get(fn).listCodeEditors()}function D5e(){return Be.get(fn).listDiffEditors()}function T5e(s,e,t){return Be.initialize(t||{}).createInstance(G3,s,e)}function N5e(s,e){const t=Be.initialize(e||{});return new Q3(s,{},t)}function I5e(s){if(typeof s.id!="string"||typeof s.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return dr.registerCommand(s.id,s.run)}function R5e(s){if(typeof s.id!="string"||typeof s.label!="string"||typeof s.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=ft.deserialize(s.precondition),t=(n,...r)=>zg.runEditorCommand(n,r,e,(o,a,l)=>Promise.resolve(s.run(a,...l))),i=new Ee;if(i.add(dr.registerCommand(s.id,t)),s.contextMenuGroupId){const n={command:{id:s.id,title:s.label},when:e,group:s.contextMenuGroupId,order:s.contextMenuOrder||0};i.add(u1.appendMenuItem(rn.EditorContext,n))}if(Array.isArray(s.keybindings)){const n=Be.get(Bn);if(!(n instanceof k1))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const r=ft.and(e,ft.deserialize(s.keybindingContext));i.add(n.addDynamicKeybindings(s.keybindings.map(o=>({keybinding:o,command:s.id,when:r}))))}}return i}function A5e(s){return Wte([s])}function Wte(s){const e=Be.get(Bn);return e instanceof k1?e.addDynamicKeybindings(s.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:ft.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),ne.None)}function M5e(s,e,t){const i=Be.get(En),n=i.getLanguageIdByMimeType(e)||e;return Vte(Be.get(Gs),i,s,n,t)}function O5e(s,e){const t=Be.get(En),i=t.getLanguageIdByMimeType(e)||e||da;s.setLanguage(t.createById(i))}function P5e(s,e,t){s&&Be.get(bm).changeOne(e,s.uri,t)}function F5e(s){Be.get(bm).changeAll(s,[])}function B5e(s){return Be.get(bm).read(s)}function V5e(s){return Be.get(bm).onMarkerChanged(s)}function W5e(s){return Be.get(Gs).getModel(s)}function H5e(){return Be.get(Gs).getModels()}function z5e(s){return Be.get(Gs).onModelAdded(s)}function U5e(s){return Be.get(Gs).onModelRemoved(s)}function j5e(s){return Be.get(Gs).onModelLanguageChanged(t=>{s({model:t.model,oldLanguage:t.oldLanguageId})})}function $5e(s){return a0e(Be.get(Gs),s)}function q5e(s,e){const t=Be.get(En),i=Be.get(ba);return r6.colorizeElement(i,t,s,e).then(()=>{i.registerEditorContainer(s)})}function G5e(s,e,t){const i=Be.get(En);return Be.get(ba).registerEditorContainer(Ut.document.body),r6.colorize(i,s,e,t)}function K5e(s,e,t=4){return Be.get(ba).registerEditorContainer(Ut.document.body),r6.colorizeModelLine(s,e,t)}function Y5e(s){const e=qi.get(s);return e||{getInitialState:()=>kw,tokenize:(t,i,n)=>OX(s,n)}}function Q5e(s,e){qi.getOrCreate(e);const t=Y5e(e),i=F1(s),n=[];let r=t.getInitialState();for(let o=0,a=i.length;o<a;o++){const l=i[o],c=t.tokenize(l,!0,r);n[o]=c.tokens,r=c.endState}return n}function X5e(s,e){Be.get(ba).defineTheme(s,e)}function Z5e(s){Be.get(ba).setTheme(s)}function J5e(){C4.clearAllFontInfos()}function eOe(s,e){return dr.registerCommand({id:s,handler:e})}function tOe(s){return Be.get(FD).registerOpener({async open(t){return typeof t=="string"&&(t=nt.parse(t)),s.open(t)}})}function iOe(s){return Be.get(fn).registerCodeEditorOpenHandler(async(t,i,n)=>{var a;if(!i)return null;const r=(a=t.options)==null?void 0:a.selection;let o;return r&&typeof r.endLineNumber=="number"&&typeof r.endColumn=="number"?o=r:r&&(o={lineNumber:r.startLineNumber,column:r.startColumn}),await s.openCodeEditor(i,t.resource,o)?i:null})}function nOe(){return{create:x5e,getEditors:E5e,getDiffEditors:D5e,onDidCreateEditor:L5e,onDidCreateDiffEditor:k5e,createDiffEditor:T5e,addCommand:I5e,addEditorAction:R5e,addKeybindingRule:A5e,addKeybindingRules:Wte,createModel:M5e,setModelLanguage:O5e,setModelMarkers:P5e,getModelMarkers:B5e,removeAllMarkers:F5e,onDidChangeMarkers:V5e,getModels:H5e,getModel:W5e,onDidCreateModel:z5e,onWillDisposeModel:U5e,onDidChangeModelLanguage:j5e,createWebWorker:$5e,colorizeElement:q5e,colorize:G5e,colorizeModelLine:K5e,tokenize:Q5e,defineTheme:X5e,setTheme:Z5e,remeasureFonts:J5e,registerCommand:eOe,registerLinkOpener:tOe,registerEditorOpener:iOe,AccessibilitySupport:oM,ContentWidgetPositionPreference:dM,CursorChangeReason:fM,DefaultEndOfLine:gM,EditorAutoIndentStrategy:pM,EditorOption:_M,EndOfLinePreference:bM,EndOfLineSequence:CM,MinimapPosition:IM,MinimapSectionHeaderStyle:RM,MouseTargetType:AM,OverlayWidgetPositionPreference:PM,OverviewRulerLane:FM,GlyphMarginLane:wM,RenderLineNumbersType:WM,RenderMinimap:HM,ScrollbarVisibility:UM,ScrollType:zM,TextEditorCursorBlinkingStyle:QM,TextEditorCursorStyle:XM,TrackedRangeStickiness:ZM,WrappingIndent:JM,InjectedTextCursorStops:SM,PositionAffinity:VM,ShowLightbulbIconMode:$M,TextDirection:YM,ConfigurationChangedEvent:fQ,BareFontInfo:Og,FontInfo:UL,TextModelResolvedOptions:Bx,FindMatch:Sw,ApplyUpdateResult:V0,EditorZoom:Du,createMultiFileDiffEditor:N5e,EditorType:vD,EditorOptions:Kr}}function sOe(s,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!s(t))return!1;return!0}function Ex(s,e){return typeof s=="boolean"?s:e}function sG(s,e){return typeof s=="string"?s:e}function rOe(s){const e={};for(const t of s)e[t]=!0;return e}function rG(s,e=!1){e&&(s=s.map(function(i){return i.toLowerCase()}));const t=rOe(s);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function X3(s,e,t){e=e.replace(/@@/g,"");let i=0,n;do n=!1,e=e.replace(/@(\w+)/g,function(o,a){n=!0;let l="";if(typeof s[a]=="string")l=s[a];else if(s[a]&&s[a]instanceof RegExp)l=s[a].source;else throw s[a]===void 0?ii(s,"language definition does not contain attribute '"+a+"', used at: "+e):ii(s,"attribute reference '"+a+"' must be a string, used at: "+e);return Cf(l)?"":"(?:"+l+")"}),i++;while(n&&i<5);e=e.replace(/\x01/g,"@");const r=(s.ignoreCase?"i":"")+(s.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(E0e(s,e,c),r)),l)}return new RegExp(e,r)}function oOe(s,e,t,i){if(i<0)return s;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function aOe(s,e,t,i){let n=-1,r=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(n=parseInt(o[3]),o[2]&&(n=n+100)),r=o[4]);let a="~",l=r;!r||r.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const u=rG(l.split("|"),s.ignoreCase);c=function(d){return a==="~"?u(d):!u(d)}}else if(a==="@"||a==="!@"){const u=s[l];if(!u)throw ii(s,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!sOe(function(g){return typeof g=="string"},u))throw ii(s,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const d=rG(u,s.ignoreCase);c=function(g){return a==="@"?d(g):!d(g)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const u=X3(s,"^"+l+"$",!1);c=function(d){return a==="~"?u.test(d):!u.test(d)}}else c=function(u,d,g,p){return X3(s,"^"+Tu(s,l,d,g,p)+"$",!1).test(u)};else if(l.indexOf("$")<0){const u=Eh(s,l);c=function(d){return a==="=="?d===u:d!==u}}else{const u=Eh(s,l);c=function(d,g,p,_,C){const v=Tu(s,u,g,p,_);return a==="=="?d===v:d!==v}}return n===-1?{name:t,value:i,test:function(u,d,g,p){return c(u,u,d,g,p)}}:{name:t,value:i,test:function(u,d,g,p){const _=oOe(u,d,g,n);return c(_||"",u,d,g,p)}}}function Z3(s,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw ii(s,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw ii(s,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw ii(s,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!D0e(s,Tu(s,n,"",[],""))))throw ii(s,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,s.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,r=t.length;n<r;n++)i[n]=Z3(s,e,t[n]);return{group:i}}else if(t.cases){const i=[];let n=!1;for(const o in t.cases)if(t.cases.hasOwnProperty(o)){const a=Z3(s,e,t.cases[o]);o==="@default"||o==="@"||o===""?i.push({test:void 0,value:a,name:o}):o==="@eos"?i.push({test:function(l,c,u,d){return d},value:a,name:o}):i.push(aOe(s,e,o,a)),n||(n=!Pn(a)&&(a.hasEmbeddedEndInCases||["@pop","@popall"].includes(a.nextEmbedded||"")))}const r=s.defaultToken;return{hasEmbeddedEndInCases:n,test:function(o,a,l,c){for(const u of i)if(!u.test||u.test(o,a,l,c))return u.value;return r}}}else throw ii(s,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class lOe{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw ii(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=X3(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=Z3(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function Hte(s,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:s,includeLF:Ex(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:Ex(e.ignoreCase,!1),unicode:Ex(e.unicode,!1),tokenPostfix:sG(e.tokenPostfix,"."+s),defaultToken:sG(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=s,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(o,a,l){for(const c of l){let u=c.include;if(u){if(typeof u!="string")throw ii(t,"an 'include' attribute must be a string at: "+o);if(u[0]==="@"&&(u=u.substr(1)),!e.tokenizer[u])throw ii(t,"include target '"+u+"' is not defined at: "+o);n(o+"."+u,a,e.tokenizer[u])}else{const d=new lOe(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(d.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")d.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const g=c[1];g.next=c[2],d.setAction(i,g)}else throw ii(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else d.setAction(i,c[1]);else{if(!c.regex)throw ii(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(d.name=c.name),c.matchOnlyAtStart&&(d.matchOnlyAtLineStart=Ex(c.matchOnlyAtLineStart,!1)),d.setRegex(i,c.regex),d.setAction(i,c.action)}a.push(d)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw ii(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,n("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw ii(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(const o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw ii(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")r.push({token:a.token+t.tokenPostfix,open:Eh(t,a.open),close:Eh(t,a.close)});else throw ii(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=r,t.noThrow=!0,t}function cOe(s){d1.registerLanguage(s)}function hOe(){let s=[];return s=s.concat(d1.getLanguages()),s}function uOe(s){return Be.get(En).languageIdCodec.encodeLanguageId(s)}function dOe(s,e){return Be.withServices(()=>{const i=Be.get(En).onDidRequestRichLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function fOe(s,e){return Be.withServices(()=>{const i=Be.get(En).onDidRequestBasicLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function gOe(s,e){if(!Be.get(En).isRegisteredLanguageId(s))throw new Error(`Cannot set configuration for unknown language ${s}`);return Be.get(rc).register(s,e,100)}class mOe{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return dv.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new X2(n.tokens,n.endState)}}class dv{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];let l=a.startIndex;r===0?l=0:l<n&&(l=n),i[r]=new fw(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const r=t.tokenize(i,n),o=dv._toClassicTokens(r.tokens,e);let a;return r.endState.equals(n)?a=n:a=r.endState,new _7(o,a)}tokenize(e,t,i){return dv.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,r=[];let o=0,a=0;for(let c=0,u=t.length;c<u;c++){const d=t[c],g=n.match(i,d.scopes)|1024;if(o>0&&r[o-1]===g)continue;let p=d.startIndex;c===0?p=0:p<a&&(p=a),r[o++]=p,r[o++]=g,a=p}const l=new Uint32Array(o);for(let c=0;c<o;c++)l[c]=r[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),r=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let o;return n.endState.equals(i)?o=i:o=n.endState,new X2(r,o)}}function pOe(s){return typeof s.getInitialState=="function"}function _Oe(s){return"tokenizeEncoded"in s}function zte(s){return s&&typeof s.then=="function"}function bOe(s){const e=Be.get(ba);if(s){const t=[null];for(let i=1,n=s.length;i<n;i++)t[i]=ae.fromHex(s[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function Ute(s,e){return _Oe(e)?new mOe(s,e):new dv(s,e,Be.get(En),Be.get(ba))}function V9(s,e){const t=new kme(async()=>{const i=await Promise.resolve(e.create());return i?pOe(i)?Ute(s,i):new Tw(Be.get(En),Be.get(ba),s,Hte(s,i),Be.get(ai)):null});return qi.registerFactory(s,t)}function COe(s,e){if(!Be.get(En).isRegisteredLanguageId(s))throw new Error(`Cannot set tokens provider for unknown language ${s}`);return zte(e)?V9(s,{create:()=>e}):qi.register(s,Ute(s,e))}function wOe(s,e){const t=i=>new Tw(Be.get(En),Be.get(ba),s,Hte(s,i),Be.get(ai));return zte(e)?V9(s,{create:()=>e}):qi.register(s,t(e))}function vOe(s,e){return Be.get(ei).referenceProvider.register(s,e)}function yOe(s,e){return Be.get(ei).renameProvider.register(s,e)}function SOe(s,e){return Be.get(ei).newSymbolNamesProvider.register(s,e)}function xOe(s,e){return Be.get(ei).signatureHelpProvider.register(s,e)}function LOe(s,e){return Be.get(ei).hoverProvider.register(s,{provideHover:async(i,n,r,o)=>{const a=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,r,o)).then(l=>{if(l)return!l.range&&a&&(l.range=new H(n.lineNumber,a.startColumn,n.lineNumber,a.endColumn)),l.range||(l.range=new H(n.lineNumber,n.column,n.lineNumber,n.column)),l})}})}function kOe(s,e){return Be.get(ei).documentSymbolProvider.register(s,e)}function EOe(s,e){return Be.get(ei).documentHighlightProvider.register(s,e)}function DOe(s,e){return Be.get(ei).linkedEditingRangeProvider.register(s,e)}function TOe(s,e){return Be.get(ei).definitionProvider.register(s,e)}function NOe(s,e){return Be.get(ei).implementationProvider.register(s,e)}function IOe(s,e){return Be.get(ei).typeDefinitionProvider.register(s,e)}function ROe(s,e){return Be.get(ei).codeLensProvider.register(s,e)}function AOe(s,e,t){return Be.get(ei).codeActionProvider.register(s,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(n,r,o,a)=>{const c=Be.get(bm).read({resource:n.uri}).filter(u=>H.areIntersectingOrTouching(u,r));return e.provideCodeActions(n,r,{markers:c,only:o.only,trigger:o.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function MOe(s,e){return Be.get(ei).documentFormattingEditProvider.register(s,e)}function OOe(s,e){return Be.get(ei).documentRangeFormattingEditProvider.register(s,e)}function POe(s,e){return Be.get(ei).onTypeFormattingEditProvider.register(s,e)}function FOe(s,e){return Be.get(ei).linkProvider.register(s,e)}function BOe(s,e){return Be.get(ei).completionProvider.register(s,e)}function VOe(s,e){return Be.get(ei).colorProvider.register(s,e)}function WOe(s,e){return Be.get(ei).foldingRangeProvider.register(s,e)}function HOe(s,e){return Be.get(ei).declarationProvider.register(s,e)}function zOe(s,e){return Be.get(ei).selectionRangeProvider.register(s,e)}function UOe(s,e){return Be.get(ei).documentSemanticTokensProvider.register(s,e)}function jOe(s,e){return Be.get(ei).documentRangeSemanticTokensProvider.register(s,e)}function $Oe(s,e){return Be.get(ei).inlineCompletionsProvider.register(s,e)}function qOe(s,e){return Be.get(ei).inlayHintsProvider.register(s,e)}function GOe(){return{register:cOe,getLanguages:hOe,onLanguage:dOe,onLanguageEncountered:fOe,getEncodedLanguageId:uOe,setLanguageConfiguration:gOe,setColorMap:bOe,registerTokensProviderFactory:V9,setTokensProvider:COe,setMonarchTokensProvider:wOe,registerReferenceProvider:vOe,registerRenameProvider:yOe,registerNewSymbolNameProvider:SOe,registerCompletionItemProvider:BOe,registerSignatureHelpProvider:xOe,registerHoverProvider:LOe,registerDocumentSymbolProvider:kOe,registerDocumentHighlightProvider:EOe,registerLinkedEditingRangeProvider:DOe,registerDefinitionProvider:TOe,registerImplementationProvider:NOe,registerTypeDefinitionProvider:IOe,registerCodeLensProvider:ROe,registerCodeActionProvider:AOe,registerDocumentFormattingEditProvider:MOe,registerDocumentRangeFormattingEditProvider:OOe,registerOnTypeFormattingEditProvider:POe,registerLinkProvider:FOe,registerColorProvider:VOe,registerFoldingRangeProvider:WOe,registerDeclarationProvider:HOe,registerSelectionRangeProvider:zOe,registerDocumentSemanticTokensProvider:UOe,registerDocumentRangeSemanticTokensProvider:jOe,registerInlineCompletionsProvider:$Oe,registerInlayHintsProvider:qOe,DocumentHighlightKind:mM,CompletionItemKind:cM,CompletionItemTag:hM,CompletionItemInsertTextRule:lM,SymbolKind:GM,SymbolTag:KM,IndentAction:yM,CompletionTriggerKind:uM,SignatureHelpTriggerKind:qM,InlayHintKind:xM,InlineCompletionTriggerKind:EM,CodeActionTriggerType:aM,NewSymbolNameTag:MM,NewSymbolNameTriggerKind:OM,PartialAcceptTriggerKind:BM,HoverVerbosityAction:vM,InlineCompletionEndOfLifeReasonKind:LM,InlineCompletionHintStyle:kM,FoldingRangeKind:rM,SelectedSuggestionInfo:Lme,EditDeltaInfo:zk}}const jte=tt("IEditorCancelService"),$te=new Ne("cancellableOperation",!1,w(939,"Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));ut(jte,class{constructor(){this._tokens=new WeakMap}add(s,e){let t=this._tokens.get(s);t||(t=s.invokeWithinContext(n=>{const r=$te.bindTo(n.get(St)),o=new sr;return{key:r,tokens:o}}),this._tokens.set(s,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(s){const e=this._tokens.get(s);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);Ke(new class extends zg{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:$te})}runEditorCommand(s,e){s.get(jte).cancel(e)}});class oG{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class KOe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(oG.toKey(e))}has(e){return this._set.has(oG.toKey(e))}}function YOe(s,e,t){const i=[],n=new KOe,r=s.ordered(t);for(const a of r)i.push(a),a.extensionId&&n.add(a.extensionId);const o=e.ordered(t);for(const a of o){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,u){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,u)}})}return i}const BC=class BC{static setFormatterSelector(e){return{dispose:BC._selectors.unshift(e)}}static async select(e,t,i,n){if(e.length===0)return;const r=_t.first(BC._selectors);if(r)return await r(e,t,i,n)}};BC._selectors=new sr;let J3=BC;async function QOe(s,e,t,i,n,r){const o=e.documentRangeFormattingEditProvider.ordered(t);for(const a of o){const l=await Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,n,r)).catch(s7);if(q2(l))return await s.computeMoreMinimalEdits(t.uri,l)}}async function XOe(s,e,t,i,n){const r=YOe(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const o of r){const a=await Promise.resolve(o.provideDocumentFormattingEdits(t,i,n)).catch(s7);if(q2(a))return await s.computeMoreMinimalEdits(t.uri,a)}}function ZOe(s,e,t,i,n,r,o){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,n,r,o)).catch(s7).then(l=>s.computeMoreMinimalEdits(t.uri,l))}dr.registerCommand("_executeFormatRangeProvider",async function(s,...e){const[t,i,n]=e;Qu(nt.isUri(t)),Qu(H.isIRange(i));const r=s.get(oD),o=s.get(ty),a=s.get(ei),l=await r.createModelReference(t);try{return QOe(o,a,l.object.textEditorModel,H.lift(i),n,lo.None)}finally{l.dispose()}});dr.registerCommand("_executeFormatDocumentProvider",async function(s,...e){const[t,i]=e;Qu(nt.isUri(t));const n=s.get(oD),r=s.get(ty),o=s.get(ei),a=await n.createModelReference(t);try{return XOe(r,o,a.object.textEditorModel,i,lo.None)}finally{a.dispose()}});dr.registerCommand("_executeFormatOnTypeProvider",async function(s,...e){const[t,i,n,r]=e;Qu(nt.isUri(t)),Qu(Y.isIPosition(i)),Qu(typeof n=="string");const o=s.get(oD),a=s.get(ty),l=s.get(ei),c=await o.createModelReference(t);try{return ZOe(a,l,c.object.textEditorModel,Y.lift(i),n,r,lo.None)}finally{c.dispose()}});Kr.wrappingIndent.defaultValue=0;Kr.glyphMargin.defaultValue=!1;Kr.autoIndent.defaultValue=3;Kr.overviewRulerLanes.defaultValue=2;J3.setFormatterSelector((s,e,t)=>Promise.resolve(s[0]));const Xs=kQ();Xs.editor=nOe();Xs.languages=GOe();const JOe=Xs.CancellationTokenSource,e3e=Xs.Emitter,t3e=Xs.KeyCode,i3e=Xs.KeyMod,n3e=Xs.Position,qte=Xs.Range,RE=Xs.Selection,Gte=Xs.SelectionDirection,s3e=Xs.MarkerSeverity,r3e=Xs.MarkerTag,o3e=Xs.Uri,a3e=Xs.Token,l3e=Xs.editor,c3e=Xs.languages,dA=k7(),j_=globalThis;(dA!=null&&dA.globalAPI||typeof j_.define=="function"&&j_.define.amd)&&(j_.monaco=Xs);typeof j_.require<"u"&&typeof j_.require.config=="function"&&j_.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const h3e=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:JOe,Emitter:e3e,KeyCode:t3e,KeyMod:i3e,MarkerSeverity:s3e,MarkerTag:r3e,Position:n3e,Range:qte,Selection:RE,SelectionDirection:Gte,Token:a3e,Uri:o3e,editor:l3e,languages:c3e},Symbol.toStringTag,{value:"Module"}));function u3e(){return h3e}const fA=globalThis.MonacoEnvironment;fA!=null&&fA.globalAPI&&(globalThis.monaco=u3e());const d3e=()=>{let s=!0;return(e,t)=>{if(s){s=!1;try{e()}finally{s=!0}}else t!==void 0&&t()}};class f3e{constructor(e,t,i){this.start=e,this.end=t,this.direction=i}}const g3e=(s,e,t)=>{const i=s.getSelection();if(i!==null){const n=i.getStartPosition(),r=i.getEndPosition(),o=TL(t,e.getOffsetAt(n)),a=TL(t,e.getOffsetAt(r));return new f3e(o,a,i.getDirection())}return null},m3e=(s,e,t,i)=>{const n=NL(t.start,i),r=NL(t.end,i);if(n!==null&&r!==null&&n.type===e&&r.type===e){const o=s.getModel(),a=o.getPositionAt(n.index),l=o.getPositionAt(r.index);return RE.createWithDirection(a.lineNumber,a.column,l.lineNumber,l.column,t.direction)}return null};class p3e{constructor(e,t,i=new Set,n=null){this.doc=e.doc,this.ytext=e,this.monacoModel=t,this.editors=i,this.mux=d3e(),this._savedSelections=new Map,this._beforeTransaction=()=>{this.mux(()=>{this._savedSelections=new Map,i.forEach(r=>{if(r.getModel()===t){const o=g3e(r,t,e);o!==null&&this._savedSelections.set(r,o)}})})},this.doc.on("beforeAllTransactions",this._beforeTransaction),this._decorations=new Map,this._rerenderDecorations=()=>{i.forEach(r=>{if(n&&r.getModel()===t){const o=this._decorations.get(r)||[],a=[];n.getStates().forEach((l,c)=>{if(c!==this.doc.clientID&&l.selection!=null&&l.selection.anchor!=null&&l.selection.head!=null){const u=NL(l.selection.anchor,this.doc),d=NL(l.selection.head,this.doc);if(u!==null&&d!==null&&u.type===e&&d.type===e){let g,p,_,C;u.index<d.index?(g=t.getPositionAt(u.index),p=t.getPositionAt(d.index),_="yRemoteSelectionHead yRemoteSelectionHead-"+c,C=null):(g=t.getPositionAt(d.index),p=t.getPositionAt(u.index),_=null,C="yRemoteSelectionHead yRemoteSelectionHead-"+c),a.push({range:new qte(g.lineNumber,g.column,p.lineNumber,p.column),options:{className:"yRemoteSelection yRemoteSelection-"+c,afterContentClassName:_,beforeContentClassName:C}})}}}),this._decorations.set(r,r.deltaDecorations(o,a))}else this._decorations.delete(r)})},this._ytextObserver=r=>{this.mux(()=>{let o=0;r.delta.forEach(a=>{if(a.retain!==void 0)o+=a.retain;else if(a.insert!==void 0){const l=t.getPositionAt(o),c=new RE(l.lineNumber,l.column,l.lineNumber,l.column),u=a.insert;t.applyEdits([{range:c,text:u}]),o+=u.length}else if(a.delete!==void 0){const l=t.getPositionAt(o),c=t.getPositionAt(o+a.delete),u=new RE(l.lineNumber,l.column,c.lineNumber,c.column);t.applyEdits([{range:u,text:""}])}else throw fa()}),this._savedSelections.forEach((a,l)=>{const c=m3e(l,e,a,this.doc);c!==null&&l.setSelection(c)})}),this._rerenderDecorations()},e.observe(this._ytextObserver);{const r=e.toString();t.getValue()!==r&&t.setValue(r)}this._monacoChangeHandler=t.onDidChangeContent(r=>{this.mux(()=>{this.doc.transact(()=>{r.changes.sort((o,a)=>a.rangeOffset-o.rangeOffset).forEach(o=>{e.delete(o.rangeOffset,o.rangeLength),e.insert(o.rangeOffset,o.text)})},this)})}),this._monacoDisposeHandler=t.onWillDispose(()=>{this.destroy()}),n&&(i.forEach(r=>{r.onDidChangeCursorSelection(()=>{if(r.getModel()===t){const o=r.getSelection();if(o===null)return;let a=t.getOffsetAt(o.getStartPosition()),l=t.getOffsetAt(o.getEndPosition());if(o.getDirection()===Gte.RTL){const c=a;a=l,l=c}n.setLocalStateField("selection",{anchor:TL(e,a),head:TL(e,l)})}}),n.on("change",this._rerenderDecorations)}),this.awareness=n)}destroy(){this._monacoChangeHandler.dispose(),this._monacoDisposeHandler.dispose(),this.ytext.unobserve(this._ytextObserver),this.doc.off("beforeAllTransactions",this._beforeTransaction),this.awareness&&this.awareness.off("change",this._rerenderDecorations)}}class _3e{constructor(e,t){if(this.unsubscribe=null,this.isDestroyed=!1,this.lastUpdate=null,this.roomName=e,this.doc=t,this.awareness=new b3e(t),!kt){console.warn("[FirebaseProvider] Firebase not available");return}const i=bn(kt,`collab/${e}/doc`);this.unsubscribe=LL(i,r=>{if(this.isDestroyed)return;const o=r.val();if(o&&o.update)try{const a=this.base64ToUint8Array(o.update);(!this.lastUpdate||!this.arraysEqual(a,this.lastUpdate))&&cde(this.doc,a)}catch(a){console.error("[FirebaseProvider] Error applying update:",a)}}),this.doc.on("update",(r,o)=>{this.isDestroyed||o==="firebase"||this.syncToFirebase()});const n=bn(kt,`collab/${e}/awareness`);LL(n,r=>{if(this.isDestroyed)return;const o=r.val();o&&this.awareness.setRemoteStates(o)}),this.awareness.on("change",()=>{if(this.isDestroyed)return;const r=this.awareness.getLocalState();if(r&&kt){const o=this.awareness.clientID;jr(bn(kt,`collab/${e}/awareness/${o}`),{...r,lastUpdated:Date.now()}).catch(console.error),ace(bn(kt,`collab/${e}/awareness/${o}`)).remove()}}),console.log("[FirebaseProvider] Connected to room:",e)}syncToFirebase(){if(!kt||this.isDestroyed)return;const e=dde(this.doc);this.lastUpdate=e,jr(bn(kt,`collab/${this.roomName}/doc`),{update:this.uint8ArrayToBase64(e),timestamp:Date.now()}).catch(console.error)}uint8ArrayToBase64(e){let t="";for(let i=0;i<e.byteLength;i++)t+=String.fromCharCode(e[i]);return btoa(t)}base64ToUint8Array(e){const t=atob(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i}arraysEqual(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}destroy(){this.isDestroyed=!0,this.unsubscribe&&this.unsubscribe(),this.awareness.destroy(),console.log("[FirebaseProvider] Destroyed")}disconnect(){this.destroy()}}class b3e{constructor(e){this.states=new Map,this.localState=null,this.listeners=new Set,this.doc=e,this.clientID=e.clientID}setLocalState(e){this.localState=e,this.states.set(this.clientID,e),this.emit()}setLocalStateField(e,t){this.localState={...this.localState,[e]:t},this.states.set(this.clientID,this.localState),this.emit()}getLocalState(){return this.localState}getStates(){return this.states}setRemoteStates(e){const t=this.states.size;for(const[i,n]of Object.entries(e)){const r=parseInt(i);r!==this.clientID&&n.lastUpdated&&Date.now()-n.lastUpdated<3e4&&this.states.set(r,n)}this.states.size!==t&&this.emit()}on(e,t){e==="change"&&this.listeners.add(t)}off(e,t){e==="change"&&this.listeners.delete(t)}emit(){for(const e of this.listeners)e()}destroy(){this.listeners.clear()}}const C3e=(s,e)=>{if(e)return"#9333ea";let t=0;for(let n=0;n<s.length;n++)t=s.charCodeAt(n)+((t<<5)-t);return`hsl(${t%360}, 70%, 50%)`},w3e=({sessionCode:s,isTeacher:e,participantId:t,editorInstance:i,monacoInstance:n})=>{const r=_e.useRef(null),o=_e.useRef(null),a=_e.useRef(null),[l,c]=_e.useState(!1),[u,d]=_e.useState(new Map),g=_e.useCallback(_=>{if(r.current){const C=r.current.getText("monaco");r.current.transact(()=>{C.delete(0,C.length),C.insert(0,_)})}},[]),p=_e.useCallback(()=>r.current?r.current.getText("monaco").toString():"",[]);return _e.useEffect(()=>{if(!s||!i||!n)return;console.log("[Collab] Setting up collaborative editing for session:",s);const _=new A1;r.current=_;const C=new _3e(`session-${s}`,_);o.current=C;const v=C.awareness,x=C3e(t,e);v.setLocalStateField("user",{name:e?" Teacher":" Student",color:x,isTeacher:e}),c(!0);const S=()=>{const T=v.getStates(),R=new Map;T.forEach((N,A)=>{N.user&&A!==v.clientID&&R.set(A,N.user)}),d(R)};v.on("change",S),S();const k=_.getText("monaco"),E=new p3e(k,i.getModel(),new Set([i]));return a.current=E,console.log("[Collab] Collaborative editing ready (Firebase sync)"),()=>{console.log("[Collab] Cleaning up collaborative editing"),E.destroy(),C.destroy(),_.destroy(),r.current=null,o.current=null,a.current=null,c(!1),d(new Map)}},[s,i,n,e,t]),{isConnected:l,collaborators:u,setText:g,getText:p}},v3e=({chapter:s,currentChallengeIndex:e,onNextChallenge:t,onPrevChallenge:i,onSelectChallenge:n,isLocked:r})=>{const o=s.challenges[e],{runCode:a,isRunning:l,clearOutput:c,output:u}=OP(),{isInSession:d,isTeacher:g,sessionCode:p,participantId:_,syncOutput:C,playgroundMode:v,playgroundCode:x,setPlaygroundMode:S,syncPlaygroundCode:k}=JK(),[E,T]=_e.useState((o==null?void 0:o.starterCode)||""),[R,N]=_e.useState(""),[A,O]=_e.useState(!1),[W,j]=_e.useState(!1),F=_e.useRef(null),q=_e.useRef(null),[Z,K]=_e.useState(!1),U=_e.useRef(null),G=e===s.challenges.length-1,Q=G&&s.challenges.length>5,{isConnected:le,collaborators:ve,setText:V}=w3e({sessionCode:d?p:null,isTeacher:g,participantId:_,editorInstance:Z?F.current:null,monacoInstance:Z?q.current:null}),ce=(Xe,lt)=>{F.current=Xe,q.current=lt,K(!0),o!=null&&o.starterCode&&Xe.setValue(o.starterCode)};_e.useEffect(()=>{if(o&&U.current!==o.id){U.current=o.id;const Xe=o.starterCode||"";T(Xe),O(!1),j(!1),c(),d&&F.current?le?V(Xe):F.current.setValue(Xe):F.current&&F.current.setValue(Xe)}},[o==null?void 0:o.id,o==null?void 0:o.starterCode,c,d,le,V]),_e.useEffect(()=>{d&&!g&&u.length>0&&C(u)},[d,g,u,C]);const oe=_e.useCallback(()=>{var lt;const Xe=((lt=F.current)==null?void 0:lt.getValue())||E;Xe.trim()&&(v?a(Xe):a(Xe,o==null?void 0:o.testCases))},[E,a,o,v]);_e.useEffect(()=>{const Xe=lt=>{(lt.ctrlKey||lt.metaKey)&&lt.key==="Enter"&&(lt.preventDefault(),oe())};return window.addEventListener("keydown",Xe),()=>window.removeEventListener("keydown",Xe)},[oe]);const Se=()=>{if(o){const Xe=o.starterCode||"";T(Xe),c(),le?V(Xe):F.current&&F.current.setValue(Xe)}},me=_e.useCallback(Xe=>{T(Xe||""),v&&d&&k(Xe||"")},[v,d,k]),Oe=_e.useCallback(()=>{var Xe;if(v)R&&F.current&&(F.current.setValue(R),T(R)),S(!1);else{const lt=((Xe=F.current)==null?void 0:Xe.getValue())||E;N(lt);const xs=x||`# Playground - experiment freely!

`;F.current&&F.current.setValue(xs),T(xs),S(!0)}c()},[v,R,E,x,S,c]),it=ve.size;return z.jsxs("div",{className:"flex h-full w-full bg-[#1e1e1e] overflow-hidden",children:[z.jsxs("div",{className:"w-[380px] min-w-[320px] flex flex-col border-r border-[#3c3c3c] bg-[#252526] h-full",children:[z.jsxs("div",{className:"p-5 border-b border-[#3c3c3c] bg-gradient-to-r from-[#1e1e1e] to-[#252526]",children:[z.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[z.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:z.jsx("span",{className:"text-white font-bold text-sm",children:e+1})}),z.jsxs("div",{className:"flex-1 min-w-0",children:[z.jsx("h2",{className:"text-base font-semibold text-white truncate",children:s.title}),z.jsx("p",{className:"text-xs text-slate-400",children:s.description})]})]}),z.jsxs("div",{className:"mt-3",children:[z.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1.5",children:[z.jsx("span",{children:"Progress"}),z.jsxs("span",{className:"text-blue-400",children:[e+1," / ",s.challenges.length]})]}),z.jsx("div",{className:"h-1.5 bg-[#3c3c3c] rounded-full overflow-hidden",children:z.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full transition-all duration-500 ease-out",style:{width:`${(e+1)/s.challenges.length*100}%`}})})]})]}),z.jsxs("div",{className:"flex-1 overflow-y-auto",children:[z.jsxs("div",{className:"p-5",children:[Q&&z.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-500/30 rounded-lg",children:[z.jsxs("div",{className:"flex items-center gap-2 text-amber-400 font-semibold text-sm",children:[z.jsx("span",{children:""}),z.jsx("span",{children:"FINAL ASSESSMENT"})]}),z.jsx("p",{className:"text-xs text-amber-200/70 mt-1",children:"Complete this challenge to master the chapter!"})]}),z.jsx("h3",{className:"text-lg font-bold text-white mb-3 leading-tight",children:(o==null?void 0:o.title)||`Challenge ${o==null?void 0:o.number}`}),z.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:z.jsx("p",{className:"text-slate-300 leading-relaxed text-sm",children:o==null?void 0:o.description})}),(o==null?void 0:o.hint)&&z.jsxs("div",{className:"mt-5",children:[z.jsxs("button",{onClick:()=>O(!A),className:"flex items-center gap-2 text-amber-400 hover:text-amber-300 text-sm font-medium transition-colors",children:[z.jsx("span",{className:"text-lg",children:A?"":""}),z.jsx("span",{children:A?"Hide Hint":"Need a hint?"})]}),A&&z.jsx("div",{className:"mt-3 p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg animate-fade-in",children:z.jsx("p",{className:"text-amber-200/90 text-sm leading-relaxed",children:o.hint})})]}),(o==null?void 0:o.solutionCode)&&z.jsxs("div",{className:"mt-4",children:[z.jsxs("button",{onClick:()=>j(!W),className:"flex items-center gap-2 text-purple-400 hover:text-purple-300 text-sm font-medium transition-colors",children:[z.jsx("span",{className:"text-lg",children:W?"":""}),z.jsx("span",{children:W?"Hide Solution":"Reveal Solution"})]}),W&&z.jsx("div",{className:"mt-3 p-4 bg-purple-500/10 border border-purple-500/20 rounded-lg animate-fade-in",children:z.jsx("pre",{className:"text-purple-200/90 text-xs font-mono overflow-x-auto whitespace-pre-wrap",children:o.solutionCode})})]})]}),z.jsx("div",{className:"px-5 pb-5",children:z.jsxs("div",{className:"p-4 bg-[#1e1e1e] rounded-lg border border-[#3c3c3c]",children:[z.jsx("h4",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"Quick Tips"}),z.jsxs("ul",{className:"space-y-2 text-xs text-slate-400",children:[z.jsxs("li",{className:"flex items-start gap-2",children:[z.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),z.jsxs("span",{children:["Press ",z.jsx("kbd",{className:"px-1.5 py-0.5 bg-[#3c3c3c] rounded text-white",children:"Ctrl"})," + ",z.jsx("kbd",{className:"px-1.5 py-0.5 bg-[#3c3c3c] rounded text-white",children:"Enter"})," to run"]})]}),z.jsxs("li",{className:"flex items-start gap-2",children:[z.jsx("span",{className:"text-blue-400 mt-0.5",children:""}),z.jsx("span",{children:"Your code auto-saves in the editor"})]}),z.jsxs("li",{className:"flex items-start gap-2",children:[z.jsx("span",{className:"text-amber-400 mt-0.5",children:""}),z.jsxs("span",{children:["Test with ",z.jsx("code",{className:"text-amber-200",children:"print()"})," statements"]})]})]})]})})]}),z.jsx("div",{className:"p-4 border-t border-[#3c3c3c] bg-[#1e1e1e]",children:z.jsxs("div",{className:"flex items-center justify-between gap-3",children:[z.jsx("button",{onClick:i,disabled:e===0,className:"px-4 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-[#3c3c3c] rounded-lg transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:" Previous"}),z.jsx("div",{className:"flex items-center gap-1.5 overflow-x-auto max-w-[140px] py-1",children:s.challenges.map((Xe,lt)=>z.jsx("button",{onClick:()=>n(lt),className:`w-2.5 h-2.5 rounded-full transition-all flex-shrink-0 ${lt===e?"bg-blue-500 scale-125":lt<e?"bg-emerald-500/60 hover:bg-emerald-400":"bg-[#3c3c3c] hover:bg-slate-500"}`,title:`Challenge ${lt+1}`},lt))}),z.jsx("button",{onClick:t,disabled:G,className:`px-4 py-2 text-sm font-medium rounded-lg transition-all ${G?"bg-emerald-600 text-white cursor-default":"text-slate-400 hover:text-white hover:bg-[#3c3c3c]"}`,children:G?" Complete":"Next "})]})})]}),z.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#1e1e1e]",children:[z.jsxs("div",{className:"h-12 bg-[#252526] border-b border-[#3c3c3c] flex items-center justify-between px-4",children:[z.jsxs("div",{className:"flex items-center gap-3",children:[z.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#1e1e1e] rounded-md border border-[#3c3c3c]",children:[z.jsx("span",{className:"text-yellow-500 text-sm",children:""}),z.jsx("span",{className:"text-xs text-slate-300 font-mono",children:"main.py"})]}),z.jsx("button",{onClick:Se,className:"text-xs text-slate-500 hover:text-slate-300 transition-colors",title:"Reset to starter code",children:" Reset"})]}),z.jsxs("div",{className:"flex items-center gap-3",children:[d&&z.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-md border ${le?"bg-emerald-600/20 border-emerald-500/30":"bg-yellow-600/20 border-yellow-500/30"}`,children:[z.jsx("span",{className:`w-2 h-2 rounded-full ${le?"bg-emerald-400 animate-pulse":"bg-yellow-400"}`}),z.jsx("span",{className:`text-xs font-medium ${le?"text-emerald-400":"text-yellow-400"}`,children:le?` Live Collab ${it>0?`(${it+1})`:""}`:" Connecting..."})]}),d&&g&&z.jsx("button",{onClick:Oe,className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium transition-all ${v?"bg-purple-600 text-white shadow-lg shadow-purple-900/50":"bg-[#3c3c3c] text-slate-400 hover:bg-[#4c4c4c] hover:text-white"}`,title:v?"Return to Challenge":"Enter Playground Mode",children:v?" Challenges":" Playground"}),z.jsx("span",{className:"text-xs text-slate-500",children:l?"Executing...":d?"Collaborative":"Ready"}),z.jsx("button",{onClick:oe,disabled:l,className:`flex items-center gap-2 px-5 py-2 rounded-lg text-sm font-bold transition-all shadow-lg ${l?"bg-slate-600 cursor-wait text-slate-300":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-400 hover:to-emerald-500 text-white"}`,children:l?z.jsxs(z.Fragment,{children:[z.jsx("span",{className:"animate-spin",children:""}),"Running..."]}):z.jsxs(z.Fragment,{children:[z.jsx("span",{children:""}),"Run Code"]})})]})]}),z.jsx("div",{className:"flex-1 relative min-h-0",children:z.jsx(Ihe,{height:"100%",defaultLanguage:"python",defaultValue:(o==null?void 0:o.starterCode)||"",onChange:me,onMount:ce,theme:"vs-dark",options:{minimap:{enabled:!1},fontSize:15,fontFamily:"'JetBrains Mono', 'Fira Code', Consolas, monospace",lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:4,padding:{top:16,bottom:16},cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",smoothScrolling:!0,renderLineHighlight:"all",bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0},readOnly:!1}})}),z.jsx("div",{className:"h-[35%] min-h-[180px] border-t border-[#3c3c3c]",children:z.jsx(Ahe,{})})]}),z.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; transform: translateY(-4px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
          animation: fade-in 0.2s ease-out;
        }
      `})]})},y3e=({chapters:s,unlockedMap:e,onUnlock:t,onLock:i,globalUnlockedMap:n,onGlobalUnlock:r,onGlobalLock:o,onClose:a})=>{const l=(d,g)=>{g?i(d):t(d)},c=(d,g)=>{g?o(d):r(d)},u=Object.values(e).filter(Boolean).length;return z.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[100] p-4",children:z.jsxs("div",{className:"bg-[#1e1e1e] border border-[#3c3c3c] rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[z.jsxs("div",{className:"px-6 py-4 border-b border-[#3c3c3c] flex items-center justify-between bg-gradient-to-r from-indigo-600/20 to-purple-600/20",children:[z.jsxs("div",{children:[z.jsx("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:" Teacher Control Panel"}),z.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[u," of ",s.length," chapters unlocked"]})]}),z.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-lg",children:z.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),z.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:z.jsx("div",{className:"space-y-2",children:s.map((d,g)=>{const p=e[d.id]||!1,_=n[d.id]||!1;return z.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border transition-all ${p?"bg-emerald-900/10 border-emerald-700/30":"bg-[#2d2d2d] border-[#3c3c3c]"}`,children:[z.jsxs("div",{className:"flex items-center gap-4",children:[z.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${p?"bg-emerald-600 text-white":"bg-[#3c3c3c] text-gray-400"}`,children:g+1}),z.jsxs("div",{children:[z.jsx("h3",{className:"font-semibold text-white",children:d.title}),z.jsx("p",{className:"text-sm text-gray-400",children:d.description}),z.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[d.challenges.length," challenges"]})]})]}),z.jsxs("div",{className:"flex items-center gap-3",children:[z.jsxs("div",{className:"flex flex-col items-end",children:[z.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-wider mb-1",children:"Session / Local"}),z.jsx("button",{onClick:()=>l(d.id,p),className:`px-3 py-1.5 rounded-md font-medium text-sm transition-all flex items-center gap-2 ${p?"bg-emerald-600/20 text-emerald-400 border border-emerald-600/50":"bg-zinc-700 text-zinc-400 hover:bg-zinc-600"}`,children:p?"Unlocked":"Locked"})]}),z.jsx("div",{className:"w-px h-8 bg-[#3c3c3c] mx-2"}),z.jsxs("div",{className:"flex flex-col items-end",children:[z.jsxs("span",{className:"text-[10px] text-blue-400 uppercase tracking-wider mb-1 flex items-center gap-1",children:[z.jsx("span",{children:""})," Global"]}),z.jsx("button",{onClick:()=>c(d.id,_),className:`px-3 py-1.5 rounded-md font-medium text-sm transition-all flex items-center gap-2 ${_?"bg-blue-600 text-white shadow-lg shadow-blue-900/50":"bg-zinc-800 text-zinc-500 hover:bg-zinc-700 border border-zinc-700"}`,children:_?"Active":"Off"})]})]})]},d.id)})})}),z.jsx("div",{className:"px-6 py-4 border-t border-[#3c3c3c] bg-[#252526]",children:z.jsxs("div",{className:"flex items-center justify-between",children:[z.jsxs("p",{className:"text-sm text-gray-400",children:[" Tip: Press ",z.jsx("kbd",{className:"px-2 py-1 bg-[#3c3c3c] rounded text-xs",children:"Ctrl+Shift+T"})," to toggle teacher mode"]}),z.jsx("button",{onClick:a,className:"px-4 py-2 bg-[#3c3c3c] text-white rounded-lg hover:bg-[#4c4c4c] transition-colors",children:"Done"})]})})]})})},S3e=({onSoloMode:s,onJoinSession:e,onCreateSession:t,isTeacherMode:i})=>{const[n,r]=_e.useState("choose"),[o,a]=_e.useState(""),[l,c]=_e.useState(""),[u,d]=_e.useState(""),[g,p]=_e.useState(!1),_=async()=>{if(o.length!==6){d("Please enter a 6-character code");return}p(!0),d(""),await e(o.toUpperCase())||d("Session not found. Please check the code."),p(!1)},C=async()=>{p(!0),d("");try{const x=await t();c(x),r("create")}catch{d("Failed to create session")}p(!1)},v=()=>{navigator.clipboard.writeText(l)};return z.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-[#0a0a0f] via-[#1a1a2e] to-[#0a0a0f] flex items-center justify-center z-50",children:z.jsxs("div",{className:"bg-[#1e1e1e] border border-[#3c3c3c] rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[z.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-600/20 to-purple-600/20 border-b border-[#3c3c3c]",children:z.jsxs("div",{className:"flex items-center gap-3",children:[z.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:z.jsx("span",{className:"text-2xl",children:""})}),z.jsxs("div",{children:[z.jsx("h1",{className:"text-xl font-bold text-white",children:"Python Tutoring"}),z.jsx("p",{className:"text-sm text-slate-400",children:"Choose how you'd like to learn"})]})]})}),z.jsxs("div",{className:"p-6",children:[n==="choose"&&z.jsxs("div",{className:"space-y-4",children:[z.jsx("button",{onClick:s,className:"w-full p-5 bg-[#252526] hover:bg-[#2d2d2d] border border-[#3c3c3c] rounded-xl text-left transition-all group",children:z.jsxs("div",{className:"flex items-center gap-4",children:[z.jsx("div",{className:"w-12 h-12 bg-emerald-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:z.jsx("span",{className:"text-2xl",children:""})}),z.jsxs("div",{children:[z.jsx("h3",{className:"text-lg font-semibold text-white",children:"Practice on Your Own"}),z.jsx("p",{className:"text-sm text-slate-400",children:"Learn at your own pace, offline"})]})]})}),z.jsx("button",{onClick:()=>r("join"),className:"w-full p-5 bg-[#252526] hover:bg-[#2d2d2d] border border-[#3c3c3c] rounded-xl text-left transition-all group",children:z.jsxs("div",{className:"flex items-center gap-4",children:[z.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:z.jsx("span",{className:"text-2xl",children:""})}),z.jsxs("div",{children:[z.jsx("h3",{className:"text-lg font-semibold text-white",children:"Join a Session"}),z.jsx("p",{className:"text-sm text-slate-400",children:"Enter a code from your teacher"})]})]})}),i&&z.jsx("button",{onClick:C,disabled:g,className:"w-full p-5 bg-gradient-to-r from-indigo-600/20 to-purple-600/20 hover:from-indigo-600/30 hover:to-purple-600/30 border border-indigo-500/30 rounded-xl text-left transition-all group",children:z.jsxs("div",{className:"flex items-center gap-4",children:[z.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:z.jsx("span",{className:"text-2xl",children:""})}),z.jsxs("div",{children:[z.jsx("h3",{className:"text-lg font-semibold text-white",children:g?"Creating...":"Start a Teaching Session"}),z.jsx("p",{className:"text-sm text-slate-400",children:"Generate a code for students to join"})]})]})})]}),n==="join"&&z.jsxs("div",{className:"space-y-4",children:[z.jsx("button",{onClick:()=>{r("choose"),d("")},className:"text-slate-400 hover:text-white text-sm flex items-center gap-1 transition-colors",children:" Back"}),z.jsxs("div",{children:[z.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Enter Session Code"}),z.jsx("input",{type:"text",value:o,onChange:x=>a(x.target.value.toUpperCase().slice(0,6)),placeholder:"ABC123",className:"w-full px-4 py-4 bg-[#252526] border border-[#3c3c3c] rounded-xl text-white text-2xl font-mono tracking-[0.5em] text-center focus:outline-none focus:border-blue-500 transition-colors uppercase",autoFocus:!0})]}),u&&z.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 text-sm",children:u}),z.jsx("button",{onClick:_,disabled:g||o.length!==6,className:"w-full py-4 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-400 hover:to-blue-500 text-white font-semibold rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Joining...":"Join Session"})]}),n==="create"&&z.jsxs("div",{className:"space-y-4 text-center",children:[z.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto",children:z.jsx("span",{className:"text-3xl",children:""})}),z.jsx("h3",{className:"text-lg font-semibold text-white",children:"Session Created!"}),z.jsx("p",{className:"text-sm text-slate-400",children:"Share this code with your student:"}),z.jsxs("div",{className:"relative",children:[z.jsx("div",{className:"px-6 py-5 bg-[#252526] border border-[#3c3c3c] rounded-xl text-3xl font-mono tracking-[0.5em] text-emerald-400 text-center",children:l}),z.jsx("button",{onClick:v,className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 hover:bg-[#3c3c3c] rounded-lg transition-colors",title:"Copy to clipboard",children:z.jsx("span",{className:"text-lg",children:""})})]}),z.jsx("button",{onClick:s,className:"w-full py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-400 hover:to-emerald-500 text-white font-semibold rounded-xl transition-all",children:"Continue to Dashboard"})]})]}),z.jsx("div",{className:"px-6 py-4 bg-[#252526] border-t border-[#3c3c3c]",children:z.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Mr Stewart Python Tutoring"})})]})})},x3e=({sessionCode:s,isTeacher:e,participantCount:t,onLeave:i})=>{const n=()=>{navigator.clipboard.writeText(s)};return z.jsxs("div",{className:"h-8 bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-between px-4 text-white text-sm z-50 shadow-lg",children:[z.jsx("div",{className:"flex items-center gap-4",children:e?z.jsxs(z.Fragment,{children:[z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsx("span",{className:"opacity-80",children:""}),z.jsx("span",{className:"font-medium",children:"Session:"}),z.jsx("button",{onClick:n,className:"px-2 py-0.5 bg-white/20 hover:bg-white/30 rounded font-mono tracking-wider transition-colors",title:"Click to copy",children:s})]}),z.jsx("div",{className:"h-4 w-px bg-white/30"}),z.jsxs("span",{className:"opacity-80",children:[t-1," student",t-1!==1?"s":""," connected"]})]}):z.jsxs(z.Fragment,{children:[z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),z.jsx("span",{children:"Connected to session"})]}),z.jsx("div",{className:"h-4 w-px bg-white/30"}),z.jsxs("span",{className:"opacity-80",children:["Code: ",s]})]})}),z.jsx("button",{onClick:i,className:"px-3 py-1 text-xs bg-white/10 hover:bg-white/20 rounded transition-colors",children:"Leave Session"})]})},Jo={"01_basics":[{title:"Personal Introduction Generator",brief:"Create a program to generate personalized introduction cards using helper functions.",bullets:["Implement `get_full_name(first, last)` to return 'Last, First'.","Implement `calculate_birth_year(age)` to return the estimated birth year.","Implement `format_introduction(name, age, hobby)` to return a summary string.","Implement `generate_card(first, last, age, hobby)` that calls all helpers to return the final card."]}],"02_if_statements":[{title:"Smart Ticket Pricing System",brief:"Design a movie ticket pricing system with age and time-based discounts.",bullets:["Implement `get_age_discount(age)` to apply discounts for kids/seniors.","Implement `is_matinee(hour)` to check if the showtime qualifies for a discount.","Implement `calculate_final_price(age, hour, is_tuesday)` to compute total cost.","Ensure Tuesday discounts are applied after other reductions."]}],"03_strings":[{title:"Username & Email Validator",brief:"Build a system to validate and format user registration data.",bullets:["Implement `clean_username(raw_input)` to strip whitespace and lowercase.","Implement `validate_email(email)` to check for a single '@' symbol.","Implement `extract_domain(email)` to return the domain part.","Implement `create_user_tag(full_name)` to generate a handle like '@johnsmith'.","Implement `format_user_summary(name, email)` to return a cleaned data summary."]}],"04_maths":[{title:"Restaurant Bill Calculator",brief:"Create a bill splitting system with tax and tip calculations.",bullets:["Implement `calculate_subtotal(items)` to sum a list of prices.","Implement `apply_tax(amount, tax_rate)` to add tax (default 8.25%).","Implement `calculate_tip(amount, tip_percent)` to calculate the tip amount.","Implement `split_bill(total, num_people)` to divide the total evenly.","Implement `generate_receipt(items, tax_rate, tip_percent, num_people)` to return the final breakdown."]}],"05_for_loops":[{title:"Math Quiz Generator",brief:"Create a multiplication practice program that tracks user performance.",bullets:["Implement `generate_problem(table, multiplier)` to return a question/answer pair.","Implement `check_answer(user_ans, correct_ans)` to return True/False.","Implement `calculate_score(correct, total)` to return a percentage.","Implement `generate_quiz(table, questions)` to create a list of problems.","Implement `grade_quiz(answers, solutions)` to identify incorrect responses."]}],"06_while_loops":[{title:"Number Guessing Game",brief:"Build a guessing game with hints and attempt tracking.",bullets:["Implement `get_hint(guess, target)` to return 'too high' or 'too low'.","Implement `get_temperature(guess, target)` to return proximity (e.g., 'hot', 'cold').","Implement `play_round(target, max_attempts)` to run a single game loop.","Implement `calculate_stats(history)` to summarize wins and losses."]}],"07_random":[{title:"Dice Roller Simulator",brief:"Create a dice rolling tool for board games.",bullets:["Implement `roll_die(sides)` to return a random number 1-sides.","Implement `roll_multiple(num_dice, sides)` to return a list of rolls.","Implement `get_roll_stats(rolls)` to return sum and average.","Implement `check_critical_success(roll, sides)` to return True if max value rolled."]}],"08_lists_dicts":[{title:"Playlist Manager",brief:"Create a music playlist manager with search and analysis features.",bullets:["Implement `add_song(playlist, song)` to add unique songs.","Implement `remove_song(playlist, song)` to delete a song if it exists.","Implement `find_longest_song(playlist)` to return the title with the most characters.","Implement `get_playlist_stats(playlist)` to return count and length stats.","Implement `search_songs(playlist, keyword)` to find matches."]},{title:"Word Frequency Analyzer",brief:"Create a tool to analyze word patterns in text.",bullets:["Implement `count_words(text)` to return frequencies (case-insensitive).","Implement `get_top_words(counts, n)` to return the most common words.","Implement `find_unique_words(text)` to find words appearing exactly once.","Implement `compare_texts(text1, text2)` to find common and unique vocabulary.","Implement `generate_report(text)` to produce a full analysis."]}],"09_more_strings":[{title:"Text Transformation Toolkit",brief:"Build a collection of utilities for cleaning and formatting text.",bullets:["Implement `to_title_case(text)` to capitalize words.","Implement `to_snake_case(text)` to convert to 'hello_world' format.","Implement `reverse_words(text)` to reverse word order.","Implement `remove_extra_spaces(text)` to collapse multiple spaces.","Implement `is_valid_identifier(text)` to check for valid variable names."]}],"10_arrays":[{title:"Grade Book Processor",brief:"Build a system to transform and analyze student grades.",bullets:["Implement `curve_scores(scores, amount)` to adjust grades (capped at 100).","Implement `drop_lowest(scores)` to remove the minimum value.","Implement `calculate_letter_grades(scores)` to convert numbers to letters.","Implement `filter_passing(students)` to return students with scores >= 60.","Implement `grade_distribution(scores)` to count each letter grade."]}],"11_2d_lists_dicts":[{title:"Student Management System",brief:"Design a system to manage student records, grades, and rosters.",bullets:["Implement `add_student(students, name)` to create a new record.","Implement `add_grade(students, id, course, grade)` to record a score.","Implement `get_student_gpa(student)` to calculate the average.","Implement `get_honor_roll(students)` to find high achievers.","Implement `get_class_statistics(students)` to return GPA metrics."]}],"12_subprograms":[{title:"Mini Shopping Cart",brief:"Build an e-commerce cart system with inventory and discounts.",bullets:["Implement `add_to_cart(cart, inventory, item, qty)` to update the cart.","Implement `remove_from_cart(cart, item, qty)` to reduce or remove items.","Implement `calculate_cart_total(cart)` to sum the cost.","Implement `apply_coupon(total, code)` to handle discounts.","Implement `checkout(cart, inventory, coupon)` to finalize the order."]}]},L3e=[{id:"001",number:1,title:"Hello Name",description:"Write a function called `hello_name` that accepts a first name. It should return a string in the format 'Hello [first_name]'.",hint:"Use f-string: f'Hello {first_name}'",starterCode:`def hello_name(first_name: str) -> str:
    # Your code here
    pass`,solutionCode:`def hello_name(first_name: str) -> str:
    return f"Hello {first_name}"`,testCases:[{input:"hello_name('Bob')",expected:"'Hello Bob'"},{input:"hello_name('Alice')",expected:"'Hello Alice'"}]},{id:"002",number:2,title:"Hello Full Name",description:"Write a function called `hello_full_name` that accepts a first name and a surname. It should return a greeting including both names, like 'Hello [first_name] [surname]'.",hint:"Use f-string",starterCode:`def hello_full_name(first_name: str, surname: str) -> str:
    # Your code here
    pass`,solutionCode:`def hello_full_name(first_name: str, surname: str) -> str:
    return f"Hello {first_name} {surname}"`,testCases:[{input:"hello_full_name('Bob', 'Smith')",expected:"'Hello Bob Smith'"}]},{id:"003",number:3,title:"Joke",description:"Write a function called `joke` that takes no arguments. It should return this specific joke: 'What do you call a bear with no teeth?\\nA gummy bear!'.",starterCode:`def joke() -> str:
    # Your code here
    pass`,solutionCode:`def joke() -> str:
    return "What do you call a bear with no teeth?\\nA gummy bear!"`,testCases:[{input:"joke()",expected:"'What do you call a bear with no teeth?\\nA gummy bear!'"}]},{id:"004",number:4,title:"Add Two Numbers",description:"Write a function called `add_two` that accepts two integers. It should return the sum of these two numbers.",starterCode:`def add_two(num1: int, num2: int) -> int:
    # Your code here
    pass`,solutionCode:`def add_two(num1: int, num2: int) -> int:
    return num1 + num2`,testCases:[{input:"add_two(2, 3)",expected:"5"},{input:"add_two(10, -5)",expected:"5"}]},{id:"005",number:5,title:"Add and Multiply",description:"Write a function called `add_and_multiply` that accepts three numbers. It should add the first two numbers together, then multiply the result by the third number, returning the final answer.",starterCode:`def add_and_multiply(num1: int, num2: int, num3: int) -> int:
    # Your code here
    pass`,solutionCode:`def add_and_multiply(num1: int, num2: int, num3: int) -> int:
    return (num1 + num2) * num3`,testCases:[{input:"add_and_multiply(2, 3, 4)",expected:"20"}]},{id:"006",number:6,title:"Pizza Slices",description:"Write a function called `pizza_left` that accepts the number of slices started with and the number eaten. It should return the message 'You have [x] slices remaining'.",starterCode:`def pizza_left(started: int, eaten: int) -> str:
    # Your code here
    pass`,solutionCode:`def pizza_left(started: int, eaten: int) -> str:
    return f"You have {started - eaten} slices remaining"`,testCases:[{input:"pizza_left(8, 3)",expected:"'You have 5 slices remaining'"}]},{id:"007",number:7,title:"Next Birthday",description:"Write a function called `birthday_message` that takes a name and current age. It should add 1 to the age and return the message '[Name] next birthday you will be [new_age]'.",starterCode:`def birthday_message(name: str, age: int) -> str:
    # Your code here
    pass`,solutionCode:`def birthday_message(name: str, age: int) -> str:
    return f"{name} next birthday you will be {age + 1}"`,testCases:[{input:"birthday_message('Bob', 20)",expected:"'Bob next birthday you will be 21'"}]},{id:"008",number:8,title:"Bill Splitter",description:"Write a function called `split_bill` that accepts the total price of a bill and the number of diners. It should divide the bill equally and return the cost per person.",starterCode:`def split_bill(total_price: float, diners: int) -> float:
    # Your code here
    pass`,solutionCode:`def split_bill(total_price: float, diners: int) -> float:
    return total_price / diners`,testCases:[{input:"split_bill(100, 4)",expected:"25.0"}]},{id:"009",number:9,title:"Days To Duration",description:"Write a function called `days_seconds` that accepts a number of days. It should calculate how many hours, minutes, and seconds are in that many days and return a string like 'In [days] days there are [hours] hours, [minutes] minutes and [seconds] seconds'.",starterCode:`def days_seconds(days: int) -> str:
    # Your code here
    pass`,solutionCode:`def days_seconds(days: int) -> str:
    hours = days * 24
    minutes = hours * 60
    seconds = minutes * 60
    return f"In {days} days there are {hours} hours, {minutes} minutes and {seconds} seconds"`,testCases:[{input:"days_seconds(1)",expected:"'In 1 days there are 24 hours, 1440 minutes and 86400 seconds'"}]},{id:"010",number:10,title:"Weight Converter",description:"Write a function called `kg_to_pounds` that takes a weight in kilograms. It should convert this to pounds (multiplying by 2.204) and return the result.",starterCode:`def kg_to_pounds(kg: float) -> float:
    # Your code here
    pass`,solutionCode:`def kg_to_pounds(kg: float) -> float:
    return kg * 2.204`,testCases:[{input:"kg_to_pounds(10)",expected:"22.04"}]},{id:"011",number:11,title:"Division Strings",description:"Write a function called `division_info` that accepts a large number and a small number. It should check how many whole times the small number fits into the large number and return the message '[small] goes into [large] [result] times'.",starterCode:`def division_info(large: int, small: int) -> str:
    # Your code here
    pass`,solutionCode:`def division_info(large: int, small: int) -> str:
    result = large // small
    return f"{small} goes into {large} {result} times"`,testCases:[{input:"division_info(100, 10)",expected:"'10 goes into 100 10 times'"}]}],k3e=[{id:"012",number:12,title:"Order Numbers",description:"Write a function called `order_numbers` that accepts two numbers. It should determine which is smaller and return them as a single string, with the smaller number first and the larger number second, separated by a space (e.g., '5 10').",starterCode:`def order_numbers(num1: int, num2: int) -> str:
    # Your code here
    pass`,solutionCode:`def order_numbers(num1: int, num2: int) -> str:
    if num1 > num2:
        return f"{num2} {num1}"
    return f"{num1} {num2}"`,testCases:[{input:"order_numbers(10, 5)",expected:"'5 10'"},{input:"order_numbers(5, 10)",expected:"'5 10'"},{input:"order_numbers(3, 3)",expected:"'3 3'"},{input:"order_numbers(-5, 2)",expected:"'-5 2'"},{input:"order_numbers(100, 1)",expected:"'1 100'"}]},{id:"013",number:13,title:"Check Under 20",description:"Write a function called `check_under_20` that takes a number. If the number is 20 or higher, return 'Too high'. If it is under 20, return 'Thank you'.",starterCode:`def check_under_20(num: int) -> str:
    # Your code here
    pass`,solutionCode:`def check_under_20(num: int) -> str:
    if num >= 20:
        return "Too high"
    return "Thank you"`,testCases:[{input:"check_under_20(25)",expected:"'Too high'"},{input:"check_under_20(10)",expected:"'Thank you'"},{input:"check_under_20(20)",expected:"'Too high'"},{input:"check_under_20(19)",expected:"'Thank you'"},{input:"check_under_20(0)",expected:"'Thank you'"}]},{id:"014",number:14,title:"Check Range",description:"Write a function called `check_range` that accepts a number. If the number is between 10 and 20 (inclusive), return 'Thank you'. Otherwise, return 'Incorrect answer'.",starterCode:`def check_range(num: int) -> str:
    # Your code here
    pass`,solutionCode:`def check_range(num: int) -> str:
    if 10 <= num <= 20:
        return "Thank you"
    return "Incorrect answer"`,testCases:[{input:"check_range(15)",expected:"'Thank you'"},{input:"check_range(21)",expected:"'Incorrect answer'"},{input:"check_range(10)",expected:"'Thank you'"},{input:"check_range(20)",expected:"'Thank you'"},{input:"check_range(9)",expected:"'Incorrect answer'"}]},{id:"015",number:15,title:"Favourite Colour",description:"Write a function called `check_colour` that takes a colour name. If the colour is 'red' (checking valid variations like 'RED' or 'Red'), return 'I like red too'. Otherwise, return 'I don't like [colour], I prefer red'.",starterCode:`def check_colour(colour: str) -> str:
    # Your code here
    pass`,solutionCode:`def check_colour(colour: str) -> str:
    if colour.lower() == "red":
        return "I like red too"
    return f"I don't like {colour}, I prefer red"`,testCases:[{input:"check_colour('Red')",expected:"'I like red too'"},{input:"check_colour('RED')",expected:"'I like red too'"},{input:"check_colour('red')",expected:"'I like red too'"},{input:"check_colour('Blue')",expected:"'I don\\'t like Blue, I prefer red'"},{input:"check_colour('green')",expected:"'I don\\'t like green, I prefer red'"}]},{id:"016",number:16,title:"Weather Check",description:"Write a function called `check_weather` that takes two string arguments: `is_raining` and `is_windy` (values 'yes' or 'no'). If it is raining, check if it is windy. If it is windy, return 'It is too windy for an umbrella'. If it is not windy, return 'Take an umbrella'. If it is not raining, return 'Enjoy your day'.",starterCode:`def check_weather(is_raining: str, is_windy: str) -> str:
    # Your code here
    pass`,solutionCode:`def check_weather(is_raining: str, is_windy: str) -> str:
    if is_raining.lower() == "yes":
        if is_windy.lower() == "yes":
            return "It is too windy for an umbrella"
        return "Take an umbrella"
    return "Enjoy your day"`,testCases:[{input:"check_weather('yes', 'No')",expected:"'Take an umbrella'"},{input:"check_weather('Yes', 'YES')",expected:"'It is too windy for an umbrella'"},{input:"check_weather('no', 'yes')",expected:"'Enjoy your day'"},{input:"check_weather('NO', 'no')",expected:"'Enjoy your day'"},{input:"check_weather('yes', 'no')",expected:"'Take an umbrella'"}]},{id:"017",number:17,title:"Voting Age",description:"Write a function called `check_age` that takes an age. Return 'You can vote' if age is 18+, 'You can learn to drive' if 17, 'You can buy a lottery ticket' if 16, or 'You can go Trick-or-Treating' if under 16.",starterCode:`def check_age(age: int) -> str:
    # Your code here
    pass`,solutionCode:`def check_age(age: int) -> str:
    if age >= 18:
        return "You can vote"
    if age == 17:
        return "You can learn to drive"
    if age == 16:
        return "You can buy a lottery ticket"
    return "You can go Trick-or-Treating"`,testCases:[{input:"check_age(18)",expected:"'You can vote'"},{input:"check_age(15)",expected:"'You can go Trick-or-Treating'"},{input:"check_age(17)",expected:"'You can learn to drive'"},{input:"check_age(16)",expected:"'You can buy a lottery ticket'"},{input:"check_age(25)",expected:"'You can vote'"}]},{id:"018",number:18,title:"Basic Range",description:"Write a function called `check_number` that takes a number. If it is under 10, return 'Too low'. If it is between 10 and 20 (inclusive), return 'Correct'. If it is over 20, return 'Too high'.",starterCode:`def check_number(num: int) -> str:
    # Your code here
    pass`,solutionCode:`def check_number(num: int) -> str:
    if num < 10:
        return "Too low"
    if num <= 20:
        return "Correct"
    return "Too high"`,testCases:[{input:"check_number(5)",expected:"'Too low'"},{input:"check_number(15)",expected:"'Correct'"},{input:"check_number(25)",expected:"'Too high'"},{input:"check_number(10)",expected:"'Correct'"},{input:"check_number(20)",expected:"'Correct'"}]},{id:"019",number:19,title:"Selection",description:"Write a function called `check_selection` that takes a number (1, 2, or 3). If 1 return 'Thank you', if 2 return 'Well done', if 3 return 'Correct'. For any other number, return 'Error message'.",starterCode:`def check_selection(num: int) -> str:
    # Your code here
    pass`,solutionCode:`def check_selection(num: int) -> str:
    if num == 1:
        return "Thank you"
    if num == 2:
        return "Well done"
    if num == 3:
        return "Correct"
    return "Error message"`,testCases:[{input:"check_selection(1)",expected:"'Thank you'"},{input:"check_selection(2)",expected:"'Well done'"},{input:"check_selection(3)",expected:"'Correct'"},{input:"check_selection(5)",expected:"'Error message'"},{input:"check_selection(0)",expected:"'Error message'"}]},{id:"020",number:20,title:"Grade Calculator",description:"Write a function called `get_grade` that takes a score (0-100). Return 'A' for 90+, 'B' for 80-89, 'C' for 70-79, 'D' for 60-69, and 'F' for below 60.",starterCode:`def get_grade(score: int) -> str:
    # Your code here
    pass`,solutionCode:`def get_grade(score: int) -> str:
    if score >= 90:
        return "A"
    if score >= 80:
        return "B"
    if score >= 70:
        return "C"
    if score >= 60:
        return "D"
    return "F"`,testCases:[{input:"get_grade(95)",expected:"'A'"},{input:"get_grade(85)",expected:"'B'"},{input:"get_grade(75)",expected:"'C'"},{input:"get_grade(65)",expected:"'D'"},{input:"get_grade(55)",expected:"'F'"}]},{id:"021",number:21,title:"Password Strength",description:"Write a function called `check_password` that takes a password string. Return 'Weak' if it has fewer than 6 characters, 'Medium' if 6-9 characters, and 'Strong' if 10 or more characters.",starterCode:`def check_password(password: str) -> str:
    # Your code here
    pass`,solutionCode:`def check_password(password: str) -> str:
    if len(password) < 6:
        return "Weak"
    if len(password) < 10:
        return "Medium"
    return "Strong"`,testCases:[{input:"check_password('abc')",expected:"'Weak'"},{input:"check_password('abcdef')",expected:"'Medium'"},{input:"check_password('abcdefghij')",expected:"'Strong'"},{input:"check_password('12345')",expected:"'Weak'"},{input:"check_password('password1')",expected:"'Medium'"}]}],E3e=[{id:"022",number:22,title:"Name Length",description:"Write a function called `name_length` that takes a name as a string. It should return the number of characters in the name.",starterCode:`def name_length(name: str) -> int:
    # Your code here
    pass`,solutionCode:`def name_length(name: str) -> int:
    return len(name)`,testCases:[{input:"name_length('Bob')",expected:"3"},{input:"name_length('Alice')",expected:"5"},{input:"name_length('')",expected:"0"},{input:"name_length('Python Programming')",expected:"18"}]},{id:"023",number:23,title:"Join Names",description:"Write a function called `join_names` that accepts a first name and a last name. It should return them combined with the total length of the full name (including the space), like '[First] [Last] [Length]'.",starterCode:`def join_names(first: str, last: str) -> str:
    # Your code here
    pass`,solutionCode:`def join_names(first: str, last: str) -> str:
    full = f"{first} {last}"
    return f"{full} {len(full)}"`,testCases:[{input:"join_names('Bob', 'Smith')",expected:"'Bob Smith 9'"},{input:"join_names('Ann', 'Lee')",expected:"'Ann Lee 7'"},{input:"join_names('Christopher', 'Williams')",expected:"'Christopher Williams 20'"},{input:"join_names('A', 'B')",expected:"'A B 3'"}]},{id:"024",number:24,title:"Title Case Names",description:"Write a function called `format_name_title` that takes a first name and a last name in lower case. It should return them combined in title case (capitalized first letters), separated by a space.",starterCode:`def format_name_title(first: str, last: str) -> str:
    # Your code here
    pass`,solutionCode:`def format_name_title(first: str, last: str) -> str:
    return f"{first.title()} {last.title()}"`,testCases:[{input:"format_name_title('bob', 'smith')",expected:"'Bob Smith'"},{input:"format_name_title('ALICE', 'JONES')",expected:"'Alice Jones'"},{input:"format_name_title('jOhN', 'dOe')",expected:"'John Doe'"},{input:"format_name_title('mary', 'jane')",expected:"'Mary Jane'"}]},{id:"025",number:25,title:"String Slice",description:"Write a function called `rhyme_part` that takes a line of text, a start index, and an end index. It should return the part of the string starting at the start index and ending before the end index.",starterCode:`def rhyme_part(line: str, start: int, end: int) -> str:
    # Your code here
    pass`,solutionCode:`def rhyme_part(line: str, start: int, end: int) -> str:
    return line[start:end]`,testCases:[{input:"rhyme_part('Mary had a little lamb', 0, 4)",expected:"'Mary'"},{input:"rhyme_part('Hello World', 6, 11)",expected:"'World'"},{input:"rhyme_part('Python', 0, 2)",expected:"'Py'"},{input:"rhyme_part('abcdef', 2, 5)",expected:"'cde'"}]},{id:"026",number:26,title:"Upper Case",description:"Write a function called `make_upper` that takes a word. It should return the word converted entirely to uppercase.",starterCode:`def make_upper(word: str) -> str:
    # Your code here
    pass`,solutionCode:`def make_upper(word: str) -> str:
    return word.upper()`,testCases:[{input:"make_upper('hello')",expected:"'HELLO'"},{input:"make_upper('Python')",expected:"'PYTHON'"},{input:"make_upper('ABC')",expected:"'ABC'"},{input:"make_upper('MixedCase')",expected:"'MIXEDCASE'"}]},{id:"027",number:27,title:"Lower Case",description:"Write a function called `make_lower` that takes a word. It should return the word converted entirely to lowercase.",starterCode:`def make_lower(word: str) -> str:
    # Your code here
    pass`,solutionCode:`def make_lower(word: str) -> str:
    return word.lower()`,testCases:[{input:"make_lower('HELLO')",expected:"'hello'"},{input:"make_lower('Python')",expected:"'python'"},{input:"make_lower('abc')",expected:"'abc'"},{input:"make_lower('MixedCase')",expected:"'mixedcase'"}]},{id:"028",number:28,title:"Name Formatting",description:"Write a function called `format_name_conditional` that takes a first name and a last name. If the first name has fewer than 5 characters, join them together and return the result in uppercase. If the first name is 5 characters or longer, return just the first name in lowercase.",starterCode:`def format_name_conditional(first: str, last: str) -> str:
    # Your code here
    pass`,solutionCode:`def format_name_conditional(first: str, last: str) -> str:
    if len(first) < 5:
        return f"{first}{last}".upper()
    return first.lower()`,testCases:[{input:"format_name_conditional('Bob', 'Smith')",expected:"'BOBSMITH'"},{input:"format_name_conditional('Steven', 'Stewart')",expected:"'steven'"},{input:"format_name_conditional('Amy', 'Wong')",expected:"'AMYWONG'"},{input:"format_name_conditional('James', 'Bond')",expected:"'james'"}]},{id:"029",number:29,title:"Pig Latin",description:"Write a function called `pig_latin` that takes a word. If it begins with a vowel (a, e, i, o, u), add 'way' to the end. If it begins with a consonant, move the first letter to the end and add 'ay'.",starterCode:`def pig_latin(word: str) -> str:
    # Your code here
    pass`,solutionCode:`def pig_latin(word: str) -> str:
    vowels = "aeiou"
    word = word.lower()
    if word[0] in vowels:
        return word + "way"
    return word[1:] + word[0] + "ay"`,testCases:[{input:"pig_latin('apple')",expected:"'appleway'"},{input:"pig_latin('chip')",expected:"'hipcay'"},{input:"pig_latin('orange')",expected:"'orangeway'"},{input:"pig_latin('hello')",expected:"'ellohay'"}]},{id:"030",number:30,title:"Reverse String",description:"Write a function called `reverse_string` that takes a string and returns it reversed.",starterCode:`def reverse_string(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def reverse_string(text: str) -> str:
    return text[::-1]`,testCases:[{input:"reverse_string('hello')",expected:"'olleh'"},{input:"reverse_string('Python')",expected:"'nohtyP'"},{input:"reverse_string('a')",expected:"'a'"},{input:"reverse_string('12345')",expected:"'54321'"}]},{id:"031",number:31,title:"Count Vowels",description:"Write a function called `count_vowels` that takes a string and returns the count of vowels (a, e, i, o, u) in it. Count both uppercase and lowercase vowels.",starterCode:`def count_vowels(text: str) -> int:
    # Your code here
    pass`,solutionCode:`def count_vowels(text: str) -> int:
    vowels = "aeiouAEIOU"
    count = 0
    for char in text:
        if char in vowels:
            count += 1
    return count`,testCases:[{input:"count_vowels('hello')",expected:"2"},{input:"count_vowels('Python')",expected:"1"},{input:"count_vowels('AEIOU')",expected:"5"},{input:"count_vowels('xyz')",expected:"0"}]}],D3e=[{id:"027",number:27,title:"Multiply Float",description:"Write a function called `multiply_float` that takes a floating-point number. It should multiply the number by 2 and return the result.",starterCode:`def multiply_float(num: float) -> float:
    # Your code here
    pass`,solutionCode:`def multiply_float(num: float) -> float:
    return num * 2`,testCases:[{input:"multiply_float(3.5)",expected:"7.0"}]},{id:"028",number:28,title:"Round Float",description:"Write a function called `round_float` that takes a number. It should multiply the number by 2 and return the result rounded to two decimal places.",starterCode:`def round_float(num: float) -> float:
    # Your code here
    pass`,solutionCode:`def round_float(num: float) -> float:
    return round(num * 2, 2)`,testCases:[{input:"round_float(3.14159)",expected:"6.28"}]},{id:"029",number:29,title:"Sqrt Over 500",description:"Write a function called `sqrt_check` that takes a number. Calculate the square root of that number and return it rounded to two decimal places.",hint:"Use `math.sqrt()`. Remember `import math`.",starterCode:`import math

def sqrt_check(num: int) -> float:
    # Your code here
    pass`,solutionCode:`import math

def sqrt_check(num: int) -> float:
    return round(math.sqrt(num), 2)`,testCases:[{input:"sqrt_check(500)",expected:"22.36"}]},{id:"030",number:30,title:"Pi",description:"Write a function called `get_pi` that takes no arguments. It should return the value of Pi (from the math library) rounded to 5 decimal places.",starterCode:`import math

def get_pi() -> float:
    # Your code here
    pass`,solutionCode:`import math

def get_pi() -> float:
    return round(math.pi, 5)`,testCases:[{input:"get_pi()",expected:"3.14159"}]},{id:"031",number:31,title:"Circle Area",description:"Write a function called `circle_area` that takes the radius of a circle. It should calculate and return the area of the circle (Pi * radius squared).",starterCode:`import math

def circle_area(radius: float) -> float:
    # Your code here
    pass`,solutionCode:`import math

def circle_area(radius: float) -> float:
    return math.pi * (radius ** 2)`,testCases:[{input:"round(circle_area(10), 2)",expected:"314.16"}]},{id:"032",number:32,title:"Cylinder Volume",description:"Write a function called `cylinder_volume` that takes a radius and a depth. It should calculate the volume of the cylinder (area of circle * depth) and return it rounded to 3 decimal places.",starterCode:`import math

def cylinder_volume(radius: float, depth: float) -> float:
    # Your code here
    pass`,solutionCode:`import math

def cylinder_volume(radius: float, depth: float) -> float:
    area = math.pi * (radius ** 2)
    return round(area * depth, 3)`,testCases:[{input:"cylinder_volume(5, 10)",expected:"785.398"}]},{id:"033",number:33,title:"Integer Division",description:"Write a function called `div_remain` that accepts two numbers. It should return a string showing the result of integer division and the remainder, formatted as '[num1] divided by [num2] is [whole_part] with [remainder] remaining'.",starterCode:`def div_remain(num1: int, num2: int) -> str:
    # Your code here
    pass`,solutionCode:`def div_remain(num1: int, num2: int) -> str:
    whole = num1 // num2
    remain = num1 % num2
    return f"{num1} divided by {num2} is {whole} with {remain} remaining"`,testCases:[{input:"div_remain(7, 2)",expected:"'7 divided by 2 is 3 with 1 remaining'"}]},{id:"034",number:34,title:"Shape Area",description:"Write a function called `shape_area` that takes a choice (1 or 2) and two values. If choice is 1, calculate the area of a square using the first value as the length of a side. If choice is 2, calculate the area of a triangle using the first value as the base and the second as the height. If the choice is anything else, return -1.",starterCode:`def shape_area(choice: int, val1: int, val2: int) -> float:
    # Your code here
    pass`,solutionCode:`def shape_area(choice: int, val1: int, val2: int) -> float:
    if choice == 1:
        return val1 ** 2
    if choice == 2:
        return 0.5 * val1 * val2
    return -1`,testCases:[{input:"shape_area(1, 10, 0)",expected:"100"},{input:"shape_area(2, 10, 5)",expected:"25.0"}]}],T3e=[{id:"035",number:35,title:"Name Repeat",description:"Write a function called `name_repeat` that takes a name. It should return the name repeated three times, with each repetition on a new line.",starterCode:`def name_repeat(name: str) -> str:
    # Your code here
    pass`,solutionCode:`def name_repeat(name: str) -> str:
    return (name + "\\n") * 3`,testCases:[{input:"name_repeat('Bob').strip()",expected:"'Bob\\nBob\\nBob'"}]},{id:"036",number:36,title:"Name Count",description:"Write a function called `name_count` that accepts a name and a number. It should return the name repeated that many times, with each repetition on a new line.",starterCode:`def name_count(name: str, count: int) -> str:
    # Your code here
    pass`,solutionCode:`def name_count(name: str, count: int) -> str:
    return (name + "\\n") * count`,testCases:[{input:"name_count('Bob', 2).strip()",expected:"'Bob\\nBob'"}]},{id:"037",number:37,title:"Name Chars",description:"Write a function called `name_chars` that takes a name. It should return a string where every character of the name is on a new line.",starterCode:`def name_chars(name: str) -> str:
    # Your code here
    pass`,solutionCode:`def name_chars(name: str) -> str:
    output = ""
    for char in name:
        output += char + "\\n"
    return output`,testCases:[{input:"name_chars('Bob').strip()",expected:"'B\\no\\nb'"}]},{id:"038",number:38,title:"Name Chars Count",description:"Write a function called `name_chars_count` that takes a name and a number. It should iterate through each character of the name and display it that many times, with each repetition on a new line.",starterCode:`def name_chars_count(name: str, count: int) -> str:
    # Your code here
    pass`,solutionCode:`def name_chars_count(name: str, count: int) -> str:
    output = ""
    for x in name:
        for i in range(count):
            output += x + "\\n"
    return output`,testCases:[{input:"name_chars_count('Bo', 2).strip()",expected:"'B\\nB\\no\\no'"}]},{id:"039",number:39,title:"Times Table",description:"Write a function called `times_table` that takes a number. It should return a string containing the times table for that number from 1 to 10, formatted as '1 x [num] = [result]', '2 x [num] = [result]', etc., each on a new line.",starterCode:`def times_table(num: int) -> str:
    # Your code here
    pass`,solutionCode:`def times_table(num: int) -> str:
    output = ""
    for i in range(1, 11):
        output += f"{i} x {num} = {i * num}\\n"
    return output`,testCases:[{input:"times_table(5).splitlines()[0]",expected:"'1 x 5 = 5'"},{input:"times_table(5).splitlines()[4]",expected:"'5 x 5 = 25'"}]},{id:"040",number:40,title:"Count Down",description:"Write a function called `count_down_50` that takes a number (below 50). It should return a list of numbers counting down from 50 to that number (inclusive).",starterCode:`def count_down_50(num: int) -> list:
    # Your code here
    pass`,solutionCode:`def count_down_50(num: int) -> list:
    output = []
    for i in range(50, num - 1, -1):
        output.append(i)
    return output`,testCases:[{input:"count_down_50(48)",expected:"[50, 49, 48]"}]},{id:"041",number:41,title:"Name Conditional Loop",description:"Write a function called `name_loop_conditional` that takes a name and a number. If the number is less than 10, return the name repeated that many times. If the number is 10 or higher, return the message 'Too high' three times.",starterCode:`def name_loop_conditional(name: str, count: int) -> str:
    # Your code here
    pass`,solutionCode:`def name_loop_conditional(name: str, count: int) -> str:
    if count < 10:
        return (name + "\\n") * count
    return ("Too high\\n") * 3`,testCases:[{input:"name_loop_conditional('Bob', 2).strip()",expected:"'Bob\\nBob'"},{input:"name_loop_conditional('Bob', 12).strip()",expected:"'Too high\\nToo high\\nToo high'"}]},{id:"042",number:42,title:"Sum List",description:"Write a function called `sum_list` that accepts a list of numbers. It should calculate and return the total sum of all the numbers in the list.",starterCode:`def sum_list(nums: list) -> int:
    # Your code here
    pass`,solutionCode:`def sum_list(nums: list) -> int:
    total = 0
    for i in nums:
        total += i
    return total`,testCases:[{input:"sum_list([1, 2, 3, 4, 5])",expected:"15"}]},{id:"043",number:43,title:"Count Direction",description:"Write a function called `count_direction` that takes a direction ('up' or 'down') and a number. If 'up', return a list of numbers from 1 to that number. If 'down', return a list of numbers from 20 down to that number. Otherwise, return an empty list.",starterCode:`def count_direction(direction: str, num: int) -> list:
    # Your code here
    pass`,solutionCode:`def count_direction(direction: str, num: int) -> list:
    output = []
    if direction == "up":
        for i in range(1, num + 1):
            output.append(i)
    elif direction == "down":
        for i in range(20, num - 1, -1):
            output.append(i)
    return output`,testCases:[{input:"count_direction('up', 3)",expected:"[1, 2, 3]"},{input:"count_direction('down', 18)",expected:"[20, 19, 18]"}]},{id:"044",number:44,title:"Invite Guests",description:"Write a function called `invite_guests` that accepts a list of guest names. If there look to be fewer than 10 guests, return a string saying '[Name] has been invited' for each one. If there are 10 or more, return 'Too many people'.",starterCode:`def invite_guests(guests: list) -> str:
    # Your code here
    pass`,solutionCode:`def invite_guests(guests: list) -> str:
    if len(guests) < 10:
        output = ""
        for name in guests:
            output += f"{name} has been invited\\n"
        return output
    return "Too many people"`,testCases:[{input:"invite_guests(['Bob', 'Alice']).strip()",expected:"'Bob has been invited\\nAlice has been invited'"}]}],N3e=[{id:"045",number:45,title:"Sum To 50",description:"Write a function called `sum_until_50` that takes a list of numbers. Iterate through the list, adding each number to a running total. If the total becomes greater than 50, stop immediately and return that total (including the number that pushed it over 50).",starterCode:`def sum_until_50(nums: list) -> int:
    # Your code here
    pass`,solutionCode:`def sum_until_50(nums: list) -> int:
    total = 0
    for num in nums:
        total += num
        if total > 50:
            break
    return total`,testCases:[{input:"sum_until_50([10, 20, 30])",expected:"60"}]},{id:"046",number:46,title:"Validate Input 5",description:"Write a function called `validate_5` that takes a list of numbers. It should iterate through the list and return the first number found that is greater than 5. If no such number involves, return 0.",starterCode:`def validate_5(nums: list) -> int:
    # Your code here
    pass`,solutionCode:`def validate_5(nums: list) -> int:
    for num in nums:
        if num > 5:
            return num
    return 0`,testCases:[{input:"validate_5([1, 2, 6])",expected:"6"}]},{id:"047",number:47,title:"Sum Sequence",description:"Write a function called `sum_sequence` that accepts a list of numbers. It should calculate and return the sum of all the numbers in the list (using a loop).",starterCode:`def sum_sequence(nums: list) -> int:
    # Your code here
    pass`,solutionCode:`def sum_sequence(nums: list) -> int:
    total = 0
    for num in nums:
        total += num
    return total`,testCases:[{input:"sum_sequence([1, 2, 3])",expected:"6"}]},{id:"048",number:48,title:"Party Invite Count",description:"Write a function called `count_invited` that takes a list of names. It should iterate through the list and verify if a guest is invited. Return a count of how many people were valid guests (basically, just count the items in the list to simulate checking).",starterCode:`def count_invites(responses: list) -> int:
    # Your code here
    pass`,solutionCode:`def count_invites(responses: list) -> int:
    count = 0
    for res in responses:
        if res == "yes":
            count += 1
    return count`,testCases:[{input:"count_invites(['yes', 'no', 'yes'])",expected:"2"}]},{id:"049",number:49,title:"Guess Loop-Attempts",description:"Create `guess_attempts(target, guesses: list)`. Return number of attempts to find target in guesses (return index + 1). If not found return -1.",starterCode:`def guess_attempts(target: int, guesses: list) -> int:
    # Your code here
    pass`,solutionCode:`def guess_attempts(target: int, guesses: list) -> int:
    attempts = 0
    for guess in guesses:
        attempts += 1
        if guess == target:
            return attempts
    return -1`,testCases:[{input:"guess_attempts(5, [1, 2, 5, 8])",expected:"3"}]},{id:"050",number:50,title:"Range Validation",description:"Create `validate_range_loop(inputs: list)`. Return first value between 10 and 20 (inclusive).",starterCode:`def validate_range_loop(inputs: list) -> int:
    # Your code here
    pass`,solutionCode:`def validate_range_loop(inputs: list) -> int:
    for x in inputs:
        if 10 <= x <= 20:
            return x
    return 0`,testCases:[{input:"validate_range_loop([5, 25, 15, 30])",expected:"15"}]},{id:"051",number:51,title:"Green Bottles",description:"Write a function called `green_bottles` that takes a number `num`. It should return the message 'There are [num] green bottles hanging on the wall'. If `num` is 0, return 'There are no more green bottles hanging on the wall'.",starterCode:`def bottles_lyrics(start: int) -> str:
    # Your code here
    pass`,solutionCode:`def bottles_lyrics(start: int) -> str:
    lyrics = ""
    num = start
    while num > 0:
        lyrics += f"There are {num} green bottles hanging on the wall\\n"
        lyrics += f"And if one green bottle should accidentally fall\\n"
        num -= 1
        lyrics += f"There will be {num} green bottles hanging on the wall\\n"
    return lyrics`,testCases:[{input:"bottles_lyrics(2).count('hanging on the wall')",expected:"4"}]}],I3e=[{id:"052",number:52,title:"Random Int",description:"Write a function called `random_int`. It should generate and return a random integer between 1 and 100 (inclusive).",starterCode:`import random
def get_random_int() -> int:
    # Your code here
    pass`,solutionCode:`import random
def get_random_int() -> int:
    return random.randint(1, 100)`,testCases:[{input:"import random; random.seed(1); get_random_int()",expected:"18"}]},{id:"053",number:53,title:"Random Fruit",description:"Write a function called `random_fruit` that takes no arguments. It should pick a random fruit from the list ['apple', 'banana', 'cherry', 'date', 'elderberry'] and return it.",starterCode:`import random
def get_random_fruit() -> str:
    # Your code here
    pass`,solutionCode:`import random
def get_random_fruit() -> str:
    fruits = ['apple', 'banana', 'cherry', 'date', 'elderberry']
    return random.choice(fruits)`,testCases:[{input:"import random; random.seed(1); get_random_fruit()",expected:"'banana'"}]},{id:"054",number:54,title:"Coin Toss",description:"Write a function called `guess_number` that takes a `guess` and a `comp_num` (target). If the guess is lower than the target, return 'Too low'. If it is higher, return 'Too high'. If it is the same, return 'Correct'.",starterCode:`import random
def coin_toss(user_choice: str) -> str:
    # Your code here
    pass`,solutionCode:`import random
def coin_toss(user_choice: str) -> str:
    flip = random.choice(['h', 't'])
    if user_choice == flip:
        return "You win"
    return "Bad luck"`,testCases:[{input:"import random; random.seed(1); coin_toss('h')",expected:"'Bad luck'"}]},{id:"055",number:55,title:"Random Guess Feedback",description:"Write a function called `pick_number`. It should check if a random number between 1 and 5 is equal to the user's choice. If it matches, return 'Well done'. If the user's choice is too high, return 'Too high'. If too low, return 'Too low'.",starterCode:`import random
def random_feedback(guess: int) -> str:
    # Your code here
    pass`,solutionCode:`import random
def random_feedback(guess: int) -> str:
    num = random.randint(1, 5)
    if guess == num:
        return "Well done"
    if guess > num:
        return "Too high"
    return "Too low"`,testCases:[{input:"import random; random.seed(1); random_feedback(2)",expected:"'Too low'"}]},{id:"056",number:56,title:"Random Loop",description:"Create `random_loop(guesses: list)`. Random 1-10. Iterate guesses. Return 'Correct' if found. Return 'Not found' if list ends.",starterCode:`import random
def random_loop(guesses: list) -> str:
    # Your code here
    pass`,solutionCode:`import random
def random_loop(guesses: list) -> str:
    num = random.randint(1, 10)
    for g in guesses:
        if g == num:
            return "Correct"
    return "Not found"`,testCases:[{input:"import random; random.seed(1); random_loop([1, 2, 3, 10])",expected:"'Correct'"}]},{id:"057",number:57,title:"Random Loop Feedback",description:"Create `random_loop_feedback(guesses: list)`. Random 1-10. Iterate guesses. If match: return 'Correct'. Else return 'Too high' or 'Too low' for each guess? Returns last message? 'Update program... tells user too high/low before pick again'. Adapted: Return list of feedback strings. e.g. ['Too high', 'Too low', 'Correct'].",starterCode:`import random
def random_loop_feedback(guesses: list) -> list:
    # Your code here
    pass`,solutionCode:`import random
def random_loop_feedback(guesses: list) -> list:
    num = random.randint(1, 10)
    feedback = []
    for g in guesses:
        if g == num:
            feedback.append("Correct")
            break
        elif g > num:
            feedback.append("Too high")
        else:
            feedback.append("Too low")
    return feedback`,testCases:[{input:"import random; random.seed(1); random_loop_feedback([10, 1, 2])",expected:"['Too high', 'Too low', 'Correct']"}]},{id:"058",number:58,title:"Math Quiz",description:"Write a function called `math_quiz_check` that takes two numbers and the user's answer. It should check if the two numbers added together equal the user's answer. Return True if correct, False otherwise.",starterCode:`def math_quiz_check(num1: int, num2: int, answer: int) -> bool:
    # Your code here
    pass`,solutionCode:`def math_quiz_check(num1: int, num2: int, answer: int) -> bool:
    return (num1 + num2) == answer`,testCases:[{input:"math_quiz_check(1, 2, 3)",expected:"True"}]},{id:"059",number:59,title:"Colour Guess",description:"Write a function called `check_colour_guess` that takes a guess. It should pick a random colour from ['red', 'blue', 'green', 'white', 'pink']. If the guess matches the random choice, return 'Well done'. Otherwise, return 'Wrong'.",starterCode:`import random
def check_colour_guess(guess: str) -> str:
    # Your code here
    pass`,solutionCode:`import random
def check_colour_guess(guess: str) -> str:
    colour = random.choice(['red', 'blue', 'green', 'white', 'pink'])
    if guess == colour:
        return "Well done"
    return "Wrong"`,testCases:[]}],R3e=[{id:"069",number:69,title:"Tuple Index",description:"Write a function called `get_tuple_item` that takes a tuple of countries and a country name. It should return the index number of that country in the tuple.",starterCode:`def get_tuple_item(countries: tuple, name: str) -> int:
    # Your code here
    pass`,solutionCode:`def get_tuple_item(countries: tuple, name: str) -> int:
    return countries.index(name)`,testCases:[{input:"get_tuple_item(('UK', 'US', 'France'), 'US')",expected:"1"}]},{id:"070",number:70,title:"Tuple Choice",description:"Write a function called `get_tuple_choice` that takes a tuple of countries and an index number. It should return the country name at that index position.",starterCode:`def get_tuple_choice(countries: tuple, index: int) -> str:
    # Your code here
pass`,solutionCode:`def get_tuple_choice(countries: tuple, index: int) -> str:
return countries[index]`,testCases:[{input:"get_tuple_choice(('UK', 'US'), 0)",expected:"'UK'"}]},{id:"071",number:71,title:"Sport List",description:"Write a function called `add_sport` that takes a list of sports and a new sport name. It should append the new sport to the list, sort the list alphabetically, and then return the updated list.",starterCode:`def add_sport(sports: list, sport: str) -> list:
    # Your code here
pass`,solutionCode:`def add_sport(sports: list, sport: str) -> list:
sports.append(sport)
sports.sort()
return sports`,testCases:[{input:"add_sport(['Tennis', 'Football'], 'Rugby')",expected:"['Football', 'Rugby', 'Tennis']"}]},{id:"072",number:72,title:"Delete Subject",description:"Write a function called `remove_subject` that takes a list of subjects and a specific subject name. If the subject exists in the list, remove it. Return the modified list.",starterCode:`def remove_subject(subjects: list, subject: str) -> list:
    # Your code here
pass`,solutionCode:`def remove_subject(subjects: list, subject: str) -> list:
if subject in subjects:
    subjects.remove(subject)
return subjects`,testCases:[{input:"remove_subject(['Maths', 'English'], 'Maths')",expected:"['English']"}]},{id:"073",number:73,title:"Food Dictionary",description:"Write a function called `remove_food` that takes a dictionary of ID-Food pairs and an ID key. It should remove the entry associated with that key and return the updated dictionary.",starterCode:`def remove_food(foods: dict, key: int) -> dict:
    # Your code here
pass`,solutionCode:`def remove_food(foods: dict, key: int) -> dict:
if key in foods:
        del foods[key]
return foods`,testCases:[{input:"remove_food({1: 'Pizza', 2: 'Curry'}, 1)",expected:"{2: 'Curry'}"}]},{id:"074",number:74,title:"Colour Range",description:"Write a function called `colour_range` that accepts a list of colours, a start index, and an end index. It should return a new list containing the colours between those indices (using Python list slicing).",starterCode:`def colour_range(colours: list, start: int, end: int) -> list:
    # Your code here
pass`,solutionCode:`def colour_range(colours: list, start: int, end: int) -> list:
return colours[start:end]`,testCases:[{input:"colour_range(['red', 'blue', 'green', 'white'], 1, 3)",expected:"['blue', 'green']"}]},{id:"075",number:75,title:"Check List Number",description:"Write a function called `check_list_num` that takes a list of numbers and a guess. If the guess is in the list, return its index (as a string). If it is not, return the string 'Not in list'.",starterCode:`def check_list_num(nums: list, guess: int) -> str:
    # Your code here
pass`,solutionCode:`def check_list_num(nums: list, guess: int) -> str:
if guess in nums:
    return str(nums.index(guess))
return "Not in list"`,testCases:[{input:"check_list_num([123, 456, 789], 456)",expected:"'1'"},{input:"check_list_num([123], 999)",expected:"'Not in list'"}]},{id:"076",number:76,title:"Invite List Count",description:"Write a function called `count_guests` that accepts a list of guest names. It should simply return the total number of guests in the list.",starterCode:`def count_guests(names: list) -> int:
    # Your code here
pass`,solutionCode:`def count_guests(names: list) -> int:
return len(names)`,testCases:[{input:"count_guests(['Bob', 'Alice'])",expected:"2"}]},{id:"077",number:77,title:"Invite Check",description:"Write a function called `invite_manage` that takes a list of names, a specific name to check, and a boolean `keep`. If the name exists in the list and `keep` is False, remove that name from the list. Return the updated list.",starterCode:`def invite_manage(names: list, check_name: str, keep: bool) -> list:
    # Your code here
pass`,solutionCode:`def invite_manage(names: list, check_name: str, keep: bool) -> list:
if check_name in names and not keep:
names.remove(check_name)
return names`,testCases:[{input:"invite_manage(['Bob'], 'Bob', False)",expected:"[]"}]},{id:"078",number:78,title:"TV Show Insert",description:"Write a function called `tv_insert` that takes a list of TV shows, a new show name, and an index. It should insert the new show into the list at the specified index and return the updated list.",starterCode:`def tv_insert(shows: list, show: str, idx: int) -> list:
    # Your code here
pass`,solutionCode:`def tv_insert(shows: list, show: str, idx: int) -> list:
shows.insert(idx, show)
return shows`,testCases:[{input:"tv_insert(['News', 'Movie'], 'Sport', 1)",expected:"['News', 'Sport', 'Movie']"}]},{id:"079",number:79,title:"Nums Keep Last",description:"Write a function called `nums_keep` that accepts a list of numbers and a boolean `keep_last`. If `keep_last` is False, remove the last item from the list. Return the list.",starterCode:`def nums_keep(nums: list, keep_last: bool) -> list:
    # Your code here
pass`,solutionCode:`def nums_keep(nums: list, keep_last: bool) -> list:
if not keep_last and nums:
nums.pop()
return nums`,testCases:[{input:"nums_keep([1, 2, 3], False)",expected:"[1, 2]"}]}],A3e=[{id:"080",number:80,title:"Name Stats",description:"Write a function called `name_stats` that takes a first name and a last name. It should return a summary string in the format 'First: [len], Last: [len], Full: [full_name]'.",starterCode:`def name_stats(first: str, last: str) -> str:
    # Your code here
pass`,solutionCode:`def name_stats(first: str, last: str) -> str:
full = f"{first} {last}"
return f"First: {len(first)}, Last: {len(last)}, Full: {full}"`,testCases:[{input:"name_stats('Bob', 'Smith')",expected:"'First: 3, Last: 5, Full: Bob Smith'"}]},{id:"081",number:81,title:"Subject Dash",description:"Write a function called `subject_dash` that takes a subject word. It should return the word with a dash ('-') inserted after every character (except possibly the last one, or just join them). Example: 'Maths' becomes 'M-a-t-h-s'.",starterCode:`def subject_dash(subject: str) -> str:
    # Your code here
pass`,solutionCode:`def subject_dash(subject: str) -> str:
output = ""
for char in subject:
    output += char + "-"
return output[: -1]`,testCases:[{input:"subject_dash('Maths')",expected:"'M-a-t-h-s'"}]},{id:"082",number:82,title:"Poem Slice",description:"Write a function called `poem_slice` that takes a line of text, a start index, and an end index. Return the substring defined by those indices.",starterCode:`def poem_slice(line: str, start: int, end: int) -> str:
    # Your code here
pass`,solutionCode:`def poem_slice(line: str, start: int, end: int) -> str:
return line[start:end]`,testCases:[{input:"poem_slice('Hello World', 0, 5)",expected:"'Hello'"}]},{id:"083",number:83,title:"Check Upper",description:"Write a function called `check_upper` that takes a word. Return True if the word is entirely uppercase, and False otherwise.",starterCode:`def check_upper(word: str) -> bool:
    # Your code here
pass`,solutionCode:`def check_upper(word: str) -> bool:
return word.isupper()`,testCases:[{input:"check_upper('HELLO')",expected:"True"},{input:"check_upper('Hello')",expected:"False"}]},{id:"084",number:84,title:"Postcode Prefix",description:"Write a function called `postcode_prefix` that accepts a postcode string. It should return the first two characters of the postcode in uppercase.",starterCode:`def postcode_prefix(postcode: str) -> str:
    # Your code here
pass`,solutionCode:`def postcode_prefix(postcode: str) -> str:
return postcode[: 2].upper()`,testCases:[{input:"postcode_prefix('ab12 3cd')",expected:"'AB'"}]},{id:"085",number:85,title:"Vowel Count",description:"Write a function called `vowel_count` that takes a word. It should count and return the number of vowels (a, e, i, o, u) in the word, regardless of case.",starterCode:`def vowel_count(word: str) -> int:
    # Your code here
pass`,solutionCode:`def vowel_count(word: str) -> int:
count = 0
vowels = "aeiou"
for char in word.lower():
    if char in vowels:
        count += 1
return count`,testCases:[{input:"vowel_count('Hello')",expected:"2"}]},{id:"086",number:86,title:"Password Match",description:"Write a function called `check_password` that takes a password attempt. If the password is 'secret', return 'Access granted'. Otherwise, return 'Try again'.",starterCode:`def password_match(p1: str, p2: str) -> str:
    # Your code here
pass`,solutionCode:`def password_match(p1: str, p2: str) -> str:
if p1 == p2:
    return "Match"
return "No match"`,testCases:[{input:"password_match('abc', 'abc')",expected:"'Match'"}]},{id:"087",number:87,title:"Reverse String",description:"Write a function called `reverse_string` that takes a word. It should return the word reversed.",starterCode:`def reverse_string(word: str) -> str:
    # Your code here
pass`,solutionCode:`def reverse_string(word: str) -> str:
return word[:: -1]`,testCases:[{input:"reverse_string('Hello')",expected:"'olleH'"}]}],M3e=[{id:"088",number:88,title:"Array Reverse",description:"Write a function called `array_reverse` that takes a list of 5 integers. It should sort the list in ascending order, then reverse it (so it is descending), and return the result.",starterCode:`def array_reverse(nums: list) -> list:
    # Your code here
pass`,solutionCode:`def array_reverse(nums: list) -> list:
nums.sort()
nums.reverse()
return nums`,testCases:[{input:"array_reverse([1, 4, 2, 5])",expected:"[5, 4, 2, 1]"}]},{id:"089",number:89,title:"Array Random",description:"Write a function called `array_get_items` that takes a list of integers. Functionally, it should simply return the list (to simulate displaying the items).",starterCode:`def array_get_items(nums: list) -> list:
    # Your code here
pass`,solutionCode:`def array_get_items(nums: list) -> list:
return nums`,testCases:[]},{id:"090",number:90,title:"Array Filter",description:"Write a function called `array_filter_10` that takes a list of numbers. It should return a new list containing only the numbers that are less than 10.",starterCode:`def array_filter_10(nums: list) -> list:
    # Your code here
pass`,solutionCode:`def array_filter_10(nums: list) -> list:
output = []
for num in nums:
    if num < 10:
        output.append(num)
return output`,testCases:[{input:"array_filter_10([1, 15, 5, 20])",expected:"[1, 5]"}]},{id:"091",number:91,title:"Array Count Target",description:"Write a function called `array_count_target` that takes a list of numbers and a target number. It should return the number of times the target appears in the list.",starterCode:`def array_count_target(nums: list, target: int) -> int:
    # Your code here
pass`,solutionCode:`def array_count_target(nums: list, target: int) -> int:
return nums.count(target)`,testCases:[{input:"array_count_target([1, 2, 1, 3], 1)",expected:"2"}]},{id:"092",number:92,title:"Array Merge",description:"Write a function called `array_merge` that takes two lists. It should combine them into one list, sort it alphabetically/numerically, and return the result.",starterCode:`def array_merge(arr1: list, arr2: list) -> list:
    # Your code here
pass`,solutionCode:`def array_merge(arr1: list, arr2: list) -> list:
full = arr1 + arr2
full.sort()
return full`,testCases:[{input:"array_merge([3, 1], [4, 2])",expected:"[1, 2, 3, 4]"}]},{id:"093",number:93,title:"Array Remove Value",description:"Write a function called `array_remove_val` that takes a list and a value. If the value exists in the list, remove it. Return the modified list.",starterCode:`def array_remove_val(nums: list, val: int) -> list:
    # Your code here
pass`,solutionCode:`def array_remove_val(nums: list, val: int) -> list:
if val in nums:
    nums.remove(val)
return nums`,testCases:[{input:"array_remove_val([1, 2, 3], 2)",expected:"[1, 3]"}]},{id:"094",number:94,title:"Array Indices",description:"Write a function called `array_indices_select` that takes a list of numbers and a list of indices. It should return a new list containing the numbers found at those specific indices.",starterCode:`def array_indices_select(nums: list, indices: list) -> list:
    # Your code here
pass`,solutionCode:`def array_indices_select(nums: list, indices: list) -> list:
output = []
for i in indices:
    if 0 <= i < len(nums):
        output.append(nums[i])
return output`,testCases:[{input:"array_indices_select([10, 20, 30], [0, 2])",expected:"[10, 30]"}]},{id:"095",number:95,title:"Array Division",description:"Write a function called `array_div` that takes a list of numbers and a divisor. It should return a new list where each number has been divided by the divisor and rounded to 2 decimal places.",starterCode:`def array_div(nums: list, divisor: float) -> list:
    # Your code here
pass`,solutionCode:`def array_div(nums: list, divisor: float) -> list:
output = []
for num in nums:
    output.append(round(num / divisor, 2))
return output`,testCases:[{input:"array_div([10, 20], 2)",expected:"[5.0, 10.0]"}]}],O3e=[{id:"096",number:96,title:"Simple 2D List",description:"Write a function called `get_simple_grid`. It should simply return the specific 2D list: `[[2, 5, 8], [3, 7, 4], [1, 6, 9], [4, 2, 0]]`.",starterCode:`def get_simple_grid() -> list:
    # Your code here
    pass`,solutionCode:`def get_simple_grid() -> list:
    return [[2, 5, 8], [3, 7, 4], [1, 6, 9], [4, 2, 0]]`,testCases:[{input:"get_simple_grid()[0]",expected:"[2, 5, 8]"}]},{id:"097",number:97,title:"Get 2D Item",description:"Write a function called `get_grid_item` that takes a 2D list (grid), a row index, and a column index. It should return the item located at that row and column.",starterCode:`def get_grid_item(grid: list, row: int, col: int) -> int:
    # Your code here
    pass`,solutionCode:`def get_grid_item(grid: list, row: int, col: int) -> int:
    return grid[row][col]`,testCases:[{input:"get_grid_item([[1, 2], [3, 4]], 1, 0)",expected:"3"}]},{id:"098",number:98,title:"Update 2D Item",description:"Write a function called `update_grid_item` that takes a 2D list, a row, a column, and a new value. It should update the item at that position and return the modified grid.",starterCode:`def update_grid_item(grid: list, row: int, col: int, val: int) -> list:
    # Your code here
    pass`,solutionCode:`def update_grid_item(grid: list, row: int, col: int, val: int) -> list:
    grid[row][col] = val
    return grid`,testCases:[{input:"update_grid_item([[1, 2], [3, 4]], 0, 0, 9)",expected:"[[9, 2], [3, 4]]"}]},{id:"099",number:99,title:"Get Row",description:"Write a function called `get_row` that takes a 2D list and a row index. It should return that entire row as a list.",starterCode:`def get_row(grid: list, row: int) -> list:
    # Your code here
    pass`,solutionCode:`def get_row(grid: list, row: int) -> list:
    return grid[row]`,testCases:[{input:"get_row([[1, 2], [3, 4]], 1)",expected:"[3, 4]"}]},{id:"100",number:100,title:"2D Dict Access",description:"Write a function called `get_sales` that accept a dictionary of sales data, a name, and a region code (e.g., 'N', 'S'). It should return the sales number associated with that name and region.",starterCode:`def get_sales(data: dict, name: str, region: str) -> int:
    # Your code here
    pass`,solutionCode:`def get_sales(data: dict, name: str, region: str) -> int:
    return data[name][region]`,testCases:[{input:"get_sales({'Bob': {'N': 10}}, 'Bob', 'N')",expected:"10"}]},{id:"101",number:101,title:"2D Dict Update",description:"Write a function called `update_sales` that takes a sales dictionary, a name, a region, and a new value. It should update the sales figure for that person and region, then return the dictionary.",starterCode:`def update_sales(data: dict, name: str, region: str, val: int) -> dict:
    # Your code here
    pass`,solutionCode:`def update_sales(data: dict, name: str, region: str, val: int) -> dict:
    data[name][region] = val
    return data`,testCases:[{input:"update_sales({'Bob': {'N': 10}}, 'Bob', 'N', 20)",expected:"{'Bob': {'N': 20}}"}]},{id:"102",number:102,title:"2D Dict Add",description:"Write a function called `add_person` that accepts a dictionary, a name, an age, and a shoe size. It should add (or update) an entry for that name containing a dictionary with 'Age' and 'Shoe' keys, then return the dictionary.",starterCode:`def add_person(data: dict, name: str, age: int, shoe: int) -> dict:
    # Your code here
    pass`,solutionCode:`def add_person(data: dict, name: str, age: int, shoe: int) -> dict:
    data[name] = {'Age': age, 'Shoe': shoe}
    return data`,testCases:[{input:"add_person({}, 'Bob', 20, 10)",expected:"{'Bob': {'Age': 20, 'Shoe': 10}}"}]},{id:"103",number:103,title:"2D Dict Print",description:"Write a function called `get_person_info` that takes the data dictionary and a name. If the person exists, return a string like 'Age: [age], Shoe: [shoe]'. If not, return 'Not found'.",starterCode:`def get_person_info(data: dict, name: str) -> str:
    # Your code here
    pass`,solutionCode:`def get_person_info(data: dict, name: str) -> str:
    if name in data:
        p = data[name]
        return f"Age: {p['Age']}, Shoe: {p['Shoe']}"
    return "Not found"`,testCases:[{input:"get_person_info({'Bob': {'Age': 20, 'Shoe': 10}}, 'Bob')",expected:"'Age: 20, Shoe: 10'"}]}],P3e=[{id:"118",number:118,title:"Ask Num Function",description:"Write a function called `ask_num` that accepts a value. It should simply return that value (simulating asking the user for input and returning it).",starterCode:`def ask_num(val: int) -> int:
    # Your code here
    pass`,solutionCode:`def ask_num(val: int) -> int:
    return val`,testCases:[{input:"ask_num(5)",expected:"5"}]},{id:"120",number:120,title:"Menu Math",description:"Write a function called `calc` that takes a choice (1 or 2) and two numbers. If choice is 1, return a string showing sum: '[a] + [b] = [ans]'. If 2, return subtraction: '[a] - [b] = [ans]'. Otherwise return 'Invalid'.",starterCode:`def calc(choice: int, a: int, b: int) -> str:
    # Your code here
    pass`,solutionCode:`def calc(choice: int, a: int, b: int) -> str:
    if choice == 1:
        return f"{a} + {b} = {a + b}"
    elif choice == 2:
        return f"{a} - {b} = {a - b}"
    return "Invalid"`,testCases:[{input:"calc(1, 5, 3)",expected:"'5 + 3 = 8'"}]},{id:"121",number:121,title:"Name List Manager",description:"Write a function called `manage_names` that takes a list of names, a menu choice (1-4), a value (for adding/removing), and an optional index. 1: Add name. 2: Change name at index. 3: Delete name. 4: Return list. Perform the action and return the list.",starterCode:`def manage_names(names: list, choice: int, val: str, idx: int = 0) -> list:
    # Your code here
    pass`,solutionCode:`def manage_names(names: list, choice: int, val: str, idx: int = 0) -> list:
    if choice == 1:
        names.append(val)
    elif choice == 2 and 0 <= idx < len(names):
        names[idx] = val
    elif choice == 3 and val in names:
        names.remove(val)
    return names`,testCases:[{input:"manage_names(['Bob'], 1, 'Alice')",expected:"['Bob', 'Alice']"},{input:"manage_names(['Bob'], 3, 'Bob')",expected:"[]"}]}],Rp=[{id:"01_basics",title:"The Basics",description:"Input, Output and Variables",explanation:"Learn to display text, handle user input, and use variables.",exampleCode:"print('Hello World')",challenges:L3e,homework:Jo["01_basics"]},{id:"02_if_statements",title:"If Statements",description:"Control Flow and Conditionals",explanation:"Use if, elif, and else to make decisions.",exampleCode:"if True:\\n    print('Yes')",challenges:k3e,homework:Jo["02_if_statements"]},{id:"03_strings",title:"Strings",description:"String Manipulation",explanation:"Work with text: splitting, slicing, and formatting.",exampleCode:"print('hello'.upper())",challenges:E3e,homework:Jo["03_strings"]},{id:"04_maths",title:"Maths",description:"Math Operations",explanation:"Perform calculations using Python's math library.",exampleCode:"import math\\nprint(math.sqrt(16))",challenges:D3e,homework:Jo["04_maths"]},{id:"05_for_loops",title:"For Loops",description:"Iteration",explanation:"Repeat code a specific number of times.",exampleCode:"for i in range(5):\\n    print(i)",challenges:T3e,homework:Jo["05_for_loops"]},{id:"06_while_loops",title:"Conditional Loops",description:"Conditional Loops",explanation:"Repeat code while a condition is true.",exampleCode:"while True:\\n    break",challenges:N3e,homework:Jo["06_while_loops"]},{id:"07_random",title:"Random",description:"Random Numbers",explanation:"Generate random numbers and choices.",exampleCode:"import random\\nprint(random.randint(1, 10))",challenges:I3e,homework:Jo["07_random"]},{id:"08_lists_dicts",title:"Tuples, Lists and Dicts",description:"Data Structures",explanation:"Store multiple values in tuples, lists, and dictionaries.",exampleCode:"x = [1, 2, 3]\\nprint(x[0])",challenges:R3e,homework:Jo["08_lists_dicts"]},{id:"09_more_strings",title:"More Strings",description:"Advanced Strings",explanation:"String formatting and advanced manipulation.",exampleCode:"print('Hello'.isupper())",challenges:A3e,homework:Jo["09_more_strings"]},{id:"10_arrays",title:"Numeric Arrays",description:"Working with Lists of Numbers",explanation:"Manipulating lists of numbers: sorting, deleting, calculating.",exampleCode:"x = [3, 1, 2]\\nx.sort()",challenges:M3e,homework:Jo["10_arrays"]},{id:"11_2d_lists_dicts",title:"2D Lists and Dictionaries",description:"Complex Data Structures",explanation:"Working with 2D lists and nested dictionaries.",exampleCode:"x = [[1, 2], [3, 4]]",challenges:O3e,homework:Jo["11_2d_lists_dicts"]},{id:"12_subprograms",title:"Subprograms",description:"Functions and Logic",explanation:"Define functions and manage program flow.",exampleCode:"def my_func():\\n    pass",challenges:P3e,homework:Jo["12_subprograms"]}],F3e=({studentName:s="Student",onFinish:e})=>{const[t,i]=_e.useState([]),n=_e.useRef(null),{isReady:r,loadingMessage:o}=OP(),[a,l]=_e.useState(0);return _e.useEffect(()=>{const c=[{text:"BIOS DATE 01/01/24 15:23:42 VER 1.0.2",delay:100},{text:"CPU: QUANTUM-XYZ 64-BIT PROCESSOR",delay:200},{text:"CHECKING MEMORY: 64512K OK",delay:400},{text:"",delay:500},{text:"DETECTING PRIMARY MASTER ... QUANTUM DRIVE C:",delay:800},{text:"DETECTING PRIMARY SLAVE  ... NONE",delay:900},{text:"",delay:1e3},{text:"LOADING SYSTEM COMPONENTS:",delay:1200}];let u=[];return c.forEach((d,g)=>{const p=setTimeout(()=>{i(_=>[..._,d.text]),g===c.length-1&&l(1)},d.delay);u.push(p)}),()=>u.forEach(clearTimeout)},[]),_e.useEffect(()=>{a===1&&i(c=>c[c.length-1]!==`> ${o}`?[...c,`> ${o}`]:c)},[o,a]),_e.useEffect(()=>{r&&a>=1&&(async()=>(i(u=>[...u,"",`WELCOME ${s.toUpperCase()}`,"SYSTEM READY."]),await new Promise(u=>setTimeout(u,1500)),e()))()},[r,a,e,s]),_e.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[t]),z.jsxs("div",{className:"fixed inset-0 bg-black text-green-500 font-mono p-10 flex flex-col items-start justify-start overflow-hidden z-[100]",children:[z.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-2",ref:n,children:[t.map((c,u)=>z.jsx("div",{className:"typewriter-line min-h-[1.5rem] break-words",children:c&&!c.startsWith("BIOS")&&!c.startsWith("CPU")&&!c.startsWith("CHECK")&&!c.startsWith("DETECT")&&!c.startsWith("LOAD")&&!c.startsWith("WELC")&&!c.startsWith("SYS")&&!c.startsWith(">")?z.jsxs(z.Fragment,{children:[z.jsx("span",{className:"mr-2",children:">"}),c]}):c},u)),z.jsx("div",{className:"animate-pulse",children:"_"})]}),z.jsx("div",{className:"absolute bottom-10 right-10 text-xs text-green-700",children:"STEVEN STEWART TUTORING // SYSTEM BOOT // PYTHON 3.11.0"}),z.jsx("style",{children:`
        .typewriter-line {
          animation: fadeIn 0.1s ease-out;
        }
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
      `})]})},Kte="python_tutoring_unlocked_chapters",B3e=()=>Rp.reduce((s,e,t)=>({...s,[e.id]:t<3}),{}),aG=()=>{try{const s=localStorage.getItem(Kte);if(s)return JSON.parse(s)}catch(s){console.error(s)}return B3e()},lG=s=>{try{localStorage.setItem(Kte,JSON.stringify(s))}catch(e){console.error(e)}},V3e=()=>{const{isInSession:s,isTeacher:e,sessionCode:t,participants:i,sessionUnlockedChapters:n,createSession:r,joinSession:o,leaveSession:a,unlockChapter:l,lockChapter:c,activeChallenge:u,setActiveChallenge:d}=JK(),[g,p]=_e.useState(Rp[0].id),[_,C]=_e.useState(0),[v,x]=_e.useState(!0),[S,k]=_e.useState(!1),[E,T]=_e.useState(aG),[R,N]=_e.useState({}),[A,O]=_e.useState(!1),[W,j]=_e.useState(!1);_e.useEffect(()=>{if(!kt)return;const me=bn(kt,"config/globalUnlockedChapters"),Oe=LL(me,it=>{const Xe=it.val();N(Xe||{})});return()=>Oe()},[]);const F=_e.useMemo(()=>{let me={...E};return s&&(me={...me,...n}),{...me,...R}},[s,n,E,R]),q=Rp.find(me=>me.id===g)||Rp[0],Z=_e.useMemo(()=>!F[q.id],[F,q.id]);_e.useEffect(()=>{s&&e&&d(g,_)},[g,_,s,e]),_e.useEffect(()=>{s&&!e&&u&&(u.chapterId!==g||u.challengeIndex!==_)&&(p(u.chapterId),C(u.challengeIndex))},[u,s,e]);const K=me=>{if(s&&e)l(me);else{const Oe={...E,[me]:!0};T(Oe),lG(Oe)}},U=me=>{if(s&&e)c(me);else{const Oe={...E,[me]:!1};T(Oe),lG(Oe)}},G=me=>{!kt||!A||jr(bn(kt,`config/globalUnlockedChapters/${me}`),!0)},Q=me=>{!kt||!A||jr(bn(kt,`config/globalUnlockedChapters/${me}`),!1)},le=me=>{!F[me]&&!A||(p(me),C(0))};_e.useEffect(()=>{const me=Oe=>{Oe.ctrlKey&&Oe.shiftKey&&Oe.key==="T"&&O(it=>{const Xe=!it;return j(!!Xe),Xe})};return window.addEventListener("keydown",me),()=>window.removeEventListener("keydown",me)},[]);const ve=()=>{x(!1),k(!0)},V=()=>{k(!1)},ce=async me=>{const Oe=await o(me);return Oe&&k(!1),Oe},oe=async()=>await r(),Se=async()=>{await a(),T(aG())};return v?z.jsx(F3e,{studentName:"Python Learner",onFinish:ve}):S?z.jsx(S3e,{onSoloMode:V,onJoinSession:ce,onCreateSession:oe,isTeacherMode:A}):z.jsxs("div",{className:"flex flex-col h-screen overflow-hidden bg-[#1e1e1e]",children:[s&&t&&z.jsx(x3e,{sessionCode:t,isTeacher:e,participantCount:Object.keys(i).length,onLeave:Se}),A&&z.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-xs font-bold text-center py-1.5 shadow-lg flex items-center justify-center gap-4",children:[z.jsx("span",{children:" TEACHER MODE"}),z.jsx("button",{onClick:()=>k(!0),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded-md transition-colors",children:"Start Session"}),z.jsx("button",{onClick:()=>j(!0),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded-md transition-colors",children:"Control Panel"}),z.jsx("span",{className:"text-white/70",children:"(Ctrl+Shift+T to toggle)"})]}),z.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[z.jsx(yce,{chapters:Rp,currentChapterId:g,onSelectChapter:le,unlockedMap:F,enforceLocksForStudent:!A}),z.jsx("main",{className:"flex-1 min-h-0 overflow-hidden relative",children:z.jsx(v3e,{chapter:q,currentChallengeIndex:_,onNextChallenge:()=>C(me=>Math.min(me+1,q.challenges.length-1)),onPrevChallenge:()=>C(me=>Math.max(me-1,0)),onSelectChallenge:C,isLocked:Z})})]}),A&&W&&z.jsx(y3e,{chapters:Rp,unlockedMap:F,onUnlock:K,onLock:U,globalUnlockedMap:R,onGlobalUnlock:G,onGlobalLock:Q,onClose:()=>j(!1)})]})};function W3e(){return z.jsx(Fhe,{children:z.jsx(Rhe,{children:z.jsx(V3e,{})})})}const Yte=document.getElementById("root");if(!Yte)throw new Error("Could not find root element to mount to");const H3e=pse.createRoot(Yte);H3e.render(z.jsx(ju.StrictMode,{children:z.jsx(W3e,{})}));

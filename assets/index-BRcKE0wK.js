var cre=Object.defineProperty;var ure=(s,e,t)=>e in s?cre(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var an=(s,e,t)=>ure(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var Nl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gP(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var _I={exports:{}},Qb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JV;function hre(){if(JV)return Qb;JV=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,n,r){var o=null;if(r!==void 0&&(o=""+r),n.key!==void 0&&(o=""+n.key),"key"in n){r={};for(var a in n)a!=="key"&&(r[a]=n[a])}else r=n;return n=r.ref,{$$typeof:s,type:i,key:o,ref:n!==void 0?n:null,props:r}}return Qb.Fragment=e,Qb.jsx=t,Qb.jsxs=t,Qb}var eH;function dre(){return eH||(eH=1,_I.exports=hre()),_I.exports}var K=dre(),bI={exports:{}},Mt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tH;function fre(){if(tH)return Mt;tH=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.for("react.activity"),g=Symbol.iterator;function p($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,C={};function x($,ce,de){this.props=$,this.context=ce,this.refs=C,this.updater=de||_}x.prototype.isReactComponent={},x.prototype.setState=function($,ce){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ce,"setState")},x.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function S(){}S.prototype=x.prototype;function y($,ce,de){this.props=$,this.context=ce,this.refs=C,this.updater=de||_}var k=y.prototype=new S;k.constructor=y,b(k,x.prototype),k.isPureReactComponent=!0;var D=Array.isArray;function R(){}var N={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function M($,ce,de){var xe=de.ref;return{$$typeof:s,type:$,key:ce,ref:xe!==void 0?xe:null,props:de}}function O($,ce){return M($.type,ce,$.props)}function V($){return typeof $=="object"&&$!==null&&$.$$typeof===s}function H($){var ce={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(de){return ce[de]})}var U=/\/+/g;function X($,ce){return typeof $=="object"&&$!==null&&$.key!=null?H(""+$.key):ce.toString(36)}function Y($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(R,R):($.status="pending",$.then(function(ce){$.status==="pending"&&($.status="fulfilled",$.value=ce)},function(ce){$.status==="pending"&&($.status="rejected",$.reason=ce)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function q($,ce,de,xe,Re){var Xe=typeof $;(Xe==="undefined"||Xe==="boolean")&&($=null);var ht=!1;if($===null)ht=!0;else switch(Xe){case"bigint":case"string":case"number":ht=!0;break;case"object":switch($.$$typeof){case s:case e:ht=!0;break;case h:return ht=$._init,q(ht($._payload),ce,de,xe,Re)}}if(ht)return Re=Re($),ht=xe===""?"."+X($,0):xe,D(Re)?(de="",ht!=null&&(de=ht.replace(U,"$&/")+"/"),q(Re,ce,de,"",function(An){return An})):Re!=null&&(V(Re)&&(Re=O(Re,de+(Re.key==null||$&&$.key===Re.key?"":(""+Re.key).replace(U,"$&/")+"/")+ht)),ce.push(Re)),1;ht=0;var bi=xe===""?".":xe+":";if(D($))for(var qt=0;qt<$.length;qt++)xe=$[qt],Xe=bi+X(xe,qt),ht+=q(xe,ce,de,Xe,Re);else if(qt=p($),typeof qt=="function")for($=qt.call($),qt=0;!(xe=$.next()).done;)xe=xe.value,Xe=bi+X(xe,qt++),ht+=q(xe,ce,de,Xe,Re);else if(Xe==="object"){if(typeof $.then=="function")return q(Y($),ce,de,xe,Re);throw ce=String($),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return ht}function ee($,ce,de){if($==null)return $;var xe=[],Re=0;return q($,xe,"","",function(Xe){return ce.call(de,Xe,Re++)}),xe}function ue($){if($._status===-1){var ce=$._result;ce=ce(),ce.then(function(de){($._status===0||$._status===-1)&&($._status=1,$._result=de)},function(de){($._status===0||$._status===-1)&&($._status=2,$._result=de)}),$._status===-1&&($._status=0,$._result=ce)}if($._status===1)return $._result.default;throw $._result}var oe=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},Ee={map:ee,forEach:function($,ce,de){ee($,function(){ce.apply(this,arguments)},de)},count:function($){var ce=0;return ee($,function(){ce++}),ce},toArray:function($){return ee($,function(ce){return ce})||[]},only:function($){if(!V($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return Mt.Activity=d,Mt.Children=Ee,Mt.Component=x,Mt.Fragment=t,Mt.Profiler=n,Mt.PureComponent=y,Mt.StrictMode=i,Mt.Suspense=l,Mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Mt.__COMPILER_RUNTIME={__proto__:null,c:function($){return N.H.useMemoCache($)}},Mt.cache=function($){return function(){return $.apply(null,arguments)}},Mt.cacheSignal=function(){return null},Mt.cloneElement=function($,ce,de){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var xe=b({},$.props),Re=$.key;if(ce!=null)for(Xe in ce.key!==void 0&&(Re=""+ce.key),ce)!A.call(ce,Xe)||Xe==="key"||Xe==="__self"||Xe==="__source"||Xe==="ref"&&ce.ref===void 0||(xe[Xe]=ce[Xe]);var Xe=arguments.length-2;if(Xe===1)xe.children=de;else if(1<Xe){for(var ht=Array(Xe),bi=0;bi<Xe;bi++)ht[bi]=arguments[bi+2];xe.children=ht}return M($.type,Re,xe)},Mt.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:r,_context:$},$},Mt.createElement=function($,ce,de){var xe,Re={},Xe=null;if(ce!=null)for(xe in ce.key!==void 0&&(Xe=""+ce.key),ce)A.call(ce,xe)&&xe!=="key"&&xe!=="__self"&&xe!=="__source"&&(Re[xe]=ce[xe]);var ht=arguments.length-2;if(ht===1)Re.children=de;else if(1<ht){for(var bi=Array(ht),qt=0;qt<ht;qt++)bi[qt]=arguments[qt+2];Re.children=bi}if($&&$.defaultProps)for(xe in ht=$.defaultProps,ht)Re[xe]===void 0&&(Re[xe]=ht[xe]);return M($,Xe,Re)},Mt.createRef=function(){return{current:null}},Mt.forwardRef=function($){return{$$typeof:a,render:$}},Mt.isValidElement=V,Mt.lazy=function($){return{$$typeof:h,_payload:{_status:-1,_result:$},_init:ue}},Mt.memo=function($,ce){return{$$typeof:c,type:$,compare:ce===void 0?null:ce}},Mt.startTransition=function($){var ce=N.T,de={};N.T=de;try{var xe=$(),Re=N.S;Re!==null&&Re(de,xe),typeof xe=="object"&&xe!==null&&typeof xe.then=="function"&&xe.then(R,oe)}catch(Xe){oe(Xe)}finally{ce!==null&&de.types!==null&&(ce.types=de.types),N.T=ce}},Mt.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Mt.use=function($){return N.H.use($)},Mt.useActionState=function($,ce,de){return N.H.useActionState($,ce,de)},Mt.useCallback=function($,ce){return N.H.useCallback($,ce)},Mt.useContext=function($){return N.H.useContext($)},Mt.useDebugValue=function(){},Mt.useDeferredValue=function($,ce){return N.H.useDeferredValue($,ce)},Mt.useEffect=function($,ce){return N.H.useEffect($,ce)},Mt.useEffectEvent=function($){return N.H.useEffectEvent($)},Mt.useId=function(){return N.H.useId()},Mt.useImperativeHandle=function($,ce,de){return N.H.useImperativeHandle($,ce,de)},Mt.useInsertionEffect=function($,ce){return N.H.useInsertionEffect($,ce)},Mt.useLayoutEffect=function($,ce){return N.H.useLayoutEffect($,ce)},Mt.useMemo=function($,ce){return N.H.useMemo($,ce)},Mt.useOptimistic=function($,ce){return N.H.useOptimistic($,ce)},Mt.useReducer=function($,ce,de){return N.H.useReducer($,ce,de)},Mt.useRef=function($){return N.H.useRef($)},Mt.useState=function($){return N.H.useState($)},Mt.useSyncExternalStore=function($,ce,de){return N.H.useSyncExternalStore($,ce,de)},Mt.useTransition=function(){return N.H.useTransition()},Mt.version="19.2.1",Mt}var iH;function mP(){return iH||(iH=1,bI.exports=fre()),bI.exports}var Ne=mP();const hd=gP(Ne);var wI={exports:{}},Xb={},vI={exports:{}},CI={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nH;function gre(){return nH||(nH=1,(function(s){function e(q,ee){var ue=q.length;q.push(ee);e:for(;0<ue;){var oe=ue-1>>>1,Ee=q[oe];if(0<n(Ee,ee))q[oe]=ee,q[ue]=Ee,ue=oe;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var ee=q[0],ue=q.pop();if(ue!==ee){q[0]=ue;e:for(var oe=0,Ee=q.length,$=Ee>>>1;oe<$;){var ce=2*(oe+1)-1,de=q[ce],xe=ce+1,Re=q[xe];if(0>n(de,ue))xe<Ee&&0>n(Re,de)?(q[oe]=Re,q[xe]=ue,oe=xe):(q[oe]=de,q[ce]=ue,oe=ce);else if(xe<Ee&&0>n(Re,ue))q[oe]=Re,q[xe]=ue,oe=xe;else break e}}return ee}function n(q,ee){var ue=q.sortIndex-ee.sortIndex;return ue!==0?ue:q.id-ee.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();s.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,d=null,g=3,p=!1,_=!1,b=!1,C=!1,x=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function k(q){for(var ee=t(c);ee!==null;){if(ee.callback===null)i(c);else if(ee.startTime<=q)i(c),ee.sortIndex=ee.expirationTime,e(l,ee);else break;ee=t(c)}}function D(q){if(b=!1,k(q),!_)if(t(l)!==null)_=!0,R||(R=!0,H());else{var ee=t(c);ee!==null&&Y(D,ee.startTime-q)}}var R=!1,N=-1,A=5,M=-1;function O(){return C?!0:!(s.unstable_now()-M<A)}function V(){if(C=!1,R){var q=s.unstable_now();M=q;var ee=!0;try{e:{_=!1,b&&(b=!1,S(N),N=-1),p=!0;var ue=g;try{t:{for(k(q),d=t(l);d!==null&&!(d.expirationTime>q&&O());){var oe=d.callback;if(typeof oe=="function"){d.callback=null,g=d.priorityLevel;var Ee=oe(d.expirationTime<=q);if(q=s.unstable_now(),typeof Ee=="function"){d.callback=Ee,k(q),ee=!0;break t}d===t(l)&&i(l),k(q)}else i(l);d=t(l)}if(d!==null)ee=!0;else{var $=t(c);$!==null&&Y(D,$.startTime-q),ee=!1}}break e}finally{d=null,g=ue,p=!1}ee=void 0}}finally{ee?H():R=!1}}}var H;if(typeof y=="function")H=function(){y(V)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,X=U.port2;U.port1.onmessage=V,H=function(){X.postMessage(null)}}else H=function(){x(V,0)};function Y(q,ee){N=x(function(){q(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(q){q.callback=null},s.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<q?Math.floor(1e3/q):5},s.unstable_getCurrentPriorityLevel=function(){return g},s.unstable_next=function(q){switch(g){case 1:case 2:case 3:var ee=3;break;default:ee=g}var ue=g;g=ee;try{return q()}finally{g=ue}},s.unstable_requestPaint=function(){C=!0},s.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ue=g;g=q;try{return ee()}finally{g=ue}},s.unstable_scheduleCallback=function(q,ee,ue){var oe=s.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?oe+ue:oe):ue=oe,q){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ue+Ee,q={id:h++,callback:ee,priorityLevel:q,startTime:ue,expirationTime:Ee,sortIndex:-1},ue>oe?(q.sortIndex=ue,e(c,q),t(l)===null&&q===t(c)&&(b?(S(N),N=-1):b=!0,Y(D,ue-oe))):(q.sortIndex=Ee,e(l,q),_||p||(_=!0,R||(R=!0,H()))),q},s.unstable_shouldYield=O,s.unstable_wrapCallback=function(q){var ee=g;return function(){var ue=g;g=ee;try{return q.apply(this,arguments)}finally{g=ue}}}})(CI)),CI}var sH;function mre(){return sH||(sH=1,vI.exports=gre()),vI.exports}var yI={exports:{}},Cr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rH;function pre(){if(rH)return Cr;rH=1;var s=mP();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},n=Symbol.for("react.portal");function r(l,c,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:d==null?null:""+d,children:l,containerInfo:c,implementation:h}}var o=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Cr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Cr.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return r(l,c,null,h)},Cr.flushSync=function(l){var c=o.T,h=i.p;try{if(o.T=null,i.p=2,l)return l()}finally{o.T=c,i.p=h,i.d.f()}},Cr.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(l,c))},Cr.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},Cr.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,d=a(h,c.crossOrigin),g=typeof c.integrity=="string"?c.integrity:void 0,p=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?i.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:g,fetchPriority:p}):h==="script"&&i.d.X(l,{crossOrigin:d,integrity:g,fetchPriority:p,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Cr.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=a(c.as,c.crossOrigin);i.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(l)},Cr.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,d=a(h,c.crossOrigin);i.d.L(l,h,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Cr.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=a(c.as,c.crossOrigin);i.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(l)},Cr.requestFormReset=function(l){i.d.r(l)},Cr.unstable_batchedUpdates=function(l,c){return l(c)},Cr.useFormState=function(l,c,h){return o.H.useFormState(l,c,h)},Cr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Cr.version="19.2.1",Cr}var oH;function _re(){if(oH)return yI.exports;oH=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),yI.exports=pre(),yI.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aH;function bre(){if(aH)return Xb;aH=1;var s=mre(),e=mP(),t=_re();function i(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function r(u){var f=u,m=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(m=f.return),u=f.return;while(u)}return f.tag===3?m:null}function o(u){if(u.tag===13){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function a(u){if(u.tag===31){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function l(u){if(r(u)!==u)throw Error(i(188))}function c(u){var f=u.alternate;if(!f){if(f=r(u),f===null)throw Error(i(188));return f!==u?null:u}for(var m=u,w=f;;){var L=m.return;if(L===null)break;var E=L.alternate;if(E===null){if(w=L.return,w!==null){m=w;continue}break}if(L.child===E.child){for(E=L.child;E;){if(E===m)return l(L),u;if(E===w)return l(L),f;E=E.sibling}throw Error(i(188))}if(m.return!==w.return)m=L,w=E;else{for(var P=!1,z=L.child;z;){if(z===m){P=!0,m=L,w=E;break}if(z===w){P=!0,w=L,m=E;break}z=z.sibling}if(!P){for(z=E.child;z;){if(z===m){P=!0,m=E,w=L;break}if(z===w){P=!0,w=E,m=L;break}z=z.sibling}if(!P)throw Error(i(189))}}if(m.alternate!==w)throw Error(i(190))}if(m.tag!==3)throw Error(i(188));return m.stateNode.current===m?u:f}function h(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=h(u),f!==null)return f;u=u.sibling}return null}var d=Object.assign,g=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),y=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function H(u){return u===null||typeof u!="object"?null:(u=V&&u[V]||u["@@iterator"],typeof u=="function"?u:null)}var U=Symbol.for("react.client.reference");function X(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===U?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case b:return"Fragment";case x:return"Profiler";case C:return"StrictMode";case D:return"Suspense";case R:return"SuspenseList";case M:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case _:return"Portal";case y:return u.displayName||"Context";case S:return(u._context.displayName||"Context")+".Consumer";case k:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case N:return f=u.displayName||null,f!==null?f:X(u.type)||"Memo";case A:f=u._payload,u=u._init;try{return X(u(f))}catch{}}return null}var Y=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},oe=[],Ee=-1;function $(u){return{current:u}}function ce(u){0>Ee||(u.current=oe[Ee],oe[Ee]=null,Ee--)}function de(u,f){Ee++,oe[Ee]=u.current,u.current=f}var xe=$(null),Re=$(null),Xe=$(null),ht=$(null);function bi(u,f){switch(de(Xe,f),de(Re,u),de(xe,null),f.nodeType){case 9:case 11:u=(u=f.documentElement)&&(u=u.namespaceURI)?yV(u):0;break;default:if(u=f.tagName,f=f.namespaceURI)f=yV(f),u=SV(f,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}ce(xe),de(xe,u)}function qt(){ce(xe),ce(Re),ce(Xe)}function An(u){u.memoizedState!==null&&de(ht,u);var f=xe.current,m=SV(f,u.type);f!==m&&(de(Re,u),de(xe,m))}function vr(u){Re.current===u&&(ce(xe),ce(Re)),ht.current===u&&(ce(ht),qb._currentValue=ue)}var li,on;function qi(u){if(li===void 0)try{throw Error()}catch(m){var f=m.stack.trim().match(/\n( *(at )?)/);li=f&&f[1]||"",on=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+li+u+on}var pe=!1;function ye(u,f){if(!u||pe)return"";pe=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(f){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(ve){var we=ve}Reflect.construct(u,[],Ie)}else{try{Ie.call()}catch(ve){we=ve}u.call(Ie.prototype)}}else{try{throw Error()}catch(ve){we=ve}(Ie=u())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(ve){if(ve&&we&&typeof ve.stack=="string")return[ve.stack,we.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var L=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");L&&L.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=w.DetermineComponentFrameRoot(),P=E[0],z=E[1];if(P&&z){var te=P.split(`
`),be=z.split(`
`);for(L=w=0;w<te.length&&!te[w].includes("DetermineComponentFrameRoot");)w++;for(;L<be.length&&!be[L].includes("DetermineComponentFrameRoot");)L++;if(w===te.length||L===be.length)for(w=te.length-1,L=be.length-1;1<=w&&0<=L&&te[w]!==be[L];)L--;for(;1<=w&&0<=L;w--,L--)if(te[w]!==be[L]){if(w!==1||L!==1)do if(w--,L--,0>L||te[w]!==be[L]){var ke=`
`+te[w].replace(" at new "," at ");return u.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",u.displayName)),ke}while(1<=w&&0<=L);break}}}finally{pe=!1,Error.prepareStackTrace=m}return(m=u?u.displayName||u.name:"")?qi(m):""}function Fe(u,f){switch(u.tag){case 26:case 27:case 5:return qi(u.type);case 16:return qi("Lazy");case 13:return u.child!==f&&f!==null?qi("Suspense Fallback"):qi("Suspense");case 19:return qi("SuspenseList");case 0:case 15:return ye(u.type,!1);case 11:return ye(u.type.render,!1);case 1:return ye(u.type,!0);case 31:return qi("Activity");default:return""}}function st(u){try{var f="",m=null;do f+=Fe(u,m),m=u,u=u.return;while(u);return f}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var Q=Object.prototype.hasOwnProperty,T=s.unstable_scheduleCallback,F=s.unstable_cancelCallback,W=s.unstable_shouldYield,ne=s.unstable_requestPaint,he=s.unstable_now,Ce=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,Ft=s.unstable_UserBlockingPriority,Si=s.unstable_NormalPriority,zt=s.unstable_LowPriority,At=s.unstable_IdlePriority,Mn=s.log,Jr=s.unstable_setDisableYieldValue,Ks=null,Mi=null;function On(u){if(typeof Mn=="function"&&Jr(u),Mi&&typeof Mi.setStrictMode=="function")try{Mi.setStrictMode(Ks,u)}catch{}}var bn=Math.clz32?Math.clz32:Vm,rb=Math.log,lT=Math.LN2;function Vm(u){return u>>>=0,u===0?32:31-(rb(u)/lT|0)|0}var Nc=256,Hm=262144,Ll=4194304;function Ic(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return u&261888;case 262144:case 524288:case 1048576:case 2097152:return u&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function Wm(u,f,m){var w=u.pendingLanes;if(w===0)return 0;var L=0,E=u.suspendedLanes,P=u.pingedLanes;u=u.warmLanes;var z=w&134217727;return z!==0?(w=z&~E,w!==0?L=Ic(w):(P&=z,P!==0?L=Ic(P):m||(m=z&~u,m!==0&&(L=Ic(m))))):(z=w&~E,z!==0?L=Ic(z):P!==0?L=Ic(P):m||(m=w&~u,m!==0&&(L=Ic(m)))),L===0?0:f!==0&&f!==L&&(f&E)===0&&(E=L&-L,m=f&-f,E>=m||E===32&&(m&4194048)!==0)?f:L}function wn(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function fh(u,f){switch(u){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fy(){var u=Ll;return Ll<<=1,(Ll&62914560)===0&&(Ll=4194304),u}function zm(u){for(var f=[],m=0;31>m;m++)f.push(u);return f}function Rc(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function gy(u,f,m,w,L,E){var P=u.pendingLanes;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=m,u.entangledLanes&=m,u.errorRecoveryDisabledLanes&=m,u.shellSuspendCounter=0;var z=u.entanglements,te=u.expirationTimes,be=u.hiddenUpdates;for(m=P&~m;0<m;){var ke=31-bn(m),Ie=1<<ke;z[ke]=0,te[ke]=-1;var we=be[ke];if(we!==null)for(be[ke]=null,ke=0;ke<we.length;ke++){var ve=we[ke];ve!==null&&(ve.lane&=-536870913)}m&=~Ie}w!==0&&ob(u,w,0),E!==0&&L===0&&u.tag!==0&&(u.suspendedLanes|=E&~(P&~f))}function ob(u,f,m){u.pendingLanes|=f,u.suspendedLanes&=~f;var w=31-bn(f);u.entangledLanes|=f,u.entanglements[w]=u.entanglements[w]|1073741824|m&261930}function my(u,f){var m=u.entangledLanes|=f;for(u=u.entanglements;m;){var w=31-bn(m),L=1<<w;L&f|u[w]&f&&(u[w]|=f),m&=~L}}function Oo(u,f){var m=f&-f;return m=(m&42)!==0?1:Ha(m),(m&(u.suspendedLanes|f))!==0?0:m}function Ha(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function Um(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function ab(){var u=ee.p;return u!==0?u:(u=window.event,u===void 0?32:qV(u.type))}function jm(u,f){var m=ee.p;try{return ee.p=u,f()}finally{ee.p=m}}var Wa=Math.random().toString(36).slice(2),Gi="__reactFiber$"+Wa,Ys="__reactProps$"+Wa,Ac="__reactContainer$"+Wa,$m="__reactEvents$"+Wa,py="__reactListeners$"+Wa,cT="__reactHandles$"+Wa,ct="__reactResources$"+Wa,re="__reactMarker$"+Wa;function Ve(u){delete u[Gi],delete u[Ys],delete u[$m],delete u[py],delete u[cT]}function Je(u){var f=u[Gi];if(f)return f;for(var m=u.parentNode;m;){if(f=m[Ac]||m[Gi]){if(m=f.alternate,f.child!==null||m!==null&&m.child!==null)for(u=NV(u);u!==null;){if(m=u[Gi])return m;u=NV(u)}return f}u=m,m=u.parentNode}return null}function Di(u){if(u=u[Gi]||u[Ac]){var f=u.tag;if(f===5||f===6||f===13||f===31||f===26||f===27||f===3)return u}return null}function Pn(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u.stateNode;throw Error(i(33))}function Ki(u){var f=u[ct];return f||(f=u[ct]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function wi(u){u[re]=!0}var ua=new Set,Mc={};function za(u,f){vn(u,f),vn(u+"Capture",f)}function vn(u,f){for(Mc[u]=f,u=0;u<f.length;u++)ua.add(f[u])}var _y=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lb={},f9={};function tne(u){return Q.call(f9,u)?!0:Q.call(lb,u)?!1:_y.test(u)?f9[u]=!0:(lb[u]=!0,!1)}function by(u,f,m){if(tne(f))if(m===null)u.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":u.removeAttribute(f);return;case"boolean":var w=f.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){u.removeAttribute(f);return}}u.setAttribute(f,""+m)}}function wy(u,f,m){if(m===null)u.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(f);return}u.setAttribute(f,""+m)}}function Oc(u,f,m,w){if(w===null)u.removeAttribute(m);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(m);return}u.setAttributeNS(f,m,""+w)}}function ha(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function g9(u){var f=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function ine(u,f,m){var w=Object.getOwnPropertyDescriptor(u.constructor.prototype,f);if(!u.hasOwnProperty(f)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var L=w.get,E=w.set;return Object.defineProperty(u,f,{configurable:!0,get:function(){return L.call(this)},set:function(P){m=""+P,E.call(this,P)}}),Object.defineProperty(u,f,{enumerable:w.enumerable}),{getValue:function(){return m},setValue:function(P){m=""+P},stopTracking:function(){u._valueTracker=null,delete u[f]}}}}function uT(u){if(!u._valueTracker){var f=g9(u)?"checked":"value";u._valueTracker=ine(u,f,""+u[f])}}function m9(u){if(!u)return!1;var f=u._valueTracker;if(!f)return!0;var m=f.getValue(),w="";return u&&(w=g9(u)?u.checked?"true":"false":u.value),u=w,u!==m?(f.setValue(u),!0):!1}function vy(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var nne=/[\n"\\]/g;function da(u){return u.replace(nne,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function hT(u,f,m,w,L,E,P,z){u.name="",P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?u.type=P:u.removeAttribute("type"),f!=null?P==="number"?(f===0&&u.value===""||u.value!=f)&&(u.value=""+ha(f)):u.value!==""+ha(f)&&(u.value=""+ha(f)):P!=="submit"&&P!=="reset"||u.removeAttribute("value"),f!=null?dT(u,P,ha(f)):m!=null?dT(u,P,ha(m)):w!=null&&u.removeAttribute("value"),L==null&&E!=null&&(u.defaultChecked=!!E),L!=null&&(u.checked=L&&typeof L!="function"&&typeof L!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?u.name=""+ha(z):u.removeAttribute("name")}function p9(u,f,m,w,L,E,P,z){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(u.type=E),f!=null||m!=null){if(!(E!=="submit"&&E!=="reset"||f!=null)){uT(u);return}m=m!=null?""+ha(m):"",f=f!=null?""+ha(f):m,z||f===u.value||(u.value=f),u.defaultValue=f}w=w??L,w=typeof w!="function"&&typeof w!="symbol"&&!!w,u.checked=z?u.checked:!!w,u.defaultChecked=!!w,P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(u.name=P),uT(u)}function dT(u,f,m){f==="number"&&vy(u.ownerDocument)===u||u.defaultValue===""+m||(u.defaultValue=""+m)}function qm(u,f,m,w){if(u=u.options,f){f={};for(var L=0;L<m.length;L++)f["$"+m[L]]=!0;for(m=0;m<u.length;m++)L=f.hasOwnProperty("$"+u[m].value),u[m].selected!==L&&(u[m].selected=L),L&&w&&(u[m].defaultSelected=!0)}else{for(m=""+ha(m),f=null,L=0;L<u.length;L++){if(u[L].value===m){u[L].selected=!0,w&&(u[L].defaultSelected=!0);return}f!==null||u[L].disabled||(f=u[L])}f!==null&&(f.selected=!0)}}function _9(u,f,m){if(f!=null&&(f=""+ha(f),f!==u.value&&(u.value=f),m==null)){u.defaultValue!==f&&(u.defaultValue=f);return}u.defaultValue=m!=null?""+ha(m):""}function b9(u,f,m,w){if(f==null){if(w!=null){if(m!=null)throw Error(i(92));if(Y(w)){if(1<w.length)throw Error(i(93));w=w[0]}m=w}m==null&&(m=""),f=m}m=ha(f),u.defaultValue=m,w=u.textContent,w===m&&w!==""&&w!==null&&(u.value=w),uT(u)}function Gm(u,f){if(f){var m=u.firstChild;if(m&&m===u.lastChild&&m.nodeType===3){m.nodeValue=f;return}}u.textContent=f}var sne=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function w9(u,f,m){var w=f.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?w?u.setProperty(f,""):f==="float"?u.cssFloat="":u[f]="":w?u.setProperty(f,m):typeof m!="number"||m===0||sne.has(f)?f==="float"?u.cssFloat=m:u[f]=(""+m).trim():u[f]=m+"px"}function v9(u,f,m){if(f!=null&&typeof f!="object")throw Error(i(62));if(u=u.style,m!=null){for(var w in m)!m.hasOwnProperty(w)||f!=null&&f.hasOwnProperty(w)||(w.indexOf("--")===0?u.setProperty(w,""):w==="float"?u.cssFloat="":u[w]="");for(var L in f)w=f[L],f.hasOwnProperty(L)&&m[L]!==w&&w9(u,L,w)}else for(var E in f)f.hasOwnProperty(E)&&w9(u,E,f[E])}function fT(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rne=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),one=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cy(u){return one.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}function Pc(){}var gT=null;function mT(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Km=null,Ym=null;function C9(u){var f=Di(u);if(f&&(u=f.stateNode)){var m=u[Ys]||null;e:switch(u=f.stateNode,f.type){case"input":if(hT(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),f=m.name,m.type==="radio"&&f!=null){for(m=u;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+da(""+f)+'"][type="radio"]'),f=0;f<m.length;f++){var w=m[f];if(w!==u&&w.form===u.form){var L=w[Ys]||null;if(!L)throw Error(i(90));hT(w,L.value,L.defaultValue,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name)}}for(f=0;f<m.length;f++)w=m[f],w.form===u.form&&m9(w)}break e;case"textarea":_9(u,m.value,m.defaultValue);break e;case"select":f=m.value,f!=null&&qm(u,!!m.multiple,f,!1)}}}var pT=!1;function y9(u,f,m){if(pT)return u(f,m);pT=!0;try{var w=u(f);return w}finally{if(pT=!1,(Km!==null||Ym!==null)&&(lS(),Km&&(f=Km,u=Ym,Ym=Km=null,C9(f),u)))for(f=0;f<u.length;f++)C9(u[f])}}function cb(u,f){var m=u.stateNode;if(m===null)return null;var w=m[Ys]||null;if(w===null)return null;m=w[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(u=u.type,w=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!w;break e;default:u=!1}if(u)return null;if(m&&typeof m!="function")throw Error(i(231,f,typeof m));return m}var Fc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_T=!1;if(Fc)try{var ub={};Object.defineProperty(ub,"passive",{get:function(){_T=!0}}),window.addEventListener("test",ub,ub),window.removeEventListener("test",ub,ub)}catch{_T=!1}var gh=null,bT=null,yy=null;function S9(){if(yy)return yy;var u,f=bT,m=f.length,w,L="value"in gh?gh.value:gh.textContent,E=L.length;for(u=0;u<m&&f[u]===L[u];u++);var P=m-u;for(w=1;w<=P&&f[m-w]===L[E-w];w++);return yy=L.slice(u,1<w?1-w:void 0)}function Sy(u){var f=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&f===13&&(u=13)):u=f,u===10&&(u=13),32<=u||u===13?u:0}function xy(){return!0}function x9(){return!1}function eo(u){function f(m,w,L,E,P){this._reactName=m,this._targetInst=L,this.type=w,this.nativeEvent=E,this.target=P,this.currentTarget=null;for(var z in u)u.hasOwnProperty(z)&&(m=u[z],this[z]=m?m(E):E[z]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?xy:x9,this.isPropagationStopped=x9,this}return d(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=xy)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=xy)},persist:function(){},isPersistent:xy}),f}var Gd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ly=eo(Gd),hb=d({},Gd,{view:0,detail:0}),ane=eo(hb),wT,vT,db,ky=d({},hb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yT,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==db&&(db&&u.type==="mousemove"?(wT=u.screenX-db.screenX,vT=u.screenY-db.screenY):vT=wT=0,db=u),wT)},movementY:function(u){return"movementY"in u?u.movementY:vT}}),L9=eo(ky),lne=d({},ky,{dataTransfer:0}),cne=eo(lne),une=d({},hb,{relatedTarget:0}),CT=eo(une),hne=d({},Gd,{animationName:0,elapsedTime:0,pseudoElement:0}),dne=eo(hne),fne=d({},Gd,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),gne=eo(fne),mne=d({},Gd,{data:0}),k9=eo(mne),pne={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_ne={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bne={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wne(u){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(u):(u=bne[u])?!!f[u]:!1}function yT(){return wne}var vne=d({},hb,{key:function(u){if(u.key){var f=pne[u.key]||u.key;if(f!=="Unidentified")return f}return u.type==="keypress"?(u=Sy(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?_ne[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yT,charCode:function(u){return u.type==="keypress"?Sy(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Sy(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Cne=eo(vne),yne=d({},ky,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E9=eo(yne),Sne=d({},hb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yT}),xne=eo(Sne),Lne=d({},Gd,{propertyName:0,elapsedTime:0,pseudoElement:0}),kne=eo(Lne),Ene=d({},ky,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Dne=eo(Ene),Tne=d({},Gd,{newState:0,oldState:0}),Nne=eo(Tne),Ine=[9,13,27,32],ST=Fc&&"CompositionEvent"in window,fb=null;Fc&&"documentMode"in document&&(fb=document.documentMode);var Rne=Fc&&"TextEvent"in window&&!fb,D9=Fc&&(!ST||fb&&8<fb&&11>=fb),T9=" ",N9=!1;function I9(u,f){switch(u){case"keyup":return Ine.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function R9(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Qm=!1;function Ane(u,f){switch(u){case"compositionend":return R9(f);case"keypress":return f.which!==32?null:(N9=!0,T9);case"textInput":return u=f.data,u===T9&&N9?null:u;default:return null}}function Mne(u,f){if(Qm)return u==="compositionend"||!ST&&I9(u,f)?(u=S9(),yy=bT=gh=null,Qm=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return D9&&f.locale!=="ko"?null:f.data;default:return null}}var One={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A9(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f==="input"?!!One[u.type]:f==="textarea"}function M9(u,f,m,w){Km?Ym?Ym.push(w):Ym=[w]:Km=w,f=mS(f,"onChange"),0<f.length&&(m=new Ly("onChange","change",null,m,w),u.push({event:m,listeners:f}))}var gb=null,mb=null;function Pne(u){pV(u,0)}function Ey(u){var f=Pn(u);if(m9(f))return u}function O9(u,f){if(u==="change")return f}var P9=!1;if(Fc){var xT;if(Fc){var LT="oninput"in document;if(!LT){var F9=document.createElement("div");F9.setAttribute("oninput","return;"),LT=typeof F9.oninput=="function"}xT=LT}else xT=!1;P9=xT&&(!document.documentMode||9<document.documentMode)}function B9(){gb&&(gb.detachEvent("onpropertychange",V9),mb=gb=null)}function V9(u){if(u.propertyName==="value"&&Ey(mb)){var f=[];M9(f,mb,u,mT(u)),y9(Pne,f)}}function Fne(u,f,m){u==="focusin"?(B9(),gb=f,mb=m,gb.attachEvent("onpropertychange",V9)):u==="focusout"&&B9()}function Bne(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Ey(mb)}function Vne(u,f){if(u==="click")return Ey(f)}function Hne(u,f){if(u==="input"||u==="change")return Ey(f)}function Wne(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var Po=typeof Object.is=="function"?Object.is:Wne;function pb(u,f){if(Po(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var m=Object.keys(u),w=Object.keys(f);if(m.length!==w.length)return!1;for(w=0;w<m.length;w++){var L=m[w];if(!Q.call(f,L)||!Po(u[L],f[L]))return!1}return!0}function H9(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function W9(u,f){var m=H9(u);u=0;for(var w;m;){if(m.nodeType===3){if(w=u+m.textContent.length,u<=f&&w>=f)return{node:m,offset:f-u};u=w}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=H9(m)}}function z9(u,f){return u&&f?u===f?!0:u&&u.nodeType===3?!1:f&&f.nodeType===3?z9(u,f.parentNode):"contains"in u?u.contains(f):u.compareDocumentPosition?!!(u.compareDocumentPosition(f)&16):!1:!1}function U9(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var f=vy(u.document);f instanceof u.HTMLIFrameElement;){try{var m=typeof f.contentWindow.location.href=="string"}catch{m=!1}if(m)u=f.contentWindow;else break;f=vy(u.document)}return f}function kT(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f&&(f==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||f==="textarea"||u.contentEditable==="true")}var zne=Fc&&"documentMode"in document&&11>=document.documentMode,Xm=null,ET=null,_b=null,DT=!1;function j9(u,f,m){var w=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;DT||Xm==null||Xm!==vy(w)||(w=Xm,"selectionStart"in w&&kT(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),_b&&pb(_b,w)||(_b=w,w=mS(ET,"onSelect"),0<w.length&&(f=new Ly("onSelect","select",null,f,m),u.push({event:f,listeners:w}),f.target=Xm)))}function Kd(u,f){var m={};return m[u.toLowerCase()]=f.toLowerCase(),m["Webkit"+u]="webkit"+f,m["Moz"+u]="moz"+f,m}var Zm={animationend:Kd("Animation","AnimationEnd"),animationiteration:Kd("Animation","AnimationIteration"),animationstart:Kd("Animation","AnimationStart"),transitionrun:Kd("Transition","TransitionRun"),transitionstart:Kd("Transition","TransitionStart"),transitioncancel:Kd("Transition","TransitionCancel"),transitionend:Kd("Transition","TransitionEnd")},TT={},$9={};Fc&&($9=document.createElement("div").style,"AnimationEvent"in window||(delete Zm.animationend.animation,delete Zm.animationiteration.animation,delete Zm.animationstart.animation),"TransitionEvent"in window||delete Zm.transitionend.transition);function Yd(u){if(TT[u])return TT[u];if(!Zm[u])return u;var f=Zm[u],m;for(m in f)if(f.hasOwnProperty(m)&&m in $9)return TT[u]=f[m];return u}var q9=Yd("animationend"),G9=Yd("animationiteration"),K9=Yd("animationstart"),Une=Yd("transitionrun"),jne=Yd("transitionstart"),$ne=Yd("transitioncancel"),Y9=Yd("transitionend"),Q9=new Map,NT="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");NT.push("scrollEnd");function Ua(u,f){Q9.set(u,f),za(f,[u])}var Dy=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},fa=[],Jm=0,IT=0;function Ty(){for(var u=Jm,f=IT=Jm=0;f<u;){var m=fa[f];fa[f++]=null;var w=fa[f];fa[f++]=null;var L=fa[f];fa[f++]=null;var E=fa[f];if(fa[f++]=null,w!==null&&L!==null){var P=w.pending;P===null?L.next=L:(L.next=P.next,P.next=L),w.pending=L}E!==0&&X9(m,L,E)}}function Ny(u,f,m,w){fa[Jm++]=u,fa[Jm++]=f,fa[Jm++]=m,fa[Jm++]=w,IT|=w,u.lanes|=w,u=u.alternate,u!==null&&(u.lanes|=w)}function RT(u,f,m,w){return Ny(u,f,m,w),Iy(u)}function Qd(u,f){return Ny(u,null,null,f),Iy(u)}function X9(u,f,m){u.lanes|=m;var w=u.alternate;w!==null&&(w.lanes|=m);for(var L=!1,E=u.return;E!==null;)E.childLanes|=m,w=E.alternate,w!==null&&(w.childLanes|=m),E.tag===22&&(u=E.stateNode,u===null||u._visibility&1||(L=!0)),u=E,E=E.return;return u.tag===3?(E=u.stateNode,L&&f!==null&&(L=31-bn(m),u=E.hiddenUpdates,w=u[L],w===null?u[L]=[f]:w.push(f),f.lane=m|536870912),E):null}function Iy(u){if(50<Vb)throw Vb=0,WN=null,Error(i(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}var ep={};function qne(u,f,m,w){this.tag=u,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fo(u,f,m,w){return new qne(u,f,m,w)}function AT(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Bc(u,f){var m=u.alternate;return m===null?(m=Fo(u.tag,f,u.key,u.mode),m.elementType=u.elementType,m.type=u.type,m.stateNode=u.stateNode,m.alternate=u,u.alternate=m):(m.pendingProps=f,m.type=u.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=u.flags&65011712,m.childLanes=u.childLanes,m.lanes=u.lanes,m.child=u.child,m.memoizedProps=u.memoizedProps,m.memoizedState=u.memoizedState,m.updateQueue=u.updateQueue,f=u.dependencies,m.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},m.sibling=u.sibling,m.index=u.index,m.ref=u.ref,m.refCleanup=u.refCleanup,m}function Z9(u,f){u.flags&=65011714;var m=u.alternate;return m===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=m.childLanes,u.lanes=m.lanes,u.child=m.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=m.memoizedProps,u.memoizedState=m.memoizedState,u.updateQueue=m.updateQueue,u.type=m.type,f=m.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function Ry(u,f,m,w,L,E){var P=0;if(w=u,typeof u=="function")AT(u)&&(P=1);else if(typeof u=="string")P=Xse(u,m,xe.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case M:return u=Fo(31,m,f,L),u.elementType=M,u.lanes=E,u;case b:return Xd(m.children,L,E,f);case C:P=8,L|=24;break;case x:return u=Fo(12,m,f,L|2),u.elementType=x,u.lanes=E,u;case D:return u=Fo(13,m,f,L),u.elementType=D,u.lanes=E,u;case R:return u=Fo(19,m,f,L),u.elementType=R,u.lanes=E,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case y:P=10;break e;case S:P=9;break e;case k:P=11;break e;case N:P=14;break e;case A:P=16,w=null;break e}P=29,m=Error(i(130,u===null?"null":typeof u,"")),w=null}return f=Fo(P,m,f,L),f.elementType=u,f.type=w,f.lanes=E,f}function Xd(u,f,m,w){return u=Fo(7,u,w,f),u.lanes=m,u}function MT(u,f,m){return u=Fo(6,u,null,f),u.lanes=m,u}function J9(u){var f=Fo(18,null,null,0);return f.stateNode=u,f}function OT(u,f,m){return f=Fo(4,u.children!==null?u.children:[],u.key,f),f.lanes=m,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}var eF=new WeakMap;function ga(u,f){if(typeof u=="object"&&u!==null){var m=eF.get(u);return m!==void 0?m:(f={value:u,source:f,stack:st(f)},eF.set(u,f),f)}return{value:u,source:f,stack:st(f)}}var tp=[],ip=0,Ay=null,bb=0,ma=[],pa=0,mh=null,kl=1,El="";function Vc(u,f){tp[ip++]=bb,tp[ip++]=Ay,Ay=u,bb=f}function tF(u,f,m){ma[pa++]=kl,ma[pa++]=El,ma[pa++]=mh,mh=u;var w=kl;u=El;var L=32-bn(w)-1;w&=~(1<<L),m+=1;var E=32-bn(f)+L;if(30<E){var P=L-L%5;E=(w&(1<<P)-1).toString(32),w>>=P,L-=P,kl=1<<32-bn(f)+L|m<<L|w,El=E+u}else kl=1<<E|m<<L|w,El=u}function PT(u){u.return!==null&&(Vc(u,1),tF(u,1,0))}function FT(u){for(;u===Ay;)Ay=tp[--ip],tp[ip]=null,bb=tp[--ip],tp[ip]=null;for(;u===mh;)mh=ma[--pa],ma[pa]=null,El=ma[--pa],ma[pa]=null,kl=ma[--pa],ma[pa]=null}function iF(u,f){ma[pa++]=kl,ma[pa++]=El,ma[pa++]=mh,kl=f.id,El=f.overflow,mh=u}var Qs=null,fn=null,ci=!1,ph=null,_a=!1,BT=Error(i(519));function _h(u){var f=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wb(ga(f,u)),BT}function nF(u){var f=u.stateNode,m=u.type,w=u.memoizedProps;switch(f[Gi]=u,f[Ys]=w,m){case"dialog":Jt("cancel",f),Jt("close",f);break;case"iframe":case"object":case"embed":Jt("load",f);break;case"video":case"audio":for(m=0;m<Wb.length;m++)Jt(Wb[m],f);break;case"source":Jt("error",f);break;case"img":case"image":case"link":Jt("error",f),Jt("load",f);break;case"details":Jt("toggle",f);break;case"input":Jt("invalid",f),p9(f,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":Jt("invalid",f);break;case"textarea":Jt("invalid",f),b9(f,w.value,w.defaultValue,w.children)}m=w.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||f.textContent===""+m||w.suppressHydrationWarning===!0||vV(f.textContent,m)?(w.popover!=null&&(Jt("beforetoggle",f),Jt("toggle",f)),w.onScroll!=null&&Jt("scroll",f),w.onScrollEnd!=null&&Jt("scrollend",f),w.onClick!=null&&(f.onclick=Pc),f=!0):f=!1,f||_h(u,!0)}function sF(u){for(Qs=u.return;Qs;)switch(Qs.tag){case 5:case 31:case 13:_a=!1;return;case 27:case 3:_a=!0;return;default:Qs=Qs.return}}function np(u){if(u!==Qs)return!1;if(!ci)return sF(u),ci=!0,!1;var f=u.tag,m;if((m=f!==3&&f!==27)&&((m=f===5)&&(m=u.type,m=!(m!=="form"&&m!=="button")||iI(u.type,u.memoizedProps)),m=!m),m&&fn&&_h(u),sF(u),f===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(i(317));fn=TV(u)}else if(f===31){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(i(317));fn=TV(u)}else f===27?(f=fn,Ih(u.type)?(u=aI,aI=null,fn=u):fn=f):fn=Qs?wa(u.stateNode.nextSibling):null;return!0}function Zd(){fn=Qs=null,ci=!1}function VT(){var u=ph;return u!==null&&(so===null?so=u:so.push.apply(so,u),ph=null),u}function wb(u){ph===null?ph=[u]:ph.push(u)}var HT=$(null),Jd=null,Hc=null;function bh(u,f,m){de(HT,f._currentValue),f._currentValue=m}function Wc(u){u._currentValue=HT.current,ce(HT)}function WT(u,f,m){for(;u!==null;){var w=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,w!==null&&(w.childLanes|=f)):w!==null&&(w.childLanes&f)!==f&&(w.childLanes|=f),u===m)break;u=u.return}}function zT(u,f,m,w){var L=u.child;for(L!==null&&(L.return=u);L!==null;){var E=L.dependencies;if(E!==null){var P=L.child;E=E.firstContext;e:for(;E!==null;){var z=E;E=L;for(var te=0;te<f.length;te++)if(z.context===f[te]){E.lanes|=m,z=E.alternate,z!==null&&(z.lanes|=m),WT(E.return,m,u),w||(P=null);break e}E=z.next}}else if(L.tag===18){if(P=L.return,P===null)throw Error(i(341));P.lanes|=m,E=P.alternate,E!==null&&(E.lanes|=m),WT(P,m,u),P=null}else P=L.child;if(P!==null)P.return=L;else for(P=L;P!==null;){if(P===u){P=null;break}if(L=P.sibling,L!==null){L.return=P.return,P=L;break}P=P.return}L=P}}function sp(u,f,m,w){u=null;for(var L=f,E=!1;L!==null;){if(!E){if((L.flags&524288)!==0)E=!0;else if((L.flags&262144)!==0)break}if(L.tag===10){var P=L.alternate;if(P===null)throw Error(i(387));if(P=P.memoizedProps,P!==null){var z=L.type;Po(L.pendingProps.value,P.value)||(u!==null?u.push(z):u=[z])}}else if(L===ht.current){if(P=L.alternate,P===null)throw Error(i(387));P.memoizedState.memoizedState!==L.memoizedState.memoizedState&&(u!==null?u.push(qb):u=[qb])}L=L.return}u!==null&&zT(f,u,m,w),f.flags|=262144}function My(u){for(u=u.firstContext;u!==null;){if(!Po(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function ef(u){Jd=u,Hc=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Xs(u){return rF(Jd,u)}function Oy(u,f){return Jd===null&&ef(u),rF(u,f)}function rF(u,f){var m=f._currentValue;if(f={context:f,memoizedValue:m,next:null},Hc===null){if(u===null)throw Error(i(308));Hc=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else Hc=Hc.next=f;return m}var Gne=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(m,w){u.push(w)}};this.abort=function(){f.aborted=!0,u.forEach(function(m){return m()})}},Kne=s.unstable_scheduleCallback,Yne=s.unstable_NormalPriority,os={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function UT(){return{controller:new Gne,data:new Map,refCount:0}}function vb(u){u.refCount--,u.refCount===0&&Kne(Yne,function(){u.controller.abort()})}var Cb=null,jT=0,rp=0,op=null;function Qne(u,f){if(Cb===null){var m=Cb=[];jT=0,rp=GN(),op={status:"pending",value:void 0,then:function(w){m.push(w)}}}return jT++,f.then(oF,oF),f}function oF(){if(--jT===0&&Cb!==null){op!==null&&(op.status="fulfilled");var u=Cb;Cb=null,rp=0,op=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function Xne(u,f){var m=[],w={status:"pending",value:null,reason:null,then:function(L){m.push(L)}};return u.then(function(){w.status="fulfilled",w.value=f;for(var L=0;L<m.length;L++)(0,m[L])(f)},function(L){for(w.status="rejected",w.reason=L,L=0;L<m.length;L++)(0,m[L])(void 0)}),w}var aF=q.S;q.S=function(u,f){jB=he(),typeof f=="object"&&f!==null&&typeof f.then=="function"&&Qne(u,f),aF!==null&&aF(u,f)};var tf=$(null);function $T(){var u=tf.current;return u!==null?u:Yi.pooledCache}function Py(u,f){f===null?de(tf,tf.current):de(tf,f.pool)}function lF(){var u=$T();return u===null?null:{parent:os._currentValue,pool:u}}var ap=Error(i(460)),qT=Error(i(474)),Fy=Error(i(542)),By={then:function(){}};function cF(u){return u=u.status,u==="fulfilled"||u==="rejected"}function uF(u,f,m){switch(m=u[m],m===void 0?u.push(f):m!==f&&(f.then(Pc,Pc),f=m),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,dF(u),u;default:if(typeof f.status=="string")f.then(Pc,Pc);else{if(u=Yi,u!==null&&100<u.shellSuspendCounter)throw Error(i(482));u=f,u.status="pending",u.then(function(w){if(f.status==="pending"){var L=f;L.status="fulfilled",L.value=w}},function(w){if(f.status==="pending"){var L=f;L.status="rejected",L.reason=w}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,dF(u),u}throw sf=f,ap}}function nf(u){try{var f=u._init;return f(u._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(sf=m,ap):m}}var sf=null;function hF(){if(sf===null)throw Error(i(459));var u=sf;return sf=null,u}function dF(u){if(u===ap||u===Fy)throw Error(i(483))}var lp=null,yb=0;function Vy(u){var f=yb;return yb+=1,lp===null&&(lp=[]),uF(lp,u,f)}function Sb(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function Hy(u,f){throw f.$$typeof===g?Error(i(525)):(u=Object.prototype.toString.call(f),Error(i(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function fF(u){function f(fe,se){if(u){var _e=fe.deletions;_e===null?(fe.deletions=[se],fe.flags|=16):_e.push(se)}}function m(fe,se){if(!u)return null;for(;se!==null;)f(fe,se),se=se.sibling;return null}function w(fe){for(var se=new Map;fe!==null;)fe.key!==null?se.set(fe.key,fe):se.set(fe.index,fe),fe=fe.sibling;return se}function L(fe,se){return fe=Bc(fe,se),fe.index=0,fe.sibling=null,fe}function E(fe,se,_e){return fe.index=_e,u?(_e=fe.alternate,_e!==null?(_e=_e.index,_e<se?(fe.flags|=67108866,se):_e):(fe.flags|=67108866,se)):(fe.flags|=1048576,se)}function P(fe){return u&&fe.alternate===null&&(fe.flags|=67108866),fe}function z(fe,se,_e,Te){return se===null||se.tag!==6?(se=MT(_e,fe.mode,Te),se.return=fe,se):(se=L(se,_e),se.return=fe,se)}function te(fe,se,_e,Te){var dt=_e.type;return dt===b?ke(fe,se,_e.props.children,Te,_e.key):se!==null&&(se.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===A&&nf(dt)===se.type)?(se=L(se,_e.props),Sb(se,_e),se.return=fe,se):(se=Ry(_e.type,_e.key,_e.props,null,fe.mode,Te),Sb(se,_e),se.return=fe,se)}function be(fe,se,_e,Te){return se===null||se.tag!==4||se.stateNode.containerInfo!==_e.containerInfo||se.stateNode.implementation!==_e.implementation?(se=OT(_e,fe.mode,Te),se.return=fe,se):(se=L(se,_e.children||[]),se.return=fe,se)}function ke(fe,se,_e,Te,dt){return se===null||se.tag!==7?(se=Xd(_e,fe.mode,Te,dt),se.return=fe,se):(se=L(se,_e),se.return=fe,se)}function Ie(fe,se,_e){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=MT(""+se,fe.mode,_e),se.return=fe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case p:return _e=Ry(se.type,se.key,se.props,null,fe.mode,_e),Sb(_e,se),_e.return=fe,_e;case _:return se=OT(se,fe.mode,_e),se.return=fe,se;case A:return se=nf(se),Ie(fe,se,_e)}if(Y(se)||H(se))return se=Xd(se,fe.mode,_e,null),se.return=fe,se;if(typeof se.then=="function")return Ie(fe,Vy(se),_e);if(se.$$typeof===y)return Ie(fe,Oy(fe,se),_e);Hy(fe,se)}return null}function we(fe,se,_e,Te){var dt=se!==null?se.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return dt!==null?null:z(fe,se,""+_e,Te);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case p:return _e.key===dt?te(fe,se,_e,Te):null;case _:return _e.key===dt?be(fe,se,_e,Te):null;case A:return _e=nf(_e),we(fe,se,_e,Te)}if(Y(_e)||H(_e))return dt!==null?null:ke(fe,se,_e,Te,null);if(typeof _e.then=="function")return we(fe,se,Vy(_e),Te);if(_e.$$typeof===y)return we(fe,se,Oy(fe,_e),Te);Hy(fe,_e)}return null}function ve(fe,se,_e,Te,dt){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return fe=fe.get(_e)||null,z(se,fe,""+Te,dt);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case p:return fe=fe.get(Te.key===null?_e:Te.key)||null,te(se,fe,Te,dt);case _:return fe=fe.get(Te.key===null?_e:Te.key)||null,be(se,fe,Te,dt);case A:return Te=nf(Te),ve(fe,se,_e,Te,dt)}if(Y(Te)||H(Te))return fe=fe.get(_e)||null,ke(se,fe,Te,dt,null);if(typeof Te.then=="function")return ve(fe,se,_e,Vy(Te),dt);if(Te.$$typeof===y)return ve(fe,se,_e,Oy(se,Te),dt);Hy(se,Te)}return null}function it(fe,se,_e,Te){for(var dt=null,xi=null,at=se,Ut=se=0,ai=null;at!==null&&Ut<_e.length;Ut++){at.index>Ut?(ai=at,at=null):ai=at.sibling;var Li=we(fe,at,_e[Ut],Te);if(Li===null){at===null&&(at=ai);break}u&&at&&Li.alternate===null&&f(fe,at),se=E(Li,se,Ut),xi===null?dt=Li:xi.sibling=Li,xi=Li,at=ai}if(Ut===_e.length)return m(fe,at),ci&&Vc(fe,Ut),dt;if(at===null){for(;Ut<_e.length;Ut++)at=Ie(fe,_e[Ut],Te),at!==null&&(se=E(at,se,Ut),xi===null?dt=at:xi.sibling=at,xi=at);return ci&&Vc(fe,Ut),dt}for(at=w(at);Ut<_e.length;Ut++)ai=ve(at,fe,Ut,_e[Ut],Te),ai!==null&&(u&&ai.alternate!==null&&at.delete(ai.key===null?Ut:ai.key),se=E(ai,se,Ut),xi===null?dt=ai:xi.sibling=ai,xi=ai);return u&&at.forEach(function(Ph){return f(fe,Ph)}),ci&&Vc(fe,Ut),dt}function bt(fe,se,_e,Te){if(_e==null)throw Error(i(151));for(var dt=null,xi=null,at=se,Ut=se=0,ai=null,Li=_e.next();at!==null&&!Li.done;Ut++,Li=_e.next()){at.index>Ut?(ai=at,at=null):ai=at.sibling;var Ph=we(fe,at,Li.value,Te);if(Ph===null){at===null&&(at=ai);break}u&&at&&Ph.alternate===null&&f(fe,at),se=E(Ph,se,Ut),xi===null?dt=Ph:xi.sibling=Ph,xi=Ph,at=ai}if(Li.done)return m(fe,at),ci&&Vc(fe,Ut),dt;if(at===null){for(;!Li.done;Ut++,Li=_e.next())Li=Ie(fe,Li.value,Te),Li!==null&&(se=E(Li,se,Ut),xi===null?dt=Li:xi.sibling=Li,xi=Li);return ci&&Vc(fe,Ut),dt}for(at=w(at);!Li.done;Ut++,Li=_e.next())Li=ve(at,fe,Ut,Li.value,Te),Li!==null&&(u&&Li.alternate!==null&&at.delete(Li.key===null?Ut:Li.key),se=E(Li,se,Ut),xi===null?dt=Li:xi.sibling=Li,xi=Li);return u&&at.forEach(function(lre){return f(fe,lre)}),ci&&Vc(fe,Ut),dt}function zi(fe,se,_e,Te){if(typeof _e=="object"&&_e!==null&&_e.type===b&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case p:e:{for(var dt=_e.key;se!==null;){if(se.key===dt){if(dt=_e.type,dt===b){if(se.tag===7){m(fe,se.sibling),Te=L(se,_e.props.children),Te.return=fe,fe=Te;break e}}else if(se.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===A&&nf(dt)===se.type){m(fe,se.sibling),Te=L(se,_e.props),Sb(Te,_e),Te.return=fe,fe=Te;break e}m(fe,se);break}else f(fe,se);se=se.sibling}_e.type===b?(Te=Xd(_e.props.children,fe.mode,Te,_e.key),Te.return=fe,fe=Te):(Te=Ry(_e.type,_e.key,_e.props,null,fe.mode,Te),Sb(Te,_e),Te.return=fe,fe=Te)}return P(fe);case _:e:{for(dt=_e.key;se!==null;){if(se.key===dt)if(se.tag===4&&se.stateNode.containerInfo===_e.containerInfo&&se.stateNode.implementation===_e.implementation){m(fe,se.sibling),Te=L(se,_e.children||[]),Te.return=fe,fe=Te;break e}else{m(fe,se);break}else f(fe,se);se=se.sibling}Te=OT(_e,fe.mode,Te),Te.return=fe,fe=Te}return P(fe);case A:return _e=nf(_e),zi(fe,se,_e,Te)}if(Y(_e))return it(fe,se,_e,Te);if(H(_e)){if(dt=H(_e),typeof dt!="function")throw Error(i(150));return _e=dt.call(_e),bt(fe,se,_e,Te)}if(typeof _e.then=="function")return zi(fe,se,Vy(_e),Te);if(_e.$$typeof===y)return zi(fe,se,Oy(fe,_e),Te);Hy(fe,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint"?(_e=""+_e,se!==null&&se.tag===6?(m(fe,se.sibling),Te=L(se,_e),Te.return=fe,fe=Te):(m(fe,se),Te=MT(_e,fe.mode,Te),Te.return=fe,fe=Te),P(fe)):m(fe,se)}return function(fe,se,_e,Te){try{yb=0;var dt=zi(fe,se,_e,Te);return lp=null,dt}catch(at){if(at===ap||at===Fy)throw at;var xi=Fo(29,at,null,fe.mode);return xi.lanes=Te,xi.return=fe,xi}finally{}}}var rf=fF(!0),gF=fF(!1),wh=!1;function GT(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function KT(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function vh(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Ch(u,f,m){var w=u.updateQueue;if(w===null)return null;if(w=w.shared,(Ti&2)!==0){var L=w.pending;return L===null?f.next=f:(f.next=L.next,L.next=f),w.pending=f,f=Iy(u),X9(u,null,m),f}return Ny(u,w,f,m),Iy(u)}function xb(u,f,m){if(f=f.updateQueue,f!==null&&(f=f.shared,(m&4194048)!==0)){var w=f.lanes;w&=u.pendingLanes,m|=w,f.lanes=m,my(u,m)}}function YT(u,f){var m=u.updateQueue,w=u.alternate;if(w!==null&&(w=w.updateQueue,m===w)){var L=null,E=null;if(m=m.firstBaseUpdate,m!==null){do{var P={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};E===null?L=E=P:E=E.next=P,m=m.next}while(m!==null);E===null?L=E=f:E=E.next=f}else L=E=f;m={baseState:w.baseState,firstBaseUpdate:L,lastBaseUpdate:E,shared:w.shared,callbacks:w.callbacks},u.updateQueue=m;return}u=m.lastBaseUpdate,u===null?m.firstBaseUpdate=f:u.next=f,m.lastBaseUpdate=f}var QT=!1;function Lb(){if(QT){var u=op;if(u!==null)throw u}}function kb(u,f,m,w){QT=!1;var L=u.updateQueue;wh=!1;var E=L.firstBaseUpdate,P=L.lastBaseUpdate,z=L.shared.pending;if(z!==null){L.shared.pending=null;var te=z,be=te.next;te.next=null,P===null?E=be:P.next=be,P=te;var ke=u.alternate;ke!==null&&(ke=ke.updateQueue,z=ke.lastBaseUpdate,z!==P&&(z===null?ke.firstBaseUpdate=be:z.next=be,ke.lastBaseUpdate=te))}if(E!==null){var Ie=L.baseState;P=0,ke=be=te=null,z=E;do{var we=z.lane&-536870913,ve=we!==z.lane;if(ve?(oi&we)===we:(w&we)===we){we!==0&&we===rp&&(QT=!0),ke!==null&&(ke=ke.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var it=u,bt=z;we=f;var zi=m;switch(bt.tag){case 1:if(it=bt.payload,typeof it=="function"){Ie=it.call(zi,Ie,we);break e}Ie=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=bt.payload,we=typeof it=="function"?it.call(zi,Ie,we):it,we==null)break e;Ie=d({},Ie,we);break e;case 2:wh=!0}}we=z.callback,we!==null&&(u.flags|=64,ve&&(u.flags|=8192),ve=L.callbacks,ve===null?L.callbacks=[we]:ve.push(we))}else ve={lane:we,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ke===null?(be=ke=ve,te=Ie):ke=ke.next=ve,P|=we;if(z=z.next,z===null){if(z=L.shared.pending,z===null)break;ve=z,z=ve.next,ve.next=null,L.lastBaseUpdate=ve,L.shared.pending=null}}while(!0);ke===null&&(te=Ie),L.baseState=te,L.firstBaseUpdate=be,L.lastBaseUpdate=ke,E===null&&(L.shared.lanes=0),kh|=P,u.lanes=P,u.memoizedState=Ie}}function mF(u,f){if(typeof u!="function")throw Error(i(191,u));u.call(f)}function pF(u,f){var m=u.callbacks;if(m!==null)for(u.callbacks=null,u=0;u<m.length;u++)mF(m[u],f)}var cp=$(null),Wy=$(0);function _F(u,f){u=Qc,de(Wy,u),de(cp,f),Qc=u|f.baseLanes}function XT(){de(Wy,Qc),de(cp,cp.current)}function ZT(){Qc=Wy.current,ce(cp),ce(Wy)}var Bo=$(null),ba=null;function yh(u){var f=u.alternate;de(Xn,Xn.current&1),de(Bo,u),ba===null&&(f===null||cp.current!==null||f.memoizedState!==null)&&(ba=u)}function JT(u){de(Xn,Xn.current),de(Bo,u),ba===null&&(ba=u)}function bF(u){u.tag===22?(de(Xn,Xn.current),de(Bo,u),ba===null&&(ba=u)):Sh()}function Sh(){de(Xn,Xn.current),de(Bo,Bo.current)}function Vo(u){ce(Bo),ba===u&&(ba=null),ce(Xn)}var Xn=$(0);function zy(u){for(var f=u;f!==null;){if(f.tag===13){var m=f.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||rI(m)||oI(m)))return f}else if(f.tag===19&&(f.memoizedProps.revealOrder==="forwards"||f.memoizedProps.revealOrder==="backwards"||f.memoizedProps.revealOrder==="unstable_legacy-backwards"||f.memoizedProps.revealOrder==="together")){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var zc=0,Bt=null,Hi=null,as=null,Uy=!1,up=!1,of=!1,jy=0,Eb=0,hp=null,Zne=0;function Fn(){throw Error(i(321))}function eN(u,f){if(f===null)return!1;for(var m=0;m<f.length&&m<u.length;m++)if(!Po(u[m],f[m]))return!1;return!0}function tN(u,f,m,w,L,E){return zc=E,Bt=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,q.H=u===null||u.memoizedState===null?tB:pN,of=!1,E=m(w,L),of=!1,up&&(E=vF(f,m,w,L)),wF(u),E}function wF(u){q.H=Nb;var f=Hi!==null&&Hi.next!==null;if(zc=0,as=Hi=Bt=null,Uy=!1,Eb=0,hp=null,f)throw Error(i(300));u===null||ls||(u=u.dependencies,u!==null&&My(u)&&(ls=!0))}function vF(u,f,m,w){Bt=u;var L=0;do{if(up&&(hp=null),Eb=0,up=!1,25<=L)throw Error(i(301));if(L+=1,as=Hi=null,u.updateQueue!=null){var E=u.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}q.H=iB,E=f(m,w)}while(up);return E}function Jne(){var u=q.H,f=u.useState()[0];return f=typeof f.then=="function"?Db(f):f,u=u.useState()[0],(Hi!==null?Hi.memoizedState:null)!==u&&(Bt.flags|=1024),f}function iN(){var u=jy!==0;return jy=0,u}function nN(u,f,m){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~m}function sN(u){if(Uy){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}Uy=!1}zc=0,as=Hi=Bt=null,up=!1,Eb=jy=0,hp=null}function Pr(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return as===null?Bt.memoizedState=as=u:as=as.next=u,as}function Zn(){if(Hi===null){var u=Bt.alternate;u=u!==null?u.memoizedState:null}else u=Hi.next;var f=as===null?Bt.memoizedState:as.next;if(f!==null)as=f,Hi=u;else{if(u===null)throw Bt.alternate===null?Error(i(467)):Error(i(310));Hi=u,u={memoizedState:Hi.memoizedState,baseState:Hi.baseState,baseQueue:Hi.baseQueue,queue:Hi.queue,next:null},as===null?Bt.memoizedState=as=u:as=as.next=u}return as}function $y(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Db(u){var f=Eb;return Eb+=1,hp===null&&(hp=[]),u=uF(hp,u,f),f=Bt,(as===null?f.memoizedState:as.next)===null&&(f=f.alternate,q.H=f===null||f.memoizedState===null?tB:pN),u}function qy(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Db(u);if(u.$$typeof===y)return Xs(u)}throw Error(i(438,String(u)))}function rN(u){var f=null,m=Bt.updateQueue;if(m!==null&&(f=m.memoCache),f==null){var w=Bt.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(f={data:w.data.map(function(L){return L.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),m===null&&(m=$y(),Bt.updateQueue=m),m.memoCache=f,m=f.data[f.index],m===void 0)for(m=f.data[f.index]=Array(u),w=0;w<u;w++)m[w]=O;return f.index++,m}function Uc(u,f){return typeof f=="function"?f(u):f}function Gy(u){var f=Zn();return oN(f,Hi,u)}function oN(u,f,m){var w=u.queue;if(w===null)throw Error(i(311));w.lastRenderedReducer=m;var L=u.baseQueue,E=w.pending;if(E!==null){if(L!==null){var P=L.next;L.next=E.next,E.next=P}f.baseQueue=L=E,w.pending=null}if(E=u.baseState,L===null)u.memoizedState=E;else{f=L.next;var z=P=null,te=null,be=f,ke=!1;do{var Ie=be.lane&-536870913;if(Ie!==be.lane?(oi&Ie)===Ie:(zc&Ie)===Ie){var we=be.revertLane;if(we===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Ie===rp&&(ke=!0);else if((zc&we)===we){be=be.next,we===rp&&(ke=!0);continue}else Ie={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},te===null?(z=te=Ie,P=E):te=te.next=Ie,Bt.lanes|=we,kh|=we;Ie=be.action,of&&m(E,Ie),E=be.hasEagerState?be.eagerState:m(E,Ie)}else we={lane:Ie,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},te===null?(z=te=we,P=E):te=te.next=we,Bt.lanes|=Ie,kh|=Ie;be=be.next}while(be!==null&&be!==f);if(te===null?P=E:te.next=z,!Po(E,u.memoizedState)&&(ls=!0,ke&&(m=op,m!==null)))throw m;u.memoizedState=E,u.baseState=P,u.baseQueue=te,w.lastRenderedState=E}return L===null&&(w.lanes=0),[u.memoizedState,w.dispatch]}function aN(u){var f=Zn(),m=f.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=u;var w=m.dispatch,L=m.pending,E=f.memoizedState;if(L!==null){m.pending=null;var P=L=L.next;do E=u(E,P.action),P=P.next;while(P!==L);Po(E,f.memoizedState)||(ls=!0),f.memoizedState=E,f.baseQueue===null&&(f.baseState=E),m.lastRenderedState=E}return[E,w]}function CF(u,f,m){var w=Bt,L=Zn(),E=ci;if(E){if(m===void 0)throw Error(i(407));m=m()}else m=f();var P=!Po((Hi||L).memoizedState,m);if(P&&(L.memoizedState=m,ls=!0),L=L.queue,uN(xF.bind(null,w,L,u),[u]),L.getSnapshot!==f||P||as!==null&&as.memoizedState.tag&1){if(w.flags|=2048,dp(9,{destroy:void 0},SF.bind(null,w,L,m,f),null),Yi===null)throw Error(i(349));E||(zc&127)!==0||yF(w,f,m)}return m}function yF(u,f,m){u.flags|=16384,u={getSnapshot:f,value:m},f=Bt.updateQueue,f===null?(f=$y(),Bt.updateQueue=f,f.stores=[u]):(m=f.stores,m===null?f.stores=[u]:m.push(u))}function SF(u,f,m,w){f.value=m,f.getSnapshot=w,LF(f)&&kF(u)}function xF(u,f,m){return m(function(){LF(f)&&kF(u)})}function LF(u){var f=u.getSnapshot;u=u.value;try{var m=f();return!Po(u,m)}catch{return!0}}function kF(u){var f=Qd(u,2);f!==null&&ro(f,u,2)}function lN(u){var f=Pr();if(typeof u=="function"){var m=u;if(u=m(),of){On(!0);try{m()}finally{On(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uc,lastRenderedState:u},f}function EF(u,f,m,w){return u.baseState=m,oN(u,Hi,typeof w=="function"?w:Uc)}function ese(u,f,m,w,L){if(Qy(u))throw Error(i(485));if(u=f.action,u!==null){var E={payload:L,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(P){E.listeners.push(P)}};q.T!==null?m(!0):E.isTransition=!1,w(E),m=f.pending,m===null?(E.next=f.pending=E,DF(f,E)):(E.next=m.next,f.pending=m.next=E)}}function DF(u,f){var m=f.action,w=f.payload,L=u.state;if(f.isTransition){var E=q.T,P={};q.T=P;try{var z=m(L,w),te=q.S;te!==null&&te(P,z),TF(u,f,z)}catch(be){cN(u,f,be)}finally{E!==null&&P.types!==null&&(E.types=P.types),q.T=E}}else try{E=m(L,w),TF(u,f,E)}catch(be){cN(u,f,be)}}function TF(u,f,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(w){NF(u,f,w)},function(w){return cN(u,f,w)}):NF(u,f,m)}function NF(u,f,m){f.status="fulfilled",f.value=m,IF(f),u.state=m,f=u.pending,f!==null&&(m=f.next,m===f?u.pending=null:(m=m.next,f.next=m,DF(u,m)))}function cN(u,f,m){var w=u.pending;if(u.pending=null,w!==null){w=w.next;do f.status="rejected",f.reason=m,IF(f),f=f.next;while(f!==w)}u.action=null}function IF(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function RF(u,f){return f}function AF(u,f){if(ci){var m=Yi.formState;if(m!==null){e:{var w=Bt;if(ci){if(fn){t:{for(var L=fn,E=_a;L.nodeType!==8;){if(!E){L=null;break t}if(L=wa(L.nextSibling),L===null){L=null;break t}}E=L.data,L=E==="F!"||E==="F"?L:null}if(L){fn=wa(L.nextSibling),w=L.data==="F!";break e}}_h(w)}w=!1}w&&(f=m[0])}}return m=Pr(),m.memoizedState=m.baseState=f,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:RF,lastRenderedState:f},m.queue=w,m=ZF.bind(null,Bt,w),w.dispatch=m,w=lN(!1),E=mN.bind(null,Bt,!1,w.queue),w=Pr(),L={state:f,dispatch:null,action:u,pending:null},w.queue=L,m=ese.bind(null,Bt,L,E,m),L.dispatch=m,w.memoizedState=u,[f,m,!1]}function MF(u){var f=Zn();return OF(f,Hi,u)}function OF(u,f,m){if(f=oN(u,f,RF)[0],u=Gy(Uc)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var w=Db(f)}catch(P){throw P===ap?Fy:P}else w=f;f=Zn();var L=f.queue,E=L.dispatch;return m!==f.memoizedState&&(Bt.flags|=2048,dp(9,{destroy:void 0},tse.bind(null,L,m),null)),[w,E,u]}function tse(u,f){u.action=f}function PF(u){var f=Zn(),m=Hi;if(m!==null)return OF(f,m,u);Zn(),f=f.memoizedState,m=Zn();var w=m.queue.dispatch;return m.memoizedState=u,[f,w,!1]}function dp(u,f,m,w){return u={tag:u,create:m,deps:w,inst:f,next:null},f=Bt.updateQueue,f===null&&(f=$y(),Bt.updateQueue=f),m=f.lastEffect,m===null?f.lastEffect=u.next=u:(w=m.next,m.next=u,u.next=w,f.lastEffect=u),u}function FF(){return Zn().memoizedState}function Ky(u,f,m,w){var L=Pr();Bt.flags|=u,L.memoizedState=dp(1|f,{destroy:void 0},m,w===void 0?null:w)}function Yy(u,f,m,w){var L=Zn();w=w===void 0?null:w;var E=L.memoizedState.inst;Hi!==null&&w!==null&&eN(w,Hi.memoizedState.deps)?L.memoizedState=dp(f,E,m,w):(Bt.flags|=u,L.memoizedState=dp(1|f,E,m,w))}function BF(u,f){Ky(8390656,8,u,f)}function uN(u,f){Yy(2048,8,u,f)}function ise(u){Bt.flags|=4;var f=Bt.updateQueue;if(f===null)f=$y(),Bt.updateQueue=f,f.events=[u];else{var m=f.events;m===null?f.events=[u]:m.push(u)}}function VF(u){var f=Zn().memoizedState;return ise({ref:f,nextImpl:u}),function(){if((Ti&2)!==0)throw Error(i(440));return f.impl.apply(void 0,arguments)}}function HF(u,f){return Yy(4,2,u,f)}function WF(u,f){return Yy(4,4,u,f)}function zF(u,f){if(typeof f=="function"){u=u();var m=f(u);return function(){typeof m=="function"?m():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function UF(u,f,m){m=m!=null?m.concat([u]):null,Yy(4,4,zF.bind(null,f,u),m)}function hN(){}function jF(u,f){var m=Zn();f=f===void 0?null:f;var w=m.memoizedState;return f!==null&&eN(f,w[1])?w[0]:(m.memoizedState=[u,f],u)}function $F(u,f){var m=Zn();f=f===void 0?null:f;var w=m.memoizedState;if(f!==null&&eN(f,w[1]))return w[0];if(w=u(),of){On(!0);try{u()}finally{On(!1)}}return m.memoizedState=[w,f],w}function dN(u,f,m){return m===void 0||(zc&1073741824)!==0&&(oi&261930)===0?u.memoizedState=f:(u.memoizedState=m,u=qB(),Bt.lanes|=u,kh|=u,m)}function qF(u,f,m,w){return Po(m,f)?m:cp.current!==null?(u=dN(u,m,w),Po(u,f)||(ls=!0),u):(zc&42)===0||(zc&1073741824)!==0&&(oi&261930)===0?(ls=!0,u.memoizedState=m):(u=qB(),Bt.lanes|=u,kh|=u,f)}function GF(u,f,m,w,L){var E=ee.p;ee.p=E!==0&&8>E?E:8;var P=q.T,z={};q.T=z,mN(u,!1,f,m);try{var te=L(),be=q.S;if(be!==null&&be(z,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var ke=Xne(te,w);Tb(u,f,ke,zo(u))}else Tb(u,f,w,zo(u))}catch(Ie){Tb(u,f,{then:function(){},status:"rejected",reason:Ie},zo())}finally{ee.p=E,P!==null&&z.types!==null&&(P.types=z.types),q.T=P}}function nse(){}function fN(u,f,m,w){if(u.tag!==5)throw Error(i(476));var L=KF(u).queue;GF(u,L,f,ue,m===null?nse:function(){return YF(u),m(w)})}function KF(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uc,lastRenderedState:ue},next:null};var m={};return f.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uc,lastRenderedState:m},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function YF(u){var f=KF(u);f.next===null&&(f=u.alternate.memoizedState),Tb(u,f.next.queue,{},zo())}function gN(){return Xs(qb)}function QF(){return Zn().memoizedState}function XF(){return Zn().memoizedState}function sse(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var m=zo();u=vh(m);var w=Ch(f,u,m);w!==null&&(ro(w,f,m),xb(w,f,m)),f={cache:UT()},u.payload=f;return}f=f.return}}function rse(u,f,m){var w=zo();m={lane:w,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Qy(u)?JF(f,m):(m=RT(u,f,m,w),m!==null&&(ro(m,u,w),eB(m,f,w)))}function ZF(u,f,m){var w=zo();Tb(u,f,m,w)}function Tb(u,f,m,w){var L={lane:w,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Qy(u))JF(f,L);else{var E=u.alternate;if(u.lanes===0&&(E===null||E.lanes===0)&&(E=f.lastRenderedReducer,E!==null))try{var P=f.lastRenderedState,z=E(P,m);if(L.hasEagerState=!0,L.eagerState=z,Po(z,P))return Ny(u,f,L,0),Yi===null&&Ty(),!1}catch{}finally{}if(m=RT(u,f,L,w),m!==null)return ro(m,u,w),eB(m,f,w),!0}return!1}function mN(u,f,m,w){if(w={lane:2,revertLane:GN(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},Qy(u)){if(f)throw Error(i(479))}else f=RT(u,m,w,2),f!==null&&ro(f,u,2)}function Qy(u){var f=u.alternate;return u===Bt||f!==null&&f===Bt}function JF(u,f){up=Uy=!0;var m=u.pending;m===null?f.next=f:(f.next=m.next,m.next=f),u.pending=f}function eB(u,f,m){if((m&4194048)!==0){var w=f.lanes;w&=u.pendingLanes,m|=w,f.lanes=m,my(u,m)}}var Nb={readContext:Xs,use:qy,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useLayoutEffect:Fn,useInsertionEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useSyncExternalStore:Fn,useId:Fn,useHostTransitionStatus:Fn,useFormState:Fn,useActionState:Fn,useOptimistic:Fn,useMemoCache:Fn,useCacheRefresh:Fn};Nb.useEffectEvent=Fn;var tB={readContext:Xs,use:qy,useCallback:function(u,f){return Pr().memoizedState=[u,f===void 0?null:f],u},useContext:Xs,useEffect:BF,useImperativeHandle:function(u,f,m){m=m!=null?m.concat([u]):null,Ky(4194308,4,zF.bind(null,f,u),m)},useLayoutEffect:function(u,f){return Ky(4194308,4,u,f)},useInsertionEffect:function(u,f){Ky(4,2,u,f)},useMemo:function(u,f){var m=Pr();f=f===void 0?null:f;var w=u();if(of){On(!0);try{u()}finally{On(!1)}}return m.memoizedState=[w,f],w},useReducer:function(u,f,m){var w=Pr();if(m!==void 0){var L=m(f);if(of){On(!0);try{m(f)}finally{On(!1)}}}else L=f;return w.memoizedState=w.baseState=L,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:L},w.queue=u,u=u.dispatch=rse.bind(null,Bt,u),[w.memoizedState,u]},useRef:function(u){var f=Pr();return u={current:u},f.memoizedState=u},useState:function(u){u=lN(u);var f=u.queue,m=ZF.bind(null,Bt,f);return f.dispatch=m,[u.memoizedState,m]},useDebugValue:hN,useDeferredValue:function(u,f){var m=Pr();return dN(m,u,f)},useTransition:function(){var u=lN(!1);return u=GF.bind(null,Bt,u.queue,!0,!1),Pr().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,m){var w=Bt,L=Pr();if(ci){if(m===void 0)throw Error(i(407));m=m()}else{if(m=f(),Yi===null)throw Error(i(349));(oi&127)!==0||yF(w,f,m)}L.memoizedState=m;var E={value:m,getSnapshot:f};return L.queue=E,BF(xF.bind(null,w,E,u),[u]),w.flags|=2048,dp(9,{destroy:void 0},SF.bind(null,w,E,m,f),null),m},useId:function(){var u=Pr(),f=Yi.identifierPrefix;if(ci){var m=El,w=kl;m=(w&~(1<<32-bn(w)-1)).toString(32)+m,f="_"+f+"R_"+m,m=jy++,0<m&&(f+="H"+m.toString(32)),f+="_"}else m=Zne++,f="_"+f+"r_"+m.toString(32)+"_";return u.memoizedState=f},useHostTransitionStatus:gN,useFormState:AF,useActionState:AF,useOptimistic:function(u){var f=Pr();f.memoizedState=f.baseState=u;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=m,f=mN.bind(null,Bt,!0,m),m.dispatch=f,[u,f]},useMemoCache:rN,useCacheRefresh:function(){return Pr().memoizedState=sse.bind(null,Bt)},useEffectEvent:function(u){var f=Pr(),m={impl:u};return f.memoizedState=m,function(){if((Ti&2)!==0)throw Error(i(440));return m.impl.apply(void 0,arguments)}}},pN={readContext:Xs,use:qy,useCallback:jF,useContext:Xs,useEffect:uN,useImperativeHandle:UF,useInsertionEffect:HF,useLayoutEffect:WF,useMemo:$F,useReducer:Gy,useRef:FF,useState:function(){return Gy(Uc)},useDebugValue:hN,useDeferredValue:function(u,f){var m=Zn();return qF(m,Hi.memoizedState,u,f)},useTransition:function(){var u=Gy(Uc)[0],f=Zn().memoizedState;return[typeof u=="boolean"?u:Db(u),f]},useSyncExternalStore:CF,useId:QF,useHostTransitionStatus:gN,useFormState:MF,useActionState:MF,useOptimistic:function(u,f){var m=Zn();return EF(m,Hi,u,f)},useMemoCache:rN,useCacheRefresh:XF};pN.useEffectEvent=VF;var iB={readContext:Xs,use:qy,useCallback:jF,useContext:Xs,useEffect:uN,useImperativeHandle:UF,useInsertionEffect:HF,useLayoutEffect:WF,useMemo:$F,useReducer:aN,useRef:FF,useState:function(){return aN(Uc)},useDebugValue:hN,useDeferredValue:function(u,f){var m=Zn();return Hi===null?dN(m,u,f):qF(m,Hi.memoizedState,u,f)},useTransition:function(){var u=aN(Uc)[0],f=Zn().memoizedState;return[typeof u=="boolean"?u:Db(u),f]},useSyncExternalStore:CF,useId:QF,useHostTransitionStatus:gN,useFormState:PF,useActionState:PF,useOptimistic:function(u,f){var m=Zn();return Hi!==null?EF(m,Hi,u,f):(m.baseState=u,[u,m.queue.dispatch])},useMemoCache:rN,useCacheRefresh:XF};iB.useEffectEvent=VF;function _N(u,f,m,w){f=u.memoizedState,m=m(w,f),m=m==null?f:d({},f,m),u.memoizedState=m,u.lanes===0&&(u.updateQueue.baseState=m)}var bN={enqueueSetState:function(u,f,m){u=u._reactInternals;var w=zo(),L=vh(w);L.payload=f,m!=null&&(L.callback=m),f=Ch(u,L,w),f!==null&&(ro(f,u,w),xb(f,u,w))},enqueueReplaceState:function(u,f,m){u=u._reactInternals;var w=zo(),L=vh(w);L.tag=1,L.payload=f,m!=null&&(L.callback=m),f=Ch(u,L,w),f!==null&&(ro(f,u,w),xb(f,u,w))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var m=zo(),w=vh(m);w.tag=2,f!=null&&(w.callback=f),f=Ch(u,w,m),f!==null&&(ro(f,u,m),xb(f,u,m))}};function nB(u,f,m,w,L,E,P){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(w,E,P):f.prototype&&f.prototype.isPureReactComponent?!pb(m,w)||!pb(L,E):!0}function sB(u,f,m,w){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(m,w),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(m,w),f.state!==u&&bN.enqueueReplaceState(f,f.state,null)}function af(u,f){var m=f;if("ref"in f){m={};for(var w in f)w!=="ref"&&(m[w]=f[w])}if(u=u.defaultProps){m===f&&(m=d({},m));for(var L in u)m[L]===void 0&&(m[L]=u[L])}return m}function rB(u){Dy(u)}function oB(u){console.error(u)}function aB(u){Dy(u)}function Xy(u,f){try{var m=u.onUncaughtError;m(f.value,{componentStack:f.stack})}catch(w){setTimeout(function(){throw w})}}function lB(u,f,m){try{var w=u.onCaughtError;w(m.value,{componentStack:m.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(L){setTimeout(function(){throw L})}}function wN(u,f,m){return m=vh(m),m.tag=3,m.payload={element:null},m.callback=function(){Xy(u,f)},m}function cB(u){return u=vh(u),u.tag=3,u}function uB(u,f,m,w){var L=m.type.getDerivedStateFromError;if(typeof L=="function"){var E=w.value;u.payload=function(){return L(E)},u.callback=function(){lB(f,m,w)}}var P=m.stateNode;P!==null&&typeof P.componentDidCatch=="function"&&(u.callback=function(){lB(f,m,w),typeof L!="function"&&(Eh===null?Eh=new Set([this]):Eh.add(this));var z=w.stack;this.componentDidCatch(w.value,{componentStack:z!==null?z:""})})}function ose(u,f,m,w,L){if(m.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(f=m.alternate,f!==null&&sp(f,m,L,!0),m=Bo.current,m!==null){switch(m.tag){case 31:case 13:return ba===null?cS():m.alternate===null&&Bn===0&&(Bn=3),m.flags&=-257,m.flags|=65536,m.lanes=L,w===By?m.flags|=16384:(f=m.updateQueue,f===null?m.updateQueue=new Set([w]):f.add(w),jN(u,w,L)),!1;case 22:return m.flags|=65536,w===By?m.flags|=16384:(f=m.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([w])},m.updateQueue=f):(m=f.retryQueue,m===null?f.retryQueue=new Set([w]):m.add(w)),jN(u,w,L)),!1}throw Error(i(435,m.tag))}return jN(u,w,L),cS(),!1}if(ci)return f=Bo.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=L,w!==BT&&(u=Error(i(422),{cause:w}),wb(ga(u,m)))):(w!==BT&&(f=Error(i(423),{cause:w}),wb(ga(f,m))),u=u.current.alternate,u.flags|=65536,L&=-L,u.lanes|=L,w=ga(w,m),L=wN(u.stateNode,w,L),YT(u,L),Bn!==4&&(Bn=2)),!1;var E=Error(i(520),{cause:w});if(E=ga(E,m),Bb===null?Bb=[E]:Bb.push(E),Bn!==4&&(Bn=2),f===null)return!0;w=ga(w,m),m=f;do{switch(m.tag){case 3:return m.flags|=65536,u=L&-L,m.lanes|=u,u=wN(m.stateNode,w,u),YT(m,u),!1;case 1:if(f=m.type,E=m.stateNode,(m.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Eh===null||!Eh.has(E))))return m.flags|=65536,L&=-L,m.lanes|=L,L=cB(L),uB(L,u,m,w),YT(m,L),!1}m=m.return}while(m!==null);return!1}var vN=Error(i(461)),ls=!1;function Zs(u,f,m,w){f.child=u===null?gF(f,null,m,w):rf(f,u.child,m,w)}function hB(u,f,m,w,L){m=m.render;var E=f.ref;if("ref"in w){var P={};for(var z in w)z!=="ref"&&(P[z]=w[z])}else P=w;return ef(f),w=tN(u,f,m,P,E,L),z=iN(),u!==null&&!ls?(nN(u,f,L),jc(u,f,L)):(ci&&z&&PT(f),f.flags|=1,Zs(u,f,w,L),f.child)}function dB(u,f,m,w,L){if(u===null){var E=m.type;return typeof E=="function"&&!AT(E)&&E.defaultProps===void 0&&m.compare===null?(f.tag=15,f.type=E,fB(u,f,E,w,L)):(u=Ry(m.type,null,w,f,f.mode,L),u.ref=f.ref,u.return=f,f.child=u)}if(E=u.child,!DN(u,L)){var P=E.memoizedProps;if(m=m.compare,m=m!==null?m:pb,m(P,w)&&u.ref===f.ref)return jc(u,f,L)}return f.flags|=1,u=Bc(E,w),u.ref=f.ref,u.return=f,f.child=u}function fB(u,f,m,w,L){if(u!==null){var E=u.memoizedProps;if(pb(E,w)&&u.ref===f.ref)if(ls=!1,f.pendingProps=w=E,DN(u,L))(u.flags&131072)!==0&&(ls=!0);else return f.lanes=u.lanes,jc(u,f,L)}return CN(u,f,m,w,L)}function gB(u,f,m,w){var L=w.children,E=u!==null?u.memoizedState:null;if(u===null&&f.stateNode===null&&(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((f.flags&128)!==0){if(E=E!==null?E.baseLanes|m:m,u!==null){for(w=f.child=u.child,L=0;w!==null;)L=L|w.lanes|w.childLanes,w=w.sibling;w=L&~E}else w=0,f.child=null;return mB(u,f,E,m,w)}if((m&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&Py(f,E!==null?E.cachePool:null),E!==null?_F(f,E):XT(),bF(f);else return w=f.lanes=536870912,mB(u,f,E!==null?E.baseLanes|m:m,m,w)}else E!==null?(Py(f,E.cachePool),_F(f,E),Sh(),f.memoizedState=null):(u!==null&&Py(f,null),XT(),Sh());return Zs(u,f,L,m),f.child}function Ib(u,f){return u!==null&&u.tag===22||f.stateNode!==null||(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.sibling}function mB(u,f,m,w,L){var E=$T();return E=E===null?null:{parent:os._currentValue,pool:E},f.memoizedState={baseLanes:m,cachePool:E},u!==null&&Py(f,null),XT(),bF(f),u!==null&&sp(u,f,w,!0),f.childLanes=L,null}function Zy(u,f){return f=eS({mode:f.mode,children:f.children},u.mode),f.ref=u.ref,u.child=f,f.return=u,f}function pB(u,f,m){return rf(f,u.child,null,m),u=Zy(f,f.pendingProps),u.flags|=2,Vo(f),f.memoizedState=null,u}function ase(u,f,m){var w=f.pendingProps,L=(f.flags&128)!==0;if(f.flags&=-129,u===null){if(ci){if(w.mode==="hidden")return u=Zy(f,w),f.lanes=536870912,Ib(null,u);if(JT(f),(u=fn)?(u=DV(u,_a),u=u!==null&&u.data==="&"?u:null,u!==null&&(f.memoizedState={dehydrated:u,treeContext:mh!==null?{id:kl,overflow:El}:null,retryLane:536870912,hydrationErrors:null},m=J9(u),m.return=f,f.child=m,Qs=f,fn=null)):u=null,u===null)throw _h(f);return f.lanes=536870912,null}return Zy(f,w)}var E=u.memoizedState;if(E!==null){var P=E.dehydrated;if(JT(f),L)if(f.flags&256)f.flags&=-257,f=pB(u,f,m);else if(f.memoizedState!==null)f.child=u.child,f.flags|=128,f=null;else throw Error(i(558));else if(ls||sp(u,f,m,!1),L=(m&u.childLanes)!==0,ls||L){if(w=Yi,w!==null&&(P=Oo(w,m),P!==0&&P!==E.retryLane))throw E.retryLane=P,Qd(u,P),ro(w,u,P),vN;cS(),f=pB(u,f,m)}else u=E.treeContext,fn=wa(P.nextSibling),Qs=f,ci=!0,ph=null,_a=!1,u!==null&&iF(f,u),f=Zy(f,w),f.flags|=4096;return f}return u=Bc(u.child,{mode:w.mode,children:w.children}),u.ref=f.ref,f.child=u,u.return=f,u}function Jy(u,f){var m=f.ref;if(m===null)u!==null&&u.ref!==null&&(f.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(i(284));(u===null||u.ref!==m)&&(f.flags|=4194816)}}function CN(u,f,m,w,L){return ef(f),m=tN(u,f,m,w,void 0,L),w=iN(),u!==null&&!ls?(nN(u,f,L),jc(u,f,L)):(ci&&w&&PT(f),f.flags|=1,Zs(u,f,m,L),f.child)}function _B(u,f,m,w,L,E){return ef(f),f.updateQueue=null,m=vF(f,w,m,L),wF(u),w=iN(),u!==null&&!ls?(nN(u,f,E),jc(u,f,E)):(ci&&w&&PT(f),f.flags|=1,Zs(u,f,m,E),f.child)}function bB(u,f,m,w,L){if(ef(f),f.stateNode===null){var E=ep,P=m.contextType;typeof P=="object"&&P!==null&&(E=Xs(P)),E=new m(w,E),f.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=bN,f.stateNode=E,E._reactInternals=f,E=f.stateNode,E.props=w,E.state=f.memoizedState,E.refs={},GT(f),P=m.contextType,E.context=typeof P=="object"&&P!==null?Xs(P):ep,E.state=f.memoizedState,P=m.getDerivedStateFromProps,typeof P=="function"&&(_N(f,m,P,w),E.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(P=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),P!==E.state&&bN.enqueueReplaceState(E,E.state,null),kb(f,w,E,L),Lb(),E.state=f.memoizedState),typeof E.componentDidMount=="function"&&(f.flags|=4194308),w=!0}else if(u===null){E=f.stateNode;var z=f.memoizedProps,te=af(m,z);E.props=te;var be=E.context,ke=m.contextType;P=ep,typeof ke=="object"&&ke!==null&&(P=Xs(ke));var Ie=m.getDerivedStateFromProps;ke=typeof Ie=="function"||typeof E.getSnapshotBeforeUpdate=="function",z=f.pendingProps!==z,ke||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(z||be!==P)&&sB(f,E,w,P),wh=!1;var we=f.memoizedState;E.state=we,kb(f,w,E,L),Lb(),be=f.memoizedState,z||we!==be||wh?(typeof Ie=="function"&&(_N(f,m,Ie,w),be=f.memoizedState),(te=wh||nB(f,m,te,w,we,be,P))?(ke||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(f.flags|=4194308)):(typeof E.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=w,f.memoizedState=be),E.props=w,E.state=be,E.context=P,w=te):(typeof E.componentDidMount=="function"&&(f.flags|=4194308),w=!1)}else{E=f.stateNode,KT(u,f),P=f.memoizedProps,ke=af(m,P),E.props=ke,Ie=f.pendingProps,we=E.context,be=m.contextType,te=ep,typeof be=="object"&&be!==null&&(te=Xs(be)),z=m.getDerivedStateFromProps,(be=typeof z=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(P!==Ie||we!==te)&&sB(f,E,w,te),wh=!1,we=f.memoizedState,E.state=we,kb(f,w,E,L),Lb();var ve=f.memoizedState;P!==Ie||we!==ve||wh||u!==null&&u.dependencies!==null&&My(u.dependencies)?(typeof z=="function"&&(_N(f,m,z,w),ve=f.memoizedState),(ke=wh||nB(f,m,ke,w,we,ve,te)||u!==null&&u.dependencies!==null&&My(u.dependencies))?(be||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(w,ve,te),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(w,ve,te)),typeof E.componentDidUpdate=="function"&&(f.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof E.componentDidUpdate!="function"||P===u.memoizedProps&&we===u.memoizedState||(f.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||P===u.memoizedProps&&we===u.memoizedState||(f.flags|=1024),f.memoizedProps=w,f.memoizedState=ve),E.props=w,E.state=ve,E.context=te,w=ke):(typeof E.componentDidUpdate!="function"||P===u.memoizedProps&&we===u.memoizedState||(f.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||P===u.memoizedProps&&we===u.memoizedState||(f.flags|=1024),w=!1)}return E=w,Jy(u,f),w=(f.flags&128)!==0,E||w?(E=f.stateNode,m=w&&typeof m.getDerivedStateFromError!="function"?null:E.render(),f.flags|=1,u!==null&&w?(f.child=rf(f,u.child,null,L),f.child=rf(f,null,m,L)):Zs(u,f,m,L),f.memoizedState=E.state,u=f.child):u=jc(u,f,L),u}function wB(u,f,m,w){return Zd(),f.flags|=256,Zs(u,f,m,w),f.child}var yN={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function SN(u){return{baseLanes:u,cachePool:lF()}}function xN(u,f,m){return u=u!==null?u.childLanes&~m:0,f&&(u|=Wo),u}function vB(u,f,m){var w=f.pendingProps,L=!1,E=(f.flags&128)!==0,P;if((P=E)||(P=u!==null&&u.memoizedState===null?!1:(Xn.current&2)!==0),P&&(L=!0,f.flags&=-129),P=(f.flags&32)!==0,f.flags&=-33,u===null){if(ci){if(L?yh(f):Sh(),(u=fn)?(u=DV(u,_a),u=u!==null&&u.data!=="&"?u:null,u!==null&&(f.memoizedState={dehydrated:u,treeContext:mh!==null?{id:kl,overflow:El}:null,retryLane:536870912,hydrationErrors:null},m=J9(u),m.return=f,f.child=m,Qs=f,fn=null)):u=null,u===null)throw _h(f);return oI(u)?f.lanes=32:f.lanes=536870912,null}var z=w.children;return w=w.fallback,L?(Sh(),L=f.mode,z=eS({mode:"hidden",children:z},L),w=Xd(w,L,m,null),z.return=f,w.return=f,z.sibling=w,f.child=z,w=f.child,w.memoizedState=SN(m),w.childLanes=xN(u,P,m),f.memoizedState=yN,Ib(null,w)):(yh(f),LN(f,z))}var te=u.memoizedState;if(te!==null&&(z=te.dehydrated,z!==null)){if(E)f.flags&256?(yh(f),f.flags&=-257,f=kN(u,f,m)):f.memoizedState!==null?(Sh(),f.child=u.child,f.flags|=128,f=null):(Sh(),z=w.fallback,L=f.mode,w=eS({mode:"visible",children:w.children},L),z=Xd(z,L,m,null),z.flags|=2,w.return=f,z.return=f,w.sibling=z,f.child=w,rf(f,u.child,null,m),w=f.child,w.memoizedState=SN(m),w.childLanes=xN(u,P,m),f.memoizedState=yN,f=Ib(null,w));else if(yh(f),oI(z)){if(P=z.nextSibling&&z.nextSibling.dataset,P)var be=P.dgst;P=be,w=Error(i(419)),w.stack="",w.digest=P,wb({value:w,source:null,stack:null}),f=kN(u,f,m)}else if(ls||sp(u,f,m,!1),P=(m&u.childLanes)!==0,ls||P){if(P=Yi,P!==null&&(w=Oo(P,m),w!==0&&w!==te.retryLane))throw te.retryLane=w,Qd(u,w),ro(P,u,w),vN;rI(z)||cS(),f=kN(u,f,m)}else rI(z)?(f.flags|=192,f.child=u.child,f=null):(u=te.treeContext,fn=wa(z.nextSibling),Qs=f,ci=!0,ph=null,_a=!1,u!==null&&iF(f,u),f=LN(f,w.children),f.flags|=4096);return f}return L?(Sh(),z=w.fallback,L=f.mode,te=u.child,be=te.sibling,w=Bc(te,{mode:"hidden",children:w.children}),w.subtreeFlags=te.subtreeFlags&65011712,be!==null?z=Bc(be,z):(z=Xd(z,L,m,null),z.flags|=2),z.return=f,w.return=f,w.sibling=z,f.child=w,Ib(null,w),w=f.child,z=u.child.memoizedState,z===null?z=SN(m):(L=z.cachePool,L!==null?(te=os._currentValue,L=L.parent!==te?{parent:te,pool:te}:L):L=lF(),z={baseLanes:z.baseLanes|m,cachePool:L}),w.memoizedState=z,w.childLanes=xN(u,P,m),f.memoizedState=yN,Ib(u.child,w)):(yh(f),m=u.child,u=m.sibling,m=Bc(m,{mode:"visible",children:w.children}),m.return=f,m.sibling=null,u!==null&&(P=f.deletions,P===null?(f.deletions=[u],f.flags|=16):P.push(u)),f.child=m,f.memoizedState=null,m)}function LN(u,f){return f=eS({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function eS(u,f){return u=Fo(22,u,null,f),u.lanes=0,u}function kN(u,f,m){return rf(f,u.child,null,m),u=LN(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function CB(u,f,m){u.lanes|=f;var w=u.alternate;w!==null&&(w.lanes|=f),WT(u.return,f,m)}function EN(u,f,m,w,L,E){var P=u.memoizedState;P===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:w,tail:m,tailMode:L,treeForkCount:E}:(P.isBackwards=f,P.rendering=null,P.renderingStartTime=0,P.last=w,P.tail=m,P.tailMode=L,P.treeForkCount=E)}function yB(u,f,m){var w=f.pendingProps,L=w.revealOrder,E=w.tail;w=w.children;var P=Xn.current,z=(P&2)!==0;if(z?(P=P&1|2,f.flags|=128):P&=1,de(Xn,P),Zs(u,f,w,m),w=ci?bb:0,!z&&u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&CB(u,m,f);else if(u.tag===19)CB(u,m,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}switch(L){case"forwards":for(m=f.child,L=null;m!==null;)u=m.alternate,u!==null&&zy(u)===null&&(L=m),m=m.sibling;m=L,m===null?(L=f.child,f.child=null):(L=m.sibling,m.sibling=null),EN(f,!1,L,m,E,w);break;case"backwards":case"unstable_legacy-backwards":for(m=null,L=f.child,f.child=null;L!==null;){if(u=L.alternate,u!==null&&zy(u)===null){f.child=L;break}u=L.sibling,L.sibling=m,m=L,L=u}EN(f,!0,m,null,E,w);break;case"together":EN(f,!1,null,null,void 0,w);break;default:f.memoizedState=null}return f.child}function jc(u,f,m){if(u!==null&&(f.dependencies=u.dependencies),kh|=f.lanes,(m&f.childLanes)===0)if(u!==null){if(sp(u,f,m,!1),(m&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(i(153));if(f.child!==null){for(u=f.child,m=Bc(u,u.pendingProps),f.child=m,m.return=f;u.sibling!==null;)u=u.sibling,m=m.sibling=Bc(u,u.pendingProps),m.return=f;m.sibling=null}return f.child}function DN(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&My(u)))}function lse(u,f,m){switch(f.tag){case 3:bi(f,f.stateNode.containerInfo),bh(f,os,u.memoizedState.cache),Zd();break;case 27:case 5:An(f);break;case 4:bi(f,f.stateNode.containerInfo);break;case 10:bh(f,f.type,f.memoizedProps.value);break;case 31:if(f.memoizedState!==null)return f.flags|=128,JT(f),null;break;case 13:var w=f.memoizedState;if(w!==null)return w.dehydrated!==null?(yh(f),f.flags|=128,null):(m&f.child.childLanes)!==0?vB(u,f,m):(yh(f),u=jc(u,f,m),u!==null?u.sibling:null);yh(f);break;case 19:var L=(u.flags&128)!==0;if(w=(m&f.childLanes)!==0,w||(sp(u,f,m,!1),w=(m&f.childLanes)!==0),L){if(w)return yB(u,f,m);f.flags|=128}if(L=f.memoizedState,L!==null&&(L.rendering=null,L.tail=null,L.lastEffect=null),de(Xn,Xn.current),w)break;return null;case 22:return f.lanes=0,gB(u,f,m,f.pendingProps);case 24:bh(f,os,u.memoizedState.cache)}return jc(u,f,m)}function SB(u,f,m){if(u!==null)if(u.memoizedProps!==f.pendingProps)ls=!0;else{if(!DN(u,m)&&(f.flags&128)===0)return ls=!1,lse(u,f,m);ls=(u.flags&131072)!==0}else ls=!1,ci&&(f.flags&1048576)!==0&&tF(f,bb,f.index);switch(f.lanes=0,f.tag){case 16:e:{var w=f.pendingProps;if(u=nf(f.elementType),f.type=u,typeof u=="function")AT(u)?(w=af(u,w),f.tag=1,f=bB(null,f,u,w,m)):(f.tag=0,f=CN(null,f,u,w,m));else{if(u!=null){var L=u.$$typeof;if(L===k){f.tag=11,f=hB(null,f,u,w,m);break e}else if(L===N){f.tag=14,f=dB(null,f,u,w,m);break e}}throw f=X(u)||u,Error(i(306,f,""))}}return f;case 0:return CN(u,f,f.type,f.pendingProps,m);case 1:return w=f.type,L=af(w,f.pendingProps),bB(u,f,w,L,m);case 3:e:{if(bi(f,f.stateNode.containerInfo),u===null)throw Error(i(387));w=f.pendingProps;var E=f.memoizedState;L=E.element,KT(u,f),kb(f,w,null,m);var P=f.memoizedState;if(w=P.cache,bh(f,os,w),w!==E.cache&&zT(f,[os],m,!0),Lb(),w=P.element,E.isDehydrated)if(E={element:w,isDehydrated:!1,cache:P.cache},f.updateQueue.baseState=E,f.memoizedState=E,f.flags&256){f=wB(u,f,w,m);break e}else if(w!==L){L=ga(Error(i(424)),f),wb(L),f=wB(u,f,w,m);break e}else{switch(u=f.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(fn=wa(u.firstChild),Qs=f,ci=!0,ph=null,_a=!0,m=gF(f,null,w,m),f.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(Zd(),w===L){f=jc(u,f,m);break e}Zs(u,f,w,m)}f=f.child}return f;case 26:return Jy(u,f),u===null?(m=MV(f.type,null,f.pendingProps,null))?f.memoizedState=m:ci||(m=f.type,u=f.pendingProps,w=pS(Xe.current).createElement(m),w[Gi]=f,w[Ys]=u,Js(w,m,u),wi(w),f.stateNode=w):f.memoizedState=MV(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:return An(f),u===null&&ci&&(w=f.stateNode=IV(f.type,f.pendingProps,Xe.current),Qs=f,_a=!0,L=fn,Ih(f.type)?(aI=L,fn=wa(w.firstChild)):fn=L),Zs(u,f,f.pendingProps.children,m),Jy(u,f),u===null&&(f.flags|=4194304),f.child;case 5:return u===null&&ci&&((L=w=fn)&&(w=Bse(w,f.type,f.pendingProps,_a),w!==null?(f.stateNode=w,Qs=f,fn=wa(w.firstChild),_a=!1,L=!0):L=!1),L||_h(f)),An(f),L=f.type,E=f.pendingProps,P=u!==null?u.memoizedProps:null,w=E.children,iI(L,E)?w=null:P!==null&&iI(L,P)&&(f.flags|=32),f.memoizedState!==null&&(L=tN(u,f,Jne,null,null,m),qb._currentValue=L),Jy(u,f),Zs(u,f,w,m),f.child;case 6:return u===null&&ci&&((u=m=fn)&&(m=Vse(m,f.pendingProps,_a),m!==null?(f.stateNode=m,Qs=f,fn=null,u=!0):u=!1),u||_h(f)),null;case 13:return vB(u,f,m);case 4:return bi(f,f.stateNode.containerInfo),w=f.pendingProps,u===null?f.child=rf(f,null,w,m):Zs(u,f,w,m),f.child;case 11:return hB(u,f,f.type,f.pendingProps,m);case 7:return Zs(u,f,f.pendingProps,m),f.child;case 8:return Zs(u,f,f.pendingProps.children,m),f.child;case 12:return Zs(u,f,f.pendingProps.children,m),f.child;case 10:return w=f.pendingProps,bh(f,f.type,w.value),Zs(u,f,w.children,m),f.child;case 9:return L=f.type._context,w=f.pendingProps.children,ef(f),L=Xs(L),w=w(L),f.flags|=1,Zs(u,f,w,m),f.child;case 14:return dB(u,f,f.type,f.pendingProps,m);case 15:return fB(u,f,f.type,f.pendingProps,m);case 19:return yB(u,f,m);case 31:return ase(u,f,m);case 22:return gB(u,f,m,f.pendingProps);case 24:return ef(f),w=Xs(os),u===null?(L=$T(),L===null&&(L=Yi,E=UT(),L.pooledCache=E,E.refCount++,E!==null&&(L.pooledCacheLanes|=m),L=E),f.memoizedState={parent:w,cache:L},GT(f),bh(f,os,L)):((u.lanes&m)!==0&&(KT(u,f),kb(f,null,null,m),Lb()),L=u.memoizedState,E=f.memoizedState,L.parent!==w?(L={parent:w,cache:w},f.memoizedState=L,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=L),bh(f,os,w)):(w=E.cache,bh(f,os,w),w!==L.cache&&zT(f,[os],m,!0))),Zs(u,f,f.pendingProps.children,m),f.child;case 29:throw f.pendingProps}throw Error(i(156,f.tag))}function $c(u){u.flags|=4}function TN(u,f,m,w,L){if((f=(u.mode&32)!==0)&&(f=!1),f){if(u.flags|=16777216,(L&335544128)===L)if(u.stateNode.complete)u.flags|=8192;else if(QB())u.flags|=8192;else throw sf=By,qT}else u.flags&=-16777217}function xB(u,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!VV(f))if(QB())u.flags|=8192;else throw sf=By,qT}function tS(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?fy():536870912,u.lanes|=f,pp|=f)}function Rb(u,f){if(!ci)switch(u.tailMode){case"hidden":f=u.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?u.tail=null:m.sibling=null;break;case"collapsed":m=u.tail;for(var w=null;m!==null;)m.alternate!==null&&(w=m),m=m.sibling;w===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:w.sibling=null}}function gn(u){var f=u.alternate!==null&&u.alternate.child===u.child,m=0,w=0;if(f)for(var L=u.child;L!==null;)m|=L.lanes|L.childLanes,w|=L.subtreeFlags&65011712,w|=L.flags&65011712,L.return=u,L=L.sibling;else for(L=u.child;L!==null;)m|=L.lanes|L.childLanes,w|=L.subtreeFlags,w|=L.flags,L.return=u,L=L.sibling;return u.subtreeFlags|=w,u.childLanes=m,f}function cse(u,f,m){var w=f.pendingProps;switch(FT(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gn(f),null;case 1:return gn(f),null;case 3:return m=f.stateNode,w=null,u!==null&&(w=u.memoizedState.cache),f.memoizedState.cache!==w&&(f.flags|=2048),Wc(os),qt(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(u===null||u.child===null)&&(np(f)?$c(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,VT())),gn(f),null;case 26:var L=f.type,E=f.memoizedState;return u===null?($c(f),E!==null?(gn(f),xB(f,E)):(gn(f),TN(f,L,null,w,m))):E?E!==u.memoizedState?($c(f),gn(f),xB(f,E)):(gn(f),f.flags&=-16777217):(u=u.memoizedProps,u!==w&&$c(f),gn(f),TN(f,L,u,w,m)),null;case 27:if(vr(f),m=Xe.current,L=f.type,u!==null&&f.stateNode!=null)u.memoizedProps!==w&&$c(f);else{if(!w){if(f.stateNode===null)throw Error(i(166));return gn(f),null}u=xe.current,np(f)?nF(f):(u=IV(L,w,m),f.stateNode=u,$c(f))}return gn(f),null;case 5:if(vr(f),L=f.type,u!==null&&f.stateNode!=null)u.memoizedProps!==w&&$c(f);else{if(!w){if(f.stateNode===null)throw Error(i(166));return gn(f),null}if(E=xe.current,np(f))nF(f);else{var P=pS(Xe.current);switch(E){case 1:E=P.createElementNS("http://www.w3.org/2000/svg",L);break;case 2:E=P.createElementNS("http://www.w3.org/1998/Math/MathML",L);break;default:switch(L){case"svg":E=P.createElementNS("http://www.w3.org/2000/svg",L);break;case"math":E=P.createElementNS("http://www.w3.org/1998/Math/MathML",L);break;case"script":E=P.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof w.is=="string"?P.createElement("select",{is:w.is}):P.createElement("select"),w.multiple?E.multiple=!0:w.size&&(E.size=w.size);break;default:E=typeof w.is=="string"?P.createElement(L,{is:w.is}):P.createElement(L)}}E[Gi]=f,E[Ys]=w;e:for(P=f.child;P!==null;){if(P.tag===5||P.tag===6)E.appendChild(P.stateNode);else if(P.tag!==4&&P.tag!==27&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===f)break e;for(;P.sibling===null;){if(P.return===null||P.return===f)break e;P=P.return}P.sibling.return=P.return,P=P.sibling}f.stateNode=E;e:switch(Js(E,L,w),L){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&$c(f)}}return gn(f),TN(f,f.type,u===null?null:u.memoizedProps,f.pendingProps,m),null;case 6:if(u&&f.stateNode!=null)u.memoizedProps!==w&&$c(f);else{if(typeof w!="string"&&f.stateNode===null)throw Error(i(166));if(u=Xe.current,np(f)){if(u=f.stateNode,m=f.memoizedProps,w=null,L=Qs,L!==null)switch(L.tag){case 27:case 5:w=L.memoizedProps}u[Gi]=f,u=!!(u.nodeValue===m||w!==null&&w.suppressHydrationWarning===!0||vV(u.nodeValue,m)),u||_h(f,!0)}else u=pS(u).createTextNode(w),u[Gi]=f,f.stateNode=u}return gn(f),null;case 31:if(m=f.memoizedState,u===null||u.memoizedState!==null){if(w=np(f),m!==null){if(u===null){if(!w)throw Error(i(318));if(u=f.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(i(557));u[Gi]=f}else Zd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;gn(f),u=!1}else m=VT(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=m),u=!0;if(!u)return f.flags&256?(Vo(f),f):(Vo(f),null);if((f.flags&128)!==0)throw Error(i(558))}return gn(f),null;case 13:if(w=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(L=np(f),w!==null&&w.dehydrated!==null){if(u===null){if(!L)throw Error(i(318));if(L=f.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(i(317));L[Gi]=f}else Zd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;gn(f),L=!1}else L=VT(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=L),L=!0;if(!L)return f.flags&256?(Vo(f),f):(Vo(f),null)}return Vo(f),(f.flags&128)!==0?(f.lanes=m,f):(m=w!==null,u=u!==null&&u.memoizedState!==null,m&&(w=f.child,L=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(L=w.alternate.memoizedState.cachePool.pool),E=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(E=w.memoizedState.cachePool.pool),E!==L&&(w.flags|=2048)),m!==u&&m&&(f.child.flags|=8192),tS(f,f.updateQueue),gn(f),null);case 4:return qt(),u===null&&XN(f.stateNode.containerInfo),gn(f),null;case 10:return Wc(f.type),gn(f),null;case 19:if(ce(Xn),w=f.memoizedState,w===null)return gn(f),null;if(L=(f.flags&128)!==0,E=w.rendering,E===null)if(L)Rb(w,!1);else{if(Bn!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(E=zy(u),E!==null){for(f.flags|=128,Rb(w,!1),u=E.updateQueue,f.updateQueue=u,tS(f,u),f.subtreeFlags=0,u=m,m=f.child;m!==null;)Z9(m,u),m=m.sibling;return de(Xn,Xn.current&1|2),ci&&Vc(f,w.treeForkCount),f.child}u=u.sibling}w.tail!==null&&he()>oS&&(f.flags|=128,L=!0,Rb(w,!1),f.lanes=4194304)}else{if(!L)if(u=zy(E),u!==null){if(f.flags|=128,L=!0,u=u.updateQueue,f.updateQueue=u,tS(f,u),Rb(w,!0),w.tail===null&&w.tailMode==="hidden"&&!E.alternate&&!ci)return gn(f),null}else 2*he()-w.renderingStartTime>oS&&m!==536870912&&(f.flags|=128,L=!0,Rb(w,!1),f.lanes=4194304);w.isBackwards?(E.sibling=f.child,f.child=E):(u=w.last,u!==null?u.sibling=E:f.child=E,w.last=E)}return w.tail!==null?(u=w.tail,w.rendering=u,w.tail=u.sibling,w.renderingStartTime=he(),u.sibling=null,m=Xn.current,de(Xn,L?m&1|2:m&1),ci&&Vc(f,w.treeForkCount),u):(gn(f),null);case 22:case 23:return Vo(f),ZT(),w=f.memoizedState!==null,u!==null?u.memoizedState!==null!==w&&(f.flags|=8192):w&&(f.flags|=8192),w?(m&536870912)!==0&&(f.flags&128)===0&&(gn(f),f.subtreeFlags&6&&(f.flags|=8192)):gn(f),m=f.updateQueue,m!==null&&tS(f,m.retryQueue),m=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),w=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(w=f.memoizedState.cachePool.pool),w!==m&&(f.flags|=2048),u!==null&&ce(tf),null;case 24:return m=null,u!==null&&(m=u.memoizedState.cache),f.memoizedState.cache!==m&&(f.flags|=2048),Wc(os),gn(f),null;case 25:return null;case 30:return null}throw Error(i(156,f.tag))}function use(u,f){switch(FT(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return Wc(os),qt(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return vr(f),null;case 31:if(f.memoizedState!==null){if(Vo(f),f.alternate===null)throw Error(i(340));Zd()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 13:if(Vo(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(i(340));Zd()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return ce(Xn),null;case 4:return qt(),null;case 10:return Wc(f.type),null;case 22:case 23:return Vo(f),ZT(),u!==null&&ce(tf),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return Wc(os),null;case 25:return null;default:return null}}function LB(u,f){switch(FT(f),f.tag){case 3:Wc(os),qt();break;case 26:case 27:case 5:vr(f);break;case 4:qt();break;case 31:f.memoizedState!==null&&Vo(f);break;case 13:Vo(f);break;case 19:ce(Xn);break;case 10:Wc(f.type);break;case 22:case 23:Vo(f),ZT(),u!==null&&ce(tf);break;case 24:Wc(os)}}function Ab(u,f){try{var m=f.updateQueue,w=m!==null?m.lastEffect:null;if(w!==null){var L=w.next;m=L;do{if((m.tag&u)===u){w=void 0;var E=m.create,P=m.inst;w=E(),P.destroy=w}m=m.next}while(m!==L)}}catch(z){Pi(f,f.return,z)}}function xh(u,f,m){try{var w=f.updateQueue,L=w!==null?w.lastEffect:null;if(L!==null){var E=L.next;w=E;do{if((w.tag&u)===u){var P=w.inst,z=P.destroy;if(z!==void 0){P.destroy=void 0,L=f;var te=m,be=z;try{be()}catch(ke){Pi(L,te,ke)}}}w=w.next}while(w!==E)}}catch(ke){Pi(f,f.return,ke)}}function kB(u){var f=u.updateQueue;if(f!==null){var m=u.stateNode;try{pF(f,m)}catch(w){Pi(u,u.return,w)}}}function EB(u,f,m){m.props=af(u.type,u.memoizedProps),m.state=u.memoizedState;try{m.componentWillUnmount()}catch(w){Pi(u,f,w)}}function Mb(u,f){try{var m=u.ref;if(m!==null){switch(u.tag){case 26:case 27:case 5:var w=u.stateNode;break;case 30:w=u.stateNode;break;default:w=u.stateNode}typeof m=="function"?u.refCleanup=m(w):m.current=w}}catch(L){Pi(u,f,L)}}function Dl(u,f){var m=u.ref,w=u.refCleanup;if(m!==null)if(typeof w=="function")try{w()}catch(L){Pi(u,f,L)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(L){Pi(u,f,L)}else m.current=null}function DB(u){var f=u.type,m=u.memoizedProps,w=u.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":m.autoFocus&&w.focus();break e;case"img":m.src?w.src=m.src:m.srcSet&&(w.srcset=m.srcSet)}}catch(L){Pi(u,u.return,L)}}function NN(u,f,m){try{var w=u.stateNode;Rse(w,u.type,m,f),w[Ys]=f}catch(L){Pi(u,u.return,L)}}function TB(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Ih(u.type)||u.tag===4}function IN(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||TB(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Ih(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function RN(u,f,m){var w=u.tag;if(w===5||w===6)u=u.stateNode,f?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(u,f):(f=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,f.appendChild(u),m=m._reactRootContainer,m!=null||f.onclick!==null||(f.onclick=Pc));else if(w!==4&&(w===27&&Ih(u.type)&&(m=u.stateNode,f=null),u=u.child,u!==null))for(RN(u,f,m),u=u.sibling;u!==null;)RN(u,f,m),u=u.sibling}function iS(u,f,m){var w=u.tag;if(w===5||w===6)u=u.stateNode,f?m.insertBefore(u,f):m.appendChild(u);else if(w!==4&&(w===27&&Ih(u.type)&&(m=u.stateNode),u=u.child,u!==null))for(iS(u,f,m),u=u.sibling;u!==null;)iS(u,f,m),u=u.sibling}function NB(u){var f=u.stateNode,m=u.memoizedProps;try{for(var w=u.type,L=f.attributes;L.length;)f.removeAttributeNode(L[0]);Js(f,w,m),f[Gi]=u,f[Ys]=m}catch(E){Pi(u,u.return,E)}}var qc=!1,cs=!1,AN=!1,IB=typeof WeakSet=="function"?WeakSet:Set,As=null;function hse(u,f){if(u=u.containerInfo,eI=SS,u=U9(u),kT(u)){if("selectionStart"in u)var m={start:u.selectionStart,end:u.selectionEnd};else e:{m=(m=u.ownerDocument)&&m.defaultView||window;var w=m.getSelection&&m.getSelection();if(w&&w.rangeCount!==0){m=w.anchorNode;var L=w.anchorOffset,E=w.focusNode;w=w.focusOffset;try{m.nodeType,E.nodeType}catch{m=null;break e}var P=0,z=-1,te=-1,be=0,ke=0,Ie=u,we=null;t:for(;;){for(var ve;Ie!==m||L!==0&&Ie.nodeType!==3||(z=P+L),Ie!==E||w!==0&&Ie.nodeType!==3||(te=P+w),Ie.nodeType===3&&(P+=Ie.nodeValue.length),(ve=Ie.firstChild)!==null;)we=Ie,Ie=ve;for(;;){if(Ie===u)break t;if(we===m&&++be===L&&(z=P),we===E&&++ke===w&&(te=P),(ve=Ie.nextSibling)!==null)break;Ie=we,we=Ie.parentNode}Ie=ve}m=z===-1||te===-1?null:{start:z,end:te}}else m=null}m=m||{start:0,end:0}}else m=null;for(tI={focusedElem:u,selectionRange:m},SS=!1,As=f;As!==null;)if(f=As,u=f.child,(f.subtreeFlags&1028)!==0&&u!==null)u.return=f,As=u;else for(;As!==null;){switch(f=As,E=f.alternate,u=f.flags,f.tag){case 0:if((u&4)!==0&&(u=f.updateQueue,u=u!==null?u.events:null,u!==null))for(m=0;m<u.length;m++)L=u[m],L.ref.impl=L.nextImpl;break;case 11:case 15:break;case 1:if((u&1024)!==0&&E!==null){u=void 0,m=f,L=E.memoizedProps,E=E.memoizedState,w=m.stateNode;try{var it=af(m.type,L);u=w.getSnapshotBeforeUpdate(it,E),w.__reactInternalSnapshotBeforeUpdate=u}catch(bt){Pi(m,m.return,bt)}}break;case 3:if((u&1024)!==0){if(u=f.stateNode.containerInfo,m=u.nodeType,m===9)sI(u);else if(m===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":sI(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(i(163))}if(u=f.sibling,u!==null){u.return=f.return,As=u;break}As=f.return}}function RB(u,f,m){var w=m.flags;switch(m.tag){case 0:case 11:case 15:Kc(u,m),w&4&&Ab(5,m);break;case 1:if(Kc(u,m),w&4)if(u=m.stateNode,f===null)try{u.componentDidMount()}catch(P){Pi(m,m.return,P)}else{var L=af(m.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(L,f,u.__reactInternalSnapshotBeforeUpdate)}catch(P){Pi(m,m.return,P)}}w&64&&kB(m),w&512&&Mb(m,m.return);break;case 3:if(Kc(u,m),w&64&&(u=m.updateQueue,u!==null)){if(f=null,m.child!==null)switch(m.child.tag){case 27:case 5:f=m.child.stateNode;break;case 1:f=m.child.stateNode}try{pF(u,f)}catch(P){Pi(m,m.return,P)}}break;case 27:f===null&&w&4&&NB(m);case 26:case 5:Kc(u,m),f===null&&w&4&&DB(m),w&512&&Mb(m,m.return);break;case 12:Kc(u,m);break;case 31:Kc(u,m),w&4&&OB(u,m);break;case 13:Kc(u,m),w&4&&PB(u,m),w&64&&(u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(m=vse.bind(null,m),Hse(u,m))));break;case 22:if(w=m.memoizedState!==null||qc,!w){f=f!==null&&f.memoizedState!==null||cs,L=qc;var E=cs;qc=w,(cs=f)&&!E?Yc(u,m,(m.subtreeFlags&8772)!==0):Kc(u,m),qc=L,cs=E}break;case 30:break;default:Kc(u,m)}}function AB(u){var f=u.alternate;f!==null&&(u.alternate=null,AB(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&Ve(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Cn=null,to=!1;function Gc(u,f,m){for(m=m.child;m!==null;)MB(u,f,m),m=m.sibling}function MB(u,f,m){if(Mi&&typeof Mi.onCommitFiberUnmount=="function")try{Mi.onCommitFiberUnmount(Ks,m)}catch{}switch(m.tag){case 26:cs||Dl(m,f),Gc(u,f,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:cs||Dl(m,f);var w=Cn,L=to;Ih(m.type)&&(Cn=m.stateNode,to=!1),Gc(u,f,m),Ub(m.stateNode),Cn=w,to=L;break;case 5:cs||Dl(m,f);case 6:if(w=Cn,L=to,Cn=null,Gc(u,f,m),Cn=w,to=L,Cn!==null)if(to)try{(Cn.nodeType===9?Cn.body:Cn.nodeName==="HTML"?Cn.ownerDocument.body:Cn).removeChild(m.stateNode)}catch(E){Pi(m,f,E)}else try{Cn.removeChild(m.stateNode)}catch(E){Pi(m,f,E)}break;case 18:Cn!==null&&(to?(u=Cn,kV(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,m.stateNode),xp(u)):kV(Cn,m.stateNode));break;case 4:w=Cn,L=to,Cn=m.stateNode.containerInfo,to=!0,Gc(u,f,m),Cn=w,to=L;break;case 0:case 11:case 14:case 15:xh(2,m,f),cs||xh(4,m,f),Gc(u,f,m);break;case 1:cs||(Dl(m,f),w=m.stateNode,typeof w.componentWillUnmount=="function"&&EB(m,f,w)),Gc(u,f,m);break;case 21:Gc(u,f,m);break;case 22:cs=(w=cs)||m.memoizedState!==null,Gc(u,f,m),cs=w;break;default:Gc(u,f,m)}}function OB(u,f){if(f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null))){u=u.dehydrated;try{xp(u)}catch(m){Pi(f,f.return,m)}}}function PB(u,f){if(f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{xp(u)}catch(m){Pi(f,f.return,m)}}function dse(u){switch(u.tag){case 31:case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new IB),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new IB),f;default:throw Error(i(435,u.tag))}}function nS(u,f){var m=dse(u);f.forEach(function(w){if(!m.has(w)){m.add(w);var L=Cse.bind(null,u,w);w.then(L,L)}})}function io(u,f){var m=f.deletions;if(m!==null)for(var w=0;w<m.length;w++){var L=m[w],E=u,P=f,z=P;e:for(;z!==null;){switch(z.tag){case 27:if(Ih(z.type)){Cn=z.stateNode,to=!1;break e}break;case 5:Cn=z.stateNode,to=!1;break e;case 3:case 4:Cn=z.stateNode.containerInfo,to=!0;break e}z=z.return}if(Cn===null)throw Error(i(160));MB(E,P,L),Cn=null,to=!1,E=L.alternate,E!==null&&(E.return=null),L.return=null}if(f.subtreeFlags&13886)for(f=f.child;f!==null;)FB(f,u),f=f.sibling}var ja=null;function FB(u,f){var m=u.alternate,w=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:io(f,u),no(u),w&4&&(xh(3,u,u.return),Ab(3,u),xh(5,u,u.return));break;case 1:io(f,u),no(u),w&512&&(cs||m===null||Dl(m,m.return)),w&64&&qc&&(u=u.updateQueue,u!==null&&(w=u.callbacks,w!==null&&(m=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=m===null?w:m.concat(w))));break;case 26:var L=ja;if(io(f,u),no(u),w&512&&(cs||m===null||Dl(m,m.return)),w&4){var E=m!==null?m.memoizedState:null;if(w=u.memoizedState,m===null)if(w===null)if(u.stateNode===null){e:{w=u.type,m=u.memoizedProps,L=L.ownerDocument||L;t:switch(w){case"title":E=L.getElementsByTagName("title")[0],(!E||E[re]||E[Gi]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=L.createElement(w),L.head.insertBefore(E,L.querySelector("head > title"))),Js(E,w,m),E[Gi]=u,wi(E),w=E;break e;case"link":var P=FV("link","href",L).get(w+(m.href||""));if(P){for(var z=0;z<P.length;z++)if(E=P[z],E.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&E.getAttribute("rel")===(m.rel==null?null:m.rel)&&E.getAttribute("title")===(m.title==null?null:m.title)&&E.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){P.splice(z,1);break t}}E=L.createElement(w),Js(E,w,m),L.head.appendChild(E);break;case"meta":if(P=FV("meta","content",L).get(w+(m.content||""))){for(z=0;z<P.length;z++)if(E=P[z],E.getAttribute("content")===(m.content==null?null:""+m.content)&&E.getAttribute("name")===(m.name==null?null:m.name)&&E.getAttribute("property")===(m.property==null?null:m.property)&&E.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&E.getAttribute("charset")===(m.charSet==null?null:m.charSet)){P.splice(z,1);break t}}E=L.createElement(w),Js(E,w,m),L.head.appendChild(E);break;default:throw Error(i(468,w))}E[Gi]=u,wi(E),w=E}u.stateNode=w}else BV(L,u.type,u.stateNode);else u.stateNode=PV(L,w,u.memoizedProps);else E!==w?(E===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):E.count--,w===null?BV(L,u.type,u.stateNode):PV(L,w,u.memoizedProps)):w===null&&u.stateNode!==null&&NN(u,u.memoizedProps,m.memoizedProps)}break;case 27:io(f,u),no(u),w&512&&(cs||m===null||Dl(m,m.return)),m!==null&&w&4&&NN(u,u.memoizedProps,m.memoizedProps);break;case 5:if(io(f,u),no(u),w&512&&(cs||m===null||Dl(m,m.return)),u.flags&32){L=u.stateNode;try{Gm(L,"")}catch(it){Pi(u,u.return,it)}}w&4&&u.stateNode!=null&&(L=u.memoizedProps,NN(u,L,m!==null?m.memoizedProps:L)),w&1024&&(AN=!0);break;case 6:if(io(f,u),no(u),w&4){if(u.stateNode===null)throw Error(i(162));w=u.memoizedProps,m=u.stateNode;try{m.nodeValue=w}catch(it){Pi(u,u.return,it)}}break;case 3:if(wS=null,L=ja,ja=_S(f.containerInfo),io(f,u),ja=L,no(u),w&4&&m!==null&&m.memoizedState.isDehydrated)try{xp(f.containerInfo)}catch(it){Pi(u,u.return,it)}AN&&(AN=!1,BB(u));break;case 4:w=ja,ja=_S(u.stateNode.containerInfo),io(f,u),no(u),ja=w;break;case 12:io(f,u),no(u);break;case 31:io(f,u),no(u),w&4&&(w=u.updateQueue,w!==null&&(u.updateQueue=null,nS(u,w)));break;case 13:io(f,u),no(u),u.child.flags&8192&&u.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(rS=he()),w&4&&(w=u.updateQueue,w!==null&&(u.updateQueue=null,nS(u,w)));break;case 22:L=u.memoizedState!==null;var te=m!==null&&m.memoizedState!==null,be=qc,ke=cs;if(qc=be||L,cs=ke||te,io(f,u),cs=ke,qc=be,no(u),w&8192)e:for(f=u.stateNode,f._visibility=L?f._visibility&-2:f._visibility|1,L&&(m===null||te||qc||cs||lf(u)),m=null,f=u;;){if(f.tag===5||f.tag===26){if(m===null){te=m=f;try{if(E=te.stateNode,L)P=E.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none";else{z=te.stateNode;var Ie=te.memoizedProps.style,we=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;z.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(it){Pi(te,te.return,it)}}}else if(f.tag===6){if(m===null){te=f;try{te.stateNode.nodeValue=L?"":te.memoizedProps}catch(it){Pi(te,te.return,it)}}}else if(f.tag===18){if(m===null){te=f;try{var ve=te.stateNode;L?EV(ve,!0):EV(te.stateNode,!1)}catch(it){Pi(te,te.return,it)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}w&4&&(w=u.updateQueue,w!==null&&(m=w.retryQueue,m!==null&&(w.retryQueue=null,nS(u,m))));break;case 19:io(f,u),no(u),w&4&&(w=u.updateQueue,w!==null&&(u.updateQueue=null,nS(u,w)));break;case 30:break;case 21:break;default:io(f,u),no(u)}}function no(u){var f=u.flags;if(f&2){try{for(var m,w=u.return;w!==null;){if(TB(w)){m=w;break}w=w.return}if(m==null)throw Error(i(160));switch(m.tag){case 27:var L=m.stateNode,E=IN(u);iS(u,E,L);break;case 5:var P=m.stateNode;m.flags&32&&(Gm(P,""),m.flags&=-33);var z=IN(u);iS(u,z,P);break;case 3:case 4:var te=m.stateNode.containerInfo,be=IN(u);RN(u,be,te);break;default:throw Error(i(161))}}catch(ke){Pi(u,u.return,ke)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function BB(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;BB(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),u=u.sibling}}function Kc(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)RB(u,f.alternate,f),f=f.sibling}function lf(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:xh(4,f,f.return),lf(f);break;case 1:Dl(f,f.return);var m=f.stateNode;typeof m.componentWillUnmount=="function"&&EB(f,f.return,m),lf(f);break;case 27:Ub(f.stateNode);case 26:case 5:Dl(f,f.return),lf(f);break;case 22:f.memoizedState===null&&lf(f);break;case 30:lf(f);break;default:lf(f)}u=u.sibling}}function Yc(u,f,m){for(m=m&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var w=f.alternate,L=u,E=f,P=E.flags;switch(E.tag){case 0:case 11:case 15:Yc(L,E,m),Ab(4,E);break;case 1:if(Yc(L,E,m),w=E,L=w.stateNode,typeof L.componentDidMount=="function")try{L.componentDidMount()}catch(be){Pi(w,w.return,be)}if(w=E,L=w.updateQueue,L!==null){var z=w.stateNode;try{var te=L.shared.hiddenCallbacks;if(te!==null)for(L.shared.hiddenCallbacks=null,L=0;L<te.length;L++)mF(te[L],z)}catch(be){Pi(w,w.return,be)}}m&&P&64&&kB(E),Mb(E,E.return);break;case 27:NB(E);case 26:case 5:Yc(L,E,m),m&&w===null&&P&4&&DB(E),Mb(E,E.return);break;case 12:Yc(L,E,m);break;case 31:Yc(L,E,m),m&&P&4&&OB(L,E);break;case 13:Yc(L,E,m),m&&P&4&&PB(L,E);break;case 22:E.memoizedState===null&&Yc(L,E,m),Mb(E,E.return);break;case 30:break;default:Yc(L,E,m)}f=f.sibling}}function MN(u,f){var m=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==m&&(u!=null&&u.refCount++,m!=null&&vb(m))}function ON(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&vb(u))}function $a(u,f,m,w){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)VB(u,f,m,w),f=f.sibling}function VB(u,f,m,w){var L=f.flags;switch(f.tag){case 0:case 11:case 15:$a(u,f,m,w),L&2048&&Ab(9,f);break;case 1:$a(u,f,m,w);break;case 3:$a(u,f,m,w),L&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&vb(u)));break;case 12:if(L&2048){$a(u,f,m,w),u=f.stateNode;try{var E=f.memoizedProps,P=E.id,z=E.onPostCommit;typeof z=="function"&&z(P,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(te){Pi(f,f.return,te)}}else $a(u,f,m,w);break;case 31:$a(u,f,m,w);break;case 13:$a(u,f,m,w);break;case 23:break;case 22:E=f.stateNode,P=f.alternate,f.memoizedState!==null?E._visibility&2?$a(u,f,m,w):Ob(u,f):E._visibility&2?$a(u,f,m,w):(E._visibility|=2,fp(u,f,m,w,(f.subtreeFlags&10256)!==0||!1)),L&2048&&MN(P,f);break;case 24:$a(u,f,m,w),L&2048&&ON(f.alternate,f);break;default:$a(u,f,m,w)}}function fp(u,f,m,w,L){for(L=L&&((f.subtreeFlags&10256)!==0||!1),f=f.child;f!==null;){var E=u,P=f,z=m,te=w,be=P.flags;switch(P.tag){case 0:case 11:case 15:fp(E,P,z,te,L),Ab(8,P);break;case 23:break;case 22:var ke=P.stateNode;P.memoizedState!==null?ke._visibility&2?fp(E,P,z,te,L):Ob(E,P):(ke._visibility|=2,fp(E,P,z,te,L)),L&&be&2048&&MN(P.alternate,P);break;case 24:fp(E,P,z,te,L),L&&be&2048&&ON(P.alternate,P);break;default:fp(E,P,z,te,L)}f=f.sibling}}function Ob(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var m=u,w=f,L=w.flags;switch(w.tag){case 22:Ob(m,w),L&2048&&MN(w.alternate,w);break;case 24:Ob(m,w),L&2048&&ON(w.alternate,w);break;default:Ob(m,w)}f=f.sibling}}var Pb=8192;function gp(u,f,m){if(u.subtreeFlags&Pb)for(u=u.child;u!==null;)HB(u,f,m),u=u.sibling}function HB(u,f,m){switch(u.tag){case 26:gp(u,f,m),u.flags&Pb&&u.memoizedState!==null&&Zse(m,ja,u.memoizedState,u.memoizedProps);break;case 5:gp(u,f,m);break;case 3:case 4:var w=ja;ja=_S(u.stateNode.containerInfo),gp(u,f,m),ja=w;break;case 22:u.memoizedState===null&&(w=u.alternate,w!==null&&w.memoizedState!==null?(w=Pb,Pb=16777216,gp(u,f,m),Pb=w):gp(u,f,m));break;default:gp(u,f,m)}}function WB(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function Fb(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var m=0;m<f.length;m++){var w=f[m];As=w,UB(w,u)}WB(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)zB(u),u=u.sibling}function zB(u){switch(u.tag){case 0:case 11:case 15:Fb(u),u.flags&2048&&xh(9,u,u.return);break;case 3:Fb(u);break;case 12:Fb(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&2&&(u.return===null||u.return.tag!==13)?(f._visibility&=-3,sS(u)):Fb(u);break;default:Fb(u)}}function sS(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var m=0;m<f.length;m++){var w=f[m];As=w,UB(w,u)}WB(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:xh(8,f,f.return),sS(f);break;case 22:m=f.stateNode,m._visibility&2&&(m._visibility&=-3,sS(f));break;default:sS(f)}u=u.sibling}}function UB(u,f){for(;As!==null;){var m=As;switch(m.tag){case 0:case 11:case 15:xh(8,m,f);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var w=m.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:vb(m.memoizedState.cache)}if(w=m.child,w!==null)w.return=m,As=w;else e:for(m=u;As!==null;){w=As;var L=w.sibling,E=w.return;if(AB(w),w===m){As=null;break e}if(L!==null){L.return=E,As=L;break e}As=E}}}var fse={getCacheForType:function(u){var f=Xs(os),m=f.data.get(u);return m===void 0&&(m=u(),f.data.set(u,m)),m},cacheSignal:function(){return Xs(os).controller.signal}},gse=typeof WeakMap=="function"?WeakMap:Map,Ti=0,Yi=null,Zt=null,oi=0,Oi=0,Ho=null,Lh=!1,mp=!1,PN=!1,Qc=0,Bn=0,kh=0,cf=0,FN=0,Wo=0,pp=0,Bb=null,so=null,BN=!1,rS=0,jB=0,oS=1/0,aS=null,Eh=null,ys=0,Dh=null,_p=null,Xc=0,VN=0,HN=null,$B=null,Vb=0,WN=null;function zo(){return(Ti&2)!==0&&oi!==0?oi&-oi:q.T!==null?GN():ab()}function qB(){if(Wo===0)if((oi&536870912)===0||ci){var u=Hm;Hm<<=1,(Hm&3932160)===0&&(Hm=262144),Wo=u}else Wo=536870912;return u=Bo.current,u!==null&&(u.flags|=32),Wo}function ro(u,f,m){(u===Yi&&(Oi===2||Oi===9)||u.cancelPendingCommit!==null)&&(bp(u,0),Th(u,oi,Wo,!1)),Rc(u,m),((Ti&2)===0||u!==Yi)&&(u===Yi&&((Ti&2)===0&&(cf|=m),Bn===4&&Th(u,oi,Wo,!1)),Tl(u))}function GB(u,f,m){if((Ti&6)!==0)throw Error(i(327));var w=!m&&(f&127)===0&&(f&u.expiredLanes)===0||wn(u,f),L=w?_se(u,f):UN(u,f,!0),E=w;do{if(L===0){mp&&!w&&Th(u,f,0,!1);break}else{if(m=u.current.alternate,E&&!mse(m)){L=UN(u,f,!1),E=!1;continue}if(L===2){if(E=f,u.errorRecoveryDisabledLanes&E)var P=0;else P=u.pendingLanes&-536870913,P=P!==0?P:P&536870912?536870912:0;if(P!==0){f=P;e:{var z=u;L=Bb;var te=z.current.memoizedState.isDehydrated;if(te&&(bp(z,P).flags|=256),P=UN(z,P,!1),P!==2){if(PN&&!te){z.errorRecoveryDisabledLanes|=E,cf|=E,L=4;break e}E=so,so=L,E!==null&&(so===null?so=E:so.push.apply(so,E))}L=P}if(E=!1,L!==2)continue}}if(L===1){bp(u,0),Th(u,f,0,!0);break}e:{switch(w=u,E=L,E){case 0:case 1:throw Error(i(345));case 4:if((f&4194048)!==f)break;case 6:Th(w,f,Wo,!Lh);break e;case 2:so=null;break;case 3:case 5:break;default:throw Error(i(329))}if((f&62914560)===f&&(L=rS+300-he(),10<L)){if(Th(w,f,Wo,!Lh),Wm(w,0,!0)!==0)break e;Xc=f,w.timeoutHandle=xV(KB.bind(null,w,m,so,aS,BN,f,Wo,cf,pp,Lh,E,"Throttled",-0,0),L);break e}KB(w,m,so,aS,BN,f,Wo,cf,pp,Lh,E,null,-0,0)}}break}while(!0);Tl(u)}function KB(u,f,m,w,L,E,P,z,te,be,ke,Ie,we,ve){if(u.timeoutHandle=-1,Ie=f.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pc},HB(f,E,Ie);var it=(E&62914560)===E?rS-he():(E&4194048)===E?jB-he():0;if(it=Jse(Ie,it),it!==null){Xc=E,u.cancelPendingCommit=it(iV.bind(null,u,f,E,m,w,L,P,z,te,ke,Ie,null,we,ve)),Th(u,E,P,!be);return}}iV(u,f,E,m,w,L,P,z,te)}function mse(u){for(var f=u;;){var m=f.tag;if((m===0||m===11||m===15)&&f.flags&16384&&(m=f.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var w=0;w<m.length;w++){var L=m[w],E=L.getSnapshot;L=L.value;try{if(!Po(E(),L))return!1}catch{return!1}}if(m=f.child,f.subtreeFlags&16384&&m!==null)m.return=f,f=m;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Th(u,f,m,w){f&=~FN,f&=~cf,u.suspendedLanes|=f,u.pingedLanes&=~f,w&&(u.warmLanes|=f),w=u.expirationTimes;for(var L=f;0<L;){var E=31-bn(L),P=1<<E;w[E]=-1,L&=~P}m!==0&&ob(u,m,f)}function lS(){return(Ti&6)===0?(Hb(0),!1):!0}function zN(){if(Zt!==null){if(Oi===0)var u=Zt.return;else u=Zt,Hc=Jd=null,sN(u),lp=null,yb=0,u=Zt;for(;u!==null;)LB(u.alternate,u),u=u.return;Zt=null}}function bp(u,f){var m=u.timeoutHandle;m!==-1&&(u.timeoutHandle=-1,Ose(m)),m=u.cancelPendingCommit,m!==null&&(u.cancelPendingCommit=null,m()),Xc=0,zN(),Yi=u,Zt=m=Bc(u.current,null),oi=f,Oi=0,Ho=null,Lh=!1,mp=wn(u,f),PN=!1,pp=Wo=FN=cf=kh=Bn=0,so=Bb=null,BN=!1,(f&8)!==0&&(f|=f&32);var w=u.entangledLanes;if(w!==0)for(u=u.entanglements,w&=f;0<w;){var L=31-bn(w),E=1<<L;f|=u[L],w&=~E}return Qc=f,Ty(),m}function YB(u,f){Bt=null,q.H=Nb,f===ap||f===Fy?(f=hF(),Oi=3):f===qT?(f=hF(),Oi=4):Oi=f===vN?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Ho=f,Zt===null&&(Bn=1,Xy(u,ga(f,u.current)))}function QB(){var u=Bo.current;return u===null?!0:(oi&4194048)===oi?ba===null:(oi&62914560)===oi||(oi&536870912)!==0?u===ba:!1}function XB(){var u=q.H;return q.H=Nb,u===null?Nb:u}function ZB(){var u=q.A;return q.A=fse,u}function cS(){Bn=4,Lh||(oi&4194048)!==oi&&Bo.current!==null||(mp=!0),(kh&134217727)===0&&(cf&134217727)===0||Yi===null||Th(Yi,oi,Wo,!1)}function UN(u,f,m){var w=Ti;Ti|=2;var L=XB(),E=ZB();(Yi!==u||oi!==f)&&(aS=null,bp(u,f)),f=!1;var P=Bn;e:do try{if(Oi!==0&&Zt!==null){var z=Zt,te=Ho;switch(Oi){case 8:zN(),P=6;break e;case 3:case 2:case 9:case 6:Bo.current===null&&(f=!0);var be=Oi;if(Oi=0,Ho=null,wp(u,z,te,be),m&&mp){P=0;break e}break;default:be=Oi,Oi=0,Ho=null,wp(u,z,te,be)}}pse(),P=Bn;break}catch(ke){YB(u,ke)}while(!0);return f&&u.shellSuspendCounter++,Hc=Jd=null,Ti=w,q.H=L,q.A=E,Zt===null&&(Yi=null,oi=0,Ty()),P}function pse(){for(;Zt!==null;)JB(Zt)}function _se(u,f){var m=Ti;Ti|=2;var w=XB(),L=ZB();Yi!==u||oi!==f?(aS=null,oS=he()+500,bp(u,f)):mp=wn(u,f);e:do try{if(Oi!==0&&Zt!==null){f=Zt;var E=Ho;t:switch(Oi){case 1:Oi=0,Ho=null,wp(u,f,E,1);break;case 2:case 9:if(cF(E)){Oi=0,Ho=null,eV(f);break}f=function(){Oi!==2&&Oi!==9||Yi!==u||(Oi=7),Tl(u)},E.then(f,f);break e;case 3:Oi=7;break e;case 4:Oi=5;break e;case 7:cF(E)?(Oi=0,Ho=null,eV(f)):(Oi=0,Ho=null,wp(u,f,E,7));break;case 5:var P=null;switch(Zt.tag){case 26:P=Zt.memoizedState;case 5:case 27:var z=Zt;if(P?VV(P):z.stateNode.complete){Oi=0,Ho=null;var te=z.sibling;if(te!==null)Zt=te;else{var be=z.return;be!==null?(Zt=be,uS(be)):Zt=null}break t}}Oi=0,Ho=null,wp(u,f,E,5);break;case 6:Oi=0,Ho=null,wp(u,f,E,6);break;case 8:zN(),Bn=6;break e;default:throw Error(i(462))}}bse();break}catch(ke){YB(u,ke)}while(!0);return Hc=Jd=null,q.H=w,q.A=L,Ti=m,Zt!==null?0:(Yi=null,oi=0,Ty(),Bn)}function bse(){for(;Zt!==null&&!W();)JB(Zt)}function JB(u){var f=SB(u.alternate,u,Qc);u.memoizedProps=u.pendingProps,f===null?uS(u):Zt=f}function eV(u){var f=u,m=f.alternate;switch(f.tag){case 15:case 0:f=_B(m,f,f.pendingProps,f.type,void 0,oi);break;case 11:f=_B(m,f,f.pendingProps,f.type.render,f.ref,oi);break;case 5:sN(f);default:LB(m,f),f=Zt=Z9(f,Qc),f=SB(m,f,Qc)}u.memoizedProps=u.pendingProps,f===null?uS(u):Zt=f}function wp(u,f,m,w){Hc=Jd=null,sN(f),lp=null,yb=0;var L=f.return;try{if(ose(u,L,f,m,oi)){Bn=1,Xy(u,ga(m,u.current)),Zt=null;return}}catch(E){if(L!==null)throw Zt=L,E;Bn=1,Xy(u,ga(m,u.current)),Zt=null;return}f.flags&32768?(ci||w===1?u=!0:mp||(oi&536870912)!==0?u=!1:(Lh=u=!0,(w===2||w===9||w===3||w===6)&&(w=Bo.current,w!==null&&w.tag===13&&(w.flags|=16384))),tV(f,u)):uS(f)}function uS(u){var f=u;do{if((f.flags&32768)!==0){tV(f,Lh);return}u=f.return;var m=cse(f.alternate,f,Qc);if(m!==null){Zt=m;return}if(f=f.sibling,f!==null){Zt=f;return}Zt=f=u}while(f!==null);Bn===0&&(Bn=5)}function tV(u,f){do{var m=use(u.alternate,u);if(m!==null){m.flags&=32767,Zt=m;return}if(m=u.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!f&&(u=u.sibling,u!==null)){Zt=u;return}Zt=u=m}while(u!==null);Bn=6,Zt=null}function iV(u,f,m,w,L,E,P,z,te){u.cancelPendingCommit=null;do hS();while(ys!==0);if((Ti&6)!==0)throw Error(i(327));if(f!==null){if(f===u.current)throw Error(i(177));if(E=f.lanes|f.childLanes,E|=IT,gy(u,m,E,P,z,te),u===Yi&&(Zt=Yi=null,oi=0),_p=f,Dh=u,Xc=m,VN=E,HN=L,$B=w,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,yse(Si,function(){return aV(),null})):(u.callbackNode=null,u.callbackPriority=0),w=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||w){w=q.T,q.T=null,L=ee.p,ee.p=2,P=Ti,Ti|=4;try{hse(u,f,m)}finally{Ti=P,ee.p=L,q.T=w}}ys=1,nV(),sV(),rV()}}function nV(){if(ys===1){ys=0;var u=Dh,f=_p,m=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||m){m=q.T,q.T=null;var w=ee.p;ee.p=2;var L=Ti;Ti|=4;try{FB(f,u);var E=tI,P=U9(u.containerInfo),z=E.focusedElem,te=E.selectionRange;if(P!==z&&z&&z.ownerDocument&&z9(z.ownerDocument.documentElement,z)){if(te!==null&&kT(z)){var be=te.start,ke=te.end;if(ke===void 0&&(ke=be),"selectionStart"in z)z.selectionStart=be,z.selectionEnd=Math.min(ke,z.value.length);else{var Ie=z.ownerDocument||document,we=Ie&&Ie.defaultView||window;if(we.getSelection){var ve=we.getSelection(),it=z.textContent.length,bt=Math.min(te.start,it),zi=te.end===void 0?bt:Math.min(te.end,it);!ve.extend&&bt>zi&&(P=zi,zi=bt,bt=P);var fe=W9(z,bt),se=W9(z,zi);if(fe&&se&&(ve.rangeCount!==1||ve.anchorNode!==fe.node||ve.anchorOffset!==fe.offset||ve.focusNode!==se.node||ve.focusOffset!==se.offset)){var _e=Ie.createRange();_e.setStart(fe.node,fe.offset),ve.removeAllRanges(),bt>zi?(ve.addRange(_e),ve.extend(se.node,se.offset)):(_e.setEnd(se.node,se.offset),ve.addRange(_e))}}}}for(Ie=[],ve=z;ve=ve.parentNode;)ve.nodeType===1&&Ie.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<Ie.length;z++){var Te=Ie[z];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}SS=!!eI,tI=eI=null}finally{Ti=L,ee.p=w,q.T=m}}u.current=f,ys=2}}function sV(){if(ys===2){ys=0;var u=Dh,f=_p,m=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||m){m=q.T,q.T=null;var w=ee.p;ee.p=2;var L=Ti;Ti|=4;try{RB(u,f.alternate,f)}finally{Ti=L,ee.p=w,q.T=m}}ys=3}}function rV(){if(ys===4||ys===3){ys=0,ne();var u=Dh,f=_p,m=Xc,w=$B;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?ys=5:(ys=0,_p=Dh=null,oV(u,u.pendingLanes));var L=u.pendingLanes;if(L===0&&(Eh=null),Um(m),f=f.stateNode,Mi&&typeof Mi.onCommitFiberRoot=="function")try{Mi.onCommitFiberRoot(Ks,f,void 0,(f.current.flags&128)===128)}catch{}if(w!==null){f=q.T,L=ee.p,ee.p=2,q.T=null;try{for(var E=u.onRecoverableError,P=0;P<w.length;P++){var z=w[P];E(z.value,{componentStack:z.stack})}}finally{q.T=f,ee.p=L}}(Xc&3)!==0&&hS(),Tl(u),L=u.pendingLanes,(m&261930)!==0&&(L&42)!==0?u===WN?Vb++:(Vb=0,WN=u):Vb=0,Hb(0)}}function oV(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,vb(f)))}function hS(){return nV(),sV(),rV(),aV()}function aV(){if(ys!==5)return!1;var u=Dh,f=VN;VN=0;var m=Um(Xc),w=q.T,L=ee.p;try{ee.p=32>m?32:m,q.T=null,m=HN,HN=null;var E=Dh,P=Xc;if(ys=0,_p=Dh=null,Xc=0,(Ti&6)!==0)throw Error(i(331));var z=Ti;if(Ti|=4,zB(E.current),VB(E,E.current,P,m),Ti=z,Hb(0,!1),Mi&&typeof Mi.onPostCommitFiberRoot=="function")try{Mi.onPostCommitFiberRoot(Ks,E)}catch{}return!0}finally{ee.p=L,q.T=w,oV(u,f)}}function lV(u,f,m){f=ga(m,f),f=wN(u.stateNode,f,2),u=Ch(u,f,2),u!==null&&(Rc(u,2),Tl(u))}function Pi(u,f,m){if(u.tag===3)lV(u,u,m);else for(;f!==null;){if(f.tag===3){lV(f,u,m);break}else if(f.tag===1){var w=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Eh===null||!Eh.has(w))){u=ga(m,u),m=cB(2),w=Ch(f,m,2),w!==null&&(uB(m,w,f,u),Rc(w,2),Tl(w));break}}f=f.return}}function jN(u,f,m){var w=u.pingCache;if(w===null){w=u.pingCache=new gse;var L=new Set;w.set(f,L)}else L=w.get(f),L===void 0&&(L=new Set,w.set(f,L));L.has(m)||(PN=!0,L.add(m),u=wse.bind(null,u,f,m),f.then(u,u))}function wse(u,f,m){var w=u.pingCache;w!==null&&w.delete(f),u.pingedLanes|=u.suspendedLanes&m,u.warmLanes&=~m,Yi===u&&(oi&m)===m&&(Bn===4||Bn===3&&(oi&62914560)===oi&&300>he()-rS?(Ti&2)===0&&bp(u,0):FN|=m,pp===oi&&(pp=0)),Tl(u)}function cV(u,f){f===0&&(f=fy()),u=Qd(u,f),u!==null&&(Rc(u,f),Tl(u))}function vse(u){var f=u.memoizedState,m=0;f!==null&&(m=f.retryLane),cV(u,m)}function Cse(u,f){var m=0;switch(u.tag){case 31:case 13:var w=u.stateNode,L=u.memoizedState;L!==null&&(m=L.retryLane);break;case 19:w=u.stateNode;break;case 22:w=u.stateNode._retryCache;break;default:throw Error(i(314))}w!==null&&w.delete(f),cV(u,m)}function yse(u,f){return T(u,f)}var dS=null,vp=null,$N=!1,fS=!1,qN=!1,Nh=0;function Tl(u){u!==vp&&u.next===null&&(vp===null?dS=vp=u:vp=vp.next=u),fS=!0,$N||($N=!0,xse())}function Hb(u,f){if(!qN&&fS){qN=!0;do for(var m=!1,w=dS;w!==null;){if(u!==0){var L=w.pendingLanes;if(L===0)var E=0;else{var P=w.suspendedLanes,z=w.pingedLanes;E=(1<<31-bn(42|u)+1)-1,E&=L&~(P&~z),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(m=!0,fV(w,E))}else E=oi,E=Wm(w,w===Yi?E:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(E&3)===0||wn(w,E)||(m=!0,fV(w,E));w=w.next}while(m);qN=!1}}function Sse(){uV()}function uV(){fS=$N=!1;var u=0;Nh!==0&&Mse()&&(u=Nh);for(var f=he(),m=null,w=dS;w!==null;){var L=w.next,E=hV(w,f);E===0?(w.next=null,m===null?dS=L:m.next=L,L===null&&(vp=m)):(m=w,(u!==0||(E&3)!==0)&&(fS=!0)),w=L}ys!==0&&ys!==5||Hb(u),Nh!==0&&(Nh=0)}function hV(u,f){for(var m=u.suspendedLanes,w=u.pingedLanes,L=u.expirationTimes,E=u.pendingLanes&-62914561;0<E;){var P=31-bn(E),z=1<<P,te=L[P];te===-1?((z&m)===0||(z&w)!==0)&&(L[P]=fh(z,f)):te<=f&&(u.expiredLanes|=z),E&=~z}if(f=Yi,m=oi,m=Wm(u,u===f?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),w=u.callbackNode,m===0||u===f&&(Oi===2||Oi===9)||u.cancelPendingCommit!==null)return w!==null&&w!==null&&F(w),u.callbackNode=null,u.callbackPriority=0;if((m&3)===0||wn(u,m)){if(f=m&-m,f===u.callbackPriority)return f;switch(w!==null&&F(w),Um(m)){case 2:case 8:m=Ft;break;case 32:m=Si;break;case 268435456:m=At;break;default:m=Si}return w=dV.bind(null,u),m=T(m,w),u.callbackPriority=f,u.callbackNode=m,f}return w!==null&&w!==null&&F(w),u.callbackPriority=2,u.callbackNode=null,2}function dV(u,f){if(ys!==0&&ys!==5)return u.callbackNode=null,u.callbackPriority=0,null;var m=u.callbackNode;if(hS()&&u.callbackNode!==m)return null;var w=oi;return w=Wm(u,u===Yi?w:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),w===0?null:(GB(u,w,f),hV(u,he()),u.callbackNode!=null&&u.callbackNode===m?dV.bind(null,u):null)}function fV(u,f){if(hS())return null;GB(u,f,!0)}function xse(){Pse(function(){(Ti&6)!==0?T(Ze,Sse):uV()})}function GN(){if(Nh===0){var u=rp;u===0&&(u=Nc,Nc<<=1,(Nc&261888)===0&&(Nc=256)),Nh=u}return Nh}function gV(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:Cy(""+u)}function mV(u,f){var m=f.ownerDocument.createElement("input");return m.name=f.name,m.value=f.value,u.id&&m.setAttribute("form",u.id),f.parentNode.insertBefore(m,f),u=new FormData(u),m.parentNode.removeChild(m),u}function Lse(u,f,m,w,L){if(f==="submit"&&m&&m.stateNode===L){var E=gV((L[Ys]||null).action),P=w.submitter;P&&(f=(f=P[Ys]||null)?gV(f.formAction):P.getAttribute("formAction"),f!==null&&(E=f,P=null));var z=new Ly("action","action",null,w,L);u.push({event:z,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(Nh!==0){var te=P?mV(L,P):new FormData(L);fN(m,{pending:!0,data:te,method:L.method,action:E},null,te)}}else typeof E=="function"&&(z.preventDefault(),te=P?mV(L,P):new FormData(L),fN(m,{pending:!0,data:te,method:L.method,action:E},E,te))},currentTarget:L}]})}}for(var KN=0;KN<NT.length;KN++){var YN=NT[KN],kse=YN.toLowerCase(),Ese=YN[0].toUpperCase()+YN.slice(1);Ua(kse,"on"+Ese)}Ua(q9,"onAnimationEnd"),Ua(G9,"onAnimationIteration"),Ua(K9,"onAnimationStart"),Ua("dblclick","onDoubleClick"),Ua("focusin","onFocus"),Ua("focusout","onBlur"),Ua(Une,"onTransitionRun"),Ua(jne,"onTransitionStart"),Ua($ne,"onTransitionCancel"),Ua(Y9,"onTransitionEnd"),vn("onMouseEnter",["mouseout","mouseover"]),vn("onMouseLeave",["mouseout","mouseover"]),vn("onPointerEnter",["pointerout","pointerover"]),vn("onPointerLeave",["pointerout","pointerover"]),za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),za("onBeforeInput",["compositionend","keypress","textInput","paste"]),za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dse=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wb));function pV(u,f){f=(f&4)!==0;for(var m=0;m<u.length;m++){var w=u[m],L=w.event;w=w.listeners;e:{var E=void 0;if(f)for(var P=w.length-1;0<=P;P--){var z=w[P],te=z.instance,be=z.currentTarget;if(z=z.listener,te!==E&&L.isPropagationStopped())break e;E=z,L.currentTarget=be;try{E(L)}catch(ke){Dy(ke)}L.currentTarget=null,E=te}else for(P=0;P<w.length;P++){if(z=w[P],te=z.instance,be=z.currentTarget,z=z.listener,te!==E&&L.isPropagationStopped())break e;E=z,L.currentTarget=be;try{E(L)}catch(ke){Dy(ke)}L.currentTarget=null,E=te}}}}function Jt(u,f){var m=f[$m];m===void 0&&(m=f[$m]=new Set);var w=u+"__bubble";m.has(w)||(_V(f,u,2,!1),m.add(w))}function QN(u,f,m){var w=0;f&&(w|=4),_V(m,u,w,f)}var gS="_reactListening"+Math.random().toString(36).slice(2);function XN(u){if(!u[gS]){u[gS]=!0,ua.forEach(function(m){m!=="selectionchange"&&(Dse.has(m)||QN(m,!1,u),QN(m,!0,u))});var f=u.nodeType===9?u:u.ownerDocument;f===null||f[gS]||(f[gS]=!0,QN("selectionchange",!1,f))}}function _V(u,f,m,w){switch(qV(f)){case 2:var L=ire;break;case 8:L=nre;break;default:L=dI}m=L.bind(null,f,m,u),L=void 0,!_T||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(L=!0),w?L!==void 0?u.addEventListener(f,m,{capture:!0,passive:L}):u.addEventListener(f,m,!0):L!==void 0?u.addEventListener(f,m,{passive:L}):u.addEventListener(f,m,!1)}function ZN(u,f,m,w,L){var E=w;if((f&1)===0&&(f&2)===0&&w!==null)e:for(;;){if(w===null)return;var P=w.tag;if(P===3||P===4){var z=w.stateNode.containerInfo;if(z===L)break;if(P===4)for(P=w.return;P!==null;){var te=P.tag;if((te===3||te===4)&&P.stateNode.containerInfo===L)return;P=P.return}for(;z!==null;){if(P=Je(z),P===null)return;if(te=P.tag,te===5||te===6||te===26||te===27){w=E=P;continue e}z=z.parentNode}}w=w.return}y9(function(){var be=E,ke=mT(m),Ie=[];e:{var we=Q9.get(u);if(we!==void 0){var ve=Ly,it=u;switch(u){case"keypress":if(Sy(m)===0)break e;case"keydown":case"keyup":ve=Cne;break;case"focusin":it="focus",ve=CT;break;case"focusout":it="blur",ve=CT;break;case"beforeblur":case"afterblur":ve=CT;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=L9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=cne;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=xne;break;case q9:case G9:case K9:ve=dne;break;case Y9:ve=kne;break;case"scroll":case"scrollend":ve=ane;break;case"wheel":ve=Dne;break;case"copy":case"cut":case"paste":ve=gne;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=E9;break;case"toggle":case"beforetoggle":ve=Nne}var bt=(f&4)!==0,zi=!bt&&(u==="scroll"||u==="scrollend"),fe=bt?we!==null?we+"Capture":null:we;bt=[];for(var se=be,_e;se!==null;){var Te=se;if(_e=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||_e===null||fe===null||(Te=cb(se,fe),Te!=null&&bt.push(zb(se,Te,_e))),zi)break;se=se.return}0<bt.length&&(we=new ve(we,it,null,m,ke),Ie.push({event:we,listeners:bt}))}}if((f&7)===0){e:{if(we=u==="mouseover"||u==="pointerover",ve=u==="mouseout"||u==="pointerout",we&&m!==gT&&(it=m.relatedTarget||m.fromElement)&&(Je(it)||it[Ac]))break e;if((ve||we)&&(we=ke.window===ke?ke:(we=ke.ownerDocument)?we.defaultView||we.parentWindow:window,ve?(it=m.relatedTarget||m.toElement,ve=be,it=it?Je(it):null,it!==null&&(zi=r(it),bt=it.tag,it!==zi||bt!==5&&bt!==27&&bt!==6)&&(it=null)):(ve=null,it=be),ve!==it)){if(bt=L9,Te="onMouseLeave",fe="onMouseEnter",se="mouse",(u==="pointerout"||u==="pointerover")&&(bt=E9,Te="onPointerLeave",fe="onPointerEnter",se="pointer"),zi=ve==null?we:Pn(ve),_e=it==null?we:Pn(it),we=new bt(Te,se+"leave",ve,m,ke),we.target=zi,we.relatedTarget=_e,Te=null,Je(ke)===be&&(bt=new bt(fe,se+"enter",it,m,ke),bt.target=_e,bt.relatedTarget=zi,Te=bt),zi=Te,ve&&it)t:{for(bt=Tse,fe=ve,se=it,_e=0,Te=fe;Te;Te=bt(Te))_e++;Te=0;for(var dt=se;dt;dt=bt(dt))Te++;for(;0<_e-Te;)fe=bt(fe),_e--;for(;0<Te-_e;)se=bt(se),Te--;for(;_e--;){if(fe===se||se!==null&&fe===se.alternate){bt=fe;break t}fe=bt(fe),se=bt(se)}bt=null}else bt=null;ve!==null&&bV(Ie,we,ve,bt,!1),it!==null&&zi!==null&&bV(Ie,zi,it,bt,!0)}}e:{if(we=be?Pn(be):window,ve=we.nodeName&&we.nodeName.toLowerCase(),ve==="select"||ve==="input"&&we.type==="file")var xi=O9;else if(A9(we))if(P9)xi=Hne;else{xi=Bne;var at=Fne}else ve=we.nodeName,!ve||ve.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?be&&fT(be.elementType)&&(xi=O9):xi=Vne;if(xi&&(xi=xi(u,be))){M9(Ie,xi,m,ke);break e}at&&at(u,we,be),u==="focusout"&&be&&we.type==="number"&&be.memoizedProps.value!=null&&dT(we,"number",we.value)}switch(at=be?Pn(be):window,u){case"focusin":(A9(at)||at.contentEditable==="true")&&(Xm=at,ET=be,_b=null);break;case"focusout":_b=ET=Xm=null;break;case"mousedown":DT=!0;break;case"contextmenu":case"mouseup":case"dragend":DT=!1,j9(Ie,m,ke);break;case"selectionchange":if(zne)break;case"keydown":case"keyup":j9(Ie,m,ke)}var Ut;if(ST)e:{switch(u){case"compositionstart":var ai="onCompositionStart";break e;case"compositionend":ai="onCompositionEnd";break e;case"compositionupdate":ai="onCompositionUpdate";break e}ai=void 0}else Qm?I9(u,m)&&(ai="onCompositionEnd"):u==="keydown"&&m.keyCode===229&&(ai="onCompositionStart");ai&&(D9&&m.locale!=="ko"&&(Qm||ai!=="onCompositionStart"?ai==="onCompositionEnd"&&Qm&&(Ut=S9()):(gh=ke,bT="value"in gh?gh.value:gh.textContent,Qm=!0)),at=mS(be,ai),0<at.length&&(ai=new k9(ai,u,null,m,ke),Ie.push({event:ai,listeners:at}),Ut?ai.data=Ut:(Ut=R9(m),Ut!==null&&(ai.data=Ut)))),(Ut=Rne?Ane(u,m):Mne(u,m))&&(ai=mS(be,"onBeforeInput"),0<ai.length&&(at=new k9("onBeforeInput","beforeinput",null,m,ke),Ie.push({event:at,listeners:ai}),at.data=Ut)),Lse(Ie,u,be,m,ke)}pV(Ie,f)})}function zb(u,f,m){return{instance:u,listener:f,currentTarget:m}}function mS(u,f){for(var m=f+"Capture",w=[];u!==null;){var L=u,E=L.stateNode;if(L=L.tag,L!==5&&L!==26&&L!==27||E===null||(L=cb(u,m),L!=null&&w.unshift(zb(u,L,E)),L=cb(u,f),L!=null&&w.push(zb(u,L,E))),u.tag===3)return w;u=u.return}return[]}function Tse(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function bV(u,f,m,w,L){for(var E=f._reactName,P=[];m!==null&&m!==w;){var z=m,te=z.alternate,be=z.stateNode;if(z=z.tag,te!==null&&te===w)break;z!==5&&z!==26&&z!==27||be===null||(te=be,L?(be=cb(m,E),be!=null&&P.unshift(zb(m,be,te))):L||(be=cb(m,E),be!=null&&P.push(zb(m,be,te)))),m=m.return}P.length!==0&&u.push({event:f,listeners:P})}var Nse=/\r\n?/g,Ise=/\u0000|\uFFFD/g;function wV(u){return(typeof u=="string"?u:""+u).replace(Nse,`
`).replace(Ise,"")}function vV(u,f){return f=wV(f),wV(u)===f}function Wi(u,f,m,w,L,E){switch(m){case"children":typeof w=="string"?f==="body"||f==="textarea"&&w===""||Gm(u,w):(typeof w=="number"||typeof w=="bigint")&&f!=="body"&&Gm(u,""+w);break;case"className":wy(u,"class",w);break;case"tabIndex":wy(u,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":wy(u,m,w);break;case"style":v9(u,w,E);break;case"data":if(f!=="object"){wy(u,"data",w);break}case"src":case"href":if(w===""&&(f!=="a"||m!=="href")){u.removeAttribute(m);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){u.removeAttribute(m);break}w=Cy(""+w),u.setAttribute(m,w);break;case"action":case"formAction":if(typeof w=="function"){u.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(m==="formAction"?(f!=="input"&&Wi(u,f,"name",L.name,L,null),Wi(u,f,"formEncType",L.formEncType,L,null),Wi(u,f,"formMethod",L.formMethod,L,null),Wi(u,f,"formTarget",L.formTarget,L,null)):(Wi(u,f,"encType",L.encType,L,null),Wi(u,f,"method",L.method,L,null),Wi(u,f,"target",L.target,L,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){u.removeAttribute(m);break}w=Cy(""+w),u.setAttribute(m,w);break;case"onClick":w!=null&&(u.onclick=Pc);break;case"onScroll":w!=null&&Jt("scroll",u);break;case"onScrollEnd":w!=null&&Jt("scrollend",u);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(i(61));if(m=w.__html,m!=null){if(L.children!=null)throw Error(i(60));u.innerHTML=m}}break;case"multiple":u.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":u.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){u.removeAttribute("xlink:href");break}m=Cy(""+w),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?u.setAttribute(m,""+w):u.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?u.setAttribute(m,""):u.removeAttribute(m);break;case"capture":case"download":w===!0?u.setAttribute(m,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?u.setAttribute(m,w):u.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?u.setAttribute(m,w):u.removeAttribute(m);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?u.removeAttribute(m):u.setAttribute(m,w);break;case"popover":Jt("beforetoggle",u),Jt("toggle",u),by(u,"popover",w);break;case"xlinkActuate":Oc(u,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":Oc(u,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":Oc(u,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":Oc(u,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":Oc(u,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":Oc(u,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":Oc(u,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":Oc(u,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":Oc(u,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":by(u,"is",w);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=rne.get(m)||m,by(u,m,w))}}function JN(u,f,m,w,L,E){switch(m){case"style":v9(u,w,E);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(i(61));if(m=w.__html,m!=null){if(L.children!=null)throw Error(i(60));u.innerHTML=m}}break;case"children":typeof w=="string"?Gm(u,w):(typeof w=="number"||typeof w=="bigint")&&Gm(u,""+w);break;case"onScroll":w!=null&&Jt("scroll",u);break;case"onScrollEnd":w!=null&&Jt("scrollend",u);break;case"onClick":w!=null&&(u.onclick=Pc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mc.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(L=m.endsWith("Capture"),f=m.slice(2,L?m.length-7:void 0),E=u[Ys]||null,E=E!=null?E[m]:null,typeof E=="function"&&u.removeEventListener(f,E,L),typeof w=="function")){typeof E!="function"&&E!==null&&(m in u?u[m]=null:u.hasAttribute(m)&&u.removeAttribute(m)),u.addEventListener(f,w,L);break e}m in u?u[m]=w:w===!0?u.setAttribute(m,""):by(u,m,w)}}}function Js(u,f,m){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Jt("error",u),Jt("load",u);var w=!1,L=!1,E;for(E in m)if(m.hasOwnProperty(E)){var P=m[E];if(P!=null)switch(E){case"src":w=!0;break;case"srcSet":L=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,f));default:Wi(u,f,E,P,m,null)}}L&&Wi(u,f,"srcSet",m.srcSet,m,null),w&&Wi(u,f,"src",m.src,m,null);return;case"input":Jt("invalid",u);var z=E=P=L=null,te=null,be=null;for(w in m)if(m.hasOwnProperty(w)){var ke=m[w];if(ke!=null)switch(w){case"name":L=ke;break;case"type":P=ke;break;case"checked":te=ke;break;case"defaultChecked":be=ke;break;case"value":E=ke;break;case"defaultValue":z=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(i(137,f));break;default:Wi(u,f,w,ke,m,null)}}p9(u,E,z,te,be,P,L,!1);return;case"select":Jt("invalid",u),w=P=E=null;for(L in m)if(m.hasOwnProperty(L)&&(z=m[L],z!=null))switch(L){case"value":E=z;break;case"defaultValue":P=z;break;case"multiple":w=z;default:Wi(u,f,L,z,m,null)}f=E,m=P,u.multiple=!!w,f!=null?qm(u,!!w,f,!1):m!=null&&qm(u,!!w,m,!0);return;case"textarea":Jt("invalid",u),E=L=w=null;for(P in m)if(m.hasOwnProperty(P)&&(z=m[P],z!=null))switch(P){case"value":w=z;break;case"defaultValue":L=z;break;case"children":E=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(i(91));break;default:Wi(u,f,P,z,m,null)}b9(u,w,L,E);return;case"option":for(te in m)if(m.hasOwnProperty(te)&&(w=m[te],w!=null))switch(te){case"selected":u.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:Wi(u,f,te,w,m,null)}return;case"dialog":Jt("beforetoggle",u),Jt("toggle",u),Jt("cancel",u),Jt("close",u);break;case"iframe":case"object":Jt("load",u);break;case"video":case"audio":for(w=0;w<Wb.length;w++)Jt(Wb[w],u);break;case"image":Jt("error",u),Jt("load",u);break;case"details":Jt("toggle",u);break;case"embed":case"source":case"link":Jt("error",u),Jt("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in m)if(m.hasOwnProperty(be)&&(w=m[be],w!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,f));default:Wi(u,f,be,w,m,null)}return;default:if(fT(f)){for(ke in m)m.hasOwnProperty(ke)&&(w=m[ke],w!==void 0&&JN(u,f,ke,w,m,void 0));return}}for(z in m)m.hasOwnProperty(z)&&(w=m[z],w!=null&&Wi(u,f,z,w,m,null))}function Rse(u,f,m,w){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var L=null,E=null,P=null,z=null,te=null,be=null,ke=null;for(ve in m){var Ie=m[ve];if(m.hasOwnProperty(ve)&&Ie!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":te=Ie;default:w.hasOwnProperty(ve)||Wi(u,f,ve,null,w,Ie)}}for(var we in w){var ve=w[we];if(Ie=m[we],w.hasOwnProperty(we)&&(ve!=null||Ie!=null))switch(we){case"type":E=ve;break;case"name":L=ve;break;case"checked":be=ve;break;case"defaultChecked":ke=ve;break;case"value":P=ve;break;case"defaultValue":z=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(i(137,f));break;default:ve!==Ie&&Wi(u,f,we,ve,w,Ie)}}hT(u,P,z,te,be,ke,E,L);return;case"select":ve=P=z=we=null;for(E in m)if(te=m[E],m.hasOwnProperty(E)&&te!=null)switch(E){case"value":break;case"multiple":ve=te;default:w.hasOwnProperty(E)||Wi(u,f,E,null,w,te)}for(L in w)if(E=w[L],te=m[L],w.hasOwnProperty(L)&&(E!=null||te!=null))switch(L){case"value":we=E;break;case"defaultValue":z=E;break;case"multiple":P=E;default:E!==te&&Wi(u,f,L,E,w,te)}f=z,m=P,w=ve,we!=null?qm(u,!!m,we,!1):!!w!=!!m&&(f!=null?qm(u,!!m,f,!0):qm(u,!!m,m?[]:"",!1));return;case"textarea":ve=we=null;for(z in m)if(L=m[z],m.hasOwnProperty(z)&&L!=null&&!w.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Wi(u,f,z,null,w,L)}for(P in w)if(L=w[P],E=m[P],w.hasOwnProperty(P)&&(L!=null||E!=null))switch(P){case"value":we=L;break;case"defaultValue":ve=L;break;case"children":break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(i(91));break;default:L!==E&&Wi(u,f,P,L,w,E)}_9(u,we,ve);return;case"option":for(var it in m)if(we=m[it],m.hasOwnProperty(it)&&we!=null&&!w.hasOwnProperty(it))switch(it){case"selected":u.selected=!1;break;default:Wi(u,f,it,null,w,we)}for(te in w)if(we=w[te],ve=m[te],w.hasOwnProperty(te)&&we!==ve&&(we!=null||ve!=null))switch(te){case"selected":u.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:Wi(u,f,te,we,w,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in m)we=m[bt],m.hasOwnProperty(bt)&&we!=null&&!w.hasOwnProperty(bt)&&Wi(u,f,bt,null,w,we);for(be in w)if(we=w[be],ve=m[be],w.hasOwnProperty(be)&&we!==ve&&(we!=null||ve!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,f));break;default:Wi(u,f,be,we,w,ve)}return;default:if(fT(f)){for(var zi in m)we=m[zi],m.hasOwnProperty(zi)&&we!==void 0&&!w.hasOwnProperty(zi)&&JN(u,f,zi,void 0,w,we);for(ke in w)we=w[ke],ve=m[ke],!w.hasOwnProperty(ke)||we===ve||we===void 0&&ve===void 0||JN(u,f,ke,we,w,ve);return}}for(var fe in m)we=m[fe],m.hasOwnProperty(fe)&&we!=null&&!w.hasOwnProperty(fe)&&Wi(u,f,fe,null,w,we);for(Ie in w)we=w[Ie],ve=m[Ie],!w.hasOwnProperty(Ie)||we===ve||we==null&&ve==null||Wi(u,f,Ie,we,w,ve)}function CV(u){switch(u){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ase(){if(typeof performance.getEntriesByType=="function"){for(var u=0,f=0,m=performance.getEntriesByType("resource"),w=0;w<m.length;w++){var L=m[w],E=L.transferSize,P=L.initiatorType,z=L.duration;if(E&&z&&CV(P)){for(P=0,z=L.responseEnd,w+=1;w<m.length;w++){var te=m[w],be=te.startTime;if(be>z)break;var ke=te.transferSize,Ie=te.initiatorType;ke&&CV(Ie)&&(te=te.responseEnd,P+=ke*(te<z?1:(z-be)/(te-be)))}if(--w,f+=8*(E+P)/(L.duration/1e3),u++,10<u)break}}if(0<u)return f/u/1e6}return navigator.connection&&(u=navigator.connection.downlink,typeof u=="number")?u:5}var eI=null,tI=null;function pS(u){return u.nodeType===9?u:u.ownerDocument}function yV(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function SV(u,f){if(u===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&f==="foreignObject"?0:u}function iI(u,f){return u==="textarea"||u==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var nI=null;function Mse(){var u=window.event;return u&&u.type==="popstate"?u===nI?!1:(nI=u,!0):(nI=null,!1)}var xV=typeof setTimeout=="function"?setTimeout:void 0,Ose=typeof clearTimeout=="function"?clearTimeout:void 0,LV=typeof Promise=="function"?Promise:void 0,Pse=typeof queueMicrotask=="function"?queueMicrotask:typeof LV<"u"?function(u){return LV.resolve(null).then(u).catch(Fse)}:xV;function Fse(u){setTimeout(function(){throw u})}function Ih(u){return u==="head"}function kV(u,f){var m=f,w=0;do{var L=m.nextSibling;if(u.removeChild(m),L&&L.nodeType===8)if(m=L.data,m==="/$"||m==="/&"){if(w===0){u.removeChild(L),xp(f);return}w--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")w++;else if(m==="html")Ub(u.ownerDocument.documentElement);else if(m==="head"){m=u.ownerDocument.head,Ub(m);for(var E=m.firstChild;E;){var P=E.nextSibling,z=E.nodeName;E[re]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&E.rel.toLowerCase()==="stylesheet"||m.removeChild(E),E=P}}else m==="body"&&Ub(u.ownerDocument.body);m=L}while(m);xp(f)}function EV(u,f){var m=u;u=0;do{var w=m.nextSibling;if(m.nodeType===1?f?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(f?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),w&&w.nodeType===8)if(m=w.data,m==="/$"){if(u===0)break;u--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||u++;m=w}while(m)}function sI(u){var f=u.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var m=f;switch(f=f.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":sI(m),Ve(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}u.removeChild(m)}}function Bse(u,f,m,w){for(;u.nodeType===1;){var L=m;if(u.nodeName.toLowerCase()!==f.toLowerCase()){if(!w&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(w){if(!u[re])switch(f){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(E=u.getAttribute("rel"),E==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(E!==L.rel||u.getAttribute("href")!==(L.href==null||L.href===""?null:L.href)||u.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin)||u.getAttribute("title")!==(L.title==null?null:L.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(E=u.getAttribute("src"),(E!==(L.src==null?null:L.src)||u.getAttribute("type")!==(L.type==null?null:L.type)||u.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin))&&E&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(f==="input"&&u.type==="hidden"){var E=L.name==null?null:""+L.name;if(L.type==="hidden"&&u.getAttribute("name")===E)return u}else return u;if(u=wa(u.nextSibling),u===null)break}return null}function Vse(u,f,m){if(f==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!m||(u=wa(u.nextSibling),u===null))return null;return u}function DV(u,f){for(;u.nodeType!==8;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!f||(u=wa(u.nextSibling),u===null))return null;return u}function rI(u){return u.data==="$?"||u.data==="$~"}function oI(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState!=="loading"}function Hse(u,f){var m=u.ownerDocument;if(u.data==="$~")u._reactRetry=f;else if(u.data!=="$?"||m.readyState!=="loading")f();else{var w=function(){f(),m.removeEventListener("DOMContentLoaded",w)};m.addEventListener("DOMContentLoaded",w),u._reactRetry=w}}function wa(u){for(;u!=null;u=u.nextSibling){var f=u.nodeType;if(f===1||f===3)break;if(f===8){if(f=u.data,f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"||f==="F!"||f==="F")break;if(f==="/$"||f==="/&")return null}}return u}var aI=null;function TV(u){u=u.nextSibling;for(var f=0;u;){if(u.nodeType===8){var m=u.data;if(m==="/$"||m==="/&"){if(f===0)return wa(u.nextSibling);f--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||f++}u=u.nextSibling}return null}function NV(u){u=u.previousSibling;for(var f=0;u;){if(u.nodeType===8){var m=u.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(f===0)return u;f--}else m!=="/$"&&m!=="/&"||f++}u=u.previousSibling}return null}function IV(u,f,m){switch(f=pS(m),u){case"html":if(u=f.documentElement,!u)throw Error(i(452));return u;case"head":if(u=f.head,!u)throw Error(i(453));return u;case"body":if(u=f.body,!u)throw Error(i(454));return u;default:throw Error(i(451))}}function Ub(u){for(var f=u.attributes;f.length;)u.removeAttributeNode(f[0]);Ve(u)}var va=new Map,RV=new Set;function _S(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var Zc=ee.d;ee.d={f:Wse,r:zse,D:Use,C:jse,L:$se,m:qse,X:Kse,S:Gse,M:Yse};function Wse(){var u=Zc.f(),f=lS();return u||f}function zse(u){var f=Di(u);f!==null&&f.tag===5&&f.type==="form"?YF(f):Zc.r(u)}var Cp=typeof document>"u"?null:document;function AV(u,f,m){var w=Cp;if(w&&typeof f=="string"&&f){var L=da(f);L='link[rel="'+u+'"][href="'+L+'"]',typeof m=="string"&&(L+='[crossorigin="'+m+'"]'),RV.has(L)||(RV.add(L),u={rel:u,crossOrigin:m,href:f},w.querySelector(L)===null&&(f=w.createElement("link"),Js(f,"link",u),wi(f),w.head.appendChild(f)))}}function Use(u){Zc.D(u),AV("dns-prefetch",u,null)}function jse(u,f){Zc.C(u,f),AV("preconnect",u,f)}function $se(u,f,m){Zc.L(u,f,m);var w=Cp;if(w&&u&&f){var L='link[rel="preload"][as="'+da(f)+'"]';f==="image"&&m&&m.imageSrcSet?(L+='[imagesrcset="'+da(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(L+='[imagesizes="'+da(m.imageSizes)+'"]')):L+='[href="'+da(u)+'"]';var E=L;switch(f){case"style":E=yp(u);break;case"script":E=Sp(u)}va.has(E)||(u=d({rel:"preload",href:f==="image"&&m&&m.imageSrcSet?void 0:u,as:f},m),va.set(E,u),w.querySelector(L)!==null||f==="style"&&w.querySelector(jb(E))||f==="script"&&w.querySelector($b(E))||(f=w.createElement("link"),Js(f,"link",u),wi(f),w.head.appendChild(f)))}}function qse(u,f){Zc.m(u,f);var m=Cp;if(m&&u){var w=f&&typeof f.as=="string"?f.as:"script",L='link[rel="modulepreload"][as="'+da(w)+'"][href="'+da(u)+'"]',E=L;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Sp(u)}if(!va.has(E)&&(u=d({rel:"modulepreload",href:u},f),va.set(E,u),m.querySelector(L)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector($b(E)))return}w=m.createElement("link"),Js(w,"link",u),wi(w),m.head.appendChild(w)}}}function Gse(u,f,m){Zc.S(u,f,m);var w=Cp;if(w&&u){var L=Ki(w).hoistableStyles,E=yp(u);f=f||"default";var P=L.get(E);if(!P){var z={loading:0,preload:null};if(P=w.querySelector(jb(E)))z.loading=5;else{u=d({rel:"stylesheet",href:u,"data-precedence":f},m),(m=va.get(E))&&lI(u,m);var te=P=w.createElement("link");wi(te),Js(te,"link",u),te._p=new Promise(function(be,ke){te.onload=be,te.onerror=ke}),te.addEventListener("load",function(){z.loading|=1}),te.addEventListener("error",function(){z.loading|=2}),z.loading|=4,bS(P,f,w)}P={type:"stylesheet",instance:P,count:1,state:z},L.set(E,P)}}}function Kse(u,f){Zc.X(u,f);var m=Cp;if(m&&u){var w=Ki(m).hoistableScripts,L=Sp(u),E=w.get(L);E||(E=m.querySelector($b(L)),E||(u=d({src:u,async:!0},f),(f=va.get(L))&&cI(u,f),E=m.createElement("script"),wi(E),Js(E,"link",u),m.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},w.set(L,E))}}function Yse(u,f){Zc.M(u,f);var m=Cp;if(m&&u){var w=Ki(m).hoistableScripts,L=Sp(u),E=w.get(L);E||(E=m.querySelector($b(L)),E||(u=d({src:u,async:!0,type:"module"},f),(f=va.get(L))&&cI(u,f),E=m.createElement("script"),wi(E),Js(E,"link",u),m.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},w.set(L,E))}}function MV(u,f,m,w){var L=(L=Xe.current)?_S(L):null;if(!L)throw Error(i(446));switch(u){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(f=yp(m.href),m=Ki(L).hoistableStyles,w=m.get(f),w||(w={type:"style",instance:null,count:0,state:null},m.set(f,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){u=yp(m.href);var E=Ki(L).hoistableStyles,P=E.get(u);if(P||(L=L.ownerDocument||L,P={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(u,P),(E=L.querySelector(jb(u)))&&!E._p&&(P.instance=E,P.state.loading=5),va.has(u)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},va.set(u,m),E||Qse(L,u,m,P.state))),f&&w===null)throw Error(i(528,""));return P}if(f&&w!==null)throw Error(i(529,""));return null;case"script":return f=m.async,m=m.src,typeof m=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Sp(m),m=Ki(L).hoistableScripts,w=m.get(f),w||(w={type:"script",instance:null,count:0,state:null},m.set(f,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,u))}}function yp(u){return'href="'+da(u)+'"'}function jb(u){return'link[rel="stylesheet"]['+u+"]"}function OV(u){return d({},u,{"data-precedence":u.precedence,precedence:null})}function Qse(u,f,m,w){u.querySelector('link[rel="preload"][as="style"]['+f+"]")?w.loading=1:(f=u.createElement("link"),w.preload=f,f.addEventListener("load",function(){return w.loading|=1}),f.addEventListener("error",function(){return w.loading|=2}),Js(f,"link",m),wi(f),u.head.appendChild(f))}function Sp(u){return'[src="'+da(u)+'"]'}function $b(u){return"script[async]"+u}function PV(u,f,m){if(f.count++,f.instance===null)switch(f.type){case"style":var w=u.querySelector('style[data-href~="'+da(m.href)+'"]');if(w)return f.instance=w,wi(w),w;var L=d({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return w=(u.ownerDocument||u).createElement("style"),wi(w),Js(w,"style",L),bS(w,m.precedence,u),f.instance=w;case"stylesheet":L=yp(m.href);var E=u.querySelector(jb(L));if(E)return f.state.loading|=4,f.instance=E,wi(E),E;w=OV(m),(L=va.get(L))&&lI(w,L),E=(u.ownerDocument||u).createElement("link"),wi(E);var P=E;return P._p=new Promise(function(z,te){P.onload=z,P.onerror=te}),Js(E,"link",w),f.state.loading|=4,bS(E,m.precedence,u),f.instance=E;case"script":return E=Sp(m.src),(L=u.querySelector($b(E)))?(f.instance=L,wi(L),L):(w=m,(L=va.get(E))&&(w=d({},m),cI(w,L)),u=u.ownerDocument||u,L=u.createElement("script"),wi(L),Js(L,"link",w),u.head.appendChild(L),f.instance=L);case"void":return null;default:throw Error(i(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(w=f.instance,f.state.loading|=4,bS(w,m.precedence,u));return f.instance}function bS(u,f,m){for(var w=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),L=w.length?w[w.length-1]:null,E=L,P=0;P<w.length;P++){var z=w[P];if(z.dataset.precedence===f)E=z;else if(E!==L)break}E?E.parentNode.insertBefore(u,E.nextSibling):(f=m.nodeType===9?m.head:m,f.insertBefore(u,f.firstChild))}function lI(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.title==null&&(u.title=f.title)}function cI(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.integrity==null&&(u.integrity=f.integrity)}var wS=null;function FV(u,f,m){if(wS===null){var w=new Map,L=wS=new Map;L.set(m,w)}else L=wS,w=L.get(m),w||(w=new Map,L.set(m,w));if(w.has(u))return w;for(w.set(u,null),m=m.getElementsByTagName(u),L=0;L<m.length;L++){var E=m[L];if(!(E[re]||E[Gi]||u==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var P=E.getAttribute(f)||"";P=u+P;var z=w.get(P);z?z.push(E):w.set(P,[E])}}return w}function BV(u,f,m){u=u.ownerDocument||u,u.head.insertBefore(m,f==="title"?u.querySelector("head > title"):null)}function Xse(u,f,m){if(m===1||f.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return u=f.disabled,typeof f.precedence=="string"&&u==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function VV(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}function Zse(u,f,m,w){if(m.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var L=yp(w.href),E=f.querySelector(jb(L));if(E){f=E._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(u.count++,u=vS.bind(u),f.then(u,u)),m.state.loading|=4,m.instance=E,wi(E);return}E=f.ownerDocument||f,w=OV(w),(L=va.get(L))&&lI(w,L),E=E.createElement("link"),wi(E);var P=E;P._p=new Promise(function(z,te){P.onload=z,P.onerror=te}),Js(E,"link",w),m.instance=E}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(m,f),(f=m.state.preload)&&(m.state.loading&3)===0&&(u.count++,m=vS.bind(u),f.addEventListener("load",m),f.addEventListener("error",m))}}var uI=0;function Jse(u,f){return u.stylesheets&&u.count===0&&yS(u,u.stylesheets),0<u.count||0<u.imgCount?function(m){var w=setTimeout(function(){if(u.stylesheets&&yS(u,u.stylesheets),u.unsuspend){var E=u.unsuspend;u.unsuspend=null,E()}},6e4+f);0<u.imgBytes&&uI===0&&(uI=62500*Ase());var L=setTimeout(function(){if(u.waitingForImages=!1,u.count===0&&(u.stylesheets&&yS(u,u.stylesheets),u.unsuspend)){var E=u.unsuspend;u.unsuspend=null,E()}},(u.imgBytes>uI?50:800)+f);return u.unsuspend=m,function(){u.unsuspend=null,clearTimeout(w),clearTimeout(L)}}:null}function vS(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yS(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var CS=null;function yS(u,f){u.stylesheets=null,u.unsuspend!==null&&(u.count++,CS=new Map,f.forEach(ere,u),CS=null,vS.call(u))}function ere(u,f){if(!(f.state.loading&4)){var m=CS.get(u);if(m)var w=m.get(null);else{m=new Map,CS.set(u,m);for(var L=u.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<L.length;E++){var P=L[E];(P.nodeName==="LINK"||P.getAttribute("media")!=="not all")&&(m.set(P.dataset.precedence,P),w=P)}w&&m.set(null,w)}L=f.instance,P=L.getAttribute("data-precedence"),E=m.get(P)||w,E===w&&m.set(null,L),m.set(P,L),this.count++,w=vS.bind(this),L.addEventListener("load",w),L.addEventListener("error",w),E?E.parentNode.insertBefore(L,E.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(L,u.firstChild)),f.state.loading|=4}}var qb={$$typeof:y,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function tre(u,f,m,w,L,E,P,z,te){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zm(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zm(0),this.hiddenUpdates=zm(null),this.identifierPrefix=w,this.onUncaughtError=L,this.onCaughtError=E,this.onRecoverableError=P,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function HV(u,f,m,w,L,E,P,z,te,be,ke,Ie){return u=new tre(u,f,m,P,te,be,ke,Ie,z),f=1,E===!0&&(f|=24),E=Fo(3,null,null,f),u.current=E,E.stateNode=u,f=UT(),f.refCount++,u.pooledCache=f,f.refCount++,E.memoizedState={element:w,isDehydrated:m,cache:f},GT(E),u}function WV(u){return u?(u=ep,u):ep}function zV(u,f,m,w,L,E){L=WV(L),w.context===null?w.context=L:w.pendingContext=L,w=vh(f),w.payload={element:m},E=E===void 0?null:E,E!==null&&(w.callback=E),m=Ch(u,w,f),m!==null&&(ro(m,u,f),xb(m,u,f))}function UV(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var m=u.retryLane;u.retryLane=m!==0&&m<f?m:f}}function hI(u,f){UV(u,f),(u=u.alternate)&&UV(u,f)}function jV(u){if(u.tag===13||u.tag===31){var f=Qd(u,67108864);f!==null&&ro(f,u,67108864),hI(u,67108864)}}function $V(u){if(u.tag===13||u.tag===31){var f=zo();f=Ha(f);var m=Qd(u,f);m!==null&&ro(m,u,f),hI(u,f)}}var SS=!0;function ire(u,f,m,w){var L=q.T;q.T=null;var E=ee.p;try{ee.p=2,dI(u,f,m,w)}finally{ee.p=E,q.T=L}}function nre(u,f,m,w){var L=q.T;q.T=null;var E=ee.p;try{ee.p=8,dI(u,f,m,w)}finally{ee.p=E,q.T=L}}function dI(u,f,m,w){if(SS){var L=fI(w);if(L===null)ZN(u,f,w,xS,m),GV(u,w);else if(rre(L,u,f,m,w))w.stopPropagation();else if(GV(u,w),f&4&&-1<sre.indexOf(u)){for(;L!==null;){var E=Di(L);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var P=Ic(E.pendingLanes);if(P!==0){var z=E;for(z.pendingLanes|=2,z.entangledLanes|=2;P;){var te=1<<31-bn(P);z.entanglements[1]|=te,P&=~te}Tl(E),(Ti&6)===0&&(oS=he()+500,Hb(0))}}break;case 31:case 13:z=Qd(E,2),z!==null&&ro(z,E,2),lS(),hI(E,2)}if(E=fI(w),E===null&&ZN(u,f,w,xS,m),E===L)break;L=E}L!==null&&w.stopPropagation()}else ZN(u,f,w,null,m)}}function fI(u){return u=mT(u),gI(u)}var xS=null;function gI(u){if(xS=null,u=Je(u),u!==null){var f=r(u);if(f===null)u=null;else{var m=f.tag;if(m===13){if(u=o(f),u!==null)return u;u=null}else if(m===31){if(u=a(f),u!==null)return u;u=null}else if(m===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;u=null}else f!==u&&(u=null)}}return xS=u,null}function qV(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ce()){case Ze:return 2;case Ft:return 8;case Si:case zt:return 32;case At:return 268435456;default:return 32}default:return 32}}var mI=!1,Rh=null,Ah=null,Mh=null,Gb=new Map,Kb=new Map,Oh=[],sre="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function GV(u,f){switch(u){case"focusin":case"focusout":Rh=null;break;case"dragenter":case"dragleave":Ah=null;break;case"mouseover":case"mouseout":Mh=null;break;case"pointerover":case"pointerout":Gb.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kb.delete(f.pointerId)}}function Yb(u,f,m,w,L,E){return u===null||u.nativeEvent!==E?(u={blockedOn:f,domEventName:m,eventSystemFlags:w,nativeEvent:E,targetContainers:[L]},f!==null&&(f=Di(f),f!==null&&jV(f)),u):(u.eventSystemFlags|=w,f=u.targetContainers,L!==null&&f.indexOf(L)===-1&&f.push(L),u)}function rre(u,f,m,w,L){switch(f){case"focusin":return Rh=Yb(Rh,u,f,m,w,L),!0;case"dragenter":return Ah=Yb(Ah,u,f,m,w,L),!0;case"mouseover":return Mh=Yb(Mh,u,f,m,w,L),!0;case"pointerover":var E=L.pointerId;return Gb.set(E,Yb(Gb.get(E)||null,u,f,m,w,L)),!0;case"gotpointercapture":return E=L.pointerId,Kb.set(E,Yb(Kb.get(E)||null,u,f,m,w,L)),!0}return!1}function KV(u){var f=Je(u.target);if(f!==null){var m=r(f);if(m!==null){if(f=m.tag,f===13){if(f=o(m),f!==null){u.blockedOn=f,jm(u.priority,function(){$V(m)});return}}else if(f===31){if(f=a(m),f!==null){u.blockedOn=f,jm(u.priority,function(){$V(m)});return}}else if(f===3&&m.stateNode.current.memoizedState.isDehydrated){u.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}u.blockedOn=null}function LS(u){if(u.blockedOn!==null)return!1;for(var f=u.targetContainers;0<f.length;){var m=fI(u.nativeEvent);if(m===null){m=u.nativeEvent;var w=new m.constructor(m.type,m);gT=w,m.target.dispatchEvent(w),gT=null}else return f=Di(m),f!==null&&jV(f),u.blockedOn=m,!1;f.shift()}return!0}function YV(u,f,m){LS(u)&&m.delete(f)}function ore(){mI=!1,Rh!==null&&LS(Rh)&&(Rh=null),Ah!==null&&LS(Ah)&&(Ah=null),Mh!==null&&LS(Mh)&&(Mh=null),Gb.forEach(YV),Kb.forEach(YV)}function kS(u,f){u.blockedOn===f&&(u.blockedOn=null,mI||(mI=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,ore)))}var ES=null;function QV(u){ES!==u&&(ES=u,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){ES===u&&(ES=null);for(var f=0;f<u.length;f+=3){var m=u[f],w=u[f+1],L=u[f+2];if(typeof w!="function"){if(gI(w||m)===null)continue;break}var E=Di(m);E!==null&&(u.splice(f,3),f-=3,fN(E,{pending:!0,data:L,method:m.method,action:w},w,L))}}))}function xp(u){function f(te){return kS(te,u)}Rh!==null&&kS(Rh,u),Ah!==null&&kS(Ah,u),Mh!==null&&kS(Mh,u),Gb.forEach(f),Kb.forEach(f);for(var m=0;m<Oh.length;m++){var w=Oh[m];w.blockedOn===u&&(w.blockedOn=null)}for(;0<Oh.length&&(m=Oh[0],m.blockedOn===null);)KV(m),m.blockedOn===null&&Oh.shift();if(m=(u.ownerDocument||u).$$reactFormReplay,m!=null)for(w=0;w<m.length;w+=3){var L=m[w],E=m[w+1],P=L[Ys]||null;if(typeof E=="function")P||QV(m);else if(P){var z=null;if(E&&E.hasAttribute("formAction")){if(L=E,P=E[Ys]||null)z=P.formAction;else if(gI(L)!==null)continue}else z=P.action;typeof z=="function"?m[w+1]=z:(m.splice(w,3),w-=3),QV(m)}}}function XV(){function u(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(P){return L=P})},focusReset:"manual",scroll:"manual"})}function f(){L!==null&&(L(),L=null),w||setTimeout(m,20)}function m(){if(!w&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,L=null;return navigation.addEventListener("navigate",u),navigation.addEventListener("navigatesuccess",f),navigation.addEventListener("navigateerror",f),setTimeout(m,100),function(){w=!0,navigation.removeEventListener("navigate",u),navigation.removeEventListener("navigatesuccess",f),navigation.removeEventListener("navigateerror",f),L!==null&&(L(),L=null)}}}function pI(u){this._internalRoot=u}DS.prototype.render=pI.prototype.render=function(u){var f=this._internalRoot;if(f===null)throw Error(i(409));var m=f.current,w=zo();zV(m,w,u,f,null,null)},DS.prototype.unmount=pI.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var f=u.containerInfo;zV(u.current,2,null,u,null,null),lS(),f[Ac]=null}};function DS(u){this._internalRoot=u}DS.prototype.unstable_scheduleHydration=function(u){if(u){var f=ab();u={blockedOn:null,target:u,priority:f};for(var m=0;m<Oh.length&&f!==0&&f<Oh[m].priority;m++);Oh.splice(m,0,u),m===0&&KV(u)}};var ZV=e.version;if(ZV!=="19.2.1")throw Error(i(527,ZV,"19.2.1"));ee.findDOMNode=function(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(i(188)):(u=Object.keys(u).join(","),Error(i(268,u)));return u=c(f),u=u!==null?h(u):null,u=u===null?null:u.stateNode,u};var are={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var TS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!TS.isDisabled&&TS.supportsFiber)try{Ks=TS.inject(are),Mi=TS}catch{}}return Xb.createRoot=function(u,f){if(!n(u))throw Error(i(299));var m=!1,w="",L=rB,E=oB,P=aB;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(w=f.identifierPrefix),f.onUncaughtError!==void 0&&(L=f.onUncaughtError),f.onCaughtError!==void 0&&(E=f.onCaughtError),f.onRecoverableError!==void 0&&(P=f.onRecoverableError)),f=HV(u,1,!1,null,null,m,w,null,L,E,P,XV),u[Ac]=f.current,XN(u),new pI(f)},Xb.hydrateRoot=function(u,f,m){if(!n(u))throw Error(i(299));var w=!1,L="",E=rB,P=oB,z=aB,te=null;return m!=null&&(m.unstable_strictMode===!0&&(w=!0),m.identifierPrefix!==void 0&&(L=m.identifierPrefix),m.onUncaughtError!==void 0&&(E=m.onUncaughtError),m.onCaughtError!==void 0&&(P=m.onCaughtError),m.onRecoverableError!==void 0&&(z=m.onRecoverableError),m.formState!==void 0&&(te=m.formState)),f=HV(u,1,!0,f,m??null,w,L,te,E,P,z,XV),f.context=WV(null),m=f.current,w=zo(),w=Ha(w),L=vh(w),L.callback=null,Ch(m,L,w),m=w,f.current.lanes=m,Rc(f,m),Tl(f),u[Ac]=f.current,XN(u),new DS(f)},Xb.version="19.2.1",Xb}var lH;function wre(){if(lH)return wI.exports;lH=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),wI.exports=bre(),wI.exports}var vre=wre();const Cre=gP(vre),yre=({chapters:s,currentChapterId:e,onSelectChapter:t,unlockedMap:i,enforceLocksForStudent:n=!0})=>{const[r,o]=Ne.useState(null),[a,l]=Ne.useState(!1),c=Object.values(i).filter(Boolean).length,h=Math.round(c/s.length*100);return K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"w-14 bg-[#252526] text-slate-400 flex flex-col items-center py-4 border-r border-[#3c3c3c] relative z-30",children:[K.jsx("div",{className:"mb-6 w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-xl text-white shadow-lg cursor-pointer hover:scale-105 transition-transform",title:"Python Tutoring",children:""}),K.jsxs("button",{onClick:()=>l(!a),className:`w-10 h-10 rounded-lg flex items-center justify-center mb-2 transition-all relative ${a?"bg-blue-600 text-white":"hover:bg-[#3c3c3c] hover:text-white"}`,title:"Chapters",children:[K.jsx("span",{className:"text-xl",children:""}),K.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[K.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#3c3c3c",strokeWidth:"2"}),K.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#22c55e",strokeWidth:"2",strokeDasharray:`${h} 100`,strokeLinecap:"round",className:"transition-all duration-500"})]})]}),K.jsx("div",{className:"flex-1"}),K.jsx("button",{className:"w-10 h-10 rounded-lg flex items-center justify-center hover:bg-[#3c3c3c] hover:text-white transition-all",title:"Settings",children:K.jsx("span",{className:"text-xl",children:""})}),K.jsx("button",{className:"w-10 h-10 rounded-lg flex items-center justify-center hover:bg-[#3c3c3c] hover:text-white transition-all",title:"Keyboard Shortcuts: Ctrl+Enter to Run",children:K.jsx("span",{className:"text-xl",children:""})})]}),a&&K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"fixed inset-0 bg-black/40 z-20",onClick:()=>l(!1)}),K.jsxs("div",{className:"fixed left-14 top-0 h-full w-80 bg-[#1e1e1e] shadow-2xl border-r border-[#3c3c3c] z-30 animate-slide-in overflow-hidden flex flex-col",children:[K.jsxs("div",{className:"p-5 border-b border-[#3c3c3c] bg-[#252526]",children:[K.jsxs("div",{className:"flex items-center justify-between mb-3",children:[K.jsx("h3",{className:"font-bold text-white text-lg",children:"Curriculum"}),K.jsx("button",{onClick:()=>l(!1),className:"text-slate-500 hover:text-white transition-colors",children:""})]}),K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"flex-1 h-2 bg-[#3c3c3c] rounded-full overflow-hidden",children:K.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-green-400 rounded-full transition-all duration-500",style:{width:`${h}%`}})}),K.jsxs("span",{className:"text-xs text-slate-400 font-mono",children:[h,"%"]})]})]}),K.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:s.map((d,g)=>{const p=i[d.id],_=e===d.id,b=!p&&n,C=r===d.id;return K.jsxs("button",{onClick:()=>{if(b){o(d.id),setTimeout(()=>o(null),1500);return}t(d.id),l(!1)},className:`w-full text-left p-4 rounded-xl mb-2 transition-all flex items-start gap-3 group ${_?"bg-blue-600/20 border border-blue-500/30":C?"bg-red-600/20 border border-red-500/50 animate-shake":b?"opacity-60 cursor-not-allowed border border-transparent":"hover:bg-[#2a2a2a] border border-transparent"}`,children:[K.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold flex-shrink-0 ${_?"bg-blue-600 text-white":p?"bg-emerald-600/20 text-emerald-400 border border-emerald-500/30":"bg-[#3c3c3c] text-slate-500"}`,children:p?g+1:""}),K.jsxs("div",{className:"flex-1 min-w-0",children:[K.jsx("div",{className:`font-medium truncate text-sm ${_?"text-white":"text-slate-300"}`,children:d.title}),K.jsxs("div",{className:"text-xs text-slate-500 truncate mt-0.5",children:[d.challenges.length," challenges"]})]}),p&&!_&&K.jsx("span",{className:"text-emerald-500 text-sm",children:""}),C&&K.jsx("span",{className:"text-red-400 text-xs animate-pulse",children:"Locked by teacher"})]},d.id)})}),K.jsx("div",{className:"p-4 border-t border-[#3c3c3c] bg-[#252526]",children:K.jsx("div",{className:"text-xs text-slate-500 text-center",children:"Mr. Stewart's Python Tutoring"})})]})]}),K.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateX(-100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        .animate-slide-in {
          animation: slide-in 0.2s ease-out;
        }
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          20%, 60% { transform: translateX(-4px); }
          40%, 80% { transform: translateX(4px); }
        }
        .animate-shake {
          animation: shake 0.3s ease-out;
        }
      `})]})};function cH(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,i=Array(e);t<e;t++)i[t]=s[t];return i}function Sre(s){if(Array.isArray(s))return s}function xre(s,e,t){return(e=Ire(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Lre(s,e){var t=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(t!=null){var i,n,r,o,a=[],l=!0,c=!1;try{if(r=(t=t.call(s)).next,e!==0)for(;!(l=(i=r.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(h){c=!0,n=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function kre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uH(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function hH(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uH(Object(t),!0).forEach(function(i){xre(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):uH(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function Ere(s,e){if(s==null)return{};var t,i,n=Dre(s,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(n[t]=s[t])}return n}function Dre(s,e){if(s==null)return{};var t={};for(var i in s)if({}.hasOwnProperty.call(s,i)){if(e.indexOf(i)!==-1)continue;t[i]=s[i]}return t}function Tre(s,e){return Sre(s)||Lre(s,e)||Rre(s,e)||kre()}function Nre(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Ire(s){var e=Nre(s,"string");return typeof e=="symbol"?e:e+""}function Rre(s,e){if(s){if(typeof s=="string")return cH(s,e);var t={}.toString.call(s).slice(8,-1);return t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set"?Array.from(s):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?cH(s,e):void 0}}function Are(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function dH(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function fH(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dH(Object(t),!0).forEach(function(i){Are(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):dH(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function Mre(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(i){return e.reduceRight(function(n,r){return r(n)},i)}}function E0(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return n.length>=s.length?s.apply(this,n):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function mL(s){return{}.toString.call(s).includes("Object")}function Ore(s){return!Object.keys(s).length}function Yw(s){return typeof s=="function"}function Pre(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function Fre(s,e){return mL(e)||dd("changeType"),Object.keys(e).some(function(t){return!Pre(s,t)})&&dd("changeField"),e}function Bre(s){Yw(s)||dd("selectorType")}function Vre(s){Yw(s)||mL(s)||dd("handlerType"),mL(s)&&Object.values(s).some(function(e){return!Yw(e)})&&dd("handlersType")}function Hre(s){s||dd("initialIsRequired"),mL(s)||dd("initialType"),Ore(s)&&dd("initialContent")}function Wre(s,e){throw new Error(s[e]||s.default)}var zre={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},dd=E0(Wre)(zre),NS={changes:Fre,selector:Bre,handler:Vre,initial:Hre};function Ure(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};NS.initial(s),NS.handler(e);var t={current:s},i=E0(qre)(t,e),n=E0($re)(t),r=E0(NS.changes)(s),o=E0(jre)(t);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return NS.selector(c),c(t.current)}function l(c){Mre(i,n,r,o)(c)}return[a,l]}function jre(s,e){return Yw(e)?e(s.current):e}function $re(s,e){return s.current=fH(fH({},s.current),e),e}function qre(s,e,t){return Yw(e)?e(s.current):Object.keys(t).forEach(function(i){var n;return(n=e[i])===null||n===void 0?void 0:n.call(e,s.current[i])}),t}var Gre={create:Ure},Kre={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function Yre(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return n.length>=s.length?s.apply(this,n):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function Qre(s){return{}.toString.call(s).includes("Object")}function Xre(s){return s||gH("configIsRequired"),Qre(s)||gH("configType"),s.urls?(Zre(),{paths:{vs:s.urls.monacoBase}}):s}function Zre(){console.warn(zG.deprecation)}function Jre(s,e){throw new Error(s[e]||s.default)}var zG={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},gH=Yre(Jre)(zG),eoe={config:Xre},toe=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduceRight(function(r,o){return o(r)},n)}};function UG(s,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&s[t]&&Object.assign(e[t],UG(s[t],e[t]))}),hH(hH({},s),e)}var ioe={type:"cancelation",msg:"operation is manually canceled"};function SI(s){var e=!1,t=new Promise(function(i,n){s.then(function(r){return e?n(ioe):i(r)}),s.catch(n)});return t.cancel=function(){return e=!0},t}var noe=["monaco"],soe=Gre.create({config:Kre,isInitialized:!1,resolve:null,reject:null,monaco:null}),jG=Tre(soe,2),yC=jG[0],ME=jG[1];function roe(s){var e=eoe.config(s),t=e.monaco,i=Ere(e,noe);ME(function(n){return{config:UG(n.config,i),monaco:t}})}function ooe(){var s=yC(function(e){var t=e.monaco,i=e.isInitialized,n=e.resolve;return{monaco:t,isInitialized:i,resolve:n}});if(!s.isInitialized){if(ME({isInitialized:!0}),s.monaco)return s.resolve(s.monaco),SI(xI);if(window.monaco&&window.monaco.editor)return $G(window.monaco),s.resolve(window.monaco),SI(xI);toe(aoe,coe)(uoe)}return SI(xI)}function aoe(s){return document.body.appendChild(s)}function loe(s){var e=document.createElement("script");return s&&(e.src=s),e}function coe(s){var e=yC(function(i){var n=i.config,r=i.reject;return{config:n,reject:r}}),t=loe("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return s()},t.onerror=e.reject,t}function uoe(){var s=yC(function(t){var i=t.config,n=t.resolve,r=t.reject;return{config:i,resolve:n,reject:r}}),e=window.require;e.config(s.config),e(["vs/editor/editor.main"],function(t){var i=t.m||t;$G(i),s.resolve(i)},function(t){s.reject(t)})}function $G(s){yC().monaco||ME({monaco:s})}function hoe(){return yC(function(s){var e=s.monaco;return e})}var xI=new Promise(function(s,e){return ME({resolve:s,reject:e})}),qG={config:roe,init:ooe,__getMonacoInstance:hoe},doe={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},LI=doe,foe={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},goe=foe;function moe({children:s}){return hd.createElement("div",{style:goe.container},s)}var poe=moe,_oe=poe;function boe({width:s,height:e,isEditorReady:t,loading:i,_ref:n,className:r,wrapperProps:o}){return hd.createElement("section",{style:{...LI.wrapper,width:s,height:e},...o},!t&&hd.createElement(_oe,null,i),hd.createElement("div",{ref:n,style:{...LI.fullWidth,...!t&&LI.hide},className:r}))}var woe=boe,GG=Ne.memo(woe);function voe(s){Ne.useEffect(s,[])}var KG=voe;function Coe(s,e,t=!0){let i=Ne.useRef(!0);Ne.useEffect(i.current||!t?()=>{i.current=!1}:s,e)}var Go=Coe;function V0(){}function Gp(s,e,t,i){return yoe(s,i)||Soe(s,e,t,i)}function yoe(s,e){return s.editor.getModel(YG(s,e))}function Soe(s,e,t,i){return s.editor.createModel(e,t,i?YG(s,i):void 0)}function YG(s,e){return s.Uri.parse(e)}function xoe({original:s,modified:e,language:t,originalLanguage:i,modifiedLanguage:n,originalModelPath:r,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:h="Loading...",options:d={},height:g="100%",width:p="100%",className:_,wrapperProps:b={},beforeMount:C=V0,onMount:x=V0}){let[S,y]=Ne.useState(!1),[k,D]=Ne.useState(!0),R=Ne.useRef(null),N=Ne.useRef(null),A=Ne.useRef(null),M=Ne.useRef(x),O=Ne.useRef(C),V=Ne.useRef(!1);KG(()=>{let Y=qG.init();return Y.then(q=>(N.current=q)&&D(!1)).catch(q=>(q==null?void 0:q.type)!=="cancelation"&&console.error("Monaco initialization: error:",q)),()=>R.current?X():Y.cancel()}),Go(()=>{if(R.current&&N.current){let Y=R.current.getOriginalEditor(),q=Gp(N.current,s||"",i||t||"text",r||"");q!==Y.getModel()&&Y.setModel(q)}},[r],S),Go(()=>{if(R.current&&N.current){let Y=R.current.getModifiedEditor(),q=Gp(N.current,e||"",n||t||"text",o||"");q!==Y.getModel()&&Y.setModel(q)}},[o],S),Go(()=>{let Y=R.current.getModifiedEditor();Y.getOption(N.current.editor.EditorOption.readOnly)?Y.setValue(e||""):e!==Y.getValue()&&(Y.executeEdits("",[{range:Y.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),Y.pushUndoStop())},[e],S),Go(()=>{var Y,q;(q=(Y=R.current)==null?void 0:Y.getModel())==null||q.original.setValue(s||"")},[s],S),Go(()=>{let{original:Y,modified:q}=R.current.getModel();N.current.editor.setModelLanguage(Y,i||t||"text"),N.current.editor.setModelLanguage(q,n||t||"text")},[t,i,n],S),Go(()=>{var Y;(Y=N.current)==null||Y.editor.setTheme(c)},[c],S),Go(()=>{var Y;(Y=R.current)==null||Y.updateOptions(d)},[d],S);let H=Ne.useCallback(()=>{var ee;if(!N.current)return;O.current(N.current);let Y=Gp(N.current,s||"",i||t||"text",r||""),q=Gp(N.current,e||"",n||t||"text",o||"");(ee=R.current)==null||ee.setModel({original:Y,modified:q})},[t,e,n,s,i,r,o]),U=Ne.useCallback(()=>{var Y;!V.current&&A.current&&(R.current=N.current.editor.createDiffEditor(A.current,{automaticLayout:!0,...d}),H(),(Y=N.current)==null||Y.editor.setTheme(c),y(!0),V.current=!0)},[d,c,H]);Ne.useEffect(()=>{S&&M.current(R.current,N.current)},[S]),Ne.useEffect(()=>{!k&&!S&&U()},[k,S,U]);function X(){var q,ee,ue,oe;let Y=(q=R.current)==null?void 0:q.getModel();a||((ee=Y==null?void 0:Y.original)==null||ee.dispose()),l||((ue=Y==null?void 0:Y.modified)==null||ue.dispose()),(oe=R.current)==null||oe.dispose()}return hd.createElement(GG,{width:p,height:g,isEditorReady:S,loading:h,_ref:A,className:_,wrapperProps:b})}var Loe=xoe;Ne.memo(Loe);function koe(s){let e=Ne.useRef();return Ne.useEffect(()=>{e.current=s},[s]),e.current}var Eoe=koe,IS=new Map;function Doe({defaultValue:s,defaultLanguage:e,defaultPath:t,value:i,language:n,path:r,theme:o="light",line:a,loading:l="Loading...",options:c={},overrideServices:h={},saveViewState:d=!0,keepCurrentModel:g=!1,width:p="100%",height:_="100%",className:b,wrapperProps:C={},beforeMount:x=V0,onMount:S=V0,onChange:y,onValidate:k=V0}){let[D,R]=Ne.useState(!1),[N,A]=Ne.useState(!0),M=Ne.useRef(null),O=Ne.useRef(null),V=Ne.useRef(null),H=Ne.useRef(S),U=Ne.useRef(x),X=Ne.useRef(),Y=Ne.useRef(i),q=Eoe(r),ee=Ne.useRef(!1),ue=Ne.useRef(!1);KG(()=>{let $=qG.init();return $.then(ce=>(M.current=ce)&&A(!1)).catch(ce=>(ce==null?void 0:ce.type)!=="cancelation"&&console.error("Monaco initialization: error:",ce)),()=>O.current?Ee():$.cancel()}),Go(()=>{var ce,de,xe,Re;let $=Gp(M.current,s||i||"",e||n||"",r||t||"");$!==((ce=O.current)==null?void 0:ce.getModel())&&(d&&IS.set(q,(de=O.current)==null?void 0:de.saveViewState()),(xe=O.current)==null||xe.setModel($),d&&((Re=O.current)==null||Re.restoreViewState(IS.get(r))))},[r],D),Go(()=>{var $;($=O.current)==null||$.updateOptions(c)},[c],D),Go(()=>{!O.current||i===void 0||(O.current.getOption(M.current.editor.EditorOption.readOnly)?O.current.setValue(i):i!==O.current.getValue()&&(ue.current=!0,O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),O.current.pushUndoStop(),ue.current=!1))},[i],D),Go(()=>{var ce,de;let $=(ce=O.current)==null?void 0:ce.getModel();$&&n&&((de=M.current)==null||de.editor.setModelLanguage($,n))},[n],D),Go(()=>{var $;a!==void 0&&(($=O.current)==null||$.revealLine(a))},[a],D),Go(()=>{var $;($=M.current)==null||$.editor.setTheme(o)},[o],D);let oe=Ne.useCallback(()=>{var $;if(!(!V.current||!M.current)&&!ee.current){U.current(M.current);let ce=r||t,de=Gp(M.current,i||s||"",e||n||"",ce||"");O.current=($=M.current)==null?void 0:$.editor.create(V.current,{model:de,automaticLayout:!0,...c},h),d&&O.current.restoreViewState(IS.get(ce)),M.current.editor.setTheme(o),a!==void 0&&O.current.revealLine(a),R(!0),ee.current=!0}},[s,e,t,i,n,r,c,h,d,o,a]);Ne.useEffect(()=>{D&&H.current(O.current,M.current)},[D]),Ne.useEffect(()=>{!N&&!D&&oe()},[N,D,oe]),Y.current=i,Ne.useEffect(()=>{var $,ce;D&&y&&(($=X.current)==null||$.dispose(),X.current=(ce=O.current)==null?void 0:ce.onDidChangeModelContent(de=>{ue.current||y(O.current.getValue(),de)}))},[D,y]),Ne.useEffect(()=>{if(D){let $=M.current.editor.onDidChangeMarkers(ce=>{var xe;let de=(xe=O.current.getModel())==null?void 0:xe.uri;if(de&&ce.find(Re=>Re.path===de.path)){let Re=M.current.editor.getModelMarkers({resource:de});k==null||k(Re)}});return()=>{$==null||$.dispose()}}return()=>{}},[D,k]);function Ee(){var $,ce;($=X.current)==null||$.dispose(),g?d&&IS.set(r,O.current.saveViewState()):(ce=O.current.getModel())==null||ce.dispose(),O.current.dispose()}return hd.createElement(GG,{width:p,height:_,isEditorReady:D,loading:l,_ref:V,className:b,wrapperProps:C})}var Toe=Doe,Noe=Ne.memo(Toe),Ioe=Noe;const QG=Ne.createContext(void 0),pP=()=>{const s=Ne.useContext(QG);if(!s)throw new Error("usePython must be used within a PythonProvider");return s},Roe=({children:s})=>{const[e,t]=Ne.useState(null),[i,n]=Ne.useState(!0),[r,o]=Ne.useState(!1),[a,l]=Ne.useState("Initializing Python environment..."),[c,h]=Ne.useState([]),[d,g]=Ne.useState(!1),[p,_]=Ne.useState(null),b=Ne.useRef([]);Ne.useEffect(()=>{const y=setInterval(()=>{b.current.length>0&&(h(k=>[...k,...b.current]),b.current=[])},50);return()=>clearInterval(y)},[]),Ne.useEffect(()=>{(async()=>{try{if(l("Downloading Pyodide (Python 3.11)..."),!window.loadPyodide){const D=document.createElement("script");D.src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js",D.async=!0,document.body.appendChild(D),await new Promise(R=>{D.onload=R})}l("Instantiating WebAssembly...");const k=await window.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.25.0/full/"});k.setStdout({batched:D=>{if(D.startsWith("__TEST_RESULTS__:"))try{const R=D.replace("__TEST_RESULTS__:",""),N=JSON.parse(R);_(N)}catch(R){console.error("Failed to parse test results",R)}else b.current.push(D)}}),k.setStderr({batched:D=>b.current.push(`Error: ${D}`)}),l("Loading standard libraries..."),t(k),o(!0),l("System Ready.")}catch(k){console.error("Failed to load Pyodide:",k),l("Failed to load Python engine. Please refresh.")}finally{n(!1)}})()},[]);const C=Ne.useCallback(async(y,k)=>{if(e){g(!0),_(null);try{await new Promise(R=>setTimeout(R,10));let D=y;if(k&&k.length>0){const R=`
import json
import traceback

def __run_tests():
    test_cases = ${JSON.stringify(k)}
    results = []

    for case in test_cases:
        try:
            expected = eval(case['expected']) # Evaluate string "4" to int 4

            # Capture return value
            actual = eval(case['input'])

            passed = actual == expected
            results.append({
                "input": case['input'],
                "expected": str(expected),
                "actual": str(actual),
                "passed": passed
            })
        except Exception as e:
            results.append({
                "input": case['input'],
                "expected": case['expected'],
                "actual": "Error",
                "passed": False,
                "error": str(e)
            })

    print("__TEST_RESULTS__:" + json.dumps(results))

__run_tests()
`;D=y+`
`+R}await e.runPythonAsync(D)}catch(D){b.current.push(D.toString())}finally{g(!1)}}},[e]),x=Ne.useCallback(()=>{h([]),b.current=[],_(null)},[]),S=hd.useMemo(()=>({isLoading:i,isReady:r,loadingMessage:a,runCode:C,output:c,clearOutput:x,isRunning:d,testResults:p}),[i,r,a,C,c,x,d,p]);return K.jsx(QG.Provider,{value:S,children:s})},Aoe=()=>{const{output:s,isRunning:e,clearOutput:t,testResults:i}=pP(),n=Ne.useRef(null),[r,o]=Ne.useState("terminal");Ne.useEffect(()=>{i&&o("tests")},[i]),Ne.useEffect(()=>{var d;r==="terminal"&&((d=n.current)==null||d.scrollIntoView({behavior:"smooth"}))},[s,r]);const a=d=>d.startsWith("Error:")||d.includes("Traceback")?"text-red-400":d.startsWith(">>>")?"text-blue-400":"text-slate-200",l=(i==null?void 0:i.filter(d=>d.passed).length)||0,c=(i==null?void 0:i.length)||0,h=c>0&&l===c;return K.jsxs("div",{className:"flex flex-col h-full bg-[#0d0d0d] font-mono text-sm",children:[K.jsxs("div",{className:"flex items-center bg-[#1a1a1a] border-b border-[#2a2a2a]",children:[K.jsx("button",{onClick:()=>o("terminal"),className:`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${r==="terminal"?"text-white border-b-2 border-blue-500 bg-[#252526]":"text-slate-500 hover:text-slate-300"}`,children:"Terminal"}),K.jsxs("button",{onClick:()=>o("tests"),className:`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors flex items-center gap-2 ${r==="tests"?"text-white border-b-2 border-emerald-500 bg-[#252526]":"text-slate-500 hover:text-slate-300"}`,children:["Test Cases",i&&K.jsxs("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] ${h?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:[l,"/",c]})]}),K.jsx("div",{className:"flex-1"}),K.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e&&K.jsx("span",{className:"text-xs text-blue-400 animate-pulse",children:"Running..."}),K.jsx("button",{onClick:t,className:"text-xs text-slate-500 hover:text-white px-2 py-1",children:"Clear"})]})]}),K.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:r==="terminal"?K.jsxs("div",{className:"space-y-0.5",children:[s.length===0&&!e&&K.jsx("div",{className:"text-slate-600 italic text-xs",children:"Output will appear here..."}),s.map((d,g)=>K.jsx("div",{className:`${a(d)} whitespace-pre-wrap break-all`,children:d},g)),K.jsx("div",{ref:n})]}):K.jsx("div",{className:"space-y-3",children:i?K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:`p-3 rounded-lg border ${h?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[K.jsx("div",{className:"font-bold text-sm mb-1",children:h?" All Tests Passed!":" Some Tests Failed"}),K.jsxs("div",{className:"text-xs opacity-80",children:["You passed ",l," out of ",c," tests."]})]}),i.map((d,g)=>K.jsxs("div",{className:`p-3 rounded bg-[#1e1e1e] border ${d.passed?"border-emerald-500/20":"border-red-500/20"}`,children:[K.jsxs("div",{className:"flex items-center justify-between mb-2",children:[K.jsxs("span",{className:"font-mono text-xs text-slate-400",children:["Test Case ",g+1]}),K.jsx("span",{className:d.passed?"text-emerald-500":"text-red-500",children:d.passed?"PASSED":"FAILED"})]}),K.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-4 gap-y-1 text-xs font-mono",children:[K.jsx("div",{className:"text-slate-500 text-right",children:"Input:"}),K.jsx("div",{className:"text-slate-300",children:d.input}),K.jsx("div",{className:"text-slate-500 text-right",children:"Expected:"}),K.jsx("div",{className:"text-emerald-400/80",children:d.expected}),K.jsx("div",{className:"text-slate-500 text-right",children:"Actual:"}),K.jsx("div",{className:`${d.passed?"text-emerald-400/80":"text-red-400"}`,children:d.actual}),d.error&&K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"text-red-500 text-right",children:"Error:"}),K.jsx("div",{className:"text-red-400",children:d.error})]})]})]},g))]}):K.jsx("div",{className:"text-slate-600 italic text-xs",children:"Run code to see test results..."})})})]})},Moe=()=>{};var mH={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XG={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const je=function(s,e){if(!s)throw B1(e)},B1=function(s){return new Error("Firebase Database ("+XG.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZG=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let n=s.charCodeAt(i);n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):(n&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e},Ooe=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const n=s[t++];if(n<128)e[i++]=String.fromCharCode(n);else if(n>191&&n<224){const r=s[t++];e[i++]=String.fromCharCode((n&31)<<6|r&63)}else if(n>239&&n<365){const r=s[t++],o=s[t++],a=s[t++],l=((n&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=s[t++],o=s[t++];e[i++]=String.fromCharCode((n&15)<<12|(r&63)<<6|o&63)}}return e.join("")},_P={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<s.length;n+=3){const r=s[n],o=n+1<s.length,a=o?s[n+1]:0,l=n+2<s.length,c=l?s[n+2]:0,h=r>>2,d=(r&3)<<4|a>>4;let g=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(g=64)),i.push(t[h],t[d],t[g],t[p])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(ZG(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Ooe(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<s.length;){const r=t[s.charAt(n++)],a=n<s.length?t[s.charAt(n)]:0;++n;const c=n<s.length?t[s.charAt(n)]:64;++n;const d=n<s.length?t[s.charAt(n)]:64;if(++n,r==null||a==null||c==null||d==null)throw new Poe;const g=r<<2|a>>4;if(i.push(g),c!==64){const p=a<<4&240|c>>2;if(i.push(p),d!==64){const _=c<<6&192|d;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Poe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JG=function(s){const e=ZG(s);return _P.encodeByteArray(e,!0)},pL=function(s){return JG(s).replace(/\./g,"")},DA=function(s){try{return _P.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Foe(s){return eK(void 0,s)}function eK(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Boe(t)||(s[t]=eK(s[t],e[t]));return s}function Boe(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Voe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hoe=()=>Voe().__FIREBASE_DEFAULTS__,Woe=()=>{if(typeof process>"u"||typeof mH>"u")return;const s=mH.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},zoe=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&DA(s[1]);return e&&JSON.parse(e)},tK=()=>{try{return Moe()||Hoe()||Woe()||zoe()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Uoe=s=>{var e,t;return(t=(e=tK())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},joe=s=>{const e=Uoe(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},iK=()=>{var s;return(s=tK())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bP(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $oe(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qoe(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",n=s.iat||0,r=s.sub||s.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...s};return[pL(JSON.stringify(t)),pL(JSON.stringify(o)),""].join(".")}const H0={};function Goe(){const s={prod:[],emulator:[]};for(const e of Object.keys(H0))H0[e]?s.emulator.push(e):s.prod.push(e);return s}function Koe(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let pH=!1;function Yoe(s,e){if(typeof window>"u"||typeof document>"u"||!bP(window.location.host)||H0[s]===e||H0[s]||pH)return;H0[s]=e;function t(g){return`__firebase__banner__${g}`}const i="__firebase__banner",r=Goe().prod.length>0;function o(){const g=document.getElementById(i);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,p){g.setAttribute("width","24"),g.setAttribute("id",p),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function c(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{pH=!0,o()},g}function h(g,p){g.setAttribute("id",p),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function d(){const g=Koe(i),p=t("text"),_=document.getElementById(p)||document.createElement("span"),b=t("learnmore"),C=document.getElementById(b)||document.createElement("a"),x=t("preprendIcon"),S=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const y=g.element;a(y),h(C,b);const k=c();l(S,x),y.append(S,_,C,k),document.body.appendChild(y)}r?(_.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qoe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qoe())}function Xoe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Zoe(){return XG.NODE_ADMIN===!0}function Joe(){try{return typeof indexedDB=="object"}catch{return!1}}function eae(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},n.onupgradeneeded=()=>{t=!1},n.onerror=()=>{var r;e(((r=n.error)==null?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tae="FirebaseError";class SC extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=tae,Object.setPrototypeOf(this,SC.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sK.prototype.create)}}class sK{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},n=`${this.service}/${e}`,r=this.errors[e],o=r?iae(r,i):"Error",a=`${this.serviceName}: ${o} (${n}).`;return new SC(n,a,i)}}function iae(s,e){return s.replace(nae,(t,i)=>{const n=e[i];return n!=null?String(n):`<${i}?>`})}const nae=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(s){return JSON.parse(s)}function xs(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rK=function(s){let e={},t={},i={},n="";try{const r=s.split(".");e=Qw(DA(r[0])||""),t=Qw(DA(r[1])||""),n=r[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:n}},sae=function(s){const e=rK(s),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},rae=function(s){const e=rK(s).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function r1(s,e){if(Object.prototype.hasOwnProperty.call(s,e))return s[e]}function _H(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function _L(s,e,t){const i={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i[n]=e.call(t,s[n],n,s));return i}function bL(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const n of t){if(!i.includes(n))return!1;const r=s[n],o=e[n];if(bH(r)&&bH(o)){if(!bL(r,o))return!1}else if(r!==o)return!1}for(const n of i)if(!t.includes(n))return!1;return!0}function bH(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oae(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(n=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aae{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const g=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(g<<1|g>>>31)&4294967295}let n=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let d=0;d<80;d++){d<40?d<20?(c=a^r&(o^a),h=1518500249):(c=r^o^a,h=1859775393):d<60?(c=r&o|a&(r|o),h=2400959708):(c=r^o^a,h=3395469782);const g=(n<<5|n>>>27)+c+l+h+i[d]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=n,n=g}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let n=0;const r=this.buf_;let o=this.inbuf_;for(;n<t;){if(o===0)for(;n<=i;)this.compress_(e,n),n+=this.blockSize;if(typeof e=="string"){for(;n<t;)if(r[o]=e.charCodeAt(n),++o,++n,o===this.blockSize){this.compress_(r),o=0;break}}else for(;n<t;)if(r[o]=e[n],++o,++n,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let n=this.blockSize-1;n>=56;n--)this.buf_[n]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let n=0;n<5;n++)for(let r=24;r>=0;r-=8)e[i]=this.chain_[n]>>r&255,++i;return e}}function wP(s,e){return`${s} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lae=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let n=s.charCodeAt(i);if(n>=55296&&n<=56319){const r=n-55296;i++,je(i<s.length,"Surrogate pair missing trail surrogate.");const o=s.charCodeAt(i)-56320;n=65536+(r<<10)+o}n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):n<65536?(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e},PE=function(s){let e=0;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(s){return s&&s._delegate?s._delegate:s}class Xw{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cae{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new OE;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(n){if(i)return null;throw n}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hae(e))try{this.getOrInitializeService({instanceIdentifier:Cf})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:n});i.resolve(r)}catch{}}}}clearInstance(e=Cf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cf){return this.instances.has(e)}getOptions(e=Cf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(n)}return n}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),n=this.onInitCallbacks.get(i)??new Set;n.add(e),this.onInitCallbacks.set(i,n);const r=this.instances.get(i);return r&&e(r,i),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const n of i)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:uae(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Cf){return this.component?this.component.multipleInstances?e:Cf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uae(s){return s===Cf?void 0:s}function hae(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dae{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cae(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ln;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(ln||(ln={}));const fae={debug:ln.DEBUG,verbose:ln.VERBOSE,info:ln.INFO,warn:ln.WARN,error:ln.ERROR,silent:ln.SILENT},gae=ln.INFO,mae={[ln.DEBUG]:"log",[ln.VERBOSE]:"log",[ln.INFO]:"info",[ln.WARN]:"warn",[ln.ERROR]:"error"},pae=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),n=mae[e];if(n)console[n](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oK{constructor(e){this.name=e,this._logLevel=gae,this._logHandler=pae,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ln))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fae[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ln.DEBUG,...e),this._logHandler(this,ln.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ln.VERBOSE,...e),this._logHandler(this,ln.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ln.INFO,...e),this._logHandler(this,ln.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ln.WARN,...e),this._logHandler(this,ln.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ln.ERROR,...e),this._logHandler(this,ln.ERROR,...e)}}const _ae=(s,e)=>e.some(t=>s instanceof t);let wH,vH;function bae(){return wH||(wH=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wae(){return vH||(vH=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aK=new WeakMap,TA=new WeakMap,lK=new WeakMap,kI=new WeakMap,vP=new WeakMap;function vae(s){const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("success",r),s.removeEventListener("error",o)},r=()=>{t(fd(s.result)),n()},o=()=>{i(s.error),n()};s.addEventListener("success",r),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&aK.set(t,s)}).catch(()=>{}),vP.set(e,s),e}function Cae(s){if(TA.has(s))return;const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("complete",r),s.removeEventListener("error",o),s.removeEventListener("abort",o)},r=()=>{t(),n()},o=()=>{i(s.error||new DOMException("AbortError","AbortError")),n()};s.addEventListener("complete",r),s.addEventListener("error",o),s.addEventListener("abort",o)});TA.set(s,e)}let NA={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return TA.get(s);if(e==="objectStoreNames")return s.objectStoreNames||lK.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fd(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function yae(s){NA=s(NA)}function Sae(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(EI(this),e,...t);return lK.set(i,e.sort?e.sort():[e]),fd(i)}:wae().includes(s)?function(...e){return s.apply(EI(this),e),fd(aK.get(this))}:function(...e){return fd(s.apply(EI(this),e))}}function xae(s){return typeof s=="function"?Sae(s):(s instanceof IDBTransaction&&Cae(s),_ae(s,bae())?new Proxy(s,NA):s)}function fd(s){if(s instanceof IDBRequest)return vae(s);if(kI.has(s))return kI.get(s);const e=xae(s);return e!==s&&(kI.set(s,e),vP.set(e,s)),e}const EI=s=>vP.get(s);function Lae(s,e,{blocked:t,upgrade:i,blocking:n,terminated:r}={}){const o=indexedDB.open(s,e),a=fd(o);return i&&o.addEventListener("upgradeneeded",l=>{i(fd(o.result),l.oldVersion,l.newVersion,fd(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),n&&l.addEventListener("versionchange",c=>n(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const kae=["get","getKey","getAll","getAllKeys","count"],Eae=["put","add","delete","clear"],DI=new Map;function CH(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(DI.get(e))return DI.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,n=Eae.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(n||kae.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,n?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),n&&l.done]))[0]};return DI.set(e,r),r}yae(s=>({...s,get:(e,t,i)=>CH(e,t)||s.get(e,t,i),has:(e,t)=>!!CH(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Tae(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Tae(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const IA="@firebase/app",yH="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new oK("@firebase/app"),Nae="@firebase/app-compat",Iae="@firebase/analytics-compat",Rae="@firebase/analytics",Aae="@firebase/app-check-compat",Mae="@firebase/app-check",Oae="@firebase/auth",Pae="@firebase/auth-compat",Fae="@firebase/database",Bae="@firebase/data-connect",Vae="@firebase/database-compat",Hae="@firebase/functions",Wae="@firebase/functions-compat",zae="@firebase/installations",Uae="@firebase/installations-compat",jae="@firebase/messaging",$ae="@firebase/messaging-compat",qae="@firebase/performance",Gae="@firebase/performance-compat",Kae="@firebase/remote-config",Yae="@firebase/remote-config-compat",Qae="@firebase/storage",Xae="@firebase/storage-compat",Zae="@firebase/firestore",Jae="@firebase/ai",ele="@firebase/firestore-compat",tle="firebase",ile="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA="[DEFAULT]",nle={[IA]:"fire-core",[Nae]:"fire-core-compat",[Rae]:"fire-analytics",[Iae]:"fire-analytics-compat",[Mae]:"fire-app-check",[Aae]:"fire-app-check-compat",[Oae]:"fire-auth",[Pae]:"fire-auth-compat",[Fae]:"fire-rtdb",[Bae]:"fire-data-connect",[Vae]:"fire-rtdb-compat",[Hae]:"fire-fn",[Wae]:"fire-fn-compat",[zae]:"fire-iid",[Uae]:"fire-iid-compat",[jae]:"fire-fcm",[$ae]:"fire-fcm-compat",[qae]:"fire-perf",[Gae]:"fire-perf-compat",[Kae]:"fire-rc",[Yae]:"fire-rc-compat",[Qae]:"fire-gcs",[Xae]:"fire-gcs-compat",[Zae]:"fire-fst",[ele]:"fire-fst-compat",[Jae]:"fire-vertex","fire-js":"fire-js",[tle]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=new Map,sle=new Map,AA=new Map;function SH(s,e){try{s.container.addComponent(e)}catch(t){Qu.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function vL(s){const e=s.name;if(AA.has(e))return Qu.debug(`There were multiple attempts to register component ${e}.`),!1;AA.set(e,s);for(const t of wL.values())SH(t,s);for(const t of sle.values())SH(t,s);return!0}function rle(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function ole(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ale={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gd=new sK("app","Firebase",ale);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lle{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Xw("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gd.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cle=ile;function cK(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:RA,automaticDataCollectionEnabled:!0,...e},n=i.name;if(typeof n!="string"||!n)throw gd.create("bad-app-name",{appName:String(n)});if(t||(t=iK()),!t)throw gd.create("no-options");const r=wL.get(n);if(r){if(bL(t,r.options)&&bL(i,r.config))return r;throw gd.create("duplicate-app",{appName:n})}const o=new dae(n);for(const l of AA.values())o.addComponent(l);const a=new lle(t,i,o);return wL.set(n,a),a}function ule(s=RA){const e=wL.get(s);if(!e&&s===RA&&iK())return cK();if(!e)throw gd.create("no-app",{appName:s});return e}function k_(s,e,t){let i=nle[s]??s;t&&(i+=`-${t}`);const n=i.match(/\s|\//),r=e.match(/\s|\//);if(n||r){const o=[`Unable to register library "${i}" with version "${e}":`];n&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qu.warn(o.join(" "));return}vL(new Xw(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hle="firebase-heartbeat-database",dle=1,Zw="firebase-heartbeat-store";let TI=null;function uK(){return TI||(TI=Lae(hle,dle,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Zw)}catch(t){console.warn(t)}}}}).catch(s=>{throw gd.create("idb-open",{originalErrorMessage:s.message})})),TI}async function fle(s){try{const t=(await uK()).transaction(Zw),i=await t.objectStore(Zw).get(hK(s));return await t.done,i}catch(e){if(e instanceof SC)Qu.warn(e.message);else{const t=gd.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qu.warn(t.message)}}}async function xH(s,e){try{const i=(await uK()).transaction(Zw,"readwrite");await i.objectStore(Zw).put(e,hK(s)),await i.done}catch(t){if(t instanceof SC)Qu.warn(t.message);else{const i=gd.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Qu.warn(i.message)}}}function hK(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gle=1024,mle=30;class ple{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ble(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=LH();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>mle){const o=wle(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Qu.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=LH(),{heartbeatsToSend:i,unsentEntries:n}=_le(this._heartbeatsCache.heartbeats),r=pL(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return Qu.warn(t),""}}}function LH(){return new Date().toISOString().substring(0,10)}function _le(s,e=gle){const t=[];let i=s.slice();for(const n of s){const r=t.find(o=>o.agent===n.agent);if(r){if(r.dates.push(n.date),kH(t)>e){r.dates.pop();break}}else if(t.push({agent:n.agent,dates:[n.date]}),kH(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class ble{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Joe()?eae().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await fle(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xH(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xH(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function kH(s){return pL(JSON.stringify({version:2,heartbeats:s})).length}function wle(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vle(s){vL(new Xw("platform-logger",e=>new Dae(e),"PRIVATE")),vL(new Xw("heartbeat",e=>new ple(e),"PRIVATE")),k_(IA,yH,s),k_(IA,yH,"esm2020"),k_("fire-js","")}vle("");var EH={};const DH="@firebase/database",TH="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dK="";function Cle(s){dK=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yle{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),xs(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Qw(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sle{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return nh(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fK=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const e=window[s];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new yle(e)}}catch{}return new Sle},ng=fK("localStorage"),xle=fK("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_=new oK("@firebase/database"),Lle=(function(){let s=1;return function(){return s++}})(),gK=function(s){const e=lae(s),t=new aae;t.update(e);const i=t.digest();return _P.encodeByteArray(i)},xC=function(...s){let e="";for(let t=0;t<s.length;t++){const i=s[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=xC.apply(null,i):typeof i=="object"?e+=xs(i):e+=i,e+=" "}return e};let W0=null,NH=!0;const kle=function(s,e){je(!0,"Can't turn on custom loggers persistently."),E_.logLevel=ln.VERBOSE,W0=E_.log.bind(E_)},kr=function(...s){if(NH===!0&&(NH=!1,W0===null&&xle.get("logging_enabled")===!0&&kle()),W0){const e=xC.apply(null,s);W0(e)}},LC=function(s){return function(...e){kr(s,...e)}},MA=function(...s){const e="FIREBASE INTERNAL ERROR: "+xC(...s);E_.error(e)},Xu=function(...s){const e=`FIREBASE FATAL ERROR: ${xC(...s)}`;throw E_.error(e),new Error(e)},ko=function(...s){const e="FIREBASE WARNING: "+xC(...s);E_.warn(e)},Ele=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ko("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},mK=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},Dle=function(s){if(document.readyState==="complete")s();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},o1="[MIN_NAME]",$g="[MAX_NAME]",H1=function(s,e){if(s===e)return 0;if(s===o1||e===$g)return-1;if(e===o1||s===$g)return 1;{const t=IH(s),i=IH(e);return t!==null?i!==null?t-i===0?s.length-e.length:t-i:-1:i!==null?1:s<e?-1:1}},Tle=function(s,e){return s===e?0:s<e?-1:1},Zb=function(s,e){if(e&&s in e)return e[s];throw new Error("Missing required key ("+s+") in object: "+xs(e))},CP=function(s){if(typeof s!="object"||s===null)return xs(s);const e=[];for(const i in s)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=xs(e[i]),t+=":",t+=CP(s[e[i]]);return t+="}",t},pK=function(s,e){const t=s.length;if(t<=e)return[s];const i=[];for(let n=0;n<t;n+=e)n+e>t?i.push(s.substring(n,t)):i.push(s.substring(n,n+e));return i};function No(s,e){for(const t in s)s.hasOwnProperty(t)&&e(t,s[t])}const _K=function(s){je(!mK(s),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let n,r,o,a,l;s===0?(r=0,o=0,n=1/s===-1/0?1:0):(n=s<0,s=Math.abs(s),s>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(s)/Math.LN2),i),r=a+i,o=Math.round(s*Math.pow(2,t-a)-Math.pow(2,t))):(r=0,o=Math.round(s/Math.pow(2,1-i-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(n?1:0),c.reverse();const h=c.join("");let d="";for(l=0;l<64;l+=8){let g=parseInt(h.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),d=d+g}return d.toLowerCase()},Nle=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Ile=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Rle(s,e){let t="Unknown Error";s==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?t="Client doesn't have permission to access the desired data.":s==="unavailable"&&(t="The service is unavailable");const i=new Error(s+" at "+e._path.toString()+": "+t);return i.code=s.toUpperCase(),i}const Ale=new RegExp("^-?(0*)\\d{1,10}$"),Mle=-2147483648,Ole=2147483647,IH=function(s){if(Ale.test(s)){const e=Number(s);if(e>=Mle&&e<=Ole)return e}return null},W1=function(s){try{s()}catch(e){setTimeout(()=>{const t=e.stack||"";throw ko("Exception was thrown by user callback.",t),e},Math.floor(0))}},Ple=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},z0=function(s,e){const t=setTimeout(s,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fle{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,ole(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){ko(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ble{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(n=>this.auth_=n)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(kr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ko(e)}}class Px{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Px.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="5",bK="v",wK="s",vK="r",CK="f",yK=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,SK="ls",xK="p",OA="ac",LK="websocket",kK="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EK{constructor(e,t,i,n,r=!1,o="",a=!1,l=!1,c=null){this.secure=t,this.namespace=i,this.webSocketOnly=n,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ng.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ng.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Vle(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function DK(s,e,t){je(typeof e=="string","typeof type must == string"),je(typeof t=="object","typeof params must == object");let i;if(e===LK)i=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(e===kK)i=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Vle(s)&&(t.ns=s.namespace);const n=[];return No(t,(r,o)=>{n.push(r+"="+o)}),i+n.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hle{constructor(){this.counters_={}}incrementCounter(e,t=1){nh(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Foe(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI={},II={};function SP(s){const e=s.toString();return NI[e]||(NI[e]=new Hle),NI[e]}function Wle(s,e){const t=s.toString();return II[t]||(II[t]=e()),II[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zle{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let n=0;n<i.length;++n)i[n]&&W1(()=>{this.onMessage_(i[n])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RH="start",Ule="close",jle="pLPCommand",$le="pRTLPCB",TK="id",NK="pw",IK="ser",qle="cb",Gle="seg",Kle="ts",Yle="d",Qle="dframe",RK=1870,AK=30,Xle=RK-AK,Zle=25e3,Jle=3e4;class Kp{constructor(e,t,i,n,r,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=n,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=LC(e),this.stats_=SP(t),this.urlFn=l=>(this.appCheckToken&&(l[OA]=this.appCheckToken),DK(t,kK,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new zle(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Jle)),Dle(()=>{if(this.isClosed_)return;this.scriptTagHolder=new xP((...r)=>{const[o,a,l,c,h]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===RH)this.id=a,this.password=l;else if(o===Ule)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[RH]="t",i[IK]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[qle]=this.scriptTagHolder.uniqueCallbackIdentifier),i[bK]=yP,this.transportSessionId&&(i[wK]=this.transportSessionId),this.lastSessionId&&(i[SK]=this.lastSessionId),this.applicationId&&(i[xK]=this.applicationId),this.appCheckToken&&(i[OA]=this.appCheckToken),typeof location<"u"&&location.hostname&&yK.test(location.hostname)&&(i[vK]=CK);const n=this.urlFn(i);this.log_("Connecting via long-poll to "+n),this.scriptTagHolder.addTag(n,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Kp.forceAllow_=!0}static forceDisallow(){Kp.forceDisallow_=!0}static isAvailable(){return Kp.forceAllow_?!0:!Kp.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Nle()&&!Ile()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=xs(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=JG(t),n=pK(i,Xle);for(let r=0;r<n.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Qle]="t",i[TK]=e,i[NK]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=xs(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class xP{constructor(e,t,i,n){this.onDisconnect=i,this.urlFn=n,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Lle(),window[jle+this.uniqueCallbackIdentifier]=e,window[$le+this.uniqueCallbackIdentifier]=t,this.myIFrame=xP.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){kr("frame writing exception"),a.stack&&kr(a.stack),kr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||kr("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[TK]=this.myID,e[NK]=this.myPW,e[IK]=this.currentSerial;let t=this.urlFn(e),i="",n=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+AK+i.length<=RK;){const o=this.pendingSegs.shift();i=i+"&"+Gle+n+"="+o.seg+"&"+Kle+n+"="+o.ts+"&"+Yle+n+"="+o.d,n++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},n=setTimeout(i,Math.floor(Zle)),r=()=>{clearTimeout(n),i()};this.addTag(e,r)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const n=i.readyState;(!n||n==="loaded"||n==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{kr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ece=16384,tce=45e3;let CL=null;typeof MozWebSocket<"u"?CL=MozWebSocket:typeof WebSocket<"u"&&(CL=WebSocket);class al{constructor(e,t,i,n,r,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=n,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=LC(this.connId),this.stats_=SP(t),this.connURL=al.connectionURL_(t,o,a,n,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,n,r){const o={};return o[bK]=yP,typeof location<"u"&&location.hostname&&yK.test(location.hostname)&&(o[vK]=CK),t&&(o[wK]=t),i&&(o[SK]=i),n&&(o[OA]=n),r&&(o[xK]=r),DK(e,LK,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ng.set("previous_websocket_failure",!0);try{let i;Zoe(),this.mySock=new CL(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const n=i.message||i.data;n&&this.log_(n),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const n=i.message||i.data;n&&this.log_(n),this.onClosed_()}}start(){}static forceDisallow(){al.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&CL!==null&&!al.forceDisallow_}static previouslyFailed(){return ng.isInMemoryStorage||ng.get("previous_websocket_failure")===!0}markConnectionHealthy(){ng.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=Qw(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(je(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=xs(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=pK(t,ece);i.length>1&&this.sendString_(String(i.length));for(let n=0;n<i.length;n++)this.sendString_(i[n])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(tce))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}al.responsesRequiredToBeHealthy=2;al.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{static get ALL_TRANSPORTS(){return[Kp,al]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=al&&al.isAvailable();let i=t&&!al.previouslyFailed();if(e.webSocketOnly&&(t||ko("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[al];else{const n=this.transports_=[];for(const r of Jw.ALL_TRANSPORTS)r&&r.isAvailable()&&n.push(r);Jw.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Jw.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ice=6e4,nce=5e3,sce=10*1024,rce=100*1024,RI="t",AH="d",oce="s",MH="r",ace="e",OH="o",PH="a",FH="n",BH="p",lce="h";class cce{constructor(e,t,i,n,r,o,a,l,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=n,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=LC("c:"+this.id+":"),this.transportManager_=new Jw(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const n=e.healthyTimeout||0;n>0&&(this.healthyTimeout_=z0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>rce?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>sce?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(n)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(RI in e){const t=e[RI];t===PH?this.upgradeIfSecondaryHealthy_():t===MH?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===OH&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Zb("t",e),i=Zb("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:BH,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:PH,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:FH,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Zb("t",e),i=Zb("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Zb(RI,e);if(AH in e){const i=e[AH];if(t===lce){const n={...i};this.repoInfo_.isUsingEmulator&&(n.h=this.repoInfo_.host),this.onHandshake_(n)}else if(t===FH){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===oce?this.onConnectionShutdown_(i):t===MH?this.onReset_(i):t===ace?MA("Server Error: "+i):t===OH?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):MA("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.host=n,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),yP!==i&&ko("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),z0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ice))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):z0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(nce))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:BH,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ng.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MK{put(e,t,i,n){}merge(e,t,i,n){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(e){this.allowedEvents_=e,this.listeners_={},je(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let n=0;n<i.length;n++)i[n].callback.apply(i[n].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const n=this.getInitialEvent(e);n&&t.apply(i,n)}off(e,t,i){this.validateEventType_(e);const n=this.listeners_[e]||[];for(let r=0;r<n.length;r++)if(n[r].callback===t&&(!i||i===n[r].context)){n.splice(r,1);return}}validateEventType_(e){je(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL extends OK{static getInstance(){return new yL}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!nK()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return je(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VH=32,HH=768;class sn{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[i]=this.pieces_[n],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function ki(){return new sn("")}function Yt(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function Ld(s){return s.pieces_.length-s.pieceNum_}function cn(s){let e=s.pieceNum_;return e<s.pieces_.length&&e++,new sn(s.pieces_,e)}function PK(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function uce(s){let e="";for(let t=s.pieceNum_;t<s.pieces_.length;t++)s.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(s.pieces_[t])));return e||"/"}function FK(s,e=0){return s.pieces_.slice(s.pieceNum_+e)}function BK(s){if(s.pieceNum_>=s.pieces_.length)return null;const e=[];for(let t=s.pieceNum_;t<s.pieces_.length-1;t++)e.push(s.pieces_[t]);return new sn(e,0)}function Ls(s,e){const t=[];for(let i=s.pieceNum_;i<s.pieces_.length;i++)t.push(s.pieces_[i]);if(e instanceof sn)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let n=0;n<i.length;n++)i[n].length>0&&t.push(i[n])}return new sn(t,0)}function ii(s){return s.pieceNum_>=s.pieces_.length}function Ur(s,e){const t=Yt(s),i=Yt(e);if(t===null)return e;if(t===i)return Ur(cn(s),cn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+s+")")}function LP(s,e){if(Ld(s)!==Ld(e))return!1;for(let t=s.pieceNum_,i=e.pieceNum_;t<=s.pieces_.length;t++,i++)if(s.pieces_[t]!==e.pieces_[i])return!1;return!0}function cl(s,e){let t=s.pieceNum_,i=e.pieceNum_;if(Ld(s)>Ld(e))return!1;for(;t<s.pieces_.length;){if(s.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class hce{constructor(e,t){this.errorPrefix_=t,this.parts_=FK(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=PE(this.parts_[i]);VK(this)}}function dce(s,e){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(e),s.byteLength_+=PE(e),VK(s)}function fce(s){const e=s.parts_.pop();s.byteLength_-=PE(e),s.parts_.length>0&&(s.byteLength_-=1)}function VK(s){if(s.byteLength_>HH)throw new Error(s.errorPrefix_+"has a key path longer than "+HH+" bytes ("+s.byteLength_+").");if(s.parts_.length>VH)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+VH+") or object contains a cycle "+yf(s))}function yf(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP extends OK{static getInstance(){return new kP}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return je(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb=1e3,gce=300*1e3,WH=30*1e3,mce=1.3,pce=3e4,_ce="server_kill",zH=3;class Hu extends MK{constructor(e,t,i,n,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=n,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Hu.nextPersistentConnectionId_++,this.log_=LC("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Jb,this.maxReconnectDelay_=gce,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");kP.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&yL.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const n=++this.requestNumber_,r={r:n,a:e,b:t};this.log_(xs(r)),je(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[n]=i)}get(e){this.initConnection_();const t=new OE,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,i,n){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),je(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),je(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:n,hashFn:t,query:e,tag:i};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),n=t._queryIdentifier;this.log_("Listen on "+i+" for "+n);const r={p:i},o="q";e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;Hu.warnOnListenWarnings_(l,t),(this.listens.get(i)&&this.listens.get(i).get(n))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,n),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&nh(e,"w")){const i=r1(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const n='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString();ko(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${n} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||rae(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=WH)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=sae(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,n=>{const r=n.s,o=n.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),n=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+n),je(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,n)&&this.connected_&&this.sendUnlisten_(i,n,e._queryObject,t)}sendUnlisten_(e,t,i,n){this.log_("Unlisten on "+e+" for "+t);const r={p:e},o="n";n&&(r.q=i,r.t=n),this.sendRequest(o,r)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,n){const r={p:t,d:i};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{n&&setTimeout(()=>{n(o.s,o.d)},Math.floor(0))})}put(e,t,i,n){this.putInternal("p",e,t,i,n)}merge(e,t,i,n){this.putInternal("m",e,t,i,n)}putInternal(e,t,i,n,r){this.initConnection_();const o={p:t,d:i};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:n}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,n=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,r=>{this.log_(t+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),n&&n(r.s,r.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const r=i.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+xs(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):MA("Unrecognized action received from server: "+xs(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){je(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Jb,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Jb,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>pce&&(this.reconnectDelay_=Jb),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*mce)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),n=this.id+":"+Hu.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},c=function(d){je(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,g]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?kr("getToken() completed but was canceled"):(kr("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=g&&g.token,a=new cce(n,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,p=>{ko(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(_ce)},r))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&ko(d),l())}}}interrupt(e){kr("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){kr("Resuming connection for reason: "+e),delete this.interruptReasons_[e],_H(this.interruptReasons_)&&(this.reconnectDelay_=Jb,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(r=>CP(r)).join("$"):i="default";const n=this.removeListen_(e,i);n&&n.onComplete&&n.onComplete("permission_denied")}removeListen_(e,t){const i=new sn(e).toString();let n;if(this.listens.has(i)){const r=this.listens.get(i);n=r.get(t),r.delete(t),r.size===0&&this.listens.delete(i)}else n=void 0;return n}onAuthRevoked_(e,t){kr("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=zH&&(this.reconnectDelay_=WH,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){kr("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=zH&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+dK.replace(/\./g,"-")]=1,nK()?e["framework.cordova"]=1:Xoe()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=yL.getInstance().currentlyOnline();return _H(this.interruptReasons_)&&e}}Hu.nextPersistentConnectionId_=0;Hu.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Qt(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Qt(o1,e),n=new Qt(o1,t);return this.compare(i,n)!==0}minPost(){return Qt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RS;class HK extends FE{static get __EMPTY_NODE(){return RS}static set __EMPTY_NODE(e){RS=e}compare(e,t){return H1(e.name,t.name)}isDefinedOn(e){throw B1("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Qt.MIN}maxPost(){return new Qt($g,RS)}makePost(e,t){return je(typeof e=="string","KeyIndex indexValue must always be a string."),new Qt(e,RS)}toString(){return".key"}}const D_=new HK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,t,i,n,r=null){this.isReverse_=n,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,n&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Us{constructor(e,t,i,n,r){this.key=e,this.value=t,this.color=i??Us.RED,this.left=n??Co.EMPTY_NODE,this.right=r??Co.EMPTY_NODE}copy(e,t,i,n,r){return new Us(e??this.key,t??this.value,i??this.color,n??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let n=this;const r=i(e,n.key);return r<0?n=n.copy(null,null,null,n.left.insert(e,t,i),null):r===0?n=n.copy(null,t,null,null,null):n=n.copy(null,null,null,null,n.right.insert(e,t,i)),n.fixUp_()}removeMin_(){if(this.left.isEmpty())return Co.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,n;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Co.EMPTY_NODE;n=i.right.min_(),i=i.copy(n.key,n.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Us.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Us.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Us.RED=!0;Us.BLACK=!1;class bce{copy(e,t,i,n,r){return this}insert(e,t,i){return new Us(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Co{constructor(e,t=Co.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Co(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Us.BLACK,null,null))}remove(e){return new Co(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Us.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,n=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return n?n.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(n=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new AS(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new AS(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new AS(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new AS(this.root_,null,this.comparator_,!0,e)}}Co.EMPTY_NODE=new bce;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wce(s,e){return H1(s.name,e.name)}function EP(s,e){return H1(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PA;function vce(s){PA=s}const WK=function(s){return typeof s=="number"?"number:"+_K(s):"string:"+s},zK=function(s){if(s.isLeafNode()){const e=s.val();je(typeof e=="string"||typeof e=="number"||typeof e=="object"&&nh(e,".sv"),"Priority must be a string or number.")}else je(s===PA||s.isEmpty(),"priority of unexpected type.");je(s===PA||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UH;class Vs{static set __childrenNodeConstructor(e){UH=e}static get __childrenNodeConstructor(){return UH}constructor(e,t=Vs.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,je(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),zK(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Vs(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Vs.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ii(e)?this:Yt(e)===".priority"?this.priorityNode_:Vs.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Vs.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Yt(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(je(i!==".priority"||Ld(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Vs.__childrenNodeConstructor.EMPTY_NODE.updateChild(cn(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+WK(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=_K(this.value_):e+=this.value_,this.lazyHash_=gK(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Vs.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Vs.__childrenNodeConstructor?-1:(je(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,n=Vs.VALUE_TYPE_ORDER.indexOf(t),r=Vs.VALUE_TYPE_ORDER.indexOf(i);return je(n>=0,"Unknown leaf type: "+t),je(r>=0,"Unknown leaf type: "+i),n===r?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-n}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Vs.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UK,jK;function Cce(s){UK=s}function yce(s){jK=s}class Sce extends FE{compare(e,t){const i=e.node.getPriority(),n=t.node.getPriority(),r=i.compareTo(n);return r===0?H1(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Qt.MIN}maxPost(){return new Qt($g,new Vs("[PRIORITY-POST]",jK))}makePost(e,t){const i=UK(e);return new Qt(t,new Vs("[PRIORITY-POST]",i))}toString(){return".priority"}}const $n=new Sce;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xce=Math.log(2);class Lce{constructor(e){const t=r=>parseInt(Math.log(r)/xce,10),i=r=>parseInt(Array(r+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const n=i(this.count);this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const SL=function(s,e,t,i){s.sort(e);const n=function(l,c){const h=c-l;let d,g;if(h===0)return null;if(h===1)return d=s[l],g=t?t(d):d,new Us(g,d.node,Us.BLACK,null,null);{const p=parseInt(h/2,10)+l,_=n(l,p),b=n(p+1,c);return d=s[p],g=t?t(d):d,new Us(g,d.node,Us.BLACK,_,b)}},r=function(l){let c=null,h=null,d=s.length;const g=function(_,b){const C=d-_,x=d;d-=_;const S=n(C+1,x),y=s[C],k=t?t(y):y;p(new Us(k,y.node,b,null,S))},p=function(_){c?(c.left=_,c=_):(h=_,c=_)};for(let _=0;_<l.count;++_){const b=l.nextBitIsOne(),C=Math.pow(2,l.count-(_+1));b?g(C,Us.BLACK):(g(C,Us.BLACK),g(C,Us.RED))}return h},o=new Lce(s.length),a=r(o);return new Co(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AI;const Lp={};class Ru{static get Default(){return je(Lp&&$n,"ChildrenNode.ts has not been loaded"),AI=AI||new Ru({".priority":Lp},{".priority":$n}),AI}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=r1(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Co?t:null}hasIndex(e){return nh(this.indexSet_,e.toString())}addIndex(e,t){je(e!==D_,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let n=!1;const r=t.getIterator(Qt.Wrap);let o=r.getNext();for(;o;)n=n||e.isDefinedOn(o.node),i.push(o),o=r.getNext();let a;n?a=SL(i,e.getCompare()):a=Lp;const l=e.toString(),c={...this.indexSet_};c[l]=e;const h={...this.indexes_};return h[l]=a,new Ru(h,c)}addToIndexes(e,t){const i=_L(this.indexes_,(n,r)=>{const o=r1(this.indexSet_,r);if(je(o,"Missing index implementation for "+r),n===Lp)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(Qt.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),SL(a,o.getCompare())}else return Lp;else{const a=t.get(e.name);let l=n;return a&&(l=l.remove(new Qt(e.name,a))),l.insert(e,e.node)}});return new Ru(i,this.indexSet_)}removeFromIndexes(e,t){const i=_L(this.indexes_,n=>{if(n===Lp)return n;{const r=t.get(e.name);return r?n.remove(new Qt(e.name,r)):n}});return new Ru(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e0;class St{static get EMPTY_NODE(){return e0||(e0=new St(new Co(EP),null,Ru.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&zK(this.priorityNode_),this.children_.isEmpty()&&je(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||e0}updatePriority(e){return this.children_.isEmpty()?this:new St(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?e0:t}}getChild(e){const t=Yt(e);return t===null?this:this.getImmediateChild(t).getChild(cn(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(je(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new Qt(e,t);let n,r;t.isEmpty()?(n=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(i,this.children_)):(n=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(i,this.children_));const o=n.isEmpty()?e0:this.priorityNode_;return new St(n,o,r)}}updateChild(e,t){const i=Yt(e);if(i===null)return t;{je(Yt(e)!==".priority"||Ld(e)===1,".priority must be the last token in a path");const n=this.getImmediateChild(i).updateChild(cn(e),t);return this.updateImmediateChild(i,n)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,n=0,r=!0;if(this.forEachChild($n,(o,a)=>{t[o]=a.val(e),i++,r&&St.INTEGER_REGEXP_.test(o)?n=Math.max(n,Number(o)):r=!1}),!e&&r&&n<2*i){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+WK(this.getPriority().val())+":"),this.forEachChild($n,(t,i)=>{const n=i.hash();n!==""&&(e+=":"+t+":"+n)}),this.lazyHash_=e===""?"":gK(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const n=this.resolveIndex_(i);if(n){const r=n.getPredecessorKey(new Qt(e,t));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Qt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Qt(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(n=>t(n.name,n.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,n=>n);{const n=this.children_.getIteratorFrom(e.name,Qt.Wrap);let r=n.peek();for(;r!=null&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,n=>n);{const n=this.children_.getReverseIteratorFrom(e.name,Qt.Wrap);let r=n.peek();for(;r!=null&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===kC?-1:0}withIndex(e){if(e===D_||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new St(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===D_||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator($n),n=t.getIterator($n);let r=i.getNext(),o=n.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=i.getNext(),o=n.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===D_?null:this.indexMap_.get(e.toString())}}St.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class kce extends St{constructor(){super(new Co(EP),St.EMPTY_NODE,Ru.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return St.EMPTY_NODE}isEmpty(){return!1}}const kC=new kce;Object.defineProperties(Qt,{MIN:{value:new Qt(o1,St.EMPTY_NODE)},MAX:{value:new Qt($g,kC)}});HK.__EMPTY_NODE=St.EMPTY_NODE;Vs.__childrenNodeConstructor=St;vce(kC);yce(kC);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ece=!0;function qs(s,e=null){if(s===null)return St.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(e=s[".priority"]),je(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const t=s;return new Vs(t,qs(e))}if(!(s instanceof Array)&&Ece){const t=[];let i=!1;if(No(s,(o,a)=>{if(o.substring(0,1)!=="."){const l=qs(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new Qt(o,l)))}}),t.length===0)return St.EMPTY_NODE;const r=SL(t,wce,o=>o.name,EP);if(i){const o=SL(t,$n.getCompare());return new St(r,qs(e),new Ru({".priority":o},{".priority":$n}))}else return new St(r,qs(e),Ru.Default)}else{let t=St.EMPTY_NODE;return No(s,(i,n)=>{if(nh(s,i)&&i.substring(0,1)!=="."){const r=qs(n);(r.isLeafNode()||!r.isEmpty())&&(t=t.updateImmediateChild(i,r))}}),t.updatePriority(qs(e))}}Cce(qs);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dce extends FE{constructor(e){super(),this.indexPath_=e,je(!ii(e)&&Yt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),n=this.extractChild(t.node),r=i.compareTo(n);return r===0?H1(e.name,t.name):r}makePost(e,t){const i=qs(e),n=St.EMPTY_NODE.updateChild(this.indexPath_,i);return new Qt(t,n)}maxPost(){const e=St.EMPTY_NODE.updateChild(this.indexPath_,kC);return new Qt($g,e)}toString(){return FK(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tce extends FE{compare(e,t){const i=e.node.compareTo(t.node);return i===0?H1(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Qt.MIN}maxPost(){return Qt.MAX}makePost(e,t){const i=qs(e);return new Qt(t,i)}toString(){return".value"}}const Nce=new Tce;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $K(s){return{type:"value",snapshotNode:s}}function a1(s,e){return{type:"child_added",snapshotNode:e,childName:s}}function ev(s,e){return{type:"child_removed",snapshotNode:e,childName:s}}function tv(s,e,t){return{type:"child_changed",snapshotNode:e,childName:s,oldSnap:t}}function Ice(s,e){return{type:"child_moved",snapshotNode:e,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.index_=e}updateChild(e,t,i,n,r,o){je(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(n).equals(i.getChild(n))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(ev(t,a)):je(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(a1(t,i)):o.trackChildChange(tv(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild($n,(n,r)=>{t.hasChild(n)||i.trackChildChange(ev(n,r))}),t.isLeafNode()||t.forEachChild($n,(n,r)=>{if(e.hasChild(n)){const o=e.getImmediateChild(n);o.equals(r)||i.trackChildChange(tv(n,r,o))}else i.trackChildChange(a1(n,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?St.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e){this.indexedFilter_=new DP(e.getIndex()),this.index_=e.getIndex(),this.startPost_=iv.getStartPost_(e),this.endPost_=iv.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,n,r,o){return this.matches(new Qt(t,i))||(i=St.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,n,r,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=St.EMPTY_NODE);let n=t.withIndex(this.index_);n=n.updatePriority(St.EMPTY_NODE);const r=this;return t.forEachChild($n,(o,a)=>{r.matches(new Qt(o,a))||(n=n.updateImmediateChild(o,St.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rce{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new iv(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,n,r,o){return this.rangedFilter_.matches(new Qt(t,i))||(i=St.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,n,r,o):this.fullLimitUpdateChild_(e,t,i,r,o)}updateFullNode(e,t,i){let n;if(t.isLeafNode()||t.isEmpty())n=St.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){n=St.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))n=n.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{n=t.withIndex(this.index_),n=n.updatePriority(St.EMPTY_NODE);let r;this.reverse_?r=n.getReverseIterator(this.index_):r=n.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:n=n.updateImmediateChild(a.name,St.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,n,r){let o;if(this.reverse_){const d=this.index_.getCompare();o=(g,p)=>d(p,g)}else o=this.index_.getCompare();const a=e;je(a.numChildren()===this.limit_,"");const l=new Qt(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(t)){const d=a.getImmediateChild(t);let g=n.getChildAfterChild(this.index_,c,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=n.getChildAfterChild(this.index_,g,this.reverse_);const p=g==null?1:o(g,l);if(h&&!i.isEmpty()&&p>=0)return r!=null&&r.trackChildChange(tv(t,i,d)),a.updateImmediateChild(t,i);{r!=null&&r.trackChildChange(ev(t,d));const b=a.updateImmediateChild(t,St.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(r!=null&&r.trackChildChange(a1(g.name,g.node)),b.updateImmediateChild(g.name,g.node)):b}}else return i.isEmpty()?e:h&&o(c,l)>=0?(r!=null&&(r.trackChildChange(ev(c.name,c.node)),r.trackChildChange(a1(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,St.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$n}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return je(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return je(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:o1}hasEnd(){return this.endSet_}getIndexEndValue(){return je(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return je(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$g}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return je(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$n}copy(){const e=new TP;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ace(s){return s.loadsAllData()?new DP(s.getIndex()):s.hasLimit()?new Rce(s):new iv(s)}function jH(s){const e={};if(s.isDefault())return e;let t;if(s.index_===$n?t="$priority":s.index_===Nce?t="$value":s.index_===D_?t="$key":(je(s.index_ instanceof Dce,"Unrecognized index type!"),t=s.index_.toString()),e.orderBy=xs(t),s.startSet_){const i=s.startAfterSet_?"startAfter":"startAt";e[i]=xs(s.indexStartValue_),s.startNameSet_&&(e[i]+=","+xs(s.indexStartName_))}if(s.endSet_){const i=s.endBeforeSet_?"endBefore":"endAt";e[i]=xs(s.indexEndValue_),s.endNameSet_&&(e[i]+=","+xs(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?e.limitToFirst=s.limit_:e.limitToLast=s.limit_),e}function $H(s){const e={};if(s.startSet_&&(e.sp=s.indexStartValue_,s.startNameSet_&&(e.sn=s.indexStartName_),e.sin=!s.startAfterSet_),s.endSet_&&(e.ep=s.indexEndValue_,s.endNameSet_&&(e.en=s.indexEndName_),e.ein=!s.endBeforeSet_),s.limitSet_){e.l=s.limit_;let t=s.viewFrom_;t===""&&(s.isViewFromLeft()?t="l":t="r"),e.vf=t}return s.index_!==$n&&(e.i=s.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL extends MK{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(je(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,n){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=n,this.log_=LC("p:rest:"),this.listens_={}}listen(e,t,i,n){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=xL.getListenId_(e,i),a={};this.listens_[o]=a;const l=jH(e._queryParams);this.restRequest_(r+".json",l,(c,h)=>{let d=h;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(r,d,!1,i),r1(this.listens_,o)===a){let g;c?c===401?g="permission_denied":g="rest_error:"+c:g="ok",n(g,null)}})}unlisten(e,t){const i=xL.getListenId_(e,t);delete this.listens_[i]}get(e){const t=jH(e._queryParams),i=e._path.toString(),n=new OE;return this.restRequest_(i+".json",t,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(i,a,!1,null),n.resolve(a)):n.reject(new Error(a))}),n.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([n,r])=>{n&&n.accessToken&&(t.auth=n.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+oae(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Qw(a.responseText)}catch{ko("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&ko("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mce{constructor(){this.rootNode_=St.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LL(){return{value:null,children:new Map}}function qK(s,e,t){if(ii(e))s.value=t,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(e,t);else{const i=Yt(e);s.children.has(i)||s.children.set(i,LL());const n=s.children.get(i);e=cn(e),qK(n,e,t)}}function FA(s,e,t){s.value!==null?t(e,s.value):Oce(s,(i,n)=>{const r=new sn(e.toString()+"/"+i);FA(n,r,t)})}function Oce(s,e){s.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pce{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&No(this.last_,(i,n)=>{t[i]=t[i]-n}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qH=10*1e3,Fce=30*1e3,Bce=300*1e3;class Vce{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pce(e);const i=qH+(Fce-qH)*Math.random();z0(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;No(e,(n,r)=>{r>0&&nh(this.statsToReport_,n)&&(t[n]=r,i=!0)}),i&&this.server_.reportStats(t),z0(this.reportStats_.bind(this),Math.floor(Math.random()*2*Bce))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ul;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ul||(ul={}));function GK(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function NP(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function IP(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=ul.ACK_USER_WRITE,this.source=GK()}operationForChild(e){if(ii(this.path)){if(this.affectedTree.value!=null)return je(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new sn(e));return new kL(ki(),t,this.revert)}}else return je(Yt(this.path)===e,"operationForChild called for unrelated child."),new kL(cn(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t){this.source=e,this.path=t,this.type=ul.LISTEN_COMPLETE}operationForChild(e){return ii(this.path)?new nv(this.source,ki()):new nv(this.source,cn(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=ul.OVERWRITE}operationForChild(e){return ii(this.path)?new qg(this.source,ki(),this.snap.getImmediateChild(e)):new qg(this.source,cn(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=ul.MERGE}operationForChild(e){if(ii(this.path)){const t=this.children.subtree(new sn(e));return t.isEmpty()?null:t.value?new qg(this.source,ki(),t.value):new sv(this.source,ki(),t)}else return je(Yt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new sv(this.source,cn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ii(e))return this.isFullyInitialized()&&!this.filtered_;const t=Yt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hce{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Wce(s,e,t,i){const n=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&s.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(Ice(o.childName,o.snapshotNode))}),t0(s,n,"child_removed",e,i,t),t0(s,n,"child_added",e,i,t),t0(s,n,"child_moved",r,i,t),t0(s,n,"child_changed",e,i,t),t0(s,n,"value",e,i,t),n}function t0(s,e,t,i,n,r){const o=i.filter(a=>a.type===t);o.sort((a,l)=>Uce(s,a,l)),o.forEach(a=>{const l=zce(s,a,r);n.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,s.query_))})})}function zce(s,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,s.index_)),e}function Uce(s,e,t){if(e.childName==null||t.childName==null)throw B1("Should only compare child_ events.");const i=new Qt(e.childName,e.snapshotNode),n=new Qt(t.childName,t.snapshotNode);return s.index_.compare(i,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(s,e){return{eventCache:s,serverCache:e}}function U0(s,e,t,i){return BE(new kd(e,t,i),s.serverCache)}function KK(s,e,t,i){return BE(s.eventCache,new kd(e,t,i))}function EL(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function Gg(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MI;const jce=()=>(MI||(MI=new Co(Tle)),MI);class mn{static fromObject(e){let t=new mn(null);return No(e,(i,n)=>{t=t.set(new sn(i),n)}),t}constructor(e,t=jce()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:ki(),value:this.value};if(ii(e))return null;{const i=Yt(e),n=this.children.get(i);if(n!==null){const r=n.findRootMostMatchingPathAndValue(cn(e),t);return r!=null?{path:Ls(new sn(i),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ii(e))return this;{const t=Yt(e),i=this.children.get(t);return i!==null?i.subtree(cn(e)):new mn(null)}}set(e,t){if(ii(e))return new mn(t,this.children);{const i=Yt(e),r=(this.children.get(i)||new mn(null)).set(cn(e),t),o=this.children.insert(i,r);return new mn(this.value,o)}}remove(e){if(ii(e))return this.children.isEmpty()?new mn(null):new mn(null,this.children);{const t=Yt(e),i=this.children.get(t);if(i){const n=i.remove(cn(e));let r;return n.isEmpty()?r=this.children.remove(t):r=this.children.insert(t,n),this.value===null&&r.isEmpty()?new mn(null):new mn(this.value,r)}else return this}}get(e){if(ii(e))return this.value;{const t=Yt(e),i=this.children.get(t);return i?i.get(cn(e)):null}}setTree(e,t){if(ii(e))return t;{const i=Yt(e),r=(this.children.get(i)||new mn(null)).setTree(cn(e),t);let o;return r.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,r),new mn(this.value,o)}}fold(e){return this.fold_(ki(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((n,r)=>{i[n]=r.fold_(Ls(e,n),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,ki(),t)}findOnPath_(e,t,i){const n=this.value?i(t,this.value):!1;if(n)return n;if(ii(e))return null;{const r=Yt(e),o=this.children.get(r);return o?o.findOnPath_(cn(e),Ls(t,r),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ki(),t)}foreachOnPath_(e,t,i){if(ii(e))return this;{this.value&&i(t,this.value);const n=Yt(e),r=this.children.get(n);return r?r.foreachOnPath_(cn(e),Ls(t,n),i):new mn(null)}}foreach(e){this.foreach_(ki(),e)}foreach_(e,t){this.children.inorderTraversal((i,n)=>{n.foreach_(Ls(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.writeTree_=e}static empty(){return new dl(new mn(null))}}function j0(s,e,t){if(ii(e))return new dl(new mn(t));{const i=s.writeTree_.findRootMostValueAndPath(e);if(i!=null){const n=i.path;let r=i.value;const o=Ur(n,e);return r=r.updateChild(o,t),new dl(s.writeTree_.set(n,r))}else{const n=new mn(t),r=s.writeTree_.setTree(e,n);return new dl(r)}}}function GH(s,e,t){let i=s;return No(t,(n,r)=>{i=j0(i,Ls(e,n),r)}),i}function KH(s,e){if(ii(e))return dl.empty();{const t=s.writeTree_.setTree(e,new mn(null));return new dl(t)}}function BA(s,e){return bm(s,e)!=null}function bm(s,e){const t=s.writeTree_.findRootMostValueAndPath(e);return t!=null?s.writeTree_.get(t.path).getChild(Ur(t.path,e)):null}function YH(s){const e=[],t=s.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild($n,(i,n)=>{e.push(new Qt(i,n))}):s.writeTree_.children.inorderTraversal((i,n)=>{n.value!=null&&e.push(new Qt(i,n.value))}),e}function md(s,e){if(ii(e))return s;{const t=bm(s,e);return t!=null?new dl(new mn(t)):new dl(s.writeTree_.subtree(e))}}function VA(s){return s.writeTree_.isEmpty()}function l1(s,e){return YK(ki(),s.writeTree_,e)}function YK(s,e,t){if(e.value!=null)return t.updateChild(s,e.value);{let i=null;return e.children.inorderTraversal((n,r)=>{n===".priority"?(je(r.value!==null,"Priority writes must always be leaf nodes"),i=r.value):t=YK(Ls(s,n),r,t)}),!t.getChild(s).isEmpty()&&i!==null&&(t=t.updateChild(Ls(s,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(s,e){return JK(e,s)}function $ce(s,e,t,i,n){je(i>s.lastWriteId,"Stacking an older write on top of newer ones"),n===void 0&&(n=!0),s.allWrites.push({path:e,snap:t,writeId:i,visible:n}),n&&(s.visibleWrites=j0(s.visibleWrites,e,t)),s.lastWriteId=i}function qce(s,e){for(let t=0;t<s.allWrites.length;t++){const i=s.allWrites[t];if(i.writeId===e)return i}return null}function Gce(s,e){const t=s.allWrites.findIndex(a=>a.writeId===e);je(t>=0,"removeWrite called with nonexistent writeId.");const i=s.allWrites[t];s.allWrites.splice(t,1);let n=i.visible,r=!1,o=s.allWrites.length-1;for(;n&&o>=0;){const a=s.allWrites[o];a.visible&&(o>=t&&Kce(a,i.path)?n=!1:cl(i.path,a.path)&&(r=!0)),o--}if(n){if(r)return Yce(s),!0;if(i.snap)s.visibleWrites=KH(s.visibleWrites,i.path);else{const a=i.children;No(a,l=>{s.visibleWrites=KH(s.visibleWrites,Ls(i.path,l))})}return!0}else return!1}function Kce(s,e){if(s.snap)return cl(s.path,e);for(const t in s.children)if(s.children.hasOwnProperty(t)&&cl(Ls(s.path,t),e))return!0;return!1}function Yce(s){s.visibleWrites=QK(s.allWrites,Qce,ki()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function Qce(s){return s.visible}function QK(s,e,t){let i=dl.empty();for(let n=0;n<s.length;++n){const r=s[n];if(e(r)){const o=r.path;let a;if(r.snap)cl(t,o)?(a=Ur(t,o),i=j0(i,a,r.snap)):cl(o,t)&&(a=Ur(o,t),i=j0(i,ki(),r.snap.getChild(a)));else if(r.children){if(cl(t,o))a=Ur(t,o),i=GH(i,a,r.children);else if(cl(o,t))if(a=Ur(o,t),ii(a))i=GH(i,ki(),r.children);else{const l=r1(r.children,Yt(a));if(l){const c=l.getChild(cn(a));i=j0(i,ki(),c)}}}else throw B1("WriteRecord should have .snap or .children")}}return i}function XK(s,e,t,i,n){if(!i&&!n){const r=bm(s.visibleWrites,e);if(r!=null)return r;{const o=md(s.visibleWrites,e);if(VA(o))return t;if(t==null&&!BA(o,ki()))return null;{const a=t||St.EMPTY_NODE;return l1(o,a)}}}else{const r=md(s.visibleWrites,e);if(!n&&VA(r))return t;if(!n&&t==null&&!BA(r,ki()))return null;{const o=function(c){return(c.visible||n)&&(!i||!~i.indexOf(c.writeId))&&(cl(c.path,e)||cl(e,c.path))},a=QK(s.allWrites,o,e),l=t||St.EMPTY_NODE;return l1(a,l)}}}function Xce(s,e,t){let i=St.EMPTY_NODE;const n=bm(s.visibleWrites,e);if(n)return n.isLeafNode()||n.forEachChild($n,(r,o)=>{i=i.updateImmediateChild(r,o)}),i;if(t){const r=md(s.visibleWrites,e);return t.forEachChild($n,(o,a)=>{const l=l1(md(r,new sn(o)),a);i=i.updateImmediateChild(o,l)}),YH(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const r=md(s.visibleWrites,e);return YH(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Zce(s,e,t,i,n){je(i||n,"Either existingEventSnap or existingServerSnap must exist");const r=Ls(e,t);if(BA(s.visibleWrites,r))return null;{const o=md(s.visibleWrites,r);return VA(o)?n.getChild(t):l1(o,n.getChild(t))}}function Jce(s,e,t,i){const n=Ls(e,t),r=bm(s.visibleWrites,n);if(r!=null)return r;if(i.isCompleteForChild(t)){const o=md(s.visibleWrites,n);return l1(o,i.getNode().getImmediateChild(t))}else return null}function eue(s,e){return bm(s.visibleWrites,e)}function tue(s,e,t,i,n,r,o){let a;const l=md(s.visibleWrites,e),c=bm(l,ki());if(c!=null)a=c;else if(t!=null)a=l1(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],d=o.getCompare(),g=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let p=g.getNext();for(;p&&h.length<n;)d(p,i)!==0&&h.push(p),p=g.getNext();return h}else return[]}function iue(){return{visibleWrites:dl.empty(),allWrites:[],lastWriteId:-1}}function DL(s,e,t,i){return XK(s.writeTree,s.treePath,e,t,i)}function RP(s,e){return Xce(s.writeTree,s.treePath,e)}function QH(s,e,t,i){return Zce(s.writeTree,s.treePath,e,t,i)}function TL(s,e){return eue(s.writeTree,Ls(s.treePath,e))}function nue(s,e,t,i,n,r){return tue(s.writeTree,s.treePath,e,t,i,n,r)}function AP(s,e,t){return Jce(s.writeTree,s.treePath,e,t)}function ZK(s,e){return JK(Ls(s.treePath,e),s.writeTree)}function JK(s,e){return{treePath:s,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sue{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;je(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),je(i!==".priority","Only non-priority child changes can be tracked.");const n=this.changeMap.get(i);if(n){const r=n.type;if(t==="child_added"&&r==="child_removed")this.changeMap.set(i,tv(i,e.snapshotNode,n.snapshotNode));else if(t==="child_removed"&&r==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&r==="child_changed")this.changeMap.set(i,ev(i,n.oldSnap));else if(t==="child_changed"&&r==="child_added")this.changeMap.set(i,a1(i,e.snapshotNode));else if(t==="child_changed"&&r==="child_changed")this.changeMap.set(i,tv(i,e.snapshotNode,n.oldSnap));else throw B1("Illegal combination of changes: "+e+" occurred after "+n)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rue{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const eY=new rue;class MP{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new kd(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return AP(this.writes_,e,i)}}getChildAfterChild(e,t,i){const n=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Gg(this.viewCache_),r=nue(this.writes_,n,t,1,i,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oue(s){return{filter:s}}function aue(s,e){je(e.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),je(e.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function lue(s,e,t,i,n){const r=new sue;let o,a;if(t.type===ul.OVERWRITE){const c=t;c.source.fromUser?o=HA(s,e,c.path,c.snap,i,n,r):(je(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ii(c.path),o=NL(s,e,c.path,c.snap,i,n,a,r))}else if(t.type===ul.MERGE){const c=t;c.source.fromUser?o=uue(s,e,c.path,c.children,i,n,r):(je(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=WA(s,e,c.path,c.children,i,n,a,r))}else if(t.type===ul.ACK_USER_WRITE){const c=t;c.revert?o=fue(s,e,c.path,i,n,r):o=hue(s,e,c.path,c.affectedTree,i,n,r)}else if(t.type===ul.LISTEN_COMPLETE)o=due(s,e,t.path,i,r);else throw B1("Unknown operation type: "+t.type);const l=r.getChanges();return cue(e,o,l),{viewCache:o,changes:l}}function cue(s,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const n=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=EL(s);(t.length>0||!s.eventCache.isFullyInitialized()||n&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&t.push($K(EL(e)))}}function tY(s,e,t,i,n,r){const o=e.eventCache;if(TL(i,t)!=null)return e;{let a,l;if(ii(t))if(je(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Gg(e),h=c instanceof St?c:St.EMPTY_NODE,d=RP(i,h);a=s.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const c=DL(i,Gg(e));a=s.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=Yt(t);if(c===".priority"){je(Ld(t)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const d=QH(i,t,h,l);d!=null?a=s.filter.updatePriority(h,d):a=o.getNode()}else{const h=cn(t);let d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const g=QH(i,t,o.getNode(),l);g!=null?d=o.getNode().getImmediateChild(c).updateChild(h,g):d=o.getNode().getImmediateChild(c)}else d=AP(i,c,e.serverCache);d!=null?a=s.filter.updateChild(o.getNode(),c,d,h,n,r):a=o.getNode()}}return U0(e,a,o.isFullyInitialized()||ii(t),s.filter.filtersNodes())}}function NL(s,e,t,i,n,r,o,a){const l=e.serverCache;let c;const h=o?s.filter:s.filter.getIndexedFilter();if(ii(t))c=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(t,i);c=h.updateFullNode(l.getNode(),p,null)}else{const p=Yt(t);if(!l.isCompleteForPath(t)&&Ld(t)>1)return e;const _=cn(t),C=l.getNode().getImmediateChild(p).updateChild(_,i);p===".priority"?c=h.updatePriority(l.getNode(),C):c=h.updateChild(l.getNode(),p,C,_,eY,null)}const d=KK(e,c,l.isFullyInitialized()||ii(t),h.filtersNodes()),g=new MP(n,d,r);return tY(s,d,t,n,g,a)}function HA(s,e,t,i,n,r,o){const a=e.eventCache;let l,c;const h=new MP(n,e,r);if(ii(t))c=s.filter.updateFullNode(e.eventCache.getNode(),i,o),l=U0(e,c,!0,s.filter.filtersNodes());else{const d=Yt(t);if(d===".priority")c=s.filter.updatePriority(e.eventCache.getNode(),i),l=U0(e,c,a.isFullyInitialized(),a.isFiltered());else{const g=cn(t),p=a.getNode().getImmediateChild(d);let _;if(ii(g))_=i;else{const b=h.getCompleteChild(d);b!=null?PK(g)===".priority"&&b.getChild(BK(g)).isEmpty()?_=b:_=b.updateChild(g,i):_=St.EMPTY_NODE}if(p.equals(_))l=e;else{const b=s.filter.updateChild(a.getNode(),d,_,g,h,o);l=U0(e,b,a.isFullyInitialized(),s.filter.filtersNodes())}}}return l}function XH(s,e){return s.eventCache.isCompleteForChild(e)}function uue(s,e,t,i,n,r,o){let a=e;return i.foreach((l,c)=>{const h=Ls(t,l);XH(e,Yt(h))&&(a=HA(s,a,h,c,n,r,o))}),i.foreach((l,c)=>{const h=Ls(t,l);XH(e,Yt(h))||(a=HA(s,a,h,c,n,r,o))}),a}function ZH(s,e,t){return t.foreach((i,n)=>{e=e.updateChild(i,n)}),e}function WA(s,e,t,i,n,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ii(t)?c=i:c=new mn(null).setTree(t,i);const h=e.serverCache.getNode();return c.children.inorderTraversal((d,g)=>{if(h.hasChild(d)){const p=e.serverCache.getNode().getImmediateChild(d),_=ZH(s,p,g);l=NL(s,l,new sn(d),_,n,r,o,a)}}),c.children.inorderTraversal((d,g)=>{const p=!e.serverCache.isCompleteForChild(d)&&g.value===null;if(!h.hasChild(d)&&!p){const _=e.serverCache.getNode().getImmediateChild(d),b=ZH(s,_,g);l=NL(s,l,new sn(d),b,n,r,o,a)}}),l}function hue(s,e,t,i,n,r,o){if(TL(n,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(ii(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return NL(s,e,t,l.getNode().getChild(t),n,r,a,o);if(ii(t)){let c=new mn(null);return l.getNode().forEachChild(D_,(h,d)=>{c=c.set(new sn(h),d)}),WA(s,e,t,c,n,r,a,o)}else return e}else{let c=new mn(null);return i.foreach((h,d)=>{const g=Ls(t,h);l.isCompleteForPath(g)&&(c=c.set(h,l.getNode().getChild(g)))}),WA(s,e,t,c,n,r,a,o)}}function due(s,e,t,i,n){const r=e.serverCache,o=KK(e,r.getNode(),r.isFullyInitialized()||ii(t),r.isFiltered());return tY(s,o,t,i,eY,n)}function fue(s,e,t,i,n,r){let o;if(TL(i,t)!=null)return e;{const a=new MP(i,e,n),l=e.eventCache.getNode();let c;if(ii(t)||Yt(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=DL(i,Gg(e));else{const d=e.serverCache.getNode();je(d instanceof St,"serverChildren would be complete if leaf node"),h=RP(i,d)}h=h,c=s.filter.updateFullNode(l,h,r)}else{const h=Yt(t);let d=AP(i,h,e.serverCache);d==null&&e.serverCache.isCompleteForChild(h)&&(d=l.getImmediateChild(h)),d!=null?c=s.filter.updateChild(l,h,d,cn(t),a,r):e.eventCache.getNode().hasChild(h)?c=s.filter.updateChild(l,h,St.EMPTY_NODE,cn(t),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=DL(i,Gg(e)),o.isLeafNode()&&(c=s.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||TL(i,ki())!=null,U0(e,c,o,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gue=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,n=new DP(i.getIndex()),r=Ace(i);this.processor_=oue(r);const o=t.serverCache,a=t.eventCache,l=n.updateFullNode(St.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(St.EMPTY_NODE,a.getNode(),null),h=new kd(l,o.isFullyInitialized(),n.filtersNodes()),d=new kd(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=BE(d,h),this.eventGenerator_=new Hce(this.query_)}get query(){return this.query_}};function mue(s){return s.viewCache_.serverCache.getNode()}function pue(s){return EL(s.viewCache_)}function _ue(s,e){const t=Gg(s.viewCache_);return t&&(s.query._queryParams.loadsAllData()||!ii(e)&&!t.getImmediateChild(Yt(e)).isEmpty())?t.getChild(e):null}function JH(s){return s.eventRegistrations_.length===0}function bue(s,e){s.eventRegistrations_.push(e)}function eW(s,e,t){const i=[];if(t){je(e==null,"A cancel should cancel all event registrations.");const n=s.query._path;s.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(t,n);o&&i.push(o)})}if(e){let n=[];for(let r=0;r<s.eventRegistrations_.length;++r){const o=s.eventRegistrations_[r];if(!o.matches(e))n.push(o);else if(e.hasAnyCallback()){n=n.concat(s.eventRegistrations_.slice(r+1));break}}s.eventRegistrations_=n}else s.eventRegistrations_=[];return i}function tW(s,e,t,i){e.type===ul.MERGE&&e.source.queryId!==null&&(je(Gg(s.viewCache_),"We should always have a full cache before handling merges"),je(EL(s.viewCache_),"Missing event cache, even though we have a server cache"));const n=s.viewCache_,r=lue(s.processor_,n,e,t,i);return aue(s.processor_,r.viewCache),je(r.viewCache.serverCache.isFullyInitialized()||!n.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=r.viewCache,iY(s,r.changes,r.viewCache.eventCache.getNode(),null)}function wue(s,e){const t=s.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild($n,(r,o)=>{i.push(a1(r,o))}),t.isFullyInitialized()&&i.push($K(t.getNode())),iY(s,i,t.getNode(),e)}function iY(s,e,t,i){const n=i?[i]:s.eventRegistrations_;return Wce(s.eventGenerator_,e,t,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IL;class nY{constructor(){this.views=new Map}}function vue(s){je(!IL,"__referenceConstructor has already been defined"),IL=s}function Cue(){return je(IL,"Reference.ts has not been loaded"),IL}function yue(s){return s.views.size===0}function OP(s,e,t,i){const n=e.source.queryId;if(n!==null){const r=s.views.get(n);return je(r!=null,"SyncTree gave us an op for an invalid query."),tW(r,e,t,i)}else{let r=[];for(const o of s.views.values())r=r.concat(tW(o,e,t,i));return r}}function sY(s,e,t,i,n){const r=e._queryIdentifier,o=s.views.get(r);if(!o){let a=DL(t,n?i:null),l=!1;a?l=!0:i instanceof St?(a=RP(t,i),l=!1):(a=St.EMPTY_NODE,l=!1);const c=BE(new kd(a,l,!1),new kd(i,n,!1));return new gue(e,c)}return o}function Sue(s,e,t,i,n,r){const o=sY(s,e,i,n,r);return s.views.has(e._queryIdentifier)||s.views.set(e._queryIdentifier,o),bue(o,t),wue(o,t)}function xue(s,e,t,i){const n=e._queryIdentifier,r=[];let o=[];const a=Ed(s);if(n==="default")for(const[l,c]of s.views.entries())o=o.concat(eW(c,t,i)),JH(c)&&(s.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=s.views.get(n);l&&(o=o.concat(eW(l,t,i)),JH(l)&&(s.views.delete(n),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!Ed(s)&&r.push(new(Cue())(e._repo,e._path)),{removed:r,events:o}}function rY(s){const e=[];for(const t of s.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function pd(s,e){let t=null;for(const i of s.views.values())t=t||_ue(i,e);return t}function oY(s,e){if(e._queryParams.loadsAllData())return HE(s);{const i=e._queryIdentifier;return s.views.get(i)}}function aY(s,e){return oY(s,e)!=null}function Ed(s){return HE(s)!=null}function HE(s){for(const e of s.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RL;function Lue(s){je(!RL,"__referenceConstructor has already been defined"),RL=s}function kue(){return je(RL,"Reference.ts has not been loaded"),RL}let Eue=1;class iW{constructor(e){this.listenProvider_=e,this.syncPointTree_=new mn(null),this.pendingWriteTree_=iue(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function lY(s,e,t,i,n){return $ce(s.pendingWriteTree_,e,t,i,n),n?DC(s,new qg(GK(),e,t)):[]}function sg(s,e,t=!1){const i=qce(s.pendingWriteTree_,e);if(Gce(s.pendingWriteTree_,e)){let r=new mn(null);return i.snap!=null?r=r.set(ki(),!0):No(i.children,o=>{r=r.set(new sn(o),!0)}),DC(s,new kL(i.path,r,t))}else return[]}function EC(s,e,t){return DC(s,new qg(NP(),e,t))}function Due(s,e,t){const i=mn.fromObject(t);return DC(s,new sv(NP(),e,i))}function Tue(s,e){return DC(s,new nv(NP(),e))}function Nue(s,e,t){const i=FP(s,t);if(i){const n=BP(i),r=n.path,o=n.queryId,a=Ur(r,e),l=new nv(IP(o),a);return VP(s,r,l)}else return[]}function AL(s,e,t,i,n=!1){const r=e._path,o=s.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||aY(o,e))){const l=xue(o,e,t,i);yue(o)&&(s.syncPointTree_=s.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!n){const h=c.findIndex(g=>g._queryParams.loadsAllData())!==-1,d=s.syncPointTree_.findOnPath(r,(g,p)=>Ed(p));if(h&&!d){const g=s.syncPointTree_.subtree(r);if(!g.isEmpty()){const p=Aue(g);for(let _=0;_<p.length;++_){const b=p[_],C=b.query,x=dY(s,b);s.listenProvider_.startListening($0(C),rv(s,C),x.hashFn,x.onComplete)}}}!d&&c.length>0&&!i&&(h?s.listenProvider_.stopListening($0(e),null):c.forEach(g=>{const p=s.queryToTagMap.get(WE(g));s.listenProvider_.stopListening($0(g),p)}))}Mue(s,c)}return a}function cY(s,e,t,i){const n=FP(s,i);if(n!=null){const r=BP(n),o=r.path,a=r.queryId,l=Ur(o,e),c=new qg(IP(a),l,t);return VP(s,o,c)}else return[]}function Iue(s,e,t,i){const n=FP(s,i);if(n){const r=BP(n),o=r.path,a=r.queryId,l=Ur(o,e),c=mn.fromObject(t),h=new sv(IP(a),l,c);return VP(s,o,h)}else return[]}function zA(s,e,t,i=!1){const n=e._path;let r=null,o=!1;s.syncPointTree_.foreachOnPath(n,(g,p)=>{const _=Ur(g,n);r=r||pd(p,_),o=o||Ed(p)});let a=s.syncPointTree_.get(n);a?(o=o||Ed(a),r=r||pd(a,ki())):(a=new nY,s.syncPointTree_=s.syncPointTree_.set(n,a));let l;r!=null?l=!0:(l=!1,r=St.EMPTY_NODE,s.syncPointTree_.subtree(n).foreachChild((p,_)=>{const b=pd(_,ki());b&&(r=r.updateImmediateChild(p,b))}));const c=aY(a,e);if(!c&&!e._queryParams.loadsAllData()){const g=WE(e);je(!s.queryToTagMap.has(g),"View does not exist, but we have a tag");const p=Oue();s.queryToTagMap.set(g,p),s.tagToQueryMap.set(p,g)}const h=VE(s.pendingWriteTree_,n);let d=Sue(a,e,t,h,r,l);if(!c&&!o&&!i){const g=oY(a,e);d=d.concat(Pue(s,e,g))}return d}function PP(s,e,t){const n=s.pendingWriteTree_,r=s.syncPointTree_.findOnPath(e,(o,a)=>{const l=Ur(o,e),c=pd(a,l);if(c)return c});return XK(n,e,r,t,!0)}function Rue(s,e){const t=e._path;let i=null;s.syncPointTree_.foreachOnPath(t,(c,h)=>{const d=Ur(c,t);i=i||pd(h,d)});let n=s.syncPointTree_.get(t);n?i=i||pd(n,ki()):(n=new nY,s.syncPointTree_=s.syncPointTree_.set(t,n));const r=i!=null,o=r?new kd(i,!0,!1):null,a=VE(s.pendingWriteTree_,e._path),l=sY(n,e,a,r?o.getNode():St.EMPTY_NODE,r);return pue(l)}function DC(s,e){return uY(e,s.syncPointTree_,null,VE(s.pendingWriteTree_,ki()))}function uY(s,e,t,i){if(ii(s.path))return hY(s,e,t,i);{const n=e.get(ki());t==null&&n!=null&&(t=pd(n,ki()));let r=[];const o=Yt(s.path),a=s.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,h=ZK(i,o);r=r.concat(uY(a,l,c,h))}return n&&(r=r.concat(OP(n,s,i,t))),r}}function hY(s,e,t,i){const n=e.get(ki());t==null&&n!=null&&(t=pd(n,ki()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=ZK(i,o),h=s.operationForChild(o);h&&(r=r.concat(hY(h,a,l,c)))}),n&&(r=r.concat(OP(n,s,i,t))),r}function dY(s,e){const t=e.query,i=rv(s,t);return{hashFn:()=>(mue(e)||St.EMPTY_NODE).hash(),onComplete:n=>{if(n==="ok")return i?Nue(s,t._path,i):Tue(s,t._path);{const r=Rle(n,t);return AL(s,t,null,r)}}}}function rv(s,e){const t=WE(e);return s.queryToTagMap.get(t)}function WE(s){return s._path.toString()+"$"+s._queryIdentifier}function FP(s,e){return s.tagToQueryMap.get(e)}function BP(s){const e=s.indexOf("$");return je(e!==-1&&e<s.length-1,"Bad queryKey."),{queryId:s.substr(e+1),path:new sn(s.substr(0,e))}}function VP(s,e,t){const i=s.syncPointTree_.get(e);je(i,"Missing sync point for query tag that we're tracking");const n=VE(s.pendingWriteTree_,e);return OP(i,t,n,null)}function Aue(s){return s.fold((e,t,i)=>{if(t&&Ed(t))return[HE(t)];{let n=[];return t&&(n=rY(t)),No(i,(r,o)=>{n=n.concat(o)}),n}})}function $0(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(kue())(s._repo,s._path):s}function Mue(s,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const n=WE(i),r=s.queryToTagMap.get(n);s.queryToTagMap.delete(n),s.tagToQueryMap.delete(r)}}}function Oue(){return Eue++}function Pue(s,e,t){const i=e._path,n=rv(s,e),r=dY(s,t),o=s.listenProvider_.startListening($0(e),n,r.hashFn,r.onComplete),a=s.syncPointTree_.subtree(i);if(n)je(!Ed(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,h,d)=>{if(!ii(c)&&h&&Ed(h))return[HE(h).query];{let g=[];return h&&(g=g.concat(rY(h).map(p=>p.query))),No(d,(p,_)=>{g=g.concat(_)}),g}});for(let c=0;c<l.length;++c){const h=l[c];s.listenProvider_.stopListening($0(h),rv(s,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new HP(t)}node(){return this.node_}}class WP{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ls(this.path_,e);return new WP(this.syncTree_,t)}node(){return PP(this.syncTree_,this.path_)}}const Fue=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},nW=function(s,e,t){if(!s||typeof s!="object")return s;if(je(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return Bue(s[".sv"],e,t);if(typeof s[".sv"]=="object")return Vue(s[".sv"],e);je(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},Bue=function(s,e,t){switch(s){case"timestamp":return t.timestamp;default:je(!1,"Unexpected server value: "+s)}},Vue=function(s,e,t){s.hasOwnProperty("increment")||je(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const i=s.increment;typeof i!="number"&&je(!1,"Unexpected increment value: "+i);const n=e.node();if(je(n!==null&&typeof n<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!n.isLeafNode())return i;const o=n.getValue();return typeof o!="number"?i:o+i},Hue=function(s,e,t,i){return zP(e,new WP(t,s),i)},fY=function(s,e,t){return zP(s,new HP(e),t)};function zP(s,e,t){const i=s.getPriority().val(),n=nW(i,e.getImmediateChild(".priority"),t);let r;if(s.isLeafNode()){const o=s,a=nW(o.getValue(),e,t);return a!==o.getValue()||n!==o.getPriority().val()?new Vs(a,qs(n)):s}else{const o=s;return r=o,n!==o.getPriority().val()&&(r=r.updatePriority(new Vs(n))),o.forEachChild($n,(a,l)=>{const c=zP(l,e.getImmediateChild(a),t);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function jP(s,e){let t=e instanceof sn?e:new sn(e),i=s,n=Yt(t);for(;n!==null;){const r=r1(i.node.children,n)||{children:{},childCount:0};i=new UP(n,i,r),t=cn(t),n=Yt(t)}return i}function z1(s){return s.node.value}function gY(s,e){s.node.value=e,UA(s)}function mY(s){return s.node.childCount>0}function Wue(s){return z1(s)===void 0&&!mY(s)}function zE(s,e){No(s.node.children,(t,i)=>{e(new UP(t,s,i))})}function pY(s,e,t,i){t&&e(s),zE(s,n=>{pY(n,e,!0)})}function zue(s,e,t){let i=s.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function TC(s){return new sn(s.parent===null?s.name:TC(s.parent)+"/"+s.name)}function UA(s){s.parent!==null&&Uue(s.parent,s.name,s)}function Uue(s,e,t){const i=Wue(t),n=nh(s.node.children,e);i&&n?(delete s.node.children[e],s.node.childCount--,UA(s)):!i&&!n&&(s.node.children[e]=t.node,s.node.childCount++,UA(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jue=/[\[\].#$\/\u0000-\u001F\u007F]/,$ue=/[\[\].#$\u0000-\u001F\u007F]/,OI=10*1024*1024,_Y=function(s){return typeof s=="string"&&s.length!==0&&!jue.test(s)},bY=function(s){return typeof s=="string"&&s.length!==0&&!$ue.test(s)},que=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),bY(s)},Gue=function(s,e,t,i){$P(wP(s,"value"),e,t)},$P=function(s,e,t){const i=t instanceof sn?new hce(t,s):t;if(e===void 0)throw new Error(s+"contains undefined "+yf(i));if(typeof e=="function")throw new Error(s+"contains a function "+yf(i)+" with contents = "+e.toString());if(mK(e))throw new Error(s+"contains "+e.toString()+" "+yf(i));if(typeof e=="string"&&e.length>OI/3&&PE(e)>OI)throw new Error(s+"contains a string greater than "+OI+" utf8 bytes "+yf(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let n=!1,r=!1;if(No(e,(o,a)=>{if(o===".value")n=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!_Y(o)))throw new Error(s+" contains an invalid key ("+o+") "+yf(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);dce(i,o),$P(s,a,i),fce(i)}),n&&r)throw new Error(s+' contains ".value" child '+yf(i)+" in addition to actual children.")}},wY=function(s,e,t,i){if(!bY(t))throw new Error(wP(s,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Kue=function(s,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),wY(s,e,t)},vY=function(s,e){if(Yt(e)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},Yue=function(s,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!_Y(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!que(t))throw new Error(wP(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Que{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function qP(s,e){let t=null;for(let i=0;i<e.length;i++){const n=e[i],r=n.getPath();t!==null&&!LP(r,t.path)&&(s.eventLists_.push(t),t=null),t===null&&(t={events:[],path:r}),t.events.push(n)}t&&s.eventLists_.push(t)}function CY(s,e,t){qP(s,t),yY(s,i=>LP(i,e))}function cc(s,e,t){qP(s,t),yY(s,i=>cl(i,e)||cl(e,i))}function yY(s,e){s.recursionDepth_++;let t=!0;for(let i=0;i<s.eventLists_.length;i++){const n=s.eventLists_[i];if(n){const r=n.path;e(r)?(Xue(s.eventLists_[i]),s.eventLists_[i]=null):t=!1}}t&&(s.eventLists_=[]),s.recursionDepth_--}function Xue(s){for(let e=0;e<s.events.length;e++){const t=s.events[e];if(t!==null){s.events[e]=null;const i=t.getEventRunner();W0&&kr("event: "+t.toString()),W1(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zue="repo_interrupt",Jue=25;class ehe{constructor(e,t,i,n){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Que,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=LL(),this.transactionQueueTree_=new UP,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function the(s,e,t){if(s.stats_=SP(s.repoInfo_),s.forceRestClient_||Ple())s.server_=new xL(s.repoInfo_,(i,n,r,o)=>{sW(s,i,n,r,o)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>rW(s,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{xs(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}s.persistentConnection_=new Hu(s.repoInfo_,e,(i,n,r,o)=>{sW(s,i,n,r,o)},i=>{rW(s,i)},i=>{nhe(s,i)},s.authTokenProvider_,s.appCheckProvider_,t),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(i=>{s.server_.refreshAuthToken(i)}),s.appCheckProvider_.addTokenChangeListener(i=>{s.server_.refreshAppCheckToken(i.token)}),s.statsReporter_=Wle(s.repoInfo_,()=>new Vce(s.stats_,s.server_)),s.infoData_=new Mce,s.infoSyncTree_=new iW({startListening:(i,n,r,o)=>{let a=[];const l=s.infoData_.getNode(i._path);return l.isEmpty()||(a=EC(s.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),KP(s,"connected",!1),s.serverSyncTree_=new iW({startListening:(i,n,r,o)=>(s.server_.listen(i,r,n,(a,l)=>{const c=o(a,l);cc(s.eventQueue_,i._path,c)}),[]),stopListening:(i,n)=>{s.server_.unlisten(i,n)}})}function ihe(s){const t=s.infoData_.getNode(new sn(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function GP(s){return Fue({timestamp:ihe(s)})}function sW(s,e,t,i,n){s.dataUpdateCount++;const r=new sn(e);t=s.interceptServerDataCallback_?s.interceptServerDataCallback_(e,t):t;let o=[];if(n)if(i){const l=_L(t,c=>qs(c));o=Iue(s.serverSyncTree_,r,l,n)}else{const l=qs(t);o=cY(s.serverSyncTree_,r,l,n)}else if(i){const l=_L(t,c=>qs(c));o=Due(s.serverSyncTree_,r,l)}else{const l=qs(t);o=EC(s.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=jE(s,r)),cc(s.eventQueue_,a,o)}function rW(s,e){KP(s,"connected",e),e===!1&&ohe(s)}function nhe(s,e){No(e,(t,i)=>{KP(s,t,i)})}function KP(s,e,t){const i=new sn("/.info/"+e),n=qs(t);s.infoData_.updateSnapshot(i,n);const r=EC(s.infoSyncTree_,i,n);cc(s.eventQueue_,i,r)}function SY(s){return s.nextWriteId_++}function she(s,e,t){const i=Rue(s.serverSyncTree_,e);return i!=null?Promise.resolve(i):s.server_.get(e).then(n=>{const r=qs(n).withIndex(e._queryParams.getIndex());zA(s.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=EC(s.serverSyncTree_,e._path,r);else{const a=rv(s.serverSyncTree_,e);o=cY(s.serverSyncTree_,e._path,r,a)}return cc(s.eventQueue_,e._path,o),AL(s.serverSyncTree_,e,t,null,!0),r},n=>(UE(s,"get for query "+xs(e)+" failed: "+n),Promise.reject(new Error(n))))}function rhe(s,e,t,i,n){UE(s,"set",{path:e.toString(),value:t,priority:i});const r=GP(s),o=qs(t,i),a=PP(s.serverSyncTree_,e),l=fY(o,a,r),c=SY(s),h=lY(s.serverSyncTree_,e,l,c,!0);qP(s.eventQueue_,h),s.server_.put(e.toString(),o.val(!0),(g,p)=>{const _=g==="ok";_||ko("set at "+e+" failed: "+g);const b=sg(s.serverSyncTree_,c,!_);cc(s.eventQueue_,e,b),uhe(s,n,g,p)});const d=DY(s,e);jE(s,d),cc(s.eventQueue_,d,[])}function ohe(s){UE(s,"onDisconnectEvents");const e=GP(s),t=LL();FA(s.onDisconnect_,ki(),(n,r)=>{const o=Hue(n,r,s.serverSyncTree_,e);qK(t,n,o)});let i=[];FA(t,ki(),(n,r)=>{i=i.concat(EC(s.serverSyncTree_,n,r));const o=DY(s,n);jE(s,o)}),s.onDisconnect_=LL(),cc(s.eventQueue_,ki(),i)}function ahe(s,e,t){let i;Yt(e._path)===".info"?i=zA(s.infoSyncTree_,e,t):i=zA(s.serverSyncTree_,e,t),CY(s.eventQueue_,e._path,i)}function lhe(s,e,t){let i;Yt(e._path)===".info"?i=AL(s.infoSyncTree_,e,t):i=AL(s.serverSyncTree_,e,t),CY(s.eventQueue_,e._path,i)}function che(s){s.persistentConnection_&&s.persistentConnection_.interrupt(Zue)}function UE(s,...e){let t="";s.persistentConnection_&&(t=s.persistentConnection_.id+":"),kr(t,...e)}function uhe(s,e,t,i){e&&W1(()=>{if(t==="ok")e(null);else{const n=(t||"error").toUpperCase();let r=n;i&&(r+=": "+i);const o=new Error(r);o.code=n,e(o)}})}function xY(s,e,t){return PP(s.serverSyncTree_,e,t)||St.EMPTY_NODE}function YP(s,e=s.transactionQueueTree_){if(e||$E(s,e),z1(e)){const t=kY(s,e);je(t.length>0,"Sending zero length transaction queue"),t.every(n=>n.status===0)&&hhe(s,TC(e),t)}else mY(e)&&zE(e,t=>{YP(s,t)})}function hhe(s,e,t){const i=t.map(c=>c.currentWriteId),n=xY(s,e,i);let r=n;const o=n.hash();for(let c=0;c<t.length;c++){const h=t[c];je(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const d=Ur(e,h.path);r=r.updateChild(d,h.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;s.server_.put(l.toString(),a,c=>{UE(s,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){const d=[];for(let g=0;g<t.length;g++)t[g].status=2,h=h.concat(sg(s.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&d.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();$E(s,jP(s.transactionQueueTree_,e)),YP(s,s.transactionQueueTree_),cc(s.eventQueue_,e,h);for(let g=0;g<d.length;g++)W1(d[g])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{ko("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}jE(s,e)}},o)}function jE(s,e){const t=LY(s,e),i=TC(t),n=kY(s,t);return dhe(s,n,i),i}function dhe(s,e,t){if(e.length===0)return;const i=[];let n=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=Ur(t,l.path);let h=!1,d;if(je(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,d=l.abortReason,n=n.concat(sg(s.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Jue)h=!0,d="maxretry",n=n.concat(sg(s.serverSyncTree_,l.currentWriteId,!0));else{const g=xY(s,l.path,o);l.currentInputSnapshot=g;const p=e[a].update(g.val());if(p!==void 0){$P("transaction failed: Data returned ",p,l.path);let _=qs(p);typeof p=="object"&&p!=null&&nh(p,".priority")||(_=_.updatePriority(g.getPriority()));const C=l.currentWriteId,x=GP(s),S=fY(_,g,x);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=S,l.currentWriteId=SY(s),o.splice(o.indexOf(C),1),n=n.concat(lY(s.serverSyncTree_,l.path,S,l.currentWriteId,l.applyLocally)),n=n.concat(sg(s.serverSyncTree_,C,!0))}else h=!0,d="nodata",n=n.concat(sg(s.serverSyncTree_,l.currentWriteId,!0))}cc(s.eventQueue_,t,n),n=[],h&&(e[a].status=2,(function(g){setTimeout(g,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}$E(s,s.transactionQueueTree_);for(let a=0;a<i.length;a++)W1(i[a]);YP(s,s.transactionQueueTree_)}function LY(s,e){let t,i=s.transactionQueueTree_;for(t=Yt(e);t!==null&&z1(i)===void 0;)i=jP(i,t),e=cn(e),t=Yt(e);return i}function kY(s,e){const t=[];return EY(s,e,t),t.sort((i,n)=>i.order-n.order),t}function EY(s,e,t){const i=z1(e);if(i)for(let n=0;n<i.length;n++)t.push(i[n]);zE(e,n=>{EY(s,n,t)})}function $E(s,e){const t=z1(e);if(t){let i=0;for(let n=0;n<t.length;n++)t[n].status!==2&&(t[i]=t[n],i++);t.length=i,gY(e,t.length>0?t:void 0)}zE(e,i=>{$E(s,i)})}function DY(s,e){const t=TC(LY(s,e)),i=jP(s.transactionQueueTree_,e);return zue(i,n=>{PI(s,n)}),PI(s,i),pY(i,n=>{PI(s,n)}),t}function PI(s,e){const t=z1(e);if(t){const i=[];let n=[],r=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(je(r===o-1,"All SENT items should be at beginning of queue."),r=o,t[o].status=3,t[o].abortReason="set"):(je(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),n=n.concat(sg(s.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?gY(e,void 0):t.length=r+1,cc(s.eventQueue_,TC(e),n);for(let o=0;o<i.length;o++)W1(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fhe(s){let e="";const t=s.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let n=t[i];try{n=decodeURIComponent(n.replace(/\+/g," "))}catch{}e+="/"+n}return e}function ghe(s){const e={};s.charAt(0)==="?"&&(s=s.substring(1));for(const t of s.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ko(`Invalid query segment '${t}' in query '${s}'`)}return e}const oW=function(s,e){const t=mhe(s),i=t.namespace;t.domain==="firebase.com"&&Xu(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Xu("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Ele();const n=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new EK(t.host,t.secure,i,n,e,"",i!==t.subdomain),path:new sn(t.pathString)}},mhe=function(s){let e="",t="",i="",n="",r="",o=!0,a="https",l=443;if(typeof s=="string"){let c=s.indexOf("//");c>=0&&(a=s.substring(0,c-1),s=s.substring(c+2));let h=s.indexOf("/");h===-1&&(h=s.length);let d=s.indexOf("?");d===-1&&(d=s.length),e=s.substring(0,Math.min(h,d)),h<d&&(n=fhe(s.substring(h,d)));const g=ghe(s.substring(Math.min(s.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{const _=e.indexOf(".");i=e.substring(0,_).toLowerCase(),t=e.substring(_+1),r=i}"ns"in g&&(r=g.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:n,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class phe{constructor(e,t,i,n){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=n}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+xs(this.snapshot.exportVal())}}class _he{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TY{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return je(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,t,i,n){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=n}get key(){return ii(this._path)?null:PK(this._path)}get ref(){return new sh(this._repo,this._path)}get _queryIdentifier(){const e=$H(this._queryParams),t=CP(e);return t==="{}"?"default":t}get _queryObject(){return $H(this._queryParams)}isEqual(e){if(e=V1(e),!(e instanceof QP))return!1;const t=this._repo===e._repo,i=LP(this._path,e._path),n=this._queryIdentifier===e._queryIdentifier;return t&&i&&n}toJSON(){return this.toString()}toString(){return this._repo.toString()+uce(this._path)}}class sh extends QP{constructor(e,t){super(e,t,new TP,!1)}get parent(){const e=BK(this._path);return e===null?null:new sh(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class ov{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new sn(e),i=jA(this.ref,e);return new ov(this._node.getChild(t),i,$n)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,n)=>e(new ov(n,jA(this.ref,i),$n)))}hasChild(e){const t=new sn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function qa(s,e){return s=V1(s),s._checkNotDeleted("ref"),e!==void 0?jA(s._root,e):s._root}function jA(s,e){return s=V1(s),Yt(s._path)===null?Kue("child","path",e):wY("child","path",e),new sh(s._repo,Ls(s._path,e))}function aW(s){return vY("remove",s._path),Sf(s,null)}function Sf(s,e){s=V1(s),vY("set",s._path),Gue("set",e,s._path);const t=new OE;return rhe(s._repo,s._path,e,null,t.wrapCallback(()=>{})),t.promise}function lW(s){s=V1(s);const e=new TY(()=>{}),t=new qE(e);return she(s._repo,s,t).then(i=>new ov(i,new sh(s._repo,s._path),s._queryParams.getIndex()))}class qE{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new phe("value",this,new ov(e.snapshotNode,new sh(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new _he(this,e,t):null}matches(e){return e instanceof qE?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function bhe(s,e,t,i,n){const r=new TY(t,void 0),o=new qE(r);return ahe(s._repo,s,o),()=>lhe(s._repo,s,o)}function whe(s,e,t,i){return bhe(s,"value",e)}vue(sh);Lue(sh);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vhe="FIREBASE_DATABASE_EMULATOR_HOST",$A={};let Che=!1;function yhe(s,e,t,i){const n=e.lastIndexOf(":"),r=e.substring(0,n),o=bP(r);s.repoInfo_=new EK(e,o,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(s.authTokenProvider_=i)}function She(s,e,t,i,n){let r=i||s.options.databaseURL;r===void 0&&(s.options.projectId||Xu("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kr("Using default host for project ",s.options.projectId),r=`${s.options.projectId}-default-rtdb.firebaseio.com`);let o=oW(r,n),a=o.repoInfo,l;typeof process<"u"&&EH&&(l=EH[vhe]),l?(r=`http://${l}?ns=${a.namespace}`,o=oW(r,n),a=o.repoInfo):o.repoInfo.secure;const c=new Ble(s.name,s.options,e);Yue("Invalid Firebase Database URL",o),ii(o.path)||Xu("Database URL must point to the root of a Firebase Database (not including a child path).");const h=Lhe(a,s,c,new Fle(s,t));return new khe(h,s)}function xhe(s,e){const t=$A[e];(!t||t[s.key]!==s)&&Xu(`Database ${e}(${s.repoInfo_}) has already been deleted.`),che(s),delete t[s.key]}function Lhe(s,e,t,i){let n=$A[e.name];n||(n={},$A[e.name]=n);let r=n[s.toURLString()];return r&&Xu("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new ehe(s,Che,t,i),n[s.toURLString()]=r,r}class khe{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(the(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new sh(this._repo,ki())),this._rootInternal}_delete(){return this._rootInternal!==null&&(xhe(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Xu("Cannot call "+e+" on a deleted database.")}}function Ehe(s=ule(),e){const t=rle(s,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=joe("database");i&&Dhe(t,...i)}return t}function Dhe(s,e,t,i={}){s=V1(s),s._checkNotDeleted("useEmulator");const n=`${e}:${t}`,r=s._repoInternal;if(s._instanceStarted){if(n===s._repoInternal.repoInfo_.host&&bL(i,r.repoInfo_.emulatorOptions))return;Xu("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Xu('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Px(Px.OWNER);else if(i.mockUserToken){const a=typeof i.mockUserToken=="string"?i.mockUserToken:qoe(i.mockUserToken,s.app.options.projectId);o=new Px(a)}bP(e)&&($oe(e),Yoe("Database",!0)),yhe(r,n,i,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function The(s){Cle(cle),vL(new Xw("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return She(i,n,r,t)},"PUBLIC").setMultipleInstances(!0)),k_(DH,TH,s),k_(DH,TH,"esm2020")}Hu.prototype.simpleListen=function(s,e){this.sendRequest("q",{p:s},e)};Hu.prototype.echo=function(s,e){this.sendRequest("echo",{d:s},e)};The();var Nhe="firebase",Ihe="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */k_(Nhe,Ihe,"app");const qA={apiKey:"AIzaSyAfOvMVTMhUsz9hMGKK-O_mzTOwJ_M8bBU",authDomain:"python-tutoring.firebaseapp.com",projectId:"python-tutoring",storageBucket:"python-tutoring.firebasestorage.app",messagingSenderId:"425234567508",appId:"1:425234567508:web:e416a082b7701320ec78c1",databaseURL:"https://python-tutoring-default-rtdb.firebaseio.com"},Rhe=qA.apiKey&&qA.apiKey!=="YOUR_API_KEY";let Vn;if(Rhe)try{const s=cK(qA);Vn=Ehe(s)}catch(s){console.warn("Firebase initialization failed:",s),Vn=null}else console.warn("Firebase config missing. Using local-only mode."),Vn=null;const NY="python_tutoring_sessions",cW=()=>{const s="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="";for(let t=0;t<6;t++)e+=s.charAt(Math.floor(Math.random()*s.length));return e},Ahe=()=>"user_"+Math.random().toString(36).substring(2,11),IY=Ne.createContext(void 0),RY=()=>{const s=Ne.useContext(IY);if(!s)throw new Error("useSession must be used within a SessionProvider");return s},Mhe=()=>{const s=localStorage.getItem("python_tutoring_participant_id");if(s)return s;const e=Ahe();return localStorage.setItem("python_tutoring_participant_id",e),e},XP=()=>{try{const s=localStorage.getItem(NY);return s?JSON.parse(s):{}}catch{return{}}},AY=s=>{try{localStorage.setItem(NY,JSON.stringify(s))}catch(e){console.error("[Session] Failed to save sessions:",e)}},uf=s=>XP()[s]||null,hf=(s,e)=>{const t=XP();t[s]=e,AY(t)},Ohe=s=>{const e=XP();delete e[s],AY(e)},Phe=({children:s})=>{const[e,t]=Ne.useState(null),[i,n]=Ne.useState(!1),[r]=Ne.useState(Mhe),[o,a]=Ne.useState({}),[l,c]=Ne.useState(null),[h,d]=Ne.useState([]),[g,p]=Ne.useState({}),_=Ne.useRef(null),b=e!==null;Ne.useEffect(()=>{if(!e)return;if(Vn){const M=qa(Vn,`sessions/${e}`),O=whe(M,V=>{const H=V.val();H?(a(H.participants||{}),p(H.unlockedChapters||{}),i&&H.studentCode&&c(H.studentCode),i&&H.studentOutput&&d(H.studentOutput)):(t(null),n(!1),a({}),p({}))});return()=>O()}const A=()=>{const M=uf(e);M?(a(M.participants||{}),p(M.unlockedChapters||{}),i&&M.studentCode&&c(M.studentCode),i&&M.studentOutput&&d(M.studentOutput)):i||(console.log("[Session] Session ended by teacher"),t(null),a({}),p({}))};return A(),_.current=window.setInterval(A,500),()=>{_.current&&clearInterval(_.current)}},[e,i]);const C=Ne.useCallback(async()=>{const A=cW(),M={createdAt:Date.now(),teacherId:r,participants:{[r]:{role:"teacher",joinedAt:Date.now()}},unlockedChapters:{"ch1-intro":!0,"ch2-variables":!0,"ch3-math":!0}};if(Vn)try{let O=A,V=0;for(;V<10&&(await lW(qa(Vn,`sessions/${O}`))).exists();)O=cW(),V++;return await Sf(qa(Vn,`sessions/${O}`),M),t(O),n(!0),p(M.unlockedChapters),console.log("[Session] Created Firebase session:",O),O}catch(O){console.error("[Session] Firebase error:",O)}return hf(A,M),t(A),n(!0),p(M.unlockedChapters),a(M.participants),console.log("[Session] Created local session:",A),A},[r]),x=Ne.useCallback(async A=>{const M=A.toUpperCase().trim();if(Vn)try{const V=qa(Vn,`sessions/${M}`);if((await lW(V)).exists())return await Sf(qa(Vn,`sessions/${M}/participants/${r}`),{role:"student",joinedAt:Date.now()}),t(M),n(!1),console.log("[Session] Joined Firebase session:",M),!0}catch(V){console.error("[Session] Firebase error:",V)}const O=uf(M);return O?(O.participants[r]={role:"student",joinedAt:Date.now()},hf(M,O),t(M),n(!1),p(O.unlockedChapters),a(O.participants),console.log("[Session] Joined local session:",M),!0):(console.log("[Session] Session not found:",M),!1)},[r]),S=Ne.useCallback(async()=>{if(e){if(Vn)try{i?await aW(qa(Vn,`sessions/${e}`)):await aW(qa(Vn,`sessions/${e}/participants/${r}`))}catch(A){console.error("[Session] Firebase error:",A)}if(i)Ohe(e);else{const A=uf(e);A&&(delete A.participants[r],hf(e,A))}t(null),n(!1),a({}),c(null),d([]),p({}),console.log("[Session] Left session")}},[e,i,r]),y=Ne.useCallback((A,M,O)=>{if(!e)return;const V={content:A,chapterId:M,challengeIndex:O,lastUpdated:Date.now()};if(Vn)Sf(qa(Vn,`sessions/${e}/studentCode`),V).catch(console.error);else{const H=uf(e);H&&(H.studentCode=V,hf(e,H))}},[e]),k=Ne.useCallback(A=>{if(!(!e||i))if(Vn)Sf(qa(Vn,`sessions/${e}/studentOutput`),A).catch(console.error);else{const M=uf(e);M&&(M.studentOutput=A,hf(e,M))}},[e,i]),D=Ne.useCallback(A=>{if(!(!e||!i))if(console.log("[Session] Unlocking chapter:",A),Vn)Sf(qa(Vn,`sessions/${e}/unlockedChapters/${A}`),!0).catch(console.error);else{const M=uf(e);M&&(M.unlockedChapters[A]=!0,hf(e,M),p({...M.unlockedChapters}))}},[e,i]),R=Ne.useCallback(A=>{if(!(!e||!i))if(console.log("[Session] Locking chapter:",A),Vn)Sf(qa(Vn,`sessions/${e}/unlockedChapters/${A}`),!1).catch(console.error);else{const M=uf(e);M&&(M.unlockedChapters[A]=!1,hf(e,M),p({...M.unlockedChapters}))}},[e,i]),N={sessionCode:e,isInSession:b,isTeacher:i,participantId:r,participants:o,createSession:C,joinSession:x,leaveSession:S,syncCode:y,syncOutput:k,studentCode:l,studentOutput:h,sessionUnlockedChapters:g,unlockChapter:D,lockChapter:R};return K.jsx(IY.Provider,{value:N,children:s})},Eo=()=>new Map,GA=s=>{const e=Eo();return s.forEach((t,i)=>{e.set(i,t)}),e},la=(s,e,t)=>{let i=s.get(e);return i===void 0&&s.set(e,i=t()),i},Fhe=(s,e)=>{const t=[];for(const[i,n]of s)t.push(e(n,i));return t},Bhe=(s,e)=>{for(const[t,i]of s)if(e(i,t))return!0;return!1},Dd=()=>new Set,FI=s=>s[s.length-1],Vhe=(s,e)=>{for(let t=0;t<e.length;t++)s.push(e[t])},Zu=Array.from,Hhe=Array.isArray;class MY{constructor(){this._observers=Eo()}on(e,t){return la(this._observers,e,Dd).add(t),t}once(e,t){const i=(...n)=>{this.off(e,i),t(...n)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return Zu((this._observers.get(e)||Eo()).values()).forEach(i=>i(...t))}destroy(){this._observers=Eo()}}class OY{constructor(){this._observers=Eo()}on(e,t){la(this._observers,e,Dd).add(t)}once(e,t){const i=(...n)=>{this.off(e,i),t(...n)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return Zu((this._observers.get(e)||Eo()).values()).forEach(i=>i(...t))}destroy(){this._observers=Eo()}}const uc=Math.floor,Fx=Math.abs,Whe=Math.log10,ZP=(s,e)=>s<e?s:e,wm=(s,e)=>s>e?s:e,PY=s=>s!==0?s<0:1/s<0,uW=1,hW=2,BI=4,VI=8,av=32,Wu=64,sa=128,GE=31,KA=63,wg=127,zhe=2147483647,FY=Number.MAX_SAFE_INTEGER,Uhe=Number.isInteger||(s=>typeof s=="number"&&isFinite(s)&&uc(s)===s),jhe=String.fromCharCode,$he=s=>s.toLowerCase(),qhe=/^\s*/g,Ghe=s=>s.replace(qhe,""),Khe=/([A-Z])/g,dW=(s,e)=>Ghe(s.replace(Khe,t=>`${e}${$he(t)}`)),Yhe=s=>{const e=unescape(encodeURIComponent(s)),t=e.length,i=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e.codePointAt(n);return i},lv=typeof TextEncoder<"u"?new TextEncoder:null,Qhe=s=>lv.encode(s),YA=lv?Qhe:Yhe;let q0=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});q0&&q0.decode(new Uint8Array).length===1&&(q0=null);class NC{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const js=()=>new NC,Xhe=s=>{let e=s.cpos;for(let t=0;t<s.bufs.length;t++)e+=s.bufs[t].length;return e},kn=s=>{const e=new Uint8Array(Xhe(s));let t=0;for(let i=0;i<s.bufs.length;i++){const n=s.bufs[i];e.set(n,t),t+=n.length}return e.set(new Uint8Array(s.cbuf.buffer,0,s.cpos),t),e},Zhe=(s,e)=>{const t=s.cbuf.length;t-s.cpos<e&&(s.bufs.push(new Uint8Array(s.cbuf.buffer,0,s.cpos)),s.cbuf=new Uint8Array(wm(t,e)*2),s.cpos=0)},Bs=(s,e)=>{const t=s.cbuf.length;s.cpos===t&&(s.bufs.push(s.cbuf),s.cbuf=new Uint8Array(t*2),s.cpos=0),s.cbuf[s.cpos++]=e},cv=Bs,ft=(s,e)=>{for(;e>wg;)Bs(s,sa|wg&e),e=uc(e/128);Bs(s,wg&e)},JP=(s,e)=>{const t=PY(e);for(t&&(e=-e),Bs(s,(e>KA?sa:0)|(t?Wu:0)|KA&e),e=uc(e/64);e>0;)Bs(s,(e>wg?sa:0)|wg&e),e=uc(e/128)},QA=new Uint8Array(3e4),Jhe=QA.length/3,ede=(s,e)=>{if(e.length<Jhe){const t=lv.encodeInto(e,QA).written||0;ft(s,t);for(let i=0;i<t;i++)Bs(s,QA[i])}else Un(s,YA(e))},tde=(s,e)=>{const t=unescape(encodeURIComponent(e)),i=t.length;ft(s,i);for(let n=0;n<i;n++)Bs(s,t.codePointAt(n))},tc=lv&&lv.encodeInto?ede:tde,KE=(s,e)=>{const t=s.cbuf.length,i=s.cpos,n=ZP(t-i,e.length),r=e.length-n;s.cbuf.set(e.subarray(0,n),i),s.cpos+=n,r>0&&(s.bufs.push(s.cbuf),s.cbuf=new Uint8Array(wm(t*2,r)),s.cbuf.set(e.subarray(n)),s.cpos=r)},Un=(s,e)=>{ft(s,e.byteLength),KE(s,e)},e6=(s,e)=>{Zhe(s,e);const t=new DataView(s.cbuf.buffer,s.cpos,e);return s.cpos+=e,t},ide=(s,e)=>e6(s,4).setFloat32(0,e,!1),nde=(s,e)=>e6(s,8).setFloat64(0,e,!1),sde=(s,e)=>e6(s,8).setBigInt64(0,e,!1),fW=new DataView(new ArrayBuffer(4)),rde=s=>(fW.setFloat32(0,s),fW.getFloat32(0)===s),c1=(s,e)=>{switch(typeof e){case"string":Bs(s,119),tc(s,e);break;case"number":Uhe(e)&&Fx(e)<=zhe?(Bs(s,125),JP(s,e)):rde(e)?(Bs(s,124),ide(s,e)):(Bs(s,123),nde(s,e));break;case"bigint":Bs(s,122),sde(s,e);break;case"object":if(e===null)Bs(s,126);else if(Hhe(e)){Bs(s,117),ft(s,e.length);for(let t=0;t<e.length;t++)c1(s,e[t])}else if(e instanceof Uint8Array)Bs(s,116),Un(s,e);else{Bs(s,118);const t=Object.keys(e);ft(s,t.length);for(let i=0;i<t.length;i++){const n=t[i];tc(s,n),c1(s,e[n])}}break;case"boolean":Bs(s,e?120:121);break;default:Bs(s,127)}};class gW extends NC{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&ft(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const mW=s=>{s.count>0&&(JP(s.encoder,s.count===1?s.s:-s.s),s.count>1&&ft(s.encoder,s.count-2))};class Bx{constructor(){this.encoder=new NC,this.s=0,this.count=0}write(e){this.s===e?this.count++:(mW(this),this.count=1,this.s=e)}toUint8Array(){return mW(this),kn(this.encoder)}}const pW=s=>{if(s.count>0){const e=s.diff*2+(s.count===1?0:1);JP(s.encoder,e),s.count>1&&ft(s.encoder,s.count-2)}};class HI{constructor(){this.encoder=new NC,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(pW(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return pW(this),kn(this.encoder)}}class ode{constructor(){this.sarr=[],this.s="",this.lensE=new Bx}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new NC;return this.sarr.push(this.s),this.s="",tc(e,this.sarr.join("")),KE(e,this.lensE.toUint8Array()),kn(e)}}const hc=s=>new Error(s),ic=()=>{throw hc("Method unimplemented")},Ma=()=>{throw hc("Unexpected case")},BY=hc("Unexpected end of array"),VY=hc("Integer out of Range");class YE{constructor(e){this.arr=e,this.pos=0}}const xc=s=>new YE(s),ade=s=>s.pos!==s.arr.length,lde=(s,e)=>{const t=new Uint8Array(s.arr.buffer,s.pos+s.arr.byteOffset,e);return s.pos+=e,t},Hs=s=>lde(s,Pt(s)),Kg=s=>s.arr[s.pos++],Pt=s=>{let e=0,t=1;const i=s.arr.length;for(;s.pos<i;){const n=s.arr[s.pos++];if(e=e+(n&wg)*t,t*=128,n<sa)return e;if(e>FY)throw VY}throw BY},t6=s=>{let e=s.arr[s.pos++],t=e&KA,i=64;const n=(e&Wu)>0?-1:1;if((e&sa)===0)return n*t;const r=s.arr.length;for(;s.pos<r;){if(e=s.arr[s.pos++],t=t+(e&wg)*i,i*=128,e<sa)return n*t;if(t>FY)throw VY}throw BY},cde=s=>{let e=Pt(s);if(e===0)return"";{let t=String.fromCodePoint(Kg(s));if(--e<100)for(;e--;)t+=String.fromCodePoint(Kg(s));else for(;e>0;){const i=e<1e4?e:1e4,n=s.arr.subarray(s.pos,s.pos+i);s.pos+=i,t+=String.fromCodePoint.apply(null,n),e-=i}return decodeURIComponent(escape(t))}},ude=s=>q0.decode(Hs(s)),zu=q0?ude:cde,i6=(s,e)=>{const t=new DataView(s.arr.buffer,s.arr.byteOffset+s.pos,e);return s.pos+=e,t},hde=s=>i6(s,4).getFloat32(0,!1),dde=s=>i6(s,8).getFloat64(0,!1),fde=s=>i6(s,8).getBigInt64(0,!1),gde=[s=>{},s=>null,t6,hde,dde,fde,s=>!1,s=>!0,zu,s=>{const e=Pt(s),t={};for(let i=0;i<e;i++){const n=zu(s);t[n]=u1(s)}return t},s=>{const e=Pt(s),t=[];for(let i=0;i<e;i++)t.push(u1(s));return t},Hs],u1=s=>gde[127-Kg(s)](s);class _W extends YE{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),ade(this)?this.count=Pt(this)+1:this.count=-1),this.count--,this.s}}class Vx extends YE{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=t6(this);const e=PY(this.s);this.count=1,e&&(this.s=-this.s,this.count=Pt(this)+2)}return this.count--,this.s}}class WI extends YE{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=t6(this),t=e&1;this.diff=uc(e/2),this.count=1,t&&(this.count=Pt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class mde{constructor(e){this.decoder=new Vx(e),this.str=zu(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const pde=crypto.getRandomValues.bind(crypto),_de=Math.random,HY=()=>pde(new Uint32Array(1))[0],bde="10000000-1000-4000-8000"+-1e11,WY=()=>bde.replace(/[018]/g,s=>(s^HY()&15>>s/4).toString(16)),Ju=Date.now,bW=s=>new Promise(s);Promise.all.bind(Promise);const wde=s=>Promise.reject(s),n6=s=>Promise.resolve(s),wW=s=>s===void 0?null:s;class vde{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let zY=new vde,s6=!0;try{typeof localStorage<"u"&&localStorage&&(zY=localStorage,s6=!1)}catch{}const UY=zY,Cde=s=>s6||addEventListener("storage",s),yde=s=>s6||removeEventListener("storage",s),Sde=Object.assign,jY=Object.keys,xde=(s,e)=>{for(const t in s)e(s[t],t)},vW=s=>jY(s).length,CW=s=>jY(s).length,Lde=s=>{for(const e in s)return!1;return!0},kde=(s,e)=>{for(const t in s)if(!e(s[t],t))return!1;return!0},$Y=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),Ede=(s,e)=>s===e||CW(s)===CW(e)&&kde(s,(t,i)=>(t!==void 0||$Y(e,i))&&e[i]===t),Dde=Object.freeze,qY=s=>{for(const e in s){const t=s[e];(typeof t=="object"||typeof t=="function")&&qY(s[e])}return Dde(s)},yW=Symbol("Equality"),r6=(s,e,t=0)=>{try{for(;t<s.length;t++)s[t](...e)}finally{t<s.length&&r6(s,e,t+1)}},Tde=()=>{},Nde=s=>s,G0=(s,e)=>{if(s===e)return!0;if(s==null||e==null||s.constructor!==e.constructor)return!1;if(s[yW]!=null)return s[yW](e);switch(s.constructor){case ArrayBuffer:s=new Uint8Array(s),e=new Uint8Array(e);case Uint8Array:{if(s.byteLength!==e.byteLength)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;break}case Set:{if(s.size!==e.size)return!1;for(const t of s)if(!e.has(t))return!1;break}case Map:{if(s.size!==e.size)return!1;for(const t of s.keys())if(!e.has(t)||!G0(s.get(t),e.get(t)))return!1;break}case Object:if(vW(s)!==vW(e))return!1;for(const t in s)if(!$Y(s,t)||!G0(s[t],e[t]))return!1;break;case Array:if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!G0(s[t],e[t]))return!1;break;default:return!1}return!0},Ide=(s,e)=>e.includes(s);var GY={};const h1=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",KY=typeof window<"u"&&typeof document<"u"&&!h1;let Il;const Rde=()=>{if(Il===void 0)if(h1){Il=Eo();const s=process.argv;let e=null;for(let t=0;t<s.length;t++){const i=s[t];i[0]==="-"?(e!==null&&Il.set(e,""),e=i):e!==null&&(Il.set(e,i),e=null)}e!==null&&Il.set(e,"")}else typeof location=="object"?(Il=Eo(),(location.search||"?").slice(1).split("&").forEach(s=>{if(s.length!==0){const[e,t]=s.split("=");Il.set(`--${dW(e,"-")}`,t),Il.set(`-${dW(e,"-")}`,t)}})):Il=Eo();return Il},XA=s=>Rde().has(s),uv=s=>wW(h1?GY[s.toUpperCase().replaceAll("-","_")]:UY.getItem(s)),YY=s=>XA("--"+s)||uv(s)!==null;YY("production");const Ade=h1&&Ide(GY.FORCE_COLOR,["true","1","2"]),Mde=Ade||!XA("--no-colors")&&!YY("no-color")&&(!h1||process.stdout.isTTY)&&(!h1||XA("--color")||uv("COLORTERM")!==null||(uv("TERM")||"").includes("color")),QY=s=>new Uint8Array(s),Ode=(s,e,t)=>new Uint8Array(s,e,t),Pde=s=>new Uint8Array(s),Fde=s=>{let e="";for(let t=0;t<s.byteLength;t++)e+=jhe(s[t]);return btoa(e)},Bde=s=>Buffer.from(s.buffer,s.byteOffset,s.byteLength).toString("base64"),Vde=s=>{const e=atob(s),t=QY(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t},Hde=s=>{const e=Buffer.from(s,"base64");return Ode(e.buffer,e.byteOffset,e.byteLength)},XY=KY?Fde:Bde,ZY=KY?Vde:Hde,Wde=s=>{const e=QY(s.byteLength);return e.set(s),e};class zde{constructor(e,t){this.left=e,this.right=t}}const Jc=(s,e)=>new zde(s,e);typeof DOMParser<"u"&&new DOMParser;const Ude=s=>Fhe(s,(e,t)=>`${t}:${e};`).join(""),jde=JSON.stringify,rh=Symbol,Ta=rh(),Yg=rh(),JY=rh(),o6=rh(),eQ=rh(),tQ=rh(),iQ=rh(),QE=rh(),XE=rh(),$de=s=>{var n;s.length===1&&((n=s[0])==null?void 0:n.constructor)===Function&&(s=s[0]());const e=[],t=[];let i=0;for(;i<s.length;i++){const r=s[i];if(r===void 0)break;if(r.constructor===String||r.constructor===Number)e.push(r);else if(r.constructor===Object)break}for(i>0&&t.push(e.join(""));i<s.length;i++){const r=s[i];r instanceof Symbol||t.push(r)}return t},SW=[eQ,iQ,QE,JY];let zI=0,xW=Ju();const qde=(s,e)=>{const t=SW[zI],i=uv("log"),n=i!==null&&(i==="*"||i==="true"||new RegExp(i,"gi").test(e));return zI=(zI+1)%SW.length,e+=": ",n?(...r)=>{var l;r.length===1&&((l=r[0])==null?void 0:l.constructor)===Function&&(r=r[0]());const o=Ju(),a=o-xW;xW=o,s(t,e,XE,...r.map(c=>{switch(c!=null&&c.constructor===Uint8Array&&(c=Array.from(c)),typeof c){case"string":case"symbol":return c;default:return jde(c)}}),t," +"+a+"ms")}:Tde},Gde={[Ta]:Jc("font-weight","bold"),[Yg]:Jc("font-weight","normal"),[JY]:Jc("color","blue"),[eQ]:Jc("color","green"),[o6]:Jc("color","grey"),[tQ]:Jc("color","red"),[iQ]:Jc("color","purple"),[QE]:Jc("color","orange"),[XE]:Jc("color","black")},Kde=s=>{var o;s.length===1&&((o=s[0])==null?void 0:o.constructor)===Function&&(s=s[0]());const e=[],t=[],i=Eo();let n=[],r=0;for(;r<s.length;r++){const a=s[r],l=Gde[a];if(l!==void 0)i.set(l.left,l.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const c=Ude(i);r>0||c.length>0?(e.push("%c"+a),t.push(c)):e.push(a)}else break}}for(r>0&&(n=t,n.unshift(e.join("")));r<s.length;r++){const a=s[r];a instanceof Symbol||n.push(a)}return n},nQ=Mde?Kde:$de,sQ=(...s)=>{console.log(...nQ(s)),rQ.forEach(e=>e.print(s))},Yde=(...s)=>{console.warn(...nQ(s)),s.unshift(QE),rQ.forEach(e=>e.print(s))},rQ=Dd(),Qde=s=>qde(sQ,s),oQ=s=>({[Symbol.iterator](){return this},next:s}),Xde=(s,e)=>oQ(()=>{let t;do t=s.next();while(!t.done&&!e(t.value));return t}),UI=(s,e)=>oQ(()=>{const{done:t,value:i}=s.next();return{done:t,value:t?void 0:e(i)}});class a6{constructor(e,t){this.clock=e,this.len=t}}class IC{constructor(){this.clients=new Map}}const aQ=(s,e,t)=>e.clients.forEach((i,n)=>{const r=s.doc.store.clients.get(n);if(r!=null){const o=r[r.length-1],a=o.id.clock+o.length;for(let l=0,c=i[l];l<i.length&&c.clock<a;c=i[++l])CQ(s,r,c.clock,c.len,t)}}),Zde=(s,e)=>{let t=0,i=s.length-1;for(;t<=i;){const n=uc((t+i)/2),r=s[n],o=r.clock;if(o<=e){if(e<o+r.len)return n;t=n+1}else i=n-1}return null},lQ=(s,e)=>{const t=s.clients.get(e.client);return t!==void 0&&Zde(t,e.clock)!==null},l6=s=>{s.clients.forEach(e=>{e.sort((n,r)=>n.clock-r.clock);let t,i;for(t=1,i=1;t<e.length;t++){const n=e[i-1],r=e[t];n.clock+n.len>=r.clock?n.len=wm(n.len,r.clock+r.len-n.clock):(i<t&&(e[i]=r),i++)}e.length=i})},Jde=s=>{const e=new IC;for(let t=0;t<s.length;t++)s[t].clients.forEach((i,n)=>{if(!e.clients.has(n)){const r=i.slice();for(let o=t+1;o<s.length;o++)Vhe(r,s[o].clients.get(n)||[]);e.clients.set(n,r)}});return l6(e),e},ML=(s,e,t,i)=>{la(s.clients,e,()=>[]).push(new a6(t,i))},efe=()=>new IC,tfe=s=>{const e=efe();return s.clients.forEach((t,i)=>{const n=[];for(let r=0;r<t.length;r++){const o=t[r];if(o.deleted){const a=o.id.clock;let l=o.length;if(r+1<t.length)for(let c=t[r+1];r+1<t.length&&c.deleted;c=t[++r+1])l+=c.length;n.push(new a6(a,l))}}n.length>0&&e.clients.set(i,n)}),e},U1=(s,e)=>{ft(s.restEncoder,e.clients.size),Zu(e.clients.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{s.resetDsCurVal(),ft(s.restEncoder,t);const n=i.length;ft(s.restEncoder,n);for(let r=0;r<n;r++){const o=i[r];s.writeDsClock(o.clock),s.writeDsLen(o.len)}})},c6=s=>{const e=new IC,t=Pt(s.restDecoder);for(let i=0;i<t;i++){s.resetDsCurVal();const n=Pt(s.restDecoder),r=Pt(s.restDecoder);if(r>0){const o=la(e.clients,n,()=>[]);for(let a=0;a<r;a++)o.push(new a6(s.readDsClock(),s.readDsLen()))}}return e},LW=(s,e,t)=>{const i=new IC,n=Pt(s.restDecoder);for(let r=0;r<n;r++){s.resetDsCurVal();const o=Pt(s.restDecoder),a=Pt(s.restDecoder),l=t.clients.get(o)||[],c=ws(t,o);for(let h=0;h<a;h++){const d=s.readDsClock(),g=d+s.readDsLen();if(d<c){c<g&&ML(i,o,c,g-c);let p=dc(l,d),_=l[p];for(!_.deleted&&_.id.clock<d&&(l.splice(p+1,0,UL(e,_,d-_.id.clock)),p++);p<l.length&&(_=l[p++],_.id.clock<g);)_.deleted||(g<_.id.clock+_.length&&l.splice(p,0,UL(e,_,g-_.id.clock)),_.delete(e))}else ML(i,o,d,g-d)}}if(i.clients.size>0){const r=new Qg;return ft(r.restEncoder,0),U1(r,i),r.toUint8Array()}return null},cQ=HY;class j1 extends MY{constructor({guid:e=WY(),collectionid:t=null,gc:i=!0,gcFilter:n=()=>!0,meta:r=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=i,this.gcFilter=n,this.clientID=cQ(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new wQ,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=r,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=bW(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>bW(c=>{const h=d=>{(d===void 0||d===!0)&&(this.off("sync",h),c())};this.on("sync",h)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&un(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Zu(this.subdocs).map(e=>e.guid))}transact(e,t=null){return un(this,e,t)}get(e,t=ur){const i=la(this.share,e,()=>{const r=new t;return r._integrate(this,null),r}),n=i.constructor;if(t!==ur&&n!==t)if(n===ur){const r=new t;r._map=i._map,i._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=r}),r._start=i._start;for(let o=r._start;o!==null;o=o.right)o.parent=r;return r._length=i._length,this.share.set(e,r),r._integrate(this,null),r}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,I_)}getText(e=""){return this.get(e,g1)}getMap(e=""){return this.get(e,f1)}getXmlElement(e=""){return this.get(e,m1)}getXmlFragment(e=""){return this.get(e,Xg)}toJSON(){const e={};return this.share.forEach((t,i)=>{e[i]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,Zu(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new j1({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,un(e.parent.doc,i=>{const n=t.doc;e.deleted||i.subdocsAdded.add(n),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class uQ{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Pt(this.restDecoder)}readDsLen(){return Pt(this.restDecoder)}}class hQ extends uQ{readLeftID(){return Xt(Pt(this.restDecoder),Pt(this.restDecoder))}readRightID(){return Xt(Pt(this.restDecoder),Pt(this.restDecoder))}readClient(){return Pt(this.restDecoder)}readInfo(){return Kg(this.restDecoder)}readString(){return zu(this.restDecoder)}readParentInfo(){return Pt(this.restDecoder)===1}readTypeRef(){return Pt(this.restDecoder)}readLen(){return Pt(this.restDecoder)}readAny(){return u1(this.restDecoder)}readBuf(){return Wde(Hs(this.restDecoder))}readJSON(){return JSON.parse(zu(this.restDecoder))}readKey(){return zu(this.restDecoder)}}class ife{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Pt(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Pt(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class d1 extends ife{constructor(e){super(e),this.keys=[],Pt(e),this.keyClockDecoder=new WI(Hs(e)),this.clientDecoder=new Vx(Hs(e)),this.leftClockDecoder=new WI(Hs(e)),this.rightClockDecoder=new WI(Hs(e)),this.infoDecoder=new _W(Hs(e),Kg),this.stringDecoder=new mde(Hs(e)),this.parentInfoDecoder=new _W(Hs(e),Kg),this.typeRefDecoder=new Vx(Hs(e)),this.lenDecoder=new Vx(Hs(e))}readLeftID(){return new T_(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new T_(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return u1(this.restDecoder)}readBuf(){return Hs(this.restDecoder)}readJSON(){return u1(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class dQ{constructor(){this.restEncoder=js()}toUint8Array(){return kn(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){ft(this.restEncoder,e)}writeDsLen(e){ft(this.restEncoder,e)}}class RC extends dQ{writeLeftID(e){ft(this.restEncoder,e.client),ft(this.restEncoder,e.clock)}writeRightID(e){ft(this.restEncoder,e.client),ft(this.restEncoder,e.clock)}writeClient(e){ft(this.restEncoder,e)}writeInfo(e){cv(this.restEncoder,e)}writeString(e){tc(this.restEncoder,e)}writeParentInfo(e){ft(this.restEncoder,e?1:0)}writeTypeRef(e){ft(this.restEncoder,e)}writeLen(e){ft(this.restEncoder,e)}writeAny(e){c1(this.restEncoder,e)}writeBuf(e){Un(this.restEncoder,e)}writeJSON(e){tc(this.restEncoder,JSON.stringify(e))}writeKey(e){tc(this.restEncoder,e)}}class fQ{constructor(){this.restEncoder=js(),this.dsCurrVal=0}toUint8Array(){return kn(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,ft(this.restEncoder,t)}writeDsLen(e){e===0&&Ma(),ft(this.restEncoder,e-1),this.dsCurrVal+=e}}class Qg extends fQ{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new HI,this.clientEncoder=new Bx,this.leftClockEncoder=new HI,this.rightClockEncoder=new HI,this.infoEncoder=new gW(cv),this.stringEncoder=new ode,this.parentInfoEncoder=new gW(cv),this.typeRefEncoder=new Bx,this.lenEncoder=new Bx}toUint8Array(){const e=js();return ft(e,0),Un(e,this.keyClockEncoder.toUint8Array()),Un(e,this.clientEncoder.toUint8Array()),Un(e,this.leftClockEncoder.toUint8Array()),Un(e,this.rightClockEncoder.toUint8Array()),Un(e,kn(this.infoEncoder)),Un(e,this.stringEncoder.toUint8Array()),Un(e,kn(this.parentInfoEncoder)),Un(e,this.typeRefEncoder.toUint8Array()),Un(e,this.lenEncoder.toUint8Array()),KE(e,kn(this.restEncoder)),kn(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){c1(this.restEncoder,e)}writeBuf(e){Un(this.restEncoder,e)}writeJSON(e){c1(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const nfe=(s,e,t,i)=>{i=wm(i,e[0].id.clock);const n=dc(e,i);ft(s.restEncoder,e.length-n),s.writeClient(t),ft(s.restEncoder,i);const r=e[n];r.write(s,i-r.id.clock);for(let o=n+1;o<e.length;o++)e[o].write(s,0)},u6=(s,e,t)=>{const i=new Map;t.forEach((n,r)=>{ws(e,r)>n&&i.set(r,n)}),ZE(e).forEach((n,r)=>{t.has(r)||i.set(r,0)}),ft(s.restEncoder,i.size),Zu(i.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{nfe(s,e.clients.get(n),n,r)})},sfe=(s,e)=>{const t=Eo(),i=Pt(s.restDecoder);for(let n=0;n<i;n++){const r=Pt(s.restDecoder),o=new Array(r),a=s.readClient();let l=Pt(s.restDecoder);t.set(a,{i:0,refs:o});for(let c=0;c<r;c++){const h=s.readInfo();switch(GE&h){case 0:{const d=s.readLen();o[c]=new ka(Xt(a,l),d),l+=d;break}case 10:{const d=Pt(s.restDecoder);o[c]=new Ea(Xt(a,l),d),l+=d;break}default:{const d=(h&(Wu|sa))===0,g=new qn(Xt(a,l),null,(h&sa)===sa?s.readLeftID():null,null,(h&Wu)===Wu?s.readRightID():null,d?s.readParentInfo()?e.get(s.readString()):s.readLeftID():null,d&&(h&av)===av?s.readString():null,HQ(s,h));o[c]=g,l+=g.length}}}}return t},rfe=(s,e,t)=>{const i=[];let n=Zu(t.keys()).sort((p,_)=>p-_);if(n.length===0)return null;const r=()=>{if(n.length===0)return null;let p=t.get(n[n.length-1]);for(;p.refs.length===p.i;)if(n.pop(),n.length>0)p=t.get(n[n.length-1]);else return null;return p};let o=r();if(o===null)return null;const a=new wQ,l=new Map,c=(p,_)=>{const b=l.get(p);(b==null||b>_)&&l.set(p,_)};let h=o.refs[o.i++];const d=new Map,g=()=>{for(const p of i){const _=p.id.client,b=t.get(_);b?(b.i--,a.clients.set(_,b.refs.slice(b.i)),t.delete(_),b.i=0,b.refs=[]):a.clients.set(_,[p]),n=n.filter(C=>C!==_)}i.length=0};for(;;){if(h.constructor!==Ea){const _=la(d,h.id.client,()=>ws(e,h.id.client))-h.id.clock;if(_<0)i.push(h),c(h.id.client,h.id.clock-1),g();else{const b=h.getMissing(s,e);if(b!==null){i.push(h);const C=t.get(b)||{refs:[],i:0};if(C.refs.length===C.i)c(b,ws(e,b)),g();else{h=C.refs[C.i++];continue}}else(_===0||_<h.length)&&(h.integrate(s,_),d.set(h.id.client,h.id.clock+h.length))}}if(i.length>0)h=i.pop();else if(o!==null&&o.i<o.refs.length)h=o.refs[o.i++];else{if(o=r(),o===null)break;h=o.refs[o.i++]}}if(a.clients.size>0){const p=new Qg;return u6(p,a,new Map),ft(p.restEncoder,0),{missing:l,update:p.toUint8Array()}}return null},ofe=(s,e)=>u6(s,e.doc.store,e.beforeState),afe=(s,e,t,i=new d1(s))=>un(e,n=>{n.local=!1;let r=!1;const o=n.doc,a=o.store,l=sfe(i,o),c=rfe(n,a,l),h=a.pendingStructs;if(h){for(const[g,p]of h.missing)if(p<ws(a,g)){r=!0;break}if(c){for(const[g,p]of c.missing){const _=h.missing.get(g);(_==null||_>p)&&h.missing.set(g,p)}h.update=FL([h.update,c.update])}}else a.pendingStructs=c;const d=LW(i,n,a);if(a.pendingDs){const g=new d1(xc(a.pendingDs));Pt(g.restDecoder);const p=LW(g,n,a);d&&p?a.pendingDs=FL([d,p]):a.pendingDs=d||p}else a.pendingDs=d;if(r){const g=a.pendingStructs.update;a.pendingStructs=null,gQ(n.doc,g)}},t,!1),gQ=(s,e,t,i=d1)=>{const n=xc(e);afe(n,s,t,new i(n))},lfe=(s,e,t)=>gQ(s,e,t,hQ),cfe=(s,e,t=new Map)=>{u6(s,e.store,t),U1(s,tfe(e.store))},ufe=(s,e=new Uint8Array([0]),t=new Qg)=>{const i=mQ(e);cfe(t,s,i);const n=[t.toUint8Array()];if(s.store.pendingDs&&n.push(s.store.pendingDs),s.store.pendingStructs&&n.push(Tfe(s.store.pendingStructs.update,e)),n.length>1){if(t.constructor===RC)return Efe(n.map((r,o)=>o===0?r:Ife(r)));if(t.constructor===Qg)return FL(n)}return n[0]},hfe=(s,e)=>ufe(s,e,new RC),dfe=s=>{const e=new Map,t=Pt(s.restDecoder);for(let i=0;i<t;i++){const n=Pt(s.restDecoder),r=Pt(s.restDecoder);e.set(n,r)}return e},mQ=s=>dfe(new uQ(xc(s))),pQ=(s,e)=>(ft(s.restEncoder,e.size),Zu(e.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{ft(s.restEncoder,t),ft(s.restEncoder,i)}),s),ffe=(s,e)=>pQ(s,ZE(e.store)),gfe=(s,e=new fQ)=>(s instanceof Map?pQ(e,s):ffe(e,s),e.toUint8Array()),mfe=s=>gfe(s,new dQ);class pfe{constructor(){this.l=[]}}const kW=()=>new pfe,EW=(s,e)=>s.l.push(e),DW=(s,e)=>{const t=s.l,i=t.length;s.l=t.filter(n=>e!==n),i===s.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},_Q=(s,e,t)=>r6(s.l,[e,t]);class T_{constructor(e,t){this.client=e,this.clock=t}}const MS=(s,e)=>s===e||s!==null&&e!==null&&s.client===e.client&&s.clock===e.clock,Xt=(s,e)=>new T_(s,e),bQ=s=>{for(const[e,t]of s.doc.share.entries())if(t===s)return e;throw Ma()};class _fe{constructor(e,t,i,n=0){this.type=e,this.tname=t,this.item=i,this.assoc=n}}class bfe{constructor(e,t,i=0){this.type=e,this.index=t,this.assoc=i}}const wfe=(s,e,t=0)=>new bfe(s,e,t),OS=(s,e,t)=>{let i=null,n=null;return s._item===null?n=bQ(s):i=Xt(s._item.id.client,s._item.id.clock),new _fe(i,n,e,t)},OL=(s,e,t=0)=>{let i=s._start;if(t<0){if(e===0)return OS(s,null,t);e--}for(;i!==null;){if(!i.deleted&&i.countable){if(i.length>e)return OS(s,Xt(i.id.client,i.id.clock+e),t);e-=i.length}if(i.right===null&&t<0)return OS(s,i.lastId,t);i=i.right}return OS(s,null,t)},vfe=(s,e)=>{const t=N_(s,e),i=e.clock-t.id.clock;return{item:t,diff:i}},PL=(s,e,t=!0)=>{const i=e.store,n=s.item,r=s.type,o=s.tname,a=s.assoc;let l=null,c=0;if(n!==null){if(ws(i,n.client)<=n.clock)return null;const h=t?PW(i,n):vfe(i,n),d=h.item;if(!(d instanceof qn))return null;if(l=d.parent,l._item===null||!l._item.deleted){c=d.deleted||!d.countable?0:h.diff+(a>=0?0:1);let g=d.left;for(;g!==null;)!g.deleted&&g.countable&&(c+=g.length),g=g.left}}else{if(o!==null)l=e.get(o);else if(r!==null){if(ws(i,r.client)<=r.clock)return null;const{item:h}=t?PW(i,r):{item:N_(i,r)};if(h instanceof qn&&h.content instanceof Lc)l=h.content.type;else return null}else throw Ma();a>=0?c=l._length:c=0}return wfe(l,c,s.assoc)},zp=(s,e)=>e===void 0?!s.deleted:e.sv.has(s.id.client)&&(e.sv.get(s.id.client)||0)>s.id.clock&&!lQ(e.ds,s.id),ZA=(s,e)=>{const t=la(s.meta,ZA,Dd),i=s.doc.store;t.has(e)||(e.sv.forEach((n,r)=>{n<ws(i,r)&&Td(s,Xt(r,n))}),aQ(s,e.ds,n=>{}),t.add(e))};class wQ{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const ZE=s=>{const e=new Map;return s.clients.forEach((t,i)=>{const n=t[t.length-1];e.set(i,n.id.clock+n.length)}),e},ws=(s,e)=>{const t=s.clients.get(e);if(t===void 0)return 0;const i=t[t.length-1];return i.id.clock+i.length},vQ=(s,e)=>{let t=s.clients.get(e.id.client);if(t===void 0)t=[],s.clients.set(e.id.client,t);else{const i=t[t.length-1];if(i.id.clock+i.length!==e.id.clock)throw Ma()}t.push(e)},dc=(s,e)=>{let t=0,i=s.length-1,n=s[i],r=n.id.clock;if(r===e)return i;let o=uc(e/(r+n.length-1)*i);for(;t<=i;){if(n=s[o],r=n.id.clock,r<=e){if(e<r+n.length)return o;t=o+1}else i=o-1;o=uc((t+i)/2)}throw Ma()},Cfe=(s,e)=>{const t=s.clients.get(e.client);return t[dc(t,e.clock)]},N_=Cfe,JA=(s,e,t)=>{const i=dc(e,t),n=e[i];return n.id.clock<t&&n instanceof qn?(e.splice(i+1,0,UL(s,n,t-n.id.clock)),i+1):i},Td=(s,e)=>{const t=s.doc.store.clients.get(e.client);return t[JA(s,t,e.clock)]},TW=(s,e,t)=>{const i=e.clients.get(t.client),n=dc(i,t.clock),r=i[n];return t.clock!==r.id.clock+r.length-1&&r.constructor!==ka&&i.splice(n+1,0,UL(s,r,t.clock-r.id.clock+1)),r},yfe=(s,e,t)=>{const i=s.clients.get(e.id.client);i[dc(i,e.id.clock)]=t},CQ=(s,e,t,i,n)=>{if(i===0)return;const r=t+i;let o=JA(s,e,t),a;do a=e[o++],r<a.id.clock+a.length&&JA(s,e,r),n(a);while(o<e.length&&e[o].id.clock<r)};class Sfe{constructor(e,t,i){this.doc=e,this.deleteSet=new IC,this.beforeState=ZE(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const NW=(s,e)=>e.deleteSet.clients.size===0&&!Bhe(e.afterState,(t,i)=>e.beforeState.get(i)!==t)?!1:(l6(e.deleteSet),ofe(s,e),U1(s,e.deleteSet),!0),IW=(s,e,t)=>{const i=e._item;(i===null||i.id.clock<(s.beforeState.get(i.id.client)||0)&&!i.deleted)&&la(s.changed,e,Dd).add(t)},Hx=(s,e)=>{let t=s[e],i=s[e-1],n=e;for(;n>0;t=i,i=s[--n-1]){if(i.deleted===t.deleted&&i.constructor===t.constructor&&i.mergeWith(t)){t instanceof qn&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,i);continue}break}const r=e-n;return r&&s.splice(e+1-r,r),r},xfe=(s,e,t)=>{for(const[i,n]of s.clients.entries()){const r=e.clients.get(i);for(let o=n.length-1;o>=0;o--){const a=n[o],l=a.clock+a.len;for(let c=dc(r,a.clock),h=r[c];c<r.length&&h.id.clock<l;h=r[++c]){const d=r[c];if(a.clock+a.len<=d.id.clock)break;d instanceof qn&&d.deleted&&!d.keep&&t(d)&&d.gc(e,!1)}}}},Lfe=(s,e)=>{s.clients.forEach((t,i)=>{const n=e.clients.get(i);for(let r=t.length-1;r>=0;r--){const o=t[r],a=ZP(n.length-1,1+dc(n,o.clock+o.len-1));for(let l=a,c=n[l];l>0&&c.id.clock>=o.clock;c=n[l])l-=1+Hx(n,l)}})},yQ=(s,e)=>{if(e<s.length){const t=s[e],i=t.doc,n=i.store,r=t.deleteSet,o=t._mergeStructs;try{l6(r),t.afterState=ZE(t.doc.store),i.emit("beforeObserverCalls",[t,i]);const a=[];t.changed.forEach((l,c)=>a.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(t,l)})),a.push(()=>{t.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(h=>h.target._item===null||!h.target._item.deleted),l.forEach(h=>{h.currentTarget=c,h._path=null}),l.sort((h,d)=>h.path.length-d.path.length),_Q(c._dEH,l,t))})}),a.push(()=>i.emit("afterTransaction",[t,i])),r6(a,[]),t._needFormattingCleanup&&$fe(t)}finally{i.gc&&xfe(r,n,i.gcFilter),Lfe(r,n),t.afterState.forEach((h,d)=>{const g=t.beforeState.get(d)||0;if(g!==h){const p=n.clients.get(d),_=wm(dc(p,g),1);for(let b=p.length-1;b>=_;)b-=1+Hx(p,b)}});for(let h=o.length-1;h>=0;h--){const{client:d,clock:g}=o[h].id,p=n.clients.get(d),_=dc(p,g);_+1<p.length&&Hx(p,_+1)>1||_>0&&Hx(p,_)}if(!t.local&&t.afterState.get(i.clientID)!==t.beforeState.get(i.clientID)&&(sQ(QE,Ta,"[yjs] ",Yg,tQ,"Changed the client-id because another client seems to be using it."),i.clientID=cQ()),i.emit("afterTransactionCleanup",[t,i]),i._observers.has("update")){const h=new RC;NW(h,t)&&i.emit("update",[h.toUint8Array(),t.origin,i,t])}if(i._observers.has("updateV2")){const h=new Qg;NW(h,t)&&i.emit("updateV2",[h.toUint8Array(),t.origin,i,t])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=t;(a.size>0||c.size>0||l.size>0)&&(a.forEach(h=>{h.clientID=i.clientID,h.collectionid==null&&(h.collectionid=i.collectionid),i.subdocs.add(h)}),c.forEach(h=>i.subdocs.delete(h)),i.emit("subdocs",[{loaded:l,added:a,removed:c},i,t]),c.forEach(h=>h.destroy())),s.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,s])):yQ(s,e+1)}}},un=(s,e,t=null,i=!0)=>{const n=s._transactionCleanups;let r=!1,o=null;s._transaction===null&&(r=!0,s._transaction=new Sfe(s,t,i),n.push(s._transaction),n.length===1&&s.emit("beforeAllTransactions",[s]),s.emit("beforeTransaction",[s._transaction,s]));try{o=e(s._transaction)}finally{if(r){const a=s._transaction===n[0];s._transaction=null,a&&yQ(n,0)}}return o};function*kfe(s){const e=Pt(s.restDecoder);for(let t=0;t<e;t++){const i=Pt(s.restDecoder),n=s.readClient();let r=Pt(s.restDecoder);for(let o=0;o<i;o++){const a=s.readInfo();if(a===10){const l=Pt(s.restDecoder);yield new Ea(Xt(n,r),l),r+=l}else if((GE&a)!==0){const l=(a&(Wu|sa))===0,c=new qn(Xt(n,r),null,(a&sa)===sa?s.readLeftID():null,null,(a&Wu)===Wu?s.readRightID():null,l?s.readParentInfo()?s.readString():s.readLeftID():null,l&&(a&av)===av?s.readString():null,HQ(s,a));yield c,r+=c.length}else{const l=s.readLen();yield new ka(Xt(n,r),l),r+=l}}}}class h6{constructor(e,t){this.gen=kfe(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ea);return this.curr}}class d6{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const Efe=s=>FL(s,hQ,RC),Dfe=(s,e)=>{if(s.constructor===ka){const{client:t,clock:i}=s.id;return new ka(Xt(t,i+e),s.length-e)}else if(s.constructor===Ea){const{client:t,clock:i}=s.id;return new Ea(Xt(t,i+e),s.length-e)}else{const t=s,{client:i,clock:n}=t.id;return new qn(Xt(i,n+e),null,Xt(i,n+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},FL=(s,e=d1,t=Qg)=>{if(s.length===1)return s[0];const i=s.map(h=>new e(xc(h)));let n=i.map(h=>new h6(h,!0)),r=null;const o=new t,a=new d6(o);for(;n=n.filter(g=>g.curr!==null),n.sort((g,p)=>{if(g.curr.id.client===p.curr.id.client){const _=g.curr.id.clock-p.curr.id.clock;return _===0?g.curr.constructor===p.curr.constructor?0:g.curr.constructor===Ea?1:-1:_}else return p.curr.id.client-g.curr.id.client}),n.length!==0;){const h=n[0],d=h.curr.id.client;if(r!==null){let g=h.curr,p=!1;for(;g!==null&&g.id.clock+g.length<=r.struct.id.clock+r.struct.length&&g.id.client>=r.struct.id.client;)g=h.next(),p=!0;if(g===null||g.id.client!==d||p&&g.id.clock>r.struct.id.clock+r.struct.length)continue;if(d!==r.struct.id.client)Kh(a,r.struct,r.offset),r={struct:g,offset:0},h.next();else if(r.struct.id.clock+r.struct.length<g.id.clock)if(r.struct.constructor===Ea)r.struct.length=g.id.clock+g.length-r.struct.id.clock;else{Kh(a,r.struct,r.offset);const _=g.id.clock-r.struct.id.clock-r.struct.length;r={struct:new Ea(Xt(d,r.struct.id.clock+r.struct.length),_),offset:0}}else{const _=r.struct.id.clock+r.struct.length-g.id.clock;_>0&&(r.struct.constructor===Ea?r.struct.length-=_:g=Dfe(g,_)),r.struct.mergeWith(g)||(Kh(a,r.struct,r.offset),r={struct:g,offset:0},h.next())}}else r={struct:h.curr,offset:0},h.next();for(let g=h.curr;g!==null&&g.id.client===d&&g.id.clock===r.struct.id.clock+r.struct.length&&g.constructor!==Ea;g=h.next())Kh(a,r.struct,r.offset),r={struct:g,offset:0}}r!==null&&(Kh(a,r.struct,r.offset),r=null),f6(a);const l=i.map(h=>c6(h)),c=Jde(l);return U1(o,c),o.toUint8Array()},Tfe=(s,e,t=d1,i=Qg)=>{const n=mQ(e),r=new i,o=new d6(r),a=new t(xc(s)),l=new h6(a,!1);for(;l.curr;){const h=l.curr,d=h.id.client,g=n.get(d)||0;if(l.curr.constructor===Ea){l.next();continue}if(h.id.clock+h.length>g)for(Kh(o,h,wm(g-h.id.clock,0)),l.next();l.curr&&l.curr.id.client===d;)Kh(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===d&&l.curr.id.clock+l.curr.length<=g;)l.next()}f6(o);const c=c6(a);return U1(r,c),r.toUint8Array()},SQ=s=>{s.written>0&&(s.clientStructs.push({written:s.written,restEncoder:kn(s.encoder.restEncoder)}),s.encoder.restEncoder=js(),s.written=0)},Kh=(s,e,t)=>{s.written>0&&s.currClient!==e.id.client&&SQ(s),s.written===0&&(s.currClient=e.id.client,s.encoder.writeClient(e.id.client),ft(s.encoder.restEncoder,e.id.clock+t)),e.write(s.encoder,t),s.written++},f6=s=>{SQ(s);const e=s.encoder.restEncoder;ft(e,s.clientStructs.length);for(let t=0;t<s.clientStructs.length;t++){const i=s.clientStructs[t];ft(e,i.written),KE(e,i.restEncoder)}},Nfe=(s,e,t,i)=>{const n=new t(xc(s)),r=new h6(n,!1),o=new i,a=new d6(o);for(let c=r.curr;c!==null;c=r.next())Kh(a,e(c),0);f6(a);const l=c6(n);return U1(o,l),o.toUint8Array()},Ife=s=>Nfe(s,Nde,d1,RC),RW="You must not compute changes after the event-handler fired.";class JE{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Rfe(this.currentTarget,this.target))}deletes(e){return lQ(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw hc(RW);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(n=>{if(n!==null){const r=t._map.get(n);let o,a;if(this.adds(r)){let l=r.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(r))if(l!==null&&this.deletes(l))o="delete",a=FI(l.content.getContent());else return;else l!==null&&this.deletes(l)?(o="update",a=FI(l.content.getContent())):(o="add",a=void 0)}else if(this.deletes(r))o="delete",a=FI(r.content.getContent());else return;e.set(n,{action:o,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw hc(RW);const t=this.target,i=Dd(),n=Dd(),r=[];if(e={added:i,deleted:n,delta:r,keys:this.keys},this.transaction.changed.get(t).has(null)){let a=null;const l=()=>{a&&r.push(a)};for(let c=t._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((a===null||a.delete===void 0)&&(l(),a={delete:0}),a.delete+=c.length,n.add(c)):this.adds(c)?((a===null||a.insert===void 0)&&(l(),a={insert:[]}),a.insert=a.insert.concat(c.content.getContent()),i.add(c)):((a===null||a.retain===void 0)&&(l(),a={retain:0}),a.retain+=c.length);a!==null&&a.retain===void 0&&l()}this._changes=e}return e}}const Rfe=(s,e)=>{const t=[];for(;e._item!==null&&e!==s;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let i=0,n=e._item.parent._start;for(;n!==e._item&&n!==null;)!n.deleted&&n.countable&&(i+=n.length),n=n.right;t.unshift(i)}e=e._item.parent}return t},Ir=()=>{Yde("Invalid access: Add Yjs type to a document before reading data.")},xQ=80;let g6=0;class Afe{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=g6++}}const Mfe=s=>{s.timestamp=g6++},LQ=(s,e,t)=>{s.p.marker=!1,s.p=e,e.marker=!0,s.index=t,s.timestamp=g6++},Ofe=(s,e,t)=>{if(s.length>=xQ){const i=s.reduce((n,r)=>n.timestamp<r.timestamp?n:r);return LQ(i,e,t),i}else{const i=new Afe(e,t);return s.push(i),i}},eD=(s,e)=>{if(s._start===null||e===0||s._searchMarker===null)return null;const t=s._searchMarker.length===0?null:s._searchMarker.reduce((r,o)=>Fx(e-r.index)<Fx(e-o.index)?r:o);let i=s._start,n=0;for(t!==null&&(i=t.p,n=t.index,Mfe(t));i.right!==null&&n<e;){if(!i.deleted&&i.countable){if(e<n+i.length)break;n+=i.length}i=i.right}for(;i.left!==null&&n>e;)i=i.left,!i.deleted&&i.countable&&(n-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(n-=i.length);return t!==null&&Fx(t.index-n)<i.parent.length/xQ?(LQ(t,i,n),t):Ofe(s._searchMarker,i,n)},hv=(s,e,t)=>{for(let i=s.length-1;i>=0;i--){const n=s[i];if(t>0){let r=n.p;for(r.marker=!1;r&&(r.deleted||!r.countable);)r=r.left,r&&!r.deleted&&r.countable&&(n.index-=r.length);if(r===null||r.marker===!0){s.splice(i,1);continue}n.p=r,r.marker=!0}(e<n.index||t>0&&e===n.index)&&(n.index=wm(e,n.index+t))}},tD=(s,e,t)=>{const i=s,n=e.changedParentTypes;for(;la(n,s,()=>[]).push(t),s._item!==null;)s=s._item.parent;_Q(i._eH,t,e)};class ur{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=kW(),this._dEH=kW(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw ic()}clone(){throw ic()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){EW(this._eH,e)}observeDeep(e){EW(this._dEH,e)}unobserve(e){DW(this._eH,e)}unobserveDeep(e){DW(this._dEH,e)}toJSON(){}}const kQ=(s,e,t)=>{s.doc??Ir(),e<0&&(e=s._length+e),t<0&&(t=s._length+t);let i=t-e;const n=[];let r=s._start;for(;r!==null&&i>0;){if(r.countable&&!r.deleted){const o=r.content.getContent();if(o.length<=e)e-=o.length;else{for(let a=e;a<o.length&&i>0;a++)n.push(o[a]),i--;e=0}}r=r.right}return n},EQ=s=>{s.doc??Ir();const e=[];let t=s._start;for(;t!==null;){if(t.countable&&!t.deleted){const i=t.content.getContent();for(let n=0;n<i.length;n++)e.push(i[n])}t=t.right}return e},dv=(s,e)=>{let t=0,i=s._start;for(s.doc??Ir();i!==null;){if(i.countable&&!i.deleted){const n=i.content.getContent();for(let r=0;r<n.length;r++)e(n[r],t++,s)}i=i.right}},DQ=(s,e)=>{const t=[];return dv(s,(i,n)=>{t.push(e(i,n,s))}),t},Pfe=s=>{let e=s._start,t=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),i=0,e=e.right}const n=t[i++];return t.length<=i&&(t=null),{done:!1,value:n}}}},TQ=(s,e)=>{s.doc??Ir();const t=eD(s,e);let i=s._start;for(t!==null&&(i=t.p,e-=t.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},BL=(s,e,t,i)=>{let n=t;const r=s.doc,o=r.clientID,a=r.store,l=t===null?e._start:t.right;let c=[];const h=()=>{c.length>0&&(n=new qn(Xt(o,ws(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new Zg(c)),n.integrate(s,0),c=[])};i.forEach(d=>{if(d===null)c.push(d);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(d);break;default:switch(h(),d.constructor){case Uint8Array:case ArrayBuffer:n=new qn(Xt(o,ws(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new AC(new Uint8Array(d))),n.integrate(s,0);break;case j1:n=new qn(Xt(o,ws(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new MC(d)),n.integrate(s,0);break;default:if(d instanceof ur)n=new qn(Xt(o,ws(a,o)),n,n&&n.lastId,l,l&&l.id,e,null,new Lc(d)),n.integrate(s,0);else throw new Error("Unexpected content type in insert operation")}}}),h()},NQ=()=>hc("Length exceeded!"),IQ=(s,e,t,i)=>{if(t>e._length)throw NQ();if(t===0)return e._searchMarker&&hv(e._searchMarker,t,i.length),BL(s,e,null,i);const n=t,r=eD(e,t);let o=e._start;for(r!==null&&(o=r.p,t-=r.index,t===0&&(o=o.prev,t+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(t<=o.length){t<o.length&&Td(s,Xt(o.id.client,o.id.clock+t));break}t-=o.length}return e._searchMarker&&hv(e._searchMarker,n,i.length),BL(s,e,o,i)},Ffe=(s,e,t)=>{let n=(e._searchMarker||[]).reduce((r,o)=>o.index>r.index?o:r,{index:0,p:e._start}).p;if(n)for(;n.right;)n=n.right;return BL(s,e,n,t)},RQ=(s,e,t,i)=>{if(i===0)return;const n=t,r=i,o=eD(e,t);let a=e._start;for(o!==null&&(a=o.p,t-=o.index);a!==null&&t>0;a=a.right)!a.deleted&&a.countable&&(t<a.length&&Td(s,Xt(a.id.client,a.id.clock+t)),t-=a.length);for(;i>0&&a!==null;)a.deleted||(i<a.length&&Td(s,Xt(a.id.client,a.id.clock+i)),a.delete(s),i-=a.length),a=a.right;if(i>0)throw NQ();e._searchMarker&&hv(e._searchMarker,n,-r+i)},VL=(s,e,t)=>{const i=e._map.get(t);i!==void 0&&i.delete(s)},m6=(s,e,t,i)=>{const n=e._map.get(t)||null,r=s.doc,o=r.clientID;let a;if(i==null)a=new Zg([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new Zg([i]);break;case Uint8Array:a=new AC(i);break;case j1:a=new MC(i);break;default:if(i instanceof ur)a=new Lc(i);else throw new Error("Unexpected content type")}new qn(Xt(o,ws(r.store,o)),n,n&&n.lastId,null,null,e,t,a).integrate(s,0)},p6=(s,e)=>{s.doc??Ir();const t=s._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},AQ=s=>{const e={};return s.doc??Ir(),s._map.forEach((t,i)=>{t.deleted||(e[i]=t.content.getContent()[t.length-1])}),e},MQ=(s,e)=>{s.doc??Ir();const t=s._map.get(e);return t!==void 0&&!t.deleted},Bfe=(s,e)=>{const t={};return s._map.forEach((i,n)=>{let r=i;for(;r!==null&&(!e.sv.has(r.id.client)||r.id.clock>=(e.sv.get(r.id.client)||0));)r=r.left;r!==null&&zp(r,e)&&(t[n]=r.content.getContent()[r.length-1])}),t},PS=s=>(s.doc??Ir(),Xde(s._map.entries(),e=>!e[1].deleted));class Vfe extends JE{}class I_ extends ur{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new I_;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new I_}clone(){const e=new I_;return e.insert(0,this.toArray().map(t=>t instanceof ur?t.clone():t)),e}get length(){return this.doc??Ir(),this._length}_callObserver(e,t){super._callObserver(e,t),tD(this,e,new Vfe(this,e))}insert(e,t){this.doc!==null?un(this.doc,i=>{IQ(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?un(this.doc,t=>{Ffe(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?un(this.doc,i=>{RQ(i,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return TQ(this,e)}toArray(){return EQ(this)}slice(e=0,t=this.length){return kQ(this,e,t)}toJSON(){return this.map(e=>e instanceof ur?e.toJSON():e)}map(e){return DQ(this,e)}forEach(e){dv(this,e)}[Symbol.iterator](){return Pfe(this)}_write(e){e.writeTypeRef(uge)}}const Hfe=s=>new I_;class Wfe extends JE{constructor(e,t,i){super(e,t),this.keysChanged=i}}class f1 extends ur{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((i,n)=>{this.set(n,i)}),this._prelimContent=null}_copy(){return new f1}clone(){const e=new f1;return this.forEach((t,i)=>{e.set(i,t instanceof ur?t.clone():t)}),e}_callObserver(e,t){tD(this,e,new Wfe(this,e,t))}toJSON(){this.doc??Ir();const e={};return this._map.forEach((t,i)=>{if(!t.deleted){const n=t.content.getContent()[t.length-1];e[i]=n instanceof ur?n.toJSON():n}}),e}get size(){return[...PS(this)].length}keys(){return UI(PS(this),e=>e[0])}values(){return UI(PS(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return UI(PS(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Ir(),this._map.forEach((t,i)=>{t.deleted||e(t.content.getContent()[t.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?un(this.doc,t=>{VL(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?un(this.doc,i=>{m6(i,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return p6(this,e)}has(e){return MQ(this,e)}clear(){this.doc!==null?un(this.doc,e=>{this.forEach(function(t,i,n){VL(e,n,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(hge)}}const zfe=s=>new f1,td=(s,e)=>s===e||typeof s=="object"&&typeof e=="object"&&s&&e&&Ede(s,e);class eM{constructor(e,t,i,n){this.left=e,this.right=t,this.index=i,this.currentAttributes=n}forward(){switch(this.right===null&&Ma(),this.right.content.constructor){case Ns:this.right.deleted||$1(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const AW=(s,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case Ns:e.right.deleted||$1(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&Td(s,Xt(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},FS=(s,e,t,i)=>{const n=new Map,r=i?eD(e,t):null;if(r){const o=new eM(r.p.left,r.p,r.index,n);return AW(s,o,t-r.index)}else{const o=new eM(null,e._start,0,n);return AW(s,o,t)}},OQ=(s,e,t,i)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Ns&&td(i.get(t.right.content.key),t.right.content.value));)t.right.deleted||i.delete(t.right.content.key),t.forward();const n=s.doc,r=n.clientID;i.forEach((o,a)=>{const l=t.left,c=t.right,h=new qn(Xt(r,ws(n.store,r)),l,l&&l.lastId,c,c&&c.id,e,null,new Ns(a,o));h.integrate(s,0),t.right=h,t.forward()})},$1=(s,e)=>{const{key:t,value:i}=e;i===null?s.delete(t):s.set(t,i)},PQ=(s,e)=>{for(;s.right!==null;){if(!(s.right.deleted||s.right.content.constructor===Ns&&td(e[s.right.content.key]??null,s.right.content.value)))break;s.forward()}},FQ=(s,e,t,i)=>{const n=s.doc,r=n.clientID,o=new Map;for(const a in i){const l=i[a],c=t.currentAttributes.get(a)??null;if(!td(c,l)){o.set(a,c);const{left:h,right:d}=t;t.right=new qn(Xt(r,ws(n.store,r)),h,h&&h.lastId,d,d&&d.id,e,null,new Ns(a,l)),t.right.integrate(s,0),t.forward()}}return o},jI=(s,e,t,i,n)=>{t.currentAttributes.forEach((g,p)=>{n[p]===void 0&&(n[p]=null)});const r=s.doc,o=r.clientID;PQ(t,n);const a=FQ(s,e,t,n),l=i.constructor===String?new fc(i):i instanceof ur?new Lc(i):new vm(i);let{left:c,right:h,index:d}=t;e._searchMarker&&hv(e._searchMarker,t.index,l.getLength()),h=new qn(Xt(o,ws(r.store,o)),c,c&&c.lastId,h,h&&h.id,e,null,l),h.integrate(s,0),t.right=h,t.index=d,t.forward(),OQ(s,e,t,a)},MW=(s,e,t,i,n)=>{const r=s.doc,o=r.clientID;PQ(t,n);const a=FQ(s,e,t,n);e:for(;t.right!==null&&(i>0||a.size>0&&(t.right.deleted||t.right.content.constructor===Ns));){if(!t.right.deleted)switch(t.right.content.constructor){case Ns:{const{key:l,value:c}=t.right.content,h=n[l];if(h!==void 0){if(td(h,c))a.delete(l);else{if(i===0)break e;a.set(l,c)}t.right.delete(s)}else t.currentAttributes.set(l,c);break}default:i<t.right.length&&Td(s,Xt(t.right.id.client,t.right.id.clock+i)),i-=t.right.length;break}t.forward()}if(i>0){let l="";for(;i>0;i--)l+=`
`;t.right=new qn(Xt(o,ws(r.store,o)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new fc(l)),t.right.integrate(s,0),t.forward()}OQ(s,e,t,a)},BQ=(s,e,t,i,n)=>{let r=e;const o=Eo();for(;r&&(!r.countable||r.deleted);){if(!r.deleted&&r.content.constructor===Ns){const c=r.content;o.set(c.key,c)}r=r.right}let a=0,l=!1;for(;e!==r;){if(t===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case Ns:{const{key:h,value:d}=c,g=i.get(h)??null;(o.get(h)!==c||g===d)&&(e.delete(s),a++,!l&&(n.get(h)??null)===d&&g!==d&&(g===null?n.delete(h):n.set(h,g))),!l&&!e.deleted&&$1(n,c);break}}}e=e.right}return a},Ufe=(s,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ns){const i=e.content.key;t.has(i)?e.delete(s):t.add(i)}e=e.left}},jfe=s=>{let e=0;return un(s.doc,t=>{let i=s._start,n=s._start,r=Eo();const o=GA(r);for(;n;){if(n.deleted===!1)switch(n.content.constructor){case Ns:$1(o,n.content);break;default:e+=BQ(t,i,n,r,o),r=GA(o),i=n;break}n=n.right}}),e},$fe=s=>{const e=new Set,t=s.doc;for(const[i,n]of s.afterState.entries()){const r=s.beforeState.get(i)||0;n!==r&&CQ(s,t.store.clients.get(i),r,n,o=>{!o.deleted&&o.content.constructor===Ns&&o.constructor!==ka&&e.add(o.parent)})}un(t,i=>{aQ(s,s.deleteSet,n=>{if(n instanceof ka||!n.parent._hasFormatting||e.has(n.parent))return;const r=n.parent;n.content.constructor===Ns?e.add(r):Ufe(i,n)});for(const n of e)jfe(n)})},OW=(s,e,t)=>{const i=t,n=GA(e.currentAttributes),r=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Lc:case vm:case fc:t<e.right.length&&Td(s,Xt(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(s);break}e.forward()}r&&BQ(s,r,e.right,n,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&hv(o._searchMarker,e.index,-i+t),e};class qfe extends JE{constructor(e,t,i){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(n=>{n===null?this.childListChanged=!0:this.keysChanged.add(n)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];un(e,i=>{const n=new Map,r=new Map;let o=this.target._start,a=null;const l={};let c="",h=0,d=0;const g=()=>{if(a!==null){let p=null;switch(a){case"delete":d>0&&(p={delete:d}),d=0;break;case"insert":(typeof c=="object"||c.length>0)&&(p={insert:c},n.size>0&&(p.attributes={},n.forEach((_,b)=>{_!==null&&(p.attributes[b]=_)}))),c="";break;case"retain":h>0&&(p={retain:h},Lde(l)||(p.attributes=Sde({},l))),h=0;break}p&&t.push(p),a=null}};for(;o!==null;){switch(o.content.constructor){case Lc:case vm:this.adds(o)?this.deletes(o)||(g(),a="insert",c=o.content.getContent()[0],g()):this.deletes(o)?(a!=="delete"&&(g(),a="delete"),d+=1):o.deleted||(a!=="retain"&&(g(),a="retain"),h+=1);break;case fc:this.adds(o)?this.deletes(o)||(a!=="insert"&&(g(),a="insert"),c+=o.content.str):this.deletes(o)?(a!=="delete"&&(g(),a="delete"),d+=o.length):o.deleted||(a!=="retain"&&(g(),a="retain"),h+=o.length);break;case Ns:{const{key:p,value:_}=o.content;if(this.adds(o)){if(!this.deletes(o)){const b=n.get(p)??null;td(b,_)?_!==null&&o.delete(i):(a==="retain"&&g(),td(_,r.get(p)??null)?delete l[p]:l[p]=_)}}else if(this.deletes(o)){r.set(p,_);const b=n.get(p)??null;td(b,_)||(a==="retain"&&g(),l[p]=b)}else if(!o.deleted){r.set(p,_);const b=l[p];b!==void 0&&(td(b,_)?b!==null&&o.delete(i):(a==="retain"&&g(),_===null?delete l[p]:l[p]=_))}o.deleted||(a==="insert"&&g(),$1(n,o.content));break}}o=o.right}for(g();t.length>0;){const p=t[t.length-1];if(p.retain!==void 0&&p.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class g1 extends ur{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Ir(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new g1}clone(){const e=new g1;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const i=new qfe(this,e,t);tD(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Ir();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===fc&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?un(this.doc,i=>{const n=new eM(null,this._start,0,new Map);for(let r=0;r<e.length;r++){const o=e[r];if(o.insert!==void 0){const a=!t&&typeof o.insert=="string"&&r===e.length-1&&n.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&jI(i,this,n,a,o.attributes||{})}else o.retain!==void 0?MW(i,this,n,o.retain,o.attributes||{}):o.delete!==void 0&&OW(i,n,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,i){this.doc??Ir();const n=[],r=new Map,o=this.doc;let a="",l=this._start;function c(){if(a.length>0){const d={};let g=!1;r.forEach((_,b)=>{g=!0,d[b]=_});const p={insert:a};g&&(p.attributes=d),n.push(p),a=""}}const h=()=>{for(;l!==null;){if(zp(l,e)||t!==void 0&&zp(l,t))switch(l.content.constructor){case fc:{const d=r.get("ychange");e!==void 0&&!zp(l,e)?(d===void 0||d.user!==l.id.client||d.type!=="removed")&&(c(),r.set("ychange",i?i("removed",l.id):{type:"removed"})):t!==void 0&&!zp(l,t)?(d===void 0||d.user!==l.id.client||d.type!=="added")&&(c(),r.set("ychange",i?i("added",l.id):{type:"added"})):d!==void 0&&(c(),r.delete("ychange")),a+=l.content.str;break}case Lc:case vm:{c();const d={insert:l.content.getContent()[0]};if(r.size>0){const g={};d.attributes=g,r.forEach((p,_)=>{g[_]=p})}n.push(d);break}case Ns:zp(l,e)&&(c(),$1(r,l.content));break}l=l.right}c()};return e||t?un(o,d=>{e&&ZA(d,e),t&&ZA(d,t),h()},"cleanup"):h(),n}insert(e,t,i){if(t.length<=0)return;const n=this.doc;n!==null?un(n,r=>{const o=FS(r,this,e,!i);i||(i={},o.currentAttributes.forEach((a,l)=>{i[l]=a})),jI(r,this,o,t,i)}):this._pending.push(()=>this.insert(e,t,i))}insertEmbed(e,t,i){const n=this.doc;n!==null?un(n,r=>{const o=FS(r,this,e,!i);jI(r,this,o,t,i||{})}):this._pending.push(()=>this.insertEmbed(e,t,i||{}))}delete(e,t){if(t===0)return;const i=this.doc;i!==null?un(i,n=>{OW(n,FS(n,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,i){if(t===0)return;const n=this.doc;n!==null?un(n,r=>{const o=FS(r,this,e,!1);o.right!==null&&MW(r,this,o,t,i)}):this._pending.push(()=>this.format(e,t,i))}removeAttribute(e){this.doc!==null?un(this.doc,t=>{VL(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?un(this.doc,i=>{m6(i,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return p6(this,e)}getAttributes(){return AQ(this)}_write(e){e.writeTypeRef(dge)}}const Gfe=s=>new g1;class $I{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Ir()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===m1||t.constructor===Xg)&&t._start!==null)e=t._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Xg extends ur{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Xg}clone(){const e=new Xg;return e.insert(0,this.toArray().map(t=>t instanceof ur?t.clone():t)),e}get length(){return this.doc??Ir(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new $I(this,e)}querySelector(e){e=e.toUpperCase();const i=new $I(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),Zu(new $I(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){tD(this,e,new Qfe(this,t,e))}toString(){return DQ(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},i){const n=e.createDocumentFragment();return i!==void 0&&i._createAssociation(n,this),dv(this,r=>{n.insertBefore(r.toDOM(e,t,i),null)}),n}insert(e,t){this.doc!==null?un(this.doc,i=>{IQ(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)un(this.doc,i=>{const n=e&&e instanceof ur?e._item:e;BL(i,this,n,t)});else{const i=this._prelimContent,n=e===null?0:i.findIndex(r=>r===e)+1;if(n===0&&e!==null)throw hc("Reference item not found");i.splice(n,0,...t)}}delete(e,t=1){this.doc!==null?un(this.doc,i=>{RQ(i,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return EQ(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return TQ(this,e)}slice(e=0,t=this.length){return kQ(this,e,t)}forEach(e){dv(this,e)}_write(e){e.writeTypeRef(gge)}}const Kfe=s=>new Xg;class m1 extends Xg{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((i,n)=>{this.setAttribute(n,i)}),this._prelimAttrs=null}_copy(){return new m1(this.nodeName)}clone(){const e=new m1(this.nodeName),t=this.getAttributes();return xde(t,(i,n)=>{typeof i=="string"&&e.setAttribute(n,i)}),e.insert(0,this.toArray().map(i=>i instanceof ur?i.clone():i)),e}toString(){const e=this.getAttributes(),t=[],i=[];for(const a in e)i.push(a);i.sort();const n=i.length;for(let a=0;a<n;a++){const l=i[a];t.push(l+'="'+e[l]+'"')}const r=this.nodeName.toLocaleLowerCase(),o=t.length>0?" "+t.join(" "):"";return`<${r}${o}>${super.toString()}</${r}>`}removeAttribute(e){this.doc!==null?un(this.doc,t=>{VL(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?un(this.doc,i=>{m6(i,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return p6(this,e)}hasAttribute(e){return MQ(this,e)}getAttributes(e){return e?Bfe(this,e):AQ(this)}toDOM(e=document,t={},i){const n=e.createElement(this.nodeName),r=this.getAttributes();for(const o in r){const a=r[o];typeof a=="string"&&n.setAttribute(o,a)}return dv(this,o=>{n.appendChild(o.toDOM(e,t,i))}),i!==void 0&&i._createAssociation(n,this),n}_write(e){e.writeTypeRef(fge),e.writeKey(this.nodeName)}}const Yfe=s=>new m1(s.readKey());class Qfe extends JE{constructor(e,t,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(n=>{n===null?this.childListChanged=!0:this.attributesChanged.add(n)})}}class HL extends f1{constructor(e){super(),this.hookName=e}_copy(){return new HL(this.hookName)}clone(){const e=new HL(this.hookName);return this.forEach((t,i)=>{e.set(i,t)}),e}toDOM(e=document,t={},i){const n=t[this.hookName];let r;return n!==void 0?r=n.createDom(this):r=document.createElement(this.hookName),r.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(r,this),r}_write(e){e.writeTypeRef(mge),e.writeKey(this.hookName)}}const Xfe=s=>new HL(s.readKey());class WL extends g1{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new WL}clone(){const e=new WL;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,i){const n=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{const t=[];for(const n in e.attributes){const r=[];for(const o in e.attributes[n])r.push({key:o,value:e.attributes[n][o]});r.sort((o,a)=>o.key<a.key?-1:1),t.push({nodeName:n,attrs:r})}t.sort((n,r)=>n.nodeName<r.nodeName?-1:1);let i="";for(let n=0;n<t.length;n++){const r=t[n];i+=`<${r.nodeName}`;for(let o=0;o<r.attrs.length;o++){const a=r.attrs[o];i+=` ${a.key}="${a.value}"`}i+=">"}i+=e.insert;for(let n=t.length-1;n>=0;n--)i+=`</${t[n].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(pge)}}const Zfe=s=>new WL;class _6{constructor(e,t){this.id=e,this.length=t}get deleted(){throw ic()}mergeWith(e){return!1}write(e,t,i){throw ic()}integrate(e,t){throw ic()}}const Jfe=0;class ka extends _6{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),vQ(e.doc.store,this)}write(e,t){e.writeInfo(Jfe),e.writeLen(this.length-t)}getMissing(e,t){return null}}class AC{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new AC(this.content)}splice(e){throw ic()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const ege=s=>new AC(s.readBuf());class fv{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new fv(this.len)}splice(e){const t=new fv(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){ML(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const tge=s=>new fv(s.readLen()),VQ=(s,e)=>new j1({guid:s,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class MC{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new MC(VQ(this.doc.guid,this.opts))}splice(e){throw ic()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const ige=s=>new MC(VQ(s.readString(),s.readAny()));class vm{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new vm(this.embed)}splice(e){throw ic()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const nge=s=>new vm(s.readJSON());class Ns{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ns(this.key,this.value)}splice(e){throw ic()}mergeWith(e){return!1}integrate(e,t){const i=t.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const sge=s=>new Ns(s.readKey(),s.readJSON());class zL{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new zL(this.arr)}splice(e){const t=new zL(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let n=t;n<i;n++){const r=this.arr[n];e.writeString(r===void 0?"undefined":JSON.stringify(r))}}getRef(){return 2}}const rge=s=>{const e=s.readLen(),t=[];for(let i=0;i<e;i++){const n=s.readString();n==="undefined"?t.push(void 0):t.push(JSON.parse(n))}return new zL(t)},oge=uv("node_env")==="development";class Zg{constructor(e){this.arr=e,oge&&qY(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Zg(this.arr)}splice(e){const t=new Zg(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let n=t;n<i;n++){const r=this.arr[n];e.writeAny(r)}}getRef(){return 8}}const age=s=>{const e=s.readLen(),t=[];for(let i=0;i<e;i++)t.push(s.readAny());return new Zg(t)};class fc{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new fc(this.str)}splice(e){const t=new fc(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const lge=s=>new fc(s.readString()),cge=[Hfe,zfe,Gfe,Yfe,Kfe,Xfe,Zfe],uge=0,hge=1,dge=2,fge=3,gge=4,mge=5,pge=6;class Lc{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Lc(this.type._copy())}splice(e){throw ic()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const _ge=s=>new Lc(cge[s.readTypeRef()](s)),PW=(s,e)=>{let t=e,i=0,n;do i>0&&(t=Xt(t.client,t.clock+i)),n=N_(s,t),i=t.clock-n.id.clock,t=n.redone;while(t!==null&&n instanceof qn);return{item:n,diff:i}},UL=(s,e,t)=>{const{client:i,clock:n}=e.id,r=new qn(Xt(i,n+t),e,Xt(i,n+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&r.markDeleted(),e.keep&&(r.keep=!0),e.redone!==null&&(r.redone=Xt(e.redone.client,e.redone.clock+t)),e.right=r,r.right!==null&&(r.right.left=r),s._mergeStructs.push(r),r.parentSub!==null&&r.right===null&&r.parent._map.set(r.parentSub,r),e.length=t,r};class qn extends _6{constructor(e,t,i,n,r,o,a,l){super(e,l.getLength()),this.origin=i,this.left=t,this.right=n,this.rightOrigin=r,this.parent=o,this.parentSub=a,this.redone=null,this.content=l,this.info=this.content.isCountable()?hW:0}set marker(e){(this.info&VI)>0!==e&&(this.info^=VI)}get marker(){return(this.info&VI)>0}get keep(){return(this.info&uW)>0}set keep(e){this.keep!==e&&(this.info^=uW)}get countable(){return(this.info&hW)>0}get deleted(){return(this.info&BI)>0}set deleted(e){this.deleted!==e&&(this.info^=BI)}markDeleted(){this.info|=BI}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ws(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ws(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===T_&&this.id.client!==this.parent.client&&this.parent.clock>=ws(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=TW(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Td(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ka||this.right&&this.right.constructor===ka)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===qn?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===qn&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===T_){const i=N_(t,this.parent);i.constructor===ka?this.parent=null:this.parent=i.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=TW(e,e.doc.store,Xt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,n;if(i!==null)n=i.right;else if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start;const r=new Set,o=new Set;for(;n!==null&&n!==this.right;){if(o.add(n),r.add(n),MS(this.origin,n.origin)){if(n.id.client<this.id.client)i=n,r.clear();else if(MS(this.rightOrigin,n.rightOrigin))break}else if(n.origin!==null&&o.has(N_(e.doc.store,n.origin)))r.has(N_(e.doc.store,n.origin))||(i=n,r.clear());else break;n=n.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),vQ(e.doc.store,this),this.content.integrate(e,this),IW(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new ka(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Xt(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&MS(e.origin,this.lastId)&&this.right===e&&MS(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),ML(e.deleteSet,this.id.client,this.id.clock,this.length),IW(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw Ma();this.content.gc(e),t?yfe(e,this,new ka(this.id,this.length)):this.content=new fv(this.length)}write(e,t){const i=t>0?Xt(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,r=this.parentSub,o=this.content.getRef()&GE|(i===null?0:sa)|(n===null?0:Wu)|(r===null?0:av);if(e.writeInfo(o),i!==null&&e.writeLeftID(i),n!==null&&e.writeRightID(n),i===null&&n===null){const a=this.parent;if(a._item!==void 0){const l=a._item;if(l===null){const c=bQ(a);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===T_?(e.writeParentInfo(!1),e.writeLeftID(a)):Ma();r!==null&&e.writeString(r)}this.content.write(e,t)}}const HQ=(s,e)=>bge[e&GE](s),bge=[()=>{Ma()},tge,rge,ege,lge,nge,sge,_ge,age,ige,()=>{Ma()}],wge=10;class Ea extends _6{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){Ma()}write(e,t){e.writeInfo(wge),ft(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const WQ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},zQ="__ $YJS$ __";WQ[zQ]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");WQ[zQ]=!0;const vge=1200,Cge=2500,jL=3e4,tM=s=>{if(s.shouldConnect&&s.ws===null){const e=new WebSocket(s.url),t=s.binaryType;let i=null;t&&(e.binaryType=t),s.ws=e,s.connecting=!0,s.connected=!1,e.onmessage=o=>{s.lastMessageReceived=Ju();const a=o.data,l=typeof a=="string"?JSON.parse(a):a;l&&l.type==="pong"&&(clearTimeout(i),i=setTimeout(r,jL/2)),s.emit("message",[l,s])};const n=o=>{s.ws!==null&&(s.ws=null,s.connecting=!1,s.connected?(s.connected=!1,s.emit("disconnect",[{type:"disconnect",error:o},s])):s.unsuccessfulReconnects++,setTimeout(tM,ZP(Whe(s.unsuccessfulReconnects+1)*vge,Cge),s)),clearTimeout(i)},r=()=>{s.ws===e&&s.send({type:"ping"})};e.onclose=()=>n(null),e.onerror=o=>n(o),e.onopen=()=>{s.lastMessageReceived=Ju(),s.connecting=!1,s.connected=!0,s.unsuccessfulReconnects=0,s.emit("connect",[{type:"connect"},s]),i=setTimeout(r,jL/2)}}};class yge extends OY{constructor(e,{binaryType:t}={}){super(),this.url=e,this.ws=null,this.binaryType=t||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&jL<Ju()-this.lastMessageReceived&&this.ws.close()},jL/2),tM(this)}send(e){this.ws&&this.ws.send(JSON.stringify(e))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&tM(this)}}const UQ=new Map;class Sge{constructor(e){this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&this.onmessage!==null&&this.onmessage({data:ZY(t.newValue||"")}),Cde(this._onChange)}postMessage(e){UY.setItem(this.room,XY(Pde(e)))}close(){yde(this._onChange)}}const xge=typeof BroadcastChannel>"u"?Sge:BroadcastChannel,b6=s=>la(UQ,s,()=>{const e=Dd(),t=new xge(s);return t.onmessage=i=>e.forEach(n=>n(i.data,"broadcastchannel")),{bc:t,subs:e}}),Lge=(s,e)=>(b6(s).subs.add(e),e),kge=(s,e)=>{const t=b6(s),i=t.subs.delete(e);return i&&t.subs.size===0&&(t.bc.close(),UQ.delete(s)),i},Ege=(s,e,t=null)=>{const i=b6(s);i.bc.postMessage(e),i.subs.forEach(n=>n(e,t))},jQ=()=>{let s=!0;return(e,t)=>{if(s){s=!1;try{e()}finally{s=!0}}else t!==void 0&&t()}};function BS(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qI={exports:{}},FW;function Dge(){return FW||(FW=1,(function(s,e){(function(t){s.exports=t()})(function(){var t=Math.floor,i=Math.abs,n=Math.pow;return(function(){function r(o,a,l){function c(g,p){if(!a[g]){if(!o[g]){var _=typeof BS=="function"&&BS;if(!p&&_)return _(g,!0);if(h)return h(g,!0);var b=new Error("Cannot find module '"+g+"'");throw b.code="MODULE_NOT_FOUND",b}var C=a[g]={exports:{}};o[g][0].call(C.exports,function(x){var S=o[g][1][x];return c(S||x)},C,C.exports,r,o,a,l)}return a[g].exports}for(var h=typeof BS=="function"&&BS,d=0;d<l.length;d++)c(l[d]);return c}return r})()({1:[function(r,o,a){function l(k){var D=k.length;if(0<D%4)throw new Error("Invalid string. Length must be a multiple of 4");var R=k.indexOf("=");R===-1&&(R=D);var N=R===D?0:4-R%4;return[R,N]}function c(k,D,R){return 3*(D+R)/4-R}function h(k){var D,R,N=l(k),A=N[0],M=N[1],O=new C(c(k,A,M)),V=0,H=0<M?A-4:A;for(R=0;R<H;R+=4)D=b[k.charCodeAt(R)]<<18|b[k.charCodeAt(R+1)]<<12|b[k.charCodeAt(R+2)]<<6|b[k.charCodeAt(R+3)],O[V++]=255&D>>16,O[V++]=255&D>>8,O[V++]=255&D;return M===2&&(D=b[k.charCodeAt(R)]<<2|b[k.charCodeAt(R+1)]>>4,O[V++]=255&D),M===1&&(D=b[k.charCodeAt(R)]<<10|b[k.charCodeAt(R+1)]<<4|b[k.charCodeAt(R+2)]>>2,O[V++]=255&D>>8,O[V++]=255&D),O}function d(k){return _[63&k>>18]+_[63&k>>12]+_[63&k>>6]+_[63&k]}function g(k,D,R){for(var N,A=[],M=D;M<R;M+=3)N=(16711680&k[M]<<16)+(65280&k[M+1]<<8)+(255&k[M+2]),A.push(d(N));return A.join("")}function p(k){for(var D,R=k.length,N=R%3,A=[],M=16383,O=0,V=R-N;O<V;O+=M)A.push(g(k,O,O+M>V?V:O+M));return N===1?(D=k[R-1],A.push(_[D>>2]+_[63&D<<4]+"==")):N===2&&(D=(k[R-2]<<8)+k[R-1],A.push(_[D>>10]+_[63&D>>4]+_[63&D<<2]+"=")),A.join("")}a.byteLength=function(k){var D=l(k),R=D[0],N=D[1];return 3*(R+N)/4-N},a.toByteArray=h,a.fromByteArray=p;for(var _=[],b=[],C=typeof Uint8Array>"u"?Array:Uint8Array,x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=0,y=x.length;S<y;++S)_[S]=x[S],b[x.charCodeAt(S)]=S;b[45]=62,b[95]=63},{}],2:[function(){},{}],3:[function(r,o,a){(function(){(function(){var l=String.fromCharCode,c=Math.min;function h(T){if(2147483647<T)throw new RangeError('The value "'+T+'" is invalid for option "size"');var F=new Uint8Array(T);return F.__proto__=d.prototype,F}function d(T,F,W){if(typeof T=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(T)}return g(T,F,W)}function g(T,F,W){if(typeof T=="string")return C(T,F);if(ArrayBuffer.isView(T))return x(T);if(T==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T);if(pe(T,ArrayBuffer)||T&&pe(T.buffer,ArrayBuffer))return S(T,F,W);if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ne=T.valueOf&&T.valueOf();if(ne!=null&&ne!==T)return d.from(ne,F,W);var he=y(T);if(he)return he;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return d.from(T[Symbol.toPrimitive]("string"),F,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}function p(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(0>T)throw new RangeError('The value "'+T+'" is invalid for option "size"')}function _(T,F,W){return p(T),0>=T||F===void 0?h(T):typeof W=="string"?h(T).fill(F,W):h(T).fill(F)}function b(T){return p(T),h(0>T?0:0|k(T))}function C(T,F){if((typeof F!="string"||F==="")&&(F="utf8"),!d.isEncoding(F))throw new TypeError("Unknown encoding: "+F);var W=0|D(T,F),ne=h(W),he=ne.write(T,F);return he!==W&&(ne=ne.slice(0,he)),ne}function x(T){for(var F=0>T.length?0:0|k(T.length),W=h(F),ne=0;ne<F;ne+=1)W[ne]=255&T[ne];return W}function S(T,F,W){if(0>F||T.byteLength<F)throw new RangeError('"offset" is outside of buffer bounds');if(T.byteLength<F+(W||0))throw new RangeError('"length" is outside of buffer bounds');var ne;return ne=F===void 0&&W===void 0?new Uint8Array(T):W===void 0?new Uint8Array(T,F):new Uint8Array(T,F,W),ne.__proto__=d.prototype,ne}function y(T){if(d.isBuffer(T)){var F=0|k(T.length),W=h(F);return W.length===0||T.copy(W,0,0,F),W}return T.length===void 0?T.type==="Buffer"&&Array.isArray(T.data)?x(T.data):void 0:typeof T.length!="number"||ye(T.length)?h(0):x(T)}function k(T){if(T>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|T}function D(T,F){if(d.isBuffer(T))return T.length;if(ArrayBuffer.isView(T)||pe(T,ArrayBuffer))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);var W=T.length,ne=2<arguments.length&&arguments[2]===!0;if(!ne&&W===0)return 0;for(var he=!1;;)switch(F){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return An(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*W;case"hex":return W>>>1;case"base64":return on(T).length;default:if(he)return ne?-1:An(T).length;F=(""+F).toLowerCase(),he=!0}}function R(T,F,W){var ne=!1;if((F===void 0||0>F)&&(F=0),F>this.length||((W===void 0||W>this.length)&&(W=this.length),0>=W)||(W>>>=0,F>>>=0,W<=F))return"";for(T||(T="utf8");;)switch(T){case"hex":return $(this,F,W);case"utf8":case"utf-8":return ee(this,F,W);case"ascii":return oe(this,F,W);case"latin1":case"binary":return Ee(this,F,W);case"base64":return q(this,F,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ce(this,F,W);default:if(ne)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),ne=!0}}function N(T,F,W){var ne=T[F];T[F]=T[W],T[W]=ne}function A(T,F,W,ne,he){if(T.length===0)return-1;if(typeof W=="string"?(ne=W,W=0):2147483647<W?W=2147483647:-2147483648>W&&(W=-2147483648),W=+W,ye(W)&&(W=he?0:T.length-1),0>W&&(W=T.length+W),W>=T.length){if(he)return-1;W=T.length-1}else if(0>W)if(he)W=0;else return-1;if(typeof F=="string"&&(F=d.from(F,ne)),d.isBuffer(F))return F.length===0?-1:M(T,F,W,ne,he);if(typeof F=="number")return F&=255,typeof Uint8Array.prototype.indexOf=="function"?he?Uint8Array.prototype.indexOf.call(T,F,W):Uint8Array.prototype.lastIndexOf.call(T,F,W):M(T,[F],W,ne,he);throw new TypeError("val must be string, number or Buffer")}function M(T,F,W,ne,he){function Ce(Ks,Mi){return Ze===1?Ks[Mi]:Ks.readUInt16BE(Mi*Ze)}var Ze=1,Ft=T.length,Si=F.length;if(ne!==void 0&&(ne=(ne+"").toLowerCase(),ne==="ucs2"||ne==="ucs-2"||ne==="utf16le"||ne==="utf-16le")){if(2>T.length||2>F.length)return-1;Ze=2,Ft/=2,Si/=2,W/=2}var zt;if(he){var At=-1;for(zt=W;zt<Ft;zt++)if(Ce(T,zt)!==Ce(F,At===-1?0:zt-At))At!==-1&&(zt-=zt-At),At=-1;else if(At===-1&&(At=zt),zt-At+1===Si)return At*Ze}else for(W+Si>Ft&&(W=Ft-Si),zt=W;0<=zt;zt--){for(var Mn=!0,Jr=0;Jr<Si;Jr++)if(Ce(T,zt+Jr)!==Ce(F,Jr)){Mn=!1;break}if(Mn)return zt}return-1}function O(T,F,W,ne){W=+W||0;var he=T.length-W;ne?(ne=+ne,ne>he&&(ne=he)):ne=he;var Ce=F.length;ne>Ce/2&&(ne=Ce/2);for(var Ze,Ft=0;Ft<ne;++Ft){if(Ze=parseInt(F.substr(2*Ft,2),16),ye(Ze))return Ft;T[W+Ft]=Ze}return Ft}function V(T,F,W,ne){return qi(An(F,T.length-W),T,W,ne)}function H(T,F,W,ne){return qi(vr(F),T,W,ne)}function U(T,F,W,ne){return H(T,F,W,ne)}function X(T,F,W,ne){return qi(on(F),T,W,ne)}function Y(T,F,W,ne){return qi(li(F,T.length-W),T,W,ne)}function q(T,F,W){return F===0&&W===T.length?Fe.fromByteArray(T):Fe.fromByteArray(T.slice(F,W))}function ee(T,F,W){W=c(T.length,W);for(var ne=[],he=F;he<W;){var Ce=T[he],Ze=null,Ft=239<Ce?4:223<Ce?3:191<Ce?2:1;if(he+Ft<=W){var Si,zt,At,Mn;Ft===1?128>Ce&&(Ze=Ce):Ft===2?(Si=T[he+1],(192&Si)==128&&(Mn=(31&Ce)<<6|63&Si,127<Mn&&(Ze=Mn))):Ft===3?(Si=T[he+1],zt=T[he+2],(192&Si)==128&&(192&zt)==128&&(Mn=(15&Ce)<<12|(63&Si)<<6|63&zt,2047<Mn&&(55296>Mn||57343<Mn)&&(Ze=Mn))):Ft===4&&(Si=T[he+1],zt=T[he+2],At=T[he+3],(192&Si)==128&&(192&zt)==128&&(192&At)==128&&(Mn=(15&Ce)<<18|(63&Si)<<12|(63&zt)<<6|63&At,65535<Mn&&1114112>Mn&&(Ze=Mn)))}Ze===null?(Ze=65533,Ft=1):65535<Ze&&(Ze-=65536,ne.push(55296|1023&Ze>>>10),Ze=56320|1023&Ze),ne.push(Ze),he+=Ft}return ue(ne)}function ue(T){var F=T.length;if(F<=4096)return l.apply(String,T);for(var W="",ne=0;ne<F;)W+=l.apply(String,T.slice(ne,ne+=4096));return W}function oe(T,F,W){var ne="";W=c(T.length,W);for(var he=F;he<W;++he)ne+=l(127&T[he]);return ne}function Ee(T,F,W){var ne="";W=c(T.length,W);for(var he=F;he<W;++he)ne+=l(T[he]);return ne}function $(T,F,W){var ne=T.length;(!F||0>F)&&(F=0),(!W||0>W||W>ne)&&(W=ne);for(var he="",Ce=F;Ce<W;++Ce)he+=qt(T[Ce]);return he}function ce(T,F,W){for(var ne=T.slice(F,W),he="",Ce=0;Ce<ne.length;Ce+=2)he+=l(ne[Ce]+256*ne[Ce+1]);return he}function de(T,F,W){if(T%1!=0||0>T)throw new RangeError("offset is not uint");if(T+F>W)throw new RangeError("Trying to access beyond buffer length")}function xe(T,F,W,ne,he,Ce){if(!d.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>he||F<Ce)throw new RangeError('"value" argument is out of bounds');if(W+ne>T.length)throw new RangeError("Index out of range")}function Re(T,F,W,ne){if(W+ne>T.length)throw new RangeError("Index out of range");if(0>W)throw new RangeError("Index out of range")}function Xe(T,F,W,ne,he){return F=+F,W>>>=0,he||Re(T,F,W,4),st.write(T,F,W,ne,23,4),W+4}function ht(T,F,W,ne,he){return F=+F,W>>>=0,he||Re(T,F,W,8),st.write(T,F,W,ne,52,8),W+8}function bi(T){if(T=T.split("=")[0],T=T.trim().replace(Q,""),2>T.length)return"";for(;T.length%4!=0;)T+="=";return T}function qt(T){return 16>T?"0"+T.toString(16):T.toString(16)}function An(T,F){F=F||1/0;for(var W,ne=T.length,he=null,Ce=[],Ze=0;Ze<ne;++Ze){if(W=T.charCodeAt(Ze),55295<W&&57344>W){if(!he){if(56319<W){-1<(F-=3)&&Ce.push(239,191,189);continue}else if(Ze+1===ne){-1<(F-=3)&&Ce.push(239,191,189);continue}he=W;continue}if(56320>W){-1<(F-=3)&&Ce.push(239,191,189),he=W;continue}W=(he-55296<<10|W-56320)+65536}else he&&-1<(F-=3)&&Ce.push(239,191,189);if(he=null,128>W){if(0>(F-=1))break;Ce.push(W)}else if(2048>W){if(0>(F-=2))break;Ce.push(192|W>>6,128|63&W)}else if(65536>W){if(0>(F-=3))break;Ce.push(224|W>>12,128|63&W>>6,128|63&W)}else if(1114112>W){if(0>(F-=4))break;Ce.push(240|W>>18,128|63&W>>12,128|63&W>>6,128|63&W)}else throw new Error("Invalid code point")}return Ce}function vr(T){for(var F=[],W=0;W<T.length;++W)F.push(255&T.charCodeAt(W));return F}function li(T,F){for(var W,ne,he,Ce=[],Ze=0;Ze<T.length&&!(0>(F-=2));++Ze)W=T.charCodeAt(Ze),ne=W>>8,he=W%256,Ce.push(he),Ce.push(ne);return Ce}function on(T){return Fe.toByteArray(bi(T))}function qi(T,F,W,ne){for(var he=0;he<ne&&!(he+W>=F.length||he>=T.length);++he)F[he+W]=T[he];return he}function pe(T,F){return T instanceof F||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===F.name}function ye(T){return T!==T}var Fe=r("base64-js"),st=r("ieee754");a.Buffer=d,a.SlowBuffer=function(T){return+T!=T&&(T=0),d.alloc(+T)},a.INSPECT_MAX_BYTES=50,a.kMaxLength=2147483647,d.TYPED_ARRAY_SUPPORT=(function(){try{var T=new Uint8Array(1);return T.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},T.foo()===42}catch{return!1}})(),d.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){return d.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){return d.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=function(T,F,W){return g(T,F,W)},d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,d.alloc=function(T,F,W){return _(T,F,W)},d.allocUnsafe=function(T){return b(T)},d.allocUnsafeSlow=function(T){return b(T)},d.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==d.prototype},d.compare=function(T,F){if(pe(T,Uint8Array)&&(T=d.from(T,T.offset,T.byteLength)),pe(F,Uint8Array)&&(F=d.from(F,F.offset,F.byteLength)),!d.isBuffer(T)||!d.isBuffer(F))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===F)return 0;for(var W=T.length,ne=F.length,he=0,Ce=c(W,ne);he<Ce;++he)if(T[he]!==F[he]){W=T[he],ne=F[he];break}return W<ne?-1:ne<W?1:0},d.isEncoding=function(T){switch((T+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(T,F){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return d.alloc(0);var W;if(F===void 0)for(F=0,W=0;W<T.length;++W)F+=T[W].length;var ne=d.allocUnsafe(F),he=0;for(W=0;W<T.length;++W){var Ce=T[W];if(pe(Ce,Uint8Array)&&(Ce=d.from(Ce)),!d.isBuffer(Ce))throw new TypeError('"list" argument must be an Array of Buffers');Ce.copy(ne,he),he+=Ce.length}return ne},d.byteLength=D,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var T=this.length;if(T%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var F=0;F<T;F+=2)N(this,F,F+1);return this},d.prototype.swap32=function(){var T=this.length;if(T%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var F=0;F<T;F+=4)N(this,F,F+3),N(this,F+1,F+2);return this},d.prototype.swap64=function(){var T=this.length;if(T%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var F=0;F<T;F+=8)N(this,F,F+7),N(this,F+1,F+6),N(this,F+2,F+5),N(this,F+3,F+4);return this},d.prototype.toString=function(){var T=this.length;return T===0?"":arguments.length===0?ee(this,0,T):R.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(T){if(!d.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T||d.compare(this,T)===0},d.prototype.inspect=function(){var T="",F=a.INSPECT_MAX_BYTES;return T=this.toString("hex",0,F).replace(/(.{2})/g,"$1 ").trim(),this.length>F&&(T+=" ... "),"<Buffer "+T+">"},d.prototype.compare=function(T,F,W,ne,he){if(pe(T,Uint8Array)&&(T=d.from(T,T.offset,T.byteLength)),!d.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(F===void 0&&(F=0),W===void 0&&(W=T?T.length:0),ne===void 0&&(ne=0),he===void 0&&(he=this.length),0>F||W>T.length||0>ne||he>this.length)throw new RangeError("out of range index");if(ne>=he&&F>=W)return 0;if(ne>=he)return-1;if(F>=W)return 1;if(F>>>=0,W>>>=0,ne>>>=0,he>>>=0,this===T)return 0;for(var Ce=he-ne,Ze=W-F,Ft=c(Ce,Ze),Si=this.slice(ne,he),zt=T.slice(F,W),At=0;At<Ft;++At)if(Si[At]!==zt[At]){Ce=Si[At],Ze=zt[At];break}return Ce<Ze?-1:Ze<Ce?1:0},d.prototype.includes=function(T,F,W){return this.indexOf(T,F,W)!==-1},d.prototype.indexOf=function(T,F,W){return A(this,T,F,W,!0)},d.prototype.lastIndexOf=function(T,F,W){return A(this,T,F,W,!1)},d.prototype.write=function(T,F,W,ne){if(F===void 0)ne="utf8",W=this.length,F=0;else if(W===void 0&&typeof F=="string")ne=F,W=this.length,F=0;else if(isFinite(F))F>>>=0,isFinite(W)?(W>>>=0,ne===void 0&&(ne="utf8")):(ne=W,W=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var he=this.length-F;if((W===void 0||W>he)&&(W=he),0<T.length&&(0>W||0>F)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");ne||(ne="utf8");for(var Ce=!1;;)switch(ne){case"hex":return O(this,T,F,W);case"utf8":case"utf-8":return V(this,T,F,W);case"ascii":return H(this,T,F,W);case"latin1":case"binary":return U(this,T,F,W);case"base64":return X(this,T,F,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,T,F,W);default:if(Ce)throw new TypeError("Unknown encoding: "+ne);ne=(""+ne).toLowerCase(),Ce=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.slice=function(T,F){var W=this.length;T=~~T,F=F===void 0?W:~~F,0>T?(T+=W,0>T&&(T=0)):T>W&&(T=W),0>F?(F+=W,0>F&&(F=0)):F>W&&(F=W),F<T&&(F=T);var ne=this.subarray(T,F);return ne.__proto__=d.prototype,ne},d.prototype.readUIntLE=function(T,F,W){T>>>=0,F>>>=0,W||de(T,F,this.length);for(var ne=this[T],he=1,Ce=0;++Ce<F&&(he*=256);)ne+=this[T+Ce]*he;return ne},d.prototype.readUIntBE=function(T,F,W){T>>>=0,F>>>=0,W||de(T,F,this.length);for(var ne=this[T+--F],he=1;0<F&&(he*=256);)ne+=this[T+--F]*he;return ne},d.prototype.readUInt8=function(T,F){return T>>>=0,F||de(T,1,this.length),this[T]},d.prototype.readUInt16LE=function(T,F){return T>>>=0,F||de(T,2,this.length),this[T]|this[T+1]<<8},d.prototype.readUInt16BE=function(T,F){return T>>>=0,F||de(T,2,this.length),this[T]<<8|this[T+1]},d.prototype.readUInt32LE=function(T,F){return T>>>=0,F||de(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+16777216*this[T+3]},d.prototype.readUInt32BE=function(T,F){return T>>>=0,F||de(T,4,this.length),16777216*this[T]+(this[T+1]<<16|this[T+2]<<8|this[T+3])},d.prototype.readIntLE=function(T,F,W){T>>>=0,F>>>=0,W||de(T,F,this.length);for(var ne=this[T],he=1,Ce=0;++Ce<F&&(he*=256);)ne+=this[T+Ce]*he;return he*=128,ne>=he&&(ne-=n(2,8*F)),ne},d.prototype.readIntBE=function(T,F,W){T>>>=0,F>>>=0,W||de(T,F,this.length);for(var ne=F,he=1,Ce=this[T+--ne];0<ne&&(he*=256);)Ce+=this[T+--ne]*he;return he*=128,Ce>=he&&(Ce-=n(2,8*F)),Ce},d.prototype.readInt8=function(T,F){return T>>>=0,F||de(T,1,this.length),128&this[T]?-1*(255-this[T]+1):this[T]},d.prototype.readInt16LE=function(T,F){T>>>=0,F||de(T,2,this.length);var W=this[T]|this[T+1]<<8;return 32768&W?4294901760|W:W},d.prototype.readInt16BE=function(T,F){T>>>=0,F||de(T,2,this.length);var W=this[T+1]|this[T]<<8;return 32768&W?4294901760|W:W},d.prototype.readInt32LE=function(T,F){return T>>>=0,F||de(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},d.prototype.readInt32BE=function(T,F){return T>>>=0,F||de(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},d.prototype.readFloatLE=function(T,F){return T>>>=0,F||de(T,4,this.length),st.read(this,T,!0,23,4)},d.prototype.readFloatBE=function(T,F){return T>>>=0,F||de(T,4,this.length),st.read(this,T,!1,23,4)},d.prototype.readDoubleLE=function(T,F){return T>>>=0,F||de(T,8,this.length),st.read(this,T,!0,52,8)},d.prototype.readDoubleBE=function(T,F){return T>>>=0,F||de(T,8,this.length),st.read(this,T,!1,52,8)},d.prototype.writeUIntLE=function(T,F,W,ne){if(T=+T,F>>>=0,W>>>=0,!ne){var he=n(2,8*W)-1;xe(this,T,F,W,he,0)}var Ce=1,Ze=0;for(this[F]=255&T;++Ze<W&&(Ce*=256);)this[F+Ze]=255&T/Ce;return F+W},d.prototype.writeUIntBE=function(T,F,W,ne){if(T=+T,F>>>=0,W>>>=0,!ne){var he=n(2,8*W)-1;xe(this,T,F,W,he,0)}var Ce=W-1,Ze=1;for(this[F+Ce]=255&T;0<=--Ce&&(Ze*=256);)this[F+Ce]=255&T/Ze;return F+W},d.prototype.writeUInt8=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,1,255,0),this[F]=255&T,F+1},d.prototype.writeUInt16LE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,2,65535,0),this[F]=255&T,this[F+1]=T>>>8,F+2},d.prototype.writeUInt16BE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,2,65535,0),this[F]=T>>>8,this[F+1]=255&T,F+2},d.prototype.writeUInt32LE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,4,4294967295,0),this[F+3]=T>>>24,this[F+2]=T>>>16,this[F+1]=T>>>8,this[F]=255&T,F+4},d.prototype.writeUInt32BE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,4,4294967295,0),this[F]=T>>>24,this[F+1]=T>>>16,this[F+2]=T>>>8,this[F+3]=255&T,F+4},d.prototype.writeIntLE=function(T,F,W,ne){if(T=+T,F>>>=0,!ne){var he=n(2,8*W-1);xe(this,T,F,W,he-1,-he)}var Ce=0,Ze=1,Ft=0;for(this[F]=255&T;++Ce<W&&(Ze*=256);)0>T&&Ft===0&&this[F+Ce-1]!==0&&(Ft=1),this[F+Ce]=255&(T/Ze>>0)-Ft;return F+W},d.prototype.writeIntBE=function(T,F,W,ne){if(T=+T,F>>>=0,!ne){var he=n(2,8*W-1);xe(this,T,F,W,he-1,-he)}var Ce=W-1,Ze=1,Ft=0;for(this[F+Ce]=255&T;0<=--Ce&&(Ze*=256);)0>T&&Ft===0&&this[F+Ce+1]!==0&&(Ft=1),this[F+Ce]=255&(T/Ze>>0)-Ft;return F+W},d.prototype.writeInt8=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,1,127,-128),0>T&&(T=255+T+1),this[F]=255&T,F+1},d.prototype.writeInt16LE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,2,32767,-32768),this[F]=255&T,this[F+1]=T>>>8,F+2},d.prototype.writeInt16BE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,2,32767,-32768),this[F]=T>>>8,this[F+1]=255&T,F+2},d.prototype.writeInt32LE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,4,2147483647,-2147483648),this[F]=255&T,this[F+1]=T>>>8,this[F+2]=T>>>16,this[F+3]=T>>>24,F+4},d.prototype.writeInt32BE=function(T,F,W){return T=+T,F>>>=0,W||xe(this,T,F,4,2147483647,-2147483648),0>T&&(T=4294967295+T+1),this[F]=T>>>24,this[F+1]=T>>>16,this[F+2]=T>>>8,this[F+3]=255&T,F+4},d.prototype.writeFloatLE=function(T,F,W){return Xe(this,T,F,!0,W)},d.prototype.writeFloatBE=function(T,F,W){return Xe(this,T,F,!1,W)},d.prototype.writeDoubleLE=function(T,F,W){return ht(this,T,F,!0,W)},d.prototype.writeDoubleBE=function(T,F,W){return ht(this,T,F,!1,W)},d.prototype.copy=function(T,F,W,ne){if(!d.isBuffer(T))throw new TypeError("argument should be a Buffer");if(W||(W=0),ne||ne===0||(ne=this.length),F>=T.length&&(F=T.length),F||(F=0),0<ne&&ne<W&&(ne=W),ne===W||T.length===0||this.length===0)return 0;if(0>F)throw new RangeError("targetStart out of bounds");if(0>W||W>=this.length)throw new RangeError("Index out of range");if(0>ne)throw new RangeError("sourceEnd out of bounds");ne>this.length&&(ne=this.length),T.length-F<ne-W&&(ne=T.length-F+W);var he=ne-W;if(this===T&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(F,W,ne);else if(this===T&&W<F&&F<ne)for(var Ce=he-1;0<=Ce;--Ce)T[Ce+F]=this[Ce+W];else Uint8Array.prototype.set.call(T,this.subarray(W,ne),F);return he},d.prototype.fill=function(T,F,W,ne){if(typeof T=="string"){if(typeof F=="string"?(ne=F,F=0,W=this.length):typeof W=="string"&&(ne=W,W=this.length),ne!==void 0&&typeof ne!="string")throw new TypeError("encoding must be a string");if(typeof ne=="string"&&!d.isEncoding(ne))throw new TypeError("Unknown encoding: "+ne);if(T.length===1){var he=T.charCodeAt(0);(ne==="utf8"&&128>he||ne==="latin1")&&(T=he)}}else typeof T=="number"&&(T&=255);if(0>F||this.length<F||this.length<W)throw new RangeError("Out of range index");if(W<=F)return this;F>>>=0,W=W===void 0?this.length:W>>>0,T||(T=0);var Ce;if(typeof T=="number")for(Ce=F;Ce<W;++Ce)this[Ce]=T;else{var Ze=d.isBuffer(T)?T:d.from(T,ne),Ft=Ze.length;if(Ft===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(Ce=0;Ce<W-F;++Ce)this[Ce+F]=Ze[Ce%Ft]}return this};var Q=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(r,o,a){(function(l){(function(){function c(){let d;try{d=a.storage.getItem("debug")}catch{}return!d&&typeof l<"u"&&"env"in l&&(d=l.env.DEBUG),d}a.formatArgs=function(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!this.useColors)return;const g="color: "+this.color;d.splice(1,0,g,"color: inherit");let p=0,_=0;d[0].replace(/%[a-zA-Z%]/g,b=>{b==="%%"||(p++,b==="%c"&&(_=p))}),d.splice(_,0,g)},a.save=function(d){try{d?a.storage.setItem("debug",d):a.storage.removeItem("debug")}catch{}},a.load=c,a.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},a.storage=(function(){try{return localStorage}catch{}})(),a.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],a.log=console.debug||console.log||(()=>{}),o.exports=r("./common")(a);const{formatters:h}=o.exports;h.j=function(d){try{return JSON.stringify(d)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}}).call(this)}).call(this,r("_process"))},{"./common":5,_process:12}],5:[function(r,o){o.exports=function(a){function l(d){function g(...b){if(!g.enabled)return;const C=g,x=+new Date,S=x-(p||x);C.diff=S,C.prev=p,C.curr=x,p=x,b[0]=l.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let y=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(D,R)=>{if(D==="%%")return"%";y++;const N=l.formatters[R];if(typeof N=="function"){const A=b[y];D=N.call(C,A),b.splice(y,1),y--}return D}),l.formatArgs.call(C,b),(C.log||l.log).apply(C,b)}let p,_=null;return g.namespace=d,g.useColors=l.useColors(),g.color=l.selectColor(d),g.extend=c,g.destroy=l.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>_===null?l.enabled(d):_,set:b=>{_=b}}),typeof l.init=="function"&&l.init(g),g}function c(d,g){const p=l(this.namespace+(typeof g>"u"?":":g)+d);return p.log=this.log,p}function h(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}return l.debug=l,l.default=l,l.coerce=function(d){return d instanceof Error?d.stack||d.message:d},l.disable=function(){const d=[...l.names.map(h),...l.skips.map(h).map(g=>"-"+g)].join(",");return l.enable(""),d},l.enable=function(d){l.save(d),l.names=[],l.skips=[];let g;const p=(typeof d=="string"?d:"").split(/[\s,]+/),_=p.length;for(g=0;g<_;g++)p[g]&&(d=p[g].replace(/\*/g,".*?"),d[0]==="-"?l.skips.push(new RegExp("^"+d.substr(1)+"$")):l.names.push(new RegExp("^"+d+"$")))},l.enabled=function(d){if(d[d.length-1]==="*")return!0;let g,p;for(g=0,p=l.skips.length;g<p;g++)if(l.skips[g].test(d))return!1;for(g=0,p=l.names.length;g<p;g++)if(l.names[g].test(d))return!0;return!1},l.humanize=r("ms"),l.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(d=>{l[d]=a[d]}),l.names=[],l.skips=[],l.formatters={},l.selectColor=function(d){let g=0;for(let p=0;p<d.length;p++)g=(g<<5)-g+d.charCodeAt(p),g|=0;return l.colors[i(g)%l.colors.length]},l.enable(l.load()),l}},{ms:11}],6:[function(r,o){function a(l,c){for(const h in c)Object.defineProperty(l,h,{value:c[h],enumerable:!0,configurable:!0});return l}o.exports=function(l,c,h){if(!l||typeof l=="string")throw new TypeError("Please pass an Error to err-code");h||(h={}),typeof c=="object"&&(h=c,c=""),c&&(h.code=c);try{return a(l,h)}catch{h.message=l.message,h.stack=l.stack;const g=function(){};return g.prototype=Object.create(Object.getPrototypeOf(l)),a(new g,h)}}},{}],7:[function(r,o){function a(O){console&&console.warn&&console.warn(O)}function l(){l.init.call(this)}function c(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}function h(O){return O._maxListeners===void 0?l.defaultMaxListeners:O._maxListeners}function d(O,V,H,U){var X,Y,q;if(c(H),Y=O._events,Y===void 0?(Y=O._events=Object.create(null),O._eventsCount=0):(Y.newListener!==void 0&&(O.emit("newListener",V,H.listener?H.listener:H),Y=O._events),q=Y[V]),q===void 0)q=Y[V]=H,++O._eventsCount;else if(typeof q=="function"?q=Y[V]=U?[H,q]:[q,H]:U?q.unshift(H):q.push(H),X=h(O),0<X&&q.length>X&&!q.warned){q.warned=!0;var ee=new Error("Possible EventEmitter memory leak detected. "+q.length+" "+(V+" listeners added. Use emitter.setMaxListeners() to increase limit"));ee.name="MaxListenersExceededWarning",ee.emitter=O,ee.type=V,ee.count=q.length,a(ee)}return O}function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(O,V,H){var U={fired:!1,wrapFn:void 0,target:O,type:V,listener:H},X=g.bind(U);return X.listener=H,U.wrapFn=X,X}function _(O,V,H){var U=O._events;if(U===void 0)return[];var X=U[V];return X===void 0?[]:typeof X=="function"?H?[X.listener||X]:[X]:H?S(X):C(X,X.length)}function b(O){var V=this._events;if(V!==void 0){var H=V[O];if(typeof H=="function")return 1;if(H!==void 0)return H.length}return 0}function C(O,V){for(var H=Array(V),U=0;U<V;++U)H[U]=O[U];return H}function x(O,V){for(;V+1<O.length;V++)O[V]=O[V+1];O.pop()}function S(O){for(var V=Array(O.length),H=0;H<V.length;++H)V[H]=O[H].listener||O[H];return V}function y(O,V,H){typeof O.on=="function"&&k(O,"error",V,H)}function k(O,V,H,U){if(typeof O.on=="function")U.once?O.once(V,H):O.on(V,H);else if(typeof O.addEventListener=="function")O.addEventListener(V,function X(Y){U.once&&O.removeEventListener(V,X),H(Y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}var D,R=typeof Reflect=="object"?Reflect:null,N=R&&typeof R.apply=="function"?R.apply:function(O,V,H){return Function.prototype.apply.call(O,V,H)};D=R&&typeof R.ownKeys=="function"?R.ownKeys:Object.getOwnPropertySymbols?function(O){return Object.getOwnPropertyNames(O).concat(Object.getOwnPropertySymbols(O))}:function(O){return Object.getOwnPropertyNames(O)};var A=Number.isNaN||function(O){return O!==O};o.exports=l,o.exports.once=function(O,V){return new Promise(function(H,U){function X(q){O.removeListener(V,Y),U(q)}function Y(){typeof O.removeListener=="function"&&O.removeListener("error",X),H([].slice.call(arguments))}k(O,V,Y,{once:!0}),V!=="error"&&y(O,X,{once:!0})})},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var M=10;Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return M},set:function(O){if(typeof O!="number"||0>O||A(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");M=O}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(O){if(typeof O!="number"||0>O||A(O))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+O+".");return this._maxListeners=O,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(O){for(var V=[],H=1;H<arguments.length;H++)V.push(arguments[H]);var U=O==="error",X=this._events;if(X!==void 0)U=U&&X.error===void 0;else if(!U)return!1;if(U){var Y;if(0<V.length&&(Y=V[0]),Y instanceof Error)throw Y;var q=new Error("Unhandled error."+(Y?" ("+Y.message+")":""));throw q.context=Y,q}var ee=X[O];if(ee===void 0)return!1;if(typeof ee=="function")N(ee,this,V);else for(var ue=ee.length,oe=C(ee,ue),H=0;H<ue;++H)N(oe[H],this,V);return!0},l.prototype.addListener=function(O,V){return d(this,O,V,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(O,V){return d(this,O,V,!0)},l.prototype.once=function(O,V){return c(V),this.on(O,p(this,O,V)),this},l.prototype.prependOnceListener=function(O,V){return c(V),this.prependListener(O,p(this,O,V)),this},l.prototype.removeListener=function(O,V){var H,U,X,Y,q;if(c(V),U=this._events,U===void 0)return this;if(H=U[O],H===void 0)return this;if(H===V||H.listener===V)--this._eventsCount==0?this._events=Object.create(null):(delete U[O],U.removeListener&&this.emit("removeListener",O,H.listener||V));else if(typeof H!="function"){for(X=-1,Y=H.length-1;0<=Y;Y--)if(H[Y]===V||H[Y].listener===V){q=H[Y].listener,X=Y;break}if(0>X)return this;X===0?H.shift():x(H,X),H.length===1&&(U[O]=H[0]),U.removeListener!==void 0&&this.emit("removeListener",O,q||V)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(O){var V,H,U;if(H=this._events,H===void 0)return this;if(H.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):H[O]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete H[O]),this;if(arguments.length===0){var X,Y=Object.keys(H);for(U=0;U<Y.length;++U)X=Y[U],X!=="removeListener"&&this.removeAllListeners(X);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(V=H[O],typeof V=="function")this.removeListener(O,V);else if(V!==void 0)for(U=V.length-1;0<=U;U--)this.removeListener(O,V[U]);return this},l.prototype.listeners=function(O){return _(this,O,!0)},l.prototype.rawListeners=function(O){return _(this,O,!1)},l.listenerCount=function(O,V){return typeof O.listenerCount=="function"?O.listenerCount(V):b.call(O,V)},l.prototype.listenerCount=b,l.prototype.eventNames=function(){return 0<this._eventsCount?D(this._events):[]}},{}],8:[function(r,o){o.exports=function(){if(typeof globalThis>"u")return null;var a={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return a.RTCPeerConnection?a:null}},{}],9:[function(r,o,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(l,c,h,d,g){var p,_,b=8*g-d-1,C=(1<<b)-1,x=C>>1,S=-7,y=h?g-1:0,k=h?-1:1,D=l[c+y];for(y+=k,p=D&(1<<-S)-1,D>>=-S,S+=b;0<S;p=256*p+l[c+y],y+=k,S-=8);for(_=p&(1<<-S)-1,p>>=-S,S+=d;0<S;_=256*_+l[c+y],y+=k,S-=8);if(p===0)p=1-x;else{if(p===C)return _?NaN:(D?-1:1)*(1/0);_+=n(2,d),p-=x}return(D?-1:1)*_*n(2,p-d)},a.write=function(l,c,h,d,g,p){var _,b,C,x=Math.LN2,S=Math.log,y=8*p-g-1,k=(1<<y)-1,D=k>>1,R=g===23?n(2,-24)-n(2,-77):0,N=d?0:p-1,A=d?1:-1,M=0>c||c===0&&0>1/c?1:0;for(c=i(c),isNaN(c)||c===1/0?(b=isNaN(c)?1:0,_=k):(_=t(S(c)/x),1>c*(C=n(2,-_))&&(_--,C*=2),c+=1<=_+D?R/C:R*n(2,1-D),2<=c*C&&(_++,C/=2),_+D>=k?(b=0,_=k):1<=_+D?(b=(c*C-1)*n(2,g),_+=D):(b=c*n(2,D-1)*n(2,g),_=0));8<=g;l[h+N]=255&b,N+=A,b/=256,g-=8);for(_=_<<g|b,y+=g;0<y;l[h+N]=255&_,N+=A,_/=256,y-=8);l[h+N-A]|=128*M}},{}],10:[function(r,o){o.exports=typeof Object.create=="function"?function(a,l){l&&(a.super_=l,a.prototype=Object.create(l.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:function(a,l){if(l){a.super_=l;var c=function(){};c.prototype=l.prototype,a.prototype=new c,a.prototype.constructor=a}}},{}],11:[function(r,o){var a=Math.round;function l(g){if(g+="",!(100<g.length)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(p){var _=parseFloat(p[1]),b=(p[2]||"ms").toLowerCase();return b==="years"||b==="year"||b==="yrs"||b==="yr"||b==="y"?315576e5*_:b==="weeks"||b==="week"||b==="w"?6048e5*_:b==="days"||b==="day"||b==="d"?864e5*_:b==="hours"||b==="hour"||b==="hrs"||b==="hr"||b==="h"?36e5*_:b==="minutes"||b==="minute"||b==="mins"||b==="min"||b==="m"?6e4*_:b==="seconds"||b==="second"||b==="secs"||b==="sec"||b==="s"?1e3*_:b==="milliseconds"||b==="millisecond"||b==="msecs"||b==="msec"||b==="ms"?_:void 0}}}function c(g){var p=i(g);return 864e5<=p?a(g/864e5)+"d":36e5<=p?a(g/36e5)+"h":6e4<=p?a(g/6e4)+"m":1e3<=p?a(g/1e3)+"s":g+"ms"}function h(g){var p=i(g);return 864e5<=p?d(g,p,864e5,"day"):36e5<=p?d(g,p,36e5,"hour"):6e4<=p?d(g,p,6e4,"minute"):1e3<=p?d(g,p,1e3,"second"):g+" ms"}function d(g,p,_,b){return a(g/_)+" "+b+(p>=1.5*_?"s":"")}o.exports=function(g,p){p=p||{};var _=typeof g;if(_=="string"&&0<g.length)return l(g);if(_==="number"&&isFinite(g))return p.long?h(g):c(g);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(g))}},{}],12:[function(r,o){function a(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function c(R){if(b===setTimeout)return setTimeout(R,0);if((b===a||!b)&&setTimeout)return b=setTimeout,setTimeout(R,0);try{return b(R,0)}catch{try{return b.call(null,R,0)}catch{return b.call(this,R,0)}}}function h(R){if(C===clearTimeout)return clearTimeout(R);if((C===l||!C)&&clearTimeout)return C=clearTimeout,clearTimeout(R);try{return C(R)}catch{try{return C.call(null,R)}catch{return C.call(this,R)}}}function d(){k&&S&&(k=!1,S.length?y=S.concat(y):D=-1,y.length&&g())}function g(){if(!k){var R=c(d);k=!0;for(var N=y.length;N;){for(S=y,y=[];++D<N;)S&&S[D].run();D=-1,N=y.length}S=null,k=!1,h(R)}}function p(R,N){this.fun=R,this.array=N}function _(){}var b,C,x=o.exports={};(function(){try{b=typeof setTimeout=="function"?setTimeout:a}catch{b=a}try{C=typeof clearTimeout=="function"?clearTimeout:l}catch{C=l}})();var S,y=[],k=!1,D=-1;x.nextTick=function(R){var N=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)N[A-1]=arguments[A];y.push(new p(R,N)),y.length!==1||k||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},x.title="browser",x.browser=!0,x.env={},x.argv=[],x.version="",x.versions={},x.on=_,x.addListener=_,x.once=_,x.off=_,x.removeListener=_,x.removeAllListeners=_,x.emit=_,x.prependListener=_,x.prependOnceListener=_,x.listeners=function(){return[]},x.binding=function(){throw new Error("process.binding is not supported")},x.cwd=function(){return"/"},x.chdir=function(){throw new Error("process.chdir is not supported")},x.umask=function(){return 0}},{}],13:[function(r,o){(function(a){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let l;o.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?a:window):c=>(l||(l=Promise.resolve())).then(c).catch(h=>setTimeout(()=>{throw h},0))}).call(this)}).call(this,typeof Nl>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nl)},{}],14:[function(r,o){(function(a,l){(function(){var c=r("safe-buffer").Buffer,h=l.crypto||l.msCrypto;o.exports=h&&h.getRandomValues?function(d,g){if(d>4294967295)throw new RangeError("requested too many random bytes");var p=c.allocUnsafe(d);if(0<d)if(65536<d)for(var _=0;_<d;_+=65536)h.getRandomValues(p.slice(_,_+65536));else h.getRandomValues(p);return typeof g=="function"?a.nextTick(function(){g(null,p)}):p}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,r("_process"),typeof Nl>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nl)},{_process:12,"safe-buffer":30}],15:[function(r,o){function a(_,b){_.prototype=Object.create(b.prototype),_.prototype.constructor=_,_.__proto__=b}function l(_,b,C){function x(y,k,D){return typeof b=="string"?b:b(y,k,D)}C||(C=Error);var S=(function(y){function k(D,R,N){return y.call(this,x(D,R,N))||this}return a(k,y),k})(C);S.prototype.name=C.name,S.prototype.code=_,p[_]=S}function c(_,b){if(Array.isArray(_)){var C=_.length;return _=_.map(function(x){return x+""}),2<C?"one of ".concat(b," ").concat(_.slice(0,C-1).join(", "),", or ")+_[C-1]:C===2?"one of ".concat(b," ").concat(_[0]," or ").concat(_[1]):"of ".concat(b," ").concat(_[0])}return"of ".concat(b," ").concat(_+"")}function h(_,b,C){return _.substr(0,b.length)===b}function d(_,b,C){return(C===void 0||C>_.length)&&(C=_.length),_.substring(C-b.length,C)===b}function g(_,b,C){return typeof C!="number"&&(C=0),!(C+b.length>_.length)&&_.indexOf(b,C)!==-1}var p={};l("ERR_INVALID_OPT_VALUE",function(_,b){return'The value "'+b+'" is invalid for option "'+_+'"'},TypeError),l("ERR_INVALID_ARG_TYPE",function(_,b,C){var x;typeof b=="string"&&h(b,"not ")?(x="must not be",b=b.replace(/^not /,"")):x="must be";var S;if(d(_," argument"))S="The ".concat(_," ").concat(x," ").concat(c(b,"type"));else{var y=g(_,".")?"property":"argument";S='The "'.concat(_,'" ').concat(y," ").concat(x," ").concat(c(b,"type"))}return S+=". Received type ".concat(typeof C),S},TypeError),l("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),l("ERR_METHOD_NOT_IMPLEMENTED",function(_){return"The "+_+" method is not implemented"}),l("ERR_STREAM_PREMATURE_CLOSE","Premature close"),l("ERR_STREAM_DESTROYED",function(_){return"Cannot call "+_+" after a stream was destroyed"}),l("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),l("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),l("ERR_STREAM_WRITE_AFTER_END","write after end"),l("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),l("ERR_UNKNOWN_ENCODING",function(_){return"Unknown encoding: "+_},TypeError),l("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),o.exports.codes=p},{}],16:[function(r,o){(function(a){(function(){function l(x){return this instanceof l?(g.call(this,x),p.call(this,x),this.allowHalfOpen=!0,void(x&&(x.readable===!1&&(this.readable=!1),x.writable===!1&&(this.writable=!1),x.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",c))))):new l(x)}function c(){this._writableState.ended||a.nextTick(h,this)}function h(x){x.end()}var d=Object.keys||function(x){var S=[];for(var y in x)S.push(y);return S};o.exports=l;var g=r("./_stream_readable"),p=r("./_stream_writable");r("inherits")(l,g);for(var _,b=d(p.prototype),C=0;C<b.length;C++)_=b[C],l.prototype[_]||(l.prototype[_]=p.prototype[_]);Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=x,this._writableState.destroyed=x)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(r,o){function a(c){return this instanceof a?void l.call(this,c):new a(c)}o.exports=a;var l=r("./_stream_transform");r("inherits")(a,l),a.prototype._transform=function(c,h,d){d(null,c)}},{"./_stream_transform":19,inherits:10}],18:[function(r,o){(function(a,l){(function(){function c(Q){return ce.from(Q)}function h(Q){return ce.isBuffer(Q)||Q instanceof de}function d(Q,T,F){return typeof Q.prependListener=="function"?Q.prependListener(T,F):void(Q._events&&Q._events[T]?Array.isArray(Q._events[T])?Q._events[T].unshift(F):Q._events[T]=[F,Q._events[T]]:Q.on(T,F))}function g(Q,T,F){ue=ue||r("./_stream_duplex"),Q=Q||{},typeof F!="boolean"&&(F=T instanceof ue),this.objectMode=!!Q.objectMode,F&&(this.objectMode=this.objectMode||!!Q.readableObjectMode),this.highWaterMark=vr(this,Q,"readableHighWaterMark",F),this.buffer=new bi,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Q.emitClose!==!1,this.autoDestroy=!!Q.autoDestroy,this.destroyed=!1,this.defaultEncoding=Q.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Q.encoding&&(!Re&&(Re=r("string_decoder/").StringDecoder),this.decoder=new Re(Q.encoding),this.encoding=Q.encoding)}function p(Q){if(ue=ue||r("./_stream_duplex"),!(this instanceof p))return new p(Q);var T=this instanceof ue;this._readableState=new g(Q,this,T),this.readable=!0,Q&&(typeof Q.read=="function"&&(this._read=Q.read),typeof Q.destroy=="function"&&(this._destroy=Q.destroy)),$.call(this)}function _(Q,T,F,W,ne){oe("readableAddChunk",T);var he=Q._readableState;if(T===null)he.reading=!1,y(Q,he);else{var Ce;if(ne||(Ce=C(he,T)),Ce)Fe(Q,Ce);else if(!(he.objectMode||T&&0<T.length))W||(he.reading=!1,R(Q,he));else if(typeof T=="string"||he.objectMode||Object.getPrototypeOf(T)===ce.prototype||(T=c(T)),W)he.endEmitted?Fe(Q,new ye):b(Q,he,T,!0);else if(he.ended)Fe(Q,new qi);else{if(he.destroyed)return!1;he.reading=!1,he.decoder&&!F?(T=he.decoder.write(T),he.objectMode||T.length!==0?b(Q,he,T,!1):R(Q,he)):b(Q,he,T,!1)}}return!he.ended&&(he.length<he.highWaterMark||he.length===0)}function b(Q,T,F,W){T.flowing&&T.length===0&&!T.sync?(T.awaitDrain=0,Q.emit("data",F)):(T.length+=T.objectMode?1:F.length,W?T.buffer.unshift(F):T.buffer.push(F),T.needReadable&&k(Q)),R(Q,T)}function C(Q,T){var F;return h(T)||typeof T=="string"||T===void 0||Q.objectMode||(F=new on("chunk",["string","Buffer","Uint8Array"],T)),F}function x(Q){return 1073741824<=Q?Q=1073741824:(Q--,Q|=Q>>>1,Q|=Q>>>2,Q|=Q>>>4,Q|=Q>>>8,Q|=Q>>>16,Q++),Q}function S(Q,T){return 0>=Q||T.length===0&&T.ended?0:T.objectMode?1:Q===Q?(Q>T.highWaterMark&&(T.highWaterMark=x(Q)),Q<=T.length?Q:T.ended?T.length:(T.needReadable=!0,0)):T.flowing&&T.length?T.buffer.head.data.length:T.length}function y(Q,T){if(oe("onEofChunk"),!T.ended){if(T.decoder){var F=T.decoder.end();F&&F.length&&(T.buffer.push(F),T.length+=T.objectMode?1:F.length)}T.ended=!0,T.sync?k(Q):(T.needReadable=!1,!T.emittedReadable&&(T.emittedReadable=!0,D(Q)))}}function k(Q){var T=Q._readableState;oe("emitReadable",T.needReadable,T.emittedReadable),T.needReadable=!1,T.emittedReadable||(oe("emitReadable",T.flowing),T.emittedReadable=!0,a.nextTick(D,Q))}function D(Q){var T=Q._readableState;oe("emitReadable_",T.destroyed,T.length,T.ended),!T.destroyed&&(T.length||T.ended)&&(Q.emit("readable"),T.emittedReadable=!1),T.needReadable=!T.flowing&&!T.ended&&T.length<=T.highWaterMark,U(Q)}function R(Q,T){T.readingMore||(T.readingMore=!0,a.nextTick(N,Q,T))}function N(Q,T){for(;!T.reading&&!T.ended&&(T.length<T.highWaterMark||T.flowing&&T.length===0);){var F=T.length;if(oe("maybeReadMore read 0"),Q.read(0),F===T.length)break}T.readingMore=!1}function A(Q){return function(){var T=Q._readableState;oe("pipeOnDrain",T.awaitDrain),T.awaitDrain&&T.awaitDrain--,T.awaitDrain===0&&Ee(Q,"data")&&(T.flowing=!0,U(Q))}}function M(Q){var T=Q._readableState;T.readableListening=0<Q.listenerCount("readable"),T.resumeScheduled&&!T.paused?T.flowing=!0:0<Q.listenerCount("data")&&Q.resume()}function O(Q){oe("readable nexttick read 0"),Q.read(0)}function V(Q,T){T.resumeScheduled||(T.resumeScheduled=!0,a.nextTick(H,Q,T))}function H(Q,T){oe("resume",T.reading),T.reading||Q.read(0),T.resumeScheduled=!1,Q.emit("resume"),U(Q),T.flowing&&!T.reading&&Q.read(0)}function U(Q){var T=Q._readableState;for(oe("flow",T.flowing);T.flowing&&Q.read()!==null;);}function X(Q,T){if(T.length===0)return null;var F;return T.objectMode?F=T.buffer.shift():!Q||Q>=T.length?(F=T.decoder?T.buffer.join(""):T.buffer.length===1?T.buffer.first():T.buffer.concat(T.length),T.buffer.clear()):F=T.buffer.consume(Q,T.decoder),F}function Y(Q){var T=Q._readableState;oe("endReadable",T.endEmitted),T.endEmitted||(T.ended=!0,a.nextTick(q,T,Q))}function q(Q,T){if(oe("endReadableNT",Q.endEmitted,Q.length),!Q.endEmitted&&Q.length===0&&(Q.endEmitted=!0,T.readable=!1,T.emit("end"),Q.autoDestroy)){var F=T._writableState;(!F||F.autoDestroy&&F.finished)&&T.destroy()}}function ee(Q,T){for(var F=0,W=Q.length;F<W;F++)if(Q[F]===T)return F;return-1}o.exports=p;var ue;p.ReadableState=g;var oe;r("events").EventEmitter;var Ee=function(Q,T){return Q.listeners(T).length},$=r("./internal/streams/stream"),ce=r("buffer").Buffer,de=l.Uint8Array||function(){},xe=r("util");oe=xe&&xe.debuglog?xe.debuglog("stream"):function(){};var Re,Xe,ht,bi=r("./internal/streams/buffer_list"),qt=r("./internal/streams/destroy"),An=r("./internal/streams/state"),vr=An.getHighWaterMark,li=r("../errors").codes,on=li.ERR_INVALID_ARG_TYPE,qi=li.ERR_STREAM_PUSH_AFTER_EOF,pe=li.ERR_METHOD_NOT_IMPLEMENTED,ye=li.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(p,$);var Fe=qt.errorOrDestroy,st=["error","close","destroy","pause","resume"];Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(Q){this._readableState&&(this._readableState.destroyed=Q)}}),p.prototype.destroy=qt.destroy,p.prototype._undestroy=qt.undestroy,p.prototype._destroy=function(Q,T){T(Q)},p.prototype.push=function(Q,T){var F,W=this._readableState;return W.objectMode?F=!0:typeof Q=="string"&&(T=T||W.defaultEncoding,T!==W.encoding&&(Q=ce.from(Q,T),T=""),F=!0),_(this,Q,T,!1,F)},p.prototype.unshift=function(Q){return _(this,Q,null,!0,!1)},p.prototype.isPaused=function(){return this._readableState.flowing===!1},p.prototype.setEncoding=function(Q){Re||(Re=r("string_decoder/").StringDecoder);var T=new Re(Q);this._readableState.decoder=T,this._readableState.encoding=this._readableState.decoder.encoding;for(var F=this._readableState.buffer.head,W="";F!==null;)W+=T.write(F.data),F=F.next;return this._readableState.buffer.clear(),W!==""&&this._readableState.buffer.push(W),this._readableState.length=W.length,this},p.prototype.read=function(Q){oe("read",Q),Q=parseInt(Q,10);var T=this._readableState,F=Q;if(Q!==0&&(T.emittedReadable=!1),Q===0&&T.needReadable&&((T.highWaterMark===0?0<T.length:T.length>=T.highWaterMark)||T.ended))return oe("read: emitReadable",T.length,T.ended),T.length===0&&T.ended?Y(this):k(this),null;if(Q=S(Q,T),Q===0&&T.ended)return T.length===0&&Y(this),null;var W=T.needReadable;oe("need readable",W),(T.length===0||T.length-Q<T.highWaterMark)&&(W=!0,oe("length less than watermark",W)),T.ended||T.reading?(W=!1,oe("reading or ended",W)):W&&(oe("do read"),T.reading=!0,T.sync=!0,T.length===0&&(T.needReadable=!0),this._read(T.highWaterMark),T.sync=!1,!T.reading&&(Q=S(F,T)));var ne;return ne=0<Q?X(Q,T):null,ne===null?(T.needReadable=T.length<=T.highWaterMark,Q=0):(T.length-=Q,T.awaitDrain=0),T.length===0&&(!T.ended&&(T.needReadable=!0),F!==Q&&T.ended&&Y(this)),ne!==null&&this.emit("data",ne),ne},p.prototype._read=function(){Fe(this,new pe("_read()"))},p.prototype.pipe=function(Q,T){function F(On,bn){oe("onunpipe"),On===zt&&bn&&bn.hasUnpiped===!1&&(bn.hasUnpiped=!0,ne())}function W(){oe("onend"),Q.end()}function ne(){oe("cleanup"),Q.removeListener("close",Ze),Q.removeListener("finish",Ft),Q.removeListener("drain",Ks),Q.removeListener("error",Ce),Q.removeListener("unpipe",F),zt.removeListener("end",W),zt.removeListener("end",Si),zt.removeListener("data",he),Mi=!0,At.awaitDrain&&(!Q._writableState||Q._writableState.needDrain)&&Ks()}function he(On){oe("ondata");var bn=Q.write(On);oe("dest.write",bn),bn===!1&&((At.pipesCount===1&&At.pipes===Q||1<At.pipesCount&&ee(At.pipes,Q)!==-1)&&!Mi&&(oe("false write response, pause",At.awaitDrain),At.awaitDrain++),zt.pause())}function Ce(On){oe("onerror",On),Si(),Q.removeListener("error",Ce),Ee(Q,"error")===0&&Fe(Q,On)}function Ze(){Q.removeListener("finish",Ft),Si()}function Ft(){oe("onfinish"),Q.removeListener("close",Ze),Si()}function Si(){oe("unpipe"),zt.unpipe(Q)}var zt=this,At=this._readableState;switch(At.pipesCount){case 0:At.pipes=Q;break;case 1:At.pipes=[At.pipes,Q];break;default:At.pipes.push(Q)}At.pipesCount+=1,oe("pipe count=%d opts=%j",At.pipesCount,T);var Mn=(!T||T.end!==!1)&&Q!==a.stdout&&Q!==a.stderr,Jr=Mn?W:Si;At.endEmitted?a.nextTick(Jr):zt.once("end",Jr),Q.on("unpipe",F);var Ks=A(zt);Q.on("drain",Ks);var Mi=!1;return zt.on("data",he),d(Q,"error",Ce),Q.once("close",Ze),Q.once("finish",Ft),Q.emit("pipe",zt),At.flowing||(oe("pipe resume"),zt.resume()),Q},p.prototype.unpipe=function(Q){var T=this._readableState,F={hasUnpiped:!1};if(T.pipesCount===0)return this;if(T.pipesCount===1)return Q&&Q!==T.pipes?this:(Q||(Q=T.pipes),T.pipes=null,T.pipesCount=0,T.flowing=!1,Q&&Q.emit("unpipe",this,F),this);if(!Q){var W=T.pipes,ne=T.pipesCount;T.pipes=null,T.pipesCount=0,T.flowing=!1;for(var he=0;he<ne;he++)W[he].emit("unpipe",this,{hasUnpiped:!1});return this}var Ce=ee(T.pipes,Q);return Ce===-1?this:(T.pipes.splice(Ce,1),T.pipesCount-=1,T.pipesCount===1&&(T.pipes=T.pipes[0]),Q.emit("unpipe",this,F),this)},p.prototype.on=function(Q,T){var F=$.prototype.on.call(this,Q,T),W=this._readableState;return Q==="data"?(W.readableListening=0<this.listenerCount("readable"),W.flowing!==!1&&this.resume()):Q=="readable"&&!W.endEmitted&&!W.readableListening&&(W.readableListening=W.needReadable=!0,W.flowing=!1,W.emittedReadable=!1,oe("on readable",W.length,W.reading),W.length?k(this):!W.reading&&a.nextTick(O,this)),F},p.prototype.addListener=p.prototype.on,p.prototype.removeListener=function(Q,T){var F=$.prototype.removeListener.call(this,Q,T);return Q==="readable"&&a.nextTick(M,this),F},p.prototype.removeAllListeners=function(Q){var T=$.prototype.removeAllListeners.apply(this,arguments);return(Q==="readable"||Q===void 0)&&a.nextTick(M,this),T},p.prototype.resume=function(){var Q=this._readableState;return Q.flowing||(oe("resume"),Q.flowing=!Q.readableListening,V(this,Q)),Q.paused=!1,this},p.prototype.pause=function(){return oe("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(oe("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},p.prototype.wrap=function(Q){var T=this,F=this._readableState,W=!1;for(var ne in Q.on("end",function(){if(oe("wrapped end"),F.decoder&&!F.ended){var Ce=F.decoder.end();Ce&&Ce.length&&T.push(Ce)}T.push(null)}),Q.on("data",function(Ce){if(oe("wrapped data"),F.decoder&&(Ce=F.decoder.write(Ce)),!(F.objectMode&&Ce==null)&&(F.objectMode||Ce&&Ce.length)){var Ze=T.push(Ce);Ze||(W=!0,Q.pause())}}),Q)this[ne]===void 0&&typeof Q[ne]=="function"&&(this[ne]=(function(Ce){return function(){return Q[Ce].apply(Q,arguments)}})(ne));for(var he=0;he<st.length;he++)Q.on(st[he],this.emit.bind(this,st[he]));return this._read=function(Ce){oe("wrapped _read",Ce),W&&(W=!1,Q.resume())},this},typeof Symbol=="function"&&(p.prototype[Symbol.asyncIterator]=function(){return Xe===void 0&&(Xe=r("./internal/streams/async_iterator")),Xe(this)}),Object.defineProperty(p.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(p.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(p.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Q){this._readableState&&(this._readableState.flowing=Q)}}),p._fromList=X,Object.defineProperty(p.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(p.from=function(Q,T){return ht===void 0&&(ht=r("./internal/streams/from")),ht(p,Q,T)})}).call(this)}).call(this,r("_process"),typeof Nl>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nl)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(r,o){function a(x,S){var y=this._transformState;y.transforming=!1;var k=y.writecb;if(k===null)return this.emit("error",new p);y.writechunk=null,y.writecb=null,S!=null&&this.push(S),k(x);var D=this._readableState;D.reading=!1,(D.needReadable||D.length<D.highWaterMark)&&this._read(D.highWaterMark)}function l(x){return this instanceof l?(C.call(this,x),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,x&&(typeof x.transform=="function"&&(this._transform=x.transform),typeof x.flush=="function"&&(this._flush=x.flush)),void this.on("prefinish",c)):new l(x)}function c(){var x=this;typeof this._flush!="function"||this._readableState.destroyed?h(this,null,null):this._flush(function(S,y){h(x,S,y)})}function h(x,S,y){if(S)return x.emit("error",S);if(y!=null&&x.push(y),x._writableState.length)throw new b;if(x._transformState.transforming)throw new _;return x.push(null)}o.exports=l;var d=r("../errors").codes,g=d.ERR_METHOD_NOT_IMPLEMENTED,p=d.ERR_MULTIPLE_CALLBACK,_=d.ERR_TRANSFORM_ALREADY_TRANSFORMING,b=d.ERR_TRANSFORM_WITH_LENGTH_0,C=r("./_stream_duplex");r("inherits")(l,C),l.prototype.push=function(x,S){return this._transformState.needTransform=!1,C.prototype.push.call(this,x,S)},l.prototype._transform=function(x,S,y){y(new g("_transform()"))},l.prototype._write=function(x,S,y){var k=this._transformState;if(k.writecb=y,k.writechunk=x,k.writeencoding=S,!k.transforming){var D=this._readableState;(k.needTransform||D.needReadable||D.length<D.highWaterMark)&&this._read(D.highWaterMark)}},l.prototype._read=function(){var x=this._transformState;x.writechunk===null||x.transforming?x.needTransform=!0:(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform))},l.prototype._destroy=function(x,S){C.prototype._destroy.call(this,x,function(y){S(y)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(r,o){(function(a,l){(function(){function c(pe){var ye=this;this.next=null,this.entry=null,this.finish=function(){Y(ye,pe)}}function h(pe){return oe.from(pe)}function d(pe){return oe.isBuffer(pe)||pe instanceof Ee}function g(){}function p(pe,ye,Fe){q=q||r("./_stream_duplex"),pe=pe||{},typeof Fe!="boolean"&&(Fe=ye instanceof q),this.objectMode=!!pe.objectMode,Fe&&(this.objectMode=this.objectMode||!!pe.writableObjectMode),this.highWaterMark=de(this,pe,"writableHighWaterMark",Fe),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var st=pe.decodeStrings===!1;this.decodeStrings=!st,this.defaultEncoding=pe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Q){R(ye,Q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=pe.emitClose!==!1,this.autoDestroy=!!pe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function _(pe){q=q||r("./_stream_duplex");var ye=this instanceof q;return ye||qi.call(_,this)?(this._writableState=new p(pe,this,ye),this.writable=!0,pe&&(typeof pe.write=="function"&&(this._write=pe.write),typeof pe.writev=="function"&&(this._writev=pe.writev),typeof pe.destroy=="function"&&(this._destroy=pe.destroy),typeof pe.final=="function"&&(this._final=pe.final)),void ue.call(this)):new _(pe)}function b(pe,ye){var Fe=new vr;on(pe,Fe),a.nextTick(ye,Fe)}function C(pe,ye,Fe,st){var Q;return Fe===null?Q=new An:typeof Fe!="string"&&!ye.objectMode&&(Q=new Re("chunk",["string","Buffer"],Fe)),!Q||(on(pe,Q),a.nextTick(st,Q),!1)}function x(pe,ye,Fe){return pe.objectMode||pe.decodeStrings===!1||typeof ye!="string"||(ye=oe.from(ye,Fe)),ye}function S(pe,ye,Fe,st,Q,T){if(!Fe){var F=x(ye,st,Q);st!==F&&(Fe=!0,Q="buffer",st=F)}var W=ye.objectMode?1:st.length;ye.length+=W;var ne=ye.length<ye.highWaterMark;if(ne||(ye.needDrain=!0),ye.writing||ye.corked){var he=ye.lastBufferedRequest;ye.lastBufferedRequest={chunk:st,encoding:Q,isBuf:Fe,callback:T,next:null},he?he.next=ye.lastBufferedRequest:ye.bufferedRequest=ye.lastBufferedRequest,ye.bufferedRequestCount+=1}else y(pe,ye,!1,W,st,Q,T);return ne}function y(pe,ye,Fe,st,Q,T,F){ye.writelen=st,ye.writecb=F,ye.writing=!0,ye.sync=!0,ye.destroyed?ye.onwrite(new qt("write")):Fe?pe._writev(Q,ye.onwrite):pe._write(Q,T,ye.onwrite),ye.sync=!1}function k(pe,ye,Fe,st,Q){--ye.pendingcb,Fe?(a.nextTick(Q,st),a.nextTick(U,pe,ye),pe._writableState.errorEmitted=!0,on(pe,st)):(Q(st),pe._writableState.errorEmitted=!0,on(pe,st),U(pe,ye))}function D(pe){pe.writing=!1,pe.writecb=null,pe.length-=pe.writelen,pe.writelen=0}function R(pe,ye){var Fe=pe._writableState,st=Fe.sync,Q=Fe.writecb;if(typeof Q!="function")throw new ht;if(D(Fe),ye)k(pe,Fe,st,ye,Q);else{var T=O(Fe)||pe.destroyed;T||Fe.corked||Fe.bufferProcessing||!Fe.bufferedRequest||M(pe,Fe),st?a.nextTick(N,pe,Fe,T,Q):N(pe,Fe,T,Q)}}function N(pe,ye,Fe,st){Fe||A(pe,ye),ye.pendingcb--,st(),U(pe,ye)}function A(pe,ye){ye.length===0&&ye.needDrain&&(ye.needDrain=!1,pe.emit("drain"))}function M(pe,ye){ye.bufferProcessing=!0;var Fe=ye.bufferedRequest;if(pe._writev&&Fe&&Fe.next){var st=ye.bufferedRequestCount,Q=Array(st),T=ye.corkedRequestsFree;T.entry=Fe;for(var F=0,W=!0;Fe;)Q[F]=Fe,Fe.isBuf||(W=!1),Fe=Fe.next,F+=1;Q.allBuffers=W,y(pe,ye,!0,ye.length,Q,"",T.finish),ye.pendingcb++,ye.lastBufferedRequest=null,T.next?(ye.corkedRequestsFree=T.next,T.next=null):ye.corkedRequestsFree=new c(ye),ye.bufferedRequestCount=0}else{for(;Fe;){var ne=Fe.chunk,he=Fe.encoding,Ce=Fe.callback,Ze=ye.objectMode?1:ne.length;if(y(pe,ye,!1,Ze,ne,he,Ce),Fe=Fe.next,ye.bufferedRequestCount--,ye.writing)break}Fe===null&&(ye.lastBufferedRequest=null)}ye.bufferedRequest=Fe,ye.bufferProcessing=!1}function O(pe){return pe.ending&&pe.length===0&&pe.bufferedRequest===null&&!pe.finished&&!pe.writing}function V(pe,ye){pe._final(function(Fe){ye.pendingcb--,Fe&&on(pe,Fe),ye.prefinished=!0,pe.emit("prefinish"),U(pe,ye)})}function H(pe,ye){ye.prefinished||ye.finalCalled||(typeof pe._final!="function"||ye.destroyed?(ye.prefinished=!0,pe.emit("prefinish")):(ye.pendingcb++,ye.finalCalled=!0,a.nextTick(V,pe,ye)))}function U(pe,ye){var Fe=O(ye);if(Fe&&(H(pe,ye),ye.pendingcb===0&&(ye.finished=!0,pe.emit("finish"),ye.autoDestroy))){var st=pe._readableState;(!st||st.autoDestroy&&st.endEmitted)&&pe.destroy()}return Fe}function X(pe,ye,Fe){ye.ending=!0,U(pe,ye),Fe&&(ye.finished?a.nextTick(Fe):pe.once("finish",Fe)),ye.ended=!0,pe.writable=!1}function Y(pe,ye,Fe){var st=pe.entry;for(pe.entry=null;st;){var Q=st.callback;ye.pendingcb--,Q(Fe),st=st.next}ye.corkedRequestsFree.next=pe}o.exports=_;var q;_.WritableState=p;var ee={deprecate:r("util-deprecate")},ue=r("./internal/streams/stream"),oe=r("buffer").Buffer,Ee=l.Uint8Array||function(){},$=r("./internal/streams/destroy"),ce=r("./internal/streams/state"),de=ce.getHighWaterMark,xe=r("../errors").codes,Re=xe.ERR_INVALID_ARG_TYPE,Xe=xe.ERR_METHOD_NOT_IMPLEMENTED,ht=xe.ERR_MULTIPLE_CALLBACK,bi=xe.ERR_STREAM_CANNOT_PIPE,qt=xe.ERR_STREAM_DESTROYED,An=xe.ERR_STREAM_NULL_VALUES,vr=xe.ERR_STREAM_WRITE_AFTER_END,li=xe.ERR_UNKNOWN_ENCODING,on=$.errorOrDestroy;r("inherits")(_,ue),p.prototype.getBuffer=function(){for(var pe=this.bufferedRequest,ye=[];pe;)ye.push(pe),pe=pe.next;return ye},(function(){try{Object.defineProperty(p.prototype,"buffer",{get:ee.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var qi;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(qi=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function(pe){return!!qi.call(this,pe)||this===_&&pe&&pe._writableState instanceof p}})):qi=function(pe){return pe instanceof this},_.prototype.pipe=function(){on(this,new bi)},_.prototype.write=function(pe,ye,Fe){var st=this._writableState,Q=!1,T=!st.objectMode&&d(pe);return T&&!oe.isBuffer(pe)&&(pe=h(pe)),typeof ye=="function"&&(Fe=ye,ye=null),T?ye="buffer":!ye&&(ye=st.defaultEncoding),typeof Fe!="function"&&(Fe=g),st.ending?b(this,Fe):(T||C(this,st,pe,Fe))&&(st.pendingcb++,Q=S(this,st,T,pe,ye,Fe)),Q},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var pe=this._writableState;pe.corked&&(pe.corked--,!pe.writing&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&M(this,pe))},_.prototype.setDefaultEncoding=function(pe){if(typeof pe=="string"&&(pe=pe.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((pe+"").toLowerCase())))throw new li(pe);return this._writableState.defaultEncoding=pe,this},Object.defineProperty(_.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function(pe,ye,Fe){Fe(new Xe("_write()"))},_.prototype._writev=null,_.prototype.end=function(pe,ye,Fe){var st=this._writableState;return typeof pe=="function"?(Fe=pe,pe=null,ye=null):typeof ye=="function"&&(Fe=ye,ye=null),pe!=null&&this.write(pe,ye),st.corked&&(st.corked=1,this.uncork()),st.ending||X(this,st,Fe),this},Object.defineProperty(_.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(pe){this._writableState&&(this._writableState.destroyed=pe)}}),_.prototype.destroy=$.destroy,_.prototype._undestroy=$.undestroy,_.prototype._destroy=function(pe,ye){ye(pe)}}).call(this)}).call(this,r("_process"),typeof Nl>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nl)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(r,o){(function(a){(function(){function l(A,M,O){return M in A?Object.defineProperty(A,M,{value:O,enumerable:!0,configurable:!0,writable:!0}):A[M]=O,A}function c(A,M){return{value:A,done:M}}function h(A){var M=A[b];if(M!==null){var O=A[D].read();O!==null&&(A[y]=null,A[b]=null,A[C]=null,M(c(O,!1)))}}function d(A){a.nextTick(h,A)}function g(A,M){return function(O,V){A.then(function(){return M[S]?void O(c(void 0,!0)):void M[k](O,V)},V)}}var p,_=r("./end-of-stream"),b=Symbol("lastResolve"),C=Symbol("lastReject"),x=Symbol("error"),S=Symbol("ended"),y=Symbol("lastPromise"),k=Symbol("handlePromise"),D=Symbol("stream"),R=Object.getPrototypeOf(function(){}),N=Object.setPrototypeOf((p={get stream(){return this[D]},next:function(){var A=this,M=this[x];if(M!==null)return Promise.reject(M);if(this[S])return Promise.resolve(c(void 0,!0));if(this[D].destroyed)return new Promise(function(U,X){a.nextTick(function(){A[x]?X(A[x]):U(c(void 0,!0))})});var O,V=this[y];if(V)O=new Promise(g(V,this));else{var H=this[D].read();if(H!==null)return Promise.resolve(c(H,!1));O=new Promise(this[k])}return this[y]=O,O}},l(p,Symbol.asyncIterator,function(){return this}),l(p,"return",function(){var A=this;return new Promise(function(M,O){A[D].destroy(null,function(V){return V?void O(V):void M(c(void 0,!0))})})}),p),R);o.exports=function(A){var M,O=Object.create(N,(M={},l(M,D,{value:A,writable:!0}),l(M,b,{value:null,writable:!0}),l(M,C,{value:null,writable:!0}),l(M,x,{value:null,writable:!0}),l(M,S,{value:A._readableState.endEmitted,writable:!0}),l(M,k,{value:function(V,H){var U=O[D].read();U?(O[y]=null,O[b]=null,O[C]=null,V(c(U,!1))):(O[b]=V,O[C]=H)},writable:!0}),M));return O[y]=null,_(A,function(V){if(V&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"){var H=O[C];return H!==null&&(O[y]=null,O[b]=null,O[C]=null,H(V)),void(O[x]=V)}var U=O[b];U!==null&&(O[y]=null,O[b]=null,O[C]=null,U(c(void 0,!0))),O[S]=!0}),A.on("readable",d.bind(null,O)),O}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":24,_process:12}],22:[function(r,o){function a(y,k){var D=Object.keys(y);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(y);k&&(R=R.filter(function(N){return Object.getOwnPropertyDescriptor(y,N).enumerable})),D.push.apply(D,R)}return D}function l(y){for(var k,D=1;D<arguments.length;D++)k=arguments[D]==null?{}:arguments[D],D%2?a(Object(k),!0).forEach(function(R){c(y,R,k[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(k)):a(Object(k)).forEach(function(R){Object.defineProperty(y,R,Object.getOwnPropertyDescriptor(k,R))});return y}function c(y,k,D){return k in y?Object.defineProperty(y,k,{value:D,enumerable:!0,configurable:!0,writable:!0}):y[k]=D,y}function h(y,k){if(!(y instanceof k))throw new TypeError("Cannot call a class as a function")}function d(y,k){for(var D,R=0;R<k.length;R++)D=k[R],D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(y,D.key,D)}function g(y,k,D){return k&&d(y.prototype,k),y}function p(y,k,D){b.prototype.copy.call(y,k,D)}var _=r("buffer"),b=_.Buffer,C=r("util"),x=C.inspect,S=x&&x.custom||"inspect";o.exports=(function(){function y(){h(this,y),this.head=null,this.tail=null,this.length=0}return g(y,[{key:"push",value:function(k){var D={data:k,next:null};0<this.length?this.tail.next=D:this.head=D,this.tail=D,++this.length}},{key:"unshift",value:function(k){var D={data:k,next:this.head};this.length===0&&(this.tail=D),this.head=D,++this.length}},{key:"shift",value:function(){if(this.length!==0){var k=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,k}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(k){if(this.length===0)return"";for(var D=this.head,R=""+D.data;D=D.next;)R+=k+D.data;return R}},{key:"concat",value:function(k){if(this.length===0)return b.alloc(0);for(var D=b.allocUnsafe(k>>>0),R=this.head,N=0;R;)p(R.data,D,N),N+=R.data.length,R=R.next;return D}},{key:"consume",value:function(k,D){var R;return k<this.head.data.length?(R=this.head.data.slice(0,k),this.head.data=this.head.data.slice(k)):k===this.head.data.length?R=this.shift():R=D?this._getString(k):this._getBuffer(k),R}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(k){var D=this.head,R=1,N=D.data;for(k-=N.length;D=D.next;){var A=D.data,M=k>A.length?A.length:k;if(N+=M===A.length?A:A.slice(0,k),k-=M,k===0){M===A.length?(++R,this.head=D.next?D.next:this.tail=null):(this.head=D,D.data=A.slice(M));break}++R}return this.length-=R,N}},{key:"_getBuffer",value:function(k){var D=b.allocUnsafe(k),R=this.head,N=1;for(R.data.copy(D),k-=R.data.length;R=R.next;){var A=R.data,M=k>A.length?A.length:k;if(A.copy(D,D.length-k,0,M),k-=M,k===0){M===A.length?(++N,this.head=R.next?R.next:this.tail=null):(this.head=R,R.data=A.slice(M));break}++N}return this.length-=N,D}},{key:S,value:function(k,D){return x(this,l({},D,{depth:0,customInspect:!1}))}}]),y})()},{buffer:3,util:2}],23:[function(r,o){(function(a){(function(){function l(d,g){h(d,g),c(d)}function c(d){d._writableState&&!d._writableState.emitClose||d._readableState&&!d._readableState.emitClose||d.emit("close")}function h(d,g){d.emit("error",g)}o.exports={destroy:function(d,g){var p=this,_=this._readableState&&this._readableState.destroyed,b=this._writableState&&this._writableState.destroyed;return _||b?(g?g(d):d&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,a.nextTick(h,this,d)):a.nextTick(h,this,d)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(d||null,function(C){!g&&C?p._writableState?p._writableState.errorEmitted?a.nextTick(c,p):(p._writableState.errorEmitted=!0,a.nextTick(l,p,C)):a.nextTick(l,p,C):g?(a.nextTick(c,p),g(C)):a.nextTick(c,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(d,g){var p=d._readableState,_=d._writableState;p&&p.autoDestroy||_&&_.autoDestroy?d.destroy(g):d.emit("error",g)}}}).call(this)}).call(this,r("_process"))},{_process:12}],24:[function(r,o){function a(g){var p=!1;return function(){if(!p){p=!0;for(var _=arguments.length,b=Array(_),C=0;C<_;C++)b[C]=arguments[C];g.apply(this,b)}}}function l(){}function c(g){return g.setHeader&&typeof g.abort=="function"}function h(g,p,_){if(typeof p=="function")return h(g,null,p);p||(p={}),_=a(_||l);var b=p.readable||p.readable!==!1&&g.readable,C=p.writable||p.writable!==!1&&g.writable,x=function(){g.writable||y()},S=g._writableState&&g._writableState.finished,y=function(){C=!1,S=!0,b||_.call(g)},k=g._readableState&&g._readableState.endEmitted,D=function(){b=!1,k=!0,C||_.call(g)},R=function(M){_.call(g,M)},N=function(){var M;return b&&!k?(g._readableState&&g._readableState.ended||(M=new d),_.call(g,M)):C&&!S?(g._writableState&&g._writableState.ended||(M=new d),_.call(g,M)):void 0},A=function(){g.req.on("finish",y)};return c(g)?(g.on("complete",y),g.on("abort",N),g.req?A():g.on("request",A)):C&&!g._writableState&&(g.on("end",x),g.on("close",x)),g.on("end",D),g.on("finish",y),p.error!==!1&&g.on("error",R),g.on("close",N),function(){g.removeListener("complete",y),g.removeListener("abort",N),g.removeListener("request",A),g.req&&g.req.removeListener("finish",y),g.removeListener("end",x),g.removeListener("close",x),g.removeListener("finish",y),g.removeListener("end",D),g.removeListener("error",R),g.removeListener("close",N)}}var d=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;o.exports=h},{"../../../errors":15}],25:[function(r,o){o.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(r,o){function a(S){var y=!1;return function(){y||(y=!0,S.apply(void 0,arguments))}}function l(S){if(S)throw S}function c(S){return S.setHeader&&typeof S.abort=="function"}function h(S,y,k,D){D=a(D);var R=!1;S.on("close",function(){R=!0}),_===void 0&&(_=r("./end-of-stream")),_(S,{readable:y,writable:k},function(A){return A?D(A):(R=!0,void D())});var N=!1;return function(A){if(!R)return N?void 0:(N=!0,c(S)?S.abort():typeof S.destroy=="function"?S.destroy():void D(A||new x("pipe")))}}function d(S){S()}function g(S,y){return S.pipe(y)}function p(S){return S.length&&typeof S[S.length-1]=="function"?S.pop():l}var _,b=r("../../../errors").codes,C=b.ERR_MISSING_ARGS,x=b.ERR_STREAM_DESTROYED;o.exports=function(){for(var S=arguments.length,y=Array(S),k=0;k<S;k++)y[k]=arguments[k];var D=p(y);if(Array.isArray(y[0])&&(y=y[0]),2>y.length)throw new C("streams");var R,N=y.map(function(A,M){var O=M<y.length-1;return h(A,O,0<M,function(V){R||(R=V),V&&N.forEach(d),O||(N.forEach(d),D(R))})});return y.reduce(g)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(r,o){function a(c,h,d){return c.highWaterMark==null?h?c[d]:null:c.highWaterMark}var l=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;o.exports={getHighWaterMark:function(c,h,d,g){var p=a(h,g,d);if(p!=null){if(!(isFinite(p)&&t(p)===p)||0>p){var _=g?d:"highWaterMark";throw new l(_,p)}return t(p)}return c.objectMode?16:16384}}},{"../../../errors":15}],28:[function(r,o){o.exports=r("events").EventEmitter},{events:7}],29:[function(r,o,a){a=o.exports=r("./lib/_stream_readable.js"),a.Stream=a,a.Readable=a,a.Writable=r("./lib/_stream_writable.js"),a.Duplex=r("./lib/_stream_duplex.js"),a.Transform=r("./lib/_stream_transform.js"),a.PassThrough=r("./lib/_stream_passthrough.js"),a.finished=r("./lib/internal/streams/end-of-stream.js"),a.pipeline=r("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(r,o,a){function l(g,p){for(var _ in g)p[_]=g[_]}function c(g,p,_){return d(g,p,_)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var h=r("buffer"),d=h.Buffer;d.from&&d.alloc&&d.allocUnsafe&&d.allocUnsafeSlow?o.exports=h:(l(h,a),a.Buffer=c),c.prototype=Object.create(d.prototype),l(d,c),c.from=function(g,p,_){if(typeof g=="number")throw new TypeError("Argument must not be a number");return d(g,p,_)},c.alloc=function(g,p,_){if(typeof g!="number")throw new TypeError("Argument must be a number");var b=d(g);return p===void 0?b.fill(0):typeof _=="string"?b.fill(p,_):b.fill(p),b},c.allocUnsafe=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return d(g)},c.allocUnsafeSlow=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(g)}},{buffer:3}],31:[function(r,o,a){function l(N){if(!N)return"utf8";for(var A;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(A)return;N=(""+N).toLowerCase(),A=!0}}function c(N){var A=l(N);if(typeof A!="string"&&(D.isEncoding===R||!R(N)))throw new Error("Unknown encoding: "+N);return A||N}function h(N){this.encoding=c(N);var A;switch(this.encoding){case"utf16le":this.text=b,this.end=C,A=4;break;case"utf8":this.fillLast=_,A=4;break;case"base64":this.text=x,this.end=S,A=3;break;default:return this.write=y,void(this.end=k)}this.lastNeed=0,this.lastTotal=0,this.lastChar=D.allocUnsafe(A)}function d(N){return 127>=N?0:N>>5==6?2:N>>4==14?3:N>>3==30?4:N>>6==2?-1:-2}function g(N,A,M){var O=A.length-1;if(O<M)return 0;var V=d(A[O]);return 0<=V?(0<V&&(N.lastNeed=V-1),V):--O<M||V===-2?0:(V=d(A[O]),0<=V?(0<V&&(N.lastNeed=V-2),V):--O<M||V===-2?0:(V=d(A[O]),0<=V?(0<V&&(V===2?V=0:N.lastNeed=V-3),V):0))}function p(N,A){if((192&A[0])!=128)return N.lastNeed=0,"";if(1<N.lastNeed&&1<A.length){if((192&A[1])!=128)return N.lastNeed=1,"";if(2<N.lastNeed&&2<A.length&&(192&A[2])!=128)return N.lastNeed=2,""}}function _(N){var A=this.lastTotal-this.lastNeed,M=p(this,N);return M===void 0?this.lastNeed<=N.length?(N.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(N.copy(this.lastChar,A,0,N.length),void(this.lastNeed-=N.length)):M}function b(N,A){if((N.length-A)%2==0){var M=N.toString("utf16le",A);if(M){var O=M.charCodeAt(M.length-1);if(55296<=O&&56319>=O)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=N[N.length-2],this.lastChar[1]=N[N.length-1],M.slice(0,-1)}return M}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=N[N.length-1],N.toString("utf16le",A,N.length-1)}function C(N){var A=N&&N.length?this.write(N):"";if(this.lastNeed){var M=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,M)}return A}function x(N,A){var M=(N.length-A)%3;return M==0?N.toString("base64",A):(this.lastNeed=3-M,this.lastTotal=3,M==1?this.lastChar[0]=N[N.length-1]:(this.lastChar[0]=N[N.length-2],this.lastChar[1]=N[N.length-1]),N.toString("base64",A,N.length-M))}function S(N){var A=N&&N.length?this.write(N):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function y(N){return N.toString(this.encoding)}function k(N){return N&&N.length?this.write(N):""}var D=r("safe-buffer").Buffer,R=D.isEncoding||function(N){switch(N=""+N,N&&N.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};a.StringDecoder=h,h.prototype.write=function(N){if(N.length===0)return"";var A,M;if(this.lastNeed){if(A=this.fillLast(N),A===void 0)return"";M=this.lastNeed,this.lastNeed=0}else M=0;return M<N.length?A?A+this.text(N,M):this.text(N,M):A||""},h.prototype.end=function(N){var A=N&&N.length?this.write(N):"";return this.lastNeed?A+"":A},h.prototype.text=function(N,A){var M=g(this,N,A);if(!this.lastNeed)return N.toString("utf8",A);this.lastTotal=M;var O=N.length-(M-this.lastNeed);return N.copy(this.lastChar,0,O),N.toString("utf8",A,O)},h.prototype.fillLast=function(N){return this.lastNeed<=N.length?(N.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(N.copy(this.lastChar,this.lastTotal-this.lastNeed,0,N.length),void(this.lastNeed-=N.length))}},{"safe-buffer":30}],32:[function(r,o){(function(a){(function(){function l(c){try{if(!a.localStorage)return!1}catch{return!1}var h=a.localStorage[c];return h!=null&&(h+"").toLowerCase()==="true"}o.exports=function(c,h){function d(){if(!g){if(l("throwDeprecation"))throw new Error(h);l("traceDeprecation")?console.trace(h):console.warn(h),g=!0}return c.apply(this,arguments)}if(l("noDeprecation"))return c;var g=!1;return d}}).call(this)}).call(this,typeof Nl>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nl)},{}],"/":[function(r,o){function a(S){return S.replace(/a=ice-options:trickle\s\n/g,"")}function l(S){console.warn(S)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const c=r("debug")("simple-peer"),h=r("get-browser-rtc"),d=r("randombytes"),g=r("readable-stream"),p=r("queue-microtask"),_=r("err-code"),{Buffer:b}=r("buffer"),C=65536;class x extends g.Duplex{constructor(y){if(y=Object.assign({allowHalfOpen:!1},y),super(y),this._id=d(4).toString("hex").slice(0,7),this._debug("new peer %o",y),this.channelName=y.initiator?y.channelName||d(20).toString("hex"):null,this.initiator=y.initiator||!1,this.channelConfig=y.channelConfig||x.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},x.config,y.config),this.offerOptions=y.offerOptions||{},this.answerOptions=y.answerOptions||{},this.sdpTransform=y.sdpTransform||(k=>k),this.streams=y.streams||(y.stream?[y.stream]:[]),this.trickle=y.trickle===void 0||y.trickle,this.allowHalfTrickle=y.allowHalfTrickle!==void 0&&y.allowHalfTrickle,this.iceCompleteTimeout=y.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=y.wrtc&&typeof y.wrtc=="object"?y.wrtc:h(),!this._wrtc)throw _(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(k){return void this.destroy(_(k,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=k=>{this._onIceCandidate(k)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(k=>{this.destroy(_(k,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=k=>{this._setupData(k)},this.streams&&this.streams.forEach(k=>{this.addStream(k)}),this._pc.ontrack=k=>{this._onTrack(k)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(y){if(!this.destroying){if(this.destroyed)throw _(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof y=="string")try{y=JSON.parse(y)}catch{y={}}this._debug("signal()"),y.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),y.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(y.transceiverRequest.kind,y.transceiverRequest.init)),y.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(y.candidate):this._pendingCandidates.push(y.candidate)),y.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(y)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(k=>{this._addIceCandidate(k)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(k=>{this.destroy(_(k,"ERR_SET_REMOTE_DESCRIPTION"))}),y.sdp||y.candidate||y.renegotiate||y.transceiverRequest||this.destroy(_(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(y){const k=new this._wrtc.RTCIceCandidate(y);this._pc.addIceCandidate(k).catch(D=>{!k.address||k.address.endsWith(".local")?l("Ignoring unsupported ICE candidate."):this.destroy(_(D,"ERR_ADD_ICE_CANDIDATE"))})}send(y){if(!this.destroying){if(this.destroyed)throw _(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(y)}}addTransceiver(y,k){if(!this.destroying){if(this.destroyed)throw _(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(y,k),this._needsNegotiation()}catch(D){this.destroy(_(D,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:y,init:k}})}}addStream(y){if(!this.destroying){if(this.destroyed)throw _(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),y.getTracks().forEach(k=>{this.addTrack(k,y)})}}addTrack(y,k){if(this.destroying)return;if(this.destroyed)throw _(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const D=this._senderMap.get(y)||new Map;let R=D.get(k);if(!R)R=this._pc.addTrack(y,k),D.set(k,R),this._senderMap.set(y,D),this._needsNegotiation();else throw R.removed?_(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):_(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(y,k,D){if(this.destroying)return;if(this.destroyed)throw _(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const R=this._senderMap.get(y),N=R?R.get(D):null;if(!N)throw _(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");k&&this._senderMap.set(k,R),N.replaceTrack==null?this.destroy(_(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):N.replaceTrack(k)}removeTrack(y,k){if(this.destroying)return;if(this.destroyed)throw _(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const D=this._senderMap.get(y),R=D?D.get(k):null;if(!R)throw _(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{R.removed=!0,this._pc.removeTrack(R)}catch(N){N.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(R):this.destroy(_(N,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(y){if(!this.destroying){if(this.destroyed)throw _(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),y.getTracks().forEach(k=>{this.removeTrack(k,y)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,p(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw _(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(y){this._destroy(y,()=>{})}_destroy(y,k){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",y&&(y.message||y)),p(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",y&&(y.message||y)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,y&&this.emit("error",y),this.emit("close"),k()}))}_setupData(y){if(!y.channel)return this.destroy(_(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=y.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=C),this.channelName=this._channel.label,this._channel.onmessage=D=>{this._onChannelMessage(D)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=D=>{const R=D.error instanceof Error?D.error:new Error(`Datachannel error: ${D.message} ${D.filename}:${D.lineno}:${D.colno}`);this.destroy(_(R,"ERR_DATA_CHANNEL"))};let k=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(k&&this._onChannelClose(),k=!0):k=!1},5e3)}_read(){}_write(y,k,D){if(this.destroyed)return D(_(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(y)}catch(R){return this.destroy(_(R,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>C?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=D):D(null)}else this._debug("write before connect"),this._chunk=y,this._cb=D}_onFinish(){if(!this.destroyed){const y=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?y():this.once("connect",y)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=a(y.sdp)),y.sdp=this.sdpTransform(y.sdp);const k=()=>{if(!this.destroyed){const D=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:D.type,sdp:D.sdp})}};this._pc.setLocalDescription(y).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?k():this.once("_iceComplete",k))}).catch(D=>{this.destroy(_(D,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(_(y,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(y=>{y.mid||!y.sender.track||y.requested||(y.requested=!0,this.addTransceiver(y.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=a(y.sdp)),y.sdp=this.sdpTransform(y.sdp);const k=()=>{if(!this.destroyed){const D=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:D.type,sdp:D.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(y).then(()=>{this.destroyed||(this.trickle||this._iceComplete?k():this.once("_iceComplete",k))}).catch(D=>{this.destroy(_(D,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(_(y,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(_(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const y=this._pc.iceConnectionState,k=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",y,k),this.emit("iceStateChange",y,k),(y==="connected"||y==="completed")&&(this._pcReady=!0,this._maybeReady()),y==="failed"&&this.destroy(_(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),y==="closed"&&this.destroy(_(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(y){const k=D=>(Object.prototype.toString.call(D.values)==="[object Array]"&&D.values.forEach(R=>{Object.assign(D,R)}),D);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(D=>{const R=[];D.forEach(N=>{R.push(k(N))}),y(null,R)},D=>y(D)):0<this._pc.getStats.length?this._pc.getStats(D=>{if(this.destroyed)return;const R=[];D.result().forEach(N=>{const A={};N.names().forEach(M=>{A[M]=N.stat(M)}),A.id=N.id,A.type=N.type,A.timestamp=N.timestamp,R.push(k(A))}),y(null,R)},D=>y(D)):y(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const y=()=>{this.destroyed||this.getStats((k,D)=>{if(this.destroyed)return;k&&(D=[]);const R={},N={},A={};let M=!1;D.forEach(V=>{(V.type==="remotecandidate"||V.type==="remote-candidate")&&(R[V.id]=V),(V.type==="localcandidate"||V.type==="local-candidate")&&(N[V.id]=V),(V.type==="candidatepair"||V.type==="candidate-pair")&&(A[V.id]=V)});const O=V=>{M=!0;let H=N[V.localCandidateId];H&&(H.ip||H.address)?(this.localAddress=H.ip||H.address,this.localPort=+H.port):H&&H.ipAddress?(this.localAddress=H.ipAddress,this.localPort=+H.portNumber):typeof V.googLocalAddress=="string"&&(H=V.googLocalAddress.split(":"),this.localAddress=H[0],this.localPort=+H[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let U=R[V.remoteCandidateId];U&&(U.ip||U.address)?(this.remoteAddress=U.ip||U.address,this.remotePort=+U.port):U&&U.ipAddress?(this.remoteAddress=U.ipAddress,this.remotePort=+U.portNumber):typeof V.googRemoteAddress=="string"&&(U=V.googRemoteAddress.split(":"),this.remoteAddress=U[0],this.remotePort=+U[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(D.forEach(V=>{V.type==="transport"&&V.selectedCandidatePairId&&O(A[V.selectedCandidatePairId]),(V.type==="googCandidatePair"&&V.googActiveConnection==="true"||(V.type==="candidatepair"||V.type==="candidate-pair")&&V.selected)&&O(V)}),!M&&(!Object.keys(A).length||Object.keys(N).length))return void setTimeout(y,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(H){return this.destroy(_(H,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const V=this._cb;this._cb=null,V(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};y()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>C)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(y=>{this._pc.removeTrack(y),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(y){this.destroyed||(y.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:y.candidate.candidate,sdpMLineIndex:y.candidate.sdpMLineIndex,sdpMid:y.candidate.sdpMid}}):!y.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),y.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(y){if(this.destroyed)return;let k=y.data;k instanceof ArrayBuffer&&(k=b.from(k)),this.push(k)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const y=this._cb;this._cb=null,y(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(y){this.destroyed||y.streams.forEach(k=>{this._debug("on track"),this.emit("track",y.track,k),this._remoteTracks.push({track:y.track,stream:k}),this._remoteStreams.some(D=>D.id===k.id)||(this._remoteStreams.push(k),p(()=>{this._debug("on stream"),this.emit("stream",k)}))})}_debug(){const y=[].slice.call(arguments);y[0]="["+this._id+"] "+y[0],c.apply(null,y)}}x.WEBRTC_SUPPORT=!!h(),x.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},x.channelConfig={},o.exports=x},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(qI)),qI.exports}var Tge=Dge();const Nge=gP(Tge),w6=0,v6=1,$Q=2,qQ=(s,e)=>{ft(s,w6);const t=mfe(e);Un(s,t)},GQ=(s,e,t)=>{ft(s,v6),Un(s,hfe(e,t))},Ige=(s,e,t)=>GQ(e,t,Hs(s)),KQ=(s,e,t)=>{try{lfe(e,Hs(s),t)}catch(i){console.error("Caught error while handling a Yjs update",i)}},Rge=(s,e)=>{ft(s,$Q),Un(s,e)},Age=KQ,Mge=(s,e,t,i)=>{const n=Pt(s);switch(n){case w6:Ige(s,e,t);break;case v6:KQ(s,t,i);break;case $Q:Age(s,t,i);break;default:throw new Error("Unknown message type")}return n},GI=3e4;class Oge extends OY{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const t=Ju();this.getLocalState()!==null&&GI/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const i=[];this.meta.forEach((n,r)=>{r!==this.clientID&&GI<=t-n.lastUpdated&&this.states.has(r)&&i.push(r)}),i.length>0&&iM(this,i,"timeout")},uc(GI/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,i=this.meta.get(t),n=i===void 0?0:i.clock+1,r=this.states.get(t);e===null?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:n,lastUpdated:Ju()});const o=[],a=[],l=[],c=[];e===null?c.push(t):r==null?e!=null&&o.push(t):(a.push(t),G0(r,e)||l.push(t)),(o.length>0||l.length>0||c.length>0)&&this.emit("change",[{added:o,updated:l,removed:c},"local"]),this.emit("update",[{added:o,updated:a,removed:c},"local"])}setLocalStateField(e,t){const i=this.getLocalState();i!==null&&this.setLocalState({...i,[e]:t})}getStates(){return this.states}}const iM=(s,e,t)=>{const i=[];for(let n=0;n<e.length;n++){const r=e[n];if(s.states.has(r)){if(s.states.delete(r),r===s.clientID){const o=s.meta.get(r);s.meta.set(r,{clock:o.clock+1,lastUpdated:Ju()})}i.push(r)}}i.length>0&&(s.emit("change",[{added:[],updated:[],removed:i},t]),s.emit("update",[{added:[],updated:[],removed:i},t]))},$L=(s,e,t=s.states)=>{const i=e.length,n=js();ft(n,i);for(let r=0;r<i;r++){const o=e[r],a=t.get(o)||null,l=s.meta.get(o).clock;ft(n,o),ft(n,l),tc(n,JSON.stringify(a))}return kn(n)},Pge=(s,e,t)=>{const i=xc(e),n=Ju(),r=[],o=[],a=[],l=[],c=Pt(i);for(let h=0;h<c;h++){const d=Pt(i);let g=Pt(i);const p=JSON.parse(zu(i)),_=s.meta.get(d),b=s.states.get(d),C=_===void 0?0:_.clock;(C<g||C===g&&p===null&&s.states.has(d))&&(p===null?d===s.clientID&&s.getLocalState()!=null?g++:s.states.delete(d):s.states.set(d,p),s.meta.set(d,{clock:g,lastUpdated:n}),_===void 0&&p!==null?r.push(d):_!==void 0&&p===null?l.push(d):p!==null&&(G0(p,b)||a.push(d),o.push(d)))}(r.length>0||a.length>0||l.length>0)&&s.emit("change",[{added:r,updated:a,removed:l},t]),(r.length>0||o.length>0||l.length>0)&&s.emit("update",[{added:r,updated:o,removed:l},t])},Fge=(s,e)=>{const t=YA(s).buffer,i=YA(e).buffer;return crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]).then(n=>crypto.subtle.deriveKey({name:"PBKDF2",salt:i,iterations:1e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},YQ=(s,e)=>{if(!e)return n6(s);const t=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,s).then(i=>{const n=js();return tc(n,"AES-GCM"),Un(n,t),Un(n,new Uint8Array(i)),kn(n)})},Bge=(s,e)=>{const t=js();return c1(t,s),YQ(kn(t),e)},QQ=(s,e)=>{if(!e)return n6(s);const t=xc(s);zu(t)!=="AES-GCM"&&wde(hc("Unknown encryption algorithm"));const n=Hs(t),r=Hs(t);return crypto.subtle.decrypt({name:"AES-GCM",iv:n},e,r).then(o=>new Uint8Array(o))},Vge=(s,e)=>QQ(s,e).then(t=>u1(xc(new Uint8Array(t)))),ea=Qde("y-webrtc"),R_=0,XQ=3,gv=1,C6=4,qL=new Map,vg=new Map,ZQ=s=>{let e=!0;s.webrtcConns.forEach(t=>{t.synced||(e=!1)}),(!e&&s.synced||e&&!s.synced)&&(s.synced=e,s.provider.emit("synced",[{synced:e}]),ea("synced ",Ta,s.name,Yg," with all peers"))},JQ=(s,e,t)=>{const i=xc(e),n=js(),r=Pt(i);if(s===void 0)return null;const o=s.awareness,a=s.doc;let l=!1;switch(r){case R_:{ft(n,R_);const c=Mge(i,n,a,s);c===v6&&!s.synced&&t(),c===w6&&(l=!0);break}case XQ:ft(n,gv),Un(n,$L(o,Array.from(o.getStates().keys()))),l=!0;break;case gv:Pge(o,Hs(i),s);break;case C6:{const c=Kg(i)===1,h=zu(i);if(h!==s.peerId&&(s.bcConns.has(h)&&!c||!s.bcConns.has(h)&&c)){const d=[],g=[];c?(s.bcConns.add(h),g.push(h)):(s.bcConns.delete(h),d.push(h)),s.provider.emit("peers",[{added:g,removed:d,webrtcPeers:Array.from(s.webrtcConns.keys()),bcPeers:Array.from(s.bcConns)}]),eX(s)}break}default:return console.error("Unable to compute message"),n}return l?n:null},Hge=(s,e)=>{const t=s.room;return ea("received message from ",Ta,s.remotePeerId,o6," (",t.name,")",Yg,XE),JQ(t,e,()=>{s.synced=!0,ea("synced ",Ta,t.name,Yg," with ",Ta,s.remotePeerId),ZQ(t)})},KI=(s,e)=>{ea("send message to ",Ta,s.remotePeerId,Yg,o6," (",s.room.name,")",XE);try{s.peer.send(kn(e))}catch{}},Wge=(s,e)=>{ea("broadcast message in ",Ta,s.name,Yg),s.webrtcConns.forEach(t=>{try{t.peer.send(e)}catch{}})};class BW{constructor(e,t,i,n){ea("establishing connection to ",Ta,i),this.room=n,this.remotePeerId=i,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Nge({initiator:t,...n.provider.peerOpts}),this.peer.on("signal",r=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),y6(e,n,{to:i,from:n.peerId,type:"signal",token:this.glareToken,signal:r})}),this.peer.on("connect",()=>{ea("connected to ",Ta,i),this.connected=!0;const o=n.provider.doc,a=n.awareness,l=js();ft(l,R_),qQ(l,o),KI(this,l);const c=a.getStates();if(c.size>0){const h=js();ft(h,gv),Un(h,$L(a,Array.from(c.keys()))),KI(this,h)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,n.webrtcConns.has(this.remotePeerId)&&(n.webrtcConns.delete(this.remotePeerId),n.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}])),ZQ(n),this.peer.destroy(),ea("closed connection to ",Ta,i),nM(n)}),this.peer.on("error",r=>{ea("Error in connection to ",Ta,i,": ",r),nM(n)}),this.peer.on("data",r=>{const o=Hge(this,r);o!==null&&KI(this,o)})}destroy(){this.peer.destroy()}}const Uh=(s,e)=>YQ(e,s.key).then(t=>s.mux(()=>Ege(s.name,t))),VW=(s,e)=>{s.bcconnected&&Uh(s,e),Wge(s,e)},nM=s=>{qL.forEach(e=>{e.connected&&(e.send({type:"subscribe",topics:[s.name]}),s.webrtcConns.size<s.provider.maxConns&&y6(e,s,{type:"announce",from:s.peerId}))})},eX=s=>{if(s.provider.filterBcConns){const e=js();ft(e,C6),cv(e,1),tc(e,s.peerId),Uh(s,kn(e))}};class zge{constructor(e,t,i,n){this.peerId=WY(),this.doc=e,this.awareness=t.awareness,this.provider=t,this.synced=!1,this.name=i,this.key=n,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=jQ(),this.bcconnected=!1,this._bcSubscriber=r=>QQ(new Uint8Array(r),n).then(o=>this.mux(()=>{const a=JQ(this,o,()=>{});a&&Uh(this,kn(a))})),this._docUpdateHandler=(r,o)=>{const a=js();ft(a,R_),Rge(a,r),VW(this,kn(a))},this._awarenessUpdateHandler=({added:r,updated:o,removed:a},l)=>{const c=r.concat(o).concat(a),h=js();ft(h,gv),Un(h,$L(this.awareness,c)),VW(this,kn(h))},this._beforeUnloadHandler=()=>{iM(this.awareness,[e.clientID],"window unload"),vg.forEach(r=>{r.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),nM(this);const e=this.name;Lge(e,this._bcSubscriber),this.bcconnected=!0,eX(this);const t=js();ft(t,R_),qQ(t,this.doc),Uh(this,kn(t));const i=js();ft(i,R_),GQ(i,this.doc),Uh(this,kn(i));const n=js();ft(n,XQ),Uh(this,kn(n));const r=js();ft(r,gv),Un(r,$L(this.awareness,[this.doc.clientID])),Uh(this,kn(r))}disconnect(){qL.forEach(t=>{t.connected&&t.send({type:"unsubscribe",topics:[this.name]})}),iM(this.awareness,[this.doc.clientID],"disconnect");const e=js();ft(e,C6),cv(e,0),tc(e,this.peerId),Uh(this,kn(e)),kge(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(t=>t.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const Uge=(s,e,t,i)=>{if(vg.has(t))throw hc(`A Yjs Doc connected to room "${t}" already exists!`);const n=new zge(s,e,t,i);return vg.set(t,n),n},y6=(s,e,t)=>{e.key?Bge(t,e.key).then(i=>{s.send({type:"publish",topic:e.name,data:XY(i)})}):s.send({type:"publish",topic:e.name,data:t})};class jge extends yge{constructor(e){super(e),this.providers=new Set,this.on("connect",()=>{ea(`connected (${e})`);const t=Array.from(vg.keys());this.send({type:"subscribe",topics:t}),vg.forEach(i=>y6(this,i,{type:"announce",from:i.peerId}))}),this.on("message",t=>{switch(t.type){case"publish":{const i=t.topic,n=vg.get(i);if(n==null||typeof i!="string")return;const r=o=>{const a=n.webrtcConns,l=n.peerId;if(o==null||o.from===l||o.to!==void 0&&o.to!==l||n.bcConns.has(o.from))return;const c=a.has(o.from)?()=>{}:()=>n.provider.emit("peers",[{removed:[],added:[o.from],webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}]);switch(o.type){case"announce":a.size<n.provider.maxConns&&(la(a,o.from,()=>new BW(this,!0,o.from,n)),c());break;case"signal":if(o.signal.type==="offer"){const h=a.get(o.from);if(h){const d=o.token,g=h.glareToken;if(g&&g>d){ea("offer rejected: ",o.from);return}h.glareToken=void 0}}if(o.signal.type==="answer"){ea("offer answered by: ",o.from);const h=a.get(o.from);h.glareToken=void 0}o.to===l&&(la(a,o.from,()=>new BW(this,!1,o.from,n)).peer.signal(o.signal),c());break}};n.key?typeof t.data=="string"&&Vge(ZY(t.data),n.key).then(r):r(t.data)}}}),this.on("disconnect",()=>ea(`disconnect (${e})`))}}const YI=s=>{s.emit("status",[{connected:s.connected}])};class $ge extends MY{constructor(e,t,{signaling:i=["wss://y-webrtc-eu.fly.dev"],password:n=null,awareness:r=new Oge(t),maxConns:o=20+uc(_de()*15),filterBcConns:a=!0,peerOpts:l={}}={}){super(),this.roomName=e,this.doc=t,this.filterBcConns=a,this.awareness=r,this.shouldConnect=!1,this.signalingUrls=i,this.signalingConns=[],this.maxConns=o,this.peerOpts=l,this.key=n?Fge(n,e):n6(null),this.room=null,this.key.then(c=>{this.room=Uge(t,this,e,c),this.shouldConnect?this.room.connect():this.room.disconnect(),YI(this)}),this.connect(),this.destroy=this.destroy.bind(this),t.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(e=>{const t=la(qL,e,()=>new jge(e));this.signalingConns.push(t),t.providers.add(this)}),this.room&&(this.room.connect(),YI(this))}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(e=>{e.providers.delete(this),e.providers.size===0&&(e.destroy(),qL.delete(e.url))}),this.room&&(this.room.disconnect(),YI(this))}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),vg.delete(this.roomName)}),super.destroy()}}function qge(s){if(s.length===0)throw new Error("Invalid tail call");return[s.slice(0,s.length-1),s[s.length-1]]}function Sn(s,e,t=(i,n)=>i===n){if(s===e)return!0;if(!s||!e||s.length!==e.length)return!1;for(let i=0,n=s.length;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function Gge(s,e){const t=s.length-1;e<t&&(s[e]=s[t]),s.pop()}function Kge(s,e,t){return tX(s.length,i=>t(s[i],e))}function tX(s,e){let t=0,i=s-1;for(;t<=i;){const n=(t+i)/2|0,r=e(n);if(r<0)t=n+1;else if(r>0)i=n-1;else return n}return-(t+1)}function*S6(s,e){let t,i;for(const n of s)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function iX(s,e){for(let t=0;t<=s.length;t++)e(t===0?void 0:s[t-1],t===s.length?void 0:s[t])}function Yge(s,e){for(let t=0;t<s.length;t++)e(t===0?void 0:s[t-1],s[t],t+1===s.length?void 0:s[t+1])}function x6(s){return s.filter(e=>!!e)}function HW(s){let e=0;for(let t=0;t<s.length;t++)s[t]&&(s[e]=s[t],e+=1);s.length=e}function Qge(s){return!Array.isArray(s)||s.length===0}function iD(s){return Array.isArray(s)&&s.length>0}function Jg(s,e=t=>t){const t=new Set;return s.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function nr(s,e){let t=typeof e=="number"?s:0;typeof e=="number"?t=s:(t=0,e=s);const i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function nD(s,e,t){const i=s.slice(0,e),n=s.slice(e);return i.concat(t,n)}function QI(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.unshift(e))}function VS(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.push(e))}function sM(s,e){for(const t of e)s.push(t)}function Xge(s,e,t){const i=nX(s,e),n=s.length,r=t.length;s.length=n+r;for(let o=n-1;o>=i;o--)s[o+r]=s[o];for(let o=0;o<r;o++)s[o+i]=t[o]}function GL(s,e,t,i){const n=nX(s,e);let r=s.splice(n,t);return r===void 0&&(r=[]),Xge(s,n,i),r}function nX(s,e){return e<0?Math.max(e+s.length,0):Math.min(e,s.length)}var mv;(function(s){function e(r){return r<0}s.isLessThan=e;function t(r){return r<=0}s.isLessThanOrEqual=t;function i(r){return r>0}s.isGreaterThan=i;function n(r){return r===0}s.isNeitherLessOrGreaterThan=n,s.greaterThan=1,s.lessThan=-1,s.neitherLessOrGreaterThan=0})(mv||(mv={}));function Do(s,e){return(t,i)=>e(s(t),s(i))}function Zge(...s){return(e,t)=>{for(const i of s){const n=i(e,t);if(!mv.isNeitherLessOrGreaterThan(n))return n}return mv.neitherLessOrGreaterThan}}const Uu=(s,e)=>s-e,Jge=(s,e)=>Uu(s?1:0,e?1:0);function eme(s){return(e,t)=>-s(e,t)}class eh{constructor(e){this.firstIdx=0,this.items=e,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}const f_=class f_{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new f_(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new f_(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||mv.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};f_.empty=new f_(e=>{});let Cg=f_;class tme{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?p1.isErrorNoTelemetry(e)?new p1(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const L6=new tme;function KL(s){L6.onUnexpectedError(s)}function $t(s){OC(s)||L6.onUnexpectedError(s)}function k6(s){OC(s)||L6.onUnexpectedExternalError(s)}function rM(s){if(s instanceof Error){const{name:e,message:t,cause:i}=s,n=s.stacktrace||s.stack;return{$isError:!0,name:e,message:t,stack:n,noTelemetry:p1.isErrorNoTelemetry(s),cause:i?rM(i):void 0,code:s.code}}return s}const YL="Canceled";function OC(s){return s instanceof q1?!0:s instanceof Error&&s.name===YL&&s.message===YL}class q1 extends Error{constructor(){super(YL),this.name=this.message}}function ime(){const s=new Error(YL);return s.name=s.message,s}function sD(s){return s?new Error(`Illegal argument: ${s}`):new Error("Illegal argument")}function QL(s){return s?new Error(`Illegal state: ${s}`):new Error("Illegal state")}class nme extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class p1 extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof p1)return e;const t=new p1;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class $e extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,$e.prototype)}}function XI(s,e){if(!s)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function E6(s,e="Unreachable"){throw new Error(e)}function XL(s,e="unexpected state"){if(!s)throw typeof e=="string"?new $e(`Assertion Failed: ${e}`):e}function WW(s,e="Soft Assertion Failed"){s||$t(new $e(e))}function em(s){if(!s()){debugger;s(),$t(new $e("Assertion Failed"))}}function D6(s,e){let t=0;for(;t<s.length-1;){const i=s[t],n=s[t+1];if(!e(i,n))return!1;t++}return!0}function ns(s){return typeof s=="string"}function ar(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&!(s instanceof RegExp)&&!(s instanceof Date)}function sme(s){const e=Object.getPrototypeOf(Uint8Array);return typeof s=="object"&&s instanceof e}function Cm(s){return typeof s=="number"&&!isNaN(s)}function oM(s){return!!s&&typeof s[Symbol.iterator]=="function"}function aM(s){return s===!0||s===!1}function yo(s){return typeof s>"u"}function Xo(s){return!Zo(s)}function Zo(s){return yo(s)||s===null}function _d(s,e){if(!s)throw new Error("Unexpected type")}function sX(s){return XL(s!=null,"Argument is `undefined` or `null`."),s}function _1(s){return typeof s=="function"}function rme(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++)ome(s[i],e[i])}function ome(s,e){if(ns(e)){if(typeof s!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(_1(e)){try{if(s instanceof e)return}catch{}if(!Zo(s)&&s.constructor===e||e.length===1&&e.call(void 0,s)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function vu(s){if(!s||typeof s!="object"||s instanceof RegExp)return s;const e=Array.isArray(s)?[]:{};return Object.entries(s).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?vu(i):i}),e}function ame(s){if(!s||typeof s!="object")return s;const e=[s];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(rX.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!sme(n)&&e.push(n)}}return s}const rX=Object.prototype.hasOwnProperty;function oX(s,e){return lM(s,e,new Set)}function lM(s,e,t){if(Zo(s))return s;const i=e(s);if(typeof i<"u")return i;if(Array.isArray(s)){const n=[];for(const r of s)n.push(lM(r,e,t));return n}if(ar(s)){if(t.has(s))throw new Error("Cannot clone recursive data-structure");t.add(s);const n={};for(const r in s)rX.call(s,r)&&(n[r]=lM(s[r],e,t));return t.delete(s),n}return s}function $r(s,e){if(s===e)return!0;if(s==null||e===null||e===void 0||typeof s!=typeof e||typeof s!="object"||Array.isArray(s)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(s)){if(s.length!==e.length)return!1;for(t=0;t<s.length;t++)if(!$r(s[t],e[t]))return!1}else{const n=[];for(i in s)n.push(i);n.sort();const r=[];for(i in e)r.push(i);if(r.sort(),!$r(n,r))return!1;for(t=0;t<n.length;t++)if(!$r(s[n[t]],e[n[t]]))return!1}return!0}function aX(){return globalThis._VSCODE_NLS_MESSAGES}function T6(){return globalThis._VSCODE_NLS_LANGUAGE}const lme=T6()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function zW(s,e){let t;return e.length===0?t=s:t=s.replace(/\{(\d+)\}/g,(i,n)=>{const r=n[0],o=e[r];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),lme&&(t=""+t.replace(/[aouei]/g,"$&$&")+""),t}function v(s,e,...t){return zW(typeof s=="number"?cme(s,e):e,t)}function cme(s,e){var i;const t=(i=aX())==null?void 0:i[s];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${s} !!!`)}return t}const rg="en";let pv=!1,_v=!1,K0=!1,lX=!1,N6=!1,I6=!1,cX=!1,HS,ZI=rg,UW=rg,ume,Ya;const ju=globalThis;let Ws;var BG;typeof ju.vscode<"u"&&typeof ju.vscode.process<"u"?Ws=ju.vscode.process:typeof process<"u"&&typeof((BG=process==null?void 0:process.versions)==null?void 0:BG.node)=="string"&&(Ws=process);var VG;const hme=typeof((VG=Ws==null?void 0:Ws.versions)==null?void 0:VG.electron)=="string",dme=hme&&(Ws==null?void 0:Ws.type)==="renderer";var HG;if(typeof Ws=="object"){pv=Ws.platform==="win32",_v=Ws.platform==="darwin",K0=Ws.platform==="linux",K0&&Ws.env.SNAP&&Ws.env.SNAP_REVISION,Ws.env.CI||Ws.env.BUILD_ARTIFACTSTAGINGDIRECTORY||Ws.env.GITHUB_WORKSPACE,HS=rg,ZI=rg;const s=Ws.env.VSCODE_NLS_CONFIG;if(s)try{const e=JSON.parse(s);HS=e.userLocale,UW=e.osLocale,ZI=e.resolvedLanguage||rg,ume=(HG=e.languagePack)==null?void 0:HG.translationsConfigFile}catch{}lX=!0}else typeof navigator=="object"&&!dme?(Ya=navigator.userAgent,pv=Ya.indexOf("Windows")>=0,_v=Ya.indexOf("Macintosh")>=0,I6=(Ya.indexOf("Macintosh")>=0||Ya.indexOf("iPad")>=0||Ya.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,K0=Ya.indexOf("Linux")>=0,cX=(Ya==null?void 0:Ya.indexOf("Mobi"))>=0,N6=!0,ZI=T6()||rg,HS=navigator.language.toLowerCase(),UW=HS):console.error("Unable to resolve platform.");let Wx=0;_v?Wx=1:pv?Wx=3:K0&&(Wx=2);const Rr=pv,_t=_v,Gr=K0,bv=lX,oh=N6,fme=N6&&typeof ju.importScripts=="function",gme=fme?ju.origin:void 0,gc=I6,uX=cX,JI=Wx,mc=Ya,mme=typeof ju.postMessage=="function"&&!ju.importScripts,PC=(()=>{if(mme){const s=[];ju.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=s.length;i<n;i++){const r=s[i];if(r.id===t.data.vscodeScheduleAsyncWork){s.splice(i,1),r.callback();return}}});let e=0;return t=>{const i=++e;s.push({id:i,callback:t}),ju.postMessage({vscodeScheduleAsyncWork:i},"*")}}return s=>setTimeout(s)})(),Na=_v||I6?2:pv?1:3;let jW=!0,$W=!1;function pme(){if(!$W){$W=!0;const s=new Uint8Array(2);s[0]=1,s[1]=2,jW=new Uint16Array(s.buffer)[0]===513}return jW}const R6=!!(mc&&mc.indexOf("Chrome")>=0),_me=!!(mc&&mc.indexOf("Firefox")>=0),bme=!!(!R6&&mc&&mc.indexOf("Safari")>=0),hX=!!(mc&&mc.indexOf("Edg/")>=0),wme=!!(mc&&mc.indexOf("Android")>=0);function wv(s,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=s.apply(t,arguments)),n}}var Dt;(function(s){function e(N){return!!N&&typeof N=="object"&&typeof N[Symbol.iterator]=="function"}s.is=e;const t=Object.freeze([]);function i(){return t}s.empty=i;function*n(N){yield N}s.single=n;function r(N){return e(N)?N:n(N)}s.wrap=r;function o(N){return N||t}s.from=o;function*a(N){for(let A=N.length-1;A>=0;A--)yield N[A]}s.reverse=a;function l(N){return!N||N[Symbol.iterator]().next().done===!0}s.isEmpty=l;function c(N){return N[Symbol.iterator]().next().value}s.first=c;function h(N,A){let M=0;for(const O of N)if(A(O,M++))return!0;return!1}s.some=h;function d(N,A){let M=0;for(const O of N)if(!A(O,M++))return!1;return!0}s.every=d;function g(N,A){for(const M of N)if(A(M))return M}s.find=g;function*p(N,A){for(const M of N)A(M)&&(yield M)}s.filter=p;function*_(N,A){let M=0;for(const O of N)yield A(O,M++)}s.map=_;function*b(N,A){let M=0;for(const O of N)yield*A(O,M++)}s.flatMap=b;function*C(...N){for(const A of N)oM(A)?yield*A:yield A}s.concat=C;function x(N,A,M){let O=M;for(const V of N)O=A(O,V);return O}s.reduce=x;function S(N){let A=0;for(const M of N)A++;return A}s.length=S;function*y(N,A,M=N.length){for(A<-N.length&&(A=0),A<0&&(A+=N.length),M<0?M+=N.length:M>N.length&&(M=N.length);A<M;A++)yield N[A]}s.slice=y;function k(N,A=Number.POSITIVE_INFINITY){const M=[];if(A===0)return[M,N];const O=N[Symbol.iterator]();for(let V=0;V<A;V++){const H=O.next();if(H.done)return[M,s.empty()];M.push(H.value)}return[M,{[Symbol.iterator](){return O}}]}s.consume=k;async function D(N){const A=[];for await(const M of N)A.push(M);return A}s.asyncToArray=D;async function R(N){let A=[];for await(const M of N)A=A.concat(M);return A}s.asyncToArrayFlat=R})(Dt||(Dt={}));function rD(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&s.dispose.length===0}function _n(s){if(Dt.is(s)){const e=[];for(const t of s)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(s)?[]:s}else if(s)return s.dispose(),s}function nc(...s){return qe(()=>_n(s))}class vme{constructor(e){this._isDisposed=!1,this._fn=e}dispose(){if(!this._isDisposed){if(!this._fn)throw new Error("Unbound disposable context: Need to use an arrow function to preserve the value of this");this._isDisposed=!0,this._fn()}}}function qe(s){return new vme(s)}const z2=class z2{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{_n(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e||e===le.None)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?z2.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}};z2.DISABLE_DISPOSED_WARNING=!1;let Pe=z2;const l9=class l9{constructor(){this._store=new Pe,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};l9.None=Object.freeze({dispose(){}});let le=l9;class Yn{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}}class Cme{constructor(e){this.object=e}dispose(){}}class A6{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{_n(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){var n;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(n=this._store.get(e))==null||n.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}var Fu;let Ln=(Fu=class{constructor(e){this.element=e,this.next=Fu.Undefined,this.prev=Fu.Undefined}},Fu.Undefined=new Fu(void 0),Fu);class Dr{constructor(){this._first=Ln.Undefined,this._last=Ln.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Ln.Undefined}clear(){let e=this._first;for(;e!==Ln.Undefined;){const t=e.next;e.prev=Ln.Undefined,e.next=Ln.Undefined,e=t}this._first=Ln.Undefined,this._last=Ln.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new Ln(e);if(this._first===Ln.Undefined)this._first=i,this._last=i;else if(t){const r=this._last;this._last=i,i.prev=r,r.next=i}else{const r=this._first;this._first=i,i.next=r,r.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==Ln.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Ln.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Ln.Undefined&&e.next!==Ln.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Ln.Undefined&&e.next===Ln.Undefined?(this._first=Ln.Undefined,this._last=Ln.Undefined):e.next===Ln.Undefined?(this._last=this._last.prev,this._last.next=Ln.Undefined):e.prev===Ln.Undefined&&(this._first=this._first.next,this._first.prev=Ln.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Ln.Undefined;)yield e.element,e=e.next}}const yme=globalThis.performance.now.bind(globalThis.performance);class th{static create(e){return new th(e)}constructor(e){this._now=e===!1?Date.now:yme,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var Se;(function(s){s.None=()=>le.None;function e(H,U){return g(H,()=>{},0,void 0,!0,void 0,U)}s.defer=e;function t(H){return(U,X=null,Y)=>{let q=!1,ee;return ee=H(ue=>{if(!q)return ee?ee.dispose():q=!0,U.call(X,ue)},null,Y),q&&ee.dispose(),ee}}s.once=t;function i(H,U){return s.once(s.filter(H,U))}s.onceIf=i;function n(H,U,X){return h((Y,q=null,ee)=>H(ue=>Y.call(q,U(ue)),null,ee),X)}s.map=n;function r(H,U,X){return h((Y,q=null,ee)=>H(ue=>{U(ue),Y.call(q,ue)},null,ee),X)}s.forEach=r;function o(H,U,X){return h((Y,q=null,ee)=>H(ue=>U(ue)&&Y.call(q,ue),null,ee),X)}s.filter=o;function a(H){return H}s.signal=a;function l(...H){return(U,X=null,Y)=>{const q=nc(...H.map(ee=>ee(ue=>U.call(X,ue))));return d(q,Y)}}s.any=l;function c(H,U,X,Y){let q=X;return n(H,ee=>(q=U(q,ee),q),Y)}s.reduce=c;function h(H,U){let X;const Y={onWillAddFirstListener(){X=H(q.fire,q)},onDidRemoveLastListener(){X==null||X.dispose()}},q=new Z(Y);return U==null||U.add(q),q.event}function d(H,U){return U instanceof Array?U.push(H):U&&U.add(H),H}function g(H,U,X=100,Y=!1,q=!1,ee,ue){let oe,Ee,$,ce=0,de;const xe={leakWarningThreshold:ee,onWillAddFirstListener(){oe=H(Xe=>{ce++,Ee=U(Ee,Xe),Y&&!$&&(Re.fire(Ee),Ee=void 0),de=()=>{const ht=Ee;Ee=void 0,$=void 0,(!Y||ce>1)&&Re.fire(ht),ce=0},typeof X=="number"?($&&clearTimeout($),$=setTimeout(de,X)):$===void 0&&($=null,queueMicrotask(de))})},onWillRemoveListener(){q&&ce>0&&(de==null||de())},onDidRemoveLastListener(){de=void 0,oe.dispose()}},Re=new Z(xe);return ue==null||ue.add(Re),Re.event}s.debounce=g;function p(H,U=0,X){return s.debounce(H,(Y,q)=>Y?(Y.push(q),Y):[q],U,void 0,!0,void 0,X)}s.accumulate=p;function _(H,U=(Y,q)=>Y===q,X){let Y=!0,q;return o(H,ee=>{const ue=Y||!U(ee,q);return Y=!1,q=ee,ue},X)}s.latch=_;function b(H,U,X){return[s.filter(H,U,X),s.filter(H,Y=>!U(Y),X)]}s.split=b;function C(H,U=!1,X=[],Y){let q=X.slice(),ee=H(Ee=>{q?q.push(Ee):oe.fire(Ee)});Y&&Y.add(ee);const ue=()=>{q==null||q.forEach(Ee=>oe.fire(Ee)),q=null},oe=new Z({onWillAddFirstListener(){ee||(ee=H(Ee=>oe.fire(Ee)),Y&&Y.add(ee))},onDidAddFirstListener(){q&&(U?setTimeout(ue):ue())},onDidRemoveLastListener(){ee&&ee.dispose(),ee=null}});return Y&&Y.add(oe),oe.event}s.buffer=C;function x(H,U){return(Y,q,ee)=>{const ue=U(new y);return H(function(oe){const Ee=ue.evaluate(oe);Ee!==S&&Y.call(q,Ee)},void 0,ee)}}s.chain=x;const S=Symbol("HaltChainable");class y{constructor(){this.steps=[]}map(U){return this.steps.push(U),this}forEach(U){return this.steps.push(X=>(U(X),X)),this}filter(U){return this.steps.push(X=>U(X)?X:S),this}reduce(U,X){let Y=X;return this.steps.push(q=>(Y=U(Y,q),Y)),this}latch(U=(X,Y)=>X===Y){let X=!0,Y;return this.steps.push(q=>{const ee=X||!U(q,Y);return X=!1,Y=q,ee?q:S}),this}evaluate(U){for(const X of this.steps)if(U=X(U),U===S)break;return U}}function k(H,U,X=Y=>Y){const Y=(...oe)=>ue.fire(X(...oe)),q=()=>H.on(U,Y),ee=()=>H.removeListener(U,Y),ue=new Z({onWillAddFirstListener:q,onDidRemoveLastListener:ee});return ue.event}s.fromNodeEventEmitter=k;function D(H,U,X=Y=>Y){const Y=(...oe)=>ue.fire(X(...oe)),q=()=>H.addEventListener(U,Y),ee=()=>H.removeEventListener(U,Y),ue=new Z({onWillAddFirstListener:q,onDidRemoveLastListener:ee});return ue.event}s.fromDOMEventEmitter=D;function R(H,U){let X;const Y=new Promise((q,ee)=>{const ue=t(H)(q,null,U);X=()=>ue.dispose()});return Y.cancel=X,Y}s.toPromise=R;function N(H,U){return H(X=>U.fire(X))}s.forward=N;function A(H,U,X){return U(X),H(Y=>U(Y))}s.runAndSubscribe=A;class M{constructor(U,X){this._observable=U,this._counter=0,this._hasChanged=!1;const Y={onWillAddFirstListener:()=>{U.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{U.removeObserver(this)}};this.emitter=new Z(Y),X&&X.add(this.emitter)}beginUpdate(U){this._counter++}handlePossibleChange(U){}handleChange(U,X){this._hasChanged=!0}endUpdate(U){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function O(H,U){return new M(H,U).emitter.event}s.fromObservable=O;function V(H){return(U,X,Y)=>{let q=0,ee=!1;const ue={beginUpdate(){q++},endUpdate(){q--,q===0&&(H.reportChanges(),ee&&(ee=!1,U.call(X)))},handlePossibleChange(){},handleChange(){ee=!0}};H.addObserver(ue),H.reportChanges();const oe={dispose(){H.removeObserver(ue)}};return Y instanceof Pe?Y.add(oe):Array.isArray(Y)&&Y.push(oe),oe}}s.fromObservableLight=V})(Se||(Se={}));const g_=class g_{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${g_._idPool++}`,g_.all.add(this)}start(e){this._stopWatch=new th,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};g_.all=new Set,g_._idPool=0;let cM=g_,Sme=-1;const U2=class U2{constructor(e,t,i=(U2._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[r,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(r);const l=new xme(a,r);this._errorHandler(l)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}};U2._idPool=1;let uM=U2;class M6{static create(){const e=new Error;return new M6(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class xme extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class Lme extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}class eR{constructor(e){this.value=e}}const kme=2;let Z=class{constructor(e){var t,i,n,r;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new uM((e==null?void 0:e.onListenerError)??$t,((i=this._options)==null?void 0:i.leakWarningThreshold)??Sme):void 0,this._perfMon=(n=this._options)!=null&&n._profName?new cM(this._options._profName):void 0,this._deliveryQueue=(r=this._options)==null?void 0:r.deliveryQueue}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(n=this._leakageMon)==null||n.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,l,c,h,d,g,p;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const _=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(_);const b=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],C=new Lme(`${_}. HINT: Stack shows most frequent listener (${b[1]}-times)`,b[0]);return(((a=this._options)==null?void 0:a.onListenerError)||$t)(C),le.None}if(this._disposed)return le.None;t&&(e=e.bind(t));const n=new eR(e);let r;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=M6.create(),r=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof eR?(this._deliveryQueue??(this._deliveryQueue=new dX),this._listeners=[this._listeners,n]):this._listeners.push(n):((c=(l=this._options)==null?void 0:l.onWillAddFirstListener)==null||c.call(l,this),this._listeners=n,(d=(h=this._options)==null?void 0:h.onDidAddFirstListener)==null||d.call(h,this)),(p=(g=this._options)==null?void 0:g.onDidAddListener)==null||p.call(g,this),this._size++;const o=qe(()=>{r==null||r(),this._removeListener(n)});return i instanceof Pe?i.add(o):Array.isArray(i)&&i.push(o),o}),this._event}_removeListener(e){var r,o,a,l;if((o=(r=this._options)==null?void 0:r.onWillRemoveListener)==null||o.call(r,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(l=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||l.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*kme<=t.length){let c=0;for(let h=0;h<t.length;h++)t[h]?t[c++]=t[h]:n&&c<this._deliveryQueue.end&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=c}}_deliver(e,t){var n;if(!e)return;const i=((n=this._options)==null?void 0:n.onListenerError)||$t;if(!i){e.value(t);return}try{e.value(t)}catch(r){i(r)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,n,r;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(n=this._perfMon)==null||n.start(this._size),this._listeners)if(this._listeners instanceof eR)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(r=this._perfMon)==null||r.stop()}hasListeners(){return this._size>0}};const Eme=()=>new dX;class dX{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class vv extends Z{constructor(e){super(e),this._isPaused=0,this._eventQueue=new Dr,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class fX extends vv{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class Dme extends Z{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e==null?void 0:e.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class Tme{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new Z({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),qe(wv(()=>{this.hasListeners&&this.unhook(t);const n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){var t;(t=e.listener)==null||t.dispose(),e.listener=null}dispose(){var e;this.emitter.dispose();for(const t of this.events)(e=t.listener)==null||e.dispose();this.events=[]}}class FC{constructor(){this.data=[]}wrapEvent(e,t,i){return(n,r,o)=>e(a=>{const l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(r,a)):n.call(r,a);return}const c=l;if(!c){n.call(r,t(i,a));return}c.items??(c.items=[]),c.items.push(a),c.buffers.length===0&&l.buffers.push(()=>{c.reducedResult??(c.reducedResult=i?c.items.reduce(t,i):c.items.reduce(t)),n.call(r,c.reducedResult)})},void 0,o)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}}class i0{constructor(){this.listening=!1,this.inputEvent=Se.None,this.inputEventListener=le.None,this.emitter=new Z({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const Yh=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new Z,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(s){s=Math.min(Math.max(-5,s),20),this._zoomLevel!==s&&(this._zoomLevel=s,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},Nme=_t?1.5:1.35,tR=8;class tm{static _create(e,t,i,n,r,o,a,l,c){o===0?o=Nme*i:o<tR&&(o=o*i),o=Math.round(o),o<tR&&(o=tR);const h=1+(c?0:Yh.getZoomLevel()*.1);return i*=h,o*=h,r===mX&&(t==="normal"||t==="bold"?r=gX:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new tm({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:r,lineHeight:o,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=ra.fontFamily,t=tm._wrapInQuotes(this.fontFamily);return this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const Ime=2;class ZL extends tm{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=Ime,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}const gX="normal",mX="translate",Rme="Consolas, 'Courier New', monospace",Ame="Menlo, Monaco, 'Courier New', monospace",Mme="'Droid Sans Mono', 'monospace', monospace",ra={fontFamily:_t?Ame:Rr?Rme:Mme,fontWeight:"normal",fontSize:_t?12:14,lineHeight:0,letterSpacing:0},_s={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},pX="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Ome(s=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of pX)s.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const O6=Ome();function P6(s){let e=O6;if(s&&s instanceof RegExp)if(s.global)e=s;else{let t="g";s.ignoreCase&&(t+="i"),s.multiline&&(t+="m"),s.unicode&&(t+="u"),e=new RegExp(s.source,t)}return e.lastIndex=0,e}const _X=new Dr;_X.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Cv(s,e,t,i,n){if(e=P6(e),n||(n=Dt.first(_X)),t.length>n.maxLen){let c=s-n.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,s+n.maxLen/2),Cv(s,e,t,i,n)}const r=Date.now(),o=s-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-r>=n.timeBudget);c++){const h=o-n.windowSize*c;e.lastIndex=Math.max(0,h);const d=Pme(e,t,o,a);if(!d&&l||(l=d,h<=0))break;a=h}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function Pme(s,e,t,i){let n;for(;n=s.exec(e);){const r=n.index||0;if(r<=t&&s.lastIndex>=t)return n;if(i>0&&r>i)return null}return null}const Ol=8;class bX{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class wX{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Ci{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return oD(e,t)}compute(e,t,i){return i}}class Y0{constructor(e,t){this.newValue=e,this.didChange=t}}function oD(s,e){if(typeof s!="object"||typeof e!="object"||!s||!e)return new Y0(e,s!==e);if(Array.isArray(s)||Array.isArray(e)){const i=Array.isArray(s)&&Array.isArray(e)&&Sn(s,e);return new Y0(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=oD(s[i],e[i]);n.didChange&&(s[i]=n.newValue,t=!0)}return new Y0(s,t)}class Bd{constructor(e,t){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=t}applyUpdate(e,t){return oD(e,t)}validate(e){return this.defaultValue}}class G1{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return oD(e,t)}compute(e,t,i){return i}}function Me(s,e){return typeof s>"u"?e:s==="false"?!1:!!s}class rt extends G1{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Me(e,this.defaultValue)}}function Cu(s,e,t,i){if(typeof s=="string"&&(s=parseInt(s,10)),typeof s!="number"||isNaN(s))return e;let n=s;return n=Math.max(t,n),n=Math.min(i,n),n|0}class Wt extends G1{static clampedInt(e,t,i,n){return Cu(e,t,i,n)}constructor(e,t,i,n,r,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=n,o.maximum=r),super(e,t,i,o),this.minimum=n,this.maximum=r}validate(e){return Wt.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function Fme(s,e,t,i){if(typeof s>"u")return e;const n=Tr.float(s,e);return Tr.clamp(n,t,i)}class Tr extends G1{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){return typeof e=="string"&&(e=parseFloat(e)),typeof e!="number"||isNaN(e)?t:e}constructor(e,t,i,n,r,o,a){typeof r<"u"&&(r.type="number",r.default=i,r.minimum=o,r.maximum=a),super(e,t,i,r),this.validationFn=n,this.minimum=o,this.maximum=a}validate(e){return this.validationFn(Tr.float(e,this.defaultValue))}}class $s extends G1{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return $s.string(e,this.defaultValue)}}function di(s,e,t,i){return typeof s!="string"?e:i&&s in i?i[s]:t.indexOf(s)===-1?e:s}class vi extends G1{constructor(e,t,i,n,r=void 0){typeof r<"u"&&(r.type="string",r.enum=n.slice(0),r.default=i),super(e,t,i,r),this._allowedValues=n}validate(e){return di(e,this.defaultValue,this._allowedValues)}}class n0 extends Ci{constructor(e,t,i,n,r,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=n),super(e,t,i,a),this._allowedValues=r,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function Bme(s){switch(s){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class Vme extends Ci{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[v(201,"Use platform APIs to detect when a Screen Reader is attached."),v(202,"Optimize for usage with a Screen Reader."),v(203,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:v(204,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class Hme extends Ci{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(29,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:v(205,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:v(206,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Me(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Me(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function Wme(s){switch(s){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var Dn;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(Dn||(Dn={}));function qW(s){switch(s){case"line":return Dn.Line;case"block":return Dn.Block;case"underline":return Dn.Underline;case"line-thin":return Dn.LineThin;case"block-outline":return Dn.BlockOutline;case"underline-thin":return Dn.UnderlineThin}}class zme extends Bd{constructor(){super(162,"")}compute(e,t,i){const n=["monaco-editor"];return t.get(48)&&n.push(t.get(48)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(82)==="default"?n.push("mouse-default"):t.get(82)==="copy"&&n.push("mouse-copy"),t.get(127)&&n.push("showUnused"),t.get(157)&&n.push("showDeprecated"),n.join(" ")}}class Ume extends rt{constructor(){super(45,"emptySelectionClipboard",!0,{description:v(207,"Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class jme extends Ci{constructor(){const e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(50,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:v(208,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[v(209,"Never seed search string from the editor selection."),v(210,"Always seed search string from the editor selection, including word at cursor position."),v(211,"Only seed search string from the editor selection.")],description:v(212,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[v(213,"Never turn on Find in Selection automatically (default)."),v(214,"Always turn on Find in Selection automatically."),v(215,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:v(216,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:v(217,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:_t},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:v(218,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:v(219,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[v(220,"Do not store search history from the find widget."),v(221,"Store search history across the active workspace")],description:v(222,"Controls how the find widget history should be stored")},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[v(223,"Do not store history from the replace widget."),v(224,"Store replace history across the active workspace")],description:v(225,"Controls how the replace widget history should be stored")},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:v(226,"Controls whether the Find Widget should search as you type.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Me(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:Me(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":di(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":di(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Me(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Me(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Me(t.loop,this.defaultValue.loop),history:di(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:di(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}}const mu=class mu extends Ci{constructor(){super(60,"fontLigatures",mu.OFF,{anyOf:[{type:"boolean",description:v(227,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:v(228,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:v(229,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?mu.OFF:e==="true"?mu.ON:e:e?mu.ON:mu.OFF}};mu.OFF='"liga" off, "calt" off',mu.ON='"liga" on, "calt" on';let Nd=mu;const pu=class pu extends Ci{constructor(){super(63,"fontVariations",pu.OFF,{anyOf:[{type:"boolean",description:v(230,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:v(231,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:v(232,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?pu.OFF:e==="true"?pu.TRANSLATE:e:e?pu.TRANSLATE:pu.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};pu.OFF=gX,pu.TRANSLATE=mX;let hM=pu;class $me extends Bd{constructor(){super(59,new ZL({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:!1,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:!1,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},!1))}compute(e,t,i){return e.fontInfo}}class qme extends Bd{constructor(){super(161,Dn.Line)}compute(e,t,i){return e.inputMode==="overtype"?t.get(92):t.get(34)}}class Gme extends Bd{constructor(){super(170,!1)}compute(e,t){return e.editContextSupported&&t.get(44)}}class Kme extends Bd{constructor(){super(172,!1)}compute(e,t){return e.accessibilitySupport===2?t.get(7):t.get(6)}}class Yme extends G1{constructor(){super(61,"fontSize",ra.fontSize,{type:"number",minimum:6,maximum:100,default:ra.fontSize,description:v(233,"Controls the font size in pixels.")})}validate(e){const t=Tr.float(e,this.defaultValue);return t===0?ra.fontSize:Tr.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const Hl=class Hl extends Ci{constructor(){super(62,"fontWeight",ra.fontWeight,{anyOf:[{type:"number",minimum:Hl.MINIMUM_VALUE,maximum:Hl.MAXIMUM_VALUE,errorMessage:v(234,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Hl.SUGGESTION_VALUES}],default:ra.fontWeight,description:v(235,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Wt.clampedInt(e,ra.fontWeight,Hl.MINIMUM_VALUE,Hl.MAXIMUM_VALUE))}};Hl.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],Hl.MINIMUM_VALUE=1,Hl.MAXIMUM_VALUE=1e3;let dM=Hl;class Qme extends Ci{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[v(236,"Show Peek view of the results (default)"),v(237,"Go to the primary result and show a Peek view"),v(238,"Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(67,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:v(239,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:v(240,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:v(241,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:v(242,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:v(243,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:v(244,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:v(245,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:v(246,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:v(247,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:v(248,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:v(249,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:di(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:di(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:di(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:di(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:di(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:di(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:di(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:$s.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:$s.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:$s.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:$s.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:$s.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:$s.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class Xme extends Ci{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(69,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:v(250,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:v(251,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:v(252,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:v(253,"Controls the delay in milliseconds after which the hover is hidden. Requires `#editor.hover.sticky#` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:v(254,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),delay:Wt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Me(t.sticky,this.defaultValue.sticky),hidingDelay:Wt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Me(t.above,this.defaultValue.above)}}}class A_ extends Bd{constructor(){super(165,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(e,t,i){return A_.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const r=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:r,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,h=e.scrollBeyondLastLine,d=e.minimap.renderCharacters;let g=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const p=e.minimap.maxColumn,_=e.minimap.size,b=e.minimap.side,C=e.verticalScrollbarWidth,x=e.viewLineCount,S=e.remainingWidth,y=e.isViewportWrapping,k=d?2:3;let D=Math.floor(r*n);const R=D/r;let N=!1,A=!1,M=k*g,O=g/r,V=1;if(_==="fill"||_==="fit"){const{typicalViewportLineCount:ue,extraLinesBeforeFirstLine:oe,extraLinesBeyondLastLine:Ee,desiredRatio:$,minimapLineCount:ce}=A_.computeContainedMinimapLineCount({viewLineCount:x,scrollBeyondLastLine:h,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:r});if(x/ce>1)N=!0,A=!0,g=1,M=1,O=g/r;else{let xe=!1,Re=g+1;if(_==="fit"){const Xe=Math.ceil((oe+x+Ee)*M);y&&a&&S<=t.stableFitRemainingWidth?(xe=!0,Re=t.stableFitMaxMinimapScale):xe=Xe>D}if(_==="fill"||xe){N=!0;const Xe=g;M=Math.min(l*r,Math.max(1,Math.floor(1/$))),y&&a&&S<=t.stableFitRemainingWidth&&(Re=t.stableFitMaxMinimapScale),g=Math.min(Re,Math.max(1,Math.floor(M/k))),g>Xe&&(V=Math.min(2,g/Xe)),O=g/r/V,D=Math.ceil(Math.max(ue,oe+x+Ee)*M),y?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=S,t.stableFitMaxMinimapScale=g):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const H=Math.floor(p*O),U=Math.min(H,Math.max(0,Math.floor((S-C-2)*O/(c+O)))+Ol);let X=Math.floor(r*U);const Y=X/r;X=Math.floor(X*V);const q=d?1:2,ee=b==="left"?0:i-U-C;return{renderMinimap:q,minimapLeft:ee,minimapWidth:U,minimapHeightIsEditorHeight:N,minimapIsSampling:A,minimapScale:g,minimapLineHeight:M,minimapCanvasInnerWidth:X,minimapCanvasInnerHeight:D,minimapCanvasOuterWidth:Y,minimapCanvasOuterHeight:R}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,r=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,h=t.viewLineCount,d=e.get(154),g=d==="inherit"?e.get(153):d,p=g==="inherit"?e.get(149):g,_=e.get(152),b=t.isDominatedByLongLines,C=e.get(66),x=e.get(76).renderType!==0,S=e.get(77),y=e.get(119),k=e.get(96),D=e.get(81),R=e.get(117),N=R.verticalScrollbarSize,A=R.verticalHasArrows,M=R.arrowSize,O=R.horizontalScrollbarSize,V=e.get(52),H=e.get(126)!=="never";let U=e.get(74);V&&H&&(U+=16);let X=0;if(x){const bi=Math.max(o,S);X=Math.round(bi*l)}let Y=0;C&&(Y=r*t.glyphMarginDecorationLaneCount);let q=0,ee=q+Y,ue=ee+X,oe=ue+U;const Ee=i-Y-X-U;let $=!1,ce=!1,de=-1;e.get(2)===2&&g==="inherit"&&b?($=!0,ce=!0):p==="on"||p==="bounded"?ce=!0:p==="wordWrapColumn"&&(de=_);const xe=A_._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:y,paddingTop:k.top,paddingBottom:k.bottom,minimap:D,verticalScrollbarWidth:N,viewLineCount:h,remainingWidth:Ee,isViewportWrapping:ce},t.memory||new wX);xe.renderMinimap!==0&&xe.minimapLeft===0&&(q+=xe.minimapWidth,ee+=xe.minimapWidth,ue+=xe.minimapWidth,oe+=xe.minimapWidth);const Re=Ee-xe.minimapWidth,Xe=Math.max(1,Math.floor((Re-N-2)/a)),ht=A?M:0;return ce&&(de=Math.max(1,Xe),p==="bounded"&&(de=Math.min(de,_))),{width:i,height:n,glyphMarginLeft:q,glyphMarginWidth:Y,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ee,lineNumbersWidth:X,decorationsLeft:ue,decorationsWidth:U,contentLeft:oe,contentWidth:Re,minimap:xe,viewportColumn:Xe,isWordWrapMinified:$,isViewportWrapping:ce,wrappingColumn:de,verticalScrollbarWidth:N,horizontalScrollbarHeight:O,overviewRuler:{top:ht,width:N,height:n-2*ht,right:0}}}}class Zme extends Ci{constructor(){super(156,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[v(255,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),v(256,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:v(257,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return di(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var uu;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(uu||(uu={}));class Jme extends Ci{constructor(){const e={enabled:uu.OnCode};super(73,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[uu.Off,uu.OnCode,uu.On],default:e.enabled,enumDescriptions:[v(258,"Disable the code action menu."),v(259,"Show the code action menu when the cursor is on lines with code."),v(260,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:v(261,"Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:di(e.enabled,this.defaultValue.enabled,[uu.Off,uu.OnCode,uu.On])}}}class epe extends Ci{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(131,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:v(262,"Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:v(263,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:v(264,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:v(265,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),maxLineCount:Wt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:di(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Me(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class tpe extends Ci{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(159,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:v(266,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[v(267,"Inlay hints are enabled"),v(268,"Inlay hints are showing by default and hide when holding {0}",_t?"Ctrl+Option":"Ctrl+Alt"),v(269,"Inlay hints are hidden by default and show when holding {0}",_t?"Ctrl+Option":"Ctrl+Alt"),v(270,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:v(271,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:v(272,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:v(273,"Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:v(274,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:di(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Wt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:$s.string(t.fontFamily,this.defaultValue.fontFamily),padding:Me(t.padding,this.defaultValue.padding),maximumLength:Wt.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}}class ipe extends Ci{constructor(){super(74,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Wt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Wt.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class npe extends Tr{constructor(){super(75,"lineHeight",ra.lineHeight,e=>Tr.clamp(e,0,150),{markdownDescription:v(275,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)},0,150)}compute(e,t,i){return e.fontInfo.lineHeight}}class spe extends Ci{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(81,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:v(276,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[v(277,"The minimap is always shown."),v(278,"The minimap is hidden when mouse is not over the minimap and shown when mouse is over the minimap."),v(279,"The minimap is only shown when the editor is scrolled")],default:e.autohide,description:v(280,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[v(281,"The minimap has the same size as the editor contents (and might scroll)."),v(282,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),v(283,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:v(284,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:v(285,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:v(286,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:v(287,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:v(288,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:v(289,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:v(290,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:v(291,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:v(292,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:v(293,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:v(294,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const n=t.markSectionHeaderRegex;if(typeof n=="string")try{new RegExp(n,"d"),i=n}catch{}return{enabled:Me(t.enabled,this.defaultValue.enabled),autohide:di(t.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:di(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:di(t.side,this.defaultValue.side,["right","left"]),showSlider:di(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Me(t.renderCharacters,this.defaultValue.renderCharacters),scale:Wt.clampedInt(t.scale,1,1,3),maxColumn:Wt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Me(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Me(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:Tr.clamp(Tr.float(t.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:Tr.clamp(Tr.float(t.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}}function rpe(s){return s==="ctrlCmd"?_t?"metaKey":"ctrlKey":"altKey"}class ope extends Ci{constructor(){super(96,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:v(295,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:v(296,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Wt.clampedInt(t.top,0,0,1e3),bottom:Wt.clampedInt(t.bottom,0,0,1e3)}}}class ape extends Ci{constructor(){const e={enabled:!0,cycle:!0};super(98,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:v(297,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:v(298,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),cycle:Me(t.cycle,this.defaultValue.cycle)}}}class lpe extends Bd{constructor(){super(163,1)}compute(e,t,i){return e.pixelRatio}}class cpe extends Ci{constructor(){super(100,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class upe extends Ci{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[v(299,"Quick suggestions show inside the suggest widget"),v(300,"Quick suggestions show as ghost text"),v(301,"Quick suggestions are disabled")]}];super(102,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:v(302,"Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:v(303,"Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:v(304,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:v(305,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,r=["on","inline","off"];let o,a,l;return typeof t=="boolean"?o=t?"on":"off":o=di(t,this.defaultValue.other,r),typeof i=="boolean"?a=i?"on":"off":a=di(i,this.defaultValue.comments,r),typeof n=="boolean"?l=n?"on":"off":l=di(n,this.defaultValue.strings,r),{other:o,comments:a,strings:l}}}class hpe extends Ci{constructor(){super(76,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[v(306,"Line numbers are not rendered."),v(307,"Line numbers are rendered as absolute number."),v(308,"Line numbers are rendered as distance in lines to cursor position."),v(309,"Line numbers are rendered every 10 lines.")],default:"on",description:v(310,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function JL(s){const e=s.get(112);return e==="editable"?s.get(104):e!=="on"}function ek(s){return!s.get(172)}class dpe extends Ci{constructor(){const e=[],t={type:"number",description:v(311,"Number of monospace characters at which this editor ruler will render.")};super(116,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:v(312,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:v(313,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Wt.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Wt.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class fpe extends Ci{constructor(){super(105,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function GW(s,e){if(typeof s!="string")return e;switch(s){case"hidden":return 2;case"visible":return 3;default:return 1}}let gpe=class extends Ci{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(117,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[v(314,"The vertical scrollbar will be visible only when necessary."),v(315,"The vertical scrollbar will always be visible."),v(316,"The vertical scrollbar will always be hidden.")],default:"auto",description:v(317,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[v(318,"The horizontal scrollbar will be visible only when necessary."),v(319,"The horizontal scrollbar will always be visible."),v(320,"The horizontal scrollbar will always be hidden.")],default:"auto",description:v(321,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:v(322,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:v(323,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:v(324,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:v(325,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Wt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Wt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Wt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:GW(t.vertical,this.defaultValue.vertical),horizontal:GW(t.horizontal,this.defaultValue.horizontal),useShadows:Me(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Me(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Me(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Me(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Me(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Wt.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Wt.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Me(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Me(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const Ga="inUntrustedWorkspace",df={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class mpe extends Ci{constructor(){const e={nonBasicASCII:Ga,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Ga,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(142,"unicodeHighlight",e,{[df.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ga],default:e.nonBasicASCII,description:v(326,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[df.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:v(327,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[df.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:v(328,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[df.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ga],default:e.includeComments,description:v(329,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[df.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ga],default:e.includeStrings,description:v(330,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[df.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:v(331,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[df.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:v(332,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&($r(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&($r(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new Y0(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:M_(t.nonBasicASCII,Ga,[!0,!1,Ga]),invisibleCharacters:Me(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Me(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:M_(t.includeComments,Ga,[!0,!1,Ga]),includeStrings:M_(t.includeStrings,Ga,[!0,!1,Ga]),allowedCharacters:this.validateBooleanMap(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(t.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,r]of Object.entries(e))r===!0&&(i[n]=!0);return i}}class ppe extends Ci{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,minShowDelay:0,suppressInSnippetMode:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always"},triggerCommandOnProviderChange:!1,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:!0}};super(71,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:v(333,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[v(334,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),v(335,"Show the inline suggestion toolbar when hovering over an inline suggestion."),v(336,"Never show the inline suggestion toolbar.")],description:v(337,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:v(338,"Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:v(339,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:v(340,"Controls whether inline suggestions are suppressed when in snippet mode.")},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:v(341,"Controls the minimal delay in milliseconds after which inline suggestions are shown after typing.")},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:v(342,"Suppresses inline completions for specified extension IDs -- comma separated."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:v(343,"Controls whether to send request information from the inline suggestion provider."),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:v(344,"Controls whether to trigger a command when the inline suggestion provider changes."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:v(345,"Controls whether to show inline suggestions when there is a suggest conflict."),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:v(346,"Controls the font family of the inline suggestions.")},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:v(347,"Controls whether showing a suggestion will shift the code to make space for the suggestion inline."),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:v(348,"Controls whether larger suggestions can be shown side by side."),enum:["auto","never"],enumDescriptions:[v(349,"Larger suggestions will show side by side if there is enough space, otherwise they will be shown below."),v(350,"Larger suggestions are never shown side by side and will always be shown below.")],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:v(351,"Controls whether the suggestion will show as collapsed until jumping to it."),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),mode:di(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:di(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Me(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Me(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:$s.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:Me(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:Wt.clampedInt(t.minShowDelay,0,0,1e4),suppressInSnippetMode:Me(t.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this._validateEdits(t.edits),triggerCommandOnProviderChange:Me(t.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this._validateExperimental(t.experimental)}}_validateEdits(e){if(!e||typeof e!="object")return this.defaultValue.edits;const t=e;return{enabled:Me(t.enabled,this.defaultValue.edits.enabled),showCollapsed:Me(t.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:di(t.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),renderSideBySide:di(t.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}_validateExperimental(e){if(!e||typeof e!="object")return this.defaultValue.experimental;const t=e;return{suppressInlineSuggestions:$s.string(t.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:di(t.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:Me(t.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}}class _pe extends Ci{constructor(){const e={enabled:_s.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:_s.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(21,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:v(352,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:v(353,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Me(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class bpe extends Ci{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(22,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[v(354,"Enables bracket pair guides."),v(355,"Enables bracket pair guides only for the active bracket pair."),v(356,"Disables bracket pair guides.")],default:e.bracketPairs,description:v(357,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[v(358,"Enables horizontal guides as addition to vertical bracket pair guides."),v(359,"Enables horizontal guides only for the active bracket pair."),v(360,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:v(361,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:v(362,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:v(363,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[v(364,"Highlights the active indent guide."),v(365,"Highlights the active indent guide even if bracket guides are highlighted."),v(366,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:v(367,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:M_(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:M_(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Me(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Me(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:M_(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function M_(s,e,t){const i=t.indexOf(s);return i===-1?e:t[i]}class wpe extends Ci{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(134,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[v(368,"Insert suggestion without overwriting text right of the cursor."),v(369,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:v(370,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:v(371,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:v(372,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:v(373,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[v(374,"Always select a suggestion when automatically triggering IntelliSense."),v(375,"Never select a suggestion when automatically triggering IntelliSense."),v(376,"Select a suggestion only when triggering IntelliSense from a trigger character."),v(377,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:v(378,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:v(379,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:v(380,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:v(381,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:v(382,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:v(383,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:v(384,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:v(385,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:v(386,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:v(387,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:v(388,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:v(389,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:v(390,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:v(391,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:v(392,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:v(393,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:v(394,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:v(395,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:v(396,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:v(397,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:v(398,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:v(399,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:v(400,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:v(401,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:v(402,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:v(403,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:v(404,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:v(405,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:v(406,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:v(407,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:v(408,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:v(409,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:v(410,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:v(411,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:v(412,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:v(413,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:v(414,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:v(415,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:di(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Me(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Me(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Me(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Me(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:di(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Me(t.showIcons,this.defaultValue.showIcons),showStatusBar:Me(t.showStatusBar,this.defaultValue.showStatusBar),preview:Me(t.preview,this.defaultValue.preview),previewMode:di(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Me(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Me(t.showMethods,this.defaultValue.showMethods),showFunctions:Me(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Me(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Me(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Me(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Me(t.showFields,this.defaultValue.showFields),showVariables:Me(t.showVariables,this.defaultValue.showVariables),showClasses:Me(t.showClasses,this.defaultValue.showClasses),showStructs:Me(t.showStructs,this.defaultValue.showStructs),showInterfaces:Me(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Me(t.showModules,this.defaultValue.showModules),showProperties:Me(t.showProperties,this.defaultValue.showProperties),showEvents:Me(t.showEvents,this.defaultValue.showEvents),showOperators:Me(t.showOperators,this.defaultValue.showOperators),showUnits:Me(t.showUnits,this.defaultValue.showUnits),showValues:Me(t.showValues,this.defaultValue.showValues),showConstants:Me(t.showConstants,this.defaultValue.showConstants),showEnums:Me(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Me(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Me(t.showKeywords,this.defaultValue.showKeywords),showWords:Me(t.showWords,this.defaultValue.showWords),showColors:Me(t.showColors,this.defaultValue.showColors),showFiles:Me(t.showFiles,this.defaultValue.showFiles),showReferences:Me(t.showReferences,this.defaultValue.showReferences),showFolders:Me(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Me(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Me(t.showSnippets,this.defaultValue.showSnippets),showUsers:Me(t.showUsers,this.defaultValue.showUsers),showIssues:Me(t.showIssues,this.defaultValue.showIssues)}}}class vpe extends Ci{constructor(){super(129,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:v(416,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:v(417,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Me(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Me(e.selectSubwords,this.defaultValue.selectSubwords)}}}class Cpe extends Ci{constructor(){const e=[];super(147,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:v(418,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class ype extends Ci{constructor(){super(155,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[v(419,"No indentation. Wrapped lines begin at column 1."),v(420,"Wrapped lines get the same indentation as the parent."),v(421,"Wrapped lines get +1 indentation toward the parent."),v(422,"Wrapped lines get +2 indentation toward the parent.")],description:v(423,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class Spe extends Bd{constructor(){super(166,{isDominatedByLongLines:!1,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1})}compute(e,t,i){const n=t.get(165);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class xpe extends Ci{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(43,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:v(424,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:v(425,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[v(426,"Show the drop selector widget after a file is dropped into the editor."),v(427,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),showDropSelector:di(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class Lpe extends Ci{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(97,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:v(428,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:v(429,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[v(430,"Show the paste selector widget after content is pasted into the editor."),v(431,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Me(t.enabled,this.defaultValue.enabled),showPasteSelector:di(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const Yp=[];function ge(s){return Yp[s.id]=s,s}const mo={acceptSuggestionOnCommitCharacter:ge(new rt(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:v(432,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:ge(new vi(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",v(433,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:v(434,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:ge(new Vme),accessibilityPageSize:ge(new Wt(3,"accessibilityPageSize",500,1,1073741824,{description:v(435,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),allowOverflow:ge(new rt(4,"allowOverflow",!0)),allowVariableLineHeights:ge(new rt(5,"allowVariableLineHeights",!0,{description:v(436,"Controls whether to allow using variable line heights in the editor.")})),allowVariableFonts:ge(new rt(6,"allowVariableFonts",!0,{description:v(437,"Controls whether to allow using variable fonts in the editor.")})),allowVariableFontsInAccessibilityMode:ge(new rt(7,"allowVariableFontsInAccessibilityMode",!1,{description:v(438,"Controls whether to allow using variable fonts in the editor in the accessibility mode."),tags:["accessibility"]})),ariaLabel:ge(new $s(8,"ariaLabel",v(439,"Editor content"))),ariaRequired:ge(new rt(9,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:ge(new rt(12,"screenReaderAnnounceInlineSuggestion",!0,{description:v(440,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:ge(new vi(10,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",v(441,"Use language configurations to determine when to autoclose brackets."),v(442,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:v(443,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:ge(new vi(11,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",v(444,"Use language configurations to determine when to autoclose comments."),v(445,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:v(446,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:ge(new vi(13,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",v(447,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:v(448,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:ge(new vi(14,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",v(449,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:v(450,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:ge(new vi(15,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",v(451,"Use language configurations to determine when to autoclose quotes."),v(452,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:v(453,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:ge(new n0(16,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],Bme,{enumDescriptions:[v(454,"The editor will not insert indentation automatically."),v(455,"The editor will keep the current line's indentation."),v(456,"The editor will keep the current line's indentation and honor language defined brackets."),v(457,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),v(458,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:v(459,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),autoIndentOnPaste:ge(new rt(17,"autoIndentOnPaste",!1,{description:v(460,"Controls whether the editor should automatically auto-indent the pasted content.")})),autoIndentOnPasteWithinString:ge(new rt(18,"autoIndentOnPasteWithinString",!0,{description:v(461,"Controls whether the editor should automatically auto-indent the pasted content when pasted within a string. This takes effect when autoIndentOnPaste is true.")})),automaticLayout:ge(new rt(19,"automaticLayout",!1)),autoSurround:ge(new vi(20,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[v(462,"Use language configurations to determine when to automatically surround selections."),v(463,"Surround with quotes but not brackets."),v(464,"Surround with brackets but not quotes."),""],description:v(465,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:ge(new _pe),bracketPairGuides:ge(new bpe),stickyTabStops:ge(new rt(132,"stickyTabStops",!1,{description:v(466,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:ge(new rt(23,"codeLens",!0,{description:v(467,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:ge(new $s(24,"codeLensFontFamily","",{description:v(468,"Controls the font family for CodeLens.")})),codeLensFontSize:ge(new Wt(25,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:v(469,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:ge(new rt(26,"colorDecorators",!0,{description:v(470,"Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:ge(new vi(168,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[v(471,"Make the color picker appear both on click and hover of the color decorator"),v(472,"Make the color picker appear on hover of the color decorator"),v(473,"Make the color picker appear on click of the color decorator")],description:v(474,"Controls the condition to make a color picker appear from a color decorator.")})),colorDecoratorsLimit:ge(new Wt(27,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:v(475,"Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:ge(new rt(28,"columnSelection",!1,{description:v(476,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:ge(new Hme),contextmenu:ge(new rt(30,"contextmenu",!0)),copyWithSyntaxHighlighting:ge(new rt(31,"copyWithSyntaxHighlighting",!0,{description:v(477,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:ge(new n0(32,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],Wme,{description:v(478,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:ge(new vi(33,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[v(479,"Smooth caret animation is disabled."),v(480,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),v(481,"Smooth caret animation is always enabled.")],description:v(482,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:ge(new n0(34,"cursorStyle",Dn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],qW,{description:v(483,"Controls the cursor style in insert input mode.")})),overtypeCursorStyle:ge(new n0(92,"overtypeCursorStyle",Dn.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],qW,{description:v(484,"Controls the cursor style in overtype input mode.")})),cursorSurroundingLines:ge(new Wt(35,"cursorSurroundingLines",0,0,1073741824,{description:v(485,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:ge(new vi(36,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[v(486,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),v(487,"`cursorSurroundingLines` is enforced always.")],markdownDescription:v(488,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:ge(new Wt(37,"cursorWidth",0,0,1073741824,{markdownDescription:v(489,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),cursorHeight:ge(new Wt(38,"cursorHeight",0,0,1073741824,{markdownDescription:v(490,"Controls the height of the cursor when `#editor.cursorStyle#` is set to `line`. Cursor's max height depends on line height.")})),disableLayerHinting:ge(new rt(39,"disableLayerHinting",!1)),disableMonospaceOptimizations:ge(new rt(40,"disableMonospaceOptimizations",!1)),domReadOnly:ge(new rt(41,"domReadOnly",!1)),dragAndDrop:ge(new rt(42,"dragAndDrop",!0,{description:v(491,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:ge(new Ume),dropIntoEditor:ge(new xpe),editContext:ge(new rt(44,"editContext",!0,{description:v(492,"Sets whether the EditContext API should be used instead of the text area to power input in the editor."),included:R6||hX||bv})),renderRichScreenReaderContent:ge(new rt(107,"renderRichScreenReaderContent",!1,{markdownDescription:v(493,"Whether to render rich screen reader content when the `#editor.editContext#` setting is enabled.")})),stickyScroll:ge(new epe),experimentalGpuAcceleration:ge(new vi(46,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[v(494,"Use regular DOM-based rendering."),v(495,"Use GPU acceleration.")],description:v(496,"Controls whether to use the experimental GPU acceleration to render the editor.")})),experimentalWhitespaceRendering:ge(new vi(47,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[v(497,"Use a new rendering method with svgs."),v(498,"Use a new rendering method with font characters."),v(499,"Use the stable rendering method.")],description:v(500,"Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:ge(new $s(48,"extraEditorClassName","")),fastScrollSensitivity:ge(new Tr(49,"fastScrollSensitivity",5,s=>s<=0?5:s,{markdownDescription:v(501,"Scrolling speed multiplier when pressing `Alt`.")})),find:ge(new jme),fixedOverflowWidgets:ge(new rt(51,"fixedOverflowWidgets",!1)),folding:ge(new rt(52,"folding",!0,{description:v(502,"Controls whether the editor has code folding enabled.")})),foldingStrategy:ge(new vi(53,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[v(503,"Use a language-specific folding strategy if available, else the indentation-based one."),v(504,"Use the indentation-based folding strategy.")],description:v(505,"Controls the strategy for computing folding ranges.")})),foldingHighlight:ge(new rt(54,"foldingHighlight",!0,{description:v(506,"Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:ge(new rt(55,"foldingImportsByDefault",!1,{description:v(507,"Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:ge(new Wt(56,"foldingMaximumRegions",5e3,10,65e3,{description:v(508,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:ge(new rt(57,"unfoldOnClickAfterEndOfLine",!1,{description:v(509,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:ge(new $s(58,"fontFamily",ra.fontFamily,{description:v(510,"Controls the font family.")})),fontInfo:ge(new $me),fontLigatures2:ge(new Nd),fontSize:ge(new Yme),fontWeight:ge(new dM),fontVariations:ge(new hM),formatOnPaste:ge(new rt(64,"formatOnPaste",!1,{description:v(511,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:ge(new rt(65,"formatOnType",!1,{description:v(512,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:ge(new rt(66,"glyphMargin",!0,{description:v(513,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:ge(new Qme),hideCursorInOverviewRuler:ge(new rt(68,"hideCursorInOverviewRuler",!1,{description:v(514,"Controls whether the cursor should be hidden in the overview ruler.")})),hover:ge(new Xme),inDiffEditor:ge(new rt(70,"inDiffEditor",!1)),inertialScroll:ge(new rt(158,"inertialScroll",!1,{description:v(515,"Make scrolling inertial - mostly useful with touchpad on linux.")})),letterSpacing:ge(new Tr(72,"letterSpacing",ra.letterSpacing,s=>Tr.clamp(s,-5,20),{description:v(516,"Controls the letter spacing in pixels.")})),lightbulb:ge(new Jme),lineDecorationsWidth:ge(new ipe),lineHeight:ge(new npe),lineNumbers:ge(new hpe),lineNumbersMinChars:ge(new Wt(77,"lineNumbersMinChars",5,1,300)),linkedEditing:ge(new rt(78,"linkedEditing",!1,{description:v(517,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:ge(new rt(79,"links",!0,{description:v(518,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:ge(new vi(80,"matchBrackets","always",["always","near","never"],{description:v(519,"Highlight matching brackets.")})),minimap:ge(new spe),mouseStyle:ge(new vi(82,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:ge(new Tr(83,"mouseWheelScrollSensitivity",1,s=>s===0?1:s,{markdownDescription:v(520,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:ge(new rt(84,"mouseWheelZoom",!1,{markdownDescription:_t?v(521,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):v(522,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:ge(new rt(85,"multiCursorMergeOverlapping",!0,{description:v(523,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:ge(new n0(86,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],rpe,{markdownEnumDescriptions:[v(524,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),v(525,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:v(526,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),mouseMiddleClickAction:ge(new vi(87,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:v(527,"Controls what happens when middle mouse button is clicked in the editor.")})),multiCursorPaste:ge(new vi(88,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[v(528,"Each cursor pastes a single line of the text."),v(529,"Each cursor pastes the full text.")],markdownDescription:v(530,"Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:ge(new Wt(89,"multiCursorLimit",1e4,1,1e5,{markdownDescription:v(531,"Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:ge(new vi(90,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[v(532,"Does not highlight occurrences."),v(533,"Highlights occurrences only in the current file."),v(534,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:v(535,"Controls whether occurrences should be highlighted across open files.")})),occurrencesHighlightDelay:ge(new Wt(91,"occurrencesHighlightDelay",0,0,2e3,{description:v(536,"Controls the delay in milliseconds after which occurrences are highlighted."),tags:["preview"]})),overtypeOnPaste:ge(new rt(93,"overtypeOnPaste",!0,{description:v(537,"Controls whether pasting should overtype.")})),overviewRulerBorder:ge(new rt(94,"overviewRulerBorder",!0,{description:v(538,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:ge(new Wt(95,"overviewRulerLanes",3,0,3)),padding:ge(new ope),pasteAs:ge(new Lpe),parameterHints:ge(new ape),peekWidgetDefaultFocus:ge(new vi(99,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[v(539,"Focus the tree when opening peek"),v(540,"Focus the editor when opening peek")],description:v(541,"Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:ge(new cpe),definitionLinkOpensInPeek:ge(new rt(101,"definitionLinkOpensInPeek",!1,{description:v(542,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:ge(new upe),quickSuggestionsDelay:ge(new Wt(103,"quickSuggestionsDelay",10,0,1073741824,{description:v(543,"Controls the delay in milliseconds after which quick suggestions will show up."),experiment:{mode:"auto"}})),readOnly:ge(new rt(104,"readOnly",!1)),readOnlyMessage:ge(new fpe),renameOnType:ge(new rt(106,"renameOnType",!1,{description:v(544,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:v(545,"Deprecated, use `#editor.linkedEditing#` instead.")})),renderControlCharacters:ge(new rt(108,"renderControlCharacters",!0,{description:v(546,"Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:ge(new vi(109,"renderFinalNewline",Gr?"dimmed":"on",["off","on","dimmed"],{description:v(547,"Render last line number when the file ends with a newline.")})),renderLineHighlight:ge(new vi(110,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",v(548,"Highlights both the gutter and the current line.")],description:v(549,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:ge(new rt(111,"renderLineHighlightOnlyWhenFocus",!1,{description:v(550,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:ge(new vi(112,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:ge(new vi(113,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",v(551,"Render whitespace characters except for single spaces between words."),v(552,"Render whitespace characters only on selected text."),v(553,"Render only trailing whitespace characters."),""],description:v(554,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:ge(new Wt(114,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:ge(new rt(115,"roundedSelection",!0,{description:v(555,"Controls whether selections should have rounded corners.")})),rulers:ge(new dpe),scrollbar:ge(new gpe),scrollBeyondLastColumn:ge(new Wt(118,"scrollBeyondLastColumn",4,0,1073741824,{description:v(556,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:ge(new rt(119,"scrollBeyondLastLine",!0,{description:v(557,"Controls whether the editor will scroll beyond the last line.")})),scrollOnMiddleClick:ge(new rt(171,"scrollOnMiddleClick",!1,{description:v(558,"Controls whether the editor will scroll when the middle button is pressed.")})),scrollPredominantAxis:ge(new rt(120,"scrollPredominantAxis",!0,{description:v(559,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:ge(new rt(121,"selectionClipboard",!0,{description:v(560,"Controls whether the Linux primary clipboard should be supported."),included:Gr})),selectionHighlight:ge(new rt(122,"selectionHighlight",!0,{description:v(561,"Controls whether the editor should highlight matches similar to the selection.")})),selectionHighlightMaxLength:ge(new Wt(123,"selectionHighlightMaxLength",200,0,1073741824,{description:v(562,"Controls how many characters can be in the selection before similiar matches are not highlighted. Set to zero for unlimited.")})),selectionHighlightMultiline:ge(new rt(124,"selectionHighlightMultiline",!1,{description:v(563,"Controls whether the editor should highlight selection matches that span multiple lines.")})),selectOnLineNumbers:ge(new rt(125,"selectOnLineNumbers",!0)),showFoldingControls:ge(new vi(126,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[v(564,"Always show the folding controls."),v(565,"Never show the folding controls and reduce the gutter size."),v(566,"Only show the folding controls when the mouse is over the gutter.")],description:v(567,"Controls when the folding controls on the gutter are shown.")})),showUnused:ge(new rt(127,"showUnused",!0,{description:v(568,"Controls fading out of unused code.")})),showDeprecated:ge(new rt(157,"showDeprecated",!0,{description:v(569,"Controls strikethrough deprecated variables.")})),inlayHints:ge(new tpe),snippetSuggestions:ge(new vi(128,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[v(570,"Show snippet suggestions on top of other suggestions."),v(571,"Show snippet suggestions below other suggestions."),v(572,"Show snippets suggestions with other suggestions."),v(573,"Do not show snippet suggestions.")],description:v(574,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:ge(new vpe),smoothScrolling:ge(new rt(130,"smoothScrolling",!1,{description:v(575,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:ge(new Wt(133,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:ge(new wpe),inlineSuggest:ge(new ppe),inlineCompletionsAccessibilityVerbose:ge(new rt(169,"inlineCompletionsAccessibilityVerbose",!1,{description:v(576,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:ge(new Wt(135,"suggestFontSize",0,0,1e3,{markdownDescription:v(577,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:ge(new Wt(136,"suggestLineHeight",0,0,1e3,{markdownDescription:v(578,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:ge(new rt(137,"suggestOnTriggerCharacters",!0,{description:v(579,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:ge(new vi(138,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[v(580,"Always select the first suggestion."),v(581,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),v(582,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:v(583,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:ge(new vi(139,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[v(584,"Tab complete will insert the best matching suggestion when pressing tab."),v(585,"Disable tab completions."),v(586,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:v(587,"Enables tab completions.")})),tabIndex:ge(new Wt(140,"tabIndex",0,-1,1073741824)),trimWhitespaceOnDelete:ge(new rt(141,"trimWhitespaceOnDelete",!1,{description:v(588,"Controls whether the editor will also delete the next line's indentation whitespace when deleting a newline.")})),unicodeHighlight:ge(new mpe),unusualLineTerminators:ge(new vi(143,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[v(589,"Unusual line terminators are automatically removed."),v(590,"Unusual line terminators are ignored."),v(591,"Unusual line terminators prompt to be removed.")],description:v(592,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:ge(new rt(144,"useShadowDOM",!0)),useTabStops:ge(new rt(145,"useTabStops",!0,{description:v(593,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:ge(new vi(146,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[v(594,"Use the default line break rule."),v(595,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:v(596,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:ge(new Cpe),wordSeparators:ge(new $s(148,"wordSeparators",pX,{description:v(597,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:ge(new vi(149,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[v(598,"Lines will never wrap."),v(599,"Lines will wrap at the viewport width."),v(600,"Lines will wrap at `#editor.wordWrapColumn#`."),v(601,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:v(602,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:ge(new $s(150,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:ge(new $s(151,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:ge(new Wt(152,"wordWrapColumn",80,1,1073741824,{markdownDescription:v(603,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:ge(new vi(153,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:ge(new vi(154,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:ge(new rt(160,"wrapOnEscapedLineFeeds",!1,{markdownDescription:v(604,'Controls whether literal `\\n` shall trigger a wordWrap when `#editor.wordWrap#` is enabled.\n\nFor example:\n```c\nchar* str="hello\\nworld"\n```\nwill be displayed as\n```c\nchar* str="hello\\n\n           world"\n```')})),effectiveCursorStyle:ge(new qme),editorClassName:ge(new zme),defaultColorDecorators:ge(new vi(167,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[v(605,"Show default color decorators only when no extension provides colors decorators."),v(606,"Always show default color decorators."),v(607,"Never show default color decorators.")],description:v(608,"Controls whether inline color decorations should be shown using the default document color provider.")})),pixelRatio:ge(new lpe),tabFocusMode:ge(new rt(164,"tabFocusMode",!1,{markdownDescription:v(609,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:ge(new A_),wrappingInfo:ge(new Spe),wrappingIndent:ge(new ype),wrappingStrategy:ge(new Zme),effectiveEditContextEnabled:ge(new Gme),effectiveAllowVariableFonts:ge(new Kme)},vX=Object.freeze(function(s,e){const t=setTimeout(s.bind(e),0);return{dispose(){clearTimeout(t)}}});var Io;(function(s){function e(t){return t===s.None||t===s.Cancelled||t instanceof zx?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}s.isCancellationToken=e,s.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Se.None}),s.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:vX})})(Io||(Io={}));class zx{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?vX:(this._emitter||(this._emitter=new Z),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let ym=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new zx),this._token}cancel(){this._token?this._token instanceof zx&&this._token.cancel():this._token=Io.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof zx&&this._token.dispose():this._token=Io.None}};class F6{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const Ux=new F6,fM=new F6,gM=new F6,CX=new Array(230),kpe=Object.create(null),Epe=Object.create(null),B6=[];for(let s=0;s<=193;s++)B6[s]=-1;(function(){const e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN","",""],[1,1,"Hyper",0,"",0,"","",""],[1,2,"Super",0,"",0,"","",""],[1,3,"Fn",0,"",0,"","",""],[1,4,"FnLock",0,"",0,"","",""],[1,5,"Suspend",0,"",0,"","",""],[1,6,"Resume",0,"",0,"","",""],[1,7,"Turbo",0,"",0,"","",""],[1,8,"Sleep",0,"",0,"VK_SLEEP","",""],[1,9,"WakeUp",0,"",0,"","",""],[0,10,"KeyA",31,"A",65,"VK_A","",""],[0,11,"KeyB",32,"B",66,"VK_B","",""],[0,12,"KeyC",33,"C",67,"VK_C","",""],[0,13,"KeyD",34,"D",68,"VK_D","",""],[0,14,"KeyE",35,"E",69,"VK_E","",""],[0,15,"KeyF",36,"F",70,"VK_F","",""],[0,16,"KeyG",37,"G",71,"VK_G","",""],[0,17,"KeyH",38,"H",72,"VK_H","",""],[0,18,"KeyI",39,"I",73,"VK_I","",""],[0,19,"KeyJ",40,"J",74,"VK_J","",""],[0,20,"KeyK",41,"K",75,"VK_K","",""],[0,21,"KeyL",42,"L",76,"VK_L","",""],[0,22,"KeyM",43,"M",77,"VK_M","",""],[0,23,"KeyN",44,"N",78,"VK_N","",""],[0,24,"KeyO",45,"O",79,"VK_O","",""],[0,25,"KeyP",46,"P",80,"VK_P","",""],[0,26,"KeyQ",47,"Q",81,"VK_Q","",""],[0,27,"KeyR",48,"R",82,"VK_R","",""],[0,28,"KeyS",49,"S",83,"VK_S","",""],[0,29,"KeyT",50,"T",84,"VK_T","",""],[0,30,"KeyU",51,"U",85,"VK_U","",""],[0,31,"KeyV",52,"V",86,"VK_V","",""],[0,32,"KeyW",53,"W",87,"VK_W","",""],[0,33,"KeyX",54,"X",88,"VK_X","",""],[0,34,"KeyY",55,"Y",89,"VK_Y","",""],[0,35,"KeyZ",56,"Z",90,"VK_Z","",""],[0,36,"Digit1",22,"1",49,"VK_1","",""],[0,37,"Digit2",23,"2",50,"VK_2","",""],[0,38,"Digit3",24,"3",51,"VK_3","",""],[0,39,"Digit4",25,"4",52,"VK_4","",""],[0,40,"Digit5",26,"5",53,"VK_5","",""],[0,41,"Digit6",27,"6",54,"VK_6","",""],[0,42,"Digit7",28,"7",55,"VK_7","",""],[0,43,"Digit8",29,"8",56,"VK_8","",""],[0,44,"Digit9",30,"9",57,"VK_9","",""],[0,45,"Digit0",21,"0",48,"VK_0","",""],[1,46,"Enter",3,"Enter",13,"VK_RETURN","",""],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE","",""],[1,48,"Backspace",1,"Backspace",8,"VK_BACK","",""],[1,49,"Tab",2,"Tab",9,"VK_TAB","",""],[1,50,"Space",10,"Space",32,"VK_SPACE","",""],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,"",0,"","",""],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL","",""],[1,64,"F1",59,"F1",112,"VK_F1","",""],[1,65,"F2",60,"F2",113,"VK_F2","",""],[1,66,"F3",61,"F3",114,"VK_F3","",""],[1,67,"F4",62,"F4",115,"VK_F4","",""],[1,68,"F5",63,"F5",116,"VK_F5","",""],[1,69,"F6",64,"F6",117,"VK_F6","",""],[1,70,"F7",65,"F7",118,"VK_F7","",""],[1,71,"F8",66,"F8",119,"VK_F8","",""],[1,72,"F9",67,"F9",120,"VK_F9","",""],[1,73,"F10",68,"F10",121,"VK_F10","",""],[1,74,"F11",69,"F11",122,"VK_F11","",""],[1,75,"F12",70,"F12",123,"VK_F12","",""],[1,76,"PrintScreen",0,"",0,"","",""],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL","",""],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE","",""],[1,79,"Insert",19,"Insert",45,"VK_INSERT","",""],[1,80,"Home",14,"Home",36,"VK_HOME","",""],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR","",""],[1,82,"Delete",20,"Delete",46,"VK_DELETE","",""],[1,83,"End",13,"End",35,"VK_END","",""],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT","",""],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",""],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",""],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",""],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",""],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK","",""],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE","",""],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY","",""],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT","",""],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD","",""],[1,94,"NumpadEnter",3,"",0,"","",""],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1","",""],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2","",""],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3","",""],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4","",""],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5","",""],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6","",""],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7","",""],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8","",""],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9","",""],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0","",""],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL","",""],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102","",""],[1,107,"ContextMenu",58,"ContextMenu",93,"","",""],[1,108,"Power",0,"",0,"","",""],[1,109,"NumpadEqual",0,"",0,"","",""],[1,110,"F13",71,"F13",124,"VK_F13","",""],[1,111,"F14",72,"F14",125,"VK_F14","",""],[1,112,"F15",73,"F15",126,"VK_F15","",""],[1,113,"F16",74,"F16",127,"VK_F16","",""],[1,114,"F17",75,"F17",128,"VK_F17","",""],[1,115,"F18",76,"F18",129,"VK_F18","",""],[1,116,"F19",77,"F19",130,"VK_F19","",""],[1,117,"F20",78,"F20",131,"VK_F20","",""],[1,118,"F21",79,"F21",132,"VK_F21","",""],[1,119,"F22",80,"F22",133,"VK_F22","",""],[1,120,"F23",81,"F23",134,"VK_F23","",""],[1,121,"F24",82,"F24",135,"VK_F24","",""],[1,122,"Open",0,"",0,"","",""],[1,123,"Help",0,"",0,"","",""],[1,124,"Select",0,"",0,"","",""],[1,125,"Again",0,"",0,"","",""],[1,126,"Undo",0,"",0,"","",""],[1,127,"Cut",0,"",0,"","",""],[1,128,"Copy",0,"",0,"","",""],[1,129,"Paste",0,"",0,"","",""],[1,130,"Find",0,"",0,"","",""],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE","",""],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP","",""],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN","",""],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR","",""],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1","",""],[1,136,"KanaMode",0,"",0,"","",""],[0,137,"IntlYen",0,"",0,"","",""],[1,138,"Convert",0,"",0,"","",""],[1,139,"NonConvert",0,"",0,"","",""],[1,140,"Lang1",0,"",0,"","",""],[1,141,"Lang2",0,"",0,"","",""],[1,142,"Lang3",0,"",0,"","",""],[1,143,"Lang4",0,"",0,"","",""],[1,144,"Lang5",0,"",0,"","",""],[1,145,"Abort",0,"",0,"","",""],[1,146,"Props",0,"",0,"","",""],[1,147,"NumpadParenLeft",0,"",0,"","",""],[1,148,"NumpadParenRight",0,"",0,"","",""],[1,149,"NumpadBackspace",0,"",0,"","",""],[1,150,"NumpadMemoryStore",0,"",0,"","",""],[1,151,"NumpadMemoryRecall",0,"",0,"","",""],[1,152,"NumpadMemoryClear",0,"",0,"","",""],[1,153,"NumpadMemoryAdd",0,"",0,"","",""],[1,154,"NumpadMemorySubtract",0,"",0,"","",""],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR","",""],[1,156,"NumpadClearEntry",0,"",0,"","",""],[1,0,"",5,"Ctrl",17,"VK_CONTROL","",""],[1,0,"",4,"Shift",16,"VK_SHIFT","",""],[1,0,"",6,"Alt",18,"VK_MENU","",""],[1,0,"",57,"Meta",91,"VK_COMMAND","",""],[1,157,"ControlLeft",5,"",0,"VK_LCONTROL","",""],[1,158,"ShiftLeft",4,"",0,"VK_LSHIFT","",""],[1,159,"AltLeft",6,"",0,"VK_LMENU","",""],[1,160,"MetaLeft",57,"",0,"VK_LWIN","",""],[1,161,"ControlRight",5,"",0,"VK_RCONTROL","",""],[1,162,"ShiftRight",4,"",0,"VK_RSHIFT","",""],[1,163,"AltRight",6,"",0,"VK_RMENU","",""],[1,164,"MetaRight",57,"",0,"VK_RWIN","",""],[1,165,"BrightnessUp",0,"",0,"","",""],[1,166,"BrightnessDown",0,"",0,"","",""],[1,167,"MediaPlay",0,"",0,"","",""],[1,168,"MediaRecord",0,"",0,"","",""],[1,169,"MediaFastForward",0,"",0,"","",""],[1,170,"MediaRewind",0,"",0,"","",""],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK","",""],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK","",""],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP","",""],[1,174,"Eject",0,"",0,"","",""],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE","",""],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT","",""],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL","",""],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2","",""],[1,179,"LaunchApp1",0,"",0,"VK_MEDIA_LAUNCH_APP1","",""],[1,180,"SelectTask",0,"",0,"","",""],[1,181,"LaunchScreenSaver",0,"",0,"","",""],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH","",""],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME","",""],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK","",""],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD","",""],[1,186,"BrowserStop",0,"",0,"VK_BROWSER_STOP","",""],[1,187,"BrowserRefresh",0,"",0,"VK_BROWSER_REFRESH","",""],[1,188,"BrowserFavorites",0,"",0,"VK_BROWSER_FAVORITES","",""],[1,189,"ZoomToggle",0,"",0,"","",""],[1,190,"MailReply",0,"",0,"","",""],[1,191,"MailForward",0,"",0,"","",""],[1,192,"MailSend",0,"",0,"","",""],[1,0,"",114,"KeyInComposition",229,"","",""],[1,0,"",116,"ABNT_C2",194,"VK_ABNT_C2","",""],[1,0,"",96,"OEM_8",223,"VK_OEM_8","",""],[1,0,"",0,"",0,"VK_KANA","",""],[1,0,"",0,"",0,"VK_HANGUL","",""],[1,0,"",0,"",0,"VK_JUNJA","",""],[1,0,"",0,"",0,"VK_FINAL","",""],[1,0,"",0,"",0,"VK_HANJA","",""],[1,0,"",0,"",0,"VK_KANJI","",""],[1,0,"",0,"",0,"VK_CONVERT","",""],[1,0,"",0,"",0,"VK_NONCONVERT","",""],[1,0,"",0,"",0,"VK_ACCEPT","",""],[1,0,"",0,"",0,"VK_MODECHANGE","",""],[1,0,"",0,"",0,"VK_SELECT","",""],[1,0,"",0,"",0,"VK_PRINT","",""],[1,0,"",0,"",0,"VK_EXECUTE","",""],[1,0,"",0,"",0,"VK_SNAPSHOT","",""],[1,0,"",0,"",0,"VK_HELP","",""],[1,0,"",0,"",0,"VK_APPS","",""],[1,0,"",0,"",0,"VK_PROCESSKEY","",""],[1,0,"",0,"",0,"VK_PACKET","",""],[1,0,"",0,"",0,"VK_DBE_SBCSCHAR","",""],[1,0,"",0,"",0,"VK_DBE_DBCSCHAR","",""],[1,0,"",0,"",0,"VK_ATTN","",""],[1,0,"",0,"",0,"VK_CRSEL","",""],[1,0,"",0,"",0,"VK_EXSEL","",""],[1,0,"",0,"",0,"VK_EREOF","",""],[1,0,"",0,"",0,"VK_PLAY","",""],[1,0,"",0,"",0,"VK_ZOOM","",""],[1,0,"",0,"",0,"VK_NONAME","",""],[1,0,"",0,"",0,"VK_PA1","",""],[1,0,"",0,"",0,"VK_OEM_CLEAR","",""]],t=[],i=[];for(const n of e){const[r,o,a,l,c,h,d,g,p]=n;if(i[o]||(i[o]=!0,kpe[a]=o,Epe[a.toLowerCase()]=o,r&&(B6[o]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);Ux.define(l,c),fM.define(l,g||c),gM.define(l,p||g||c)}h&&(CX[h]=l)}})();var Lu;(function(s){function e(a){return Ux.keyCodeToStr(a)}s.toString=e;function t(a){return Ux.strToKeyCode(a)}s.fromString=t;function i(a){return fM.keyCodeToStr(a)}s.toUserSettingsUS=i;function n(a){return gM.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function r(a){return fM.strToKeyCode(a)||gM.strToKeyCode(a)}s.fromUserSettings=r;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Ux.keyCodeToStr(a)}s.toElectronAccelerator=o})(Lu||(Lu={}));function yX(s,e){const t=(e&65535)<<16>>>0;return(s|t)>>>0}var KW={};let O_;const iR=globalThis.vscode;var WG;if(typeof iR<"u"&&typeof iR.process<"u"){const s=iR.process;O_={get platform(){return s.platform},get arch(){return s.arch},get env(){return s.env},cwd(){return s.cwd()}}}else typeof process<"u"&&typeof((WG=process==null?void 0:process.versions)==null?void 0:WG.node)=="string"?O_={get platform(){return process.platform},get arch(){return process.arch},get env(){return KW},cwd(){return KW.VSCODE_CWD||process.cwd()}}:O_={get platform(){return Rr?"win32":_t?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const tk=O_.cwd,ik=O_.env,Dpe=O_.platform,Tpe=65,Npe=97,Ipe=90,Rpe=122,yg=46,Ps=47,ao=92,eu=58,Ape=63;class SX extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${n} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function Mpe(s,e){if(s===null||typeof s!="object")throw new SX(e,"Object",s)}function zn(s,e){if(typeof s!="string")throw new SX(e,"string",s)}const Vd=Dpe==="win32";function Vt(s){return s===Ps||s===ao}function mM(s){return s===Ps}function tu(s){return s>=Tpe&&s<=Ipe||s>=Npe&&s<=Rpe}function nk(s,e,t,i){let n="",r=0,o=-1,a=0,l=0;for(let c=0;c<=s.length;++c){if(c<s.length)l=s.charCodeAt(c);else{if(i(l))break;l=Ps}if(i(l)){if(!(o===c-1||a===1))if(a===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==yg||n.charCodeAt(n.length-2)!==yg){if(n.length>2){const h=n.lastIndexOf(t);h===-1?(n="",r=0):(n=n.slice(0,h),r=n.length-1-n.lastIndexOf(t)),o=c,a=0;continue}else if(n.length!==0){n="",r=0,o=c,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",r=2)}else n.length>0?n+=`${t}${s.slice(o+1,c)}`:n=s.slice(o+1,c),r=c-o-1;o=c,a=0}else l===yg&&a!==-1?++a:a=-1}return n}function Ope(s){return s?`${s[0]==="."?"":"."}${s}`:""}function xX(s,e){Mpe(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${Ope(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${s}${i}`:i}const jr={resolve(...s){let e="",t="",i=!1;for(let n=s.length-1;n>=-1;n--){let r;if(n>=0){if(r=s[n],zn(r,`paths[${n}]`),r.length===0)continue}else e.length===0?r=tk():(r=ik[`=${e}`]||tk(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===ao)&&(r=`${e}\\`));const o=r.length;let a=0,l="",c=!1;const h=r.charCodeAt(0);if(o===1)Vt(h)&&(a=1,c=!0);else if(Vt(h))if(c=!0,Vt(r.charCodeAt(1))){let d=2,g=d;for(;d<o&&!Vt(r.charCodeAt(d));)d++;if(d<o&&d!==g){const p=r.slice(g,d);for(g=d;d<o&&Vt(r.charCodeAt(d));)d++;if(d<o&&d!==g){for(g=d;d<o&&!Vt(r.charCodeAt(d));)d++;(d===o||d!==g)&&(l=`\\\\${p}\\${r.slice(g,d)}`,a=d)}}}else a=1;else tu(h)&&r.charCodeAt(1)===eu&&(l=r.slice(0,2),a=2,o>2&&Vt(r.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=nk(t,!i,"\\",Vt),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(s){zn(s,"path");const e=s.length;if(e===0)return".";let t=0,i,n=!1;const r=s.charCodeAt(0);if(e===1)return mM(r)?"\\":s;if(Vt(r))if(n=!0,Vt(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Vt(s.charCodeAt(a));)a++;if(a<e&&a!==l){const c=s.slice(l,a);for(l=a;a<e&&Vt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Vt(s.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${s.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${s.slice(l,a)}`,t=a)}}}else t=1;else tu(r)&&s.charCodeAt(1)===eu&&(i=s.slice(0,2),t=2,e>2&&Vt(s.charCodeAt(2))&&(n=!0,t=3));let o=t<e?nk(s.slice(t),!n,"\\",Vt):"";if(o.length===0&&!n&&(o="."),o.length>0&&Vt(s.charCodeAt(e-1))&&(o+="\\"),!n&&i===void 0&&s.includes(":")){if(o.length>=2&&tu(o.charCodeAt(0))&&o.charCodeAt(1)===eu)return`.\\${o}`;let a=s.indexOf(":");do if(a===e-1||Vt(s.charCodeAt(a+1)))return`.\\${o}`;while((a=s.indexOf(":",a+1))!==-1)}return i===void 0?n?`\\${o}`:o:n?`${i}\\${o}`:`${i}${o}`},isAbsolute(s){zn(s,"path");const e=s.length;if(e===0)return!1;const t=s.charCodeAt(0);return Vt(t)||e>2&&tu(t)&&s.charCodeAt(1)===eu&&Vt(s.charCodeAt(2))},join(...s){if(s.length===0)return".";let e,t;for(let r=0;r<s.length;++r){const o=s[r];zn(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Vt(t.charCodeAt(0))){++n;const r=t.length;r>1&&Vt(t.charCodeAt(1))&&(++n,r>2&&(Vt(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Vt(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return jr.normalize(e)},relative(s,e){if(zn(s,"from"),zn(e,"to"),s===e)return"";const t=jr.resolve(s),i=jr.resolve(e);if(t===i||(s=t.toLowerCase(),e=i.toLowerCase(),s===e))return"";if(t.length!==s.length||i.length!==e.length){const _=t.split("\\"),b=i.split("\\");_[_.length-1]===""&&_.pop(),b[b.length-1]===""&&b.pop();const C=_.length,x=b.length,S=C<x?C:x;let y;for(y=0;y<S&&_[y].toLowerCase()===b[y].toLowerCase();y++);return y===0?i:y===S?x>S?b.slice(y).join("\\"):C>S?"..\\".repeat(C-1-y)+"..":"":"..\\".repeat(C-y)+b.slice(y).join("\\")}let n=0;for(;n<s.length&&s.charCodeAt(n)===ao;)n++;let r=s.length;for(;r-1>n&&s.charCodeAt(r-1)===ao;)r--;const o=r-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===ao;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===ao;)l--;const c=l-a,h=o<c?o:c;let d=-1,g=0;for(;g<h;g++){const _=s.charCodeAt(n+g);if(_!==e.charCodeAt(a+g))break;_===ao&&(d=g)}if(g!==h){if(d===-1)return i}else{if(c>h){if(e.charCodeAt(a+g)===ao)return i.slice(a+g+1);if(g===2)return i.slice(a+g)}o>h&&(s.charCodeAt(n+g)===ao?d=g:g===2&&(d=3)),d===-1&&(d=0)}let p="";for(g=n+d+1;g<=r;++g)(g===r||s.charCodeAt(g)===ao)&&(p+=p.length===0?"..":"\\..");return a+=d,p.length>0?`${p}${i.slice(a,l)}`:(i.charCodeAt(a)===ao&&++a,i.slice(a,l))},toNamespacedPath(s){if(typeof s!="string"||s.length===0)return s;const e=jr.resolve(s);if(e.length<=2)return s;if(e.charCodeAt(0)===ao){if(e.charCodeAt(1)===ao){const t=e.charCodeAt(2);if(t!==Ape&&t!==yg)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(tu(e.charCodeAt(0))&&e.charCodeAt(1)===eu&&e.charCodeAt(2)===ao)return`\\\\?\\${e}`;return e},dirname(s){zn(s,"path");const e=s.length;if(e===0)return".";let t=-1,i=0;const n=s.charCodeAt(0);if(e===1)return Vt(n)?s:".";if(Vt(n)){if(t=i=1,Vt(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Vt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Vt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Vt(s.charCodeAt(a));)a++;if(a===e)return s;a!==l&&(t=i=a+1)}}}}else tu(n)&&s.charCodeAt(1)===eu&&(t=e>2&&Vt(s.charCodeAt(2))?3:2,i=t);let r=-1,o=!0;for(let a=e-1;a>=i;--a)if(Vt(s.charCodeAt(a))){if(!o){r=a;break}}else o=!1;if(r===-1){if(t===-1)return".";r=t}return s.slice(0,r)},basename(s,e){e!==void 0&&zn(e,"suffix"),zn(s,"path");let t=0,i=-1,n=!0,r;if(s.length>=2&&tu(s.charCodeAt(0))&&s.charCodeAt(1)===eu&&(t=2),e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let o=e.length-1,a=-1;for(r=s.length-1;r>=t;--r){const l=s.charCodeAt(r);if(Vt(l)){if(!n){t=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(r=s.length-1;r>=t;--r)if(Vt(s.charCodeAt(r))){if(!n){t=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(t,i)},extname(s){zn(s,"path");let e=0,t=-1,i=0,n=-1,r=!0,o=0;s.length>=2&&s.charCodeAt(1)===eu&&tu(s.charCodeAt(0))&&(e=i=2);for(let a=s.length-1;a>=e;--a){const l=s.charCodeAt(a);if(Vt(l)){if(!r){i=a+1;break}continue}n===-1&&(r=!1,n=a+1),l===yg?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===i+1?"":s.slice(t,n)},format:xX.bind(null,"\\"),parse(s){zn(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.length;let i=0,n=s.charCodeAt(0);if(t===1)return Vt(n)?(e.root=e.dir=s,e):(e.base=e.name=s,e);if(Vt(n)){if(i=1,Vt(s.charCodeAt(1))){let d=2,g=d;for(;d<t&&!Vt(s.charCodeAt(d));)d++;if(d<t&&d!==g){for(g=d;d<t&&Vt(s.charCodeAt(d));)d++;if(d<t&&d!==g){for(g=d;d<t&&!Vt(s.charCodeAt(d));)d++;d===t?i=d:d!==g&&(i=d+1)}}}}else if(tu(n)&&s.charCodeAt(1)===eu){if(t<=2)return e.root=e.dir=s,e;if(i=2,Vt(s.charCodeAt(2))){if(t===3)return e.root=e.dir=s,e;i=3}}i>0&&(e.root=s.slice(0,i));let r=-1,o=i,a=-1,l=!0,c=s.length-1,h=0;for(;c>=i;--c){if(n=s.charCodeAt(c),Vt(n)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===yg?r===-1?r=c:h!==1&&(h=1):r!==-1&&(h=-1)}return a!==-1&&(r===-1||h===0||h===1&&r===a-1&&r===o+1?e.base=e.name=s.slice(o,a):(e.name=s.slice(o,r),e.base=s.slice(o,a),e.ext=s.slice(r,a))),o>0&&o!==i?e.dir=s.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Ppe=(()=>{if(Vd){const s=/\\/g;return()=>{const e=tk().replace(s,"/");return e.slice(e.indexOf("/"))}}return()=>tk()})(),dn={resolve(...s){let e="",t=!1;for(let i=s.length-1;i>=0&&!t;i--){const n=s[i];zn(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===Ps)}if(!t){const i=Ppe();e=`${i}/${e}`,t=i.charCodeAt(0)===Ps}return e=nk(e,!t,"/",mM),t?`/${e}`:e.length>0?e:"."},normalize(s){if(zn(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===Ps,t=s.charCodeAt(s.length-1)===Ps;return s=nk(s,!e,"/",mM),s.length===0?e?"/":t?"./":".":(t&&(s+="/"),e?`/${s}`:s)},isAbsolute(s){return zn(s,"path"),s.length>0&&s.charCodeAt(0)===Ps},join(...s){if(s.length===0)return".";const e=[];for(let t=0;t<s.length;++t){const i=s[t];zn(i,"path"),i.length>0&&e.push(i)}return e.length===0?".":dn.normalize(e.join("/"))},relative(s,e){if(zn(s,"from"),zn(e,"to"),s===e||(s=dn.resolve(s),e=dn.resolve(e),s===e))return"";const t=1,i=s.length,n=i-t,r=1,o=e.length-r,a=n<o?n:o;let l=-1,c=0;for(;c<a;c++){const d=s.charCodeAt(t+c);if(d!==e.charCodeAt(r+c))break;d===Ps&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(r+c)===Ps)return e.slice(r+c+1);if(c===0)return e.slice(r+c)}else n>a&&(s.charCodeAt(t+c)===Ps?l=c:c===0&&(l=0));let h="";for(c=t+l+1;c<=i;++c)(c===i||s.charCodeAt(c)===Ps)&&(h+=h.length===0?"..":"/..");return`${h}${e.slice(r+l)}`},toNamespacedPath(s){return s},dirname(s){if(zn(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===Ps;let t=-1,i=!0;for(let n=s.length-1;n>=1;--n)if(s.charCodeAt(n)===Ps){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":s.slice(0,t)},basename(s,e){e!==void 0&&zn(e,"suffix"),zn(s,"path");let t=0,i=-1,n=!0,r;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let o=e.length-1,a=-1;for(r=s.length-1;r>=0;--r){const l=s.charCodeAt(r);if(l===Ps){if(!n){t=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===Ps){if(!n){t=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(t,i)},extname(s){zn(s,"path");let e=-1,t=0,i=-1,n=!0,r=0;for(let o=s.length-1;o>=0;--o){const a=s[o];if(a==="/"){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a==="."?e===-1?e=o:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||i===-1||r===0||r===1&&e===i-1&&e===t+1?"":s.slice(e,i)},format:xX.bind(null,"/"),parse(s){zn(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.charCodeAt(0)===Ps;let i;t?(e.root="/",i=1):i=0;let n=-1,r=0,o=-1,a=!0,l=s.length-1,c=0;for(;l>=i;--l){const h=s.charCodeAt(l);if(h===Ps){if(!a){r=l+1;break}continue}o===-1&&(a=!1,o=l+1),h===yg?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(o!==-1){const h=r===0&&t?1:r;n===-1||c===0||c===1&&n===o-1&&n===r+1?e.base=e.name=s.slice(h,o):(e.name=s.slice(h,n),e.base=s.slice(h,o),e.ext=s.slice(n,o))}return r>0?e.dir=s.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};dn.win32=jr.win32=jr;dn.posix=jr.posix=dn;const LX=Vd?jr.normalize:dn.normalize,Fpe=Vd?jr.resolve:dn.resolve,Bpe=Vd?jr.relative:dn.relative,Vpe=Vd?jr.dirname:dn.dirname,kX=Vd?jr.basename:dn.basename,Hpe=Vd?jr.extname:dn.extname,bd=Vd?jr.sep:dn.sep,Wpe=/^\w[\w\d+.-]*$/,zpe=/^\//,Upe=/^\/\//;function jpe(s,e){if(!s.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${s.authority}", path: "${s.path}", query: "${s.query}", fragment: "${s.fragment}"}`);if(s.scheme&&!Wpe.test(s.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(s.path){if(s.authority){if(!zpe.test(s.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(Upe.test(s.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function $pe(s,e){return!s&&!e?"file":s}function qpe(s,e){switch(s){case"https":case"http":case"file":e?e[0]!==tl&&(e=tl+e):e=tl;break}return e}const Qi="",tl="/",Gpe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class mt{static isUri(e){return e instanceof mt?!0:!e||typeof e!="object"?!1:typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function"}constructor(e,t,i,n,r,o=!1){typeof e=="object"?(this.scheme=e.scheme||Qi,this.authority=e.authority||Qi,this.path=e.path||Qi,this.query=e.query||Qi,this.fragment=e.fragment||Qi):(this.scheme=$pe(e,o),this.authority=t||Qi,this.path=qpe(this.scheme,i||Qi),this.query=n||Qi,this.fragment=r||Qi,jpe(this,o))}get fsPath(){return sk(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:r,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=Qi),i===void 0?i=this.authority:i===null&&(i=Qi),n===void 0?n=this.path:n===null&&(n=Qi),r===void 0?r=this.query:r===null&&(r=Qi),o===void 0?o=this.fragment:o===null&&(o=Qi),t===this.scheme&&i===this.authority&&n===this.path&&r===this.query&&o===this.fragment?this:new kp(t,i,n,r,o)}static parse(e,t=!1){const i=Gpe.exec(e);return i?new kp(i[2]||Qi,WS(i[4]||Qi),WS(i[5]||Qi),WS(i[7]||Qi),WS(i[9]||Qi),t):new kp(Qi,Qi,Qi,Qi,Qi)}static file(e){let t=Qi;if(Rr&&(e=e.replace(/\\/g,tl)),e[0]===tl&&e[1]===tl){const i=e.indexOf(tl,2);i===-1?(t=e.substring(2),e=tl):(t=e.substring(2,i),e=e.substring(i)||tl)}return new kp("file",t,e,Qi,Qi)}static from(e,t){return new kp(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return Rr&&e.scheme==="file"?i=mt.file(jr.join(sk(e,!0),...t)).path:i=dn.join(e.path,...t),e.with({path:i})}toString(e=!1){return pM(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof mt)return e;{const t=new kp(e);return t._formatted=e.external??null,t._fsPath=e._sep===EX?e.fsPath??null:null,t}}else return e}}const EX=Rr?1:void 0;let kp=class extends mt{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=sk(this,!1)),this._fsPath}toString(e=!1){return e?pM(this,!0):(this._formatted||(this._formatted=pM(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=EX),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const DX={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function YW(s,e,t){let i,n=-1;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)n!==-1&&(i+=encodeURIComponent(s.substring(n,r)),n=-1),i!==void 0&&(i+=s.charAt(r));else{i===void 0&&(i=s.substr(0,r));const a=DX[o];a!==void 0?(n!==-1&&(i+=encodeURIComponent(s.substring(n,r)),n=-1),i+=a):n===-1&&(n=r)}}return n!==-1&&(i+=encodeURIComponent(s.substring(n))),i!==void 0?i:s}function Kpe(s){let e;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i===35||i===63?(e===void 0&&(e=s.substr(0,t)),e+=DX[i]):e!==void 0&&(e+=s[t])}return e!==void 0?e:s}function sk(s,e){let t;return s.authority&&s.path.length>1&&s.scheme==="file"?t=`//${s.authority}${s.path}`:s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58?e?t=s.path.substr(1):t=s.path[1].toLowerCase()+s.path.substr(2):t=s.path,Rr&&(t=t.replace(/\//g,"\\")),t}function pM(s,e){const t=e?Kpe:YW;let i="",{scheme:n,authority:r,path:o,query:a,fragment:l}=s;if(n&&(i+=n,i+=":"),(r||n==="file")&&(i+=tl,i+=tl),r){let c=r.indexOf("@");if(c!==-1){const h=r.substr(0,c);r=r.substr(c+1),c=h.lastIndexOf(":"),c===-1?i+=t(h,!1,!1):(i+=t(h.substr(0,c),!1,!1),i+=":",i+=t(h.substr(c+1),!1,!0)),i+="@"}r=r.toLowerCase(),c=r.lastIndexOf(":"),c===-1?i+=t(r,!1,!0):(i+=t(r.substr(0,c),!1,!0),i+=r.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const c=o.charCodeAt(1);c>=65&&c<=90&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const c=o.charCodeAt(0);c>=65&&c<=90&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:YW(l,!1,!1)),i}function TX(s){try{return decodeURIComponent(s)}catch{return s.length>3?s.substr(0,3)+TX(s.substr(3)):s}}const QW=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function WS(s){return s.match(QW)?s.replace(QW,e=>TX(e)):s}let J=class xf{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new xf(e,t)}delta(e=0,t=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+t))}equals(e){return xf.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return xf.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return xf.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const r=e.column|0,o=t.column|0;return r-o}return i-n}clone(){return new xf(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new xf(e.lineNumber,e.column)}static isIPosition(e){return!!e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},G=class Jn{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return Jn.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return Jn.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return Jn.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return Jn.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return Jn.plusRange(this,e)}static plusRange(e,t){let i,n,r,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,o=e.endColumn),new Jn(i,n,r,o)}intersectRanges(e){return Jn.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,h=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),r>c?(r=c,o=h):r===c&&(o=Math.min(o,h)),i>r||i===r&&n>o?null:new Jn(i,n,r,o)}equalsRange(e){return Jn.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return Jn.getEndPosition(this)}static getEndPosition(e){return new J(e.endLineNumber,e.endColumn)}getStartPosition(){return Jn.getStartPosition(this)}static getStartPosition(e){return new J(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new Jn(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new Jn(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return Jn.collapseToStart(this)}static collapseToStart(e){return new Jn(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return Jn.collapseToEnd(this)}static collapseToEnd(e){return new Jn(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new Jn(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,t=e){return new Jn(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new Jn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return!!e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static areOnlyIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber-1||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn-1||t.endLineNumber<e.startLineNumber-1||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn-1)}static compareRangesUsingStarts(e,t){if(e&&t){const r=e.startLineNumber|0,o=t.startLineNumber|0;if(r===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,h=t.endLineNumber|0;if(c===h){const d=e.endColumn|0,g=t.endColumn|0;return d-g}return c-h}return a-l}return r-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},Lt=class Ca extends G{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return Ca.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new Ca(this.startLineNumber,this.startColumn,e,t):new Ca(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new J(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new J(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new Ca(e,t,this.endLineNumber,this.endColumn):new Ca(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new Ca(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new Ca(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new Ca(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new Ca(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return!!e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,r){return r===0?new Ca(e,t,i,n):new Ca(i,n,e,t)}};const _M=Object.create(null);function I(s,e){if(ns(e)){const t=_M[e];if(t===void 0)throw new Error(`${s} references an unknown codicon: ${e}`);e=t}return _M[s]=e,{id:s}}function NX(){return _M}const Ype={add:I("add",6e4),plus:I("plus",6e4),gistNew:I("gist-new",6e4),repoCreate:I("repo-create",6e4),lightbulb:I("lightbulb",60001),lightBulb:I("light-bulb",60001),repo:I("repo",60002),repoDelete:I("repo-delete",60002),gistFork:I("gist-fork",60003),repoForked:I("repo-forked",60003),gitPullRequest:I("git-pull-request",60004),gitPullRequestAbandoned:I("git-pull-request-abandoned",60004),recordKeys:I("record-keys",60005),keyboard:I("keyboard",60005),tag:I("tag",60006),gitPullRequestLabel:I("git-pull-request-label",60006),tagAdd:I("tag-add",60006),tagRemove:I("tag-remove",60006),person:I("person",60007),personFollow:I("person-follow",60007),personOutline:I("person-outline",60007),personFilled:I("person-filled",60007),sourceControl:I("source-control",60008),mirror:I("mirror",60009),mirrorPublic:I("mirror-public",60009),star:I("star",60010),starAdd:I("star-add",60010),starDelete:I("star-delete",60010),starEmpty:I("star-empty",60010),comment:I("comment",60011),commentAdd:I("comment-add",60011),alert:I("alert",60012),warning:I("warning",60012),search:I("search",60013),searchSave:I("search-save",60013),logOut:I("log-out",60014),signOut:I("sign-out",60014),logIn:I("log-in",60015),signIn:I("sign-in",60015),eye:I("eye",60016),eyeUnwatch:I("eye-unwatch",60016),eyeWatch:I("eye-watch",60016),circleFilled:I("circle-filled",60017),primitiveDot:I("primitive-dot",60017),closeDirty:I("close-dirty",60017),debugBreakpoint:I("debug-breakpoint",60017),debugBreakpointDisabled:I("debug-breakpoint-disabled",60017),debugHint:I("debug-hint",60017),terminalDecorationSuccess:I("terminal-decoration-success",60017),primitiveSquare:I("primitive-square",60018),edit:I("edit",60019),pencil:I("pencil",60019),info:I("info",60020),issueOpened:I("issue-opened",60020),gistPrivate:I("gist-private",60021),gitForkPrivate:I("git-fork-private",60021),lock:I("lock",60021),mirrorPrivate:I("mirror-private",60021),close:I("close",60022),removeClose:I("remove-close",60022),x:I("x",60022),repoSync:I("repo-sync",60023),sync:I("sync",60023),clone:I("clone",60024),desktopDownload:I("desktop-download",60024),beaker:I("beaker",60025),microscope:I("microscope",60025),vm:I("vm",60026),deviceDesktop:I("device-desktop",60026),file:I("file",60027),more:I("more",60028),ellipsis:I("ellipsis",60028),kebabHorizontal:I("kebab-horizontal",60028),mailReply:I("mail-reply",60029),reply:I("reply",60029),organization:I("organization",60030),organizationFilled:I("organization-filled",60030),organizationOutline:I("organization-outline",60030),newFile:I("new-file",60031),fileAdd:I("file-add",60031),newFolder:I("new-folder",60032),fileDirectoryCreate:I("file-directory-create",60032),trash:I("trash",60033),trashcan:I("trashcan",60033),history:I("history",60034),clock:I("clock",60034),folder:I("folder",60035),fileDirectory:I("file-directory",60035),symbolFolder:I("symbol-folder",60035),logoGithub:I("logo-github",60036),markGithub:I("mark-github",60036),github:I("github",60036),terminal:I("terminal",60037),console:I("console",60037),repl:I("repl",60037),zap:I("zap",60038),symbolEvent:I("symbol-event",60038),error:I("error",60039),stop:I("stop",60039),variable:I("variable",60040),symbolVariable:I("symbol-variable",60040),array:I("array",60042),symbolArray:I("symbol-array",60042),symbolModule:I("symbol-module",60043),symbolPackage:I("symbol-package",60043),symbolNamespace:I("symbol-namespace",60043),symbolObject:I("symbol-object",60043),symbolMethod:I("symbol-method",60044),symbolFunction:I("symbol-function",60044),symbolConstructor:I("symbol-constructor",60044),symbolBoolean:I("symbol-boolean",60047),symbolNull:I("symbol-null",60047),symbolNumeric:I("symbol-numeric",60048),symbolNumber:I("symbol-number",60048),symbolStructure:I("symbol-structure",60049),symbolStruct:I("symbol-struct",60049),symbolParameter:I("symbol-parameter",60050),symbolTypeParameter:I("symbol-type-parameter",60050),symbolKey:I("symbol-key",60051),symbolText:I("symbol-text",60051),symbolReference:I("symbol-reference",60052),goToFile:I("go-to-file",60052),symbolEnum:I("symbol-enum",60053),symbolValue:I("symbol-value",60053),symbolRuler:I("symbol-ruler",60054),symbolUnit:I("symbol-unit",60054),activateBreakpoints:I("activate-breakpoints",60055),archive:I("archive",60056),arrowBoth:I("arrow-both",60057),arrowDown:I("arrow-down",60058),arrowLeft:I("arrow-left",60059),arrowRight:I("arrow-right",60060),arrowSmallDown:I("arrow-small-down",60061),arrowSmallLeft:I("arrow-small-left",60062),arrowSmallRight:I("arrow-small-right",60063),arrowSmallUp:I("arrow-small-up",60064),arrowUp:I("arrow-up",60065),bell:I("bell",60066),bold:I("bold",60067),book:I("book",60068),bookmark:I("bookmark",60069),debugBreakpointConditionalUnverified:I("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:I("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:I("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:I("debug-breakpoint-data-unverified",60072),debugBreakpointData:I("debug-breakpoint-data",60073),debugBreakpointDataDisabled:I("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:I("debug-breakpoint-log-unverified",60074),debugBreakpointLog:I("debug-breakpoint-log",60075),debugBreakpointLogDisabled:I("debug-breakpoint-log-disabled",60075),briefcase:I("briefcase",60076),broadcast:I("broadcast",60077),browser:I("browser",60078),bug:I("bug",60079),calendar:I("calendar",60080),caseSensitive:I("case-sensitive",60081),check:I("check",60082),checklist:I("checklist",60083),chevronDown:I("chevron-down",60084),chevronLeft:I("chevron-left",60085),chevronRight:I("chevron-right",60086),chevronUp:I("chevron-up",60087),chromeClose:I("chrome-close",60088),chromeMaximize:I("chrome-maximize",60089),chromeMinimize:I("chrome-minimize",60090),chromeRestore:I("chrome-restore",60091),circleOutline:I("circle-outline",60092),circle:I("circle",60092),debugBreakpointUnverified:I("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:I("terminal-decoration-incomplete",60092),circleSlash:I("circle-slash",60093),circuitBoard:I("circuit-board",60094),clearAll:I("clear-all",60095),clippy:I("clippy",60096),closeAll:I("close-all",60097),cloudDownload:I("cloud-download",60098),cloudUpload:I("cloud-upload",60099),code:I("code",60100),collapseAll:I("collapse-all",60101),colorMode:I("color-mode",60102),commentDiscussion:I("comment-discussion",60103),creditCard:I("credit-card",60105),dash:I("dash",60108),dashboard:I("dashboard",60109),database:I("database",60110),debugContinue:I("debug-continue",60111),debugDisconnect:I("debug-disconnect",60112),debugPause:I("debug-pause",60113),debugRestart:I("debug-restart",60114),debugStart:I("debug-start",60115),debugStepInto:I("debug-step-into",60116),debugStepOut:I("debug-step-out",60117),debugStepOver:I("debug-step-over",60118),debugStop:I("debug-stop",60119),debug:I("debug",60120),deviceCameraVideo:I("device-camera-video",60121),deviceCamera:I("device-camera",60122),deviceMobile:I("device-mobile",60123),diffAdded:I("diff-added",60124),diffIgnored:I("diff-ignored",60125),diffModified:I("diff-modified",60126),diffRemoved:I("diff-removed",60127),diffRenamed:I("diff-renamed",60128),diff:I("diff",60129),diffSidebyside:I("diff-sidebyside",60129),discard:I("discard",60130),editorLayout:I("editor-layout",60131),emptyWindow:I("empty-window",60132),exclude:I("exclude",60133),extensions:I("extensions",60134),eyeClosed:I("eye-closed",60135),fileBinary:I("file-binary",60136),fileCode:I("file-code",60137),fileMedia:I("file-media",60138),filePdf:I("file-pdf",60139),fileSubmodule:I("file-submodule",60140),fileSymlinkDirectory:I("file-symlink-directory",60141),fileSymlinkFile:I("file-symlink-file",60142),fileZip:I("file-zip",60143),files:I("files",60144),filter:I("filter",60145),flame:I("flame",60146),foldDown:I("fold-down",60147),foldUp:I("fold-up",60148),fold:I("fold",60149),folderActive:I("folder-active",60150),folderOpened:I("folder-opened",60151),gear:I("gear",60152),gift:I("gift",60153),gistSecret:I("gist-secret",60154),gist:I("gist",60155),gitCommit:I("git-commit",60156),gitCompare:I("git-compare",60157),compareChanges:I("compare-changes",60157),gitMerge:I("git-merge",60158),githubAction:I("github-action",60159),githubAlt:I("github-alt",60160),globe:I("globe",60161),grabber:I("grabber",60162),graph:I("graph",60163),gripper:I("gripper",60164),heart:I("heart",60165),home:I("home",60166),horizontalRule:I("horizontal-rule",60167),hubot:I("hubot",60168),inbox:I("inbox",60169),issueReopened:I("issue-reopened",60171),issues:I("issues",60172),italic:I("italic",60173),jersey:I("jersey",60174),json:I("json",60175),kebabVertical:I("kebab-vertical",60176),key:I("key",60177),law:I("law",60178),lightbulbAutofix:I("lightbulb-autofix",60179),linkExternal:I("link-external",60180),link:I("link",60181),listOrdered:I("list-ordered",60182),listUnordered:I("list-unordered",60183),liveShare:I("live-share",60184),loading:I("loading",60185),location:I("location",60186),mailRead:I("mail-read",60187),mail:I("mail",60188),markdown:I("markdown",60189),megaphone:I("megaphone",60190),mention:I("mention",60191),milestone:I("milestone",60192),gitPullRequestMilestone:I("git-pull-request-milestone",60192),mortarBoard:I("mortar-board",60193),move:I("move",60194),multipleWindows:I("multiple-windows",60195),mute:I("mute",60196),noNewline:I("no-newline",60197),note:I("note",60198),octoface:I("octoface",60199),openPreview:I("open-preview",60200),package:I("package",60201),paintcan:I("paintcan",60202),pin:I("pin",60203),play:I("play",60204),run:I("run",60204),plug:I("plug",60205),preserveCase:I("preserve-case",60206),preview:I("preview",60207),project:I("project",60208),pulse:I("pulse",60209),question:I("question",60210),quote:I("quote",60211),radioTower:I("radio-tower",60212),reactions:I("reactions",60213),references:I("references",60214),refresh:I("refresh",60215),regex:I("regex",60216),remoteExplorer:I("remote-explorer",60217),remote:I("remote",60218),remove:I("remove",60219),replaceAll:I("replace-all",60220),replace:I("replace",60221),repoClone:I("repo-clone",60222),repoForcePush:I("repo-force-push",60223),repoPull:I("repo-pull",60224),repoPush:I("repo-push",60225),report:I("report",60226),requestChanges:I("request-changes",60227),rocket:I("rocket",60228),rootFolderOpened:I("root-folder-opened",60229),rootFolder:I("root-folder",60230),rss:I("rss",60231),ruby:I("ruby",60232),saveAll:I("save-all",60233),saveAs:I("save-as",60234),save:I("save",60235),screenFull:I("screen-full",60236),screenNormal:I("screen-normal",60237),searchStop:I("search-stop",60238),server:I("server",60240),settingsGear:I("settings-gear",60241),settings:I("settings",60242),shield:I("shield",60243),smiley:I("smiley",60244),sortPrecedence:I("sort-precedence",60245),splitHorizontal:I("split-horizontal",60246),splitVertical:I("split-vertical",60247),squirrel:I("squirrel",60248),starFull:I("star-full",60249),starHalf:I("star-half",60250),symbolClass:I("symbol-class",60251),symbolColor:I("symbol-color",60252),symbolConstant:I("symbol-constant",60253),symbolEnumMember:I("symbol-enum-member",60254),symbolField:I("symbol-field",60255),symbolFile:I("symbol-file",60256),symbolInterface:I("symbol-interface",60257),symbolKeyword:I("symbol-keyword",60258),symbolMisc:I("symbol-misc",60259),symbolOperator:I("symbol-operator",60260),symbolProperty:I("symbol-property",60261),wrench:I("wrench",60261),wrenchSubaction:I("wrench-subaction",60261),symbolSnippet:I("symbol-snippet",60262),tasklist:I("tasklist",60263),telescope:I("telescope",60264),textSize:I("text-size",60265),threeBars:I("three-bars",60266),thumbsdown:I("thumbsdown",60267),thumbsup:I("thumbsup",60268),tools:I("tools",60269),triangleDown:I("triangle-down",60270),triangleLeft:I("triangle-left",60271),triangleRight:I("triangle-right",60272),triangleUp:I("triangle-up",60273),twitter:I("twitter",60274),unfold:I("unfold",60275),unlock:I("unlock",60276),unmute:I("unmute",60277),unverified:I("unverified",60278),verified:I("verified",60279),versions:I("versions",60280),vmActive:I("vm-active",60281),vmOutline:I("vm-outline",60282),vmRunning:I("vm-running",60283),watch:I("watch",60284),whitespace:I("whitespace",60285),wholeWord:I("whole-word",60286),window:I("window",60287),wordWrap:I("word-wrap",60288),zoomIn:I("zoom-in",60289),zoomOut:I("zoom-out",60290),listFilter:I("list-filter",60291),listFlat:I("list-flat",60292),listSelection:I("list-selection",60293),selection:I("selection",60293),listTree:I("list-tree",60294),debugBreakpointFunctionUnverified:I("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:I("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:I("debug-breakpoint-function-disabled",60296),debugStackframeActive:I("debug-stackframe-active",60297),circleSmallFilled:I("circle-small-filled",60298),debugStackframeDot:I("debug-stackframe-dot",60298),terminalDecorationMark:I("terminal-decoration-mark",60298),debugStackframe:I("debug-stackframe",60299),debugStackframeFocused:I("debug-stackframe-focused",60299),debugBreakpointUnsupported:I("debug-breakpoint-unsupported",60300),symbolString:I("symbol-string",60301),debugReverseContinue:I("debug-reverse-continue",60302),debugStepBack:I("debug-step-back",60303),debugRestartFrame:I("debug-restart-frame",60304),debugAlt:I("debug-alt",60305),callIncoming:I("call-incoming",60306),callOutgoing:I("call-outgoing",60307),menu:I("menu",60308),expandAll:I("expand-all",60309),feedback:I("feedback",60310),gitPullRequestReviewer:I("git-pull-request-reviewer",60310),groupByRefType:I("group-by-ref-type",60311),ungroupByRefType:I("ungroup-by-ref-type",60312),account:I("account",60313),gitPullRequestAssignee:I("git-pull-request-assignee",60313),bellDot:I("bell-dot",60314),debugConsole:I("debug-console",60315),library:I("library",60316),output:I("output",60317),runAll:I("run-all",60318),syncIgnored:I("sync-ignored",60319),pinned:I("pinned",60320),githubInverted:I("github-inverted",60321),serverProcess:I("server-process",60322),serverEnvironment:I("server-environment",60323),pass:I("pass",60324),issueClosed:I("issue-closed",60324),stopCircle:I("stop-circle",60325),playCircle:I("play-circle",60326),record:I("record",60327),debugAltSmall:I("debug-alt-small",60328),vmConnect:I("vm-connect",60329),cloud:I("cloud",60330),merge:I("merge",60331),export:I("export",60332),graphLeft:I("graph-left",60333),magnet:I("magnet",60334),notebook:I("notebook",60335),redo:I("redo",60336),checkAll:I("check-all",60337),pinnedDirty:I("pinned-dirty",60338),passFilled:I("pass-filled",60339),circleLargeFilled:I("circle-large-filled",60340),circleLarge:I("circle-large",60341),circleLargeOutline:I("circle-large-outline",60341),combine:I("combine",60342),gather:I("gather",60342),table:I("table",60343),variableGroup:I("variable-group",60344),typeHierarchy:I("type-hierarchy",60345),typeHierarchySub:I("type-hierarchy-sub",60346),typeHierarchySuper:I("type-hierarchy-super",60347),gitPullRequestCreate:I("git-pull-request-create",60348),runAbove:I("run-above",60349),runBelow:I("run-below",60350),notebookTemplate:I("notebook-template",60351),debugRerun:I("debug-rerun",60352),workspaceTrusted:I("workspace-trusted",60353),workspaceUntrusted:I("workspace-untrusted",60354),workspaceUnknown:I("workspace-unknown",60355),terminalCmd:I("terminal-cmd",60356),terminalDebian:I("terminal-debian",60357),terminalLinux:I("terminal-linux",60358),terminalPowershell:I("terminal-powershell",60359),terminalTmux:I("terminal-tmux",60360),terminalUbuntu:I("terminal-ubuntu",60361),terminalBash:I("terminal-bash",60362),arrowSwap:I("arrow-swap",60363),copy:I("copy",60364),personAdd:I("person-add",60365),filterFilled:I("filter-filled",60366),wand:I("wand",60367),debugLineByLine:I("debug-line-by-line",60368),inspect:I("inspect",60369),layers:I("layers",60370),layersDot:I("layers-dot",60371),layersActive:I("layers-active",60372),compass:I("compass",60373),compassDot:I("compass-dot",60374),compassActive:I("compass-active",60375),azure:I("azure",60376),issueDraft:I("issue-draft",60377),gitPullRequestClosed:I("git-pull-request-closed",60378),gitPullRequestDraft:I("git-pull-request-draft",60379),debugAll:I("debug-all",60380),debugCoverage:I("debug-coverage",60381),runErrors:I("run-errors",60382),folderLibrary:I("folder-library",60383),debugContinueSmall:I("debug-continue-small",60384),beakerStop:I("beaker-stop",60385),graphLine:I("graph-line",60386),graphScatter:I("graph-scatter",60387),pieChart:I("pie-chart",60388),bracket:I("bracket",60175),bracketDot:I("bracket-dot",60389),bracketError:I("bracket-error",60390),lockSmall:I("lock-small",60391),azureDevops:I("azure-devops",60392),verifiedFilled:I("verified-filled",60393),newline:I("newline",60394),layout:I("layout",60395),layoutActivitybarLeft:I("layout-activitybar-left",60396),layoutActivitybarRight:I("layout-activitybar-right",60397),layoutPanelLeft:I("layout-panel-left",60398),layoutPanelCenter:I("layout-panel-center",60399),layoutPanelJustify:I("layout-panel-justify",60400),layoutPanelRight:I("layout-panel-right",60401),layoutPanel:I("layout-panel",60402),layoutSidebarLeft:I("layout-sidebar-left",60403),layoutSidebarRight:I("layout-sidebar-right",60404),layoutStatusbar:I("layout-statusbar",60405),layoutMenubar:I("layout-menubar",60406),layoutCentered:I("layout-centered",60407),target:I("target",60408),indent:I("indent",60409),recordSmall:I("record-small",60410),errorSmall:I("error-small",60411),terminalDecorationError:I("terminal-decoration-error",60411),arrowCircleDown:I("arrow-circle-down",60412),arrowCircleLeft:I("arrow-circle-left",60413),arrowCircleRight:I("arrow-circle-right",60414),arrowCircleUp:I("arrow-circle-up",60415),layoutSidebarRightOff:I("layout-sidebar-right-off",60416),layoutPanelOff:I("layout-panel-off",60417),layoutSidebarLeftOff:I("layout-sidebar-left-off",60418),blank:I("blank",60419),heartFilled:I("heart-filled",60420),map:I("map",60421),mapHorizontal:I("map-horizontal",60421),foldHorizontal:I("fold-horizontal",60421),mapFilled:I("map-filled",60422),mapHorizontalFilled:I("map-horizontal-filled",60422),foldHorizontalFilled:I("fold-horizontal-filled",60422),circleSmall:I("circle-small",60423),bellSlash:I("bell-slash",60424),bellSlashDot:I("bell-slash-dot",60425),commentUnresolved:I("comment-unresolved",60426),gitPullRequestGoToChanges:I("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:I("git-pull-request-new-changes",60428),searchFuzzy:I("search-fuzzy",60429),commentDraft:I("comment-draft",60430),send:I("send",60431),sparkle:I("sparkle",60432),insert:I("insert",60433),mic:I("mic",60434),thumbsdownFilled:I("thumbsdown-filled",60435),thumbsupFilled:I("thumbsup-filled",60436),coffee:I("coffee",60437),snake:I("snake",60438),game:I("game",60439),vr:I("vr",60440),chip:I("chip",60441),piano:I("piano",60442),music:I("music",60443),micFilled:I("mic-filled",60444),repoFetch:I("repo-fetch",60445),copilot:I("copilot",60446),lightbulbSparkle:I("lightbulb-sparkle",60447),robot:I("robot",60448),sparkleFilled:I("sparkle-filled",60449),diffSingle:I("diff-single",60450),diffMultiple:I("diff-multiple",60451),surroundWith:I("surround-with",60452),share:I("share",60453),gitStash:I("git-stash",60454),gitStashApply:I("git-stash-apply",60455),gitStashPop:I("git-stash-pop",60456),vscode:I("vscode",60457),vscodeInsiders:I("vscode-insiders",60458),codeOss:I("code-oss",60459),runCoverage:I("run-coverage",60460),runAllCoverage:I("run-all-coverage",60461),coverage:I("coverage",60462),githubProject:I("github-project",60463),mapVertical:I("map-vertical",60464),foldVertical:I("fold-vertical",60464),mapVerticalFilled:I("map-vertical-filled",60465),foldVerticalFilled:I("fold-vertical-filled",60465),goToSearch:I("go-to-search",60466),percentage:I("percentage",60467),sortPercentage:I("sort-percentage",60467),attach:I("attach",60468),goToEditingSession:I("go-to-editing-session",60469),editSession:I("edit-session",60470),codeReview:I("code-review",60471),copilotWarning:I("copilot-warning",60472),python:I("python",60473),copilotLarge:I("copilot-large",60474),copilotWarningLarge:I("copilot-warning-large",60475),keyboardTab:I("keyboard-tab",60476),copilotBlocked:I("copilot-blocked",60477),copilotNotConnected:I("copilot-not-connected",60478),flag:I("flag",60479),lightbulbEmpty:I("lightbulb-empty",60480),symbolMethodArrow:I("symbol-method-arrow",60481),copilotUnavailable:I("copilot-unavailable",60482),repoPinned:I("repo-pinned",60483),keyboardTabAbove:I("keyboard-tab-above",60484),keyboardTabBelow:I("keyboard-tab-below",60485),gitPullRequestDone:I("git-pull-request-done",60486),mcp:I("mcp",60487),extensionsLarge:I("extensions-large",60488),layoutPanelDock:I("layout-panel-dock",60489),layoutSidebarLeftDock:I("layout-sidebar-left-dock",60490),layoutSidebarRightDock:I("layout-sidebar-right-dock",60491),copilotInProgress:I("copilot-in-progress",60492),copilotError:I("copilot-error",60493),copilotSuccess:I("copilot-success",60494),chatSparkle:I("chat-sparkle",60495),searchSparkle:I("search-sparkle",60496),editSparkle:I("edit-sparkle",60497),copilotSnooze:I("copilot-snooze",60498),sendToRemoteAgent:I("send-to-remote-agent",60499),commentDiscussionSparkle:I("comment-discussion-sparkle",60500),chatSparkleWarning:I("chat-sparkle-warning",60501),chatSparkleError:I("chat-sparkle-error",60502),collection:I("collection",60503),newCollection:I("new-collection",60504),thinking:I("thinking",60505),build:I("build",60506),commentDiscussionQuote:I("comment-discussion-quote",60507),cursor:I("cursor",60508),eraser:I("eraser",60509),fileText:I("file-text",60510),gitLens:I("git-lens",60511),quotes:I("quotes",60512),rename:I("rename",60513),runWithDeps:I("run-with-deps",60514),debugConnected:I("debug-connected",60515),strikethrough:I("strikethrough",60516),openInProduct:I("open-in-product",60517),indexZero:I("index-zero",60518),agent:I("agent",60519),editCode:I("edit-code",60520),repoSelected:I("repo-selected",60521),skip:I("skip",60522),mergeInto:I("merge-into",60523),gitBranchChanges:I("git-branch-changes",60524),gitBranchStagedChanges:I("git-branch-staged-changes",60525),gitBranchConflicts:I("git-branch-conflicts",60526),gitBranch:I("git-branch",60527),gitBranchCreate:I("git-branch-create",60527),gitBranchDelete:I("git-branch-delete",60527),searchLarge:I("search-large",60528),terminalGitBash:I("terminal-git-bash",60529)},Qpe={dialogError:I("dialog-error","error"),dialogWarning:I("dialog-warning","warning"),dialogInfo:I("dialog-info","info"),dialogClose:I("dialog-close","close"),treeItemExpanded:I("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:I("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:I("tree-filter-on-type-off","list-selection"),treeFilterClear:I("tree-filter-clear","close"),treeItemLoading:I("tree-item-loading","loading"),menuSelection:I("menu-selection","check"),menuSubmenu:I("menu-submenu","chevron-right"),menuBarMore:I("menubar-more","more"),scrollbarButtonLeft:I("scrollbar-button-left","triangle-left"),scrollbarButtonRight:I("scrollbar-button-right","triangle-right"),scrollbarButtonUp:I("scrollbar-button-up","triangle-up"),scrollbarButtonDown:I("scrollbar-button-down","triangle-down"),toolBarMore:I("toolbar-more","more"),quickInputBack:I("quick-input-back","arrow-left"),dropDownButton:I("drop-down-button",60084),symbolCustomColor:I("symbol-customcolor",60252),exportIcon:I("export",60332),workspaceUnspecified:I("workspace-unspecified",60355),newLine:I("newline",60394),thumbsDownFilled:I("thumbsdown-filled",60435),thumbsUpFilled:I("thumbsup-filled",60436),gitFetch:I("git-fetch",60445),lightbulbSparkleAutofix:I("lightbulb-sparkle-autofix",60447),debugBreakpointPending:I("debug-breakpoint-pending",60377)},Ae={...Ype,...Qpe};let Xpe=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),qe(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var n;(n=this._factories.get(e))==null||n.dispose();const i=new Zpe(this,e,t);return this._factories.set(e,i),qe(()=>{const r=this._factories.get(e);!r||r!==i||(this._factories.delete(e),r.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class Zpe extends le{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}let yv=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class V6{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class aD{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var XW;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(XW||(XW={}));var ZW;(function(s){const e=new Map;e.set(0,Ae.symbolMethod),e.set(1,Ae.symbolFunction),e.set(2,Ae.symbolConstructor),e.set(3,Ae.symbolField),e.set(4,Ae.symbolVariable),e.set(5,Ae.symbolClass),e.set(6,Ae.symbolStruct),e.set(7,Ae.symbolInterface),e.set(8,Ae.symbolModule),e.set(9,Ae.symbolProperty),e.set(10,Ae.symbolEvent),e.set(11,Ae.symbolOperator),e.set(12,Ae.symbolUnit),e.set(13,Ae.symbolValue),e.set(15,Ae.symbolEnum),e.set(14,Ae.symbolConstant),e.set(15,Ae.symbolEnum),e.set(16,Ae.symbolEnumMember),e.set(17,Ae.symbolKeyword),e.set(28,Ae.symbolSnippet),e.set(18,Ae.symbolText),e.set(19,Ae.symbolColor),e.set(20,Ae.symbolFile),e.set(21,Ae.symbolReference),e.set(22,Ae.symbolCustomColor),e.set(23,Ae.symbolFolder),e.set(24,Ae.symbolTypeParameter),e.set(25,Ae.account),e.set(26,Ae.issues),e.set(27,Ae.tools);function t(o){let a=e.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=Ae.symbolProperty),a}s.toIcon=t;function i(o){switch(o){case 0:return v(728,"Method");case 1:return v(729,"Function");case 2:return v(730,"Constructor");case 3:return v(731,"Field");case 4:return v(732,"Variable");case 5:return v(733,"Class");case 6:return v(734,"Struct");case 7:return v(735,"Interface");case 8:return v(736,"Module");case 9:return v(737,"Property");case 10:return v(738,"Event");case 11:return v(739,"Operator");case 12:return v(740,"Unit");case 13:return v(741,"Value");case 14:return v(742,"Constant");case 15:return v(743,"Enum");case 16:return v(744,"Enum Member");case 17:return v(745,"Keyword");case 18:return v(746,"Text");case 19:return v(747,"Color");case 20:return v(748,"File");case 21:return v(749,"Reference");case 22:return v(750,"Custom Color");case 23:return v(751,"Folder");case 24:return v(752,"Type Parameter");case 25:return v(753,"User");case 26:return v(754,"Issue");case 27:return v(755,"Tool");case 28:return v(756,"Snippet");default:return""}}s.toLabel=i;const n=new Map;n.set("method",0),n.set("function",1),n.set("constructor",2),n.set("field",3),n.set("variable",4),n.set("class",5),n.set("struct",6),n.set("interface",7),n.set("module",8),n.set("property",9),n.set("event",10),n.set("operator",11),n.set("unit",12),n.set("value",13),n.set("constant",14),n.set("enum",15),n.set("enum-member",16),n.set("enumMember",16),n.set("keyword",17),n.set("snippet",28),n.set("text",18),n.set("color",19),n.set("file",20),n.set("reference",21),n.set("customcolor",22),n.set("folder",23),n.set("type-parameter",24),n.set("typeParameter",24),n.set("account",25),n.set("issue",26),n.set("tool",27);function r(o,a){let l=n.get(o);return typeof l>"u"&&!a&&(l=9),l}s.fromString=r})(ZW||(ZW={}));var JW;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(JW||(JW={}));class Jpe{constructor(e,t,i,n){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=n}equals(e){return G.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var ez;(function(s){s[s.Code=1]="Code",s[s.Label=2]="Label"})(ez||(ez={}));var tz;(function(s){s[s.Accepted=0]="Accepted",s[s.Rejected=1]="Rejected",s[s.Ignored=2]="Ignored"})(tz||(tz={}));var iz;(function(s){s[s.Automatic=0]="Automatic",s[s.PasteAs=1]="PasteAs"})(iz||(iz={}));var nz;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(nz||(nz={}));var sz;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(sz||(sz={}));v(757,"array"),v(758,"boolean"),v(759,"class"),v(760,"constant"),v(761,"constructor"),v(762,"enumeration"),v(763,"enumeration member"),v(764,"event"),v(765,"field"),v(766,"file"),v(767,"function"),v(768,"interface"),v(769,"key"),v(770,"method"),v(771,"module"),v(772,"namespace"),v(773,"null"),v(774,"number"),v(775,"object"),v(776,"operator"),v(777,"package"),v(778,"property"),v(779,"string"),v(780,"struct"),v(781,"type parameter"),v(782,"variable");var bM;(function(s){const e=new Map;e.set(0,Ae.symbolFile),e.set(1,Ae.symbolModule),e.set(2,Ae.symbolNamespace),e.set(3,Ae.symbolPackage),e.set(4,Ae.symbolClass),e.set(5,Ae.symbolMethod),e.set(6,Ae.symbolProperty),e.set(7,Ae.symbolField),e.set(8,Ae.symbolConstructor),e.set(9,Ae.symbolEnum),e.set(10,Ae.symbolInterface),e.set(11,Ae.symbolFunction),e.set(12,Ae.symbolVariable),e.set(13,Ae.symbolConstant),e.set(14,Ae.symbolString),e.set(15,Ae.symbolNumber),e.set(16,Ae.symbolBoolean),e.set(17,Ae.symbolArray),e.set(18,Ae.symbolObject),e.set(19,Ae.symbolKey),e.set(20,Ae.symbolNull),e.set(21,Ae.symbolEnumMember),e.set(22,Ae.symbolStruct),e.set(23,Ae.symbolEvent),e.set(24,Ae.symbolOperator),e.set(25,Ae.symbolTypeParameter);function t(r){let o=e.get(r);return o||(console.info("No codicon found for SymbolKind "+r),o=Ae.symbolProperty),o}s.toIcon=t;const i=new Map;i.set(0,20),i.set(1,8),i.set(2,8),i.set(3,8),i.set(4,5),i.set(5,0),i.set(6,9),i.set(7,3),i.set(8,2),i.set(9,15),i.set(10,7),i.set(11,1),i.set(12,4),i.set(13,14),i.set(14,18),i.set(15,13),i.set(16,13),i.set(17,13),i.set(18,13),i.set(19,17),i.set(20,13),i.set(21,16),i.set(22,6),i.set(23,10),i.set(24,11),i.set(25,24);function n(r){let o=i.get(r);return o===void 0&&(console.info("No completion kind found for SymbolKind "+r),o=20),o}s.toCompletionKind=n})(bM||(bM={}));const Sa=class Sa{static fromValue(e){switch(e){case"comment":return Sa.Comment;case"imports":return Sa.Imports;case"region":return Sa.Region}return new Sa(e)}constructor(e){this.value=e}};Sa.Comment=new Sa("comment"),Sa.Imports=new Sa("imports"),Sa.Region=new Sa("region");let wM=Sa;var rz;(function(s){s[s.AIGenerated=1]="AIGenerated"})(rz||(rz={}));var oz;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(oz||(oz={}));var az;(function(s){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}s.is=e})(az||(az={}));var lz;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(lz||(lz={}));class e_e{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const hn=new Xpe;var vM;(function(s){s[s.Unknown=0]="Unknown",s[s.Disabled=1]="Disabled",s[s.Enabled=2]="Enabled"})(vM||(vM={}));var CM;(function(s){s[s.Invoke=1]="Invoke",s[s.Auto=2]="Auto"})(CM||(CM={}));var yM;(function(s){s[s.None=0]="None",s[s.KeepWhitespace=1]="KeepWhitespace",s[s.InsertAsSnippet=4]="InsertAsSnippet"})(yM||(yM={}));var SM;(function(s){s[s.Method=0]="Method",s[s.Function=1]="Function",s[s.Constructor=2]="Constructor",s[s.Field=3]="Field",s[s.Variable=4]="Variable",s[s.Class=5]="Class",s[s.Struct=6]="Struct",s[s.Interface=7]="Interface",s[s.Module=8]="Module",s[s.Property=9]="Property",s[s.Event=10]="Event",s[s.Operator=11]="Operator",s[s.Unit=12]="Unit",s[s.Value=13]="Value",s[s.Constant=14]="Constant",s[s.Enum=15]="Enum",s[s.EnumMember=16]="EnumMember",s[s.Keyword=17]="Keyword",s[s.Text=18]="Text",s[s.Color=19]="Color",s[s.File=20]="File",s[s.Reference=21]="Reference",s[s.Customcolor=22]="Customcolor",s[s.Folder=23]="Folder",s[s.TypeParameter=24]="TypeParameter",s[s.User=25]="User",s[s.Issue=26]="Issue",s[s.Tool=27]="Tool",s[s.Snippet=28]="Snippet"})(SM||(SM={}));var xM;(function(s){s[s.Deprecated=1]="Deprecated"})(xM||(xM={}));var LM;(function(s){s[s.Invoke=0]="Invoke",s[s.TriggerCharacter=1]="TriggerCharacter",s[s.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(LM||(LM={}));var kM;(function(s){s[s.EXACT=0]="EXACT",s[s.ABOVE=1]="ABOVE",s[s.BELOW=2]="BELOW"})(kM||(kM={}));var EM;(function(s){s[s.NotSet=0]="NotSet",s[s.ContentFlush=1]="ContentFlush",s[s.RecoverFromMarkers=2]="RecoverFromMarkers",s[s.Explicit=3]="Explicit",s[s.Paste=4]="Paste",s[s.Undo=5]="Undo",s[s.Redo=6]="Redo"})(EM||(EM={}));var DM;(function(s){s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(DM||(DM={}));var TM;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(TM||(TM={}));var NM;(function(s){s[s.None=0]="None",s[s.Keep=1]="Keep",s[s.Brackets=2]="Brackets",s[s.Advanced=3]="Advanced",s[s.Full=4]="Full"})(NM||(NM={}));var IM;(function(s){s[s.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",s[s.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",s[s.accessibilitySupport=2]="accessibilitySupport",s[s.accessibilityPageSize=3]="accessibilityPageSize",s[s.allowOverflow=4]="allowOverflow",s[s.allowVariableLineHeights=5]="allowVariableLineHeights",s[s.allowVariableFonts=6]="allowVariableFonts",s[s.allowVariableFontsInAccessibilityMode=7]="allowVariableFontsInAccessibilityMode",s[s.ariaLabel=8]="ariaLabel",s[s.ariaRequired=9]="ariaRequired",s[s.autoClosingBrackets=10]="autoClosingBrackets",s[s.autoClosingComments=11]="autoClosingComments",s[s.screenReaderAnnounceInlineSuggestion=12]="screenReaderAnnounceInlineSuggestion",s[s.autoClosingDelete=13]="autoClosingDelete",s[s.autoClosingOvertype=14]="autoClosingOvertype",s[s.autoClosingQuotes=15]="autoClosingQuotes",s[s.autoIndent=16]="autoIndent",s[s.autoIndentOnPaste=17]="autoIndentOnPaste",s[s.autoIndentOnPasteWithinString=18]="autoIndentOnPasteWithinString",s[s.automaticLayout=19]="automaticLayout",s[s.autoSurround=20]="autoSurround",s[s.bracketPairColorization=21]="bracketPairColorization",s[s.guides=22]="guides",s[s.codeLens=23]="codeLens",s[s.codeLensFontFamily=24]="codeLensFontFamily",s[s.codeLensFontSize=25]="codeLensFontSize",s[s.colorDecorators=26]="colorDecorators",s[s.colorDecoratorsLimit=27]="colorDecoratorsLimit",s[s.columnSelection=28]="columnSelection",s[s.comments=29]="comments",s[s.contextmenu=30]="contextmenu",s[s.copyWithSyntaxHighlighting=31]="copyWithSyntaxHighlighting",s[s.cursorBlinking=32]="cursorBlinking",s[s.cursorSmoothCaretAnimation=33]="cursorSmoothCaretAnimation",s[s.cursorStyle=34]="cursorStyle",s[s.cursorSurroundingLines=35]="cursorSurroundingLines",s[s.cursorSurroundingLinesStyle=36]="cursorSurroundingLinesStyle",s[s.cursorWidth=37]="cursorWidth",s[s.cursorHeight=38]="cursorHeight",s[s.disableLayerHinting=39]="disableLayerHinting",s[s.disableMonospaceOptimizations=40]="disableMonospaceOptimizations",s[s.domReadOnly=41]="domReadOnly",s[s.dragAndDrop=42]="dragAndDrop",s[s.dropIntoEditor=43]="dropIntoEditor",s[s.editContext=44]="editContext",s[s.emptySelectionClipboard=45]="emptySelectionClipboard",s[s.experimentalGpuAcceleration=46]="experimentalGpuAcceleration",s[s.experimentalWhitespaceRendering=47]="experimentalWhitespaceRendering",s[s.extraEditorClassName=48]="extraEditorClassName",s[s.fastScrollSensitivity=49]="fastScrollSensitivity",s[s.find=50]="find",s[s.fixedOverflowWidgets=51]="fixedOverflowWidgets",s[s.folding=52]="folding",s[s.foldingStrategy=53]="foldingStrategy",s[s.foldingHighlight=54]="foldingHighlight",s[s.foldingImportsByDefault=55]="foldingImportsByDefault",s[s.foldingMaximumRegions=56]="foldingMaximumRegions",s[s.unfoldOnClickAfterEndOfLine=57]="unfoldOnClickAfterEndOfLine",s[s.fontFamily=58]="fontFamily",s[s.fontInfo=59]="fontInfo",s[s.fontLigatures=60]="fontLigatures",s[s.fontSize=61]="fontSize",s[s.fontWeight=62]="fontWeight",s[s.fontVariations=63]="fontVariations",s[s.formatOnPaste=64]="formatOnPaste",s[s.formatOnType=65]="formatOnType",s[s.glyphMargin=66]="glyphMargin",s[s.gotoLocation=67]="gotoLocation",s[s.hideCursorInOverviewRuler=68]="hideCursorInOverviewRuler",s[s.hover=69]="hover",s[s.inDiffEditor=70]="inDiffEditor",s[s.inlineSuggest=71]="inlineSuggest",s[s.letterSpacing=72]="letterSpacing",s[s.lightbulb=73]="lightbulb",s[s.lineDecorationsWidth=74]="lineDecorationsWidth",s[s.lineHeight=75]="lineHeight",s[s.lineNumbers=76]="lineNumbers",s[s.lineNumbersMinChars=77]="lineNumbersMinChars",s[s.linkedEditing=78]="linkedEditing",s[s.links=79]="links",s[s.matchBrackets=80]="matchBrackets",s[s.minimap=81]="minimap",s[s.mouseStyle=82]="mouseStyle",s[s.mouseWheelScrollSensitivity=83]="mouseWheelScrollSensitivity",s[s.mouseWheelZoom=84]="mouseWheelZoom",s[s.multiCursorMergeOverlapping=85]="multiCursorMergeOverlapping",s[s.multiCursorModifier=86]="multiCursorModifier",s[s.mouseMiddleClickAction=87]="mouseMiddleClickAction",s[s.multiCursorPaste=88]="multiCursorPaste",s[s.multiCursorLimit=89]="multiCursorLimit",s[s.occurrencesHighlight=90]="occurrencesHighlight",s[s.occurrencesHighlightDelay=91]="occurrencesHighlightDelay",s[s.overtypeCursorStyle=92]="overtypeCursorStyle",s[s.overtypeOnPaste=93]="overtypeOnPaste",s[s.overviewRulerBorder=94]="overviewRulerBorder",s[s.overviewRulerLanes=95]="overviewRulerLanes",s[s.padding=96]="padding",s[s.pasteAs=97]="pasteAs",s[s.parameterHints=98]="parameterHints",s[s.peekWidgetDefaultFocus=99]="peekWidgetDefaultFocus",s[s.placeholder=100]="placeholder",s[s.definitionLinkOpensInPeek=101]="definitionLinkOpensInPeek",s[s.quickSuggestions=102]="quickSuggestions",s[s.quickSuggestionsDelay=103]="quickSuggestionsDelay",s[s.readOnly=104]="readOnly",s[s.readOnlyMessage=105]="readOnlyMessage",s[s.renameOnType=106]="renameOnType",s[s.renderRichScreenReaderContent=107]="renderRichScreenReaderContent",s[s.renderControlCharacters=108]="renderControlCharacters",s[s.renderFinalNewline=109]="renderFinalNewline",s[s.renderLineHighlight=110]="renderLineHighlight",s[s.renderLineHighlightOnlyWhenFocus=111]="renderLineHighlightOnlyWhenFocus",s[s.renderValidationDecorations=112]="renderValidationDecorations",s[s.renderWhitespace=113]="renderWhitespace",s[s.revealHorizontalRightPadding=114]="revealHorizontalRightPadding",s[s.roundedSelection=115]="roundedSelection",s[s.rulers=116]="rulers",s[s.scrollbar=117]="scrollbar",s[s.scrollBeyondLastColumn=118]="scrollBeyondLastColumn",s[s.scrollBeyondLastLine=119]="scrollBeyondLastLine",s[s.scrollPredominantAxis=120]="scrollPredominantAxis",s[s.selectionClipboard=121]="selectionClipboard",s[s.selectionHighlight=122]="selectionHighlight",s[s.selectionHighlightMaxLength=123]="selectionHighlightMaxLength",s[s.selectionHighlightMultiline=124]="selectionHighlightMultiline",s[s.selectOnLineNumbers=125]="selectOnLineNumbers",s[s.showFoldingControls=126]="showFoldingControls",s[s.showUnused=127]="showUnused",s[s.snippetSuggestions=128]="snippetSuggestions",s[s.smartSelect=129]="smartSelect",s[s.smoothScrolling=130]="smoothScrolling",s[s.stickyScroll=131]="stickyScroll",s[s.stickyTabStops=132]="stickyTabStops",s[s.stopRenderingLineAfter=133]="stopRenderingLineAfter",s[s.suggest=134]="suggest",s[s.suggestFontSize=135]="suggestFontSize",s[s.suggestLineHeight=136]="suggestLineHeight",s[s.suggestOnTriggerCharacters=137]="suggestOnTriggerCharacters",s[s.suggestSelection=138]="suggestSelection",s[s.tabCompletion=139]="tabCompletion",s[s.tabIndex=140]="tabIndex",s[s.trimWhitespaceOnDelete=141]="trimWhitespaceOnDelete",s[s.unicodeHighlighting=142]="unicodeHighlighting",s[s.unusualLineTerminators=143]="unusualLineTerminators",s[s.useShadowDOM=144]="useShadowDOM",s[s.useTabStops=145]="useTabStops",s[s.wordBreak=146]="wordBreak",s[s.wordSegmenterLocales=147]="wordSegmenterLocales",s[s.wordSeparators=148]="wordSeparators",s[s.wordWrap=149]="wordWrap",s[s.wordWrapBreakAfterCharacters=150]="wordWrapBreakAfterCharacters",s[s.wordWrapBreakBeforeCharacters=151]="wordWrapBreakBeforeCharacters",s[s.wordWrapColumn=152]="wordWrapColumn",s[s.wordWrapOverride1=153]="wordWrapOverride1",s[s.wordWrapOverride2=154]="wordWrapOverride2",s[s.wrappingIndent=155]="wrappingIndent",s[s.wrappingStrategy=156]="wrappingStrategy",s[s.showDeprecated=157]="showDeprecated",s[s.inertialScroll=158]="inertialScroll",s[s.inlayHints=159]="inlayHints",s[s.wrapOnEscapedLineFeeds=160]="wrapOnEscapedLineFeeds",s[s.effectiveCursorStyle=161]="effectiveCursorStyle",s[s.editorClassName=162]="editorClassName",s[s.pixelRatio=163]="pixelRatio",s[s.tabFocusMode=164]="tabFocusMode",s[s.layoutInfo=165]="layoutInfo",s[s.wrappingInfo=166]="wrappingInfo",s[s.defaultColorDecorators=167]="defaultColorDecorators",s[s.colorDecoratorsActivatedOn=168]="colorDecoratorsActivatedOn",s[s.inlineCompletionsAccessibilityVerbose=169]="inlineCompletionsAccessibilityVerbose",s[s.effectiveEditContext=170]="effectiveEditContext",s[s.scrollOnMiddleClick=171]="scrollOnMiddleClick",s[s.effectiveAllowVariableFonts=172]="effectiveAllowVariableFonts"})(IM||(IM={}));var RM;(function(s){s[s.TextDefined=0]="TextDefined",s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(RM||(RM={}));var AM;(function(s){s[s.LF=0]="LF",s[s.CRLF=1]="CRLF"})(AM||(AM={}));var MM;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(MM||(MM={}));var OM;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(OM||(OM={}));var PM;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(PM||(PM={}));var FM;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(FM||(FM={}));var BM;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(BM||(BM={}));var VM;(function(s){s[s.Accepted=0]="Accepted",s[s.Rejected=1]="Rejected",s[s.Ignored=2]="Ignored"})(VM||(VM={}));var HM;(function(s){s[s.Code=1]="Code",s[s.Label=2]="Label"})(HM||(HM={}));var WM;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(WM||(WM={}));var zM;(function(s){s[s.DependsOnKbLayout=-1]="DependsOnKbLayout",s[s.Unknown=0]="Unknown",s[s.Backspace=1]="Backspace",s[s.Tab=2]="Tab",s[s.Enter=3]="Enter",s[s.Shift=4]="Shift",s[s.Ctrl=5]="Ctrl",s[s.Alt=6]="Alt",s[s.PauseBreak=7]="PauseBreak",s[s.CapsLock=8]="CapsLock",s[s.Escape=9]="Escape",s[s.Space=10]="Space",s[s.PageUp=11]="PageUp",s[s.PageDown=12]="PageDown",s[s.End=13]="End",s[s.Home=14]="Home",s[s.LeftArrow=15]="LeftArrow",s[s.UpArrow=16]="UpArrow",s[s.RightArrow=17]="RightArrow",s[s.DownArrow=18]="DownArrow",s[s.Insert=19]="Insert",s[s.Delete=20]="Delete",s[s.Digit0=21]="Digit0",s[s.Digit1=22]="Digit1",s[s.Digit2=23]="Digit2",s[s.Digit3=24]="Digit3",s[s.Digit4=25]="Digit4",s[s.Digit5=26]="Digit5",s[s.Digit6=27]="Digit6",s[s.Digit7=28]="Digit7",s[s.Digit8=29]="Digit8",s[s.Digit9=30]="Digit9",s[s.KeyA=31]="KeyA",s[s.KeyB=32]="KeyB",s[s.KeyC=33]="KeyC",s[s.KeyD=34]="KeyD",s[s.KeyE=35]="KeyE",s[s.KeyF=36]="KeyF",s[s.KeyG=37]="KeyG",s[s.KeyH=38]="KeyH",s[s.KeyI=39]="KeyI",s[s.KeyJ=40]="KeyJ",s[s.KeyK=41]="KeyK",s[s.KeyL=42]="KeyL",s[s.KeyM=43]="KeyM",s[s.KeyN=44]="KeyN",s[s.KeyO=45]="KeyO",s[s.KeyP=46]="KeyP",s[s.KeyQ=47]="KeyQ",s[s.KeyR=48]="KeyR",s[s.KeyS=49]="KeyS",s[s.KeyT=50]="KeyT",s[s.KeyU=51]="KeyU",s[s.KeyV=52]="KeyV",s[s.KeyW=53]="KeyW",s[s.KeyX=54]="KeyX",s[s.KeyY=55]="KeyY",s[s.KeyZ=56]="KeyZ",s[s.Meta=57]="Meta",s[s.ContextMenu=58]="ContextMenu",s[s.F1=59]="F1",s[s.F2=60]="F2",s[s.F3=61]="F3",s[s.F4=62]="F4",s[s.F5=63]="F5",s[s.F6=64]="F6",s[s.F7=65]="F7",s[s.F8=66]="F8",s[s.F9=67]="F9",s[s.F10=68]="F10",s[s.F11=69]="F11",s[s.F12=70]="F12",s[s.F13=71]="F13",s[s.F14=72]="F14",s[s.F15=73]="F15",s[s.F16=74]="F16",s[s.F17=75]="F17",s[s.F18=76]="F18",s[s.F19=77]="F19",s[s.F20=78]="F20",s[s.F21=79]="F21",s[s.F22=80]="F22",s[s.F23=81]="F23",s[s.F24=82]="F24",s[s.NumLock=83]="NumLock",s[s.ScrollLock=84]="ScrollLock",s[s.Semicolon=85]="Semicolon",s[s.Equal=86]="Equal",s[s.Comma=87]="Comma",s[s.Minus=88]="Minus",s[s.Period=89]="Period",s[s.Slash=90]="Slash",s[s.Backquote=91]="Backquote",s[s.BracketLeft=92]="BracketLeft",s[s.Backslash=93]="Backslash",s[s.BracketRight=94]="BracketRight",s[s.Quote=95]="Quote",s[s.OEM_8=96]="OEM_8",s[s.IntlBackslash=97]="IntlBackslash",s[s.Numpad0=98]="Numpad0",s[s.Numpad1=99]="Numpad1",s[s.Numpad2=100]="Numpad2",s[s.Numpad3=101]="Numpad3",s[s.Numpad4=102]="Numpad4",s[s.Numpad5=103]="Numpad5",s[s.Numpad6=104]="Numpad6",s[s.Numpad7=105]="Numpad7",s[s.Numpad8=106]="Numpad8",s[s.Numpad9=107]="Numpad9",s[s.NumpadMultiply=108]="NumpadMultiply",s[s.NumpadAdd=109]="NumpadAdd",s[s.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",s[s.NumpadSubtract=111]="NumpadSubtract",s[s.NumpadDecimal=112]="NumpadDecimal",s[s.NumpadDivide=113]="NumpadDivide",s[s.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",s[s.ABNT_C1=115]="ABNT_C1",s[s.ABNT_C2=116]="ABNT_C2",s[s.AudioVolumeMute=117]="AudioVolumeMute",s[s.AudioVolumeUp=118]="AudioVolumeUp",s[s.AudioVolumeDown=119]="AudioVolumeDown",s[s.BrowserSearch=120]="BrowserSearch",s[s.BrowserHome=121]="BrowserHome",s[s.BrowserBack=122]="BrowserBack",s[s.BrowserForward=123]="BrowserForward",s[s.MediaTrackNext=124]="MediaTrackNext",s[s.MediaTrackPrevious=125]="MediaTrackPrevious",s[s.MediaStop=126]="MediaStop",s[s.MediaPlayPause=127]="MediaPlayPause",s[s.LaunchMediaPlayer=128]="LaunchMediaPlayer",s[s.LaunchMail=129]="LaunchMail",s[s.LaunchApp2=130]="LaunchApp2",s[s.Clear=131]="Clear",s[s.MAX_VALUE=132]="MAX_VALUE"})(zM||(zM={}));var UM;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(UM||(UM={}));var jM;(function(s){s[s.Unnecessary=1]="Unnecessary",s[s.Deprecated=2]="Deprecated"})(jM||(jM={}));var $M;(function(s){s[s.Inline=1]="Inline",s[s.Gutter=2]="Gutter"})($M||($M={}));var qM;(function(s){s[s.Normal=1]="Normal",s[s.Underlined=2]="Underlined"})(qM||(qM={}));var GM;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.TEXTAREA=1]="TEXTAREA",s[s.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",s[s.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",s[s.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",s[s.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",s[s.CONTENT_TEXT=6]="CONTENT_TEXT",s[s.CONTENT_EMPTY=7]="CONTENT_EMPTY",s[s.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",s[s.CONTENT_WIDGET=9]="CONTENT_WIDGET",s[s.OVERVIEW_RULER=10]="OVERVIEW_RULER",s[s.SCROLLBAR=11]="SCROLLBAR",s[s.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",s[s.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(GM||(GM={}));var KM;(function(s){s[s.AIGenerated=1]="AIGenerated"})(KM||(KM={}));var YM;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(YM||(YM={}));var QM;(function(s){s[s.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",s[s.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",s[s.TOP_CENTER=2]="TOP_CENTER"})(QM||(QM={}));var XM;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(XM||(XM={}));var ZM;(function(s){s[s.Word=0]="Word",s[s.Line=1]="Line",s[s.Suggest=2]="Suggest"})(ZM||(ZM={}));var JM;(function(s){s[s.Left=0]="Left",s[s.Right=1]="Right",s[s.None=2]="None",s[s.LeftOfInjectedText=3]="LeftOfInjectedText",s[s.RightOfInjectedText=4]="RightOfInjectedText"})(JM||(JM={}));var e4;(function(s){s[s.Off=0]="Off",s[s.On=1]="On",s[s.Relative=2]="Relative",s[s.Interval=3]="Interval",s[s.Custom=4]="Custom"})(e4||(e4={}));var t4;(function(s){s[s.None=0]="None",s[s.Text=1]="Text",s[s.Blocks=2]="Blocks"})(t4||(t4={}));var i4;(function(s){s[s.Smooth=0]="Smooth",s[s.Immediate=1]="Immediate"})(i4||(i4={}));var n4;(function(s){s[s.Auto=1]="Auto",s[s.Hidden=2]="Hidden",s[s.Visible=3]="Visible"})(n4||(n4={}));var s4;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(s4||(s4={}));var r4;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(r4||(r4={}));var o4;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(o4||(o4={}));var a4;(function(s){s[s.File=0]="File",s[s.Module=1]="Module",s[s.Namespace=2]="Namespace",s[s.Package=3]="Package",s[s.Class=4]="Class",s[s.Method=5]="Method",s[s.Property=6]="Property",s[s.Field=7]="Field",s[s.Constructor=8]="Constructor",s[s.Enum=9]="Enum",s[s.Interface=10]="Interface",s[s.Function=11]="Function",s[s.Variable=12]="Variable",s[s.Constant=13]="Constant",s[s.String=14]="String",s[s.Number=15]="Number",s[s.Boolean=16]="Boolean",s[s.Array=17]="Array",s[s.Object=18]="Object",s[s.Key=19]="Key",s[s.Null=20]="Null",s[s.EnumMember=21]="EnumMember",s[s.Struct=22]="Struct",s[s.Event=23]="Event",s[s.Operator=24]="Operator",s[s.TypeParameter=25]="TypeParameter"})(a4||(a4={}));var l4;(function(s){s[s.Deprecated=1]="Deprecated"})(l4||(l4={}));var c4;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(c4||(c4={}));var u4;(function(s){s[s.Hidden=0]="Hidden",s[s.Blink=1]="Blink",s[s.Smooth=2]="Smooth",s[s.Phase=3]="Phase",s[s.Expand=4]="Expand",s[s.Solid=5]="Solid"})(u4||(u4={}));var h4;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(h4||(h4={}));var d4;(function(s){s[s.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",s[s.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",s[s.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",s[s.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(d4||(d4={}));var f4;(function(s){s[s.None=0]="None",s[s.Same=1]="Same",s[s.Indent=2]="Indent",s[s.DeepIndent=3]="DeepIndent"})(f4||(f4={}));var Bu;let t_e=(Bu=class{static chord(e,t){return yX(e,t)}},Bu.CtrlCmd=2048,Bu.Shift=1024,Bu.Alt=512,Bu.WinCtrl=256,Bu);function IX(){return{editor:void 0,languages:void 0,CancellationTokenSource:ym,Emitter:Z,KeyCode:zM,KeyMod:t_e,Position:J,Range:G,Selection:Lt,SelectionDirection:s4,MarkerSeverity:UM,MarkerTag:jM,Uri:mt,Token:yv}}function i_e(s,e){const t=s;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}const ni=window;function RX(s){return s}class n_e{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=RX):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}class cz{get cachedValues(){return this._map}constructor(e,t){this._map=new Map,this._map2=new Map,typeof e=="function"?(this._fn=e,this._computeKey=RX):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);const i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}}var If;(function(s){s[s.Uninitialized=0]="Uninitialized",s[s.Running=1]="Running",s[s.Completed=2]="Completed"})(If||(If={}));class lr{constructor(e){this.executor=e,this._state=If.Uninitialized}get value(){if(this._state===If.Uninitialized){this._state=If.Running;try{this._value=this.executor()}catch(e){this._error=e}finally{this._state=If.Completed}}else if(this._state===If.Running)throw new Error("Cannot read the value of a lazy that is being initialized");if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function s_e(s){return!s||typeof s!="string"?!0:s.trim().length===0}const r_e=/{(\d+)}/g;function g4(s,...e){return e.length===0?s:s.replace(r_e,function(t,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=e.length?t:e[n]})}function o_e(s){return s.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function Ra(s){return s.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function pc(s){return s.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function lD(s,e){if(!s||!e)return s;const t=e.length;if(t===0||s.length===0)return s;let i=0;for(;s.indexOf(e,i)===i;)i=i+t;return s.substring(i)}function a_e(s,e){if(!s||!e)return s;const t=e.length,i=s.length;if(t===0||i===0)return s;let n=i,r=-1;for(;r=s.lastIndexOf(e,n-1),!(r===-1||r+t!==n);){if(r===0)return"";n=r}return s.substring(0,n)}function l_e(s){return s.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function AX(s,e,t={}){if(!s)throw new Error("Cannot create regex from empty string");e||(s=pc(s)),t.wholeWord&&(/\B/.test(s.charAt(0))||(s="\\b"+s),/\B/.test(s.charAt(s.length-1))||(s=s+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(s,i)}function MX(s){return s.source==="^"||s.source==="^$"||s.source==="$"||s.source==="^\\s*$"?!1:!!(s.exec("")&&s.lastIndex===0)}function K1(s){return s.split(/\r\n|\r|\n/)}function qr(s){for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function sr(s,e=0,t=s.length){for(let i=e;i<t;i++){const n=s.charCodeAt(i);if(n!==32&&n!==9)return s.substring(e,i)}return s.substring(e,t)}function Sm(s,e=s.length-1){for(let t=e;t>=0;t--){const i=s.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function m4(s,e){return s<e?-1:s>e?1:0}function H6(s,e,t=0,i=s.length,n=0,r=e.length){for(;t<i&&n<r;t++,n++){const l=s.charCodeAt(t),c=e.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const o=i-t,a=r-n;return o<a?-1:o>a?1:0}function uz(s,e){return Y1(s,e,0,s.length,0,e.length)}function Y1(s,e,t=0,i=s.length,n=0,r=e.length){for(;t<i&&n<r;t++,n++){let l=s.charCodeAt(t),c=e.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return H6(s.toLowerCase(),e.toLowerCase(),t,i,n,r);Qp(l)&&(l-=32),Qp(c)&&(c-=32);const h=l-c;if(h!==0)return h}const o=i-t,a=r-n;return o<a?-1:o>a?1:0}function zS(s){return s>=48&&s<=57}function Qp(s){return s>=97&&s<=122}function jh(s){return s>=65&&s<=90}function og(s,e){return s.length===e.length&&Y1(s,e)===0}function W6(s,e){const t=e.length;return t<=s.length&&Y1(s,e,0,t)===0}function c_e(s,e){const t=s.length,i=t-e.length;return i>=0&&Y1(s,e,i,t)===0}function b1(s,e){const t=Math.min(s.length,e.length);let i;for(i=0;i<t;i++)if(s.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function w1(s,e){const t=Math.min(s.length,e.length);let i;const n=s.length-1,r=e.length-1;for(i=0;i<t;i++)if(s.charCodeAt(n-i)!==e.charCodeAt(r-i))return i;return t}function Tn(s){return 55296<=s&&s<=56319}function im(s){return 56320<=s&&s<=57343}function z6(s,e){return(s-55296<<10)+(e-56320)+65536}function rk(s,e,t){const i=s.charCodeAt(t);if(Tn(i)&&t+1<e){const n=s.charCodeAt(t+1);if(im(n))return z6(i,n)}return i}function u_e(s,e){const t=s.charCodeAt(e-1);if(im(t)&&e>1){const i=s.charCodeAt(e-2);if(Tn(i))return z6(i,t)}return t}class U6{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=u_e(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=rk(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class ok{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new U6(e,t)}nextGraphemeLength(){const e=ak.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const r=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(hz(n,o)){t.setOffset(r);break}n=o}return t.offset-i}prevGraphemeLength(){const e=ak.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const r=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(hz(o,n)){t.setOffset(r);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function j6(s,e){return new ok(s,e).nextGraphemeLength()}function OX(s,e){return new ok(s,e).prevGraphemeLength()}function h_e(s,e){e>0&&im(s.charCodeAt(e))&&e--;const t=e+j6(s,e);return[t-OX(s,t),t]}let nR;function d_e(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Sv(s){return nR||(nR=d_e()),nR.test(s)}const f_e=/^[\t\n\r\x20-\x7E]*$/;function $6(s){return f_e.test(s)}const PX=/[\u2028\u2029]/;function FX(s){return PX.test(s)}function ih(s){return s>=11904&&s<=55215||s>=63744&&s<=64255||s>=65281&&s<=65374}function q6(s){return s>=127462&&s<=127487||s===8986||s===8987||s===9200||s===9203||s>=9728&&s<=10175||s===11088||s===11093||s>=127744&&s<=128591||s>=128640&&s<=128764||s>=128992&&s<=129008||s>=129280&&s<=129535||s>=129648&&s<=129782}const g_e="\uFEFF";function G6(s){return!!(s&&s.length>0&&s.charCodeAt(0)===65279)}function BX(s){return s=s%52,s<26?String.fromCharCode(97+s):String.fromCharCode(65+s-26)}function hz(s,e){return s===0?e!==5&&e!==7:s===2&&e===3?!1:s===4||s===2||s===3||e===4||e===2||e===3?!0:!(s===8&&(e===8||e===9||e===11||e===12)||(s===11||s===9)&&(e===9||e===10)||(s===12||s===10)&&e===10||e===5||e===13||e===7||s===1||s===13&&e===14||s===6&&e===6)}const Yf=class Yf{static getInstance(){return Yf._INSTANCE||(Yf._INSTANCE=new Yf),Yf._INSTANCE}constructor(){this._data=m_e()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};Yf._INSTANCE=null;let ak=Yf;function m_e(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function p_e(s,e){if(s===0)return 0;const t=__e(s,e);if(t!==void 0)return t;const i=new U6(e,s);return i.prevCodePoint(),i.offset}function __e(s,e){const t=new U6(e,s);let i=t.prevCodePoint();for(;b_e(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!q6(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function b_e(s){return 127995<=s&&s<=127999}const Wl=class Wl{static getInstance(e){return Wl.cache.get(Array.from(e))}static getLocales(){return Wl._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};Wl.ambiguousCharacterData=new lr(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}')),Wl.cache=new n_e({getCacheKey:JSON.stringify},e=>{function t(h){const d=new Map;for(let g=0;g<h.length;g+=2)d.set(h[g],h[g+1]);return d}function i(h,d){const g=new Map(h);for(const[p,_]of d)g.set(p,_);return g}function n(h,d){if(!h)return d;const g=new Map;for(const[p,_]of h)d.has(p)&&g.set(p,_);return g}const r=Wl.ambiguousCharacterData.value;let o=e.filter(h=>!h.startsWith("_")&&Object.hasOwn(r,h));o.length===0&&(o=["_default"]);let a;for(const h of o){const d=t(r[h]);a=n(a,d)}const l=t(r._common),c=i(l,a);return new Wl(c)}),Wl._locales=new lr(()=>Object.keys(Wl.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let xv=Wl;const m_=class m_{static getRawData(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static getData(){return this._data||(this._data=new Set([...Object.values(m_.getRawData())].flat())),this._data}static isInvisibleCharacter(e){return m_.getData().has(e)}static get codePoints(){return m_.getData()}};m_._data=void 0;let Q0=m_;const j2=class j2{constructor(){this.mapWindowIdToZoomFactor=new Map}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}getWindowId(e){return e.vscodeWindowId}};j2.INSTANCE=new j2;let p4=j2;function VX(s,e,t){typeof e=="string"&&(e=s.matchMedia(e)),e.addEventListener("change",t)}function _4(s){return p4.INSTANCE.getZoomFactor(s)}const Q1=navigator.userAgent,Kr=Q1.indexOf("Firefox")>=0,cD=Q1.indexOf("AppleWebKit")>=0,BC=Q1.indexOf("Chrome")>=0,nm=!BC&&Q1.indexOf("Safari")>=0,HX=!BC&&!nm&&cD;Q1.indexOf("Electron/")>=0;const dz=Q1.indexOf("Android")>=0;let sR=!1;if(typeof ni.matchMedia=="function"){const s=ni.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=ni.matchMedia("(display-mode: fullscreen)");sR=s.matches,VX(ni,s,({matches:t})=>{sR&&e.matches||(sR=t)})}function K6(){return globalThis.MonacoEnvironment}const VC={clipboard:{writeText:bv||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:bv||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},pointerEvents:ni.PointerEvent&&("ontouchstart"in ni||navigator.maxTouchPoints>0)};function b4(s,e){if(typeof s=="number"){if(s===0)return null;const t=(s&65535)>>>0,i=(s&4294901760)>>>16;return i!==0?new rR([US(t,e),US(i,e)]):new rR([US(t,e)])}else{const t=[];for(let i=0;i<s.length;i++)t.push(US(s[i],e));return new rR(t)}}function US(s,e){const t=!!(s&2048),i=!!(s&256),n=e===2?i:t,r=!!(s&1024),o=!!(s&512),a=e===2?t:i,l=s&255;return new sm(n,r,o,a,l)}class sm{constructor(e,t,i,n,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=r}equals(e){return e instanceof sm&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class rR{constructor(e){if(e.length===0)throw sD("chords");this.chords=e}}class w_e{constructor(e,t,i,n,r,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=r,this.keyAriaLabel=o}}class v_e{}function C_e(s){if(s.charCode){const t=String.fromCharCode(s.charCode).toUpperCase();return Lu.fromString(t)}const e=s.keyCode;if(e===3)return 7;if(Kr)switch(e){case 59:return 85;case 60:if(Gr)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(_t)return 57;break}else if(cD){if(_t&&e===93)return 57;if(!_t&&e===92)return 57}return CX[e]||0}const y_e=_t?256:2048,S_e=512,x_e=1024,L_e=_t?2048:256;class si{constructor(e){var i;this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=(i=t.getModifierState)==null?void 0:i.call(t,"AltGraph"),this.keyCode=C_e(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=y_e),this.altKey&&(t|=S_e),this.shiftKey&&(t|=x_e),this.metaKey&&(t|=L_e),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new sm(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}const fz=new WeakMap;function k_e(s){if(!s.parent||s.parent===s)return null;try{const e=s.location,t=s.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return s.parent}class E_e{static getSameOriginWindowChain(e){let t=fz.get(e);if(!t){t=[],fz.set(e,t);let i=e,n;do n=k_e(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0;const r=this.getSameOriginWindowChain(e);for(const o of r){const a=o.window.deref();if(i+=(a==null?void 0:a.scrollY)??0,n+=(a==null?void 0:a.scrollX)??0,a===t||!o.iframeElement)break;const l=o.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}}class So{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.defaultPrevented=t.defaultPrevented,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const i=E_e.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class rm{constructor(e,t=0,i=0){var r;this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(BC){const o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(e){const o=e,a=e,l=((r=e.view)==null?void 0:r.devicePixelRatio)||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*l):this.deltaY=o.wheelDeltaY/120;else if(typeof a.VERTICAL_AXIS<"u"&&a.axis===a.VERTICAL_AXIS)this.deltaY=-a.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?Kr&&!_t?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof o.wheelDeltaX<"u")nm&&Rr?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*l):this.deltaX=o.wheelDeltaX/120;else if(typeof a.HORIZONTAL_AXIS<"u"&&a.axis===a.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?Kr&&!_t?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*l):this.deltaY=e.wheelDelta/120)}}preventDefault(){var e;(e=this.browserEvent)==null||e.preventDefault()}stopPropagation(){var e;(e=this.browserEvent)==null||e.stopPropagation()}}const WX=Symbol("MicrotaskDelay");function w4(s){return!!s&&typeof s.then=="function"}function v4(s){const e=new ym,t=s(e.token);let i=!1;const n=new Promise((r,o)=>{const a=e.token.onCancellationRequested(()=>{i=!0,a.dispose(),o(new q1)});Promise.resolve(t).then(l=>{a.dispose(),e.dispose(),i?rD(l)&&l.dispose():r(l)},l=>{a.dispose(),e.dispose(),o(l)})});return new class{cancel(){e.cancel(),e.dispose()}then(r,o){return n.then(r,o)}catch(r){return this.then(void 0,r)}finally(r){return n.finally(r)}}}let D_e=class{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null,this.cancellationTokenSource=new ym}queue(e){if(this.cancellationTokenSource.token.isCancellationRequested)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.cancellationTokenSource.token.isCancellationRequested)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(this.cancellationTokenSource.token),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.cancellationTokenSource.cancel()}};const T_e=(s,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},s);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},N_e=s=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,s())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class HC{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,r)=>{this.doResolve=n,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const n=this.task;return this.task=null,n()}}));const i=()=>{var n;this.deferred=null,(n=this.doResolve)==null||n.call(this,null)};return this.deferred=t===WX?N_e(i):T_e(t,i),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new q1),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class zX{constructor(e){this.delayer=new HC(e),this.throttler=new D_e}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function v1(s,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{r.dispose(),t()},s),r=e.onCancellationRequested(()=>{clearTimeout(n),r.dispose(),i(new q1)})}):v4(t=>v1(s,t))}function C4(s,e=0,t){const i=setTimeout(()=>{s(),t&&n.dispose()},e),n=qe(()=>{clearTimeout(i),t==null||t.delete(n)});return t==null||t.add(n),n}let I_e=class{constructor(){this._runningTask=void 0,this._pendingTasks=[]}schedule(e){const t=new uD;return this._pendingTasks.push({task:e,deferred:t,setUndefinedWhenCleared:!1}),this._runIfNotRunning(),t.p}_runIfNotRunning(){this._runningTask===void 0&&this._processQueue()}async _processQueue(){if(this._pendingTasks.length===0)return;const e=this._pendingTasks.shift();if(e){if(this._runningTask)throw new $e;this._runningTask=e.task;try{const t=await e.task();e.deferred.complete(t)}catch(t){e.deferred.error(t)}finally{this._runningTask=void 0,this._processQueue()}}}clearPending(){const e=this._pendingTasks;this._pendingTasks=[];for(const t of e)t.setUndefinedWhenCleared?t.deferred.complete(void 0):t.deferred.error(new q1)}};class _c{constructor(e,t){this._isDisposed=!1,this._token=void 0,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==void 0&&(clearTimeout(this._token),this._token=void 0)}cancelAndSet(e,t){if(this._isDisposed)throw new $e("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=void 0,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new $e("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===void 0&&(this._token=setTimeout(()=>{this._token=void 0,e()},t))}}class Y6{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new $e("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=qe(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class Es{constructor(e,t){this.timeoutToken=void 0,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=void 0)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==void 0}onTimeout(){this.timeoutToken=void 0,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let Q6,X0;(function(){const s=globalThis;typeof s.requestIdleCallback!="function"||typeof s.cancelIdleCallback!="function"?X0=(e,t,i)=>{PC(()=>{if(n)return;const r=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let n=!1;return{dispose(){n||(n=!0)}}}:X0=(e,t,i)=>{const n=e.requestIdleCallback(t,typeof i=="number"?{timeout:i}:void 0);let r=!1;return{dispose(){r||(r=!0,e.cancelIdleCallback(n))}}},Q6=(e,t)=>X0(globalThis,e,t)})();class R_e{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=X0(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class A_e extends R_e{constructor(e){super(globalThis,e)}}class uD{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return this.isSettled?Promise.resolve():new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return this.isSettled?Promise.resolve():new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new q1)}}var Lv;(function(s){async function e(i){let n;const r=await Promise.all(i.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return r}s.settled=e;function t(i){return new Promise(async(n,r)=>{try{await i(n,r)}catch(o){r(o)}})}s.withAsyncBody=t})(Lv||(Lv={}));class M_e{constructor(){this._unsatisfiedConsumers=[],this._unconsumedValues=[]}get hasFinalValue(){return!!this._finalValue}produce(e){if(this._ensureNoFinalValue(),this._unsatisfiedConsumers.length>0){const t=this._unsatisfiedConsumers.shift();this._resolveOrRejectDeferred(t,e)}else this._unconsumedValues.push(e)}produceFinal(e){this._ensureNoFinalValue(),this._finalValue=e;for(const t of this._unsatisfiedConsumers)this._resolveOrRejectDeferred(t,e);this._unsatisfiedConsumers.length=0}_ensureNoFinalValue(){if(this._finalValue)throw new $e("ProducerConsumer: cannot produce after final value has been set")}_resolveOrRejectDeferred(e,t){t.ok?e.complete(t.value):e.error(t.error)}consume(){if(this._unconsumedValues.length>0||this._finalValue){const e=this._unconsumedValues.length>0?this._unconsumedValues.shift():this._finalValue;return e.ok?Promise.resolve(e.value):Promise.reject(e.error)}else{const e=new uD;return this._unsatisfiedConsumers.push(e),e.p}}}const co=class co{constructor(e,t){this._onReturn=t,this._producerConsumer=new M_e,this._iterator={next:()=>this._producerConsumer.consume(),return:()=>{var i;return(i=this._onReturn)==null||i.call(this),Promise.resolve({done:!0,value:void 0})},throw:async i=>(this._finishError(i),{done:!0,value:void 0})},queueMicrotask(async()=>{const i=e({emitOne:n=>this._producerConsumer.produce({ok:!0,value:{done:!1,value:n}}),emitMany:n=>{for(const r of n)this._producerConsumer.produce({ok:!0,value:{done:!1,value:r}})},reject:n=>this._finishError(n)});if(!this._producerConsumer.hasFinalValue)try{await i,this._finishOk()}catch(n){this._finishError(n)}})}static fromArray(e){return new co(t=>{t.emitMany(e)})}static fromPromise(e){return new co(async t=>{t.emitMany(await e)})}static fromPromisesResolveOrder(e){return new co(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new co(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}static map(e,t){return new co(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return co.map(this,e)}static coalesce(e){return co.filter(e,t=>!!t)}coalesce(){return co.coalesce(this)}static filter(e,t){return new co(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return co.filter(this,e)}_finishOk(){this._producerConsumer.hasFinalValue||this._producerConsumer.produceFinal({ok:!0,value:{done:!0,value:void 0}})}_finishError(e){this._producerConsumer.hasFinalValue||this._producerConsumer.produceFinal({ok:!1,error:e})}[Symbol.asyncIterator](){return this._iterator}};co.EMPTY=co.fromArray([]);let gz=co;var tt;(function(s){s.inMemory="inmemory",s.vscode="vscode",s.internal="private",s.walkThrough="walkThrough",s.walkThroughSnippet="walkThroughSnippet",s.http="http",s.https="https",s.file="file",s.mailto="mailto",s.untitled="untitled",s.data="data",s.command="command",s.vscodeRemote="vscode-remote",s.vscodeRemoteResource="vscode-remote-resource",s.vscodeManagedRemoteResource="vscode-managed-remote-resource",s.vscodeUserData="vscode-userdata",s.vscodeCustomEditor="vscode-custom-editor",s.vscodeNotebookCell="vscode-notebook-cell",s.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",s.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",s.vscodeNotebookCellOutput="vscode-notebook-cell-output",s.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",s.vscodeNotebookMetadata="vscode-notebook-metadata",s.vscodeInteractiveInput="vscode-interactive-input",s.vscodeSettings="vscode-settings",s.vscodeWorkspaceTrust="vscode-workspace-trust",s.vscodeTerminal="vscode-terminal",s.vscodeChatCodeBlock="vscode-chat-code-block",s.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",s.vscodeChatEditor="vscode-chat-editor",s.vscodeChatInput="chatSessionInput",s.vscodeLocalChatSession="vscode-chat-session",s.webviewPanel="webview-panel",s.vscodeWebview="vscode-webview",s.extension="extension",s.vscodeFileResource="vscode-file",s.tmp="tmp",s.vsls="vsls",s.vscodeSourceControl="vscode-scm",s.commentsInput="comment",s.codeSetting="code-setting",s.outputChannel="output",s.accessibleView="accessible-view",s.chatEditingSnapshotScheme="chat-editing-snapshot-text-model",s.chatEditingModel="chat-editing-text-model",s.copilotPr="copilot-pr"})(tt||(tt={}));function X6(s,e){return mt.isUri(s)?og(s.scheme,e):W6(s,e+":")}function mz(s,...e){return e.some(t=>X6(s,t))}const O_e="tkn";class P_e{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}get _remoteResourcesPath(){return dn.join(this._serverRootPath,tt.vscodeRemoteResource)}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return $t(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],r=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(o+=`&${O_e}=${encodeURIComponent(r)}`),mt.from({scheme:oh?this._preferredWebSchema:tt.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:o})}}const UX=new P_e,F_e="vscode-app",Mw=class Mw{uriToBrowserUri(e){return e.scheme===tt.vscodeRemote?UX.rewrite(e):e.scheme===tt.file&&(bv||gme===`${tt.vscodeFileResource}://${Mw.FALLBACK_AUTHORITY}`)?e.with({scheme:tt.vscodeFileResource,authority:e.authority||Mw.FALLBACK_AUTHORITY,query:null,fragment:null}):e}};Mw.FALLBACK_AUTHORITY=F_e;let y4=Mw;const jX=new y4;var S4;(function(s){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(r){let o;typeof r=="string"?o=new URL(r).searchParams:r instanceof URL?o=r.searchParams:mt.isUri(r)&&(o=new URL(r.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}s.getHeadersFromQuery=i;function n(r,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";r instanceof URLSearchParams?r.set(t,l):r[t]=l}s.addSearchParam=n})(S4||(S4={}));const pz=typeof Buffer<"u";new lr(()=>new Uint8Array(256));let oR;class hD{static wrap(e){return pz&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new hD(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return pz?this.buffer.toString():(oR||(oR=new TextDecoder),oR.decode(this.buffer))}}function B_e(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0}function V_e(s,e,t){s[t+0]=e&255,e=e>>>8,s[t+1]=e&255}function Ja(s,e){return s[e]*2**24+s[e+1]*2**16+s[e+2]*2**8+s[e+3]}function el(s,e,t){s[t+3]=e,e=e>>>8,s[t+2]=e,e=e>>>8,s[t+1]=e,e=e>>>8,s[t]=e}function _z(s,e){return s[e]}function bz(s,e,t){s[t]=e}const wz="0123456789abcdef";function H_e({buffer:s}){let e="";for(let t=0;t<s.length;t++){const i=s[t];e+=wz[i>>>4],e+=wz[i&15]}return e}function Z6(s){return dD(s,0)}function dD(s,e){switch(typeof s){case"object":return s===null?Au(349,e):Array.isArray(s)?z_e(s,e):U_e(s,e);case"string":return J6(s,e);case"boolean":return W_e(s,e);case"number":return Au(s,e);case"undefined":return Au(937,e);default:return Au(617,e)}}function Au(s,e){return(e<<5)-e+s|0}function W_e(s,e){return Au(s?433:863,e)}function J6(s,e){e=Au(149417,e);for(let t=0,i=s.length;t<i;t++)e=Au(s.charCodeAt(t),e);return e}function z_e(s,e){return e=Au(104579,e),s.reduce((t,i)=>dD(i,t),e)}function U_e(s,e){return e=Au(181387,e),Object.keys(s).sort().reduce((t,i)=>(t=J6(i,t),dD(s[i],t)),e)}function aR(s,e,t=32){const i=t-e,n=~((1<<i)-1);return(s<<e|(n&s)>>>i)>>>0}function s0(s,e=32){return s instanceof ArrayBuffer?H_e(hD.wrap(new Uint8Array(s))):(s>>>0).toString(16).padStart(e/4,"0")}const $2=class $2{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,r=this._leftoverHighSurrogate,o,a;for(r!==0?(o=r,a=-1,r=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(Tn(o))if(a+1<t){const c=e.charCodeAt(a+1);im(c)?(a++,l=z6(o,c)):l=65533}else{r=o;break}else im(o)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=r}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),s0(this._h0)+s0(this._h1)+s0(this._h2)+s0(this._h3)+s0(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,this._buff.subarray(this._buffLen).fill(0),this._buffLen>56&&(this._step(),this._buff.fill(0));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=$2._bigBlock32,t=this._buffDV;for(let d=0;d<64;d+=4)e.setUint32(d,t.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)e.setUint32(d,aR(e.getUint32(d-12,!1)^e.getUint32(d-32,!1)^e.getUint32(d-56,!1)^e.getUint32(d-64,!1),1),!1);let i=this._h0,n=this._h1,r=this._h2,o=this._h3,a=this._h4,l,c,h;for(let d=0;d<80;d++)d<20?(l=n&r|~n&o,c=1518500249):d<40?(l=n^r^o,c=1859775393):d<60?(l=n&r|n&o|r&o,c=2400959708):(l=n^r^o,c=3395469782),h=aR(i,5)+l+a+c+e.getUint32(d*4,!1)&4294967295,a=o,o=r,r=aR(n,30),n=i,i=h;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}};$2._bigBlock32=new DataView(new ArrayBuffer(320));let x4=$2,Lf;function j_e(s){Lf?Lf instanceof vz?Lf.loggers.push(s):Lf=new vz([Lf,s]):Lf=s}function ks(){return Lf}class vz{constructor(e){this.loggers=e}handleObservableCreated(e,t){for(const i of this.loggers)i.handleObservableCreated(e,t)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e,t){for(const i of this.loggers)i.handleAutorunCreated(e,t)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const n of this.loggers)n.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const n of this.loggers)n.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}}var Is;(function(s){let e=!1;function t(){e=!0}s.enable=t;function i(){if(!e)return;const n=Error,r=n.stackTraceLimit;n.stackTraceLimit=3;const o=new Error().stack;return n.stackTraceLimit=r,e7.fromStack(o,2)}s.ofCaller=i})(Is||(Is={}));class e7{static fromStack(e,t){const i=e.split(`
`),n=$_e(i[t+1]);if(n)return new e7(n.fileName,n.line,n.column,n.id)}constructor(e,t,i,n){this.fileName=e,this.line=t,this.column=i,this.id=n}}function $_e(s){const e=s.match(/\((.*):(\d+):(\d+)\)/);if(e)return{fileName:e[1],line:parseInt(e[2]),column:parseInt(e[3]),id:s};const t=s.match(/at ([^\(\)]*):(\d+):(\d+)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:s}}const pl=(s,e)=>s===e;function L4(s=pl){return(e,t)=>Sn(e,t,s)}function q_e(){return(s,e)=>s.equals(e)}function D0(s,e,t){{const i=s;return(n,r)=>n==null||r===void 0||r===null?r===n:i(n,r)}}class hr{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return G_e(e,this)}}const Cz=new Map,k4=new WeakMap;function G_e(s,e){const t=k4.get(s);if(t)return t;const i=K_e(s,e);if(i){let n=Cz.get(i)??0;n++,Cz.set(i,n);const r=n===1?i:`${i}#${n}`;return k4.set(s,r),r}}function K_e(s,e){const t=k4.get(s);if(t)return t;const i=e.owner?Q_e(e.owner)+".":"";let n;const r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(n=r(),n!==void 0)return i+n}else return i+r;const o=e.referenceFn;if(o!==void 0&&(n=t7(o),n!==void 0))return i+n;if(e.owner!==void 0){const a=Y_e(e.owner,s);if(a!==void 0)return i+a}}function Y_e(s,e){for(const t in s)if(s[t]===e)return t}const yz=new Map,Sz=new WeakMap;function Q_e(s){const e=Sz.get(s);if(e)return e;const t=$X(s)??"Object";let i=yz.get(t)??0;i++,yz.set(t,i);const n=i===1?t:`${t}#${i}`;return Sz.set(s,n),n}function $X(s){const e=s.constructor;if(e)return e.name==="Object"?void 0:e.name}function t7(s){const e=s.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),n=i?i[1]:void 0;return n==null?void 0:n.trim()}let E4;function X_e(s){E4=s}let qX;function Z_e(s){qX=s}class GX{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t,i=Is.ofCaller()){const n=t===void 0?void 0:e,r=t===void 0?e:t;return E4({owner:n,debugName:()=>{const o=t7(r);if(o!==void 0)return o;const l=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(l)return`${this.debugName}.${l[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:r},o=>r(this.read(o),o),i)}flatten(){return E4({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(qX(this,t)),this}}class X1 extends GX{constructor(e){var t;super(),this._observers=new Set,(t=ks())==null||t.handleObservableCreated(this,e)}addObserver(e){var i;const t=this._observers.size;this._observers.add(e),t===0&&this.onFirstObserverAdded(),t!==this._observers.size&&((i=ks())==null||i.handleOnListenerCountChanged(this,this._observers.size))}removeObserver(e){var i;const t=this._observers.delete(e);t&&this._observers.size===0&&this.onLastObserverRemoved(),t&&((i=ks())==null||i.handleOnListenerCountChanged(this,this._observers.size))}onFirstObserverAdded(){}onLastObserverRemoved(){}debugGetObservers(){return this._observers}}function J_e(s){switch(s){case 0:return"initial";case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}class xa extends X1{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n=void 0,r,o){var a;super(o),this._debugNameData=e,this._computeFn=t,this._changeTracker=i,this._handleLastObserverRemoved=n,this._equalityComparator=r,this._state=0,this._value=void 0,this._updateCount=0,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._didReportChange=!1,this._isInBeforeUpdate=!1,this._isReaderValid=!1,this._store=void 0,this._delayedStore=void 0,this._removedObserverToCallEndUpdateOn=null,this._changeSummary=(a=this._changeTracker)==null?void 0:a.createChangeSummary(void 0)}onLastObserverRemoved(){var e,t;this._state=0,this._value=void 0,(e=ks())==null||e.handleDerivedCleared(this);for(const i of this._dependencies)i.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._delayedStore!==void 0&&(this._delayedStore.dispose(),this._delayedStore=void 0),(t=this._handleLastObserverRemoved)==null||t.call(this)}get(){var t,i;if(this._isComputing,this._observers.size===0){let n;try{this._isReaderValid=!0;let r;this._changeTracker&&(r=this._changeTracker.createChangeSummary(void 0),(i=(t=this._changeTracker).beforeUpdate)==null||i.call(t,this,r)),n=this._computeFn(this,r)}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),n}else{do{if(this._state===1){for(const n of this._dependencies)if(n.reportChanges(),this._state===2)break}this._state===1&&(this._state=3),this._state!==3&&this._recompute()}while(this._state!==3);return this._value}}_recompute(){var i,n,r,o;let e=!1;this._isComputing=!0,this._didReportChange=!1;const t=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=t;try{const a=this._changeSummary;this._isReaderValid=!0,this._changeTracker&&(this._isInBeforeUpdate=!0,(n=(i=this._changeTracker).beforeUpdate)==null||n.call(i,this,a),this._isInBeforeUpdate=!1,this._changeSummary=(r=this._changeTracker)==null?void 0:r.createChangeSummary(a));const l=this._state!==0,c=this._value;this._state=3;const h=this._delayedStore;h!==void 0&&(this._delayedStore=void 0);try{this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._value=this._computeFn(this,a)}finally{this._isReaderValid=!1;for(const d of this._dependenciesToBeRemoved)d.removeObserver(this);this._dependenciesToBeRemoved.clear(),h!==void 0&&h.dispose()}e=this._didReportChange||l&&!this._equalityComparator(c,this._value),(o=ks())==null||o.handleObservableUpdated(this,{oldValue:c,newValue:this._value,change:void 0,didChange:e,hadValue:l})}catch(a){KL(a)}if(this._isComputing=!1,!this._didReportChange&&e)for(const a of this._observers)a.handleChange(this,void 0);else this._didReportChange=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new $e("Cyclic deriveds are not supported yet!");this._updateCount++,this._isUpdating=!0;try{const t=this._updateCount===1;if(this._state===3&&(this._state=1,!t))for(const i of this._observers)i.handlePossibleChange(this);if(t)for(const i of this._observers)i.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this._updateCount--,this._updateCount===0){const t=[...this._observers];for(const i of t)i.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){const i=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const n of i)n.endUpdate(this)}}em(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===3&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=1;for(const t of this._observers)t.handlePossibleChange(this)}}handleChange(e,t){var i;if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)||this._isInBeforeUpdate){(i=ks())==null||i.handleDerivedDependencyChanged(this,e,t);let n=!1;try{n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:o=>o===e},this._changeSummary):!0}catch(o){KL(o)}const r=this._state===3;if(n&&(this._state===1||r)&&(this._state=2,r))for(const o of this._observers)o.handlePossibleChange(this)}}_ensureReaderValid(){if(!this._isReaderValid)throw new $e("The reader object cannot be used outside its compute function!")}readObservable(e){this._ensureReaderValid(),e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){return this._ensureReaderValid(),this._store===void 0&&(this._store=new Pe),this._store}addObserver(e){const t=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e),t&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)?this._removedObserverToCallEndUpdateOn.delete(e):e.beginUpdate(this))}removeObserver(e){this._observers.has(e)&&this._updateCount>0&&(this._removedObserverToCallEndUpdateOn||(this._removedObserverToCallEndUpdateOn=new Set),this._removedObserverToCallEndUpdateOn.add(e)),super.removeObserver(e)}debugGetState(){return{state:this._state,stateStr:J_e(this._state),updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}debugRecompute(){this._isComputing?this._state=2:this._recompute()}setValue(e,t,i){this._value=e;const n=this._observers;t.updateObserver(this,this);for(const r of n)r.handleChange(this,i)}}class e1e extends xa{constructor(e,t,i,n=void 0,r,o,a){super(e,t,i,n,r,a),this.set=o}}function We(s,e,t=Is.ofCaller()){return e!==void 0?new xa(new hr(s,void 0,e),e,void 0,void 0,pl,t):new xa(new hr(void 0,void 0,s),s,void 0,void 0,pl,t)}function i7(s,e,t,i=Is.ofCaller()){return new e1e(new hr(s,void 0,e),e,void 0,void 0,pl,t,i)}function sc(s,e,t=Is.ofCaller()){return new xa(new hr(s.owner,s.debugName,s.debugReferenceFn),e,void 0,s.onLastObserverRemoved,s.equalsFn??pl,t)}X_e(sc);function Bl(s,e,t=Is.ofCaller()){let i,n;e===void 0?(i=s,n=void 0):(n=s,i=e);let r;return new xa(new hr(n,void 0,i),o=>{r?r.clear():r=new Pe;const a=i(o);return a&&r.add(a),a},void 0,()=>{r&&(r.dispose(),r=void 0)},pl,t)}function t1e(s){switch(s){case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}class kv{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n){var r,o;this._debugNameData=e,this._runFn=t,this._changeTracker=i,this._state=2,this._updateCount=0,this._disposed=!1,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._isRunning=!1,this._store=void 0,this._delayedStore=void 0,this._changeSummary=(r=this._changeTracker)==null?void 0:r.createChangeSummary(void 0),(o=ks())==null||o.handleAutorunCreated(this,n),this._run()}dispose(){var e;if(!this._disposed){this._disposed=!0;for(const t of this._dependencies)t.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&this._store.dispose(),this._delayedStore!==void 0&&this._delayedStore.dispose(),(e=ks())==null||e.handleAutorunDisposed(this)}}_run(){var t,i,n,r;const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e,this._state=3;try{if(!this._disposed){(t=ks())==null||t.handleAutorunStarted(this);const o=this._changeSummary,a=this._delayedStore;a!==void 0&&(this._delayedStore=void 0);try{this._isRunning=!0,this._changeTracker&&((n=(i=this._changeTracker).beforeUpdate)==null||n.call(i,this,o),this._changeSummary=this._changeTracker.createChangeSummary(o)),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._runFn(this,o)}catch(l){KL(l)}finally{this._isRunning=!1,a!==void 0&&a.dispose()}}}finally{this._disposed||(r=ks())==null||r.handleAutorunFinished(this);for(const o of this._dependenciesToBeRemoved)o.removeObserver(this);this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this._state===3&&(this._state=1),this._updateCount++}endUpdate(e){try{if(this._updateCount===1)do{if(this._state===1){this._state=3;for(const t of this._dependencies)if(t.reportChanges(),this._state===2)break}this._state!==3&&this._run()}while(this._state!==3)}finally{this._updateCount--}em(()=>this._updateCount>=0)}handlePossibleChange(e){this._state===3&&this._isDependency(e)&&(this._state=1)}handleChange(e,t){var i;if(this._isDependency(e)){(i=ks())==null||i.handleAutorunDependencyChanged(this,e,t);try{(this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this._changeSummary):!0)&&(this._state=2)}catch(n){KL(n)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}_ensureNoRunning(){if(!this._isRunning)throw new $e("The reader object cannot be used outside its compute function!")}readObservable(e){if(this._ensureNoRunning(),this._disposed)return e.get();e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){if(this._ensureNoRunning(),this._disposed)throw new $e("Cannot access store after dispose");return this._store===void 0&&(this._store=new Pe),this._store}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state,stateStr:t1e(this._state)}}debugRerun(){this._isRunning?this._state=2:this._run()}}function vt(s,e=Is.ofCaller()){return new kv(new hr(void 0,void 0,s),s,void 0,e)}function n7(s,e,t=Is.ofCaller()){return new kv(new hr(s.owner,s.debugName,s.debugReferenceFn??e),e,void 0,t)}function Z1(s,e,t=Is.ofCaller()){return new kv(new hr(s.owner,s.debugName,s.debugReferenceFn??e),e,s.changeTracker,t)}function i1e(s,e){const t=new Pe,i=Z1({owner:s.owner,debugName:s.debugName,debugReferenceFn:s.debugReferenceFn??e,changeTracker:s.changeTracker},(n,r)=>{t.clear(),e(n,r,t)});return qe(()=>{i.dispose(),t.dispose()})}function fl(s){const e=new Pe,t=n7({owner:void 0,debugName:void 0,debugReferenceFn:s},i=>{e.clear(),s(i,e)});return qe(()=>{t.dispose(),e.dispose()})}function xz(s){const e=new Error("BugIndicatingErrorRecovery: "+s);$t(e),console.error("recovered from an error that indicates a bug",e)}function tn(s,e){const t=new WC(s,e);try{s(t)}finally{t.finish()}}let jS;function T0(s){if(jS)s(jS);else{const e=new WC(s,void 0);jS=e;try{s(e)}finally{e.finish(),jS=void 0}}}function s7(s,e,t){s?e(s):tn(e,t)}class WC{constructor(e,t){var i;this._fn=e,this._getDebugName=t,this._updatingObservers=[],(i=ks())==null||i.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():t7(this._fn)}updateObserver(e,t){if(!this._updatingObservers){xz("Transaction already finished!"),tn(i=>{i.updateObserver(e,t)});return}this._updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){var t;const e=this._updatingObservers;if(!e){xz("transaction.finish() has already been called!");return}for(let i=0;i<e.length;i++){const{observer:n,observable:r}=e[i];n.endUpdate(r)}this._updatingObservers=null,(t=ks())==null||t.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}}function Ii(...s){let e,t,i,n;return s.length===2?[t,i]=s:[e,t,i,n]=s,new ag(new hr(e,void 0,i),t,i,()=>ag.globalTransaction,pl,n??Is.ofCaller())}class ag extends X1{constructor(e,t,i,n,r,o){super(o),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=n,this._equalityComparator=r,this._hasValue=!1,this.handleEvent=a=>{var g;const l=this._getValue(a),c=this._value,h=!this._hasValue||!this._equalityComparator(c,l);let d=!1;h&&(this._value=l,this._hasValue&&(d=!0,s7(this._getTransaction(),p=>{var _;(_=ks())==null||_.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:h,hadValue:this._hasValue});for(const b of this._observers)p.updateObserver(b,this),b.handleChange(this,void 0)},()=>{const p=this.getDebugName();return"Event fired"+(p?`: ${p}`:"")})),this._hasValue=!0),d||(g=ks())==null||g.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:h,hadValue:this._hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose(),this._subscription=void 0,this._hasValue=!1,this._value=void 0}get(){return this._subscription?(this._hasValue||this.handleEvent(void 0),this._value):this._getValue(void 0)}debugSetValue(e){this._value=e}debugGetState(){return{value:this._value,hasValue:this._hasValue}}}(function(s){s.Observer=ag;function e(t,i){let n=!1;ag.globalTransaction===void 0&&(ag.globalTransaction=t,n=!0);try{i()}finally{n&&(ag.globalTransaction=void 0)}}s.batchEventsGlobally=e})(Ii||(Ii={}));function fD(s,e){const t=new n1e(!0,e);s.addObserver(t);try{t.beginUpdate(s)}finally{t.endUpdate(s)}return qe(()=>{s.removeObserver(t)})}Z_e(fD);class n1e{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter===1&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges()),this._counter--}handlePossibleChange(e){}handleChange(e,t){}}function s1e(s,e){let t;return sc({owner:s,debugReferenceFn:e},n=>(t=e(n,t),t))}function Xp(s,e){switch(typeof s){case"number":return""+s;case"string":return s.length+2<=e?`"${s}"`:`"${s.substr(0,e-7)}"+...`;case"boolean":return s?"true":"false";case"undefined":return"undefined";case"object":return s===null?"null":Array.isArray(s)?r1e(s,e):o1e(s,e);case"symbol":return s.toString();case"function":return`[[Function${s.name?" "+s.name:""}]]`;default:return""+s}}function r1e(s,e){let t="[ ",i=!0;for(const n of s){if(i||(t+=", "),t.length-5>e){t+="...";break}i=!1,t+=`${Xp(n,e-t.length)}`}return t+=" ]",t}function o1e(s,e){if(typeof s.toString=="function"&&s.toString!==Object.prototype.toString){const r=s.toString();return r.length<=e?r:r.substring(0,e-3)+"..."}const t=$X(s);let i=t?t+"(":"{ ",n=!0;for(const[r,o]of Object.entries(s)){if(n||(i+=", "),i.length-5>e){i+="...";break}n=!1,i+=`${r}: ${Xp(o,e-i.length)}`}return i+=t?")":" }",i}class r7{static createClient(e,t){return new r7(e,t)}constructor(e,t){this._channelFactory=e,this._getHandler=t,this._channel=this._channelFactory({handleNotification:r=>{const o=r,a=this._getHandler().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:r=>{const o=r;try{return{type:"result",value:this._getHandler().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const i=new Proxy({},{get:(r,o)=>async(...a)=>{const l=await this._channel.sendRequest([o,a]);if(l.type==="error")throw l.value;return l.value}}),n=new Proxy({},{get:(r,o)=>(...a)=>{this._channel.sendNotification([o,a])}});this.api={notifications:n,requests:i}}}function a1e(s,e){const t=globalThis;let i=[],n;const{channel:r,handler:o}=l1e({sendNotification:l=>{n?n.sendNotification(l):i.push(l)}});let a;return(t.$$debugValueEditor_debugChannels??(t.$$debugValueEditor_debugChannels={}))[s]=l=>{a=e(),n=l;for(const c of i)l.sendNotification(c);return i=[],o},r7.createClient(r,()=>{if(!a)throw new Error("Not supported");return a})}function l1e(s){let e;return{channel:i=>(e=i,{sendNotification:n=>{s.sendNotification(n)},sendRequest:n=>{throw new Error("not supported")}}),handler:{handleRequest:i=>i.type==="notification"?e==null?void 0:e.handleNotification(i.data):e==null?void 0:e.handleRequest(i.data)}}}class c1e{constructor(){this._timeout=void 0}throttle(e,t){this._timeout===void 0&&(this._timeout=setTimeout(()=>{this._timeout=void 0,e()},t))}dispose(){this._timeout!==void 0&&clearTimeout(this._timeout)}}function KX(s,e){for(const t in e)s[t]&&typeof s[t]=="object"&&e[t]&&typeof e[t]=="object"?KX(s[t],e[t]):s[t]=e[t]}function YX(s,e){for(const t in e)e[t]===null?delete s[t]:s[t]&&typeof s[t]=="object"&&e[t]&&typeof e[t]=="object"?YX(s[t],e[t]):s[t]=e[t]}function lt(s,e,t=Is.ofCaller()){let i;return typeof s=="string"?i=new hr(void 0,s,void 0):i=new hr(s,void 0,void 0),new Ev(i,e,pl,t)}class Ev extends X1{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i,n){var r;super(n),this._debugNameData=e,this._equalityComparator=i,this._value=t,(r=ks())==null||r.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this._value}set(e,t,i){var r;if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new WC(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),(r=ks())==null||r.handleObservableUpdated(this,{oldValue:o,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this._observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}}function QX(s,e,t=Is.ofCaller()){let i;return typeof s=="string"?i=new hr(void 0,s,void 0):i=new hr(s,void 0,void 0),new u1e(i,e,pl,t)}class u1e extends Ev{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){var e;(e=this._value)==null||e.dispose()}}const Qf=class Qf{static getInstance(){return Qf._instance===void 0&&(Qf._instance=new Qf),Qf._instance}getTransactionState(){const e=[],t=[...this._activeTransactions];if(t.length===0)return;const i=t.flatMap(r=>r.debugGetUpdatingObservers()??[]).map(r=>r.observer),n=new Set;for(;i.length>0;){const r=i.shift();if(n.has(r))continue;n.add(r);const o=this._getInfo(r,a=>{n.has(a)||i.push(a)});o&&e.push(o)}return{names:t.map(r=>r.getDebugName()??"tx"),affected:e}}_getObservableInfo(e){const t=this._instanceInfos.get(e);if(!t){$t(new $e("No info found"));return}return t}_getAutorunInfo(e){const t=this._instanceInfos.get(e);if(!t){$t(new $e("No info found"));return}return t}_getInfo(e,t){if(e instanceof xa){const i=[...e.debugGetObservers()];for(const l of i)t(l);const n=this._getObservableInfo(e);if(!n)return;const r=e.debugGetState(),o={name:e.debugName,instanceId:n.instanceId,updateCount:r.updateCount},a=[...n.changedObservables].map(l=>{var c;return(c=this._instanceInfos.get(l))==null?void 0:c.instanceId}).filter(Xo);if(r.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(r.state){case 0:return{...o,type:"observable/derived",state:"noValue"};case 3:return{...o,type:"observable/derived",state:"upToDate"};case 2:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(e instanceof kv){const i=this._getAutorunInfo(e);if(!i)return;const n={name:e.debugName,instanceId:i.instanceId,updateCount:i.updateCount},r=[...i.changedObservables].map(o=>this._instanceInfos.get(o).instanceId);if(e.debugGetState().isRunning)return{...n,type:"autorun",state:"updating",changedDependencies:r};switch(e.debugGetState().state){case 3:return{...n,type:"autorun",state:"upToDate"};case 2:return{...n,type:"autorun",state:"stale",changedDependencies:r};case 1:return{...n,type:"autorun",state:"possiblyStale"}}}}_formatObservable(e){const t=this._getObservableInfo(e);if(t)return{name:e.debugName,instanceId:t.instanceId}}_formatObserver(e){var i;if(e instanceof xa)return{name:e.toString(),instanceId:(i=this._getObservableInfo(e))==null?void 0:i.instanceId};const t=this._getAutorunInfo(e);if(t)return{name:e.toString(),instanceId:t.instanceId}}constructor(){this._declarationId=0,this._instanceId=0,this._declarations=new Map,this._instanceInfos=new WeakMap,this._aliveInstances=new Map,this._activeTransactions=new Set,this._channel=a1e("observableDevTools",()=>({notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log("logObservableValue",e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null,this._channel.api.notifications.handleChange(this._fullState,!0)}},requests:{getDeclarations:()=>{const e={};for(const t of this._declarations.values())e[t.id]=t;return{decls:e}},getSummarizedInstances:()=>null,getObservableValueInfo:e=>({observers:[...this._aliveInstances.get(e).debugGetObservers()].map(i=>this._formatObserver(i)).filter(Xo)}),getDerivedInfo:e=>{const t=this._aliveInstances.get(e);return{dependencies:[...t.debugGetState().dependencies].map(i=>this._formatObservable(i)).filter(Xo),observers:[...t.debugGetObservers()].map(i=>this._formatObserver(i)).filter(Xo)}},getAutorunInfo:e=>({dependencies:[...this._aliveInstances.get(e).debugGetState().dependencies].map(i=>this._formatObservable(i)).filter(Xo)}),getTransactionState:()=>this.getTransactionState(),setValue:(e,t)=>{const i=this._aliveInstances.get(e);if(i instanceof xa)i.debugSetValue(t);else if(i instanceof Ev)i.debugSetValue(t);else if(i instanceof ag)i.debugSetValue(t);else throw new $e("Observable is not supported");const n=[...i.debugGetObservers()];for(const r of n)r.beginUpdate(i);for(const r of n)r.handleChange(i,void 0);for(const r of n)r.endUpdate(i)},getValue:e=>{const t=this._aliveInstances.get(e);if(t instanceof xa)return Xp(t.debugGetState().value,200);if(t instanceof Ev)return Xp(t.debugGetState().value,200)},logValue:e=>{const t=this._aliveInstances.get(e);if(t&&"get"in t)console.log("Logged Value:",t.get());else throw new $e("Observable is not supported")},rerun:e=>{const t=this._aliveInstances.get(e);if(t instanceof xa)t.debugRecompute();else if(t instanceof kv)t.debugRerun();else throw new $e("Observable is not supported")}}})),this._pendingChanges=null,this._changeThrottler=new c1e,this._fullState={},this._flushUpdates=()=>{this._pendingChanges!==null&&(this._channel.api.notifications.handleChange(this._pendingChanges,!1),this._pendingChanges=null)},Is.enable()}_handleChange(e){YX(this._fullState,e),this._pendingChanges===null?this._pendingChanges=e:KX(this._pendingChanges,e),this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e,t){if(!t)return-1;let i=this._declarations.get(t.id);return i===void 0&&(i={id:this._declarationId++,type:e,url:t.fileName,line:t.line,column:t.column},this._declarations.set(t.id,i),this._handleChange({decls:{[i.id]:i}})),i.id}handleObservableCreated(e,t){const n={declarationId:this._getDeclarationId("observable/value",t),instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n)}handleOnListenerCountChanged(e,t){const i=this._getObservableInfo(e);if(i){if(i.listenerCount===0&&t>0){const n=e instanceof xa?"observable/derived":"observable/value";this._aliveInstances.set(i.instanceId,e),this._handleChange({instances:{[i.instanceId]:{instanceId:i.instanceId,declarationId:i.declarationId,formattedValue:i.lastValue,type:n,name:e.debugName}}})}else i.listenerCount>0&&t===0&&(this._handleChange({instances:{[i.instanceId]:null}}),this._aliveInstances.delete(i.instanceId));i.listenerCount=t}}handleObservableUpdated(e,t){if(e instanceof xa){this._handleDerivedRecomputed(e,t);return}const i=this._getObservableInfo(e);i&&t.didChange&&(i.lastValue=Xp(t.newValue,30),i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:i.lastValue}}}))}handleAutorunCreated(e,t){const n={declarationId:this._getDeclarationId("autorun",t),instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n),this._aliveInstances.set(n.instanceId,e),n&&this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,runCount:0,type:"autorun",name:e.debugName}}})}handleAutorunDisposed(e){const t=this._getAutorunInfo(e);t&&(this._handleChange({instances:{[t.instanceId]:null}}),this._instanceInfos.delete(e),this._aliveInstances.delete(t.instanceId))}handleAutorunDependencyChanged(e,t,i){const n=this._getAutorunInfo(e);n&&n.changedObservables.add(t)}handleAutorunStarted(e){}handleAutorunFinished(e){const t=this._getAutorunInfo(e);t&&(t.changedObservables.clear(),t.updateCount++,this._handleChange({instances:{[t.instanceId]:{runCount:t.updateCount}}}))}handleDerivedDependencyChanged(e,t,i){const n=this._getObservableInfo(e);n&&n.changedObservables.add(t)}_handleDerivedRecomputed(e,t){const i=this._getObservableInfo(e);if(!i)return;const n=Xp(t.newValue,30);i.updateCount++,i.changedObservables.clear(),i.lastValue=n,i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:n,recomputationCount:i.updateCount}}})}handleDerivedCleared(e){const t=this._getObservableInfo(e);t&&(t.lastValue=void 0,t.changedObservables.clear(),t.listenerCount>0&&this._handleChange({instances:{[t.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}};Qf._instance=void 0;let D4=Qf;ik&&ik.VSCODE_DEV_DEBUG_OBSERVABLES&&j_e(D4.getInstance());const{getWindow:Ue,getDocument:h1e,getWindows:XX,getWindowsCount:d1e,getWindowId:Dv,getWindowById:Lz,onDidRegisterWindow:zC,onWillUnregisterWindow:f1e,onDidUnregisterWindow:g1e}=(function(){const s=new Map;i_e(ni,1);const e={window:ni,disposables:new Pe};s.set(ni.vscodeWindowId,e);const t=new Z,i=new Z,n=new Z;function r(o,a){return(typeof o=="number"?s.get(o):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(o){if(s.has(o.vscodeWindowId))return le.None;const a=new Pe,l={window:o,disposables:a.add(new Pe)};return s.set(o.vscodeWindowId,l),a.add(qe(()=>{s.delete(o.vscodeWindowId),i.fire(o)})),a.add(ie(o,Le.BEFORE_UNLOAD,()=>{n.fire(o)})),t.fire(l),a},getWindows(){return s.values()},getWindowsCount(){return s.size},getWindowId(o){return o.vscodeWindowId},hasWindow(o){return s.has(o)},getWindowById:r,getWindow(o){var c;const a=o;if((c=a==null?void 0:a.ownerDocument)!=null&&c.defaultView)return a.ownerDocument.defaultView.window;const l=o;return l!=null&&l.view?l.view.window:ni},getDocument(o){return Ue(o).document}}})();function _l(s){for(;s.firstChild;)s.firstChild.remove()}class m1e{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function ie(s,e,t,i){return new m1e(s,e,t,i)}function p1e(s,e){return function(t){return e(new So(s,t))}}function _1e(s){return function(e){return s(new si(e))}}const bs=function(e,t,i,n){let r=i;return t==="click"||t==="mousedown"||t==="contextmenu"?r=p1e(Ue(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=_1e(i)),ie(e,t,r,n)};function b1e(s,e,t){return ie(s,gc&&VC.pointerEvents?Le.POINTER_DOWN:Le.MOUSE_DOWN,e,t)}function w1e(s,e,t){return ie(s,gc&&VC.pointerEvents?Le.POINTER_MOVE:Le.MOUSE_MOVE,e,t)}function kz(s,e,t){return ie(s,gc&&VC.pointerEvents?Le.POINTER_UP:Le.MOUSE_UP,e,t)}function $S(s,e,t){return X0(s,e,t)}let ZX,Ar;class o7 extends Y6{constructor(e){super(),this.defaultTarget=e&&Ue(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}}class lR{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){$t(e)}}static sort(e,t){return t.priority-e.priority}}(function(){const s=new Map,e=new Map,t=new Map,i=new Map,n=r=>{t.set(r,!1);const o=s.get(r)??[];for(e.set(r,o),s.set(r,[]),i.set(r,!0);o.length>0;)o.sort(lR.sort),o.shift().execute();i.set(r,!1)};Ar=(r,o,a=0)=>{const l=Dv(r),c=new lR(o,a);let h=s.get(l);return h||(h=[],s.set(l,h)),h.push(c),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>n(l))),c},ZX=(r,o,a)=>{const l=Dv(r);if(i.get(l)){const c=new lR(o,a);let h=e.get(l);return h||(h=[],e.set(l,h)),h.push(c),c}else return Ar(r,o,a)}})();function a7(s){return Ue(s).getComputedStyle(s,null)}function T4(s,e,t){const i=Ue(s),n=i.document;if(s!==n.body)return new ku(s.clientWidth,s.clientHeight);if(gc&&(i!=null&&i.visualViewport))return new ku(i.visualViewport.width,i.visualViewport.height);if(i!=null&&i.innerWidth&&i.innerHeight)return new ku(i.innerWidth,i.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new ku(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new ku(n.documentElement.clientWidth,n.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class ji{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t){const i=a7(e),n=i?i.getPropertyValue(t):"0";return ji.convertToPixels(e,n)}static getBorderLeftWidth(e){return ji.getDimension(e,"border-left-width")}static getBorderRightWidth(e){return ji.getDimension(e,"border-right-width")}static getBorderTopWidth(e){return ji.getDimension(e,"border-top-width")}static getBorderBottomWidth(e){return ji.getDimension(e,"border-bottom-width")}static getPaddingLeft(e){return ji.getDimension(e,"padding-left")}static getPaddingRight(e){return ji.getDimension(e,"padding-right")}static getPaddingTop(e){return ji.getDimension(e,"padding-top")}static getPaddingBottom(e){return ji.getDimension(e,"padding-bottom")}static getMarginLeft(e){return ji.getDimension(e,"margin-left")}static getMarginTop(e){return ji.getDimension(e,"margin-top")}static getMarginRight(e){return ji.getDimension(e,"margin-right")}static getMarginBottom(e){return ji.getDimension(e,"margin-bottom")}}const Xf=class Xf{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Xf(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof Xf?e:new Xf(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};Xf.None=new Xf(0,0);let ku=Xf;function v1e(s){let e=s.offsetParent,t=s.offsetTop,i=s.offsetLeft;for(;(s=s.parentNode)!==null&&s!==s.ownerDocument.body&&s!==s.ownerDocument.documentElement;){t-=s.scrollTop;const n=eZ(s)?null:a7(s);n&&(i-=n.direction!=="rtl"?s.scrollLeft:-s.scrollLeft),s===e&&(i+=ji.getBorderLeftWidth(s),t+=ji.getBorderTopWidth(s),t+=s.offsetTop,i+=s.offsetLeft,e=s.offsetParent)}return{left:i,top:t}}function ta(s){const e=s.getBoundingClientRect(),t=Ue(s);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function JX(s){let e=s,t=1;do{const i=a7(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function l7(s){const e=ji.getMarginLeft(s)+ji.getMarginRight(s);return s.offsetWidth+e}function cR(s){const e=ji.getBorderLeftWidth(s)+ji.getBorderRightWidth(s),t=ji.getPaddingLeft(s)+ji.getPaddingRight(s);return s.offsetWidth-e-t}function C1e(s){const e=ji.getBorderTopWidth(s)+ji.getBorderBottomWidth(s),t=ji.getPaddingTop(s)+ji.getPaddingBottom(s);return s.offsetHeight-e-t}function N4(s){const e=ji.getMarginTop(s)+ji.getMarginBottom(s);return s.offsetHeight+e}function Gn(s,e){return!!(e!=null&&e.contains(s))}function y1e(s,e,t){for(;s&&s.nodeType===s.ELEMENT_NODE;){if(s.classList.contains(e))return s;if(t){if(typeof t=="string"){if(s.classList.contains(t))return null}else if(s===t)return null}s=s.parentNode}return null}function uR(s,e,t){return!!y1e(s,e,t)}function eZ(s){return s&&!!s.host&&!!s.mode}function I4(s){return!!om(s)}function om(s){var e;for(;s.parentNode;){if(s===((e=s.ownerDocument)==null?void 0:e.body))return null;s=s.parentNode}return eZ(s)?s:null}function Kn(){let s=gD().activeElement;for(;s!=null&&s.shadowRoot;)s=s.shadowRoot.activeElement;return s}function c7(s){return Kn()===s}function tZ(s){return Gn(Kn(),s)}function gD(){return d1e()<=1?ni.document:Array.from(XX()).map(({window:e})=>e.document).find(e=>e.hasFocus())??ni.document}function Kt(){var e;return((e=gD().defaultView)==null?void 0:e.window)??ni}const S1e=new class{constructor(){this.mutationObservers=new Map}observe(s,e,t){let i=this.mutationObservers.get(s);i||(i=new Map,this.mutationObservers.set(s,i));const n=Z6(t);let r=i.get(n);if(r)r.users+=1;else{const o=new Z,a=new MutationObserver(c=>o.fire(c));a.observe(s,t);const l=r={users:1,observer:a,onDidMutate:o.event};e.add(qe(()=>{l.users-=1,l.users===0&&(o.dispose(),a.disconnect(),i==null||i.delete(n),(i==null?void 0:i.size)===0&&this.mutationObservers.delete(s))})),i.set(n,r)}return r.onDidMutate}};function nn(s){return s instanceof HTMLElement||s instanceof Ue(s).HTMLElement}function Ez(s){return s instanceof HTMLAnchorElement||s instanceof Ue(s).HTMLAnchorElement}function iZ(s){return s instanceof SVGElement||s instanceof Ue(s).SVGElement}function u7(s){return s instanceof MouseEvent||s instanceof Ue(s).MouseEvent}function yu(s){return s instanceof KeyboardEvent||s instanceof Ue(s).KeyboardEvent}const Le={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"};function x1e(s){const e=s;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const Rt={stop:(s,e)=>(s.preventDefault(),e&&s.stopPropagation(),s)};function L1e(s){const e=[];for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)e[t]=s.scrollTop,s=s.parentNode;return e}function k1e(s,e){for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)s.scrollTop!==e[t]&&(s.scrollTop=e[t]),s=s.parentNode}let E1e=class R4 extends le{get onDidFocus(){return this._onDidFocus.event}get onDidBlur(){return this._onDidBlur.event}static hasFocusWithin(e){if(nn(e)){const t=om(e),i=t?t.activeElement:e.ownerDocument.activeElement;return Gn(i,e)}else{const t=e;return Gn(t.document.activeElement,t.document)}}constructor(e){super(),this._onDidFocus=this._register(new Z),this._onDidBlur=this._register(new Z);let t=R4.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(i=!0,(nn(e)?Ue(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{R4.hasFocusWithin(e)!==t&&(t?r():n())},this._register(ie(e,Le.FOCUS,n,!0)),this._register(ie(e,Le.BLUR,r,!0)),nn(e)&&(this._register(ie(e,Le.FOCUS_IN,()=>this._refreshStateHandler())),this._register(ie(e,Le.FOCUS_OUT,()=>this._refreshStateHandler())))}};function C1(s){return new E1e(s)}function D1e(s,e){return s.after(e),e}function Be(s,...e){if(s.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function mD(s,e){return s.insertBefore(e,s.firstChild),e}function Ds(s,...e){s.textContent="",Be(s,...e)}const T1e=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Tv;(function(s){s.HTML="http://www.w3.org/1999/xhtml",s.SVG="http://www.w3.org/2000/svg"})(Tv||(Tv={}));function nZ(s,e,t,...i){const n=T1e.exec(e);if(!n)throw new Error("Bad use of emmet");const r=n[1]||"div";let o;return s!==Tv.HTML?o=document.createElementNS(s,r):o=document.createElement(r),n[3]&&(o.id=n[3]),n[4]&&(o.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?o[a]=l:a==="selected"?l&&o.setAttribute(a,"true"):o.setAttribute(a,l))}),o.append(...i),o}function Ke(s,e,...t){return nZ(Tv.HTML,s,e,...t)}Ke.SVG=function(s,e,...t){return nZ(Tv.SVG,s,e,...t)};function sZ(...s){for(const e of s)e.style.display="",e.removeAttribute("aria-hidden")}function Dz(...s){for(const e of s)e.style.display="none",e.setAttribute("aria-hidden","true")}function Tz(s,e){const t=s.devicePixelRatio*e;return Math.max(1,Math.floor(t))/s.devicePixelRatio}function rZ(s){ni.open(s,"_blank","noopener")}function N1e(s,e){const t=()=>{e(),i=Ar(s,t)};let i=Ar(s,t);return qe(()=>i.dispose())}UX.setPreferredWebSchema(/^https:/.test(ni.location.href)?"https":"http");class id extends Z{constructor(){super(),this._subscriptions=new Pe,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(Se.runAndSubscribe(zC,({window:e,disposables:t})=>this.registerListeners(e,t),{window:ni,disposables:this._subscriptions}))}registerListeners(e,t){t.add(ie(e,"keydown",i=>{if(i.defaultPrevented)return;const n=new si(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(ie(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(ie(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(ie(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(ie(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(ie(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return id.instance||(id.instance=new id),id.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class I1e extends le{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(ie(this.element,Le.DRAG_START,e=>{var t,i;(i=(t=this.callbacks).onDragStart)==null||i.call(t,e)})),this.callbacks.onDrag&&this._register(ie(this.element,Le.DRAG,e=>{var t,i;(i=(t=this.callbacks).onDrag)==null||i.call(t,e)})),this._register(ie(this.element,Le.DRAG_ENTER,e=>{var t,i;this.counter++,this.dragStartTime=e.timeStamp,(i=(t=this.callbacks).onDragEnter)==null||i.call(t,e)})),this._register(ie(this.element,Le.DRAG_OVER,e=>{var t,i;e.preventDefault(),(i=(t=this.callbacks).onDragOver)==null||i.call(t,e,e.timeStamp-this.dragStartTime)})),this._register(ie(this.element,Le.DRAG_LEAVE,e=>{var t,i;this.counter--,this.counter===0&&(this.dragStartTime=0,(i=(t=this.callbacks).onDragLeave)==null||i.call(t,e))})),this._register(ie(this.element,Le.DRAG_END,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDragEnd)==null||i.call(t,e)})),this._register(ie(this.element,Le.DROP,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDrop)==null||i.call(t,e)}))}}const R1e=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Et(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=R1e.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const r=n.groups.tag||"div",o=document.createElement(r);n.groups.id&&(o.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(o.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=o),i)for(const c of i)nn(c)?o.appendChild(c):typeof c=="string"?o.append(c):"root"in c&&(Object.assign(l,c),o.appendChild(c.root));for(const[c,h]of Object.entries(t))if(c!=="className")if(c==="style")for(const[d,g]of Object.entries(h))o.style.setProperty(Nv(d),typeof g=="number"?g+"px":""+g);else c==="tabIndex"?o.tabIndex=h:o.setAttribute(Nv(c),h.toString());return l.root=o,l}function Nv(s){return s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function gl(s){return s.tagName.toLowerCase()==="input"||s.tagName.toLowerCase()==="textarea"||nn(s)&&!!s.editContext}var Nz;(function(s){function e(n=void 0){return(r,o,a)=>{const l=o.class;delete o.class;const c=o.ref;delete o.ref;const h=o.obsRef;return delete o.obsRef,new M1e(r,c,h,n,l,o,a)}}function t(n,r=void 0){const o=e(r);return(a,l)=>o(n,a,l)}s.div=t("div"),s.elem=e(void 0),s.svg=t("svg","http://www.w3.org/2000/svg"),s.svgElem=e("http://www.w3.org/2000/svg");function i(){let n;const r=function(o){n=o};return Object.defineProperty(r,"element",{get(){if(!n)throw new $e("Make sure the ref is set before accessing the element. Maybe wrong initialization order?");return n}}),r}s.ref=i})(Nz||(Nz={}));class h7{constructor(e,t,i,n,r,o,a){this._deriveds=[],this._element=n?document.createElementNS(n,e):document.createElement(e),t&&t(this._element),i&&this._deriveds.push(We(c=>{i(this),c.store.add({dispose:()=>{i(null)}})})),r&&(aZ(r)?this._deriveds.push(We(this,c=>{Iz(this._element,Rz(r,c))})):Iz(this._element,Rz(r,void 0)));for(const[c,h]of Object.entries(o))if(c==="style")for(const[d,g]of Object.entries(h)){const p=Nv(d);lg(g)?this._deriveds.push(sc({owner:this,debugName:()=>`set.style.${p}`},_=>{this._element.style.setProperty(p,Az(g.read(_)))})):this._element.style.setProperty(p,Az(g))}else c==="tabIndex"?lg(h)?this._deriveds.push(We(this,d=>{this._element.tabIndex=h.read(d)})):this._element.tabIndex=h:c.startsWith("on")?this._element[c]=h:lg(h)?this._deriveds.push(sc({owner:this,debugName:()=>`set.${c}`},d=>{Mz(this._element,c,h.read(d))})):Mz(this._element,c,h);if(a){let c=function(d,g){return lg(g)?c(d,g.read(d)):Array.isArray(g)?g.flatMap(p=>c(d,p)):g instanceof h7?(d&&g.readEffect(d),[g._element]):g?[g]:[]};var l=c;const h=We(this,d=>{this._element.replaceChildren(...c(d,a))});this._deriveds.push(h),lZ(a)||h.get()}}readEffect(e){for(const t of this._deriveds)t.read(e)}keepUpdated(e){return We(t=>{this.readEffect(t)}).recomputeInitiallyAndOnChange(e),this}toDisposableLiveElement(){const e=new Pe;return this.keepUpdated(e),new A1e(this._element,e)}}function Iz(s,e){iZ(s)?s.setAttribute("class",e):s.className=e}function oZ(s,e,t){if(lg(s)){t(s.read(e));return}if(Array.isArray(s)){for(const i of s)oZ(i,e,t);return}t(s)}function Rz(s,e){let t="";return oZ(s,e,i=>{i&&(t.length===0?t=i:t+=" "+i)}),t}function aZ(s){return lg(s)?!0:Array.isArray(s)?s.some(e=>aZ(e)):!1}function Az(s){return typeof s=="number"?s+"px":s}function lZ(s){return lg(s)?!0:Array.isArray(s)?s.some(e=>lZ(e)):!1}class A1e{constructor(e,t){this.element=e,this._disposable=t}dispose(){this._disposable.dispose()}}class M1e extends h7{constructor(){super(...arguments),this._isHovered=void 0,this._didMouseMoveDuringHover=void 0}get element(){return this._element}get isHovered(){if(!this._isHovered){const e=lt("hovered",!1);this._element.addEventListener("mouseenter",t=>e.set(!0,void 0)),this._element.addEventListener("mouseleave",t=>e.set(!1,void 0)),this._isHovered=e}return this._isHovered}get didMouseMoveDuringHover(){if(!this._didMouseMoveDuringHover){let e=!1;const t=lt("didMouseMoveDuringHover",!1);this._element.addEventListener("mouseenter",i=>{e=!0}),this._element.addEventListener("mousemove",i=>{e&&t.set(!0,void 0)}),this._element.addEventListener("mouseleave",i=>{e=!1,t.set(!1,void 0)}),this._didMouseMoveDuringHover=t}return this._didMouseMoveDuringHover}}function Mz(s,e,t){t==null?s.removeAttribute(Nv(e)):s.setAttribute(Nv(e),String(t))}function lg(s){return!!s&&s.read!==void 0&&s.reportChanges!==void 0}class O1e extends le{constructor(e){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){var i;(i=this._mediaQueryList)==null||i.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}}class P1e extends le{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const t=this._register(new O1e(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}class F1e{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const t=Dv(e);let i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=new P1e(e),this.mapWindowIdToPixelRatioMonitor.set(t,i),Se.once(g1e)(({vscodeWindowId:n})=>{n===t&&(i==null||i.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))})),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const lk=new F1e;class ck{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}focus(){this.domNode.focus()}setMaxWidth(e){const t=Ka(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=Ka(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=Ka(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=Ka(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=Ka(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=Ka(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=Ka(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=Ka(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=Ka(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=Ka(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=Ka(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Ka(s){return typeof s=="number"?`${s}px`:s}function Tt(s){return new ck(s)}function vs(s,e){s instanceof ck?(s.setFontFamily(e.getMassagedFontFamily()),s.setFontWeight(e.fontWeight),s.setFontSize(e.fontSize),s.setFontFeatureSettings(e.fontFeatureSettings),s.setFontVariationSettings(e.fontVariationSettings),s.setLineHeight(e.lineHeight),s.setLetterSpacing(e.letterSpacing)):(s.style.fontFamily=e.getMassagedFontFamily(),s.style.fontWeight=e.fontWeight,s.style.fontSize=e.fontSize+"px",s.style.fontFeatureSettings=e.fontFeatureSettings,s.style.fontVariationSettings=e.fontVariationSettings,s.style.lineHeight=e.lineHeight+"px",s.style.letterSpacing=e.letterSpacing+"px")}class B1e{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class d7{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){var t;this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),(t=this._container)==null||t.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");vs(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");vs(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");vs(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const r=[];for(const o of this._requests){let a;o.type===0&&(a=t),o.type===2&&(a=i),o.type===1&&(a=n),a.appendChild(document.createElement("br"));const l=document.createElement("span");d7._render(l,o),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let i="";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}}function V1e(s,e,t){new d7(e,t).read(s)}class H1e extends le{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){const t=Dv(e);let i=this._cache.get(t);return i||(i=new W1e,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){const t=this._ensureCache(e),i=t.getValues();let n=!1;for(const r of i)r.isTrusted||(n=!0,t.remove(r));n&&this._onDidChange.fire()}readFontInfo(e,t){const i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new ZL({pixelRatio:lk.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){const r=new B1e(e,t);return i.push(r),n==null||n.push(r),r}_actualReadFontInfo(e,t){const i=[],n=[],r=this._createRequest("n",0,i,n),o=this._createRequest("",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),c=this._createRequest("1",0,i,n),h=this._createRequest("2",0,i,n),d=this._createRequest("3",0,i,n),g=this._createRequest("4",0,i,n),p=this._createRequest("5",0,i,n),_=this._createRequest("6",0,i,n),b=this._createRequest("7",0,i,n),C=this._createRequest("8",0,i,n),x=this._createRequest("9",0,i,n),S=this._createRequest("",0,i,n),y=this._createRequest("",0,i,null),k=this._createRequest("",0,i,n),D=this._createRequest("",0,i,null),R="|/-_ilm%";for(let V=0,H=R.length;V<H;V++)this._createRequest(R.charAt(V),0,i,n),this._createRequest(R.charAt(V),1,i,n),this._createRequest(R.charAt(V),2,i,n);V1e(e,t,i);const N=Math.max(l.width,c.width,h.width,d.width,g.width,p.width,_.width,b.width,C.width,x.width);let A=t.fontFeatureSettings===Nd.OFF;const M=n[0].width;for(let V=1,H=n.length;A&&V<H;V++){const U=M-n[V].width;if(U<-.001||U>.001){A=!1;break}}let O=!0;return A&&y.width!==M&&(O=!1),y.width>S.width&&(O=!1),new ZL({pixelRatio:lk.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:A,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:o.width,canUseHalfwidthRightwardsArrow:O,spaceWidth:a.width,middotWidth:k.width,wsmiddotWidth:D.width,maxDigitWidth:N},!0)}}class W1e{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const A4=new H1e;var hl;(function(s){s.serviceIds=new Map,s.DI_TARGET="$di$target",s.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[s.DI_DEPENDENCIES]||[]}s.getServiceDependencies=e})(hl||(hl={}));const It=gt("instantiationService");function z1e(s,e,t){e[hl.DI_TARGET]===e?e[hl.DI_DEPENDENCIES].push({id:s,index:t}):(e[hl.DI_DEPENDENCIES]=[{id:s,index:t}],e[hl.DI_TARGET]=e)}function gt(s){if(hl.serviceIds.has(s))return hl.serviceIds.get(s);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");z1e(e,t,n)};return e.toString=()=>s,hl.serviceIds.set(s,e),e}const In=gt("codeEditorService"),mr=gt("modelService"),pD=gt("textModelService");class wd extends le{get onDidChange(){return this._onDidChange.event}constructor(e,t="",i="",n=!0,r){super(),this._onDidChange=this._register(new Z),this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class am extends le{constructor(){super(...arguments),this._onWillRun=this._register(new Z),this._onDidRun=this._register(new Z)}get onWillRun(){return this._onWillRun.event}get onDidRun(){return this._onDidRun.event}async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}}const Ow=class Ow{constructor(){this.id=Ow.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new Ow,...i]:t=i);return t}async run(){}};Ow.ID="vs.actions.separator";let is=Ow;class _D{get actions(){return this._actions}constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}}const q2=class q2 extends wd{constructor(){super(q2.ID,v(28,"(empty)"),void 0,!1)}};q2.ID="vs.actions.empty";let M4=q2;function Sg(s){return{id:s.id,label:s.label,tooltip:s.tooltip??s.label,class:s.class,enabled:s.enabled??!0,checked:s.checked,run:async(...e)=>s.run(...e)}}var O4;(function(s){function e(t){return!!t&&typeof t=="object"&&typeof t.id=="string"}s.isThemeColor=e})(O4||(O4={}));var Ct;(function(s){s.iconNameSegment="[A-Za-z0-9]+",s.iconNameExpression="[A-Za-z0-9-]+",s.iconModifierExpression="~[A-Za-z]+",s.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${s.iconNameExpression})(${s.iconModifierExpression})?$`);function t(_){const b=e.exec(_.id);if(!b)return t(Ae.error);const[,C,x]=b,S=["codicon","codicon-"+C];return x&&S.push("codicon-modifier-"+x.substring(1)),S}s.asClassNameArray=t;function i(_){return t(_).join(" ")}s.asClassName=i;function n(_){return"."+t(_).join(".")}s.asCSSSelector=n;function r(_){return!!_&&typeof _=="object"&&typeof _.id=="string"&&(typeof _.color>"u"||O4.isThemeColor(_.color))}s.isThemeIcon=r;const o=new RegExp(`^\\$\\((${s.iconNameExpression}(?:${s.iconModifierExpression})?)\\)$`);function a(_){const b=o.exec(_);if(!b)return;const[,C]=b;return{id:C}}s.fromString=a;function l(_){return{id:_}}s.fromId=l;function c(_,b){let C=_.id;const x=C.lastIndexOf("~");return x!==-1&&(C=C.substring(0,x)),b&&(C=`${C}~${b}`),{id:C}}s.modify=c;function h(_){const b=_.id.lastIndexOf("~");if(b!==-1)return _.id.substring(b+1)}s.getModifier=h;function d(_,b){var C,x;return _.id===b.id&&((C=_.color)==null?void 0:C.id)===((x=b.color)==null?void 0:x.id)}s.isEqual=d;function g(_){return(_==null?void 0:_.id)===Ae.file.id}s.isFile=g;function p(_){return(_==null?void 0:_.id)===Ae.folder.id}s.isFolder=p})(Ct||(Ct={}));const Ao=gt("commandService"),Or=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new Z,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(s,e){if(!s)throw new Error("invalid command");if(typeof s=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:s,handler:e})}if(s.metadata&&Array.isArray(s.metadata.args)){const o=[];for(const l of s.metadata.args)o.push(l.constraint);const a=s.handler;s.handler=function(l,...c){return rme(c,o),a(l,...c)}}const{id:t}=s;let i=this._commands.get(t);i||(i=new Dr,this._commands.set(t,i));const n=i.unshift(s),r=qe(()=>{n();const o=this._commands.get(t);o!=null&&o.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(s,e){return Or.registerCommand(s,(t,...i)=>t.get(Ao).executeCommand(e,...i))}getCommand(s){const e=this._commands.get(s);if(!(!e||e.isEmpty()))return Dt.first(e)}getCommands(){const s=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&s.set(e,t)}return s}};Or.registerCommand("noop",()=>{});function hR(...s){switch(s.length){case 1:return v(1693,"Did you mean {0}?",s[0]);case 2:return v(1694,"Did you mean {0} or {1}?",s[0],s[1]);case 3:return v(1695,"Did you mean {0}, {1} or {2}?",s[0],s[1],s[2]);default:return}}const U1e=v(1696,"Did you forget to open or close the quote?"),j1e=v(1697,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),p_=class p_{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw QL(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(hR("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(hR("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(hR("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=p_._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(U1e);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(j1e);return}const r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!i){e++;break}else r===91?i=!0:r===92?t=!0:r===93&&(i=!1);e++}for(;e<this._input.length&&p_._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};p_._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),p_._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);let Rf=p_;const Rs=new Map;Rs.set("false",!1);Rs.set("true",!0);Rs.set("isMac",_t);Rs.set("isLinux",Gr);Rs.set("isWindows",Rr);Rs.set("isWeb",oh);Rs.set("isMacNative",_t&&!oh);Rs.set("isEdge",hX);Rs.set("isFirefox",_me);Rs.set("isChrome",R6);Rs.set("isSafari",bme);const $1e=Object.prototype.hasOwnProperty,q1e={regexParsingWithErrorRecovery:!0},G1e=v(1675,"Empty context key expression"),K1e=v(1676,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),Y1e=v(1677,"'in' after 'not'."),Oz=v(1678,"closing parenthesis ')'"),Q1e=v(1679,"Unexpected token"),X1e=v(1680,"Did you forget to put && or || before the token?"),Z1e=v(1681,"Unexpected end of expression"),J1e=v(1682,"Did you forget to put a context key?");var Zl;let ebe=(Zl=class{constructor(e=q1e){this._config=e,this._scanner=new Rf,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:G1e,offset:0,lexeme:"",additionalInfo:K1e});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?X1e:void 0;throw this._parsingErrors.push({message:Q1e,offset:i.offset,lexeme:Rf.getLexeme(i),additionalInfo:n}),Zl._parseError}return t}catch(t){if(t!==Zl._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:xt.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:xt.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),dr.INSTANCE;case 12:return this._advance(),Mr.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,Oz),t==null?void 0:t.negate()}case 17:return this._advance(),Lm.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),xt.true();case 12:return this._advance(),xt.false();case 0:{this._advance();const t=this._expr();return this._consume(1,Oz),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const r=n.lexeme,o=r.lastIndexOf("/"),a=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let l;try{l=new RegExp(r.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return Iv.create(t,l)}switch(n.type){case 10:case 19:{const r=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let g=0;g<n.lexeme.length;g++)n.lexeme.charCodeAt(g)===40?a++:n.lexeme.charCodeAt(g)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let g=0;g<o.lexeme.length;g++)o.lexeme.charCodeAt(g)===40?a++:n.lexeme.charCodeAt(g)===41&&a--}if(a<0)break;r.push(Rf.getLexeme(o)),this._advance(),o=this._peek()}const l=r.join(""),c=l.lastIndexOf("/"),h=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),h)}catch{throw this._errExpectedButGot("REGEX",n)}return xt.regex(t,d)}case 18:{const r=n.lexeme;this._advance();let o=null;if(!s_e(r)){const a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){const c=r.slice(a+1,l),h=r[l+1]==="i"?"i":"";try{o=new RegExp(c,h)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return Iv.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,Y1e);const n=this._value();return xt.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return xt.equals(t,n);switch(n){case"true":return xt.has(t);case"false":return xt.not(t);default:return xt.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return xt.notEquals(t,n);switch(n){case"true":return xt.not(t);case"false":return xt.has(t);default:return xt.notEquals(t,n)}}case 5:return this._advance(),xD.create(t,this._value());case 6:return this._advance(),LD.create(t,this._value());case 7:return this._advance(),yD.create(t,this._value());case 8:return this._advance(),SD.create(t,this._value());case 13:return this._advance(),xt.in(t,this._value());default:return xt.has(t)}}case 20:throw this._parsingErrors.push({message:Z1e,offset:e.offset,lexeme:"",additionalInfo:J1e}),Zl._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=v(1683,`Expected: {0}
Received: '{1}'.`,e,Rf.getLexeme(t)),r=t.offset,o=Rf.getLexeme(t);return this._parsingErrors.push({message:n,offset:r,lexeme:o,additionalInfo:i}),Zl._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Zl._parseError=new Error,Zl);const c9=class c9{static false(){return dr.INSTANCE}static true(){return Mr.INSTANCE}static has(e){return xm.create(e)}static equals(e,t){return UC.create(e,t)}static notEquals(e,t){return vD.create(e,t)}static regex(e,t){return Iv.create(e,t)}static in(e,t){return bD.create(e,t)}static notIn(e,t){return wD.create(e,t)}static not(e){return Lm.create(e)}static and(...e){return cg.create(e,null,!0)}static or(...e){return Eu.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};c9._parser=new ebe({regexParsingWithErrorRecovery:!1});let xt=c9;function tbe(s,e){const t=s?s.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function Z0(s,e){return s.cmp(e)}const G2=class G2{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return Mr.INSTANCE}};G2.INSTANCE=new G2;let dr=G2;const K2=class K2{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return dr.INSTANCE}};K2.INSTANCE=new K2;let Mr=K2;class xm{static create(e,t=null){const i=Rs.get(e);return typeof i=="boolean"?i?Mr.INSTANCE:dr.INSTANCE:new xm(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:uZ(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Rs.get(this.key);return typeof e=="boolean"?e?Mr.INSTANCE:dr.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=Lm.create(this.key,this)),this.negated}}class UC{static create(e,t,i=null){if(typeof t=="boolean")return t?xm.create(e,i):Lm.create(e,i);const n=Rs.get(e);return typeof n=="boolean"?t===(n?"true":"false")?Mr.INSTANCE:dr.INSTANCE:new UC(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Rs.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Mr.INSTANCE:dr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=vD.create(this.key,this.value,this)),this.negated}}class bD{static create(e,t){return new bD(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?$1e.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=wD.create(this.key,this.valueKey)),this.negated}}class wD{static create(e,t){return new wD(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=bD.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class vD{static create(e,t,i=null){if(typeof t=="boolean")return t?Lm.create(e,i):xm.create(e,i);const n=Rs.get(e);return typeof n=="boolean"?t===(n?"true":"false")?dr.INSTANCE:Mr.INSTANCE:new vD(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Rs.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?dr.INSTANCE:Mr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=UC.create(this.key,this.value,this)),this.negated}}class Lm{static create(e,t=null){const i=Rs.get(e);return typeof i=="boolean"?i?dr.INSTANCE:Mr.INSTANCE:new Lm(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:uZ(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Rs.get(this.key);return typeof e=="boolean"?e?dr.INSTANCE:Mr.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=xm.create(this.key,this)),this.negated}}function CD(s,e){if(typeof s=="string"){const t=parseFloat(s);isNaN(t)||(s=t)}return typeof s=="string"||typeof s=="number"?e(s):dr.INSTANCE}class yD{static create(e,t,i=null){return CD(t,n=>new yD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=LD.create(this.key,this.value,this)),this.negated}}class SD{static create(e,t,i=null){return CD(t,n=>new SD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=xD.create(this.key,this.value,this)),this.negated}}class xD{static create(e,t,i=null){return CD(t,n=>new xD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=SD.create(this.key,this.value,this)),this.negated}}class LD{static create(e,t,i=null){return CD(t,n=>new LD(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:km(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=yD.create(this.key,this.value,this)),this.negated}}class Iv{static create(e,t){return new Iv(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=f7.create(this)),this.negated}}class f7{static create(e){return new f7(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function cZ(s){let e=null;for(let t=0,i=s.length;t<i;t++){const n=s[t].substituteConstants();if(s[t]!==n&&e===null){e=[];for(let r=0;r<t;r++)e[r]=s[r]}e!==null&&(e[t]=n)}return e===null?s:e}class cg{static create(e,t,i){return cg._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=Z0(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=cZ(this.expr);return e===this.expr?this:cg.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let r=!1;for(const o of e)if(o){if(o.type===1){r=!0;continue}if(o.type===0)return dr.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&r)return Mr.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(Z0);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=Eu.create(o.expr.map(h=>cg.create([h,a],null,i)),null,l);c&&(n.push(c),n.sort(Z0))}if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return dr.INSTANCE;if(n.length===1)return n[0]}return new cg(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Eu.create(e,this,!0)}return this.negated}}class Eu{static create(e,t,i){return Eu._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=Z0(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=cZ(this.expr);return e===this.expr?this:Eu.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],r=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return Mr.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&r)return dr.INSTANCE;n.sort(Z0)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return Mr.INSTANCE;if(n.length===1)return n[0]}return new Eu(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const r of Fz(t))for(const o of Fz(i))n.push(cg.create([r,o],null,!1));e.unshift(Eu.create(n,null,!1))}this.negated=Eu.create(e,this,!0)}return this.negated}}const __=class __ extends xm{static all(){return __._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?__._info.push({...i,key:e}):i!==!0&&__._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return UC.create(this.key,e)}};__._info=[];let He=__;const Ot=gt("contextKeyService");function uZ(s,e){return s<e?-1:s>e?1:0}function km(s,e,t,i){return s<t?-1:s>t?1:e<i?-1:e>i?1:0}function P4(s,e){if(s.type===0||e.type===1)return!0;if(s.type===9)return e.type===9?Pz(s.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(P4(s,t))return!0;return!1}if(s.type===6){if(e.type===6)return Pz(e.expr,s.expr);for(const t of s.expr)if(P4(t,e))return!0;return!1}return s.equals(e)}function Pz(s,e){let t=0,i=0;for(;t<s.length&&i<e.length;){const n=s[t].cmp(e[i]);if(n<0)return!1;n===0&&t++,i++}return t===s.length}function Fz(s){return s.type===9?s.expr:[s]}class ibe{constructor(){this.data=new Map}add(e,t){XI(ns(e)),XI(ar(t)),XI(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{_1(e.dispose)&&e.dispose()}),this.data.clear()}}const ss=new ibe;class g7{constructor(){this._coreKeybindings=new Dr,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Na===1){if(e&&e.win)return e.win}else if(Na===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=g7.bindToCurrentPlatform(e),i=new Pe;if(t&&t.primary){const n=b4(t.primary,Na);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,r=t.secondary.length;n<r;n++){const o=t.secondary[n],a=b4(o,Na);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}registerCommandAndKeybindingRule(e){return nc(this.registerKeybindingRule(e),Or.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,r,o){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:o,weight1:n,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,qe(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(sbe)),this._cachedMergedKeybindings.slice(0)}}const Hd=new g7,nbe={EditorModes:"platform.keybindingsRegistry"};ss.add(nbe.EditorModes,Hd);function sbe(s,e){if(s.weight1!==e.weight1)return s.weight1-e.weight1;if(s.command&&e.command){if(s.command<e.command)return-1;if(s.command>e.command)return 1}return s.weight2-e.weight2}var rbe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Bz=function(s,e){return function(t,i){e(t,i,s)}},jx;function J0(s){return s.command!==void 0}function obe(s){return s.submenu!==void 0}const B=class B{constructor(e){if(B._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);B._instances.set(e,this),this.id=e}};B._instances=new Map,B.CommandPalette=new B("CommandPalette"),B.DebugBreakpointsContext=new B("DebugBreakpointsContext"),B.DebugCallStackContext=new B("DebugCallStackContext"),B.DebugConsoleContext=new B("DebugConsoleContext"),B.DebugVariablesContext=new B("DebugVariablesContext"),B.NotebookVariablesContext=new B("NotebookVariablesContext"),B.DebugHoverContext=new B("DebugHoverContext"),B.DebugWatchContext=new B("DebugWatchContext"),B.DebugToolBar=new B("DebugToolBar"),B.DebugToolBarStop=new B("DebugToolBarStop"),B.DebugDisassemblyContext=new B("DebugDisassemblyContext"),B.DebugCallStackToolbar=new B("DebugCallStackToolbar"),B.DebugCreateConfiguration=new B("DebugCreateConfiguration"),B.EditorContext=new B("EditorContext"),B.SimpleEditorContext=new B("SimpleEditorContext"),B.EditorContent=new B("EditorContent"),B.EditorLineNumberContext=new B("EditorLineNumberContext"),B.EditorContextCopy=new B("EditorContextCopy"),B.EditorContextPeek=new B("EditorContextPeek"),B.EditorContextShare=new B("EditorContextShare"),B.EditorTitle=new B("EditorTitle"),B.CompactWindowEditorTitle=new B("CompactWindowEditorTitle"),B.EditorTitleRun=new B("EditorTitleRun"),B.EditorTitleContext=new B("EditorTitleContext"),B.EditorTitleContextShare=new B("EditorTitleContextShare"),B.EmptyEditorGroup=new B("EmptyEditorGroup"),B.EmptyEditorGroupContext=new B("EmptyEditorGroupContext"),B.EditorTabsBarContext=new B("EditorTabsBarContext"),B.EditorTabsBarShowTabsSubmenu=new B("EditorTabsBarShowTabsSubmenu"),B.EditorTabsBarShowTabsZenModeSubmenu=new B("EditorTabsBarShowTabsZenModeSubmenu"),B.EditorActionsPositionSubmenu=new B("EditorActionsPositionSubmenu"),B.EditorSplitMoveSubmenu=new B("EditorSplitMoveSubmenu"),B.ExplorerContext=new B("ExplorerContext"),B.ExplorerContextShare=new B("ExplorerContextShare"),B.ExtensionContext=new B("ExtensionContext"),B.ExtensionEditorContextMenu=new B("ExtensionEditorContextMenu"),B.GlobalActivity=new B("GlobalActivity"),B.CommandCenter=new B("CommandCenter"),B.CommandCenterCenter=new B("CommandCenterCenter"),B.LayoutControlMenuSubmenu=new B("LayoutControlMenuSubmenu"),B.LayoutControlMenu=new B("LayoutControlMenu"),B.MenubarMainMenu=new B("MenubarMainMenu"),B.MenubarAppearanceMenu=new B("MenubarAppearanceMenu"),B.MenubarDebugMenu=new B("MenubarDebugMenu"),B.MenubarEditMenu=new B("MenubarEditMenu"),B.MenubarCopy=new B("MenubarCopy"),B.MenubarFileMenu=new B("MenubarFileMenu"),B.MenubarGoMenu=new B("MenubarGoMenu"),B.MenubarHelpMenu=new B("MenubarHelpMenu"),B.MenubarLayoutMenu=new B("MenubarLayoutMenu"),B.MenubarNewBreakpointMenu=new B("MenubarNewBreakpointMenu"),B.PanelAlignmentMenu=new B("PanelAlignmentMenu"),B.PanelPositionMenu=new B("PanelPositionMenu"),B.ActivityBarPositionMenu=new B("ActivityBarPositionMenu"),B.MenubarPreferencesMenu=new B("MenubarPreferencesMenu"),B.MenubarRecentMenu=new B("MenubarRecentMenu"),B.MenubarSelectionMenu=new B("MenubarSelectionMenu"),B.MenubarShare=new B("MenubarShare"),B.MenubarSwitchEditorMenu=new B("MenubarSwitchEditorMenu"),B.MenubarSwitchGroupMenu=new B("MenubarSwitchGroupMenu"),B.MenubarTerminalMenu=new B("MenubarTerminalMenu"),B.MenubarTerminalSuggestStatusMenu=new B("MenubarTerminalSuggestStatusMenu"),B.MenubarViewMenu=new B("MenubarViewMenu"),B.MenubarHomeMenu=new B("MenubarHomeMenu"),B.OpenEditorsContext=new B("OpenEditorsContext"),B.OpenEditorsContextShare=new B("OpenEditorsContextShare"),B.ProblemsPanelContext=new B("ProblemsPanelContext"),B.SCMInputBox=new B("SCMInputBox"),B.SCMChangeContext=new B("SCMChangeContext"),B.SCMResourceContext=new B("SCMResourceContext"),B.SCMResourceContextShare=new B("SCMResourceContextShare"),B.SCMResourceFolderContext=new B("SCMResourceFolderContext"),B.SCMResourceGroupContext=new B("SCMResourceGroupContext"),B.SCMSourceControl=new B("SCMSourceControl"),B.SCMSourceControlInline=new B("SCMSourceControlInline"),B.SCMSourceControlTitle=new B("SCMSourceControlTitle"),B.SCMHistoryTitle=new B("SCMHistoryTitle"),B.SCMHistoryItemContext=new B("SCMHistoryItemContext"),B.SCMHistoryItemChangeContext=new B("SCMHistoryItemChangeContext"),B.SCMHistoryItemRefContext=new B("SCMHistoryItemRefContext"),B.SCMArtifactGroupContext=new B("SCMArtifactGroupContext"),B.SCMArtifactContext=new B("SCMArtifactContext"),B.SCMQuickDiffDecorations=new B("SCMQuickDiffDecorations"),B.SCMTitle=new B("SCMTitle"),B.SearchContext=new B("SearchContext"),B.SearchActionMenu=new B("SearchActionContext"),B.StatusBarWindowIndicatorMenu=new B("StatusBarWindowIndicatorMenu"),B.StatusBarRemoteIndicatorMenu=new B("StatusBarRemoteIndicatorMenu"),B.StickyScrollContext=new B("StickyScrollContext"),B.TestItem=new B("TestItem"),B.TestItemGutter=new B("TestItemGutter"),B.TestProfilesContext=new B("TestProfilesContext"),B.TestMessageContext=new B("TestMessageContext"),B.TestMessageContent=new B("TestMessageContent"),B.TestPeekElement=new B("TestPeekElement"),B.TestPeekTitle=new B("TestPeekTitle"),B.TestCallStack=new B("TestCallStack"),B.TestCoverageFilterItem=new B("TestCoverageFilterItem"),B.TouchBarContext=new B("TouchBarContext"),B.TitleBar=new B("TitleBar"),B.TitleBarContext=new B("TitleBarContext"),B.TitleBarTitleContext=new B("TitleBarTitleContext"),B.TunnelContext=new B("TunnelContext"),B.TunnelPrivacy=new B("TunnelPrivacy"),B.TunnelProtocol=new B("TunnelProtocol"),B.TunnelPortInline=new B("TunnelInline"),B.TunnelTitle=new B("TunnelTitle"),B.TunnelLocalAddressInline=new B("TunnelLocalAddressInline"),B.TunnelOriginInline=new B("TunnelOriginInline"),B.ViewItemContext=new B("ViewItemContext"),B.ViewContainerTitle=new B("ViewContainerTitle"),B.ViewContainerTitleContext=new B("ViewContainerTitleContext"),B.ViewTitle=new B("ViewTitle"),B.ViewTitleContext=new B("ViewTitleContext"),B.CommentEditorActions=new B("CommentEditorActions"),B.CommentThreadTitle=new B("CommentThreadTitle"),B.CommentThreadActions=new B("CommentThreadActions"),B.CommentThreadAdditionalActions=new B("CommentThreadAdditionalActions"),B.CommentThreadTitleContext=new B("CommentThreadTitleContext"),B.CommentThreadCommentContext=new B("CommentThreadCommentContext"),B.CommentTitle=new B("CommentTitle"),B.CommentActions=new B("CommentActions"),B.CommentsViewThreadActions=new B("CommentsViewThreadActions"),B.InteractiveToolbar=new B("InteractiveToolbar"),B.InteractiveCellTitle=new B("InteractiveCellTitle"),B.InteractiveCellDelete=new B("InteractiveCellDelete"),B.InteractiveCellExecute=new B("InteractiveCellExecute"),B.InteractiveInputExecute=new B("InteractiveInputExecute"),B.InteractiveInputConfig=new B("InteractiveInputConfig"),B.ReplInputExecute=new B("ReplInputExecute"),B.IssueReporter=new B("IssueReporter"),B.NotebookToolbar=new B("NotebookToolbar"),B.NotebookToolbarContext=new B("NotebookToolbarContext"),B.NotebookStickyScrollContext=new B("NotebookStickyScrollContext"),B.NotebookCellTitle=new B("NotebookCellTitle"),B.NotebookCellDelete=new B("NotebookCellDelete"),B.NotebookCellInsert=new B("NotebookCellInsert"),B.NotebookCellBetween=new B("NotebookCellBetween"),B.NotebookCellListTop=new B("NotebookCellTop"),B.NotebookCellExecute=new B("NotebookCellExecute"),B.NotebookCellExecuteGoTo=new B("NotebookCellExecuteGoTo"),B.NotebookCellExecutePrimary=new B("NotebookCellExecutePrimary"),B.NotebookDiffCellInputTitle=new B("NotebookDiffCellInputTitle"),B.NotebookDiffDocumentMetadata=new B("NotebookDiffDocumentMetadata"),B.NotebookDiffCellMetadataTitle=new B("NotebookDiffCellMetadataTitle"),B.NotebookDiffCellOutputsTitle=new B("NotebookDiffCellOutputsTitle"),B.NotebookOutputToolbar=new B("NotebookOutputToolbar"),B.NotebookOutlineFilter=new B("NotebookOutlineFilter"),B.NotebookOutlineActionMenu=new B("NotebookOutlineActionMenu"),B.NotebookEditorLayoutConfigure=new B("NotebookEditorLayoutConfigure"),B.NotebookKernelSource=new B("NotebookKernelSource"),B.BulkEditTitle=new B("BulkEditTitle"),B.BulkEditContext=new B("BulkEditContext"),B.TimelineItemContext=new B("TimelineItemContext"),B.TimelineTitle=new B("TimelineTitle"),B.TimelineTitleContext=new B("TimelineTitleContext"),B.TimelineFilterSubMenu=new B("TimelineFilterSubMenu"),B.AccountsContext=new B("AccountsContext"),B.SidebarTitle=new B("SidebarTitle"),B.PanelTitle=new B("PanelTitle"),B.AuxiliaryBarTitle=new B("AuxiliaryBarTitle"),B.TerminalInstanceContext=new B("TerminalInstanceContext"),B.TerminalEditorInstanceContext=new B("TerminalEditorInstanceContext"),B.TerminalNewDropdownContext=new B("TerminalNewDropdownContext"),B.TerminalTabContext=new B("TerminalTabContext"),B.TerminalTabEmptyAreaContext=new B("TerminalTabEmptyAreaContext"),B.TerminalStickyScrollContext=new B("TerminalStickyScrollContext"),B.WebviewContext=new B("WebviewContext"),B.InlineCompletionsActions=new B("InlineCompletionsActions"),B.InlineEditsActions=new B("InlineEditsActions"),B.NewFile=new B("NewFile"),B.MergeInput1Toolbar=new B("MergeToolbar1Toolbar"),B.MergeInput2Toolbar=new B("MergeToolbar2Toolbar"),B.MergeBaseToolbar=new B("MergeBaseToolbar"),B.MergeInputResultToolbar=new B("MergeToolbarResultToolbar"),B.InlineSuggestionToolbar=new B("InlineSuggestionToolbar"),B.InlineEditToolbar=new B("InlineEditToolbar"),B.ChatContext=new B("ChatContext"),B.ChatCodeBlock=new B("ChatCodeblock"),B.ChatCompareBlock=new B("ChatCompareBlock"),B.ChatMessageTitle=new B("ChatMessageTitle"),B.ChatHistory=new B("ChatHistory"),B.ChatWelcomeContext=new B("ChatWelcomeContext"),B.ChatMessageFooter=new B("ChatMessageFooter"),B.ChatExecute=new B("ChatExecute"),B.ChatInput=new B("ChatInput"),B.ChatInputSide=new B("ChatInputSide"),B.ChatModePicker=new B("ChatModePicker"),B.ChatEditingWidgetToolbar=new B("ChatEditingWidgetToolbar"),B.ChatEditingEditorContent=new B("ChatEditingEditorContent"),B.ChatEditingEditorHunk=new B("ChatEditingEditorHunk"),B.ChatEditingDeletedNotebookCell=new B("ChatEditingDeletedNotebookCell"),B.ChatInputAttachmentToolbar=new B("ChatInputAttachmentToolbar"),B.ChatEditingWidgetModifiedFilesToolbar=new B("ChatEditingWidgetModifiedFilesToolbar"),B.ChatInputResourceAttachmentContext=new B("ChatInputResourceAttachmentContext"),B.ChatInputSymbolAttachmentContext=new B("ChatInputSymbolAttachmentContext"),B.ChatInlineResourceAnchorContext=new B("ChatInlineResourceAnchorContext"),B.ChatInlineSymbolAnchorContext=new B("ChatInlineSymbolAnchorContext"),B.ChatMessageCheckpoint=new B("ChatMessageCheckpoint"),B.ChatMessageRestoreCheckpoint=new B("ChatMessageRestoreCheckpoint"),B.ChatNewMenu=new B("ChatNewMenu"),B.ChatEditingCodeBlockContext=new B("ChatEditingCodeBlockContext"),B.ChatTitleBarMenu=new B("ChatTitleBarMenu"),B.ChatAttachmentsContext=new B("ChatAttachmentsContext"),B.ChatToolOutputResourceToolbar=new B("ChatToolOutputResourceToolbar"),B.ChatTextEditorMenu=new B("ChatTextEditorMenu"),B.ChatToolOutputResourceContext=new B("ChatToolOutputResourceContext"),B.ChatMultiDiffContext=new B("ChatMultiDiffContext"),B.ChatSessionsMenu=new B("ChatSessionsMenu"),B.ChatSessionsCreateSubMenu=new B("ChatSessionsCreateSubMenu"),B.ChatConfirmationMenu=new B("ChatConfirmationMenu"),B.ChatEditorInlineExecute=new B("ChatEditorInputExecute"),B.ChatEditorInlineInputSide=new B("ChatEditorInputSide"),B.AccessibleView=new B("AccessibleView"),B.MultiDiffEditorFileToolbar=new B("MultiDiffEditorFileToolbar"),B.DiffEditorHunkToolbar=new B("DiffEditorHunkToolbar"),B.DiffEditorSelectionToolbar=new B("DiffEditorSelectionToolbar");let xn=B;const Em=gt("menuService"),Pw=class Pw{static for(e){let t=this._all.get(e);return t||(t=new Pw(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof Pw&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}};Pw._all=new Map;let Af=Pw;const y1=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new Dme({merge:Af.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(s){return this._commands.set(s.id,s),this._onDidChangeMenu.fire(Af.for(xn.CommandPalette)),qe(()=>{this._commands.delete(s.id)&&this._onDidChangeMenu.fire(Af.for(xn.CommandPalette))})}getCommand(s){return this._commands.get(s)}getCommands(){const s=new Map;return this._commands.forEach((e,t)=>s.set(t,e)),s}appendMenuItem(s,e){let t=this._menuItems.get(s);t||(t=new Dr,this._menuItems.set(s,t));const i=t.push(e);return this._onDidChangeMenu.fire(Af.for(s)),qe(()=>{i(),this._onDidChangeMenu.fire(Af.for(s))})}appendMenuItems(s){const e=new Pe;for(const{id:t,item:i}of s)e.add(this.appendMenuItem(t,i));return e}getMenuItems(s){let e;return this._menuItems.has(s)?e=[...this._menuItems.get(s)]:e=[],s===xn.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(s){const e=new Set;for(const t of s)J0(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||s.push({command:t})})}};class P_ extends _D{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let $u=jx=class{static label(e,t){return t!=null&&t.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,n,r,o,a){var c;this.hideActions=n,this.menuKeybinding=r,this._commandService=a,this.id=e.id,this.label=jx.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:(c=e.tooltip)==null?void 0:c.value)??"",this.enabled=!e.precondition||o.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){const h=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=o.contextMatchesRules(h.condition),this.checked&&h.tooltip&&(this.tooltip=typeof h.tooltip=="string"?h.tooltip:h.tooltip.value),this.checked&&Ct.isThemeIcon(h.icon)&&(l=h.icon),this.checked&&h.title&&(this.label=typeof h.title=="string"?h.title:h.title.value)}l||(l=Ct.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new jx(t,void 0,i,n,void 0,o,a):void 0,this._options=i,this.class=l&&Ct.asClassName(l)}run(...e){var i,n;let t=[];return(i=this._options)!=null&&i.arg&&(t=[...t,this._options.arg]),(n=this._options)!=null&&n.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};$u=jx=rbe([Bz(5,Ot),Bz(6,Ao)],$u);const ah=gt("telemetryService");var Vz,Hz,Wz;class abe{constructor(e,t){this.uri=e,this.value=t}}function lbe(s){return Array.isArray(s)}const Zf=class Zf{constructor(e,t){if(this[Vz]="ResourceMap",e instanceof Zf)this.map=new Map(e.map),this.toKey=t??Zf.defaultToKey;else if(lbe(e)){this.map=new Map,this.toKey=t??Zf.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Zf.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new abe(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(Vz=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};Zf.defaultToKey=e=>e.toString();let Ts=Zf;class cbe{constructor(e,t){this[Hz]="ResourceSet",!e||typeof e=="function"?this._map=new Ts(e):(this._map=new Ts(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Hz=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}class ube{constructor(){this[Wz]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}[(Wz=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class hbe extends ube{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class jC extends hbe{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class dbe{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class hZ{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}}class kD{constructor(){this._data=new Map}set(e,...t){let i=this._data;for(let n=0;n<t.length-1;n++)i.has(t[n])||i.set(t[n],new Map),i=i.get(t[n]);i.set(t[t.length-1],e)}get(...e){let t=this._data;for(let i=0;i<e.length-1;i++){if(!t.has(e[i]))return;t=t.get(e[i])}return t.get(e[e.length-1])}clear(){this._data.clear()}toString(){const e=(t,i)=>{let n="";for(const[r,o]of t)n+=`${"  ".repeat(i)}${r}: `,o instanceof Map?n+=`
`+e(o,i+1):n+=`${o}
`;return n};return e(this._data,0)}}function Fh(s){return s===47||s===92}function dZ(s){return s.replace(/[\\/]/g,dn.sep)}function fbe(s){return s.indexOf("/")===-1&&(s=dZ(s)),/^[a-zA-Z]:(\/|$)/.test(s)&&(s="/"+s),s}function zz(s,e=dn.sep){if(!s)return"";const t=s.length,i=s.charCodeAt(0);if(Fh(i)){if(Fh(s.charCodeAt(1))&&!Fh(s.charCodeAt(2))){let r=3;const o=r;for(;r<t&&!Fh(s.charCodeAt(r));r++);if(o!==r&&!Fh(s.charCodeAt(r+1))){for(r+=1;r<t;r++)if(Fh(s.charCodeAt(r)))return s.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(gbe(i)&&s.charCodeAt(1)===58)return Fh(s.charCodeAt(2))?s.slice(0,2)+e:s.slice(0,2);let n=s.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(Fh(s.charCodeAt(n)))return s.slice(0,n+1)}return""}function F4(s,e,t,i=bd){if(s===e)return!0;if(!s||!e||e.length>s.length)return!1;if(t){if(!W6(s,e))return!1;if(e.length===s.length)return!0;let r=e.length;return e.charAt(e.length-1)===i&&r--,s.charAt(r)===i}return e.charAt(e.length-1)!==i&&(e+=i),s.indexOf(e)===0}function gbe(s){return s>=65&&s<=90||s>=97&&s<=122}function iu(s){return sk(s,!0)}class mbe{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:m4(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===tt.file)return F4(iu(e),iu(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(jz(e.authority,t.authority))return F4(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return mt.joinPath(e,...t)}basenameOrAuthority(e){return m7(e)||e.authority}basename(e){return dn.basename(e.path)}extname(e){return dn.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===tt.file?t=mt.file(Vpe(iu(e))).path:(t=dn.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===tt.file?t=mt.file(LX(iu(e))).path:t=dn.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!jz(e.authority,t.authority))return;if(e.scheme===tt.file){const r=Bpe(iu(e),iu(t));return Rr?dZ(r):r}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(i.length,n.length);r<o&&!(i.charCodeAt(r)!==n.charCodeAt(r)&&i.charAt(r).toLowerCase()!==n.charAt(r).toLowerCase());r++);i=n.substr(0,r)+i.substr(r)}return dn.relative(i,n)}resolvePath(e,t){if(e.scheme===tt.file){const i=mt.file(Fpe(iu(e),t));return e.with({authority:i.authority,path:i.path})}return t=fbe(t),e.with({path:dn.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&og(e,t)}hasTrailingPathSeparator(e,t=bd){if(e.scheme===tt.file){const i=iu(e);return i.length>zz(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=bd){return $z(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=bd){let i=!1;if(e.scheme===tt.file){const n=iu(e);i=n!==void 0&&n.length===zz(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!$z(e,t)?e.with({path:e.path+"/"}):e}}const Ei=new mbe(()=>!1),pbe=Ei.isEqual.bind(Ei);Ei.isEqualOrParent.bind(Ei);Ei.getComparisonKey.bind(Ei);Ei.basenameOrAuthority.bind(Ei);const m7=Ei.basename.bind(Ei);Ei.extname.bind(Ei);const _be=Ei.dirname.bind(Ei),bbe=Ei.joinPath.bind(Ei),wbe=Ei.normalizePath.bind(Ei);Ei.relativePath.bind(Ei);const Uz=Ei.resolvePath.bind(Ei);Ei.isAbsolutePath.bind(Ei);const jz=Ei.isEqualAuthority.bind(Ei),$z=Ei.hasTrailingPathSeparator.bind(Ei);Ei.removeTrailingPathSeparator.bind(Ei);Ei.addTrailingPathSeparator.bind(Ei);var uk;(function(s){s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&i.set(a,l)});const r=t.path.substring(0,t.path.indexOf(";"));return r&&i.set(s.META_DATA_MIME,r),i}s.parseMetaData=e})(uk||(uk={}));const pr=gt("logService"),vbe=gt("loggerService");var jn;(function(s){s[s.Off=0]="Off",s[s.Trace=1]="Trace",s[s.Debug=2]="Debug",s[s.Info=3]="Info",s[s.Warning=4]="Warning",s[s.Error=5]="Error"})(jn||(jn={}));const fZ=jn.Info;function Cbe(s,e){return s!==jn.Off&&s<=e}class gZ extends le{constructor(){super(...arguments),this.level=fZ,this._onDidChangeLogLevel=this._register(new Z)}get onDidChangeLogLevel(){return this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return Cbe(this.level,e)}canLog(e){return this._store.isDisposed?!1:this.checkLogLevel(e)}}class ybe extends gZ{constructor(e=fZ,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.canLog(jn.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.canLog(jn.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.canLog(jn.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.canLog(jn.Warning)&&(this.useColors?console.warn("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.canLog(jn.Error)&&(this.useColors?console.error("%c  ERR","color: #f33",e,...t):console.error(e,...t))}}class Sbe extends gZ{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class xbe extends le{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new Ts,this._onDidChangeLoggers=this._register(new Z),this._onDidChangeVisibility=this._register(new Z),i)for(const n of i)this._loggers.set(n.resource,{logger:void 0,info:n})}getLoggerEntry(e){return ns(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}createLogger(e,t){var l;const i=this.toResource(e),n=ns(e)?e:(t==null?void 0:t.id)??Z6(i.toString()).toString(16);let r=(l=this._loggers.get(i))==null?void 0:l.logger;const o=(t==null?void 0:t.logLevel)==="always"?jn.Trace:t==null?void 0:t.logLevel;r||(r=this.doCreateLogger(i,o??this.getLogLevel(i)??this.logLevel,{...t,id:n}));const a={logger:r,info:{resource:i,id:n,logLevel:o,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,group:t==null?void 0:t.group,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(i,a),r}toResource(e){return ns(e)?bbe(this.logsHome,`${e}.log`):e}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){var i;let t;return e&&(t=(i=this._loggers.get(e))==null?void 0:i.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}class Lbe{constructor(){this.onDidChangeLogLevel=new Z().event}setLevel(e){}getLevel(){return jn.Info}trace(e,...t){}debug(e,...t){}info(e,...t){}warn(e,...t){}error(e,...t){}dispose(){}}class kbe extends xbe{constructor(){super(jn.Off,mt.parse("log:///log"))}doCreateLogger(e,t,i){return new Lbe}}function Ebe(s){switch(s){case jn.Trace:return"trace";case jn.Debug:return"debug";case jn.Info:return"info";case jn.Warning:return"warn";case jn.Error:return"error";case jn.Off:return"off"}}new He("logLevel",Ebe(jn.Info));const Fw=class Fw{static getRegisteredCommands(){return[...Fw.REGISTERED_COMMANDS]}static registerCommand(e){Fw.REGISTERED_COMMANDS.add(e)}};Fw.REGISTERED_COMMANDS=new Set;let B4=Fw;class ED{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata,this.canTriggerInlineEdits=e.canTriggerInlineEdits}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=xt.and(i,this.precondition):i=this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Hd.registerKeybindingRule(n)}}Or.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata}),this.canTriggerInlineEdits&&B4.registerCommand(this.id)}_registerMenuItem(e){y1.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class p7 extends ED{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((r,o)=>o.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===i){this._implementations.splice(r,1);return}}}}runCommand(e,t){const i=e.get(pr),n=e.get(Ot);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const r of this._implementations){if(r.when){const a=n.getContext(Kn());if(!r.when.evaluate(a))continue}const o=r.implementation(e,t);if(o)return i.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof o=="boolean"?void 0:o}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class mZ extends ED{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class lm extends ED{static bindToContribution(e){return class extends lm{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,r){const o=e(n);o&&this._callback(o,r)}}}static runEditorCommand(e,t,i,n){const r=e.get(In),o=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(o)return o.invokeWithinContext(a=>{if(a.get(Ot).contextMatchesRules(i??void 0))return n(a,o,t)})}runCommand(e,t){return lm.runEditorCommand(e,t,this.precondition,(i,n,r)=>this.runEditorCommand(i,n,r))}}function ot(s){return Ql.INSTANCE.registerEditorCommand(s),s}function pZ(s,e,t){Ql.INSTANCE.registerEditorContribution(s,e,t)}var F_;(function(s){function e(o){return Ql.INSTANCE.getEditorCommand(o)}s.getEditorCommand=e;function t(){return Ql.INSTANCE.getEditorActions()}s.getEditorActions=t;function i(){return Ql.INSTANCE.getEditorContributions()}s.getEditorContributions=i;function n(o){return Ql.INSTANCE.getEditorContributions().filter(a=>o.indexOf(a.id)>=0)}s.getSomeEditorContributions=n;function r(){return Ql.INSTANCE.getDiffEditorContributions()}s.getDiffEditorContributions=r})(F_||(F_={}));const Dbe={EditorCommonContributions:"editor.contributions"},Y2=class Y2{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};Y2.INSTANCE=new Y2;let Ql=Y2;ss.add(Dbe.EditorCommonContributions,Ql.INSTANCE);function $C(s){return s.register(),s}const _Z=$C(new p7({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:xn.MenubarEditMenu,group:"1_do",title:v(69,"&&Undo"),order:1},{menuId:xn.CommandPalette,group:"",title:v(70,"Undo"),order:1},{menuId:xn.SimpleEditorContext,group:"1_do",title:v(71,"Undo"),order:1}]}));$C(new mZ(_Z,{id:"default:undo",precondition:void 0}));const bZ=$C(new p7({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:xn.MenubarEditMenu,group:"1_do",title:v(72,"&&Redo"),order:2},{menuId:xn.CommandPalette,group:"",title:v(73,"Redo"),order:1},{menuId:xn.SimpleEditorContext,group:"1_do",title:v(74,"Redo"),order:2}]}));$C(new mZ(bZ,{id:"default:redo",precondition:void 0}));const Tbe=$C(new p7({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:xn.MenubarSelectionMenu,group:"1_basic",title:v(75,"&&Select All"),order:1},{menuId:xn.CommandPalette,group:"",title:v(76,"Select All"),order:1},{menuId:xn.SimpleEditorContext,group:"9_select",title:v(77,"Select All"),order:1}]})),qz="default",Nbe="$initialize";let Gz=!1;function V4(s){oh&&(Gz||(Gz=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(s.message))}class Ibe{constructor(e,t,i,n,r){this.vsWorker=e,this.req=t,this.channel=i,this.method=n,this.args=r,this.type=0}}class Kz{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class Rbe{constructor(e,t,i,n,r){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=n,this.arg=r,this.type=2}}class Abe{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class Mbe{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class Obe{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}async sendMessage(e,t,i){const n=String(++this._lastSentReq);return new Promise((r,o)=>{this._pendingReplies[n]={resolve:r,reject:o},this._send(new Ibe(this._workerId,n,e,t,i))})}listen(e,t,i){let n=null;const r=new Z({onWillAddFirstListener:()=>{n=String(++this._lastSentReq),this._pendingEmitters.set(n,r),this._send(new Rbe(this._workerId,n,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(n),this._send(new Mbe(this._workerId,n)),n=null}});return r.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(n,r)=>(typeof r=="string"&&!n[r]&&(vZ(r)?n[r]=o=>this.listen(e,r,o):wZ(r)?n[r]=this.listen(e,r,void 0):r.charCodeAt(0)===36&&(n[r]=async(...o)=>(await(t==null?void 0:t()),this.sendMessage(e,r,o)))),n[r])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;if(e.err.$isError){const n=new Error;n.name=e.err.name,n.message=e.err.message,n.stack=e.err.stack,i=n}t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(n=>{this._send(new Kz(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=rM(n.detail)),this._send(new Kz(this._workerId,t,void 0,rM(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(n=>{this._send(new Abe(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++){const n=e.args[i];n instanceof ArrayBuffer&&t.push(n)}else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class Pbe extends le{constructor(e){super(),this._localChannels=new Map,this._worker=this._register(e),this._register(this._worker.onMessage(t=>{this._protocol.handleMessage(t)})),this._register(this._worker.onError(t=>{V4(t),$t(t)})),this._protocol=new Obe({sendMessage:(t,i)=>{this._worker.postMessage(t,i)},handleMessage:(t,i,n)=>this._handleMessage(t,i,n),handleEvent:(t,i,n)=>this._handleEvent(t,i,n)}),this._protocol.setWorkerId(this._worker.getId()),this._onModuleLoaded=this._protocol.sendMessage(qz,Nbe,[this._worker.getId()]).then(()=>{}),this.proxy=this._protocol.createProxyToRemoteChannel(qz,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(t=>{this._onError("Worker failed to load ",t)})}_handleMessage(e,t,i){const n=this._localChannels.get(e);if(!n)return Promise.reject(new Error(`Missing channel ${e} on main thread`));const r=n[t];if(typeof r!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(r.apply(n,i))}catch(o){return Promise.reject(o)}}_handleEvent(e,t,i){const n=this._localChannels.get(e);if(!n)throw new Error(`Missing channel ${e} on main thread`);if(vZ(t)){const r=n[t];if(typeof r!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);const o=r.call(n,i);if(typeof o!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return o}if(wZ(t)){const r=n[t];if(typeof r!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return r}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function wZ(s){return s[0]==="o"&&s[1]==="n"&&jh(s.charCodeAt(2))}function vZ(s){return/^onDynamic/.test(s)&&jh(s.charCodeAt(9))}function Wd(s,e){var i;const t=K6();if(t!=null&&t.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(s,e)}catch(n){$t(n);return}try{return(i=globalThis.trustedTypes)==null?void 0:i.createPolicy(s,e)}catch(n){$t(n);return}}let Zp;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?Zp=globalThis.workerttPolicy:Zp=Wd("defaultWorkerFactory",{createScriptURL:s=>s});function Fbe(s,e){const t=s.label||"anonymous"+e,i=K6();if(i){if(typeof i.getWorker=="function")return i.getWorker("workerMain.js",t);if(typeof i.getWorkerUrl=="function"){const r=i.getWorkerUrl("workerMain.js",t);return new Worker(Zp?Zp.createScriptURL(r):r,{name:t,type:"module"})}}const n=s.esmModuleLocation;if(n){const r=Bbe(t,n.toString(!0)),o=new Worker(Zp?Zp.createScriptURL(r):r,{name:t,type:"module"});return Vbe(o)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function Bbe(s,e){if(!(/^((http:)|(https:)|(file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const i=e.lastIndexOf("?"),n=e.lastIndexOf("#",i),r=i>0?new URLSearchParams(e.substring(i+1,~n?n:void 0)):new URLSearchParams;S4.addSearchParam(r,!0,!0),r.toString()?e=`${e}?${r.toString()}#${s}`:e=`${e}#${s}`}const t=new Blob([x6([`/*${s}*/`,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(aX())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(T6())};`,`globalThis._VSCODE_FILE_ROOT = ${JSON.stringify(globalThis._VSCODE_FILE_ROOT)};`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL(${JSON.stringify(e)}) ?? ${JSON.stringify(e)});`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${s}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(t)}function Vbe(s){return new Promise((e,t)=>{s.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(s.onmessage=null,e(s))},s.onerror=t})}function Hbe(s){return!!s&&typeof s.then=="function"}const Q2=class Q2 extends le{constructor(e){super(),this._onMessage=this._register(new Z),this.onMessage=this._onMessage.event,this._onError=this._register(new Z),this.onError=this._onError.event,this.id=++Q2.LAST_WORKER_ID;const t=e instanceof Worker||"then"in e?e:Fbe(e,this.id);Hbe(t)?this.worker=t:this.worker=Promise.resolve(t),this.postMessage("-please-ignore-",[]);const i=n=>{this._onError.fire(n)};this.worker.then(n=>{n.onmessage=r=>{this._onMessage.fire(r.data)},n.onmessageerror=r=>{this._onError.fire(r)},typeof n.addEventListener=="function"&&n.addEventListener("error",i)}),this._register(qe(()=>{var n;(n=this.worker)==null||n.then(r=>{r.onmessage=null,r.onmessageerror=null,r.removeEventListener("error",i),r.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)==null||i.then(n=>{try{n.postMessage(e,t)}catch(r){$t(r),$t(new Error("FAILED to post message to worker",{cause:r}))}})}};Q2.LAST_WORKER_ID=0;let H4=Q2;class Wbe{constructor(e,t){this.esmModuleLocation=e,this.label=t}}function zbe(s,e){const t=mt.isUri(s)?new Wbe(s,e):s;return new Pbe(new H4(t))}var cr;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(cr||(cr={}));class dR{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class Ube{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)r0(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),r0(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),r0(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),r0(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&r0(this.autoClosingPairsCloseSingleChar,t.close,t)}}function r0(s,e,t){s.has(e)?s.get(e).push(t):s.set(e,[t])}const b_=class b_{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new dR(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new dR({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new dR({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:b_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:b_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};b_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`,b_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;let W4=b_;function ug(s,e){const t=s.getCount(),i=s.findTokenIndexAtOffset(e),n=s.getLanguageId(i);let r=i;for(;r+1<t&&s.getLanguageId(r+1)===n;)r++;let o=i;for(;o>0&&s.getLanguageId(o-1)===n;)o--;return new jbe(s,n,o,r+1,s.getStartOffset(o),s.getEndOffset(r))}class jbe{constructor(e,t,i,n,r,o){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=r,this._lastCharOffset=o,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function Pl(s){return(s&3)!==0}let fR;function CZ(){return fR||(fR=new TextDecoder("UTF-16LE")),fR}let gR;function $be(){return gR||(gR=new TextDecoder("UTF-16BE")),gR}let mR;function yZ(){return mR||(mR=pme()?CZ():$be()),mR}function qbe(s,e,t){const i=new Uint16Array(s.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?Gbe(s,e,t):CZ().decode(i)}function Gbe(s,e,t){const i=[];let n=0;for(let r=0;r<t;r++){const o=B_e(s,e);e+=2,i[n++]=String.fromCharCode(o)}return i.join("")}class J1{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return yZ().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||Tn(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class hk{constructor(e,t,i,n,r,o){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=r,this.reversedRegex=o,this._openSet=hk._toSet(this.open),this._closeSet=hk._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function Kbe(s){const e=s.length;s=s.map(o=>[o[0].toLowerCase(),o[1].toLowerCase()]);const t=[];for(let o=0;o<e;o++)t[o]=o;const i=(o,a)=>{const[l,c]=o,[h,d]=a;return l===h||l===d||c===h||c===d},n=(o,a)=>{const l=Math.min(o,a),c=Math.max(o,a);for(let h=0;h<e;h++)t[h]===c&&(t[h]=l)};for(let o=0;o<e;o++){const a=s[o];for(let l=o+1;l<e;l++){const c=s[l];i(a,c)&&n(t[o],t[l])}}const r=[];for(let o=0;o<e;o++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===o){const[h,d]=s[c];a.push(h),l.push(d)}a.length>0&&r.push({open:a,close:l})}return r}class Ybe{constructor(e,t){this._richEditBracketsBrand=void 0;const i=Kbe(t);this.brackets=i.map((n,r)=>new hk(e,r,n.open,n.close,Qbe(n.open,n.close,i,r),Xbe(n.open,n.close,i,r))),this.forwardRegex=Zbe(this.brackets),this.reversedRegex=Jbe(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const r of n.open)this.textIsBracket[r]=n,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(const r of n.close)this.textIsBracket[r]=n,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}}function SZ(s,e,t,i){for(let n=0,r=e.length;n<r;n++){if(n===t)continue;const o=e[n];for(const a of o.open)a.indexOf(s)>=0&&i.push(a);for(const a of o.close)a.indexOf(s)>=0&&i.push(a)}}function xZ(s,e){return s.length-e.length}function DD(s){if(s.length<=1)return s;const e=[],t=new Set;for(const i of s)t.has(i)||(e.push(i),t.add(i));return e}function Qbe(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let r=0,o=n.length;r<o;r++)SZ(n[r],t,i,n);return n=DD(n),n.sort(xZ),n.reverse(),qC(n)}function Xbe(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let r=0,o=n.length;r<o;r++)SZ(n[r],t,i,n);return n=DD(n),n.sort(xZ),n.reverse(),qC(n.map(_7))}function Zbe(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=DD(e),qC(e)}function Jbe(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=DD(e),qC(e.map(_7))}function e0e(s){const e=/^[\w ]+$/.test(s);return s=pc(s),e?`\\b${s}\\b`:s}function qC(s,e){const t=`(${s.map(e0e).join(")|(")})`;return AX(t,!0,e)}const _7=(function(){function s(i){const n=new Uint16Array(i.length);let r=0;for(let o=i.length-1;o>=0;o--)n[r++]=i.charCodeAt(o);return yZ().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=s(e)),t}})();class ya{static _findPrevBracketInText(e,t,i,n){const r=i.match(e);if(!r)return null;const o=i.length-(r.index||0),a=r[0].length,l=n+o;return new G(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,r){const a=_7(i).substring(i.length-r,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){const r=i.match(e);if(!r)return null;const o=r.index||0,a=r[0].length;if(a===0)return null;const l=n+o;return new G(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,r){const o=i.substring(n,r);return this.findNextBracketInText(e,t,o,n)}}class t0e{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const n=i.charAt(i.length-1);e.push(n)}return Jg(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const n=t.findTokenIndexAtOffset(i-1);if(Pl(t.getStandardTokenType(n)))return null;const r=this._richEditBrackets.reversedRegex,o=t.getLineContent().substring(0,i-1)+e,a=ya.findPrevBracketInRange(r,1,o,0,o.length);if(!a)return null;const l=o.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const h=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(h)?{matchOpenBracket:l}:null}}function qS(s){return s.global&&(s.lastIndex=0),!0}class i0e{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&qS(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&qS(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&qS(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&qS(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class Jp{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=Jp._createOpenBracketRegExp(t[0]),n=Jp._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let r=0,o=this._regExpRules.length;r<o;r++){const a=this._regExpRules[r];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let r=0,o=this._brackets.length;r<o;r++){const a=this._brackets[r];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:cr.IndentOutdent}}if(e>=2&&i.length>0){for(let r=0,o=this._brackets.length;r<o;r++)if(this._brackets[r].openRegExp.test(i))return{indentAction:cr.Indent}}return null}static _createOpenBracketRegExp(e){let t=pc(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",Jp._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=pc(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,Jp._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return $t(t),null}}}const yi=gt("configurationService");function z4(s,e){const t=Object.create(null);for(const i in s)LZ(t,i,s[i],e);return t}function LZ(s,e,t,i){const n=e.split("."),r=n.pop();let o=s;for(let a=0;a<n.length;a++){const l=n[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[r]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}function n0e(s,e){const t=e.split(".");kZ(s,t)}function kZ(s,e){if(!s)return;const t=e.shift();if(e.length===0){delete s[t];return}if(Object.keys(s).indexOf(t)!==-1){const i=s[t];typeof i=="object"&&!Array.isArray(i)&&(kZ(i,e),Object.keys(i).length===0&&delete s[t])}}function Yz(s,e,t){function i(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=e.split("."),r=i(s,n);return typeof r>"u"?t:r}function s0e(s){return s.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}const Qn=gt("languageService");class Gl{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const EZ=[];function yt(s,e,t){e instanceof Gl||(e=new Gl(e,[],!!t)),EZ.push([s,e])}function Qz(){return EZ}const Du=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),TD={JSONContribution:"base.contributions.json"};function r0e(s){return s.length>0&&s.charAt(s.length-1)==="#"?s.substring(0,s.length-1):s}class o0e extends le{constructor(){super(...arguments),this.schemasById={},this._onDidChangeSchema=this._register(new Z)}registerSchema(e,t,i){const n=r0e(e);this.schemasById[n]=t,this._onDidChangeSchema.fire(e),i&&i.add(qe(()=>{delete this.schemasById[n],this._onDidChangeSchema.fire(e)}))}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const a0e=new o0e;ss.add(TD.JSONContribution,a0e);let lo;const pR=globalThis.vscode;if(typeof pR<"u"&&typeof pR.context<"u"){const s=pR.context.configuration();if(s)lo=s.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(lo=globalThis._VSCODE_PRODUCT_JSON,ik.VSCODE_DEV&&Object.assign(lo,{nameShort:`${lo.nameShort} Dev`,nameLong:`${lo.nameLong} Dev`,dataFolderName:`${lo.dataFolderName}-dev`,serverDataFolderName:lo.serverDataFolderName?`${lo.serverDataFolderName}-dev`:void 0}),!lo.version){const s=globalThis._VSCODE_PACKAGE_JSON;Object.assign(lo,{version:s.version})}}else lo={},Object.keys(lo).length===0&&Object.assign(lo,{version:"1.104.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var _R=lo;const Dm={Configuration:"base.contributions.configuration"},GS="vscode://schemas/settings/resourceLanguage",Xz=ss.as(TD.JSONContribution);class l0e extends le{constructor(){super(),this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=this._register(new Z),this._onDidUpdateConfiguration=this._register(new Z),this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:v(1664,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},Xz.registerSchema(GS,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),Xz.registerSchema(GS,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:n,source:r}of e)for(const o in n){t.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o),l=n[o];if(a.configurationDefaultOverrides.push({value:l,source:r}),Id.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,r,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(o,c,r),i.push(...dk(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,r,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const h=this.configurationProperties[o];h&&(this.updatePropertyDefaultValue(o,h),this.updateSchema(o,h))}}this.doRegisterOverrideIdentifiers(i)}updateDefaultOverrideProperty(e,t,i){const n={section:{id:this.defaultLanguageConfigurationOverridesNode.id,title:this.defaultLanguageConfigurationOverridesNode.title,order:this.defaultLanguageConfigurationOverridesNode.order,extensionInfo:this.defaultLanguageConfigurationOverridesNode.extensionInfo},type:"object",default:t.value,description:v(1665,"Configure settings to be overridden for {0}.",s0e(e)),$ref:GS,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){const r=(n==null?void 0:n.value)||{},o=(n==null?void 0:n.source)??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(ar(l)&&(yo(r[a])||ar(r[a]))){if(r[a]={...r[a]??{},...l},i)for(const h in l)o.set(`${a}.${h}`,i)}else r[a]=l,i?o.set(a,i):o.delete(a)}return{value:r,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){const r=this.configurationProperties[e],o=(n==null?void 0:n.value)??(r==null?void 0:r.defaultDefaultValue);let a=i;if(ar(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(yo(o)||ar(o)))){if(a=(n==null?void 0:n.source)??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...ar(o)?o:{},...t}}return{value:t,source:a}}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}validateAndRegisterProperties(e,t=!0,i,n,r=4,o){var c,h,d;r=Zo(e.scope)?r:e.scope;const a=e.properties;if(a)for(const g in a){const p=a[g];if(p.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo},t&&h0e(g,p,i==null?void 0:i.id)){delete a[g];continue}p.source=i,p.defaultDefaultValue=a[g].default,this.updatePropertyDefaultValue(g,p),Id.test(g)?p.scope=void 0:(p.scope=Zo(p.scope)?r:p.scope,p.restricted=Zo(p.restricted)?!!(n!=null&&n.includes(g)):p.restricted),p.experiment?(c=p.tags)!=null&&c.some(C=>C.toLowerCase()==="onexp")||(p.tags=p.tags??[],p.tags.push("onExP")):(h=p.tags)!=null&&h.some(C=>C.toLowerCase()==="onexp")&&(console.error(`Invalid tag 'onExP' found for property '${g}'. Please use 'experiment' property instead.`),p.experiment={mode:"startup"});const _=a[g].hasOwnProperty("included")&&!a[g].included,b=(d=a[g].policy)==null?void 0:d.name;_?(this.excludedConfigurationProperties[g]=a[g],b&&(this.policyConfigurations.set(b,g),o.add(g)),delete a[g]):(o.add(g),b&&this.policyConfigurations.set(b,g),this.configurationProperties[g]=a[g],!a[g].deprecationMessage&&a[g].markdownDeprecationMessage&&(a[g].deprecationMessage=a[g].markdownDeprecationMessage))}const l=e.allOf;if(l)for(const g of l)this.validateAndRegisterProperties(g,t,i,n,r,o)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const o in n)this.updateSchema(o,n[o]);const r=i.allOf;r==null||r.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 3:break;case 7:break;case 4:break;case 5:break;case 6:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:v(1666,"Configure editor settings to be overridden for a language."),errorMessage:v(1667,"This setting does not support per-language configuration."),$ref:GS};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){v(1668,"Configure editor settings to be overridden for a language."),v(1669,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){var o;const i=(o=this.configurationDefaultsOverrides.get(e))==null?void 0:o.configurationDefaultOverrideValue;let n,r;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,r=i.source),yo(n)&&(n=t.defaultDefaultValue,r=void 0),yo(n)&&(n=u0e(t.type)),t.default=n,t.defaultValueSource=r}}const DZ="\\[([^\\]]+)\\]",Zz=new RegExp(DZ,"g"),c0e=`^(${DZ})+$`,Id=new RegExp(c0e);function dk(s){const e=[];if(Id.test(s)){let t=Zz.exec(s);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=Zz.exec(s)}}return Jg(e)}function u0e(s){switch(Array.isArray(s)?s[0]:s){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const $x=new l0e;ss.add(Dm.Configuration,$x);function h0e(s,e,t){var i,n,r,o;return s.trim()?Id.test(s)?v(1671,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",s):$x.getConfigurationProperties()[s]!==void 0&&(!t||!d0e.has(t.toLowerCase()))?v(1672,"Cannot register '{0}'. This property is already registered.",s):(i=e.policy)!=null&&i.name&&$x.getPolicyConfigurations().get((n=e.policy)==null?void 0:n.name)!==void 0?v(1673,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",s,(r=e.policy)==null?void 0:r.name,$x.getPolicyConfigurations().get((o=e.policy)==null?void 0:o.name)):null:v(1670,"Cannot register an empty property")}const d0e=new Set(_R.defaultChatAgent?[_R.defaultChatAgent.extensionId,_R.defaultChatAgent.chatExtensionId].map(s=>s.toLowerCase()):[]),f0e={ModesRegistry:"editor.modesRegistry"};class g0e extends le{constructor(){super(),this._onDidChangeLanguages=this._register(new Z),this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const S1=new g0e;ss.add(f0e.ModesRegistry,S1);const Aa="plaintext",m0e=".txt";S1.registerLanguage({id:Aa,extensions:[m0e],aliases:[v(784,"Plain Text"),"text"],mimetypes:[Du.text]});ss.as(Dm.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);class p0e{constructor(e,t){this.languageId=e;const i=t.brackets?Jz(t.brackets):[],n=new cz(a=>{const l=new Set;return{info:new _0e(this,a,l),closing:l}}),r=new cz(a=>{const l=new Set,c=new Set;return{info:new b0e(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=n.get(a),h=r.get(l);c.closing.add(h.info),h.opening.add(c.info)}const o=t.colorizedBracketPairs?Jz(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of o){const c=n.get(a),h=r.get(l);c.closing.add(h.info),h.openingColorized.add(c.info),h.opening.add(c.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){const t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return qC(t,e)}}function Jz(s){return s.filter(([e,t])=>e!==""&&t!=="")}class TZ{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class _0e extends TZ{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class b0e extends TZ{constructor(e,t,i,n){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=n,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var w0e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},eU=function(s,e){return function(t,i){e(t,i,s)}};class bR{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const kc=gt("languageConfigurationService");let U4=class extends le{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new S0e),this.onDidChangeEmitter=this._register(new Z),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(j4));this._register(this.configurationService.onDidChangeConfiguration(n=>{const r=n.change.keys.some(a=>i.has(a)),o=n.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(r)this.configurations.clear(),this.onDidChangeEmitter.fire(new bR(void 0));else for(const a of o)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new bR(a)))})),this._register(this._registry.onDidChange(n=>{this.configurations.delete(n.languageId),this.onDidChangeEmitter.fire(new bR(n.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=v0e(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};U4=w0e([eU(0,yi),eU(1,Qn)],U4);function v0e(s,e,t,i){let n=e.getLanguageConfiguration(s);if(!n){if(!i.isRegisteredLanguageId(s))return new B_(s,{});n=new B_(s,{})}const r=C0e(n.languageId,t),o=IZ([n.underlyingConfig,r]);return new B_(n.languageId,o)}const j4={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function C0e(s,e){const t=e.getValue(j4.brackets,{overrideIdentifier:s}),i=e.getValue(j4.colorizedBracketPairs,{overrideIdentifier:s});return{brackets:tU(t),colorizedBracketPairs:tU(i)}}function tU(s){if(Array.isArray(s))return s.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function NZ(s,e,t){const i=s.getLineContent(e);let n=sr(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}class y0e{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new iU(e,t,++this._order);return this._entries.push(i),this._resolved=null,qe(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new B_(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(iU.cmp),IZ(this._entries.map(e=>e.configuration)))}}function IZ(s){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of s)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class iU{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class nU{constructor(e){this.languageId=e}}class S0e extends le{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._register(this.register(Aa,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new y0e(e),this._entries.set(e,n));const r=n.register(t,i);return this._onDidChange.fire(new nU(e)),qe(()=>{r.dispose(),this._onDidChange.fire(new nU(e))})}getLanguageConfiguration(e){const t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}}class B_{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Jp(this.underlyingConfig):null,this.comments=B_._handleComments(this.underlyingConfig),this.characterPair=new W4(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||O6,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new i0e(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new p0e(e,this.underlyingConfig)}getWordDefinition(){return P6(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new Ybe(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new t0e(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new Ube(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(typeof t.lineComment=="string"?i.lineCommentToken=t.lineComment:(i.lineCommentToken=t.lineComment.comment,i.lineCommentNoIndent=t.lineComment.noIndent)),t.blockComment){const[n,r]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=r}return i}}yt(kc,U4,1);class Hh{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class sU{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function x0e(s,e,t){return new Tu(new sU(s),new sU(e)).ComputeDiff(t).changes}class Ep{static Assert(e,t){if(!e)throw new Error(t)}}class Dp{static Copy(e,t,i,n,r){for(let o=0;o<r;o++)i[n+o]=e[t+o]}static Copy2(e,t,i,n,r){for(let o=0;o<r;o++)i[n+o]=e[t+o]}}class rU{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Hh(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class Tu{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,r,o]=Tu._getElements(e),[a,l,c]=Tu._getElements(t);this._hasStrings=o&&c,this._originalStringElements=n,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(Tu._isStringArray(t)){const i=new Int32Array(t.length);for(let n=0,r=t.length;n<r;n++)i[n]=J6(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=Tu._getStrictElement(this._originalSequence,e),n=Tu._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,r){const o=[!1];let a=this.ComputeDiffRecursive(e,t,i,n,o);return r&&(a=this.PrettifyChanges(a)),{quitEarly:o[0],changes:a}}ComputeDiffRecursive(e,t,i,n,r){for(r[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let d;return i<=n?(Ep.Assert(e===t+1,"originalStart should only be one more than originalEnd"),d=[new Hh(e,0,i,n-i+1)]):e<=t?(Ep.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),d=[new Hh(e,t-e+1,i,0)]):(Ep.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Ep.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),d=[]),d}const o=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,o,a,r),c=o[0],h=a[0];if(l!==null)return l;if(!r[0]){const d=this.ComputeDiffRecursive(e,c,i,h,r);let g=[];return r[0]?g=[new Hh(c+1,t-(c+1)+1,h+1,n-(h+1)+1)]:g=this.ComputeDiffRecursive(c+1,t,h+1,n,r),this.ConcatenateChanges(d,g)}return[new Hh(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,r,o,a,l,c,h,d,g,p,_,b,C,x,S){let y=null,k=null,D=new rU,R=t,N=i,A=p[0]-C[0]-n,M=-1073741824,O=this.m_forwardHistory.length-1;do{const V=A+e;V===R||V<N&&c[V-1]<c[V+1]?(d=c[V+1],_=d-A-n,d<M&&D.MarkNextChange(),M=d,D.AddModifiedElement(d+1,_),A=V+1-e):(d=c[V-1]+1,_=d-A-n,d<M&&D.MarkNextChange(),M=d-1,D.AddOriginalElement(d,_+1),A=V-1-e),O>=0&&(c=this.m_forwardHistory[O],e=c[0],R=1,N=c.length-1)}while(--O>=-1);if(y=D.getReverseChanges(),S[0]){let V=p[0]+1,H=C[0]+1;if(y!==null&&y.length>0){const U=y[y.length-1];V=Math.max(V,U.getOriginalEnd()),H=Math.max(H,U.getModifiedEnd())}k=[new Hh(V,g-V+1,H,b-H+1)]}else{D=new rU,R=o,N=a,A=p[0]-C[0]-l,M=1073741824,O=x?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const V=A+r;V===R||V<N&&h[V-1]>=h[V+1]?(d=h[V+1]-1,_=d-A-l,d>M&&D.MarkNextChange(),M=d+1,D.AddOriginalElement(d+1,_+1),A=V+1-r):(d=h[V-1],_=d-A-l,d>M&&D.MarkNextChange(),M=d,D.AddModifiedElement(d+1,_+1),A=V-1-r),O>=0&&(h=this.m_reverseHistory[O],r=h[0],R=1,N=h.length-1)}while(--O>=-1);k=D.getChanges()}return this.ConcatenateChanges(y,k)}ComputeRecursionPoint(e,t,i,n,r,o,a){let l=0,c=0,h=0,d=0,g=0,p=0;e--,i--,r[0]=0,o[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const _=t-e+(n-i),b=_+1,C=new Int32Array(b),x=new Int32Array(b),S=n-i,y=t-e,k=e-i,D=t-n,N=(y-S)%2===0;C[S]=e,x[y]=t,a[0]=!1;for(let A=1;A<=_/2+1;A++){let M=0,O=0;h=this.ClipDiagonalBound(S-A,A,S,b),d=this.ClipDiagonalBound(S+A,A,S,b);for(let H=h;H<=d;H+=2){H===h||H<d&&C[H-1]<C[H+1]?l=C[H+1]:l=C[H-1]+1,c=l-(H-S)-k;const U=l;for(;l<t&&c<n&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(C[H]=l,l+c>M+O&&(M=l,O=c),!N&&Math.abs(H-y)<=A-1&&l>=x[H])return r[0]=l,o[0]=c,U<=x[H]&&A<=1448?this.WALKTRACE(S,h,d,k,y,g,p,D,C,x,l,t,r,c,n,o,N,a):null}const V=(M-e+(O-i)-A)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(M,V))return a[0]=!0,r[0]=M,o[0]=O,V>0&&A<=1448?this.WALKTRACE(S,h,d,k,y,g,p,D,C,x,l,t,r,c,n,o,N,a):(e++,i++,[new Hh(e,t-e+1,i,n-i+1)]);g=this.ClipDiagonalBound(y-A,A,y,b),p=this.ClipDiagonalBound(y+A,A,y,b);for(let H=g;H<=p;H+=2){H===g||H<p&&x[H-1]>=x[H+1]?l=x[H+1]-1:l=x[H-1],c=l-(H-y)-D;const U=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(x[H]=l,N&&Math.abs(H-S)<=A&&l<=C[H])return r[0]=l,o[0]=c,U>=C[H]&&A<=1448?this.WALKTRACE(S,h,d,k,y,g,p,D,C,x,l,t,r,c,n,o,N,a):null}if(A<=1447){let H=new Int32Array(d-h+2);H[0]=S-h+1,Dp.Copy2(C,h,H,1,d-h+1),this.m_forwardHistory.push(H),H=new Int32Array(p-g+2),H[0]=y-g+1,Dp.Copy2(x,g,H,1,p-g+1),this.m_reverseHistory.push(H)}}return this.WALKTRACE(S,h,d,k,y,g,p,D,C,x,l,t,r,c,n,o,N,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,o=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<r&&(!o||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,r=0;if(t>0){const d=e[t-1];n=d.originalStart+d.originalLength,r=d.modifiedStart+d.modifiedLength}const o=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let d=1;;d++){const g=i.originalStart-d,p=i.modifiedStart-d;if(g<n||p<r||o&&!this.OriginalElementsAreEqual(g,g+i.originalLength)||a&&!this.ModifiedElementsAreEqual(p,p+i.modifiedLength))break;const b=(g===n&&p===r?5:0)+this._boundaryScore(g,i.originalLength,p,i.modifiedLength);b>c&&(c=b,l=d)}i.originalStart-=l,i.modifiedStart-=l;const h=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],h)){e[t-1]=h[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const n=e[t-1],r=e[t],o=r.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=r.originalStart+r.originalLength,c=l-a,h=n.modifiedStart,d=r.modifiedStart+r.modifiedLength,g=d-h;if(o<5&&c<20&&g<20){const p=this._findBetterContiguousSequence(a,c,h,g,o);if(p){const[_,b]=p;(_!==n.originalStart+n.originalLength||b!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=_-n.originalStart,n.modifiedLength=b-n.modifiedStart,r.originalStart=_+o,r.modifiedStart=b+o,r.originalLength=l-r.originalStart,r.modifiedLength=d-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,r){if(t<r||n<r)return null;const o=e+t-r+1,a=i+n-r+1;let l=0,c=0,h=0;for(let d=e;d<o;d++)for(let g=i;g<a;g++){const p=this._contiguousSequenceScore(d,g,r);p>0&&p>l&&(l=p,c=d,h=g)}return l>0?[c,h]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let r=0;r<i;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;n+=this._originalStringElements[e+r].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){const r=this._OriginalRegionIsBoundary(e,t)?1:0,o=this._ModifiedRegionIsBoundary(i,n)?1:0;return r+o}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return Dp.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],Dp.Copy(t,1,n,e.length,t.length-1),n}else{const n=new Array(e.length+t.length);return Dp.Copy(e,0,n,0,e.length),Dp.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(Ep.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Ep.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let r=e.originalLength;const o=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new Hh(n,r,o,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const r=i,o=n-i-1,a=t%2===0;if(e<0){const l=r%2===0;return a===l?0:1}else{const l=o%2===0;return a===l?n-1:n-2}}}function fk(s){return s<0?0:s>255?255:s|0}function Tp(s){return s<0?0:s>4294967295?4294967295:s|0}class GC{constructor(e){const t=fk(e);this._defaultValue=t,this._asciiMap=GC._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=fk(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class L0e{constructor(e,t,i){const n=new Uint8Array(e*t);for(let r=0,o=e*t;r<o;r++)n[r]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class k0e{constructor(e){let t=0,i=0;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new L0e(i,t,0);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let wR=null;function E0e(){return wR===null&&(wR=new k0e([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),wR}let o0=null;function D0e(){if(o0===null){o0=new GC(0);const s=` 	<>'"|`;for(let t=0;t<s.length;t++)o0.set(s.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)o0.set(e.charCodeAt(t),2)}return o0}class gk{static _createLink(e,t,i,n,r){let o=r-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=E0e()){const i=D0e(),n=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r),l=a.length;let c=0,h=0,d=0,g=1,p=!1,_=!1,b=!1,C=!1;for(;c<l;){let x=!1;const S=a.charCodeAt(c);if(g===13){let y;switch(S){case 40:p=!0,y=0;break;case 41:y=p?0:1;break;case 91:b=!0,_=!0,y=0;break;case 93:b=!1,y=_?0:1;break;case 123:C=!0,y=0;break;case 125:y=C?0:1;break;case 39:case 34:case 96:d===S?y=1:d===39||d===34||d===96?y=0:y=1;break;case 42:y=d===42?1:0;break;case 32:y=b?0:1;break;default:y=i.get(S)}y===1&&(n.push(gk._createLink(i,a,r,h,c)),x=!0)}else if(g===12){let y;S===91?(_=!0,y=0):y=i.get(S),y===1?x=!0:g=13}else g=t.nextState(g,S),g===0&&(x=!0);x&&(g=1,p=!1,_=!1,C=!1,h=c+1,d=S),c++}g===13&&n.push(gk._createLink(i,a,r,h,l))}return n}}function T0e(s){return!s||typeof s.getLineCount!="function"||typeof s.getLineContent!="function"?[]:gk.computeLinks(s)}const X2=class X2{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,r){if(e&&t){const o=this.doNavigateValueSet(t,r);if(o)return{range:e,value:o}}if(i&&n){const o=this.doNavigateValueSet(n,r);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const r=parseFloat(e);return!isNaN(n)&&!isNaN(r)&&n===r?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let r=0,o=e.length;n===null&&r<o;r++)n=this.valueSetReplace(e[r],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}};X2.INSTANCE=new X2;let $4=X2;const KC={DateTimeFormat(s,e){return new lr(()=>{try{return new Intl.DateTimeFormat(s,e)}catch{return new Intl.DateTimeFormat(void 0,e)}})},Collator(s,e){return new lr(()=>{try{return new Intl.Collator(s,e)}catch{return new Intl.Collator(void 0,e)}})},Segmenter(s,e){return new lr(()=>{try{return new Intl.Segmenter(s,e)}catch{return new Intl.Segmenter(void 0,e)}})},Locale(s,e){return new lr(()=>{try{return new Intl.Locale(s,e)}catch{return new Intl.Locale(rg,e)}})},NumberFormat(s,e){return new lr(()=>{try{return new Intl.NumberFormat(s,e)}catch{return new Intl.NumberFormat(void 0,e)}})}};class N0e extends GC{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=KC.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.value.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const oU=new jC(10);function x1(s,e){const t=`${s}/${e.join(",")}`;let i=oU.get(t);return i||(i=new N0e(s,e),oU.set(t,i)),i}var mk;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(mk||(mk={}));var Rd;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(Rd||(Rd={}));var xo;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(xo||(xo={}));var L1;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(L1||(L1={}));class qx{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&$r(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class Rv{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function I0e(s){return!!s&&typeof s.read=="function"}class vR{constructor(e,t,i,n,r,o){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=r,this._isTracked=o}}class R0e{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class A0e{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function M0e(s){return!s.isTooLargeForSyncing()&&!s.isForSimpleWidget}const O0e=999;class Np{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=RZ(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=AX(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new R0e(t,this.wordSeparators?x1(this.wordSeparators,[]):null,i?this.searchString:null)}}function RZ(s){if(!s||s.length===0)return!1;for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=s.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function Mf(s,e,t){if(!t)return new Rv(s,null);const i=[];for(let n=0,r=e.length;n<r;n++)i[n]=e[n];return new Rv(s,i)}class aU{constructor(e){const t=[];let i=0;for(let n=0,r=e.length;n<r;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){const r=i+((n-i)/2>>0);t[r]>=e?n=r-1:t[r+1]>=e?(i=r,n=r):i=r+1}return i+1}}class KS{static findMatches(e,t,i,n,r){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,i,new e_(o.wordSeparators,o.regex),n,r):this._doFindMatchesLineByLine(e,i,o,n,r):[]}static _getMultilineMatchRange(e,t,i,n,r,o){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let c;if(n){const p=n.findLineFeedCountBeforeOffset(r+o.length)-l;c=a+o.length+p}else c=a+o.length;const h=e.getPositionAt(a),d=e.getPositionAt(c);return new G(h.lineNumber,h.column,d.lineNumber,d.column)}static _doFindMatchesMultiline(e,t,i,n,r){const o=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new aU(a):null,c=[];let h=0,d;for(i.reset(0);d=i.next(a);)if(c[h++]=Mf(this._getMultilineMatchRange(e,o,a,l,d.index,d[0]),d,n),h>=r)return c;return c}static _doFindMatchesLineByLine(e,t,i,n,r){const o=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,o,n,r),o}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,o,n,r);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<r;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,o,n,r);if(a<r){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,o,n,r)}return o}static _findMatchesInLine(e,t,i,n,r,o,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const g=e.simpleSearch,p=g.length,_=t.length;let b=-p;for(;(b=t.indexOf(g,b+p))!==-1;)if((!c||b7(c,t,_,b,p))&&(o[r++]=new Rv(new G(i,b+1+n,i,b+1+p+n),null),r>=l))return r;return r}const h=new e_(e.wordSeparators,e.regex);let d;h.reset(0);do if(d=h.next(t),d&&(o[r++]=Mf(new G(i,d.index+1+n,i,d.index+1+d[0].length+n),d,a),r>=l))return r;while(d);return r}static findNextMatch(e,t,i,n){const r=t.parseSearchRequest();if(!r)return null;const o=new e_(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,i,o,n):this._doFindNextMatchLineByLine(e,i,o,n)}static _doFindNextMatchMultiline(e,t,i,n){const r=new J(t.lineNumber,1),o=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new G(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new aU(l):null;i.reset(t.column-1);const h=i.next(l);return h?Mf(this._getMultilineMatchRange(e,o,l,c,h.index,h[0]),h,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new J(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o),l=this._findFirstMatchInLine(i,a,o,t.column,n);if(l)return l;for(let c=1;c<=r;c++){const h=(o+c-1)%r,d=e.getLineContent(h+1),g=this._findFirstMatchInLine(i,d,h+1,1,n);if(g)return g}return null}static _findFirstMatchInLine(e,t,i,n,r){e.reset(n-1);const o=e.next(t);return o?Mf(new G(i,o.index+1,i,o.index+1+o[0].length),o,r):null}static findPreviousMatch(e,t,i,n){const r=t.parseSearchRequest();if(!r)return null;const o=new e_(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,i,o,n):this._doFindPreviousMatchLineByLine(e,i,o,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const r=this._doFindMatchesMultiline(e,new G(1,1,t.lineNumber,t.column),i,n,10*O0e);if(r.length>0)return r[r.length-1];const o=e.getLineCount();return t.lineNumber!==o||t.column!==e.getLineMaxColumn(o)?this._doFindPreviousMatchMultiline(e,new J(o,e.getLineMaxColumn(o)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,o,n);if(l)return l;for(let c=1;c<=r;c++){const h=(r+o-c-1)%r,d=e.getLineContent(h+1),g=this._findLastMatchInLine(i,d,h+1,n);if(g)return g}return null}static _findLastMatchInLine(e,t,i,n){let r=null,o;for(e.reset(0);o=e.next(t);)r=Mf(new G(i,o.index+1,i,o.index+1+o[0].length),o,n);return r}}function P0e(s,e,t,i,n){if(i===0)return!0;const r=e.charCodeAt(i-1);if(s.get(r)!==0||r===13||r===10)return!0;if(n>0){const o=e.charCodeAt(i);if(s.get(o)!==0)return!0}return!1}function F0e(s,e,t,i,n){if(i+n===t)return!0;const r=e.charCodeAt(i+n);if(s.get(r)!==0||r===13||r===10)return!0;if(n>0){const o=e.charCodeAt(i+n-1);if(s.get(o)!==0)return!0}return!1}function b7(s,e,t,i,n){return P0e(s,e,t,i,n)&&F0e(s,e,t,i,n)}class e_{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,r=i[0].length;if(n===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){rk(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=r,!this._wordSeparators||b7(this._wordSeparators,e,t,n,r))return i}while(i);return null}}class B0e{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,r=i?i.endLineNumber:e.getLineCount(),o=new lU(t),a=o.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${V0e(Array.from(a))}`,"g");const c=new e_(null,l),h=[];let d=!1,g,p=0,_=0,b=0;e:for(let C=n,x=r;C<=x;C++){const S=e.getLineContent(C),y=S.length;c.reset(0);do if(g=c.next(S),g){let k=g.index,D=g.index+g[0].length;if(k>0){const M=S.charCodeAt(k-1);Tn(M)&&k--}if(D+1<y){const M=S.charCodeAt(D-1);Tn(M)&&D++}const R=S.substring(k,D);let N=Cv(k+1,O6,S,0);N&&N.endColumn<=k+1&&(N=null);const A=o.shouldHighlightNonBasicASCII(R,N?N.word:null);if(A!==0){if(A===3?p++:A===2?_++:A===1?b++:E6(),h.length>=1e3){d=!0;break e}h.push(new G(C,k+1,C,D+1))}}while(g)}return{ranges:h,hasMore:d,ambiguousCharacterCount:p,invisibleCharacterCount:_,nonBasicAsciiCharacterCount:b}}static computeUnicodeHighlightReason(e,t){const i=new lU(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const r=e.codePointAt(0),o=i.ambiguousCharacters.getPrimaryConfusable(r),a=xv.getLocales().filter(l=>!xv.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(r));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function V0e(s,e){return`[${pc(s.map(i=>String.fromCodePoint(i)).join(""))}]`}class lU{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=xv.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of Q0.codePoints)cU(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,r=!1;if(t)for(const o of t){const a=o.codePointAt(0),l=$6(o);n=n||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!Q0.isInvisibleCharacter(a)&&(r=!0)}return!n&&r?0:this.options.invisibleCharacters&&!cU(e)&&Q0.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function cU(s){return s===" "||s===`
`||s==="	"}class Gx{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class AZ{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class ze{static fromTo(e,t){return new ze(e,t)}static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{const r=Math.min(e.start,t[i].start),o=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new ze(r,o))}}static tryCreate(e,t){if(!(e>t))return new ze(e,t)}static ofLength(e){return new ze(0,e)}static ofStartAndLength(e,t){return new ze(e,e+t)}static emptyAt(e){return new ze(e,e)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new $e(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new ze(this.start+e,this.endExclusive+e)}deltaStart(e){return new ze(this.start+e,this.endExclusive)}deltaEnd(e){return new ze(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new ze(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new ze(t,i)}intersectionLength(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,i-t)}intersects(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}intersectsOrTouches(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<=i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new $e(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new $e(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}joinRightTouching(e){if(this.endExclusive!==e.start)throw new $e(`Invalid join: ${this.toString()} and ${e.toString()}`);return new ze(this.start,e.endExclusive)}}class w7{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const n=Math.min(e.start,this._sortedRanges[t].start),r=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new ze(n,r))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new w7;for(const i of this._sortedRanges){const n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function pk(s,e,t=s.length-1){const i=H0e(s,e,t);if(i!==-1)return s[i]}function H0e(s,e,t=s.length-1){for(let i=t;i>=0;i--){const n=s[i];if(e(n,i))return i}return-1}function k1(s,e){const t=E1(s,e);return t===-1?void 0:s[t]}function E1(s,e,t=0,i=s.length){let n=t,r=i;for(;n<r;){const o=Math.floor((n+r)/2);e(s[o])?n=o+1:r=o}return n-1}function W0e(s,e){const t=q4(s,e);return t===s.length?void 0:s[t]}function q4(s,e,t=0,i=s.length){let n=t,r=i;for(;n<r;){const o=Math.floor((n+r)/2);e(s[o])?r=o:n=o+1}return n}const Z2=class Z2{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(Z2.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=E1(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};Z2.assertInvariants=!1;let _k=Z2;function MZ(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>0&&(t=n)}return t}function z0e(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>=0&&(t=n)}return t}function U0e(s,e){return MZ(s,(t,i)=>-e(t,i))}function j0e(s,e){if(s.length===0)return-1;let t=0;for(let i=1;i<s.length;i++){const n=s[i];e(n,s[t])>0&&(t=i)}return t}const jo=class jo{static ofLength(e,t){return new jo(e,e+t)}static fromRange(e){return new jo(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new jo(e.startLineNumber,e.endLineNumber+1)}static joinMany(e){if(e.length===0)return[];let t=new Jo(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new Jo(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new $e("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new jo(t,i)}static deserialize(e){return new jo(e[0],e[1])}constructor(e,t){if(e>t)throw new $e(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new jo(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new jo(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new jo(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new jo(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}intersectsOrTouches(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new G(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new G(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}toOffsetRange(){return new ze(this.startLineNumber-1,this.endLineNumberExclusive-1)}addMargin(e,t){return new jo(this.startLineNumber-e,this.endLineNumberExclusive+t)}};jo.compareByStart=Do(e=>e.startLineNumber,Uu);let Qe=jo;class Jo{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=q4(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=E1(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{const n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){const t=k1(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){const t=k1(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,n=0,r=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let o=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(o=a,i++):(o=l,n++)}else i<this._normalizedRanges.length?(o=this._normalizedRanges[i],i++):(o=e._normalizedRanges[n],n++);r===null?r=o:r.endLineNumberExclusive>=o.startLineNumber?r=new Qe(r.startLineNumber,Math.max(r.endLineNumberExclusive,o.endLineNumberExclusive)):(t.push(r),r=o)}return r!==null&&t.push(r),new Jo(t)}subtractFrom(e){const t=q4(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),i=E1(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new Jo([e]);const n=[];let r=e.startLineNumber;for(let o=t;o<i;o++){const a=this._normalizedRanges[o];a.startLineNumber>r&&n.push(new Qe(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&n.push(new Qe(r,e.endLineNumberExclusive)),new Jo(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){const r=this._normalizedRanges[i],o=e._normalizedRanges[n],a=r.intersect(o);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<o.endLineNumberExclusive?i++:n++}return new Jo(t)}getWithDelta(e){return new Jo(this._normalizedRanges.map(t=>t.delta(e)))}}const Za=class Za{static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new Za(0,t.column-e.column):new Za(t.lineNumber-e.lineNumber,t.column-1)}static fromPosition(e){return new Za(e.lineNumber-1,e.column-1)}static ofRange(e){return Za.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(const n of e)n===`
`?(t++,i=0):i++;return new Za(t,i)}constructor(e,t){this.lineCount=e,this.columnCount=t}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}add(e){return e.lineCount===0?new Za(this.lineCount,this.columnCount+e.columnCount):new Za(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new G(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new G(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new G(1,1,this.lineCount+1,this.columnCount+1)}toLineRange(){return Qe.ofLength(1,this.lineCount+1)}addToPosition(e){return this.lineCount===0?new J(e.lineNumber,e.column+this.columnCount):new J(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};Za.zero=new Za(0,0);let Yr=Za;class $0e{getOffsetRange(e){return new ze(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getRange(e){return G.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getStringReplacement(e){return new xg.deps.StringReplacement(this.getOffsetRange(e.range),e.text)}getTextReplacement(e){return new xg.deps.TextReplacement(this.getRange(e.replaceRange),e.newText)}getTextEdit(e){const t=e.replacements.map(i=>this.getTextReplacement(i));return new xg.deps.TextEdit(t)}}const u9=class u9{static get deps(){if(!this._deps)throw new Error("Dependencies not set. Call _setDependencies first.");return this._deps}};u9._deps=void 0;let xg=u9;function q0e(s){xg._deps=s}class ND extends $0e{constructor(e){super(),this.text=e,this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&(this.lineStartOffsetByLineIdx.push(t+1),t>0&&e.charAt(t-1)==="\r"?this.lineEndOffsetByLineIdx.push(t-1):this.lineEndOffsetByLineIdx.push(t));this.lineEndOffsetByLineIdx.push(e.length)}getOffset(e){const t=this._validatePosition(e);return this.lineStartOffsetByLineIdx[t.lineNumber-1]+t.column-1}_validatePosition(e){if(e.lineNumber<1)return new J(1,1);const t=this.textLength.lineCount+1;if(e.lineNumber>t){const n=this.getLineLength(t);return new J(t,n+1)}if(e.column<1)return new J(e.lineNumber,1);const i=this.getLineLength(e.lineNumber);return e.column-1>i?new J(e.lineNumber,i+1):e}getPosition(e){const t=E1(this.lineStartOffsetByLineIdx,r=>r<=e),i=t+1,n=e-this.lineStartOffsetByLineIdx[t]+1;return new J(i,n)}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new xg.deps.TextLength(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}}class v7{constructor(){this._transformer=void 0}get endPositionExclusive(){return this.length.addToPosition(new J(1,1))}get lineRange(){return this.length.toLineRange()}getValue(){return this.getValueOfRange(this.length.toRange())}getValueOfOffsetRange(e){return this.getValueOfRange(this.getTransformer().getRange(e))}getLineLength(e){return this.getValueOfRange(new G(e,1,e,Number.MAX_SAFE_INTEGER)).length}getTransformer(){return this._transformer||(this._transformer=new ND(this.getValue())),this._transformer}getLineAt(e){return this.getValueOfRange(new G(e,1,e,Number.MAX_SAFE_INTEGER))}}class G0e extends v7{constructor(e,t){XL(t>=1),super(),this._getLineContent=e,this._lineCount=t}getValueOfRange(e){if(e.startLineNumber===e.endLineNumber)return this._getLineContent(e.startLineNumber).substring(e.startColumn-1,e.endColumn-1);let t=this._getLineContent(e.startLineNumber).substring(e.startColumn-1);for(let i=e.startLineNumber+1;i<e.endLineNumber;i++)t+=`
`+this._getLineContent(i);return t+=`
`+this._getLineContent(e.endLineNumber).substring(0,e.endColumn-1),t}getLineLength(e){return this._getLineContent(e).length}get length(){const e=this._getLineContent(this._lineCount);return new Yr(this._lineCount-1,e.length)}}class YS extends G0e{constructor(e){super(t=>e[t-1],e.length)}}class uU extends v7{constructor(e){super(),this.value=e,this._t=new ND(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}getTransformer(){return this._t}}class Av{static fromStringEdit(e,t){const i=e.replacements.map(n=>il.fromStringReplacement(n,t));return new Av(i)}static fromParallelReplacementsUnsorted(e){const t=e.slice().sort(Do(i=>i.range,G.compareRangesUsingStarts));return new Av(t)}constructor(e){this.replacements=e,em(()=>D6(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}mapPosition(e){let t=0,i=0,n=0;for(const r of this.replacements){const o=r.range.getStartPosition();if(e.isBeforeOrEqual(o))break;const a=r.range.getEndPosition(),l=Yr.ofText(r.text);if(e.isBefore(a)){const c=new J(o.lineNumber+t,o.column+(o.lineNumber+t===i?n:0)),h=l.addToPosition(c);return QS(c,h)}o.lineNumber+t!==i&&(n=0),t+=l.lineCount-(r.range.endLineNumber-r.range.startLineNumber),l.lineCount===0?a.lineNumber!==o.lineNumber?n+=l.columnCount-(a.column-1):n+=l.columnCount-(a.column-o.column):n=l.columnCount,i=a.lineNumber+t}return new J(e.lineNumber+t,e.column+(e.lineNumber+t===i?n:0))}mapRange(e){function t(o){return o instanceof J?o:o.getStartPosition()}function i(o){return o instanceof J?o:o.getEndPosition()}const n=t(this.mapPosition(e.getStartPosition())),r=i(this.mapPosition(e.getEndPosition()));return QS(n,r)}apply(e){let t="",i=new J(1,1);for(const r of this.replacements){const o=r.range,a=o.getStartPosition(),l=o.getEndPosition(),c=QS(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=r.text,i=l}const n=QS(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){const t=new uU(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,n=0;for(const r of this.replacements){const o=Yr.ofText(r.text),a=J.lift({lineNumber:r.range.startLineNumber+i,column:r.range.startColumn+(r.range.startLineNumber===t?n:0)}),l=o.createRange(a);e.push(l),i=l.endLineNumber-r.range.endLineNumber,n=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}toReplacement(e){if(this.replacements.length===0)throw new $e;if(this.replacements.length===1)return this.replacements[0];const t=this.replacements[0].range.getStartPosition(),i=this.replacements[this.replacements.length-1].range.getEndPosition();let n="";for(let r=0;r<this.replacements.length;r++){const o=this.replacements[r];if(n+=o.text,r<this.replacements.length-1){const a=this.replacements[r+1],l=G.fromPositions(o.range.getEndPosition(),a.range.getStartPosition()),c=e.getValueOfRange(l);n+=c}}return new il(G.fromPositions(t,i),n)}toString(e){return e===void 0?this.replacements.map(t=>t.toString()).join(`
`):typeof e=="string"?this.toString(new uU(e)):this.replacements.length===0?"":this.replacements.map(t=>{const n=e.getValueOfRange(t.range),r=G.fromPositions(new J(Math.max(1,t.range.startLineNumber-1),1),t.range.getStartPosition());let o=e.getValueOfRange(r);o.length>10&&(o="..."+o.substring(o.length-10));const a=G.fromPositions(t.range.getEndPosition(),new J(t.range.endLineNumber+1,1));let l=e.getValueOfRange(a);l.length>10&&(l=l.substring(0,10)+"...");let c=n;if(c.length>10){const d=Math.floor(5);c=c.substring(0,d)+"..."+c.substring(c.length-d)}let h=t.text;if(h.length>10){const d=Math.floor(5);h=h.substring(0,d)+"..."+h.substring(h.length-d)}return c.length===0?`${o}${h}${l}`:`${o}${c}${h}${l}`}).join(`
`)}}class il{static joinReplacements(e,t){if(e.length===0)throw new $e;if(e.length===1)return e[0];const i=e[0].range.getStartPosition(),n=e[e.length-1].range.getEndPosition();let r="";for(let o=0;o<e.length;o++){const a=e[o];if(r+=a.text,o<e.length-1){const l=e[o+1],c=G.fromPositions(a.range.getEndPosition(),l.range.getStartPosition()),h=t.getValueOfRange(c);r+=h}}return new il(G.fromPositions(i,n),r)}static fromStringReplacement(e,t){return new il(t.getTransformer().getRange(e.replaceRange),e.newText)}static delete(e){return new il(e,"")}constructor(e,t){this.range=e,this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}equals(e){return il.equals(this,e)}removeCommonPrefixAndSuffix(e){return this.removeCommonPrefix(e).removeCommonSuffix(e)}removeCommonPrefix(e){const t=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=this.text.replaceAll(`\r
`,`
`),n=b1(t,i),r=Yr.ofText(t.substring(0,n)).addToPosition(this.range.getStartPosition()),o=i.substring(n),a=G.fromPositions(r,this.range.getEndPosition());return new il(a,o)}removeCommonSuffix(e){const t=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=this.text.replaceAll(`\r
`,`
`),n=w1(t,i),r=Yr.ofText(t.substring(0,t.length-n)).addToPosition(this.range.getStartPosition()),o=i.substring(0,i.length-n),a=G.fromPositions(this.range.getStartPosition(),r);return new il(a,o)}toString(){const e=this.range.getStartPosition(),t=this.range.getEndPosition();return`(${e.lineNumber},${e.column} -> ${t.lineNumber},${t.column}): "${this.text}"`}}function QS(s,e){if(s.lineNumber===e.lineNumber&&s.column===Number.MAX_SAFE_INTEGER)return G.fromPositions(e,e);if(!s.isBeforeOrEqual(e))throw new $e("start must be before end");return new G(s.lineNumber,s.column,e.lineNumber,e.column)}class Gs{static inverse(e,t,i){const n=[];let r=1,o=1;for(const l of e){const c=new Gs(new Qe(r,l.original.startLineNumber),new Qe(o,l.modified.startLineNumber));c.modified.isEmpty||n.push(c),r=l.original.endLineNumberExclusive,o=l.modified.endLineNumberExclusive}const a=new Gs(new Qe(r,t+1),new Qe(o,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){const n=[];for(const r of e){const o=r.original.intersect(t),a=r.modified.intersect(i);o&&!o.isEmpty&&a&&!a.isEmpty&&n.push(new Gs(o,a))}return n}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Gs(this.modified,this.original)}join(e){return new Gs(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new Hr(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new $e("not a valid diff");return new Hr(new G(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new G(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new Hr(new G(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new G(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(hU(this.original.endLineNumberExclusive,e)&&hU(this.modified.endLineNumberExclusive,t))return new Hr(new G(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new G(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new Hr(G.fromPositions(new J(this.original.startLineNumber,1),Ip(new J(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),G.fromPositions(new J(this.modified.startLineNumber,1),Ip(new J(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new Hr(G.fromPositions(Ip(new J(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),Ip(new J(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),G.fromPositions(Ip(new J(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),Ip(new J(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new $e}}function Ip(s,e){if(s.lineNumber<1)return new J(1,1);if(s.lineNumber>e.length)return new J(e.length,e[e.length-1].length+1);const t=e[s.lineNumber-1];return s.column>t.length+1?new J(s.lineNumber,t.length+1):s}function hU(s,e){return s>=1&&s<=e.length}class To extends Gs{static fromRangeMappings(e){const t=Qe.join(e.map(n=>Qe.fromRangeInclusive(n.originalRange))),i=Qe.join(e.map(n=>Qe.fromRangeInclusive(n.modifiedRange)));return new To(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new To(this.modified,this.original,(e=this.innerChanges)==null?void 0:e.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new To(this.original,this.modified,[this.toRangeMapping()])}}class Hr{static fromEdit(e){const t=e.getNewRanges();return e.replacements.map((n,r)=>new Hr(n.range,t[r]))}static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new $e("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new Hr(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new il(this.originalRange,t)}}function dU(s,e,t,i=!1){const n=[];for(const r of S6(s.map(o=>K0e(o,e,t)),(o,a)=>o.original.intersectsOrTouches(a.original)||o.modified.intersectsOrTouches(a.modified))){const o=r[0],a=r[r.length-1];n.push(new To(o.original.join(a.original),o.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return em(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length.lineCount-n[n.length-1].modified.endLineNumberExclusive!==e.length.lineCount-n[n.length-1].original.endLineNumberExclusive)?!1:D6(n,(r,o)=>o.original.startLineNumber-r.original.endLineNumberExclusive===o.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<o.original.startLineNumber&&r.modified.endLineNumberExclusive<o.modified.startLineNumber)),n}function K0e(s,e,t){let i=0,n=0;s.modifiedRange.endColumn===1&&s.originalRange.endColumn===1&&s.originalRange.startLineNumber+i<=s.originalRange.endLineNumber&&s.modifiedRange.startLineNumber+i<=s.modifiedRange.endLineNumber&&(n=-1),s.modifiedRange.startColumn-1>=t.getLineLength(s.modifiedRange.startLineNumber)&&s.originalRange.startColumn-1>=e.getLineLength(s.originalRange.startLineNumber)&&s.originalRange.startLineNumber<=s.originalRange.endLineNumber+n&&s.modifiedRange.startLineNumber<=s.modifiedRange.endLineNumber+n&&(i=1);const r=new Qe(s.originalRange.startLineNumber+i,s.originalRange.endLineNumber+1+n),o=new Qe(s.modifiedRange.startLineNumber+i,s.modifiedRange.endLineNumber+1+n);return new To(r,o,[s])}const Y0e=3;class Q0e{computeDiff(e,t,i){var l;const r=new J0e(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),o=[];let a=null;for(const c of r.changes){let h;c.originalEndLineNumber===0?h=new Qe(c.originalStartLineNumber+1,c.originalStartLineNumber+1):h=new Qe(c.originalStartLineNumber,c.originalEndLineNumber+1);let d;c.modifiedEndLineNumber===0?d=new Qe(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):d=new Qe(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let g=new To(h,d,(l=c.charChanges)==null?void 0:l.map(p=>new Hr(new G(p.originalStartLineNumber,p.originalStartColumn,p.originalEndLineNumber,p.originalEndColumn),new G(p.modifiedStartLineNumber,p.modifiedStartColumn,p.modifiedEndLineNumber,p.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===g.modified.startLineNumber||a.original.endLineNumberExclusive===g.original.startLineNumber)&&(g=new To(a.original.join(g.original),a.modified.join(g.modified),a.innerChanges&&g.innerChanges?a.innerChanges.concat(g.innerChanges):void 0),o.pop()),o.push(g),a=g}return em(()=>D6(o,(c,h)=>h.original.startLineNumber-c.original.endLineNumberExclusive===h.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<h.original.startLineNumber&&c.modified.endLineNumberExclusive<h.modified.startLineNumber)),new Gx(o,[],r.quitEarly)}}function OZ(s,e,t,i){return new Tu(s,e,t).ComputeDiff(i)}let fU=class{constructor(e){const t=[],i=[];for(let n=0,r=e.length;n<r;n++)t[n]=G4(e[n],1),i[n]=K4(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],r=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],h=e?this._startColumns[l]:1,d=e?this._endColumns[l]:c.length+1;for(let g=h;g<d;g++)n[a]=c.charCodeAt(g-1),r[a]=l+1,o[a]=g,a++;!e&&l<i&&(n[a]=10,r[a]=l+1,o[a]=c.length+1,a++)}return new X0e(n,r,o)}};class X0e{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class V_{constructor(e,t,i,n,r,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=r,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),h=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),d=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new V_(n,r,o,a,l,c,h,d)}}function Z0e(s){if(s.length<=1)return s;const e=[s[0]];let t=e[0];for(let i=1,n=s.length;i<n;i++){const r=s[i],o=r.originalStart-(t.originalStart+t.originalLength),a=r.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<Y0e?(t.originalLength=r.originalStart+r.originalLength-t.originalStart,t.modifiedLength=r.modifiedStart+r.modifiedLength-t.modifiedStart):(e.push(r),t=r)}return e}class ew{constructor(e,t,i,n,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=r}static createFromDiffResult(e,t,i,n,r,o,a){let l,c,h,d,g;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(h=n.getStartLineNumber(t.modifiedStart)-1,d=0):(h=n.getStartLineNumber(t.modifiedStart),d=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const p=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),_=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(p.getElements().length>0&&_.getElements().length>0){let b=OZ(p,_,r,!0).changes;a&&(b=Z0e(b)),g=[];for(let C=0,x=b.length;C<x;C++)g.push(V_.createFromDiffChange(b[C],p,_))}}return new ew(l,c,h,d,g)}}class J0e{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new fU(e),this.modified=new fU(t),this.continueLineDiff=gU(i.maxComputationTime),this.continueCharDiff=gU(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=OZ(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(ew.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let r=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,h=c?c.originalStart:this.originalLines.length,d=c?c.modifiedStart:this.modifiedLines.length;for(;r<h&&o<d;){const g=this.originalLines[r],p=this.modifiedLines[o];if(g!==p){{let _=G4(g,1),b=G4(p,1);for(;_>1&&b>1;){const C=g.charCodeAt(_-2),x=p.charCodeAt(b-2);if(C!==x)break;_--,b--}(_>1||b>1)&&this._pushTrimWhitespaceCharChange(n,r+1,1,_,o+1,1,b)}{let _=K4(g,1),b=K4(p,1);const C=g.length+1,x=p.length+1;for(;_<C&&b<x;){const S=g.charCodeAt(_-1),y=g.charCodeAt(b-1);if(S!==y)break;_++,b++}(_<C||b<x)&&this._pushTrimWhitespaceCharChange(n,r+1,_,C,o+1,b,x)}}r++,o++}c&&(n.push(ew.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,r,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,r,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new V_(t,i,t,n,r,o,r,a)]),e.push(new ew(t,t,r,r,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,r,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===r?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new V_(t,i,t,n,r,o,r,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===r?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new V_(t,i,t,n,r,o,r,a)),!0):!1}}function G4(s,e){const t=qr(s);return t===-1?e:t+1}function K4(s,e){const t=Sm(s);return t===-1?e:t+2}function gU(s){if(s===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<s}class qu{static trivial(e,t){return new qu([new En(ze.ofLength(e.length),ze.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new qu([new En(ze.ofLength(e.length),ze.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class En{static invert(e,t){const i=[];return iX(e,(n,r)=>{i.push(En.fromOffsetPairs(n?n.getEndExclusives():Mu.zero,r?r.getStarts():new Mu(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new En(new ze(e.offset1,t.offset1),new ze(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new $e("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new En(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new En(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new En(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new En(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new En(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new En(t,i)}getStarts(){return new Mu(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Mu(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}const Jf=class Jf{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new Jf(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}};Jf.zero=new Jf(0,0),Jf.max=new Jf(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);let Mu=Jf;const J2=class J2{isValid(){return!0}};J2.instance=new J2;let Mv=J2;class ewe{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new $e("timeout must be positive")}isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}}class CR{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function Y4(s){return s===32||s===9}const Bw=class Bw{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let n=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){const o=t[r];for(let l=0;l<o.length;l++){n++;const c=o[l],h=Bw.getKey(c);this.histogram[h]=(this.histogram[h]||0)+1}n++;const a=Bw.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}};Bw.chrKeys=new Map;let bk=Bw;class twe{compute(e,t,i=Mv.instance,n){if(e.length===0||t.length===0)return qu.trivial(e,t);const r=new CR(e.length,t.length),o=new CR(e.length,t.length),a=new CR(e.length,t.length);for(let _=0;_<e.length;_++)for(let b=0;b<t.length;b++){if(!i.isValid())return qu.trivialTimedOut(e,t);const C=_===0?0:r.get(_-1,b),x=b===0?0:r.get(_,b-1);let S;e.getElement(_)===t.getElement(b)?(_===0||b===0?S=0:S=r.get(_-1,b-1),_>0&&b>0&&o.get(_-1,b-1)===3&&(S+=a.get(_-1,b-1)),S+=n?n(_,b):1):S=-1;const y=Math.max(C,x,S);if(y===S){const k=_>0&&b>0?a.get(_-1,b-1):0;a.set(_,b,k+1),o.set(_,b,3)}else y===C?(a.set(_,b,0),o.set(_,b,1)):y===x&&(a.set(_,b,0),o.set(_,b,2));r.set(_,b,y)}const l=[];let c=e.length,h=t.length;function d(_,b){(_+1!==c||b+1!==h)&&l.push(new En(new ze(_+1,c),new ze(b+1,h))),c=_,h=b}let g=e.length-1,p=t.length-1;for(;g>=0&&p>=0;)o.get(g,p)===3?(d(g,p),g--,p--):o.get(g,p)===1?g--:p--;return d(-1,-1),l.reverse(),new qu(l,!1)}}class PZ{compute(e,t,i=Mv.instance){if(e.length===0||t.length===0)return qu.trivial(e,t);const n=e,r=t;function o(b,C){for(;b<n.length&&C<r.length&&n.getElement(b)===r.getElement(C);)b++,C++;return b}let a=0;const l=new iwe;l.set(0,o(0,0));const c=new nwe;c.set(0,l.get(0)===0?null:new mU(null,0,0,l.get(0)));let h=0;e:for(;;){if(a++,!i.isValid())return qu.trivialTimedOut(n,r);const b=-Math.min(a,r.length+a%2),C=Math.min(a,n.length+a%2);for(h=b;h<=C;h+=2){const x=h===C?-1:l.get(h+1),S=h===b?-1:l.get(h-1)+1,y=Math.min(Math.max(x,S),n.length),k=y-h;if(y>n.length||k>r.length)continue;const D=o(y,k);l.set(h,D);const R=y===x?c.get(h+1):c.get(h-1);if(c.set(h,D!==y?new mU(R,y,k,D-y):R),l.get(h)===n.length&&l.get(h)-h===r.length)break e}}let d=c.get(h);const g=[];let p=n.length,_=r.length;for(;;){const b=d?d.x+d.length:0,C=d?d.y+d.length:0;if((b!==p||C!==_)&&g.push(new En(new ze(b,p),new ze(C,_))),!d)break;p=d.x,_=d.y,d=d.prev}return g.reverse(),new qu(g,!1)}}class mU{constructor(e,t,i,n){this.prev=e,this.x=t,this.y=i,this.length=n}}class iwe{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class nwe{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class wk{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let r=e[n-1],o=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(o=this.range.startColumn-1,r=r.substring(o)),this.lineStartOffsets.push(o);let a=0;if(!i){const c=r.trimStart();a=r.length-c.length,r=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-o-a,r.length):r.length;for(let c=0;c<l;c++)this.elements.push(r.charCodeAt(c));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new ze(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=bU(e>0?this.elements[e-1]:-1),i=bU(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=_U(t),n+=_U(i),n}translateOffset(e,t="right"){const i=E1(this.firstElementOffsetByLineIdx,r=>r<=e),n=e-this.firstElementOffsetByLineIdx[i];return new J(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?G.fromPositions(i,i):G.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!Rp(this.elements[e]))return;let t=e;for(;t>0&&Rp(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&Rp(this.elements[i]);)i++;return new ze(t,i)}findSubWordContaining(e){if(e<0||e>=this.elements.length||!Rp(this.elements[e]))return;let t=e;for(;t>0&&Rp(this.elements[t-1])&&!pU(this.elements[t]);)t--;let i=e;for(;i<this.elements.length&&Rp(this.elements[i])&&!pU(this.elements[i]);)i++;return new ze(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=k1(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=W0e(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new ze(t,i)}}function Rp(s){return s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57}function pU(s){return s>=65&&s<=90}const swe={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function _U(s){return swe[s]}function bU(s){return s===10?8:s===13?7:Y4(s)?6:s>=97&&s<=122?0:s>=65&&s<=90?1:s>=48&&s<=57?2:s===-1?3:s===44||s===59?5:4}function rwe(s,e,t,i,n,r){let{moves:o,excludedChanges:a}=awe(s,e,t,r);if(!r.isValid())return[];const l=s.filter(h=>!a.has(h)),c=lwe(l,i,n,e,t,r);return sM(o,c),o=cwe(o),o=o.filter(h=>{const d=h.original.toOffsetRange().slice(e).map(p=>p.trim());return d.join(`
`).length>=15&&owe(d,p=>p.length>=2)>=2}),o=uwe(s,o),o}function owe(s,e){let t=0;for(const i of s)e(i)&&t++;return t}function awe(s,e,t,i){const n=[],r=s.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new bk(l.original,e,l)),o=new Set(s.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new bk(l.modified,t,l))),a=new Set;for(const l of r){let c=-1,h;for(const d of o){const g=l.computeSimilarity(d);g>c&&(c=g,h=d)}if(c>.9&&h&&(o.delete(h),n.push(new Gs(l.range,h.range)),a.add(l.source),a.add(h.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function lwe(s,e,t,i,n,r){const o=[],a=new hZ;for(const g of s)for(let p=g.original.startLineNumber;p<g.original.endLineNumberExclusive-2;p++){const _=`${e[p-1]}:${e[p+1-1]}:${e[p+2-1]}`;a.add(_,{range:new Qe(p,p+3)})}const l=[];s.sort(Do(g=>g.modified.startLineNumber,Uu));for(const g of s){let p=[];for(let _=g.modified.startLineNumber;_<g.modified.endLineNumberExclusive-2;_++){const b=`${t[_-1]}:${t[_+1-1]}:${t[_+2-1]}`,C=new Qe(_,_+3),x=[];a.forEach(b,({range:S})=>{for(const k of p)if(k.originalLineRange.endLineNumberExclusive+1===S.endLineNumberExclusive&&k.modifiedLineRange.endLineNumberExclusive+1===C.endLineNumberExclusive){k.originalLineRange=new Qe(k.originalLineRange.startLineNumber,S.endLineNumberExclusive),k.modifiedLineRange=new Qe(k.modifiedLineRange.startLineNumber,C.endLineNumberExclusive),x.push(k);return}const y={modifiedLineRange:C,originalLineRange:S};l.push(y),x.push(y)}),p=x}if(!r.isValid())return[]}l.sort(eme(Do(g=>g.modifiedLineRange.length,Uu)));const c=new Jo,h=new Jo;for(const g of l){const p=g.modifiedLineRange.startLineNumber-g.originalLineRange.startLineNumber,_=c.subtractFrom(g.modifiedLineRange),b=h.subtractFrom(g.originalLineRange).getWithDelta(p),C=_.getIntersection(b);for(const x of C.ranges){if(x.length<3)continue;const S=x,y=x.delta(-p);o.push(new Gs(y,S)),c.addRange(S),h.addRange(y)}}o.sort(Do(g=>g.original.startLineNumber,Uu));const d=new _k(s);for(let g=0;g<o.length;g++){const p=o[g],_=d.findLastMonotonous(R=>R.original.startLineNumber<=p.original.startLineNumber),b=k1(s,R=>R.modified.startLineNumber<=p.modified.startLineNumber),C=Math.max(p.original.startLineNumber-_.original.startLineNumber,p.modified.startLineNumber-b.modified.startLineNumber),x=d.findLastMonotonous(R=>R.original.startLineNumber<p.original.endLineNumberExclusive),S=k1(s,R=>R.modified.startLineNumber<p.modified.endLineNumberExclusive),y=Math.max(x.original.endLineNumberExclusive-p.original.endLineNumberExclusive,S.modified.endLineNumberExclusive-p.modified.endLineNumberExclusive);let k;for(k=0;k<C;k++){const R=p.original.startLineNumber-k-1,N=p.modified.startLineNumber-k-1;if(R>i.length||N>n.length||c.contains(N)||h.contains(R)||!wU(i[R-1],n[N-1],r))break}k>0&&(h.addRange(new Qe(p.original.startLineNumber-k,p.original.startLineNumber)),c.addRange(new Qe(p.modified.startLineNumber-k,p.modified.startLineNumber)));let D;for(D=0;D<y;D++){const R=p.original.endLineNumberExclusive+D,N=p.modified.endLineNumberExclusive+D;if(R>i.length||N>n.length||c.contains(N)||h.contains(R)||!wU(i[R-1],n[N-1],r))break}D>0&&(h.addRange(new Qe(p.original.endLineNumberExclusive,p.original.endLineNumberExclusive+D)),c.addRange(new Qe(p.modified.endLineNumberExclusive,p.modified.endLineNumberExclusive+D))),(k>0||D>0)&&(o[g]=new Gs(new Qe(p.original.startLineNumber-k,p.original.endLineNumberExclusive+D),new Qe(p.modified.startLineNumber-k,p.modified.endLineNumberExclusive+D)))}return o}function wU(s,e,t){if(s.trim()===e.trim())return!0;if(s.length>300&&e.length>300)return!1;const n=new PZ().compute(new wk([s],new G(1,1,1,s.length),!1),new wk([e],new G(1,1,1,e.length),!1),t);let r=0;const o=En.invert(n.diffs,s.length);for(const h of o)h.seq1Range.forEach(d=>{Y4(s.charCodeAt(d))||r++});function a(h){let d=0;for(let g=0;g<s.length;g++)Y4(h.charCodeAt(g))||d++;return d}const l=a(s.length>e.length?s:e);return r/l>.6&&l>10}function cwe(s){if(s.length===0)return s;s.sort(Do(t=>t.original.startLineNumber,Uu));const e=[s[0]];for(let t=1;t<s.length;t++){const i=e[e.length-1],n=s[t],r=n.original.startLineNumber-i.original.endLineNumberExclusive,o=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(r>=0&&o>=0&&r+o<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function uwe(s,e){const t=new _k(s);return e=e.filter(i=>{const n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Gs(new Qe(1,1),new Qe(1,1)),r=k1(s,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==r}),e}function vU(s,e,t){let i=t;return i=CU(s,e,i),i=CU(s,e,i),i=hwe(s,e,i),i}function CU(s,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let r=1;r<t.length;r++){const o=i[i.length-1];let a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-o.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(s.getElement(a.seq1Range.start-c)!==s.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new En(new ze(o.seq1Range.start,a.seq1Range.endExclusive-l),new ze(o.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const n=[];for(let r=0;r<i.length-1;r++){const o=i[r+1];let a=i[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=o.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!s.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[r+1]=new En(new ze(a.seq1Range.start+l,o.seq1Range.endExclusive),new ze(a.seq2Range.start+l,o.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function hwe(s,e,t){if(!s.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const n=i>0?t[i-1]:void 0,r=t[i],o=i+1<t.length?t[i+1]:void 0,a=new ze(n?n.seq1Range.endExclusive+1:0,o?o.seq1Range.start-1:s.length),l=new ze(n?n.seq2Range.endExclusive+1:0,o?o.seq2Range.start-1:e.length);r.seq1Range.isEmpty?t[i]=yU(r,s,e,a,l):r.seq2Range.isEmpty&&(t[i]=yU(r.swap(),e,s,l,a).swap())}return t}function yU(s,e,t,i,n){let o=1;for(;s.seq1Range.start-o>=i.start&&s.seq2Range.start-o>=n.start&&t.isStronglyEqual(s.seq2Range.start-o,s.seq2Range.endExclusive-o)&&o<100;)o++;o--;let a=0;for(;s.seq1Range.start+a<i.endExclusive&&s.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(s.seq2Range.start+a,s.seq2Range.endExclusive+a)&&a<100;)a++;if(o===0&&a===0)return s;let l=0,c=-1;for(let h=-o;h<=a;h++){const d=s.seq2Range.start+h,g=s.seq2Range.endExclusive+h,p=s.seq1Range.start+h,_=e.getBoundaryScore(p)+t.getBoundaryScore(d)+t.getBoundaryScore(g);_>c&&(c=_,l=h)}return s.delta(l)}function dwe(s,e,t){const i=[];for(const n of t){const r=i[i.length-1];if(!r){i.push(n);continue}n.seq1Range.start-r.seq1Range.endExclusive<=2||n.seq2Range.start-r.seq2Range.endExclusive<=2?i[i.length-1]=new En(r.seq1Range.join(n.seq1Range),r.seq2Range.join(n.seq2Range)):i.push(n)}return i}function SU(s,e,t,i,n=!1){const r=En.invert(t,s.length),o=[];let a=new Mu(0,0);function l(h,d){if(h.offset1<a.offset1||h.offset2<a.offset2)return;const g=i(s,h.offset1),p=i(e,h.offset2);if(!g||!p)return;let _=new En(g,p);const b=_.intersect(d);let C=b.seq1Range.length,x=b.seq2Range.length;for(;r.length>0;){const S=r[0];if(!(S.seq1Range.intersects(_.seq1Range)||S.seq2Range.intersects(_.seq2Range)))break;const k=i(s,S.seq1Range.start),D=i(e,S.seq2Range.start),R=new En(k,D),N=R.intersect(S);if(C+=N.seq1Range.length,x+=N.seq2Range.length,_=_.join(R),_.seq1Range.endExclusive>=S.seq1Range.endExclusive)r.shift();else break}(n&&C+x<_.seq1Range.length+_.seq2Range.length||C+x<(_.seq1Range.length+_.seq2Range.length)*2/3)&&o.push(_),a=_.getEndExclusives()}for(;r.length>0;){const h=r.shift();h.seq1Range.isEmpty||(l(h.getStarts(),h),l(h.getEndExclusives().delta(-1),h))}return fwe(t,o)}function fwe(s,e){const t=[];for(;s.length>0||e.length>0;){const i=s[0],n=e[0];let r;i&&(!n||i.seq1Range.start<n.seq1Range.start)?r=s.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function gwe(s,e,t){let i=t;if(i.length===0)return i;let n=0,r;do{r=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let d=function(p,_){const b=new ze(h.seq1Range.endExclusive,c.seq1Range.start);return s.getText(b).replace(/\s/g,"").length<=4&&(p.seq1Range.length+p.seq2Range.length>5||_.seq1Range.length+_.seq2Range.length>5)};var o=d;const c=i[l],h=a[a.length-1];d(h,c)?(r=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(n++<10&&r);return i}function mwe(s,e,t){let i=t;if(i.length===0)return i;let n=0,r;do{r=!1;const l=[i[0]];for(let c=1;c<i.length;c++){let g=function(_,b){const C=new ze(d.seq1Range.endExclusive,h.seq1Range.start);if(s.countLinesIn(C)>5||C.length>500)return!1;const S=s.getText(C).trim();if(S.length>20||S.split(/\r\n|\r|\n/).length>1)return!1;const y=s.countLinesIn(_.seq1Range),k=_.seq1Range.length,D=e.countLinesIn(_.seq2Range),R=_.seq2Range.length,N=s.countLinesIn(b.seq1Range),A=b.seq1Range.length,M=e.countLinesIn(b.seq2Range),O=b.seq2Range.length,V=130;function H(U){return Math.min(U,V)}return Math.pow(Math.pow(H(y*40+k),1.5)+Math.pow(H(D*40+R),1.5),1.5)+Math.pow(Math.pow(H(N*40+A),1.5)+Math.pow(H(M*40+O),1.5),1.5)>(V**1.5)**1.5*1.3};var a=g;const h=i[c],d=l[l.length-1];g(d,h)?(r=!0,l[l.length-1]=l[l.length-1].join(h)):l.push(h)}i=l}while(n++<10&&r);const o=[];return Yge(i,(l,c,h)=>{let d=c;function g(S){return S.length>0&&S.trim().length<=3&&c.seq1Range.length+c.seq2Range.length>100}const p=s.extendToFullLines(c.seq1Range),_=s.getText(new ze(p.start,c.seq1Range.start));g(_)&&(d=d.deltaStart(-_.length));const b=s.getText(new ze(c.seq1Range.endExclusive,p.endExclusive));g(b)&&(d=d.deltaEnd(b.length));const C=En.fromOffsetPairs(l?l.getEndExclusives():Mu.zero,h?h.getStarts():Mu.max),x=d.intersect(C);o.length>0&&x.getStarts().equals(o[o.length-1].getEndExclusives())?o[o.length-1]=o[o.length-1].join(x):o.push(x)}),o}class xU{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:LU(this.lines[e-1]),i=e===this.lines.length?0:LU(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function LU(s){let e=0;for(;e<s.length&&(s.charCodeAt(e)===32||s.charCodeAt(e)===9);)e++;return e}class pwe{constructor(){this.dynamicProgrammingDiffing=new twe,this.myersDiffingAlgorithm=new PZ}computeDiff(e,t,i){if(e.length<=1&&Sn(e,t,(N,A)=>N===A))return new Gx([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new Gx([new To(new Qe(1,e.length+1),new Qe(1,t.length+1),[new Hr(new G(1,1,e.length,e[e.length-1].length+1),new G(1,1,t.length,t[t.length-1].length+1))])],[],!1);const n=i.maxComputationTimeMs===0?Mv.instance:new ewe(i.maxComputationTimeMs),r=!i.ignoreTrimWhitespace,o=new Map;function a(N){let A=o.get(N);return A===void 0&&(A=o.size,o.set(N,A)),A}const l=e.map(N=>a(N.trim())),c=t.map(N=>a(N.trim())),h=new xU(l,e),d=new xU(c,t),g=h.length+d.length<1700?this.dynamicProgrammingDiffing.compute(h,d,n,(N,A)=>e[N]===t[A]?t[A].length===0?.1:1+Math.log(1+t[A].length):.99):this.myersDiffingAlgorithm.compute(h,d,n);let p=g.diffs,_=g.hitTimeout;p=vU(h,d,p),p=gwe(h,d,p);const b=[],C=N=>{if(r)for(let A=0;A<N;A++){const M=x+A,O=S+A;if(e[M]!==t[O]){const V=this.refineDiff(e,t,new En(new ze(M,M+1),new ze(O,O+1)),n,r,i);for(const H of V.mappings)b.push(H);V.hitTimeout&&(_=!0)}}};let x=0,S=0;for(const N of p){em(()=>N.seq1Range.start-x===N.seq2Range.start-S);const A=N.seq1Range.start-x;C(A),x=N.seq1Range.endExclusive,S=N.seq2Range.endExclusive;const M=this.refineDiff(e,t,N,n,r,i);M.hitTimeout&&(_=!0);for(const O of M.mappings)b.push(O)}C(e.length-x);const y=new YS(e),k=new YS(t),D=dU(b,y,k);let R=[];return i.computeMoves&&(R=this.computeMoves(D,e,t,l,c,n,r,i)),em(()=>{function N(M,O){if(M.lineNumber<1||M.lineNumber>O.length)return!1;const V=O[M.lineNumber-1];return!(M.column<1||M.column>V.length+1)}function A(M,O){return!(M.startLineNumber<1||M.startLineNumber>O.length+1||M.endLineNumberExclusive<1||M.endLineNumberExclusive>O.length+1)}for(const M of D){if(!M.innerChanges)return!1;for(const O of M.innerChanges)if(!(N(O.modifiedRange.getStartPosition(),t)&&N(O.modifiedRange.getEndPosition(),t)&&N(O.originalRange.getStartPosition(),e)&&N(O.originalRange.getEndPosition(),e)))return!1;if(!A(M.modified,t)||!A(M.original,e))return!1}return!0}),new Gx(D,R,_)}computeMoves(e,t,i,n,r,o,a,l){return rwe(e,t,i,n,r,o).map(d=>{const g=this.refineDiff(t,i,new En(d.original.toOffsetRange(),d.modified.toOffsetRange()),o,a,l),p=dU(g.mappings,new YS(t),new YS(i),!0);return new AZ(d,p)})}refineDiff(e,t,i,n,r,o){const l=_we(i).toRangeMapping2(e,t),c=new wk(e,l.originalRange,r),h=new wk(t,l.modifiedRange,r),d=c.length+h.length<500?this.dynamicProgrammingDiffing.compute(c,h,n):this.myersDiffingAlgorithm.compute(c,h,n);let g=d.diffs;return g=vU(c,h,g),g=SU(c,h,g,(_,b)=>_.findWordContaining(b)),o.extendToSubwords&&(g=SU(c,h,g,(_,b)=>_.findSubWordContaining(b),!0)),g=dwe(c,h,g),g=mwe(c,h,g),{mappings:g.map(_=>new Hr(c.translateRange(_.seq1Range),h.translateRange(_.seq2Range))),hitTimeout:d.hitTimeout}}}function _we(s){return new Gs(new Qe(s.seq1Range.start+1,s.seq1Range.endExclusive+1),new Qe(s.seq2Range.start+1,s.seq2Range.endExclusive+1))}const kU={getLegacy:()=>new Q0e,getDefault:()=>new pwe};function vd(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}class ae{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=vd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class La{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=vd(Math.max(Math.min(1,t),0),3),this.l=vd(Math.max(Math.min(1,i),0),3),this.a=vd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=e.a,o=Math.max(t,i,n),a=Math.min(t,i,n);let l=0,c=0;const h=(a+o)/2,d=o-a;if(d>0){switch(c=Math.min(h<=.5?d/(2*h):d/(2-2*h),1),o){case t:l=(i-n)/d+(i<n?6:0);break;case i:l=(n-t)/d+2;break;case n:l=(t-i)/d+4;break}l*=60,l=Math.round(l)}return new La(l,c,h,r)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:r}=e;let o,a,l;if(i===0)o=a=l=n;else{const c=n<.5?n*(1+i):n+i-n*i,h=2*n-c;o=La._hue2rgb(h,c,t+1/3),a=La._hue2rgb(h,c,t),l=La._hue2rgb(h,c,t-1/3)}return new ae(Math.round(o*255),Math.round(a*255),Math.round(l*255),r)}}class t_{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=vd(Math.max(Math.min(1,t),0),3),this.v=vd(Math.max(Math.min(1,i),0),3),this.a=vd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),o=Math.min(t,i,n),a=r-o,l=r===0?0:a/r;let c;return a===0?c=0:r===t?c=((i-n)/a%6+6)%6:r===i?c=(n-t)/a+2:c=(t-i)/a+4,new t_(Math.round(c*60),l,r,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:r}=e,o=n*i,a=o*(1-Math.abs(t/60%2-1)),l=n-o;let[c,h,d]=[0,0,0];return t<60?(c=o,h=a):t<120?(c=a,h=o):t<180?(h=o,d=a):t<240?(h=a,d=o):t<300?(c=a,d=o):t<=360&&(c=o,d=a),c=Math.round((c+l)*255),h=Math.round((h+l)*255),d=Math.round((d+l)*255),new ae(c,h,d,r)}}const Ri=class Ri{static fromHex(e){return Ri.Format.CSS.parseHex(e)||Ri.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:La.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:t_.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof ae)this.rgba=e;else if(e instanceof La)this._hsla=e,this.rgba=La.toRGBA(e);else if(e instanceof t_)this._hsva=e,this.rgba=t_.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&ae.equals(this.rgba,e.rgba)&&La.equals(this.hsla,e.hsla)&&t_.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=Ri._relativeLuminanceForComponent(this.rgba.r),t=Ri._relativeLuminanceForComponent(this.rgba.g),i=Ri._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return vd(n,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new Ri(new La(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Ri(new La(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:r}=this.rgba;return new Ri(new ae(t,i,n,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new Ri(new ae(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}mix(e,t=.5){const i=Math.min(Math.max(t,0),1),n=this.rgba,r=e.rgba,o=n.r+(r.r-n.r)*i,a=n.g+(r.g-n.g)*i,l=n.b+(r.b-n.b)*i,c=n.a+(r.a-n.a)*i;return new Ri(new ae(o,a,l,c))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:n,a:r}=this.rgba;return new Ri(new ae(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-i),e.rgba.b-r*(e.rgba.b-n),1))}toString(){return this._toString||(this._toString=Ri.Format.CSS.format(this)),this._toString}toNumber32Bit(){return this._toNumber32Bit||(this._toNumber32Bit=(this.rgba.r<<24|this.rgba.g<<16|this.rgba.b<<8|this.rgba.a*255<<0)>>>0),this._toNumber32Bit}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(r-n)/r,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(n-r)/n,e.darken(i)}};Ri.white=new Ri(new ae(255,255,255,1)),Ri.black=new Ri(new ae(0,0,0,1)),Ri.red=new Ri(new ae(255,0,0,1)),Ri.blue=new Ri(new ae(0,0,255,1)),Ri.green=new Ri(new ae(0,255,0,1)),Ri.cyan=new Ri(new ae(0,255,255,1)),Ri.lightgrey=new Ri(new ae(211,211,211,1)),Ri.transparent=new Ri(new ae(0,0,0,0));let me=Ri;(function(s){(function(e){(function(t){function i(b){return b.rgba.a===1?`rgb(${b.rgba.r}, ${b.rgba.g}, ${b.rgba.b})`:s.Format.CSS.formatRGBA(b)}t.formatRGB=i;function n(b){return`rgba(${b.rgba.r}, ${b.rgba.g}, ${b.rgba.b}, ${+b.rgba.a.toFixed(2)})`}t.formatRGBA=n;function r(b){return b.hsla.a===1?`hsl(${b.hsla.h}, ${Math.round(b.hsla.s*100)}%, ${Math.round(b.hsla.l*100)}%)`:s.Format.CSS.formatHSLA(b)}t.formatHSL=r;function o(b){return`hsla(${b.hsla.h}, ${Math.round(b.hsla.s*100)}%, ${Math.round(b.hsla.l*100)}%, ${b.hsla.a.toFixed(2)})`}t.formatHSLA=o;function a(b){const C=b.toString(16);return C.length!==2?"0"+C:C}function l(b){return`#${a(b.rgba.r)}${a(b.rgba.g)}${a(b.rgba.b)}`}t.formatHex=l;function c(b,C=!1){return C&&b.rgba.a===1?s.Format.CSS.formatHex(b):`#${a(b.rgba.r)}${a(b.rgba.g)}${a(b.rgba.b)}${a(Math.round(b.rgba.a*255))}`}t.formatHexA=c;function h(b){return b.isOpaque()?s.Format.CSS.formatHex(b):s.Format.CSS.formatRGBA(b)}t.format=h;function d(b){var C,x,S,y,k,D,R;if(b==="transparent")return s.transparent;if(b.startsWith("#"))return p(b);if(b.startsWith("rgba(")){const N=b.match(/rgba\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+), *(?<a>(?:\+|-)?\d+(\.\d+)?)\)/);if(!N)throw new Error("Invalid color format "+b);const A=parseInt(((C=N.groups)==null?void 0:C.r)??"0"),M=parseInt(((x=N.groups)==null?void 0:x.g)??"0"),O=parseInt(((S=N.groups)==null?void 0:S.b)??"0"),V=parseFloat(((y=N.groups)==null?void 0:y.a)??"0");return new s(new ae(A,M,O,V))}if(b.startsWith("rgb(")){const N=b.match(/rgb\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+)\)/);if(!N)throw new Error("Invalid color format "+b);const A=parseInt(((k=N.groups)==null?void 0:k.r)??"0"),M=parseInt(((D=N.groups)==null?void 0:D.g)??"0"),O=parseInt(((R=N.groups)==null?void 0:R.b)??"0");return new s(new ae(A,M,O))}return g(b)}t.parse=d;function g(b){switch(b){case"aliceblue":return new s(new ae(240,248,255,1));case"antiquewhite":return new s(new ae(250,235,215,1));case"aqua":return new s(new ae(0,255,255,1));case"aquamarine":return new s(new ae(127,255,212,1));case"azure":return new s(new ae(240,255,255,1));case"beige":return new s(new ae(245,245,220,1));case"bisque":return new s(new ae(255,228,196,1));case"black":return new s(new ae(0,0,0,1));case"blanchedalmond":return new s(new ae(255,235,205,1));case"blue":return new s(new ae(0,0,255,1));case"blueviolet":return new s(new ae(138,43,226,1));case"brown":return new s(new ae(165,42,42,1));case"burlywood":return new s(new ae(222,184,135,1));case"cadetblue":return new s(new ae(95,158,160,1));case"chartreuse":return new s(new ae(127,255,0,1));case"chocolate":return new s(new ae(210,105,30,1));case"coral":return new s(new ae(255,127,80,1));case"cornflowerblue":return new s(new ae(100,149,237,1));case"cornsilk":return new s(new ae(255,248,220,1));case"crimson":return new s(new ae(220,20,60,1));case"cyan":return new s(new ae(0,255,255,1));case"darkblue":return new s(new ae(0,0,139,1));case"darkcyan":return new s(new ae(0,139,139,1));case"darkgoldenrod":return new s(new ae(184,134,11,1));case"darkgray":return new s(new ae(169,169,169,1));case"darkgreen":return new s(new ae(0,100,0,1));case"darkgrey":return new s(new ae(169,169,169,1));case"darkkhaki":return new s(new ae(189,183,107,1));case"darkmagenta":return new s(new ae(139,0,139,1));case"darkolivegreen":return new s(new ae(85,107,47,1));case"darkorange":return new s(new ae(255,140,0,1));case"darkorchid":return new s(new ae(153,50,204,1));case"darkred":return new s(new ae(139,0,0,1));case"darksalmon":return new s(new ae(233,150,122,1));case"darkseagreen":return new s(new ae(143,188,143,1));case"darkslateblue":return new s(new ae(72,61,139,1));case"darkslategray":return new s(new ae(47,79,79,1));case"darkslategrey":return new s(new ae(47,79,79,1));case"darkturquoise":return new s(new ae(0,206,209,1));case"darkviolet":return new s(new ae(148,0,211,1));case"deeppink":return new s(new ae(255,20,147,1));case"deepskyblue":return new s(new ae(0,191,255,1));case"dimgray":return new s(new ae(105,105,105,1));case"dimgrey":return new s(new ae(105,105,105,1));case"dodgerblue":return new s(new ae(30,144,255,1));case"firebrick":return new s(new ae(178,34,34,1));case"floralwhite":return new s(new ae(255,250,240,1));case"forestgreen":return new s(new ae(34,139,34,1));case"fuchsia":return new s(new ae(255,0,255,1));case"gainsboro":return new s(new ae(220,220,220,1));case"ghostwhite":return new s(new ae(248,248,255,1));case"gold":return new s(new ae(255,215,0,1));case"goldenrod":return new s(new ae(218,165,32,1));case"gray":return new s(new ae(128,128,128,1));case"green":return new s(new ae(0,128,0,1));case"greenyellow":return new s(new ae(173,255,47,1));case"grey":return new s(new ae(128,128,128,1));case"honeydew":return new s(new ae(240,255,240,1));case"hotpink":return new s(new ae(255,105,180,1));case"indianred":return new s(new ae(205,92,92,1));case"indigo":return new s(new ae(75,0,130,1));case"ivory":return new s(new ae(255,255,240,1));case"khaki":return new s(new ae(240,230,140,1));case"lavender":return new s(new ae(230,230,250,1));case"lavenderblush":return new s(new ae(255,240,245,1));case"lawngreen":return new s(new ae(124,252,0,1));case"lemonchiffon":return new s(new ae(255,250,205,1));case"lightblue":return new s(new ae(173,216,230,1));case"lightcoral":return new s(new ae(240,128,128,1));case"lightcyan":return new s(new ae(224,255,255,1));case"lightgoldenrodyellow":return new s(new ae(250,250,210,1));case"lightgray":return new s(new ae(211,211,211,1));case"lightgreen":return new s(new ae(144,238,144,1));case"lightgrey":return new s(new ae(211,211,211,1));case"lightpink":return new s(new ae(255,182,193,1));case"lightsalmon":return new s(new ae(255,160,122,1));case"lightseagreen":return new s(new ae(32,178,170,1));case"lightskyblue":return new s(new ae(135,206,250,1));case"lightslategray":return new s(new ae(119,136,153,1));case"lightslategrey":return new s(new ae(119,136,153,1));case"lightsteelblue":return new s(new ae(176,196,222,1));case"lightyellow":return new s(new ae(255,255,224,1));case"lime":return new s(new ae(0,255,0,1));case"limegreen":return new s(new ae(50,205,50,1));case"linen":return new s(new ae(250,240,230,1));case"magenta":return new s(new ae(255,0,255,1));case"maroon":return new s(new ae(128,0,0,1));case"mediumaquamarine":return new s(new ae(102,205,170,1));case"mediumblue":return new s(new ae(0,0,205,1));case"mediumorchid":return new s(new ae(186,85,211,1));case"mediumpurple":return new s(new ae(147,112,219,1));case"mediumseagreen":return new s(new ae(60,179,113,1));case"mediumslateblue":return new s(new ae(123,104,238,1));case"mediumspringgreen":return new s(new ae(0,250,154,1));case"mediumturquoise":return new s(new ae(72,209,204,1));case"mediumvioletred":return new s(new ae(199,21,133,1));case"midnightblue":return new s(new ae(25,25,112,1));case"mintcream":return new s(new ae(245,255,250,1));case"mistyrose":return new s(new ae(255,228,225,1));case"moccasin":return new s(new ae(255,228,181,1));case"navajowhite":return new s(new ae(255,222,173,1));case"navy":return new s(new ae(0,0,128,1));case"oldlace":return new s(new ae(253,245,230,1));case"olive":return new s(new ae(128,128,0,1));case"olivedrab":return new s(new ae(107,142,35,1));case"orange":return new s(new ae(255,165,0,1));case"orangered":return new s(new ae(255,69,0,1));case"orchid":return new s(new ae(218,112,214,1));case"palegoldenrod":return new s(new ae(238,232,170,1));case"palegreen":return new s(new ae(152,251,152,1));case"paleturquoise":return new s(new ae(175,238,238,1));case"palevioletred":return new s(new ae(219,112,147,1));case"papayawhip":return new s(new ae(255,239,213,1));case"peachpuff":return new s(new ae(255,218,185,1));case"peru":return new s(new ae(205,133,63,1));case"pink":return new s(new ae(255,192,203,1));case"plum":return new s(new ae(221,160,221,1));case"powderblue":return new s(new ae(176,224,230,1));case"purple":return new s(new ae(128,0,128,1));case"rebeccapurple":return new s(new ae(102,51,153,1));case"red":return new s(new ae(255,0,0,1));case"rosybrown":return new s(new ae(188,143,143,1));case"royalblue":return new s(new ae(65,105,225,1));case"saddlebrown":return new s(new ae(139,69,19,1));case"salmon":return new s(new ae(250,128,114,1));case"sandybrown":return new s(new ae(244,164,96,1));case"seagreen":return new s(new ae(46,139,87,1));case"seashell":return new s(new ae(255,245,238,1));case"sienna":return new s(new ae(160,82,45,1));case"silver":return new s(new ae(192,192,192,1));case"skyblue":return new s(new ae(135,206,235,1));case"slateblue":return new s(new ae(106,90,205,1));case"slategray":return new s(new ae(112,128,144,1));case"slategrey":return new s(new ae(112,128,144,1));case"snow":return new s(new ae(255,250,250,1));case"springgreen":return new s(new ae(0,255,127,1));case"steelblue":return new s(new ae(70,130,180,1));case"tan":return new s(new ae(210,180,140,1));case"teal":return new s(new ae(0,128,128,1));case"thistle":return new s(new ae(216,191,216,1));case"tomato":return new s(new ae(255,99,71,1));case"turquoise":return new s(new ae(64,224,208,1));case"violet":return new s(new ae(238,130,238,1));case"wheat":return new s(new ae(245,222,179,1));case"white":return new s(new ae(255,255,255,1));case"whitesmoke":return new s(new ae(245,245,245,1));case"yellow":return new s(new ae(255,255,0,1));case"yellowgreen":return new s(new ae(154,205,50,1));default:return null}}function p(b){const C=b.length;if(C===0||b.charCodeAt(0)!==35)return null;if(C===7){const x=16*_(b.charCodeAt(1))+_(b.charCodeAt(2)),S=16*_(b.charCodeAt(3))+_(b.charCodeAt(4)),y=16*_(b.charCodeAt(5))+_(b.charCodeAt(6));return new s(new ae(x,S,y,1))}if(C===9){const x=16*_(b.charCodeAt(1))+_(b.charCodeAt(2)),S=16*_(b.charCodeAt(3))+_(b.charCodeAt(4)),y=16*_(b.charCodeAt(5))+_(b.charCodeAt(6)),k=16*_(b.charCodeAt(7))+_(b.charCodeAt(8));return new s(new ae(x,S,y,k/255))}if(C===4){const x=_(b.charCodeAt(1)),S=_(b.charCodeAt(2)),y=_(b.charCodeAt(3));return new s(new ae(16*x+x,16*S+S,16*y+y))}if(C===5){const x=_(b.charCodeAt(1)),S=_(b.charCodeAt(2)),y=_(b.charCodeAt(3)),k=_(b.charCodeAt(4));return new s(new ae(16*x+x,16*S+S,16*y+y,(16*k+k)/255))}return null}t.parseHex=p;function _(b){switch(b){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(s.Format||(s.Format={}))})(me||(me={}));function FZ(s){const e=[];for(const t of s){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function C7(s,e,t,i){return{red:s/255,blue:t/255,green:e/255,alpha:i}}function a0(s,e){const t=e.index,i=e[0].length;if(t===void 0)return;const n=s.positionAt(t);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+i}}function bwe(s,e){if(!s)return;const t=me.Format.CSS.parseHex(e);if(t)return{range:s,color:C7(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function EU(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),r=FZ(n);return{range:s,color:C7(r[0],r[1],r[2],t?r[3]:1)}}function DU(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),r=FZ(n),o=new me(new La(r[0],r[1]/100,r[2]/100,t?r[3]:1));return{range:s,color:C7(o.rgba.r,o.rgba.g,o.rgba.b,o.rgba.a)}}function l0(s,e){return typeof s=="string"?[...s.matchAll(e)]:s.findMatches(e)}function wwe(s){const e=[],t=new RegExp(`\\b(rgb|rgba|hsl|hsla)(\\([0-9\\s,.\\%]*\\))|^(#)([A-Fa-f0-9]{3})\\b|^(#)([A-Fa-f0-9]{4})\\b|^(#)([A-Fa-f0-9]{6})\\b|^(#)([A-Fa-f0-9]{8})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{3})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{4})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{6})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{8})\\b`,"gm"),i=l0(s,t);if(i.length>0)for(const n of i){const r=n.filter(c=>c!==void 0),o=r[1],a=r[2];if(!a)continue;let l;if(o==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=EU(a0(s,n),l0(a,c),!1)}else if(o==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=EU(a0(s,n),l0(a,c),!0)}else if(o==="hsl"){const c=/^\(\s*((?:360(?:\.0+)?|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])(?:\.\d+)?))\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=DU(a0(s,n),l0(a,c),!1)}else if(o==="hsla"){const c=/^\(\s*((?:360(?:\.0+)?|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])(?:\.\d+)?))\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(0[.][0-9]+|[.][0-9]+|[01][.]0*|[01])\s*\)$/gm;l=DU(a0(s,n),l0(a,c),!0)}else o==="#"&&(l=bwe(a0(s,n),o+a));l&&e.push(l)}return e}function vwe(s){return!s||typeof s.getValue!="function"||typeof s.positionAt!="function"?[]:wwe(s)}const Cwe=/^-+|-+$/g,TU=100,ywe=5;function Swe(s,e){var i;let t=[];if(e.findRegionSectionHeaders&&((i=e.foldingRules)!=null&&i.markers)){const n=xwe(s,e);t=t.concat(n)}if(e.findMarkSectionHeaders){const n=Lwe(s,e);t=t.concat(n)}return t}function xwe(s,e){const t=[],i=s.getLineCount();for(let n=1;n<=i;n++){const r=s.getLineContent(n),o=r.match(e.foldingRules.markers.start);if(o){const a={startLineNumber:n,startColumn:o[0].length+1,endLineNumber:n,endColumn:r.length+1};if(a.endColumn>a.startColumn){const l={range:a,...kwe(r.substring(o[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function Lwe(s,e){const t=[],i=s.getLineCount();if(!e.markSectionHeaderRegex||e.markSectionHeaderRegex.trim()==="")return t;const n=RZ(e.markSectionHeaderRegex),r=new RegExp(e.markSectionHeaderRegex,`gdm${n?"s":""}`);if(MX(r))return t;for(let o=1;o<=i;o+=TU-ywe){const a=Math.min(o+TU-1,i),l=[];for(let d=o;d<=a;d++)l.push(s.getLineContent(d));const c=l.join(`
`);r.lastIndex=0;let h;for(;(h=r.exec(c))!==null;){const d=c.substring(0,h.index),g=(d.match(/\n/g)||[]).length,p=o+g,_=h[0].split(`
`),b=_.length,C=p+b-1,x=d.lastIndexOf(`
`)+1,S=h.index-x+1,y=_[_.length-1],k=b===1?S+h[0].length:y.length+1,D={startLineNumber:p,startColumn:S,endLineNumber:C,endColumn:k},R=(h.groups??{}).label??"",N=((h.groups??{}).separator??"")!=="",A={range:D,text:R,hasSeparatorLine:N,shouldBeInComments:!0};(A.text||A.hasSeparatorLine)&&(t.length===0||t[t.length-1].range.endLineNumber<A.range.startLineNumber)&&t.push(A),r.lastIndex=h.index+h[0].length}}return t}function kwe(s){s=s.trim();const e=s.startsWith("-");return s=s.replace(Cwe,""),{text:s,hasSeparatorLine:e}}class Ewe{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=Tp(e);const i=this.values,n=this.prefixSum,r=t.length;return r===0?!1:(this.values=new Uint32Array(i.length+r),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+r),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Tp(e),t=Tp(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Tp(e),t=Tp(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const r=i.length-e;return t>=r&&(t=r),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Tp(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,r=0,o=0;for(;t<=i;)if(n=t+(i-t)/2|0,r=this.prefixSum[n],o=r-this.values[n],e<o)i=n-1;else if(e>=r)t=n+1;else break;return new BZ(n,e-o)}}class Dwe{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new BZ(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=nD(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let r=0;r<i;r++)this._indexBySum[n+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class BZ{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class Twe{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new J(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Ewe(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=K1(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this._lines.splice(e.lineNumber+r-1,0,i[r]),n[r-1]=i[r].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const NU=60*1e3;class Nwe extends le{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new Y6;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(NU/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)_n(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>NU&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const r=new Pe;r.add(i.onDidChangeContent(o=>{this._proxy.$acceptModelChanged(n.toString(),o)})),r.add(i.onWillDispose(()=>{this._stopModelSync(n)})),r.add(qe(()=>{this._proxy.$acceptRemovedModel(n)})),this._syncedModels[n]=r}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],_n(t)}}class Iwe{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new Rwe(mt.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class Rwe extends Twe{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const n=this._lines[i],r=this.offsetAt(new J(i+1,1)),o=n.matchAll(e);for(const a of o)(a.index||a.index===0)&&(a.index=a.index+r),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=Cv(e.column,P6(t),this._lines[e.lineNumber-1],0);return i?new G(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,r="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=r.substring(a[o].start,a[o].end);o+=1,yield l}else if(n<t.length)r=t[n],a=i(r,e),o=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),r=[];for(const o of n)r.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return r}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,r=[];r.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<n;o++)r.push(this._lines[o]);return r.push(this._lines[n].substring(0,e.endColumn-1)),r.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!J.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const r=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>r&&(i=r,n=!0)}return n?{lineNumber:t,column:i}:e}}const eg=class eg{constructor(e=null){this._foreignModule=e,this._requestHandlerBrand=void 0,this._workerTextModelSyncServer=new Iwe}dispose(){}async $ping(){return"pong"}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const n=this._getModel(e);return n?B0e.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?Swe(i,t):[]}async $computeDiff(e,t,i,n){const r=this._getModel(e),o=this._getModel(t);return!r||!o?null:eg.computeDiff(r,o,i,n)}static computeDiff(e,t,i,n){const r=n==="advanced"?kU.getDefault():kU.getLegacy(),o=e.getLinesContent(),a=t.getLinesContent(),l=r.computeDiff(o,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function h(d){return d.map(g=>{var p;return[g.original.startLineNumber,g.original.endLineNumberExclusive,g.modified.startLineNumber,g.modified.endLineNumberExclusive,(p=g.innerChanges)==null?void 0:p.map(_=>[_.originalRange.startLineNumber,_.originalRange.startColumn,_.originalRange.endLineNumber,_.originalRange.endColumn,_.modifiedRange.startLineNumber,_.modifiedRange.startColumn,_.modifiedRange.endLineNumber,_.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:h(l.changes),moves:l.moves.map(d=>[d.lineRangeMapping.original.startLineNumber,d.lineRangeMapping.original.endLineNumberExclusive,d.lineRangeMapping.modified.startLineNumber,d.lineRangeMapping.modified.endLineNumberExclusive,h(d.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let r=1;r<=i;r++){const o=e.getLineContent(r),a=t.getLineContent(r);if(o!==a)return!1}return!0}async $computeMoreMinimalEdits(e,t,i){const n=this._getModel(e);if(!n)return t;const r=[];let o;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return G.compareRangesUsingStarts(l.range,c.range);const h=l.range?0:1,d=c.range?0:1;return h-d});let a=0;for(let l=1;l<t.length;l++)G.getEndPosition(t[a].range).equals(G.getStartPosition(t[l].range))?(t[a].range=G.fromPositions(G.getStartPosition(t[a].range),G.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:h}of t){if(typeof h=="number"&&(o=h),G.isEmpty(l)&&!c)continue;const d=n.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,n.eol),d===c)continue;if(Math.max(c.length,d.length)>eg._diffLimit){r.push({range:l,text:c});continue}const g=x0e(d,c,i),p=n.offsetAt(G.lift(l).getStartPosition());for(const _ of g){const b=n.positionAt(p+_.originalStart),C=n.positionAt(p+_.originalStart+_.originalLength),x={text:c.substr(_.modifiedStart,_.modifiedLength),range:{startLineNumber:b.lineNumber,startColumn:b.column,endLineNumber:C.lineNumber,endColumn:C.column}};n.getValueInRange(x.range)!==x.text&&r.push(x)}}return typeof o=="number"&&r.push({eol:o,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),r}async $computeLinks(e){const t=this._getModel(e);return t?T0e(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?vwe(t):null}async $textualSuggest(e,t,i,n){const r=new th,o=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const h of c.words(o))if(!(h===t||!isNaN(Number(h)))&&(a.add(h),a.size>eg._suggestionsLimit))break e}}return{words:Array.from(a),duration:r.elapsed()}}async $computeWordRanges(e,t,i,n){const r=this._getModel(e);if(!r)return Object.create(null);const o=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=r.getLineWords(l,o);for(const h of c){if(!isNaN(Number(h.word)))continue;let d=a[h.word];d||(d=[],a[h.word]=d),d.push({startLineNumber:l,startColumn:h.startColumn,endLineNumber:l,endColumn:h.endColumn})}}return a}async $navigateValueSet(e,t,i,n,r){const o=this._getModel(e);if(!o)return null;const a=new RegExp(n,r);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const h=o.getValueInRange(c);return $4.INSTANCE.navigateValueSet(t,l,c,h,i)}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}};eg._diffLimit=1e5,eg._suggestionsLimit=1e4;let Q4=eg;typeof importScripts=="function"&&(globalThis.monaco=IX());const y7=gt("textResourceConfigurationService"),VZ=gt("textResourcePropertiesService"),mi=gt("ILanguageFeaturesService"),Vw=class Vw{static getChannel(e){return e.getChannel(Vw.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(Vw.CHANNEL_NAME,t)}};Vw.CHANNEL_NAME="editorWorkerHost";let X4=Vw;var S7=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Of=function(s,e){return function(t,i){e(t,i,s)}};const IU=300*1e3;function Pf(s,e){const t=s.getModel(e);return!(!t||t.isTooLargeForSyncing())}let Z4=class extends le{constructor(e,t,i,n,r,o){super(),this._languageConfigurationService=r,this._modelService=t,this._workerManager=this._register(new J4(e,this._modelService)),this._logService=n,this._register(o.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!Pf(this._modelService,a.uri))return Promise.resolve({links:[]});const h=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return h&&{links:h}}})),this._register(o.completionProvider.register("*",new Awe(this._workerManager,i,this._modelService,this._languageConfigurationService,this._logService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return Pf(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,n){const o=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,n);if(!o)return null;return{identical:o.identical,quitEarly:o.quitEarly,changes:l(o.changes),moves:o.moves.map(c=>new AZ(new Gs(new Qe(c[0],c[1]),new Qe(c[2],c[3])),l(c[4])))};function l(c){return c.map(h=>{var d;return new To(new Qe(h[0],h[1]),new Qe(h[2],h[3]),(d=h[4])==null?void 0:d.map(g=>new Hr(new G(g[0],g[1],g[2],g[3]),new G(g[4],g[5],g[6],g[7]))))})}}async computeMoreMinimalEdits(e,t,i=!1){if(iD(t)){if(!Pf(this._modelService,e))return Promise.resolve(t);const n=th.create(),r=this._workerWithResources([e]).then(o=>o.$computeMoreMinimalEdits(e.toString(),t,i));return r.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed())),Promise.race([r,v1(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return Pf(this._modelService,e)}async navigateValueSet(e,t,i){const n=this._modelService.getModel(e);if(!n)return null;const r=this._languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),o=r.source,a=r.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,o,a)}canComputeWordRanges(e){return Pf(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const n=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),r=n.source,o=n.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,r,o)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};Z4=S7([Of(1,mr),Of(2,y7),Of(3,pr),Of(4,kc),Of(5,mi)],Z4);class Awe{constructor(e,t,i,n,r){this.languageConfigurationService=n,this.logService=r,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const n=[];if(i.wordBasedSuggestions==="currentDocument")Pf(this._modelService,e.uri)&&n.push(e.uri);else for(const d of this._modelService.getModels())Pf(this._modelService,d.uri)&&(d===e?n.unshift(d.uri):(i.wordBasedSuggestions==="allDocuments"||d.getLanguageId()===e.getLanguageId())&&n.push(d.uri));if(n.length===0)return;const r=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),o=e.getWordAtPosition(t),a=o?new G(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):G.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column);this.logService.trace("[WordBasedCompletionItemProvider]",`word: "${(o==null?void 0:o.word)||""}", wordDef: "${r}", replace: [${a.toString()}], insert: [${l.toString()}]`);const h=await(await this._workerManager.withWorker()).textualSuggest(n,o==null?void 0:o.word,r);if(h)return{duration:h.duration,suggestions:h.words.map(d=>({kind:18,label:d,insertText:d,range:{insert:l,replace:a}}))}}}let J4=class extends le{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new o7).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(IU/2),ni),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>IU&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new vk(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};J4=S7([Of(1,mr)],J4);class Mwe{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let vk=class extends le{constructor(e,t,i){super(),this._workerDescriptorOrWorker=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(zbe(this._workerDescriptorOrWorker)),X4.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){V4(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return V4(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new Mwe(new Q4(null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new Nwe(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject(ime());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const n=await this.workerWithSyncedResources(e),r=i.source,o=i.flags;return n.$textualSuggest(e.map(a=>a.toString()),t,r,o)}dispose(){super.dispose(),this._disposed=!0}};vk=S7([Of(2,mr)],vk);function Owe(s,e){return new Pwe(s,e)}class Pwe extends vk{constructor(e,t){super(t.worker,t.keepIdleModels||!1,e),this._foreignModuleHost=t.host||null,this._foreignProxy=this._getProxy().then(i=>new Proxy({},{get(n,r,o){if(r!=="then"){if(typeof r!="string")throw new Error("Not supported");return(...a)=>i.$fmr(r,a)}}}))}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}getProxy(){return this._foreignProxy}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}const ID={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"},Ov=new class{clone(){return this}equals(s){return this===s}};function HZ(s,e){return new V6([new yv(0,"",s)],e)}function x7(s,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(s<<0|0|0|32768|2<<24)>>>0,new aD(t,e===null?Ov:e)}class _o{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let r=`color: ${t[i]};`;n&1&&(r+="font-style: italic;"),n&2&&(r+="font-weight: bold;");let o="";return n&4&&(o+=" underline"),n&8&&(o+=" line-through"),o&&(r+=`text-decoration:${o};`),r}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}const _u=class _u{static createEmpty(e,t){const i=_u.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new _u(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="";const r=new Array;for(const{text:o,metadata:a}of e)r.push(i+o.length,a),i+=o.length,n+=o;return new _u(new Uint32Array(r),n,t)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let r=0;r<n;r++)e[r<<1]=e[r+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const r=i+Math.floor((n-i)/2),o=e[r<<1];if(o===t)return r+1;o<t?i=r+1:o>t&&(n=r)}return i}constructor(e,t,i){this._lineTokensBrand=void 0,(e.length>1?e[e.length-2]:0)!==t.length&&$t(new Error("Token length and text length do not match!")),this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}getTextLength(){return this._text.length}equals(e){return e instanceof _u?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const n=t<<1,r=n+(i<<1);for(let o=n;o<r;o++)if(this._tokens[o]!==e._tokens[o])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=_o.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return _o.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return _o.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return _o.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return _o.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return _o.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return _u.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new L7(this,e,t,i)}sliceZeroCopy(e){return this.sliceAndInflate(e.start,e.endExclusive,0)}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="";const r=new Array;let o=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(o,a);const c=this._tokens[(t<<1)+1];r.push(n.length,c),t++,o=a}else if(l){if(l.offset>o){n+=this._text.substring(o,l.offset);const c=this._tokens[(t<<1)+1];r.push(n.length,c),o=l.offset}n+=l.text,r.push(n.length,l.tokenMetadata),i++}else break}return new _u(new Uint32Array(r),n,this.languageIdCodec)}getTokensInRange(e){const t=new Fwe,i=this.findTokenIndexAtOffset(e.start),n=this.findTokenIndexAtOffset(e.endExclusive);for(let r=i;r<=n;r++){const a=new ze(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){const t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){const t=this.getCount();for(let i=0;i<t;i++)e(i)}toString(){let e="";return this.forEach(t=>{e+=`[${this.getTokenText(t)}]{${this.getClassName(t)}}`}),e}};_u.defaultTokenMetadata=(32768|2<<24)>>>0;let Rn=_u;class L7{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,o=e.getCount();r<o&&!(e.getStartOffset(r)>=i);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof L7?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){const t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t);let r=this._source.getTokenText(t);return i<this._startOffset&&(r=r.substring(this._startOffset-i)),n>this._endOffset&&(r=r.substring(0,r.length-(n-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}class tw{static fromLineTokens(e){const t=[];for(let i=0;i<e.getCount();i++)t.push(new e5(e.getEndOffset(i)-e.getStartOffset(i),e.getMetadata(i)));return tw.create(t)}static create(e){return new tw(e)}constructor(e){this._tokenInfo=e}toLineTokens(e,t){return Rn.createFromTextAndMetadata(this.map((i,n)=>({text:i.substring(e),metadata:n.metadata})),t)}forEach(e){let t=0;for(const i of this._tokenInfo){const n=new ze(t,t+i.length);e(n,i),t+=i.length}}map(e){const t=[];let i=0;for(const n of this._tokenInfo){const r=new ze(i,i+n.length);t.push(e(r,n)),i+=n.length}return t}slice(e){const t=[];let i=0;for(const n of this._tokenInfo){const r=i,o=r+n.length;if(o>e.start){if(r>=e.endExclusive)break;const a=Math.max(0,e.start-r),l=Math.max(0,o-e.endExclusive);t.push(new e5(n.length-a-l,n.metadata))}i+=n.length}return tw.create(t)}}class e5{constructor(e,t){this.length=e,this.metadata=t}}class Fwe{constructor(){this._tokens=[]}add(e,t){this._tokens.push(new e5(e,t))}build(){return tw.create(this._tokens)}}class ia{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,n=t.length;if(i!==n)return!1;for(let r=0;r<i;r++)if(!ia._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const n=t+1,r=i+1,o=i-t,a=[];let l=0;for(const c of e)c.endColumn<=n||c.startColumn>=r||(a[l++]=new ia(Math.max(1,c.startColumn-n+1),Math.min(o+1,c.endColumn-n+1),c.className,c.type));return a}static filter(e,t,i,n){if(e.length===0)return[];const r=[];let o=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.range;if(h.endLineNumber<t||h.startLineNumber>t||h.isEmpty()&&(c.type===0||c.type===3))continue;const d=h.startLineNumber===t?h.startColumn:i,g=h.endLineNumber===t?h.endColumn:n;r[o++]=new ia(d,g,c.inlineClassName,c.type)}return r}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=ia._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class RU{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class Ck{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new RU(t,this.stopOffsets[n],this.classNames.join(" "),Ck._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new RU(t,e-1,this.classNames.join(" "),Ck._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class Bwe{static normalize(e,t){if(t.length===0)return[];const i=[],n=new Ck;let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];let c=l.startColumn,h=l.endColumn;const d=l.className,g=l.type===1?2:l.type===2?4:0;if(c>1){const b=e.charCodeAt(c-2);Tn(b)&&c--}if(h>1){const b=e.charCodeAt(h-2);Tn(b)&&h--}const p=c-1,_=h-2;r=n.consumeLowerThan(p,r,i),n.count===0&&(r=p),n.insert(_,d,g)}return n.consumeLowerThan(1073741824,r,i),i}}class yn{constructor(e,t,i,n){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=n,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class Tm{get isLTR(){return!this.containsRTL&&this.textDirection!==xo.RTL}constructor(e,t,i,n,r,o,a,l,c,h,d,g,p,_,b,C,x,S,y,k,D,R=!1){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=r,this.containsRTL=o,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(ia.compare),this.tabSize=h,this.startVisibleColumn=d,this.spaceWidth=g,this.stopRenderingLineAfter=b,this.renderWhitespace=C==="all"?4:C==="boundary"?1:C==="selection"?2:C==="trailing"?3:0,this.renderControlCharacters=x,this.fontLigatures=S,this.selectionsOnLine=y&&y.sort((M,O)=>M.start<O.start?-1:1),this.renderNewLineWhenEmpty=R,this.textDirection=k,this.verticalScrollbarSize=D;const N=Math.abs(_-g),A=Math.abs(p-g);N<A?(this.renderSpaceWidth=_,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=p,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&ia.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)&&this.textDirection===e.textDirection&&this.verticalScrollbarSize===e.verticalScrollbarSize&&this.renderNewLineWhenEmpty===e.renderNewLineWhenEmpty}}class WZ{constructor(e,t){this.partIndex=e,this.charIndex=t}}class Kl{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){const r=(t<<16|i<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=Kl.getPartIndex(t),n=Kl.getCharIndex(t);return new WZ(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const n=(e<<16|i<<0)>>>0;let r=0,o=this.length-1;for(;r+1<o;){const b=r+o>>>1,C=this._data[b];if(C===n)return b;C>n?o=b:r=b}if(r===o)return r;const a=this._data[r],l=this._data[o];if(a===n)return r;if(l===n)return o;const c=Kl.getPartIndex(a),h=Kl.getCharIndex(a),d=Kl.getPartIndex(l);let g;c!==d?g=t:g=Kl.getCharIndex(l);const p=i-h,_=g-i;return p<=_?r:o}}class yk{constructor(e,t){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsForeignElements=t}}function RD(s,e){if(s.lineContent.length===0){if(s.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(const o of s.lineDecorations)(o.type===1||o.type===2)&&(e.appendString('<span class="'),e.appendString(o.className),e.appendString('"></span>'),o.type===1&&(n|=1,t++),o.type===2&&(n|=2,i++));e.appendString("</span>");const r=new Kl(1,t+i);return r.setColumnInfo(1,t,0,0),new yk(r,n)}return s.renderNewLineWhenEmpty?e.appendString(`<span><span>
</span></span>`):e.appendString("<span><span></span></span>"),new yk(new Kl(0,0),0)}return Kwe(Wwe(s),e)}class Vwe{constructor(e,t,i){this.characterMapping=e,this.html=t,this.containsForeignElements=i}}function AD(s){const e=new J1(1e4),t=RD(s,e);return new Vwe(t.characterMapping,e.build(),t.containsForeignElements)}class Hwe{constructor(e,t,i,n,r,o,a,l,c,h,d,g,p,_,b){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=r,this.overflowingCharCount=o,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=h,this.startVisibleColumn=d,this.spaceWidth=g,this.renderSpaceCharCode=p,this.renderWhitespace=_,this.renderControlCharacters=b}}function Wwe(s){const e=s.lineContent;let t,i,n;s.stopRenderingLineAfter!==-1&&s.stopRenderingLineAfter<e.length?(t=!0,i=e.length-s.stopRenderingLineAfter,n=s.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let r=zwe(e,s.containsRTL,s.lineTokens,s.fauxIndentLength,n);s.renderControlCharacters&&!s.isBasicASCII&&(r=$we(e,r)),(s.renderWhitespace===4||s.renderWhitespace===1||s.renderWhitespace===2&&s.selectionsOnLine||s.renderWhitespace===3&&!s.continuesWithWrappedLine)&&(r=qwe(s,e,n,r));let o=0;if(s.lineDecorations.length>0){for(let a=0,l=s.lineDecorations.length;a<l;a++){const c=s.lineDecorations[a];c.type===3||c.type===1?o|=1:c.type===2&&(o|=2)}r=Gwe(e,n,r,s.lineDecorations)}return s.containsRTL?r=jwe(e,r):r=Uwe(e,r,!s.isBasicASCII||s.fontLigatures),new Hwe(s.useMonospaceOptimizations,s.canUseHalfwidthRightwardsArrow,e,n,t,i,r,o,s.fauxIndentLength,s.tabSize,s.startVisibleColumn,s.spaceWidth,s.renderSpaceCharCode,s.renderWhitespace,s.renderControlCharacters)}function zwe(s,e,t,i,n){const r=[];let o=0;i>0&&(r[o++]=new yn(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const h=t.getEndOffset(l);if(h<=i)continue;const d=t.getClassName(l);if(h>=n){const p=e?Sv(s.substring(a,n)):!1;r[o++]=new yn(n,d,0,p);break}const g=e?Sv(s.substring(a,h)):!1;r[o++]=new yn(h,d,0,g),a=h}return r}function Uwe(s,e,t){let i=0;const n=[];let r=0;if(t)for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex;if(i+50<c){const h=l.type,d=l.metadata,g=l.containsRTL;let p=-1,_=i;for(let b=i;b<c;b++)s.charCodeAt(b)===32&&(p=b),p!==-1&&b-_>=50&&(n[r++]=new yn(p+1,h,d,g),_=p+1,p=-1);_!==c&&(n[r++]=new yn(c,h,d,g))}else n[r++]=l;i=c}else for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex,h=c-i;if(h>50){const d=l.type,g=l.metadata,p=l.containsRTL,_=Math.ceil(h/50);for(let b=1;b<_;b++){const C=i+b*50;n[r++]=new yn(C,d,g,p)}n[r++]=new yn(c,d,g,p)}else n[r++]=l;i=c}return n}function jwe(s,e){if(e.length===0)return e;const t=e[0];if(!t.containsRTL)return e;const i=t.endIndex;let n=0;for(let o=0;o<i;o++){const a=s.charCodeAt(o);if(a!==32&&a!==9){n=o;break}}if(n===0)return e;const r=[];r.push(new yn(n,t.type,t.metadata,!1)),r.push(new yn(i,t.type,t.metadata,t.containsRTL));for(let o=1;o<e.length;o++)r.push(e[o]);return r}function zZ(s){return s<32?s!==9:s===127||s>=8234&&s<=8238||s>=8294&&s<=8297||s>=8206&&s<=8207||s===1564}function $we(s,e){const t=[];let i=new yn(0,"",0,!1),n=0;for(const r of e){const o=r.endIndex;for(;n<o;n++){const a=s.charCodeAt(n);zZ(a)&&(n>i.endIndex&&(i=new yn(n,r.type,r.metadata,r.containsRTL),t.push(i)),i=new yn(n+1,"mtkcontrol",r.metadata,!1),t.push(i))}n>i.endIndex&&(i=new yn(o,r.type,r.metadata,r.containsRTL),t.push(i))}return t}function qwe(s,e,t,i){const n=s.continuesWithWrappedLine,r=s.fauxIndentLength,o=s.tabSize,a=s.startVisibleColumn,l=s.useMonospaceOptimizations,c=s.selectionsOnLine,h=s.renderWhitespace===1,d=s.renderWhitespace===3,g=s.renderSpaceWidth!==s.spaceWidth,p=[];let _=0,b=0,C=i[b].type,x=i[b].containsRTL,S=i[b].endIndex;const y=i.length;let k=!1,D=qr(e),R;D===-1?(k=!0,D=t,R=t):R=Sm(e);let N=!1,A=0,M=c&&c[A],O=a%o;for(let H=r;H<t;H++){const U=e.charCodeAt(H);M&&M.endExclusive<=H&&(A++,M=c&&c[A]);let X;if(H<D||H>R)X=!0;else if(U===9)X=!0;else if(U===32)if(h)if(N)X=!0;else{const Y=H+1<t?e.charCodeAt(H+1):0;X=Y===32||Y===9}else X=!0;else X=!1;if(X&&c&&(X=!!M&&M.start<=H&&H<M.endExclusive),X&&d&&(X=k||H>R),X&&x&&H>=D&&H<=R&&(X=!1),N){if(!X||!l&&O>=o){if(g){const Y=_>0?p[_-1].endIndex:r;for(let q=Y+1;q<=H;q++)p[_++]=new yn(q,"mtkw",1,!1)}else p[_++]=new yn(H,"mtkw",1,!1);O=O%o}}else(H===S||X&&H>r)&&(p[_++]=new yn(H,C,0,x),O=O%o);for(U===9?O=o:ih(U)?O+=2:O++,N=X;H===S&&(b++,b<y);)C=i[b].type,x=i[b].containsRTL,S=i[b].endIndex}let V=!1;if(N)if(n&&h){const H=t>0?e.charCodeAt(t-1):0,U=t>1?e.charCodeAt(t-2):0;H===32&&U!==32&&U!==9||(V=!0)}else V=!0;if(V)if(g){const H=_>0?p[_-1].endIndex:r;for(let U=H+1;U<=t;U++)p[_++]=new yn(U,"mtkw",1,!1)}else p[_++]=new yn(t,"mtkw",1,!1);else p[_++]=new yn(t,C,0,x);return p}function Gwe(s,e,t,i){i.sort(ia.compare);const n=Bwe.normalize(s,i),r=n.length;let o=0;const a=[];let l=0,c=0;for(let d=0,g=t.length;d<g;d++){const p=t[d],_=p.endIndex,b=p.type,C=p.metadata,x=p.containsRTL;for(;o<r&&n[o].startOffset<_;){const S=n[o];if(S.startOffset>c&&(c=S.startOffset,a[l++]=new yn(c,b,C,x)),S.endOffset+1<=_)c=S.endOffset+1,a[l++]=new yn(c,b+" "+S.className,C|S.metadata,x),o++;else{c=_,a[l++]=new yn(c,b+" "+S.className,C|S.metadata,x);break}}_>c&&(c=_,a[l++]=new yn(c,b,C,x))}const h=t[t.length-1].endIndex;if(o<r&&n[o].startOffset===h)for(;o<r&&n[o].startOffset===h;){const d=n[o];a[l++]=new yn(c,d.className,d.metadata,!1),o++}return a}function Kwe(s,e){const t=s.fontIsMonospace,i=s.canUseHalfwidthRightwardsArrow,n=s.containsForeignElements,r=s.lineContent,o=s.len,a=s.isOverflowing,l=s.overflowingCharCount,c=s.parts,h=s.fauxIndentLength,d=s.tabSize,g=s.startVisibleColumn,p=s.spaceWidth,_=s.renderSpaceCharCode,b=s.renderWhitespace,C=s.renderControlCharacters,x=new Kl(o+1,c.length);let S=!1,y=0,k=g,D=0,R=0,N=0;e.appendString("<span>");for(let A=0,M=c.length;A<M;A++){const O=c[A],V=O.endIndex,H=O.type,U=O.containsRTL,X=b!==0&&O.isWhitespace(),Y=X&&!t&&(H==="mtkw"||!n),q=y===V&&O.isPseudoAfter();if(D=0,e.appendString("<span "),U&&e.appendString('dir="rtl" style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(Y?"mtkz":H),e.appendASCIICharCode(34),X){let ee=0;{let ue=y,oe=k;for(;ue<V;ue++){const $=(r.charCodeAt(ue)===9?d-oe%d:1)|0;ee+=$,ue>=h&&(oe+=$)}}for(Y&&(e.appendString(' style="width:'),e.appendString(String(p*ee)),e.appendString('px"')),e.appendASCIICharCode(62);y<V;y++){x.setColumnInfo(y+1,A-N,D,R),N=0;const ue=r.charCodeAt(y);let oe,Ee;if(ue===9){oe=d-k%d|0,Ee=oe,!i||Ee>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let $=2;$<=Ee;$++)e.appendCharCode(160)}else oe=2,Ee=1,e.appendCharCode(_),e.appendCharCode(8204);D+=oe,R+=Ee,y>=h&&(k+=Ee)}}else for(e.appendASCIICharCode(62);y<V;y++){x.setColumnInfo(y+1,A-N,D,R),N=0;const ee=r.charCodeAt(y);let ue=1,oe=1;switch(ee){case 9:ue=d-k%d,oe=ue;for(let Ee=1;Ee<=ue;Ee++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:C?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:ih(ee)&&oe++,C&&ee<32?e.appendCharCode(9216+ee):C&&ee===127?e.appendCharCode(9249):C&&zZ(ee)?(e.appendString("[U+"),e.appendString(Ywe(ee)),e.appendString("]"),ue=8,oe=ue):e.appendCharCode(ee)}D+=ue,R+=oe,y>=h&&(k+=oe)}q?N++:N=0,y>=o&&!S&&O.isPseudoAfter()&&(S=!0,x.setColumnInfo(y+1,A,D,R)),e.appendString("</span>")}return S||x.setColumnInfo(o+1,c.length-1,D,R),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(v(796,"Show more ({0})",Qwe(l))),e.appendString("</span>")),e.appendString("</span>"),new yk(x,n)}function Ywe(s){return s.toString(16).toUpperCase().padStart(4,"0")}function Qwe(s){return s<1024?v(797,"{0} chars",s):s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(1)} MB`}class AU{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}}class Xwe{constructor(e,t){this.tabSize=e,this.data=t}}class k7{constructor(e,t,i,n,r,o,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=r,this.tokens=o,this.inlineDecorations=a}}class Ro{constructor(e,t,i,n,r,o,a,l,c,h,d,g){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=Ro.isBasicASCII(i,o),this.containsRTL=Ro.containsRTL(i,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=h,this.textDirection=d,this.hasVariableFonts=g}static isBasicASCII(e,t){return t?$6(e):!0}static containsRTL(e,t,i){return!t&&i?Sv(e):!1}}class Pv{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&Sn(e.data,t.data)}static equalsArr(e,t){return Sn(e,t,Pv.equals)}}function Zwe(s){return Array.isArray(s)}function Jwe(s){return!Zwe(s)}function UZ(s){return typeof s=="string"}function MU(s){return!UZ(s)}function Ff(s){return!s}function Gu(s,e){return s.ignoreCase&&e?e.toLowerCase():e}function OU(s){return s.replace(/[&<>'"_]/g,"-")}function eve(s,e){console.log(`${s.languageId}: ${e}`)}function _i(s,e){return new Error(`${s.languageId}: ${e}`)}function Qh(s,e,t,i,n){const r=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(r,function(a,l,c,h,d,g,p,_,b){return Ff(c)?Ff(h)?!Ff(d)&&d<i.length?Gu(s,i[d]):!Ff(p)&&s&&typeof s[p]=="string"?s[p]:(o===null&&(o=n.split("."),o.unshift(n)),!Ff(g)&&g<o.length?Gu(s,o[g]):""):Gu(s,t):"$"})}function tve(s,e,t){const i=/\$[sS](\d\d?)/g;let n=null;return e.replace(i,function(r,o){return n===null&&(n=t.split("."),n.unshift(t)),!Ff(o)&&o<n.length?pc(Gu(s,n[o])):""})}function XS(s,e){let t=e;for(;t&&t.length>0;){const i=s.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function ive(s,e){let t=e;for(;t&&t.length>0;){if(s.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var nve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},sve=function(s,e){return function(t,i){e(t,i,s)}},t5;const jZ=5,eE=class eE{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new H_(e,t);let i=H_.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new H_(e,t),this._entries[i]=n,n)}};eE._INSTANCE=new eE(jZ);let Fv=eE;class H_{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return H_._equals(this,e)}push(e){return Fv.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Fv.create(this.parent,e)}}class i_{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new i_(this.languageId,this.state)}}const tE=class tE{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new iw(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new iw(e,t);const i=H_.getStackElementId(e);let n=this._entries[i];return n||(n=new iw(e,null),this._entries[i]=n,n)}};tE._INSTANCE=new tE(jZ);let Xh=tE;class iw{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Xh.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof iw)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class rve{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new yv(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,a=hn.get(r);if(!a)return this.enterLanguage(r),this.emit(n,""),o;const l=a.tokenize(e,t,o);if(n!==0)for(const c of l.tokens)this._tokens.push(new yv(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new V6(this._tokens,e)}}class Sk{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,r=t.length,o=i!==null?i.length:0;if(n===0&&r===0&&o===0)return new Uint32Array(0);if(n===0&&r===0)return i;if(r===0&&o===0)return e;const a=new Uint32Array(n+r+o);e!==null&&a.set(e);for(let l=0;l<r;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+r),a}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,a=hn.get(r);if(!a)return this.enterLanguage(r),this.emit(n,""),o;const l=a.tokenizeEncoded(e,t,o);if(n!==0)for(let c=0,h=l.tokens.length;c<h;c+=2)l.tokens[c]+=n;return this._prependTokens=Sk._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new aD(Sk._merge(this._prependTokens,this._tokens,null),e)}}let Bv=t5=class extends le{constructor(e,t,i,n,r){super(),this._configurationService=r,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._register(hn.onDidChange(a=>{if(o)return;let l=!1;for(let c=0,h=a.changedLanguages.length;c<h;c++){const d=a.changedLanguages[c];if(this._embeddedLanguages[d]){l=!0;break}}l&&(o=!0,hn.handleChange([this._languageId]),o=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=hn.get(t);if(i){if(i instanceof t5){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}hn.isResolved(t)||e.push(hn.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=Fv.create(null,this._lexer.start);return Xh.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return HZ(this._languageId,i);const n=new rve,r=this._tokenize(e,t,i,n);return n.finalize(r)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return x7(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new Sk(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),r=this._tokenize(e,t,i,n);return n.finalize(r)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=XS(this._lexer,t.stack.state),!i))throw _i(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,r=!1;for(const o of i){if(!MU(o.action)||!(o.action.nextEmbedded==="@pop"||o.action.hasEmbeddedEndInCases))continue;r=!0;let a=o.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const h=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),h)}const c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!r)throw _i(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,r){const o=this._findLeavingNestedLanguageOffset(e,i);if(o===-1){const c=r.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return Xh.create(i.stack,new i_(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,o);a.length>0&&r.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(o);return this._myTokenize(l,t,i,n+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,r){r.enterLanguage(this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,h=i.stack,d=0,g=null,p=!0;for(;p||d<l;){const _=d,b=h.depth,C=g?g.groups.length:0,x=h.state;let S=null,y=null,k=null,D=null,R=null;if(g){S=g.matches;const M=g.groups.shift();y=M.matched,k=M.action,D=g.rule,g.groups.length===0&&(g=null)}else{if(!p&&d>=l)break;p=!1;let M=this._lexer.tokenizer[x];if(!M&&(M=XS(this._lexer,x),!M))throw _i(this._lexer,"tokenizer state is not defined: "+x);const O=a.substr(d);for(const V of M)if((d===0||!V.matchOnlyAtLineStart)&&(S=O.match(V.resolveRegex(x)),S)){y=S[0],k=V.action;break}}if(S||(S=[""],y=""),k||(d<l&&(S=[a.charAt(d)],y=S[0]),k=this._lexer.defaultToken),y===null)break;for(d+=y.length;Jwe(k)&&MU(k)&&k.test;)k=k.test(y,S,x,d===l);let N=null;if(typeof k=="string"||Array.isArray(k))N=k;else if(k.group)N=k.group;else if(k.token!==null&&k.token!==void 0){if(k.tokenSubst?N=Qh(this._lexer,k.token,y,S,x):N=k.token,k.nextEmbedded)if(k.nextEmbedded==="@pop"){if(!c)throw _i(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw _i(this._lexer,"cannot enter embedded language from within an embedded language");R=Qh(this._lexer,k.nextEmbedded,y,S,x)}if(k.goBack&&(d=Math.max(0,d-k.goBack)),k.switchTo&&typeof k.switchTo=="string"){let M=Qh(this._lexer,k.switchTo,y,S,x);if(M[0]==="@"&&(M=M.substr(1)),XS(this._lexer,M))h=h.switchTo(M);else throw _i(this._lexer,"trying to switch to a state '"+M+"' that is undefined in rule: "+this._safeRuleName(D))}else{if(k.transform&&typeof k.transform=="function")throw _i(this._lexer,"action.transform not supported");if(k.next)if(k.next==="@push"){if(h.depth>=this._lexer.maxStack)throw _i(this._lexer,"maximum tokenizer stack size reached: ["+h.state+","+h.parent.state+",...]");h=h.push(x)}else if(k.next==="@pop"){if(h.depth<=1)throw _i(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(D));h=h.pop()}else if(k.next==="@popall")h=h.popall();else{let M=Qh(this._lexer,k.next,y,S,x);if(M[0]==="@"&&(M=M.substr(1)),XS(this._lexer,M))h=h.push(M);else throw _i(this._lexer,"trying to set a next state '"+M+"' that is undefined in rule: "+this._safeRuleName(D))}}k.log&&typeof k.log=="string"&&eve(this._lexer,this._lexer.languageId+": "+Qh(this._lexer,k.log,y,S,x))}if(N===null)throw _i(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(D));const A=M=>{const O=this._languageService.getLanguageIdByLanguageName(M)||this._languageService.getLanguageIdByMimeType(M)||M,V=this._getNestedEmbeddedLanguageData(O);if(d<l){const H=e.substr(d);return this._nestedTokenize(H,t,Xh.create(h,V),n+d,r)}else return Xh.create(h,V)};if(Array.isArray(N)){if(g&&g.groups.length>0)throw _i(this._lexer,"groups cannot be nested: "+this._safeRuleName(D));if(S.length!==N.length+1)throw _i(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(D));let M=0;for(let O=1;O<S.length;O++)M+=S[O].length;if(M!==y.length)throw _i(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(D));g={rule:D,matches:S,groups:[]};for(let O=0;O<N.length;O++)g.groups[O]={action:N[O],matched:S[O+1]};d-=y.length;continue}else{if(N==="@rematch"&&(d-=y.length,y="",S=null,N="",R!==null))return A(R);if(y.length===0){if(l===0||b!==h.depth||x!==h.state||(g?g.groups.length:0)!==C)continue;throw _i(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(D))}let M=null;if(UZ(N)&&N.indexOf("@brackets")===0){const O=N.substr(9),V=ove(this._lexer,y);if(!V)throw _i(this._lexer,"@brackets token returned but no bracket defined as: "+y);M=OU(V.token+O)}else{const O=N===""?"":N+this._lexer.tokenPostfix;M=OU(O)}_<o&&r.emit(_+n,M)}if(R!==null)return A(R)}return Xh.create(h,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new i_(e,Ov);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),hn.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=hn.get(e);return t?new i_(e,t.getInitialState()):new i_(e,Ov)}};Bv=t5=nve([sve(4,yi)],Bv);function ove(s,e){if(!e)return null;e=Gu(s,e);const t=s.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const yR=Wd("standaloneColorizer",{createHTML:s=>s});class E7{static colorizeElement(e,t,i,n){n=n||{};const r=n.theme||"vs",o=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(o)||o;e.setTheme(r);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+r;const c=h=>{const d=(yR==null?void 0:yR.createHTML(h))??h;i.innerHTML=d};return this.colorize(t,l||"",a,n).then(c,h=>console.error(h))}static async colorize(e,t,i,n){const r=e.languageIdCodec;let o=4;n&&typeof n.tabSize=="number"&&(o=n.tabSize),G6(t)&&(t=t.substr(1));const a=K1(t);if(!e.isRegisteredLanguageId(i))return PU(a,o,r);const l=await hn.getOrCreate(i);return l?ave(a,o,l,r):PU(a,o,r)}static colorizeLine(e,t,i,n,r=4){const o=Ro.isBasicASCII(e,t),a=Ro.containsRTL(e,o,i);return AD(new Tm(!1,!0,e,!1,o,a,0,n,[],r,0,0,0,0,-1,"none",!1,!1,null,null,0)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const o=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function ave(s,e,t,i){return new Promise((n,r)=>{const o=()=>{const a=lve(s,e,t,i);if(t instanceof Bv){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,r);return}}n(a)};o()})}function PU(s,e,t){let i=[];const r=new Uint32Array(2);r[0]=0,r[1]=33587200;for(let o=0,a=s.length;o<a;o++){const l=s[o];r[0]=l.length;const c=new Rn(r,l,t),h=Ro.isBasicASCII(l,!0),d=Ro.containsRTL(l,h,!0),g=AD(new Tm(!1,!0,l,!1,h,d,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null,null,0));i=i.concat(g.html),i.push("<br/>")}return i.join("")}function lve(s,e,t,i){let n=[],r=t.getInitialState();for(let o=0,a=s.length;o<a;o++){const l=s[o],c=t.tokenizeEncoded(l,!0,r);Rn.convertToEndOffset(c.tokens,l.length);const h=new Rn(c.tokens,l,i),d=Ro.isBasicASCII(l,!0),g=Ro.containsRTL(l,d,!0),p=AD(new Tm(!1,!0,l,!1,d,g,0,h.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null,null,0));n=n.concat(p.html),n.push("<br/>"),r=c.endState}return n.join("")}const FU=2e4;let Bf,Kx,i5,Yx,n5;function cve(s){Bf=document.createElement("div"),Bf.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),Bf.appendChild(i),i};Kx=e(),i5=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),Bf.appendChild(i),i};Yx=t(),n5=t(),s.appendChild(Bf)}function Vv(s){Bf&&(Kx.textContent!==s?(_l(i5),Lk(Kx,s)):(_l(Kx),Lk(i5,s)))}function xk(s){Bf&&(Yx.textContent!==s?(_l(n5),Lk(Yx,s)):(_l(Yx),Lk(n5,s)))}function Lk(s,e){_l(s),e.length>FU&&(e=e.substr(0,FU)),s.textContent=e,s.style.visibility="hidden",s.style.visibility="visible"}const $Z=gt("markerDecorationsService");var uve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},hve=function(s,e){return function(t,i){e(t,i,s)}},n1;let kk=(n1=class{constructor(e,t){}dispose(){}},n1.ID="editor.contrib.markerDecorations",n1);kk=uve([hve(1,$Z)],kk);pZ(kk.ID,kk,0);class qZ extends le{constructor(e,t){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,n=!1;const r=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{Ar(Ue(this._referenceDomElement),()=>{n=!1,r()})}};this._resizeObserver=new ResizeObserver(o=>{o&&o[0]&&o[0].contentRect?e={width:o[0].contentRect.width,height:o[0].contentRect.height}:e=null,i=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}}const w_=class w_{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=w_._read(e,this.key),i=r=>w_._read(e,r),n=(r,o)=>w_._write(e,r,o);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u"||e===null)return;const i=t.indexOf(".");if(i>=0){const n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){const n=t.indexOf(".");if(n>=0){const r=t.substring(0,n);e[r]=e[r]||{},this._write(e[r],t.substring(n+1),i);return}e[t]=i}};w_.items=[];let Hv=w_;function ca(s,e){Hv.items.push(new Hv(s,e))}function _r(s,e){ca(s,(t,i,n)=>{if(typeof t<"u"){for(const[r,o]of e)if(t===r){n(s,o);return}}})}function dve(s){Hv.items.forEach(e=>e.apply(s))}_r("wordWrap",[[!0,"on"],[!1,"off"]]);_r("lineNumbers",[[!0,"on"],[!1,"off"]]);_r("cursorBlinking",[["visible","solid"]]);_r("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);_r("renderLineHighlight",[[!0,"line"],[!1,"none"]]);_r("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);_r("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);_r("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);_r("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);_r("autoIndent",[[!1,"advanced"],[!0,"full"]]);_r("matchBrackets",[[!0,"always"],[!1,"never"]]);_r("renderFinalNewline",[[!0,"on"],[!1,"off"]]);_r("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);_r("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);_r("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);_r("defaultColorDecorators",[[!0,"auto"],[!1,"never"]]);_r("minimap.autohide",[[!0,"mouseover"],[!1,"none"]]);ca("autoClosingBrackets",(s,e,t)=>{s===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});ca("renderIndentGuides",(s,e,t)=>{typeof s<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!s))});ca("highlightActiveIndentGuide",(s,e,t)=>{typeof s<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!s))});const fve={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};ca("suggest.filteredTypes",(s,e,t)=>{if(s&&typeof s=="object"){for(const i of Object.entries(fve))s[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});ca("quickSuggestions",(s,e,t)=>{if(typeof s=="boolean"){const i=s?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});ca("experimental.stickyScroll.enabled",(s,e,t)=>{typeof s=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",s))});ca("experimental.stickyScroll.maxLineCount",(s,e,t)=>{typeof s=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",s))});ca("editor.experimentalEditContextEnabled",(s,e,t)=>{typeof s=="boolean"&&(t("editor.experimentalEditContextEnabled",void 0),typeof e("editor.editContext")>"u"&&t("editor.editContext",s))});ca("codeActionsOnSave",(s,e,t)=>{if(s&&typeof s=="object"){let i=!1;const n={};for(const r of Object.entries(s))typeof r[1]=="boolean"?(i=!0,n[r[0]]=r[1]?"explicit":"never"):n[r[0]]=r[1];i&&t("codeActionsOnSave",n)}});ca("codeActionWidget.includeNearbyQuickfixes",(s,e,t)=>{typeof s=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",s))});ca("lightbulb.enabled",(s,e,t)=>{typeof s=="boolean"&&t("lightbulb.enabled",s?void 0:"off")});ca("inlineSuggest.edits.codeShifting",(s,e,t)=>{typeof s=="boolean"&&(t("inlineSuggest.edits.codeShifting",void 0),t("inlineSuggest.edits.allowCodeShifting",s?"always":"never"))});class gve{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new Z,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const Ek=new gve;function mve(s,e,t){const i=s.get(58),n=s.get(62),r=s.get(61),o=s.get(60),a=s.get(63),l=s.get(75),c=s.get(72);return tm._create(i,n,r,o,a,l,c,e,t)}function pve(s,e,t=!1){const i=mo.fontFamily.validate(s.fontFamily),n=mo.fontWeight.validate(s.fontWeight),r=mo.fontSize.validate(s.fontSize),o=mo.fontLigatures2.validate(s.fontLigatures),a=mo.fontVariations.validate(s.fontVariations),l=mo.lineHeight.validate(s.lineHeight),c=mo.letterSpacing.validate(s.letterSpacing);return tm._create(i,n,r,o,a,l,c,e,t)}const Mo=gt("accessibilityService"),_ve=new He("accessibilityModeEnabled",!1);class bve{constructor(){this._inputMode="insert",this._onDidChangeInputMode=new Z,this.onDidChangeInputMode=this._onDidChangeInputMode.event}getInputMode(){return this._inputMode}}const s5=new bve;var wve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},vve=function(s,e){return function(t,i){e(t,i,s)}};let r5=class extends le{constructor(e,t,i,n,r){super(),this._accessibilityService=r,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new Z),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new wX,this.isSimpleWidget=e,this.contextMenuId=t,this._containerObserver=this._register(new qZ(n,i.dimension)),this._targetWindowId=Ue(n).vscodeWindowId,this._rawOptions=BU(i),this._validatedOptions=Zh.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(19)&&this._containerObserver.startObserving(),this._register(Yh.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(Ek.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(A4.onDidChange(()=>this._recomputeOptions())),this._register(lk.getInstance(Ue(n)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions())),this._register(s5.onDidChangeInputMode(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Zh.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=mve(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:this._validatedOptions.get(164)||Ek.getTabFocusMode(),inputMode:s5.getInputMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount,editContextSupported:e.editContextSupported};return Zh.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:yve(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:cD||Kr,pixelRatio:lk.getInstance(Lz(this._targetWindowId,!0).window).value,editContextSupported:typeof globalThis.EditContext=="function",accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return A4.readFontInfo(Lz(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=BU(e);Zh.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Zh.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=Cve(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};r5=wve([vve(4,Mo)],r5);function Cve(s){let e=0;for(;s;)s=Math.floor(s/10),e++;return e||1}function yve(){let s="";return nm||HX?(s+="no-minimap-shadow ",s+="enable-user-select "):s+="no-user-select ",_t&&(s+="mac "),s}class Sve{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class xve{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Zh{static validateOptions(e){const t=new Sve;for(const i of Yp){const n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new xve;for(const n of Yp)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?Sn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Zh._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const r of Yp){const o=!Zh._deepEquals(e._read(r.id),t._read(r.id));i[r.id]=o,o&&(n=!0)}return n?new bX(i):null}static applyUpdate(e,t){let i=!1;for(const n of Yp)if(t.hasOwnProperty(n.name)){const r=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=r.newValue,i=i||r.didChange}return i}}function BU(s){const e=vu(s);return dve(e),e}var nd;(function(s){const e={total:0,min:Number.MAX_VALUE,max:0},t={...e},i={...e},n={...e};let r=0;const o={keydown:0,input:0,render:0};function a(){x(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),o.keydown=1,queueMicrotask(l)}s.onKeyDown=a;function l(){o.keydown===1&&(performance.mark("keydown/end"),o.keydown=2)}function c(){performance.mark("input/start"),o.input=1,C()}s.onBeforeInput=c;function h(){o.input===0&&c(),queueMicrotask(d)}s.onInput=h;function d(){o.input===1&&(performance.mark("input/end"),o.input=2)}function g(){x()}s.onKeyUp=g;function p(){x()}s.onSelectionChange=p;function _(){o.keydown===2&&o.input===2&&o.render===0&&(performance.mark("render/start"),o.render=1,queueMicrotask(b),C())}s.onRenderStart=_;function b(){o.render===1&&(performance.mark("render/end"),o.render=2)}function C(){setTimeout(x)}function x(){o.keydown===2&&o.input===2&&o.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),S("keydown",e),S("input",t),S("render",i),S("inputlatency",n),r++,y())}function S(N,A){const M=performance.getEntriesByName(N)[0].duration;A.total+=M,A.min=Math.min(A.min,M),A.max=Math.max(A.max,M)}function y(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),o.keydown=0,o.input=0,o.render=0}function k(){if(r===0)return;const N={keydown:D(e),input:D(t),render:D(i),total:D(n),sampleCount:r};return R(e),R(t),R(i),R(n),r=0,N}s.getAndClearMeasurements=k;function D(N){return{average:N.total/r,max:N.max,min:N.min}}function R(N){N.total=0,N.min=Number.MAX_VALUE,N.max=0}})(nd||(nd={}));const GZ=new Map;function bl(s=ni.document.head,e,t){const i=document.createElement("style");if(i.type="text/css",i.media="screen",e==null||e(i),s.appendChild(i),s===ni.document.head){const n=new Set;GZ.set(i,n);for(const{window:r,disposables:o}of XX())r!==ni&&o.add(Lve(i,n,r))}return i}function Lve(s,e,t){var r,o;const i=new Pe,n=s.cloneNode(!0);t.document.head.appendChild(n),i.add(qe(()=>n.remove()));for(const a of Eve(s))(o=n.sheet)==null||o.insertRule(a.cssText,(r=n.sheet)==null?void 0:r.cssRules.length);return i.add(S1e.observe(s,i,{childList:!0,subtree:Kr,characterData:Kr})(()=>{n.textContent=s.textContent})),e.add(n),i.add(qe(()=>e.delete(n))),i}let SR=null;function kve(){return SR||(SR=bl()),SR}function Eve(s){var e,t;return(e=s==null?void 0:s.sheet)!=null&&e.rules?s.sheet.rules:(t=s==null?void 0:s.sheet)!=null&&t.cssRules?s.sheet.cssRules:[]}function o5(s,e,t=kve()){var i;if(!(!t||!e)){(i=t.sheet)==null||i.insertRule(`${s} {${e}}`,0);for(const n of GZ.get(t)??[])o5(s,e,n)}}class MD{constructor(){this._hooks=new Pe,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=r;let o=e;try{e.setPointerCapture(t),this._hooks.add(qe(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{o=Ue(e)}this._hooks.add(ie(o,Le.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(ie(o,Le.POINTER_UP,a=>this.stopMonitoring(!0)))}}function D7(s){return`--vscode-${s.replace(/\./g,"-")}`}function De(s){return`var(${D7(s)})`}function Dve(s,e){return`var(${D7(s)}, ${e})`}function Tve(s){return s!==null&&typeof s=="object"&&"light"in s&&"dark"in s}const KZ={ColorContribution:"base.contributions.colors"},Nve="default";class Ive extends le{constructor(){super(),this._onDidChangeSchema=this._register(new Z),this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,r){const o={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:r};this.colorsById[e]=o;const a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=v(2022,"This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:Nve,description:v(2023,"Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i!=null&&i.defaults){const n=Tve(i.defaults)?i.defaults[t.type]:i.defaults;return Uo(n,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const n=t.indexOf(".")===-1?0:1,r=i.indexOf(".")===-1?0:1;return n!==r?n-r:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const OD=new Ive;ss.add(KZ.ColorContribution,OD);function j(s,e,t,i,n){return OD.registerColor(s,e,t,i,n)}function Rve(s,e){var t,i,n,r;switch(s.op){case 0:return(t=Uo(s.value,e))==null?void 0:t.darken(s.factor);case 1:return(i=Uo(s.value,e))==null?void 0:i.lighten(s.factor);case 2:return(n=Uo(s.value,e))==null?void 0:n.transparent(s.factor);case 7:{const o=Uo(s.color,e)||me.transparent,a=Uo(s.with,e)||me.transparent;return o.mix(a,s.ratio)}case 3:{const o=Uo(s.background,e);return o?(r=Uo(s.value,e))==null?void 0:r.makeOpaque(o):Uo(s.value,e)}case 4:for(const o of s.values){const a=Uo(o,e);if(a)return a}return;case 6:return Uo(e.defines(s.if)?s.then:s.else,e);case 5:{const o=Uo(s.value,e);if(!o)return;const a=Uo(s.background,e);return a?o.isDarkerThan(a)?me.getLighterColor(o,a,s.factor).transparent(s.transparency):me.getDarkerColor(o,a,s.factor).transparent(s.transparency):o.transparent(s.factor*s.transparency)}default:throw E6()}}function Nm(s,e){return{op:0,value:s,factor:e}}function ml(s,e){return{op:1,value:s,factor:e}}function pt(s,e){return{op:2,value:s,factor:e}}function VU(...s){return{op:4,values:s}}function Ave(s,e,t){return{op:6,if:s,then:e,else:t}}function HU(s,e,t,i){return{op:5,value:s,background:e,factor:t,transparency:i}}function Uo(s,e){if(s!==null){if(typeof s=="string")return s[0]==="#"?me.fromHex(s):e.getColor(s);if(s instanceof me)return s;if(typeof s=="object")return Rve(s,e)}}const YZ="vscode://schemas/workbench-colors",QZ=ss.as(TD.JSONContribution);QZ.registerSchema(YZ,OD.getColorSchema());const WU=new Es(()=>QZ.notifySchemaChanged(YZ),200);OD.onDidChangeSchema(()=>{WU.isScheduled()||WU.schedule()});const ri=j("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},v(1773,"Overall foreground color. This color is only used if not overridden by a component."));j("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},v(1774,"Overall foreground for disabled elements. This color is only used if not overridden by a component."));j("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},v(1775,"Overall foreground color for error messages. This color is only used if not overridden by a component."));j("descriptionForeground",{light:"#717171",dark:pt(ri,.7),hcDark:pt(ri,.7),hcLight:pt(ri,.7)},v(1776,"Foreground color for description text providing additional information, for example for a label."));const a5=j("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},v(1777,"The default color for icons in the workbench.")),bc=j("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},v(1778,"Overall border color for focused elements. This color is only used if not overridden by a component.")),Nt=j("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},v(1779,"An extra border around elements to separate them from others for greater contrast.")),rn=j("contrastActiveBorder",{light:null,dark:null,hcDark:bc,hcLight:bc},v(1780,"An extra border around active elements to separate them from others for greater contrast."));j("selection.background",null,v(1781,"The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const Mve=j("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},v(1782,"Foreground color for links in text."));j("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},v(1783,"Foreground color for links in text when clicked on and on mouse hover."));j("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:me.black,hcLight:"#292929"},v(1784,"Color for text separators."));j("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},v(1785,"Foreground color for preformatted text segments."));j("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},v(1786,"Background color for preformatted text segments."));j("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},v(1787,"Background color for block quotes in text."));j("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:me.white,hcLight:"#292929"},v(1788,"Border color for block quotes in text."));j("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:me.black,hcLight:"#F2F2F2"},v(1789,"Background color for code blocks in text."));j("sash.hoverBorder",bc,v(1994,"Border color of active sashes."));const Qx=j("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:me.black,hcLight:"#0F4A85"},v(1995,"Badge background color. Badges are small information labels, e.g. for search results count.")),Ove=j("badge.foreground",{dark:me.white,light:"#333",hcDark:me.white,hcLight:me.white},v(1996,"Badge foreground color. Badges are small information labels, e.g. for search results count."));j("activityWarningBadge.foreground",{dark:me.black.lighten(.2),light:me.white,hcDark:null,hcLight:me.black.lighten(.2)},v(1997,"Foreground color of the warning activity badge"));j("activityWarningBadge.background",{dark:"#CCA700",light:"#BF8803",hcDark:null,hcLight:"#CCA700"},v(1998,"Background color of the warning activity badge"));j("activityErrorBadge.foreground",{dark:me.black.lighten(.2),light:me.white,hcDark:null,hcLight:me.black.lighten(.2)},v(1999,"Foreground color of the error activity badge"));j("activityErrorBadge.background",{dark:"#F14C4C",light:"#E51400",hcDark:null,hcLight:"#F14C4C"},v(2e3,"Background color of the error activity badge"));const T7=j("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},v(2001,"Scrollbar shadow to indicate that the view is scrolled.")),XZ=j("scrollbarSlider.background",{dark:me.fromHex("#797979").transparent(.4),light:me.fromHex("#646464").transparent(.4),hcDark:pt(Nt,.6),hcLight:pt(Nt,.4)},v(2002,"Scrollbar slider background color.")),ZZ=j("scrollbarSlider.hoverBackground",{dark:me.fromHex("#646464").transparent(.7),light:me.fromHex("#646464").transparent(.7),hcDark:pt(Nt,.8),hcLight:pt(Nt,.8)},v(2003,"Scrollbar slider background color when hovering.")),JZ=j("scrollbarSlider.activeBackground",{dark:me.fromHex("#BFBFBF").transparent(.4),light:me.fromHex("#000000").transparent(.6),hcDark:Nt,hcLight:Nt},v(2004,"Scrollbar slider background color when clicked on."));j("scrollbar.background",null,v(2005,"Scrollbar track background color."));const Pve=j("progressBar.background",{dark:me.fromHex("#0E70C0"),light:me.fromHex("#0E70C0"),hcDark:Nt,hcLight:Nt},v(2006,"Background color of the progress bar that can show for long running operations."));j("chart.line",{dark:"#236B8E",light:"#236B8E",hcDark:"#236B8E",hcLight:"#236B8E"},v(2007,"Line color for the chart."));j("chart.axis",{dark:me.fromHex("#BFBFBF").transparent(.4),light:me.fromHex("#000000").transparent(.6),hcDark:Nt,hcLight:Nt},v(2008,"Axis color for the chart."));j("chart.guide",{dark:me.fromHex("#BFBFBF").transparent(.2),light:me.fromHex("#000000").transparent(.2),hcDark:Nt,hcLight:Nt},v(2009,"Guide line for the chart."));const Oa=j("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:me.black,hcLight:me.white},v(1798,"Editor background color.")),YC=j("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:me.white,hcLight:ri},v(1799,"Editor default foreground color."));j("editorStickyScroll.background",Oa,v(1800,"Background color of sticky scroll in the editor"));j("editorStickyScrollGutter.background",Oa,v(1801,"Background color of the gutter part of sticky scroll in the editor"));j("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:me.fromHex("#0F4A85").transparent(.1)},v(1802,"Background color of sticky scroll on hover in the editor"));j("editorStickyScroll.border",{dark:null,light:null,hcDark:Nt,hcLight:Nt},v(1803,"Border color of sticky scroll in the editor"));j("editorStickyScroll.shadow",T7,v(1804," Shadow color of sticky scroll in the editor"));const Ia=j("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:me.white},v(1805,"Background color of editor widgets, such as find/replace.")),PD=j("editorWidget.foreground",ri,v(1806,"Foreground color of editor widgets, such as find/replace.")),eJ=j("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Nt,hcLight:Nt},v(1807,"Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));j("editorWidget.resizeBorder",null,v(1808,"Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));j("editorError.background",null,v(1809,"Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const N7=j("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},v(1810,"Foreground color of error squigglies in the editor."));j("editorError.border",{dark:null,light:null,hcDark:me.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},v(1811,"If set, color of double underlines for errors in the editor."));const Fve=j("editorWarning.background",null,v(1812,"Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Ad=j("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},v(1813,"Foreground color of warning squigglies in the editor.")),Dk=j("editorWarning.border",{dark:null,light:null,hcDark:me.fromHex("#FFCC00").transparent(.8),hcLight:me.fromHex("#FFCC00").transparent(.8)},v(1814,"If set, color of double underlines for warnings in the editor."));j("editorInfo.background",null,v(1815,"Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const cm=j("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},v(1816,"Foreground color of info squigglies in the editor.")),Tk=j("editorInfo.border",{dark:null,light:null,hcDark:me.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},v(1817,"If set, color of double underlines for infos in the editor.")),Bve=j("editorHint.foreground",{dark:me.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},v(1818,"Foreground color of hint squigglies in the editor."));j("editorHint.border",{dark:null,light:null,hcDark:me.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},v(1819,"If set, color of double underlines for hints in the editor."));j("editorLink.activeForeground",{dark:"#4E94CE",light:me.blue,hcDark:me.cyan,hcLight:"#292929"},v(1820,"Color of active links."));const n_=j("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},v(1821,"Color of the editor selection.")),Vve=j("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:me.white},v(1822,"Color of the selected text for high contrast.")),tJ=j("editor.inactiveSelectionBackground",{light:pt(n_,.5),dark:pt(n_,.5),hcDark:pt(n_,.7),hcLight:pt(n_,.5)},v(1823,"Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),iJ=j("editor.selectionHighlightBackground",{light:HU(n_,Oa,.3,.6),dark:HU(n_,Oa,.3,.6),hcDark:null,hcLight:null},v(1824,"Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:rn,hcLight:rn},v(1825,"Border color for regions with the same content as the selection."));j("editor.compositionBorder",{light:"#000000",dark:"#ffffff",hcLight:"#000000",hcDark:"#ffffff"},v(1826,"The border color for an IME composition."));j("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},v(1827,"Color of the current search match."));j("editor.findMatchForeground",null,v(1828,"Text color of the current search match."));const sd=j("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},v(1829,"Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.findMatchHighlightForeground",null,v(1830,"Foreground color of the other search matches."),!0);j("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},v(1831,"Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.findMatchBorder",{light:null,dark:null,hcDark:rn,hcLight:rn},v(1832,"Border color of the current search match."));const s_=j("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:rn,hcLight:rn},v(1833,"Border color of the other search matches."));j("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:pt(rn,.4),hcLight:pt(rn,.4)},v(1834,"Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},v(1835,"Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const zU=j("editorHoverWidget.background",Ia,v(1836,"Background color of the editor hover."));j("editorHoverWidget.foreground",PD,v(1837,"Foreground color of the editor hover."));const Hve=j("editorHoverWidget.border",eJ,v(1838,"Border color of the editor hover."));j("editorHoverWidget.statusBarBackground",{dark:ml(zU,.2),light:Nm(zU,.05),hcDark:Ia,hcLight:Ia},v(1839,"Background color of the editor hover status bar."));const nJ=j("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:me.white,hcLight:me.black},v(1840,"Foreground color of inline hints")),sJ=j("editorInlayHint.background",{dark:pt(Qx,.1),light:pt(Qx,.1),hcDark:pt(me.white,.1),hcLight:pt(Qx,.1)},v(1841,"Background color of inline hints"));j("editorInlayHint.typeForeground",nJ,v(1842,"Foreground color of inline hints for types"));j("editorInlayHint.typeBackground",sJ,v(1843,"Background color of inline hints for types"));j("editorInlayHint.parameterForeground",nJ,v(1844,"Foreground color of inline hints for parameters"));j("editorInlayHint.parameterBackground",sJ,v(1845,"Background color of inline hints for parameters"));const Wve=j("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},v(1846,"The color used for the lightbulb actions icon."));j("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},v(1847,"The color used for the lightbulb auto fix actions icon."));j("editorLightBulbAi.foreground",Wve,v(1848,"The color used for the lightbulb AI icon."));j("editor.snippetTabstopHighlightBackground",{dark:new me(new ae(124,124,124,.3)),light:new me(new ae(10,50,100,.2)),hcDark:new me(new ae(124,124,124,.3)),hcLight:new me(new ae(10,50,100,.2))},v(1849,"Highlight background color of a snippet tabstop."));j("editor.snippetTabstopHighlightBorder",null,v(1850,"Highlight border color of a snippet tabstop."));j("editor.snippetFinalTabstopHighlightBackground",null,v(1851,"Highlight background color of the final tabstop of a snippet."));j("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new me(new ae(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},v(1852,"Highlight border color of the final tabstop of a snippet."));const l5=new me(new ae(155,185,85,.2)),c5=new me(new ae(255,0,0,.2)),zve=j("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},v(1853,"Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Uve=j("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},v(1854,"Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);j("diffEditor.insertedLineBackground",{dark:l5,light:l5,hcDark:null,hcLight:null},v(1855,"Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);j("diffEditor.removedLineBackground",{dark:c5,light:c5,hcDark:null,hcLight:null},v(1856,"Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);j("diffEditorGutter.insertedLineBackground",null,v(1857,"Background color for the margin where lines got inserted."));j("diffEditorGutter.removedLineBackground",null,v(1858,"Background color for the margin where lines got removed."));const jve=j("diffEditorOverview.insertedForeground",null,v(1859,"Diff overview ruler foreground for inserted content.")),$ve=j("diffEditorOverview.removedForeground",null,v(1860,"Diff overview ruler foreground for removed content."));j("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},v(1861,"Outline color for the text that got inserted."));j("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},v(1862,"Outline color for text that got removed."));j("diffEditor.border",{dark:null,light:null,hcDark:Nt,hcLight:Nt},v(1863,"Border color between the two text editors."));j("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},v(1864,"Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));j("diffEditor.unchangedRegionBackground","sideBar.background",v(1865,"The background color of unchanged blocks in the diff editor."));j("diffEditor.unchangedRegionForeground","foreground",v(1866,"The foreground color of unchanged blocks in the diff editor."));j("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},v(1867,"The background color of unchanged code in the diff editor."));const QC=j("widget.shadow",{dark:pt(me.black,.36),light:pt(me.black,.16),hcDark:null,hcLight:null},v(1868,"Shadow color of widgets such as find/replace inside the editor.")),rJ=j("widget.border",{dark:null,light:null,hcDark:Nt,hcLight:Nt},v(1869,"Border color of widgets such as find/replace inside the editor.")),UU=j("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},v(1870,"Toolbar background when hovering over actions using the mouse"));j("toolbar.hoverOutline",{dark:null,light:null,hcDark:rn,hcLight:rn},v(1871,"Toolbar outline when hovering over actions using the mouse"));j("toolbar.activeBackground",{dark:ml(UU,.1),light:Nm(UU,.1),hcDark:null,hcLight:null},v(1872,"Toolbar background when holding the mouse over actions"));const qve=j("breadcrumb.foreground",pt(ri,.8),v(1873,"Color of focused breadcrumb items.")),Gve=j("breadcrumb.background",Oa,v(1874,"Background color of breadcrumb items.")),jU=j("breadcrumb.focusForeground",{light:Nm(ri,.2),dark:ml(ri,.1),hcDark:ml(ri,.1),hcLight:ml(ri,.1)},v(1875,"Color of focused breadcrumb items.")),Kve=j("breadcrumb.activeSelectionForeground",{light:Nm(ri,.2),dark:ml(ri,.1),hcDark:ml(ri,.1),hcLight:ml(ri,.1)},v(1876,"Color of selected breadcrumb items."));j("breadcrumbPicker.background",Ia,v(1877,"Background color of breadcrumb item picker."));const oJ=.5,$U=me.fromHex("#40C8AE").transparent(oJ),qU=me.fromHex("#40A6FF").transparent(oJ),GU=me.fromHex("#606060").transparent(.4),I7=.4,D1=1,u5=j("merge.currentHeaderBackground",{dark:$U,light:$U,hcDark:null,hcLight:null},v(1878,"Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);j("merge.currentContentBackground",pt(u5,I7),v(1879,"Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const h5=j("merge.incomingHeaderBackground",{dark:qU,light:qU,hcDark:null,hcLight:null},v(1880,"Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);j("merge.incomingContentBackground",pt(h5,I7),v(1881,"Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const d5=j("merge.commonHeaderBackground",{dark:GU,light:GU,hcDark:null,hcLight:null},v(1882,"Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);j("merge.commonContentBackground",pt(d5,I7),v(1883,"Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const T1=j("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},v(1884,"Border color on headers and the splitter in inline merge-conflicts."));j("editorOverviewRuler.currentContentForeground",{dark:pt(u5,D1),light:pt(u5,D1),hcDark:T1,hcLight:T1},v(1885,"Current overview ruler foreground for inline merge-conflicts."));j("editorOverviewRuler.incomingContentForeground",{dark:pt(h5,D1),light:pt(h5,D1),hcDark:T1,hcLight:T1},v(1886,"Incoming overview ruler foreground for inline merge-conflicts."));j("editorOverviewRuler.commonContentForeground",{dark:pt(d5,D1),light:pt(d5,D1),hcDark:T1,hcLight:T1},v(1887,"Common ancestor overview ruler foreground for inline merge-conflicts."));j("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},v(1888,"Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0);j("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",v(1889,"Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const Yve=j("problemsErrorIcon.foreground",N7,v(1890,"The color used for the problems error icon.")),Qve=j("problemsWarningIcon.foreground",Ad,v(1891,"The color used for the problems warning icon.")),Xve=j("problemsInfoIcon.foreground",cm,v(1892,"The color used for the problems info icon.")),Zve=j("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},v(1983,"Minimap marker color for find matches."),!0);j("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},v(1984,"Minimap marker color for repeating editor selections."),!0);const KU=j("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},v(1985,"Minimap marker color for the editor selection."),!0),Jve=j("minimap.infoHighlight",{dark:cm,light:cm,hcDark:Tk,hcLight:Tk},v(1986,"Minimap marker color for infos.")),eCe=j("minimap.warningHighlight",{dark:Ad,light:Ad,hcDark:Dk,hcLight:Dk},v(1987,"Minimap marker color for warnings.")),tCe=j("minimap.errorHighlight",{dark:new me(new ae(255,18,18,.7)),light:new me(new ae(255,18,18,.7)),hcDark:new me(new ae(255,50,50,1)),hcLight:"#B5200D"},v(1988,"Minimap marker color for errors.")),iCe=j("minimap.background",null,v(1989,"Minimap background color.")),nCe=j("minimap.foregroundOpacity",me.fromHex("#000f"),v(1990,'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));j("minimapSlider.background",pt(XZ,.5),v(1991,"Minimap slider background color."));j("minimapSlider.hoverBackground",pt(ZZ,.5),v(1992,"Minimap slider background color when hovering."));j("minimapSlider.activeBackground",pt(JZ,.5),v(1993,"Minimap slider background color when clicked on."));j("charts.foreground",ri,v(1790,"The foreground color used in charts."));j("charts.lines",pt(ri,.5),v(1791,"The color used for horizontal lines in charts."));j("charts.red",N7,v(1792,"The red color used in chart visualizations."));j("charts.blue",cm,v(1793,"The blue color used in chart visualizations."));j("charts.yellow",Ad,v(1794,"The yellow color used in chart visualizations."));j("charts.orange",Zve,v(1795,"The orange color used in chart visualizations."));j("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},v(1796,"The green color used in chart visualizations."));j("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},v(1797,"The purple color used in chart visualizations."));const sCe=j("input.background",{dark:"#3C3C3C",light:me.white,hcDark:me.black,hcLight:me.white},v(1893,"Input box background.")),rCe=j("input.foreground",ri,v(1894,"Input box foreground.")),oCe=j("input.border",{dark:null,light:null,hcDark:Nt,hcLight:Nt},v(1895,"Input box border.")),aJ=j("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Nt,hcLight:Nt},v(1896,"Border color of activated options in input fields.")),aCe=j("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},v(1897,"Background color of activated options in input fields.")),lJ=j("inputOption.activeBackground",{dark:pt(bc,.4),light:pt(bc,.2),hcDark:me.transparent,hcLight:me.transparent},v(1898,"Background hover color of options in input fields.")),cJ=j("inputOption.activeForeground",{dark:me.white,light:me.black,hcDark:ri,hcLight:ri},v(1899,"Foreground color of activated options in input fields."));j("input.placeholderForeground",{light:pt(ri,.5),dark:pt(ri,.5),hcDark:pt(ri,.7),hcLight:pt(ri,.7)},v(1900,"Input box foreground color for placeholder text."));const lCe=j("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:me.black,hcLight:me.white},v(1901,"Input validation background color for information severity.")),cCe=j("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:ri},v(1902,"Input validation foreground color for information severity.")),uCe=j("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Nt,hcLight:Nt},v(1903,"Input validation border color for information severity.")),hCe=j("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:me.black,hcLight:me.white},v(1904,"Input validation background color for warning severity.")),dCe=j("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:ri},v(1905,"Input validation foreground color for warning severity.")),fCe=j("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Nt,hcLight:Nt},v(1906,"Input validation border color for warning severity.")),gCe=j("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:me.black,hcLight:me.white},v(1907,"Input validation background color for error severity.")),mCe=j("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:ri},v(1908,"Input validation foreground color for error severity.")),pCe=j("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Nt,hcLight:Nt},v(1909,"Input validation border color for error severity.")),FD=j("dropdown.background",{dark:"#3C3C3C",light:me.white,hcDark:me.black,hcLight:me.white},v(1910,"Dropdown background.")),_Ce=j("dropdown.listBackground",{dark:null,light:null,hcDark:me.black,hcLight:me.white},v(1911,"Dropdown list background.")),R7=j("dropdown.foreground",{dark:"#F0F0F0",light:ri,hcDark:me.white,hcLight:ri},v(1912,"Dropdown foreground.")),A7=j("dropdown.border",{dark:FD,light:"#CECECE",hcDark:Nt,hcLight:Nt},v(1913,"Dropdown border.")),uJ=j("button.foreground",me.white,v(1914,"Button foreground color.")),bCe=j("button.separator",pt(uJ,.4),v(1915,"Button separator color.")),N0=j("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:me.black,hcLight:"#0F4A85"},v(1916,"Button background color.")),wCe=j("button.hoverBackground",{dark:ml(N0,.2),light:Nm(N0,.2),hcDark:N0,hcLight:N0},v(1917,"Button background color when hovering.")),vCe=j("button.border",Nt,v(1918,"Button border color.")),CCe=j("button.secondaryForeground",{dark:me.white,light:me.white,hcDark:me.white,hcLight:ri},v(1919,"Secondary button foreground color.")),f5=j("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:me.white},v(1920,"Secondary button background color.")),yCe=j("button.secondaryHoverBackground",{dark:ml(f5,.2),light:Nm(f5,.2),hcDark:null,hcLight:null},v(1921,"Secondary button background color when hovering.")),I0=j("radio.activeForeground",cJ,v(1922,"Foreground color of active radio option.")),SCe=j("radio.activeBackground",lJ,v(1923,"Background color of active radio option.")),xCe=j("radio.activeBorder",aJ,v(1924,"Border color of the active radio option.")),LCe=j("radio.inactiveForeground",null,v(1925,"Foreground color of inactive radio option.")),kCe=j("radio.inactiveBackground",null,v(1926,"Background color of inactive radio option.")),ECe=j("radio.inactiveBorder",{light:pt(I0,.2),dark:pt(I0,.2),hcDark:pt(I0,.4),hcLight:pt(I0,.2)},v(1927,"Border color of the inactive radio option.")),DCe=j("radio.inactiveHoverBackground",aCe,v(1928,"Background color of inactive active radio option when hovering.")),M7=j("checkbox.background",FD,v(1929,"Background color of checkbox widget."));j("checkbox.selectBackground",Ia,v(1930,"Background color of checkbox widget when the element it's in is selected."));const O7=j("checkbox.foreground",R7,v(1931,"Foreground color of checkbox widget.")),TCe=j("checkbox.border",A7,v(1932,"Border color of checkbox widget."));j("checkbox.selectBorder",a5,v(1933,"Border color of checkbox widget when the element it's in is selected."));const NCe=j("checkbox.disabled.background",{op:7,color:M7,with:O7,ratio:.33},v(1934,"Background of a disabled checkbox.")),ICe=j("checkbox.disabled.foreground",{op:7,color:O7,with:M7,ratio:.33},v(1935,"Foreground of a disabled checkbox.")),RCe=j("keybindingLabel.background",{dark:new me(new ae(128,128,128,.17)),light:new me(new ae(221,221,221,.4)),hcDark:me.transparent,hcLight:me.transparent},v(1936,"Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),ACe=j("keybindingLabel.foreground",{dark:me.fromHex("#CCCCCC"),light:me.fromHex("#555555"),hcDark:me.white,hcLight:ri},v(1937,"Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),MCe=j("keybindingLabel.border",{dark:new me(new ae(51,51,51,.6)),light:new me(new ae(204,204,204,.4)),hcDark:new me(new ae(111,195,223)),hcLight:Nt},v(1938,"Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),OCe=j("keybindingLabel.bottomBorder",{dark:new me(new ae(68,68,68,.6)),light:new me(new ae(187,187,187,.4)),hcDark:new me(new ae(111,195,223)),hcLight:ri},v(1939,"Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),PCe=j("list.focusBackground",null,v(1940,"List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),FCe=j("list.focusForeground",null,v(1941,"List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),BCe=j("list.focusOutline",{dark:bc,light:bc,hcDark:rn,hcLight:rn},v(1942,"List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),VCe=j("list.focusAndSelectionOutline",null,v(1943,"List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),um=j("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:me.fromHex("#0F4A85").transparent(.1)},v(1944,"List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Wv=j("list.activeSelectionForeground",{dark:me.white,light:me.white,hcDark:null,hcLight:null},v(1945,"List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),hJ=j("list.activeSelectionIconForeground",null,v(1946,"List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),HCe=j("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:me.fromHex("#0F4A85").transparent(.1)},v(1947,"List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),WCe=j("list.inactiveSelectionForeground",null,v(1948,"List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),zCe=j("list.inactiveSelectionIconForeground",null,v(1949,"List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),UCe=j("list.inactiveFocusBackground",null,v(1950,"List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),jCe=j("list.inactiveFocusOutline",null,v(1951,"List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),dJ=j("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:me.white.transparent(.1),hcLight:me.fromHex("#0F4A85").transparent(.1)},v(1952,"List/Tree background when hovering over items using the mouse.")),fJ=j("list.hoverForeground",null,v(1953,"List/Tree foreground when hovering over items using the mouse.")),$Ce=j("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},v(1954,"List/Tree drag and drop background when moving items over other items when using the mouse.")),qCe=j("list.dropBetweenBackground",{dark:a5,light:a5,hcDark:null,hcLight:null},v(1955,"List/Tree drag and drop border color when moving items between items when using the mouse.")),ZS=j("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:bc,hcLight:bc},v(1956,"List/Tree foreground color of the match highlights when searching inside the list/tree."));j("list.focusHighlightForeground",{dark:ZS,light:Ave(um,ZS,"#BBE7FF"),hcDark:ZS,hcLight:ZS},v(1957,"List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));j("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},v(1958,"List/Tree foreground color for invalid items, for example an unresolved root in explorer."));j("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},v(1959,"Foreground color of list items containing errors."));j("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},v(1960,"Foreground color of list items containing warnings."));const GCe=j("listFilterWidget.background",{light:Nm(Ia,0),dark:ml(Ia,0),hcDark:Ia,hcLight:Ia},v(1961,"Background color of the type filter widget in lists and trees.")),KCe=j("listFilterWidget.outline",{dark:me.transparent,light:me.transparent,hcDark:"#f38518",hcLight:"#007ACC"},v(1962,"Outline color of the type filter widget in lists and trees.")),YCe=j("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Nt,hcLight:Nt},v(1963,"Outline color of the type filter widget in lists and trees, when there are no matches.")),QCe=j("listFilterWidget.shadow",QC,v(1964,"Shadow color of the type filter widget in lists and trees."));j("list.filterMatchBackground",{dark:sd,light:sd,hcDark:null,hcLight:null},v(1965,"Background color of the filtered match."));j("list.filterMatchBorder",{dark:s_,light:s_,hcDark:Nt,hcLight:rn},v(1966,"Border color of the filtered match."));j("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},v(1967,"List/Tree foreground color for items that are deemphasized."));const gJ=j("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},v(1968,"Tree stroke color for the indentation guides.")),XCe=j("tree.inactiveIndentGuidesStroke",pt(gJ,.4),v(1969,"Tree stroke color for the indentation guides that are not active.")),ZCe=j("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},v(1970,"Table border color between columns.")),JCe=j("tree.tableOddRowsBackground",{dark:pt(ri,.04),light:pt(ri,.04),hcDark:null,hcLight:null},v(1971,"Background color for odd table rows."));j("editorActionList.background",Ia,v(1972,"Action List background color."));j("editorActionList.foreground",PD,v(1973,"Action List foreground color."));j("editorActionList.focusForeground",Wv,v(1974,"Action List foreground color for the focused item."));j("editorActionList.focusBackground",um,v(1975,"Action List background color for the focused item."));const eye=j("menu.border",{dark:null,light:null,hcDark:Nt,hcLight:Nt},v(1976,"Border color of menus.")),tye=j("menu.foreground",R7,v(1977,"Foreground color of menu items.")),iye=j("menu.background",FD,v(1978,"Background color of menu items.")),nye=j("menu.selectionForeground",Wv,v(1979,"Foreground color of the selected menu item in menus.")),sye=j("menu.selectionBackground",um,v(1980,"Background color of the selected menu item in menus.")),rye=j("menu.selectionBorder",{dark:null,light:null,hcDark:rn,hcLight:rn},v(1981,"Border color of the selected menu item in menus.")),oye=j("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Nt,hcLight:Nt},v(1982,"Color of a separator menu item in menus.")),xR=j("quickInput.background",Ia,v(2010,"Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),aye=j("quickInput.foreground",PD,v(2011,"Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),lye=j("quickInputTitle.background",{dark:new me(new ae(255,255,255,.105)),light:new me(new ae(0,0,0,.06)),hcDark:"#000000",hcLight:me.white},v(2012,"Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),mJ=j("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:me.white,hcLight:"#0F4A85"},v(2013,"Quick picker color for grouping labels.")),cye=j("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:me.white,hcLight:"#0F4A85"},v(2014,"Quick picker color for grouping borders.")),YU=j("quickInput.list.focusBackground",null,"",void 0,v(2015,"Please use quickInputList.focusBackground instead")),g5=j("quickInputList.focusForeground",Wv,v(2016,"Quick picker foreground color for the focused item.")),pJ=j("quickInputList.focusIconForeground",hJ,v(2017,"Quick picker icon foreground color for the focused item.")),m5=j("quickInputList.focusBackground",{dark:VU(YU,um),light:VU(YU,um),hcDark:null,hcLight:null},v(2018,"Quick picker background color for the focused item."));j("search.resultsInfoForeground",{light:ri,dark:pt(ri,.65),hcDark:ri,hcLight:ri},v(2019,"Color of the text in the search viewlet's completion message."));j("searchEditor.findMatchBackground",{light:pt(sd,.66),dark:pt(sd,.66),hcDark:sd,hcLight:sd},v(2020,"Color of the Search Editor query matches."));j("searchEditor.findMatchBorder",{light:pt(s_,.66),dark:pt(s_,.66),hcDark:s_,hcLight:s_},v(2021,"Border color of the Search Editor query matches."));class XC{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(e){return new _J(this.x-e.scrollX,this.y-e.scrollY)}}class _J{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(e){return new XC(this.clientX+e.scrollX,this.clientY+e.scrollY)}}class uye{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class hye{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function BD(s){const e=ta(s);return new uye(e.left,e.top,e.width,e.height)}function VD(s,e,t){const i=e.width/s.offsetWidth,n=e.height/s.offsetHeight,r=(t.x-e.x)/i,o=(t.y-e.y)/n;return new hye(r,o)}class Md extends So{constructor(e,t,i){super(Ue(i),e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new XC(this.posx,this.posy),this.editorPos=BD(i),this.relativePos=VD(i,this.editorPos,this.pos)}}class dye{constructor(e){this._editorViewDomNode=e}_create(e){return new Md(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return ie(e,Le.CONTEXT_MENU,i=>{t(this._create(i))})}onMouseUp(e,t){return ie(e,Le.MOUSE_UP,i=>{t(this._create(i))})}onMouseDown(e,t){return ie(e,Le.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return ie(e,Le.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return ie(e,Le.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return ie(e,Le.MOUSE_MOVE,i=>t(this._create(i)))}}class fye{constructor(e){this._editorViewDomNode=e}_create(e){return new Md(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return ie(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return ie(e,Le.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return ie(e,Le.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return ie(e,"pointermove",i=>t(this._create(i)))}}class gye extends le{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new MD),this._keydownListener=null}startMonitoring(e,t,i,n,r){this._keydownListener=bs(e.ownerDocument,"keydown",o=>{o.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,o.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,o=>{n(new Md(o,!0,this._editorViewDomNode))},o=>{this._keydownListener.dispose(),r(o)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class Im extends le{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const r=e[i];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}}class br extends Im{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class wl{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=i[n-o-1];return r}}class mye{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getLineHeightForLineNumber(e){return this._viewLayout.getLineHeightForLineNumber(e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class pye extends mye{constructor(e,t,i,n){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i,this._viewLinesGpu=n}linesVisibleRangesForRange(e,t){const i=this._viewLines.linesVisibleRangesForRange(e,t);if(!this._viewLinesGpu)return i??null;const n=this._viewLinesGpu.linesVisibleRangesForRange(e,t);return i?n?i.concat(n).sort((r,o)=>r.lineNumber-o.lineNumber):i:n}visibleRangeForPosition(e){var t;return this._viewLines.visibleRangeForPosition(e)??((t=this._viewLinesGpu)==null?void 0:t.visibleRangeForPosition(e))??null}}class bJ{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class ZC{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const r=e[i];t[i]=new ZC(r.left,r.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class Cd{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class wJ{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class p5{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class Xx{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,r){const o=this._createRange();try{return o.setStart(e,t),o.setEnd(i,n),o.getClientRects()}catch{return null}finally{this._detachRange(o,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Cd.compare);const t=[];let i=0,n=e[0];for(let r=1,o=e.length;r<o;r++){const a=e[r];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const n=[];for(let r=0,o=e.length;r<o;r++){const a=e[r];n[r]=new Cd(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,r,o){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===r&&i===0&&!e.children[t].firstChild){const g=e.children[t].getClientRects();return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(g,o.clientRectDeltaLeft,o.clientRectScale)}t!==n&&n>0&&r===0&&(n--,r=1073741824);let c=e.children[t].firstChild,h=e.children[n].firstChild;if((!c||!h)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!h&&r===0&&n>0&&(h=e.children[n-1].firstChild,r=1073741824)),!c||!h)return null;i=Math.min(c.textContent.length,Math.max(0,i)),r=Math.min(h.textContent.length,Math.max(0,r));const d=this._readClientRects(c,i,h,r,o.endNode);return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(d,o.clientRectDeltaLeft,o.clientRectScale)}}var na;(function(s){s.DARK="dark",s.LIGHT="light",s.HIGH_CONTRAST_DARK="hcDark",s.HIGH_CONTRAST_LIGHT="hcLight"})(na||(na={}));var r_;(function(s){s.VS="vs",s.VS_DARK="vs-dark",s.HC_BLACK="hc-black",s.HC_LIGHT="hc-light"})(r_||(r_={}));function W_(s){return s===na.HIGH_CONTRAST_DARK||s===na.HIGH_CONTRAST_LIGHT}function Rm(s){return s===na.DARK||s===na.HIGH_CONTRAST_DARK}const _ye=(function(){return bv?!0:!(Gr||Kr||nm)})();let z_=!0;const iE=class iE{constructor(e,t){this._viewGpuContext=e,this._options=t,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Tt(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){var e;return W_(this._options.themeType)||((e=this._renderedViewLine)==null?void 0:e.input.renderWhitespace)===2?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,r){var b,C,x;if(this._options.useGpu&&((b=this._viewGpuContext)!=null&&b.canRender(this._options,n,e)))return(x=(C=this._renderedViewLine)==null?void 0:C.domNode)==null||x.domNode.remove(),this._renderedViewLine=null,!1;if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const o=n.getViewLineRenderingData(e),a=this._options,l=ia.filter(o.inlineDecorations,e,o.minColumn,o.maxColumn),c=o.hasVariableFonts||a.experimentalWhitespaceRendering==="off"?a.renderWhitespace:"none",h=!o.hasVariableFonts;let d=null;if(W_(a.themeType)||c==="selection"){const S=n.selections;for(const y of S){if(y.endLineNumber<e||y.startLineNumber>e)continue;const k=y.startLineNumber===e?y.startColumn:o.minColumn,D=y.endLineNumber===e?y.endColumn:o.maxColumn;k<D&&(W_(a.themeType)&&l.push(new ia(k,D,"inline-selected-text",0)),c==="selection"&&(d||(d=[]),d.push(new ze(k-1,D-1))))}}const g=new Tm(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,o.content,o.continuesWithWrappedLine,o.isBasicASCII,o.containsRTL,o.minColumn-1,o.tokens,l,o.tabSize,o.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,c,a.renderControlCharacters,a.fontLigatures!==Nd.OFF,d,o.textDirection,a.verticalScrollbarSize);if(this._renderedViewLine&&this._renderedViewLine.input.equals(g))return!1;r.appendString("<div "),o.textDirection===xo.RTL?r.appendString('dir="rtl" '):o.containsRTL&&r.appendString('dir="ltr" '),r.appendString('style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(i)),r.appendString("px;line-height:"),r.appendString(String(i)),o.textDirection===xo.RTL&&(r.appendString("px;padding-right:"),r.appendString(String(a.verticalScrollbarSize))),r.appendString('px;" class="'),r.appendString(iE.CLASS_NAME),r.appendString('">');const p=RD(g,r);r.appendString("</div>");let _=null;return h&&z_&&_ye&&o.isBasicASCII&&g.isLTR&&a.useMonospaceOptimizations&&p.containsForeignElements===0&&(_=new JS(this._renderedViewLine?this._renderedViewLine.domNode:null,g,p.characterMapping)),_||(_=CJ(this._renderedViewLine?this._renderedViewLine.domNode:null,g,p.characterMapping,p.containsForeignElements)),this._renderedViewLine=_,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i),this._renderedViewLine.domNode.setLineHeight(i))}isRenderedRTL(){return this._renderedViewLine?this._renderedViewLine.input.textDirection===xo.RTL:!1}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof JS:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof JS?this._renderedViewLine.monospaceAssumptionsAreValid():z_}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof JS&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&i>r+1)return new p5(!0,[new Cd(this.getWidth(n),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&i>r+1&&(i=r+1);const o=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return o&&o.length>0?new p5(!1,o):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};iE.CLASS_NAME="view-line";let Nu=iE;class JS{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let r=0;r<n;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return z_;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),z_=!1)}return z_}toSlowRenderedLine(){return CJ(this.domNode,this.input,this._characterMapping,0)}getVisibleRangesForRange(e,t,i,n){const r=this._getColumnPixelOffset(e,t,n),o=this._getColumnPixelOffset(e,i,n);return[new Cd(r,o-r)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const n=Math.floor((t-1)/300)-1,r=(n+1)*300+1;let o=-1;if(this._keyColumnPixelOffsetCache&&(o=this._keyColumnPixelOffsetCache[n],o===-1&&(o=this._actualReadPixelOffset(e,r,i),this._keyColumnPixelOffsetCache[n]=o)),o===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return o+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const n=this._characterMapping.getDomPosition(t),r=Xx.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return zv(this._characterMapping,e,t)}}class vJ{constructor(e,t,i,n){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=n,this._cachedWidth=-1,this._pixelOffsetCache=null,t.isLTR){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let r=0,o=this._characterMapping.length;r<=o;r++)this._pixelOffsetCache[r]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const r=this._readPixelOffset(this.domNode,e,t,n);if(r===-1)return null;const o=this._readPixelOffset(this.domNode,e,i,n);return o===-1?null:[new Cd(r,o-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,r){if(i===n){const o=this._readPixelOffset(e,t,i,r);return o===-1?null:[new Cd(o,0)]}else return this._readRawVisibleRangesForRange(e,i,n,r)}_readPixelOffset(e,t,i,n){if(this.input.isLTR&&this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);const r=this._getReadingTarget(e);return r.firstChild?(n.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const r=this._pixelOffsetCache[i];if(r!==-1)return r;const o=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=o,o}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){const l=Xx.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(this.input.isLTR&&i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);const r=this._characterMapping.getDomPosition(i),o=Xx.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,n);if(!o||o.length===0)return-1;const a=o[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,n){if(this.input.isLTR&&t===1&&i===this._characterMapping.length)return[new Cd(0,this.getWidth(n))];const r=this._characterMapping.getDomPosition(t),o=this._characterMapping.getDomPosition(i);return Xx.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,o.partIndex,o.charIndex,n)}getColumnOfNodeOffset(e,t){return zv(this._characterMapping,e,t)}}class bye extends vJ{_readVisibleRangesForRange(e,t,i,n,r){const o=super._readVisibleRangesForRange(e,t,i,n,r);if(!o||o.length===0||i===n||i===1&&n===this._characterMapping.length)return o;if(this.input.isLTR){const a=this._readPixelOffset(e,t,n,r);if(a!==-1){const l=o[o.length-1];l.left<a&&(l.width=a-l.left)}}return o}}const CJ=(function(){return cD?wye:vye})();function wye(s,e,t,i){return new bye(s,e,t,i)}function vye(s,e,t,i){return new vJ(s,e,t,i)}function zv(s,e,t){const i=e.textContent.length;let n=-1;for(;e;)e=e.previousSibling,n++;return s.getColumn(new WZ(n,t),i)}class Ai{static _nextVisibleColumn(e,t,i){return e===9?Ai.nextRenderTabStop(t,i):ih(e)||q6(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),r=e.substring(0,n),o=new ok(r);let a=0;for(;!o.eol();){const l=rk(r,n,o.offset);o.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,r=new ok(e);let o=0,a=1;for(;!r.eol();){const l=rk(e,n,r.offset);r.nextGraphemeLength();const c=this._nextVisibleColumn(l,o,i),h=r.offset+1;if(c>=t){const d=t-o;return c-t<d?h:a}o=c,a=h}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return Ai.nextRenderTabStop(e,t)}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Ai.prevRenderTabStop(e,t)}}class Uv{static whitespaceVisibleColumn(e,t,i){const n=e.length;let r=0,o=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[o,a,r];switch(r%i===0&&(o=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=Ai.nextRenderTabStop(r,i);break;default:return[-1,-1,-1]}}return t===n?[o,a,r]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const r=e.length,[o,a,l]=Uv.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(n){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(o===-1)return-1;let g=a;for(let p=o;p<r;++p){if(g===a+i)return o;switch(e.charCodeAt(p)){case 32:g+=1;break;case 9:g=Ai.nextRenderTabStop(g,i);break;default:return-1}}return g===a+i?o:-1}const h=Ai.nextRenderTabStop(l,i);let d=l;for(let g=t;g<r;g++){if(d===h)return g;switch(e.charCodeAt(g)){case 32:d+=1;break;case 9:d=Ai.nextRenderTabStop(d,i);break;default:return-1}}return d===h?r:-1}}class Wh{constructor(e=null){this.hitTarget=e,this.type=0}}class yJ{get hitTarget(){return this.spanNode}constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var Vf;(function(s){function e(t,i,n){const r=t.getPositionFromDOMInfo(i,n);return r?new yJ(r,i,null):new Wh(i)}s.createFromDOMInfo=e})(Vf||(Vf={}));class Cye{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class ms{static _deduceRage(e,t=null){return!t&&e?new G(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,r,o){return{type:e,element:t,mouseColumn:i,position:n,range:r,detail:o}}static createViewZone(e,t,i,n,r){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:r}}static createContentText(e,t,i,n,r){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:r}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class er{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}}class N1{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(165),this.viewDomNode=t.viewDomNode,this.viewLinesGpu=t.viewLinesGpu,this.lineHeight=n.get(75),this.stickyTabStops=n.get(132),this.typicalHalfwidthCharacterWidth=n.get(59).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return N1.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,r=e.viewModel.getLineCount();let o=null,a,l=null;return i.afterLineNumber!==r&&(l=new J(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(o=new J(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=o:o===null?a=l:t<n?a=o:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:o,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const n=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(n);return{range:new G(n,r,n,r),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new G(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return N1._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}isRtl(e){return this.viewModel.getTextDirection(e)===xo.RTL}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class yye{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Fs._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class Sye extends yye{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=wl.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,r){super(e,t,i,n),this.hitTestResult=new lr(()=>Fs.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=e,this._eventTarget=r;const o=!!this._eventTarget;this._useHitTestTarget=!o}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Ai.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return ms.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return ms.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return ms.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return ms.createViewZone(e,this.target,this._getMouseColumn(),t,i)}fulfillContentText(e,t,i){return ms.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return ms.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return ms.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return ms.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return ms.createOverlayWidget(this.target,this._getMouseColumn(),e)}}const QU={isAfterLines:!0};function ff(s){return{isAfterLines:!1,horizontalDistanceToText:s}}class Fs{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=wl.collect(t,this._viewHelper.viewDomNode);return!!(er.isChildOfContentWidgets(i)||er.isChildOfOverflowingContentWidgets(i)||er.isChildOfOverlayWidgets(i)||er.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,r){const o=new N1(this._context,this._viewHelper,e),a=new Sye(o,t,i,n,r);try{const l=Fs._createMouseTarget(o,a);if(l.type===6&&o.stickyTabStops&&l.position!==null){const c=Fs._snapToSoftTabBoundary(l.position,o.viewModel),h=G.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,h,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();const i=t;let n=null;return!er.isChildOfOverflowGuard(t.targetPath)&&!er.isChildOfOverflowingContentWidgets(t.targetPath)&&!er.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||Fs._hitTestContentWidget(e,i),n=n||Fs._hitTestOverlayWidget(e,i),n=n||Fs._hitTestMinimap(e,i),n=n||Fs._hitTestScrollbarSlider(e,i),n=n||Fs._hitTestViewZone(e,i),n=n||Fs._hitTestMargin(e,i),n=n||Fs._hitTestViewCursor(e,i),n=n||Fs._hitTestTextArea(e,i),n=n||Fs._hitTestViewLines(e,i),n=n||Fs._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(er.isChildOfContentWidgets(t.targetPath)||er.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(er.isChildOfOverlayWidgets(t.targetPath)||er.isChildOfOverflowingOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(const o of i){if(n<o.contentLeft||n>o.contentLeft+o.width)continue;const a=e.getVerticalOffsetForLineNumber(o.position.lineNumber);if(a<=r&&r<=a+o.height)return t.fulfillContentText(o.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return er.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let r=Math.abs(t.relativePos.x);const o={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){const a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return o.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,n,i.range,o)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,o):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,o))}return null}static _hitTestViewLines(e,t){if(!er.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new J(1,1),QU);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new J(n,r),QU)}if(er.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineLength(n),o=e.getLineWidth(n);if(r===0){const l=ff(t.mouseContentHorizontalOffset-o);return t.fulfillContentEmpty(new J(n,1),l)}if(e.isRtl(n)){if(t.mouseContentHorizontalOffset+o<=e.layoutInfo.contentWidth-e.layoutInfo.verticalScrollbarWidth){const l=ff(t.mouseContentHorizontalOffset-o),c=new J(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(t.mouseContentHorizontalOffset>=o){const l=ff(t.mouseContentHorizontalOffset-o),c=new J(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(e.viewLinesGpu){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){const l=e.getLineWidth(n),c=ff(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(new J(n,1),c)}const r=e.getLineWidth(n);if(e.isRtl(n)){if(t.mouseContentHorizontalOffset+r<=e.layoutInfo.contentWidth-e.layoutInfo.verticalScrollbarWidth){const l=ff(t.mouseContentHorizontalOffset-r),c=new J(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(t.mouseContentHorizontalOffset>=r){const l=ff(t.mouseContentHorizontalOffset-r),c=new J(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}const a=e.viewLinesGpu.getPositionAtCoordinate(n,t.mouseContentHorizontalOffset);if(a){const l={injectedText:null,mightBeForeignElement:!1};return t.fulfillContentText(a,G.fromPositions(a,a),l)}}const i=t.hitTestResult.value;return i.type===1?Fs.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(er.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new J(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(er.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new J(n,r))}}return null}static _hitTestScrollbar(e,t){if(er.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new J(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(165),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return Fs._getMouseColumn(n,t.get(59).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,r){const o=n.lineNumber,a=n.column,l=e.getLineWidth(o);if(t.mouseContentHorizontalOffset>l){const x=ff(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,x)}const c=e.visibleRangeForPosition(o,a);if(!c)return t.fulfillUnknown(n);const h=c.left;if(Math.abs(t.mouseContentHorizontalOffset-h)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!r,injectedText:r});const d=[];if(d.push({offset:c.left,column:a}),a>1){const x=e.visibleRangeForPosition(o,a-1);x&&d.push({offset:x.left,column:a-1})}const g=e.viewModel.getLineMaxColumn(o);if(a<g){const x=e.visibleRangeForPosition(o,a+1);x&&d.push({offset:x.left,column:a+1})}d.sort((x,S)=>x.offset-S.offset);const p=t.pos.toClientCoordinates(Ue(e.viewDomNode)),_=i.getBoundingClientRect(),b=_.left<=p.clientX&&p.clientX<=_.right;let C=null;for(let x=1;x<d.length;x++){const S=d[x-1],y=d[x];if(S.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=y.offset){C=new G(o,S.column,o,y.column);const k=Math.abs(S.offset-t.mouseContentHorizontalOffset),D=Math.abs(y.offset-t.mouseContentHorizontalOffset);n=k<D?new J(o,S.column):new J(o,y.column);break}}return t.fulfillContentText(n,C,{mightBeForeignElement:!b||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),r=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){const a=Math.floor((n+r)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new XC(t.pos.x,l),h=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates(Ue(e.viewDomNode)));if(h.type===1)return h}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(Ue(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=om(e.viewDomNode);let n;if(i?typeof i.caretRangeFromPoint>"u"?n=xye(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new Wh;const r=n.startContainer;if(r.nodeType===r.TEXT_NODE){const o=r.parentNode,a=o?o.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Nu.CLASS_NAME?Vf.createFromDOMInfo(e,o,n.startOffset):new Wh(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){const o=r.parentNode,a=o?o.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Nu.CLASS_NAME?Vf.createFromDOMInfo(e,r,r.textContent.length):new Wh(r)}return new Wh}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const n=i.offsetNode.parentNode,r=n?n.parentNode:null,o=r?r.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===Nu.CLASS_NAME?Vf.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new Wh(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const n=i.offsetNode.parentNode,r=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,o=n?n.parentNode:null,a=o&&o.nodeType===o.ELEMENT_NODE?o.className:null;if(r===Nu.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return Vf.createFromDOMInfo(e,l,0)}else if(a===Nu.CLASS_NAME)return Vf.createFromDOMInfo(e,i.offsetNode,0)}return new Wh(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),r=Uv.atomicPosition(i,e.column-1,n,2);return r!==-1?new J(e.lineNumber,r+1):e}static doHitTest(e,t){let i=new Wh;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(Ue(e.viewDomNode)))),i.type===1){const n=e.viewModel.getInjectedTextAt(i.position),r=e.viewModel.normalizePosition(i.position,2);(n||!r.equals(i.position))&&(i=new yJ(r,i.spanNode,n))}return i}}function xye(s,e,t){const i=document.createRange();let n=s.elementFromPoint(e,t);if(n!=null&&n.hasChildNodes()){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const r=n.getBoundingClientRect(),o=Ue(n),a=o.getComputedStyle(n,null).getPropertyValue("font-style"),l=o.getComputedStyle(n,null).getPropertyValue("font-variant"),c=o.getComputedStyle(n,null).getPropertyValue("font-weight"),h=o.getComputedStyle(n,null).getPropertyValue("font-size"),d=o.getComputedStyle(n,null).getPropertyValue("line-height"),g=o.getComputedStyle(n,null).getPropertyValue("font-family"),p=`${a} ${l} ${c} ${h}/${d} ${g}`,_=n.innerText;let b=r.left,C=0,x;if(e>r.left+r.width)C=_.length;else{const S=_5.getInstance();for(let y=0;y<_.length+1;y++){if(x=S.getCharWidth(_.charAt(y),p)/2,b+=x,e<b){C=y;break}b+=x}}i.setStart(n.firstChild,C),i.setEnd(n.firstChild,C)}return i}const tg=class tg{static getInstance(){return tg._INSTANCE||(tg._INSTANCE=new tg),tg._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const o=n.measureText(e).width;return this._cache[i]=o,o}};tg._INSTANCE=null;let _5=tg;function Vi(s,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");const r=`$memoize$${e}`;t[i]=function(...o){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,o)}),this[r]}}var Lye=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},hi;(function(s){s.Tap="-monaco-gesturetap",s.Change="-monaco-gesturechange",s.Start="-monaco-gesturestart",s.End="-monaco-gesturesend",s.Contextmenu="-monaco-gesturecontextmenu"})(hi||(hi={}));const fs=class fs extends le{constructor(){super(),this.dispatched=!1,this.targets=new Dr,this.ignoreTargets=new Dr,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Se.runAndSubscribe(zC,({window:e,disposables:t})=>{t.add(ie(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(ie(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(ie(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:ni,disposables:this._store}))}static addTarget(e){if(!fs.isTouchDevice())return le.None;fs.INSTANCE||(fs.INSTANCE=new fs);const t=fs.INSTANCE.targets.push(e);return qe(t)}static ignoreTarget(e){if(!fs.isTouchDevice())return le.None;fs.INSTANCE||(fs.INSTANCE=new fs);const t=fs.INSTANCE.ignoreTargets.push(e);return qe(t)}static isTouchDevice(){return"ontouchstart"in ni||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){const r=e.targetTouches.item(i);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};const o=this.newGestureEvent(hi.Start,r.target);o.pageX=r.pageX,o.pageY=r.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){const i=Date.now(),n=Object.keys(this.activeTouches).length;for(let r=0,o=t.changedTouches.length;r<o;r++){const a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}const l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<fs.HOLD_DELAY&&Math.abs(l.initialPageX-l.rollingPageX.at(-1))<30&&Math.abs(l.initialPageY-l.rollingPageY.at(-1))<30){const h=this.newGestureEvent(hi.Tap,l.initialTarget);h.pageX=l.rollingPageX.at(-1),h.pageY=l.rollingPageY.at(-1),this.dispatchEvent(h)}else if(c>=fs.HOLD_DELAY&&Math.abs(l.initialPageX-l.rollingPageX.at(-1))<30&&Math.abs(l.initialPageY-l.rollingPageY.at(-1))<30){const h=this.newGestureEvent(hi.Contextmenu,l.initialTarget);h.pageX=l.rollingPageX.at(-1),h.pageY=l.rollingPageY.at(-1),this.dispatchEvent(h)}else if(n===1){const h=l.rollingPageX.at(-1),d=l.rollingPageY.at(-1),g=l.rollingTimestamps.at(-1)-l.rollingTimestamps[0],p=h-l.rollingPageX[0],_=d-l.rollingPageY[0],b=[...this.targets].filter(C=>l.initialTarget instanceof Node&&C.contains(l.initialTarget));this.inertia(e,b,i,Math.abs(p)/g,p>0?1:-1,h,Math.abs(_)/g,_>0?1:-1,d)}this.dispatchEvent(this.newGestureEvent(hi.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===hi.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>fs.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===hi.Change||e.type===hi.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(e.initialTarget))return;const t=[];for(const i of this.targets)if(i.contains(e.initialTarget)){let n=0,r=e.initialTarget;for(;r&&r!==i;)n++,r=r.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(const[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,r,o,a,l,c){this.handle=Ar(e,()=>{const h=Date.now(),d=h-i;let g=0,p=0,_=!0;n+=fs.SCROLL_FRICTION*d,a+=fs.SCROLL_FRICTION*d,n>0&&(_=!1,g=r*n*d),a>0&&(_=!1,p=l*a*d);const b=this.newGestureEvent(hi.Change);b.translationX=g,b.translationY=p,t.forEach(C=>C.dispatchEvent(b)),_||this.inertia(e,t,h,n,r,o+g,a,l,c+p)})}onTouchMove(e){const t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){const r=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}const o=this.activeTouches[r.identifier],a=this.newGestureEvent(hi.Change,o.initialTarget);a.translationX=r.pageX-o.rollingPageX.at(-1),a.translationY=r.pageY-o.rollingPageY.at(-1),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(r.pageX),o.rollingPageY.push(r.pageY),o.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};fs.SCROLL_FRICTION=-.005,fs.HOLD_DELAY=700,fs.CLEAR_TAP_COUNT_TIME=400;let fr=fs;Lye([Vi],fr,"isTouchDevice",null);let Ec=class extends le{onclick(e,t){this._register(ie(e,Le.CLICK,i=>t(new So(Ue(e),i))))}onmousedown(e,t){this._register(ie(e,Le.MOUSE_DOWN,i=>t(new So(Ue(e),i))))}onmouseover(e,t){this._register(ie(e,Le.MOUSE_OVER,i=>t(new So(Ue(e),i))))}onmouseleave(e,t){this._register(ie(e,Le.MOUSE_LEAVE,i=>t(new So(Ue(e),i))))}onkeydown(e,t){this._register(ie(e,Le.KEY_DOWN,i=>t(new si(i))))}onkeyup(e,t){this._register(ie(e,Le.KEY_UP,i=>t(new si(i))))}oninput(e,t){this._register(ie(e,Le.INPUT,t))}onblur(e,t){this._register(ie(e,Le.BLUR,t))}onfocus(e,t){this._register(ie(e,Le.FOCUS,t))}ignoreGesture(e){return fr.ignoreTarget(e)}};const I1=11;class kye extends Ec{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Ct.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=I1+"px",this.domNode.style.height=I1+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new MD),this._register(bs(this.bgDomNode,Le.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(bs(this.domNode,Le.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new o7),this._pointerdownScheduleRepeatTimer=this._register(new _c)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Ue(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class Eye extends le{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new _c)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var e;(e=this._domNode)==null||e.setClassName(this._visibleClassName)},0))}_hide(e){var t;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(t=this._domNode)==null||t.setClassName(this._invisibleClassName+(e?" fade":"")))}}const Dye=140;class SJ extends Ec{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new Eye(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new MD),this._shouldRender=!0,this.domNode=Tt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(ie(this.domNode.domNode,Le.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new kye(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=Tt(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(ie(this.slider.domNode,Le.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);i<=r&&r<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const o=ta(this.domNode.domNode);t=e.pageX-o.left,i=e.pageY-o.top}const n=e.pointerType==="mouse",r=e.button===0;if(r||!n){const o=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(o):this._scrollbarState.getDesiredScrollPositionFromOffset(o))}r&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{const o=this._sliderOrthogonalPointerPosition(r),a=Math.abs(o-i);if(Rr&&a>Dye){this._setDesiredScrollPositionNow(n.getScrollPosition());return}const c=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const Tye=20;class R1{constructor(e,t,i,n,r,o){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=r,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new R1(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,r){const o=Math.max(0,i-e),a=Math.max(0,o-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(Tye,Math.floor(i*a/n))),h=(a-c)/(n-i),d=r*h;return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:h,computedSliderPosition:Math.round(d)}}_refreshComputedValues(){const e=R1._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class Nye extends SJ{constructor(e,t,i){const n=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new R1(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const o=(t.arrowSize-I1)/2,a=(t.horizontalScrollbarSize-I1)/2;this._createArrow({className:"scra",icon:Ae.scrollbarButtonLeft,top:a,left:o,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new rm(null,1,0))}),this._createArrow({className:"scra",icon:Ae.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:o,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new rm(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class Iye extends SJ{constructor(e,t,i){const n=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new R1(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const o=(t.arrowSize-I1)/2,a=(t.verticalScrollbarSize-I1)/2;this._createArrow({className:"scra",icon:Ae.scrollbarButtonUp,top:o,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new rm(null,0,1))}),this._createArrow({className:"scra",icon:Ae.scrollbarButtonDown,top:void 0,left:a,bottom:o,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new rm(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class Nk{constructor(e,t,i,n,r,o,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,r=r|0,o=o|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),r<0&&(r=0),a+r>o&&(a=o-r),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=r,this.scrollHeight=o,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new Nk(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new Nk(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:r,heightChanged:o,scrollHeightChanged:a,scrollTopChanged:l}}}class eb extends le{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new Z),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new Nk(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){var n;const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),(n=this._smoothScrolling)==null||n.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new jv(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=jv.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class XU{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function LR(s,e){const t=e-s;return function(i){return s+t*Mye(i)}}function Rye(s,e,t){return function(i){return i<t?s(i/t):e((i-t)/(1-t))}}class jv{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let r,o;return e<t?(r=e+.75*i,o=t-.75*i):(r=e-.75*i,o=t+.75*i),Rye(LR(e,r),LR(o,t),.33)}return LR(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),n=this.scrollTop(t);return new XU(i,n,!1)}return new XU(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return jv.start(e,t,i)}static start(e,t,i){i=i+10;const n=Date.now()-10;return new jv(e,t,n,i)}}function Aye(s){return Math.pow(s,3)}function Mye(s){return 1-Aye(1-s)}const Oye=500,ZU=50;class Pye{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}const nE=class nE{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{const r=n===this._front?e:Math.pow(2,-i);if(e-=r,t+=this._memory[n].score*r,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(BC){const t=Ue(e.browserEvent),i=_4(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null;const r=new Pye(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){const n=Math.abs(e.deltaX),r=Math.abs(e.deltaY),o=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,o),1),c=Math.max(Math.min(r,a),1),h=Math.max(n,o),d=Math.max(r,a);h%l===0&&d%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){const t=Number.EPSILON*100;return Math.abs(Math.round(e)-e)<.01+t}};nE.INSTANCE=new nE;let Ik=nE;class P7 extends Ec{get onScroll(){return this._onScroll.event}get options(){return this._options}constructor(e,t,i){super(),this._inertialTimeout=null,this._inertialSpeed={X:0,Y:0},this._onScroll=this._register(new Z),this._onWillScroll=this._register(new Z),e.style.overflow="hidden",this._options=Bye(t),this._scrollable=i,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));const n={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new Iye(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new Nye(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Tt(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Tt(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Tt(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new _c),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=_n(this._mouseWheelToDispose),this._inertialTimeout&&(this._inertialTimeout.dispose(),this._inertialTimeout=null),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,_t&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new rm(e))}async _periodicSync(){var t;let e=!1;(this._inertialSpeed.X!==0||this._inertialSpeed.Y!==0)&&(this._scrollable.setScrollPositionNow({scrollTop:this._scrollable.getCurrentScrollPosition().scrollTop-this._inertialSpeed.Y*100,scrollLeft:this._scrollable.getCurrentScrollPosition().scrollLeft-this._inertialSpeed.X*100}),this._inertialSpeed.X*=.9,this._inertialSpeed.Y*=.9,Math.abs(this._inertialSpeed.X)<.01&&(this._inertialSpeed.X=0),Math.abs(this._inertialSpeed.Y)<.01&&(this._inertialSpeed.Y=0),e=this._inertialSpeed.X!==0||this._inertialSpeed.Y!==0),e?(this._inertialTimeout||(this._inertialTimeout=new _c),this._inertialTimeout.cancelAndSet(()=>this._periodicSync(),1e3/60)):((t=this._inertialTimeout)==null||t.dispose(),this._inertialTimeout=null)}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=_n(this._mouseWheelToDispose),e)){const i=n=>{this._onMouseWheel(new rm(n))};this._mouseWheelToDispose.push(ie(this._listenOnDomNode,Le.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){var r;if((r=e.browserEvent)!=null&&r.defaultPrevented)return;const t=Ik.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&a+o===0?a=o=0:Math.abs(o)>=Math.abs(a)?a=0:o=0),this._options.flipAxes&&([o,a]=[a,o]);const l=!_t&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||l)&&!a&&(a=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(a=a*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);const c=this._scrollable.getFutureScrollPosition();let h={};if(o){const d=ZU*o,g=c.scrollTop-(d<0?Math.floor(d):Math.ceil(d));this._verticalScrollbar.writeScrollPosition(h,g)}if(a){const d=ZU*a,g=c.scrollLeft-(d<0?Math.floor(d):Math.ceil(d));this._horizontalScrollbar.writeScrollPosition(h,g)}if(h=this._scrollable.validateScrollPosition(h),this._options.inertialScroll&&(a||o)&&!t.isPhysicalMouseWheel()){let d=!1;this._inertialSpeed.X===0&&this._inertialSpeed.Y===0&&(d=!0),this._inertialSpeed.Y=(o<0?-1:1)*Math.abs(o)**1.02,this._inertialSpeed.X=(a<0?-1:1)*Math.abs(a)**1.02,d&&this._periodicSync()}(c.scrollLeft!==h.scrollLeft||c.scrollTop!==h.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(h):this._scrollable.setScrollPositionNow(h),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",r=t?" top":"",o=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${o}${r}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),Oye)}}class Fye extends P7{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new eb({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Ar(Ue(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class HD extends P7{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class F7 extends P7{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new eb({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Ar(Ue(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function Bye(s){const e={lazyRender:typeof s.lazyRender<"u"?s.lazyRender:!1,className:typeof s.className<"u"?s.className:"",useShadows:typeof s.useShadows<"u"?s.useShadows:!0,handleMouseWheel:typeof s.handleMouseWheel<"u"?s.handleMouseWheel:!0,flipAxes:typeof s.flipAxes<"u"?s.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof s.consumeMouseWheelIfScrollbarIsNeeded<"u"?s.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof s.alwaysConsumeMouseWheel<"u"?s.alwaysConsumeMouseWheel:!1,scrollYToX:typeof s.scrollYToX<"u"?s.scrollYToX:!1,mouseWheelScrollSensitivity:typeof s.mouseWheelScrollSensitivity<"u"?s.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof s.fastScrollSensitivity<"u"?s.fastScrollSensitivity:5,scrollPredominantAxis:typeof s.scrollPredominantAxis<"u"?s.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof s.mouseWheelSmoothScroll<"u"?s.mouseWheelSmoothScroll:!0,inertialScroll:typeof s.inertialScroll<"u"?s.inertialScroll:!1,arrowSize:typeof s.arrowSize<"u"?s.arrowSize:11,listenOnDomNode:typeof s.listenOnDomNode<"u"?s.listenOnDomNode:null,horizontal:typeof s.horizontal<"u"?s.horizontal:1,horizontalScrollbarSize:typeof s.horizontalScrollbarSize<"u"?s.horizontalScrollbarSize:10,horizontalSliderSize:typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:0,horizontalHasArrows:typeof s.horizontalHasArrows<"u"?s.horizontalHasArrows:!1,vertical:typeof s.vertical<"u"?s.vertical:1,verticalScrollbarSize:typeof s.verticalScrollbarSize<"u"?s.verticalScrollbarSize:10,verticalHasArrows:typeof s.verticalHasArrows<"u"?s.verticalHasArrows:!1,verticalSliderSize:typeof s.verticalSliderSize<"u"?s.verticalSliderSize:0,scrollByPage:typeof s.scrollByPage<"u"?s.scrollByPage:!1};return e.horizontalSliderSize=typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof s.verticalSliderSize<"u"?s.verticalSliderSize:e.verticalScrollbarSize,_t&&(e.className+=" mac"),e}class xJ extends le{constructor(e,t,i,n){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=this._createDragScrollingOperation(e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class LJ extends le{constructor(e,t,i,n,r,o){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._position=r,this._mouseEvent=o,this._lastTime=Date.now(),this._animationFrameDisposable=Ar(Ue(o.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}}class Vye extends xJ{_createDragScrollingOperation(e,t){return new Hye(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}}class Hye extends LJ{_getScrollSpeed(){const e=this._context.configuration.options.get(75),t=this._context.configuration.options.get(165).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(75),t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e,r=this._position.outsidePosition==="above"?-n:n;this._context.viewModel.viewLayout.deltaScrollNow(0,r),this._viewHelper.renderNow();const o=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?o.startLineNumber:o.endLineNumber;let l;{const c=BD(this._viewHelper.viewDomNode),h=this._context.configuration.options.get(165).horizontalScrollbarHeight,d=new XC(this._mouseEvent.pos.x,c.y+c.height-h-.1),g=VD(this._viewHelper.viewDomNode,c,d);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,d,g,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=ms.createOutsideEditor(this._position.mouseColumn,new J(a,1),"above",this._position.outsideDistance):l=ms.createOutsideEditor(this._position.mouseColumn,new J(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=Ar(Ue(l.element),()=>this._execute())}}class Wye extends xJ{_createDragScrollingOperation(e,t){return new zye(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}}class zye extends LJ{_getScrollSpeed(){const e=this._context.configuration.options.get(59).typicalFullwidthCharacterWidth,t=this._context.configuration.options.get(165).contentWidth/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(59).typicalFullwidthCharacterWidth,t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e*.5,r=this._position.outsidePosition==="left"?-n:n;if(this._context.viewModel.viewLayout.deltaScrollNow(r,0),this._viewHelper.renderNow(),!this._position.position)return;const o=this._position.position.lineNumber;let a;{const l=BD(this._viewHelper.viewDomNode),c=this._context.configuration.options.get(165).horizontalScrollbarHeight,h=new XC(this._mouseEvent.pos.x,l.y+l.height-c-.1),d=VD(this._viewHelper.viewDomNode,l,h);a=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),l,h,d,null)}this._position.outsidePosition==="left"?a=ms.createOutsideEditor(a.mouseColumn,new J(o,a.mouseColumn),"left",this._position.outsideDistance):a=ms.createOutsideEditor(a.mouseColumn,new J(o,a.mouseColumn),"right",this._position.outsideDistance),this._dispatchMouse(a,!0,2),this._animationFrameDisposable=Ar(Ue(a.element),()=>this._execute())}}class B7 extends Im{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Fs(this._context,i),this._mouseDownOperation=this._register(new Uye(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(o,a)=>this._createMouseTarget(o,a),o=>this._getMouseColumn(o))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(165).height;const n=new dye(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,o=>this._onContextMenu(o,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,o=>{this._onMouseMove(o),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=ie(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new Md(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o)));let r=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,a)=>{r=a})),this._register(ie(this.viewHelper.viewDomNode,Le.POINTER_UP,o=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,o=>this._onMouseDown(o,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=Ik.INSTANCE;let t=0,i=Yh.getZoomLevel(),n=!1,r=0;const o=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(84))return;const c=new rm(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const h=Yh.getZoomLevel(),d=c.deltaY>0?1:-1;Yh.setZoomLevel(h+d),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=Yh.getZoomLevel(),n=a(l),r=0),t=Date.now(),r+=c.deltaY,n&&(Yh.setZoomLevel(i+r/5),c.preventDefault(),c.stopPropagation())};this._register(ie(this.viewHelper.viewDomNode,Le.MOUSE_WHEEL,o,{capture:!0,passive:!1}));function a(l){return _t?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(165)){const t=this._context.configuration.options.get(165).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const n=new _J(e,t).toPageCoordinates(Ue(this.viewHelper.viewDomNode)),r=BD(this.viewHelper.viewDomNode);if(n.y<r.y||n.y>r.y+r.height||n.x<r.x||n.x>r.x+r.width)return null;const o=VD(this.viewHelper.viewDomNode,r,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,n,o,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const n=om(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(o=>this.viewHelper.viewDomNode.contains(o))??null)}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,r=i.type===2||i.type===3||i.type===4,o=i.type===3,a=this._context.configuration.options.get(125),l=i.type===8||i.type===5,c=i.type===9;let h=e.leftButton||e.middleButton;_t&&e.leftButton&&e.ctrlKey&&(h=!1);const d=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(h&&(n||o&&a))d(),this._mouseDownOperation.start(i.type,e,t);else if(r)e.preventDefault();else if(l){const g=i.detail;h&&this.viewHelper.shouldSuppressMouseDownOnViewZone(g.viewZoneId)&&(d(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(d(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class Uye extends le{constructor(e,t,i,n,r,o){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=n,this._createMouseTarget=r,this._getMouseColumn=o,this._mouseMoveMonitor=this._register(new gye(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new Vye(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._leftRightDragScrolling=this._register(new Wye(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new b5,this._currentSelection=new Lt(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13?t.outsidePosition==="above"||t.outsidePosition==="below"?(this._topBottomDragScrolling.start(t,e),this._leftRightDragScrolling.stop()):(this._leftRightDragScrolling.start(t,e),this._topBottomDragScrolling.stop()):(this._topBottomDragScrolling.stop(),this._leftRightDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const r=this._context.configuration.options;if(!r.get(104)&&r.get(42)&&!r.get(28)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&n.type===6&&n.position&&this._currentSelection.containsPosition(n.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),o=>{const a=this._findMousePosition(this._lastMouseEvent,!1);yu(o)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop(),this._leftRightDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,r=this._getMouseColumn(e);if(e.posy<t.y){const d=t.y-e.posy,g=Math.max(n.getCurrentScrollTop()-d,0),p=N1.getZoneAtCoord(this._context,g);if(p){const b=this._helpPositionJumpOverViewZone(p);if(b)return ms.createOutsideEditor(r,b,"above",d)}const _=n.getLineNumberAtVerticalOffset(g);return ms.createOutsideEditor(r,new J(_,1),"above",d)}if(e.posy>t.y+t.height){const d=e.posy-t.y-t.height,g=n.getCurrentScrollTop()+e.relativePos.y,p=N1.getZoneAtCoord(this._context,g);if(p){const b=this._helpPositionJumpOverViewZone(p);if(b)return ms.createOutsideEditor(r,b,"below",d)}const _=n.getLineNumberAtVerticalOffset(g);return ms.createOutsideEditor(r,new J(_,i.getLineMaxColumn(_)),"below",d)}const o=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y),a=this._context.configuration.options.get(165),l=a.contentLeft;if(e.relativePos.x<=l){const d=l-e.relativePos.x;return ms.createOutsideEditor(r,new J(o,1),"left",d)}const h=a.minimap.minimapLeft===0?a.width-a.verticalScrollbarWidth:a.minimap.minimapLeft;if(e.relativePos.x>=h){const d=e.relativePos.x-h;return ms.createOutsideEditor(r,new J(o,i.getLineMaxColumn(o)),"right",d)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(n.type===8||n.type===5){const o=this._helpPositionJumpOverViewZone(n.detail);if(o)return ms.createViewZone(n.type,n.element,n.mouseColumn,o,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new J(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}const sE=class sE{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>sE.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};sE.CLEAR_MOUSE_DOWN_COUNT_TIME=400;let b5=sE;class jt{get event(){return this.emitter.event}constructor(e,t,i){const n=r=>this.emitter.fire(r);this.emitter=new Z({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}}function kJ(s,e,t,i){const n=s.getPlainTextToCopy(e,t,Rr),r=s.model.getEOL(),o=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(n)?n:null,l=Array.isArray(n)?n.join(r):n;let c,h=null;if(i&&l.length<65536){const g=s.getRichTextToCopy(e,t);g&&(c=g.html,h=g.mode)}return{isFromEmptySelection:o,multicursorText:a,text:l,html:c,mode:h}}const rE=class rE{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}};rE.INSTANCE=new rE;let Lg=rE;const Rk={getTextData(s){const e=s.getData(Du.text);let t=null;const i=s.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&s.files.length>0?[Array.prototype.slice.call(s.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(s,e,t,i){s.setData(Du.text,e),typeof t=="string"&&s.setData("text/html",t),s.setData("vscode-editor-data",JSON.stringify(i))}},ig=class ig{constructor(e,t,i,n,r){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=n,this.newlineCountBeforeSelection=r}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),n=e.getSelectionStart(),r=e.getSelectionEnd();let o;if(t){const a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(o=t.newlineCountBeforeSelection)}return new ig(i,n,r,null,o)}collapseSelection(){return this.selectionStart===this.value.length?this:new ig(this.value,this.value.length,this.value.length,null,void 0)}isWrittenToTextArea(e,t){const i=this.value===e.getValue();return t?this.selectionStart===e.getSelectionStart()&&this.selectionEnd===e.getSelectionEnd()&&i:i}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){var n,r,o,a;if(e<=this.selectionStart){const l=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(((n=this.selection)==null?void 0:n.getStartPosition())??null,l,-1)}if(e>=this.selectionEnd){const l=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(((r=this.selection)==null?void 0:r.getEndPosition())??null,l,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf("")===-1)return this._finishDeduceEditorPosition(((o=this.selection)==null?void 0:o.getStartPosition())??null,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(((a=this.selection)==null?void 0:a.getEndPosition())??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(b1(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(w1(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-r);const o=t.value.substring(n,t.value.length-r),a=e.selectionStart-n,l=e.selectionEnd-n,c=t.selectionStart-n,h=t.selectionEnd-n;if(c===h){const g=e.selectionStart-n;return{text:o,replacePrevCharCnt:g,replaceNextCharCnt:0,positionDelta:0}}const d=l-a;return{text:o,replacePrevCharCnt:d,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(b1(e.value,t.value),e.selectionEnd),n=Math.min(w1(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(i,e.value.length-n),o=t.value.substring(i,t.value.length-n);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:o,replacePrevCharCnt:a,replaceNextCharCnt:r.length-a,positionDelta:l-o.length}}static fromScreenReaderContentState(e){return new ig(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};ig.EMPTY=new ig("",0,0,null,void 0);let zs=ig;const V7=(function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const s=new Uint8Array(16),e=[];for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(s),s[6]=s[6]&15|64,s[8]=s[8]&63|128;let i=0,n="";return n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n}})();function jye(s){return`${s}-${V7()}`}var $ye=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},JU=function(s,e){return function(t,i){e(t,i,s)}},Ak;(function(s){s.Tap="-monaco-textarea-synthetic-tap"})(Ak||(Ak={}));class qye{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}let w5=class extends le{get textAreaState(){return this._textAreaState}constructor(e,t,i,n,r,o){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._accessibilityService=r,this._logService=o,this._onFocus=this._register(new Z),this.onFocus=this._onFocus.event,this._onBlur=this._register(new Z),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new Z),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new Z),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new Z),this.onCut=this._onCut.event,this._onPaste=this._register(new Z),this.onPaste=this._onPaste.event,this._onType=this._register(new Z),this.onType=this._onType.event,this._onCompositionStart=this._register(new Z),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new Z),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new Z),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new Z),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new Yn),this._asyncTriggerCut=this._register(new Es(()=>this._onCut.fire(),0)),this._textAreaState=zs.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(Se.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Es(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let a=null;this._register(this._textArea.onKeyDown(l=>{const c=new si(l);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),a=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(l=>{const c=new si(l);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(l=>{const c=new qye;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&a&&a.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===l.data&&(a.code==="ArrowRight"||a.code==="ArrowLeft")){c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:l.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:l.data});return}this._onCompositionStart.fire({data:l.data})})),this._register(this._textArea.onCompositionUpdate(l=>{const c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){const d=zs.readFromTextArea(this._textArea,this._textAreaState),g=zs.deduceAndroidCompositionInput(this._textAreaState,d);this._textAreaState=d,this._onType.fire(g),this._onCompositionUpdate.fire(l);return}const h=c.handleCompositionUpdate(l.data);this._textAreaState=zs.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(h),this._onCompositionUpdate.fire(l)})),this._register(this._textArea.onCompositionEnd(l=>{const c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){const d=zs.readFromTextArea(this._textArea,this._textAreaState),g=zs.deduceAndroidCompositionInput(this._textAreaState,d);this._textAreaState=d,this._onType.fire(g),this._onCompositionEnd.fire();return}const h=c.handleCompositionUpdate(l.data);this._textAreaState=zs.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(h),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const c=zs.readFromTextArea(this._textArea,this._textAreaState),h=zs.deduceInput(this._textAreaState,c,this._OS===2);h.replacePrevCharCnt===0&&h.text.length===1&&(Tn(h.text.charCodeAt(0))||h.text.charCodeAt(0)===127)||(this._textAreaState=c,(h.text!==""||h.replacePrevCharCnt!==0||h.replaceNextCharCnt!==0||h.positionDelta!==0)&&(l.inputType==="insertFromPaste"?this._onPaste.fire({text:h.text,metadata:Lg.INSTANCE.get(h.text)}):this._onType.fire(h)))})),this._register(this._textArea.onCut(l=>{this._logService.trace("TextAreaInput#onCut",l),this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(l),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(l=>{this._logService.trace("TextAreaInput#onCopy",l),this._ensureClipboardGetsEditorSelection(l)})),this._register(this._textArea.onPaste(l=>{if(this._logService.trace("TextAreaInput#onPaste",l),this._textArea.setIgnoreSelectionChangeTime("received paste event"),l.preventDefault(),!l.clipboardData)return;let[c,h]=Rk.getTextData(l.clipboardData);this._logService.trace("TextAreaInput#onPaste with id : ",h==null?void 0:h.id," with text.length: ",c.length),c&&(h=h||Lg.INSTANCE.get(c),this._logService.trace("TextAreaInput#onPaste (before onPaste)"),this._onPaste.fire({text:c,metadata:h}))})),this._register(this._textArea.onFocus(()=>{const l=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!l&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Es(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return ie(this._textArea.ownerDocument,"selectionchange",t=>{if(nd.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const r=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),r<100||!this._textAreaState.selection)return;const o=this._textArea.getValue();if(this._textAreaState.value!==o)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),h=this._host.deduceModelPosition(c[0],c[1],c[2]),d=this._textAreaState.deduceEditorPosition(l),g=this._host.deduceModelPosition(d[0],d[1],d[2]),p=new Lt(h.lineNumber,h.column,g.lineNumber,g.column);this._onSelectionChangeRequest.fire(p)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.isWrittenToTextArea(this._textArea,this._hasFocus)||this._logService.trace(`writeTextAreaState(reason: ${e})`),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent())}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy();let i;this._logService.getLevel()===jn.Trace&&(i=V7());const n={version:1,id:i,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};Lg.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,n),e.preventDefault(),e.clipboardData&&Rk.setTextData(e.clipboardData,t.text,t.html,n),this._logService.trace("TextAreaEditContextInput#_ensureClipboardGetsEditorSelection with id : ",i," with text.length: ",t.text.length)}};w5=$ye([JU(4,Mo),JU(5,pr)],w5);class Gye extends le{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this._onSyntheticTap=this._register(new Z),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this.onKeyDown=this._register(new jt(this._actual,"keydown")).event,this.onKeyPress=this._register(new jt(this._actual,"keypress")).event,this.onKeyUp=this._register(new jt(this._actual,"keyup")).event,this.onCompositionStart=this._register(new jt(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new jt(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new jt(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new jt(this._actual,"beforeinput")).event,this.onInput=this._register(new jt(this._actual,"input")).event,this.onCut=this._register(new jt(this._actual,"cut")).event,this.onCopy=this._register(new jt(this._actual,"copy")).event,this.onPaste=this._register(new jt(this._actual,"paste")).event,this.onFocus=this._register(new jt(this._actual,"focus")).event,this.onBlur=this._register(new jt(this._actual,"blur")).event,this._register(this.onKeyDown(()=>nd.onKeyDown())),this._register(this.onBeforeInput(()=>nd.onBeforeInput())),this._register(this.onInput(()=>nd.onInput())),this._register(this.onKeyUp(()=>nd.onKeyUp())),this._register(ie(this._actual,Ak.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=om(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?Kn()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let r=null;const o=om(n);o?r=o.activeElement:r=Kn();const a=Ue(r),l=r===n,c=n.selectionStart,h=n.selectionEnd;if(l&&c===t&&h===i){Kr&&a.parent!==a&&n.focus();return}if(l){this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),Kr&&a.parent!==a&&n.focus();return}try{const d=L1e(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),k1e(n,d)}catch{}}}class Kye extends B7{constructor(e,t,i){super(e,t,i),this._register(fr.addTarget(this.viewHelper.linesContentDomNode)),this._register(ie(this.viewHelper.linesContentDomNode,hi.Tap,r=>this.onTap(r))),this._register(ie(this.viewHelper.linesContentDomNode,hi.Change,r=>this.onChange(r))),this._register(ie(this.viewHelper.linesContentDomNode,hi.Contextmenu,r=>this._onContextMenu(new Md(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(ie(this.viewHelper.linesContentDomNode,"pointerdown",r=>{const o=r.pointerType;if(o==="mouse"){this._lastPointerType="mouse";return}else o==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const n=new fye(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(r,o)=>this._onMouseDown(r,o)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){const i=this._createMouseTarget(new Md(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class Yye extends B7{constructor(e,t,i){super(e,t,i),this._register(fr.addTarget(this.viewHelper.linesContentDomNode)),this._register(ie(this.viewHelper.linesContentDomNode,hi.Tap,n=>this.onTap(n))),this._register(ie(this.viewHelper.linesContentDomNode,hi.Change,n=>this.onChange(n))),this._register(ie(this.viewHelper.linesContentDomNode,hi.Contextmenu,n=>this._onContextMenu(new Md(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new Md(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(Ak.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class Qye extends le{constructor(e,t,i){super(),(gc||wme&&uX)&&VC.pointerEvents?this.handler=this._register(new Kye(e,t,i)):ni.TouchEvent?this.handler=this._register(new Yye(e,t,i)):this.handler=this._register(new B7(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}function Xye(s,e,t){let i=0;for(let r=0;r<s.length;r++)s.charAt(r)==="	"?i=Ai.nextIndentTabStop(i,e):i++;let n="";if(!t){const r=Math.floor(i/e);i=i%e;for(let o=0;o<r;o++)n+="	"}for(let r=0;r<i;r++)n+=" ";return n}function EJ(s,e,t){let i=qr(s);return i===-1&&(i=s.length),Xye(s.substring(0,i),e,t)+s.substring(i)}const Zye=()=>!0,Jye=()=>!1,eSe=s=>s===" "||s==="	";class Ap{static shouldRecreate(e){return e.hasChanged(165)||e.hasChanged(148)||e.hasChanged(45)||e.hasChanged(85)||e.hasChanged(88)||e.hasChanged(89)||e.hasChanged(10)||e.hasChanged(11)||e.hasChanged(15)||e.hasChanged(13)||e.hasChanged(14)||e.hasChanged(20)||e.hasChanged(145)||e.hasChanged(141)||e.hasChanged(59)||e.hasChanged(104)||e.hasChanged(147)||e.hasChanged(93)}constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const r=i.options,o=r.get(165),a=r.get(59);this.readOnly=r.get(104),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(132),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(o.height/this.lineHeight)-2),this.useTabStops=r.get(145),this.trimWhitespaceOnDelete=r.get(141),this.wordSeparators=r.get(148),this.emptySelectionClipboard=r.get(45),this.copyWithSyntaxHighlighting=r.get(31),this.multiCursorMergeOverlapping=r.get(85),this.multiCursorPaste=r.get(88),this.multiCursorLimit=r.get(89),this.autoClosingBrackets=r.get(10),this.autoClosingComments=r.get(11),this.autoClosingQuotes=r.get(15),this.autoClosingDelete=r.get(13),this.autoClosingOvertype=r.get(14),this.autoSurround=r.get(20),this.autoIndent=r.get(16),this.wordSegmenterLocales=r.get(147),this.overtypeOnPaste=r.get(93),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(const h of l)this.surroundingPairs[h.open]=h.close;const c=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=(c==null?void 0:c.blockCommentStartToken)??null}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)==null?void 0:e.getElectricCharacters();if(t)for(const i of t)this._electricChars[i]=!0}return this._electricChars}get inputMode(){return s5.getInputMode()}onElectricCharacter(e,t,i){const n=ug(t,i-1),r=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return r?r.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return EJ(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return eSe;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return Zye;case"never":return Jye}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return Ai.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=Ai.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),r=e.getLineMinColumn(t);if(n<r)return r;const o=e.getLineMaxColumn(t);return n>o?o:n}}class wt{static fromModelState(e){return new tSe(e)}static fromViewState(e){return new iSe(e)}static fromModelSelection(e){const t=Lt.liftSelection(e),i=new es(G.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return wt.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class tSe{constructor(e){this.modelState=e,this.viewState=null}}class iSe{constructor(e){this.modelState=null,this.viewState=e}}class es{constructor(e,t,i,n,r){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=n,this.leftoverVisibleColumns=r,this._singleCursorStateBrand=void 0,this.selection=es._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new es(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new J(t,i),n):new es(new G(t,i,t,i),0,n,new J(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Lt.fromPositions(e.getStartPosition(),t):Lt.fromPositions(e.getEndPosition(),t)}}class gr{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function Od(s){return s==="'"||s==='"'||s==="`"}class Hf{static columnSelect(e,t,i,n,r,o){const a=Math.abs(r-i)+1,l=i>r,c=n>o,h=n<o,d=[];for(let g=0;g<a;g++){const p=i+(l?-g:g),_=e.columnFromVisibleColumn(t,p,n),b=e.columnFromVisibleColumn(t,p,o),C=e.visibleColumnFromColumn(t,new J(p,_)),x=e.visibleColumnFromColumn(t,new J(p,b));h&&(C>o||x<n)||c&&(x>n||C<o)||d.push(new es(new G(p,_,p,_),0,0,new J(p,b),0))}if(d.length===0)for(let g=0;g<a;g++){const p=i+(l?-g:g),_=t.getLineMaxColumn(p);d.push(new es(new G(p,_,p,_),0,0,new J(p,_),0))}return{viewStates:d,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:r,toVisualColumn:o}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,Hf.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const r=Math.min(i.fromViewLineNumber,i.toViewLineNumber),o=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=r;l<=o;l++){const c=t.getLineMaxColumn(l),h=e.visibleColumnFromColumn(t,new J(l,c));n=Math.max(n,h)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){const r=n?e.pageSize:1,o=Math.max(1,i.toViewLineNumber-r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const r=n?e.pageSize:1,o=Math.min(t.getLineCount(),i.toViewLineNumber+r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}}class Wr{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Lt.fromPositions(n.getEndPosition())}}class v5{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){const i=this._range.getStartPosition(),n=this._range.getEndPosition(),r=n.lineNumber,o=this._text.length+(this._range.isEmpty()?0:-1);let a=DJ(e,n,o);a.lineNumber>r&&(a=new J(r,e.getLineMaxColumn(r)));const l=G.fromPositions(i,a);t.addTrackedEditOperation(l,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Lt.fromPositions(n.getEndPosition())}}class Zx{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Lt.fromPositions(n.getStartPosition())}}class Mk{constructor(e,t,i,n,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Lt.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class nSe{constructor(e){this._range=e}getEditOperations(e,t){const i=e.getValueInRange(this._range),n=this._range.getEndPosition(),r=n.lineNumber;let o=DJ(e,n,i.length);o.lineNumber>r&&(o=new J(r,e.getLineMaxColumn(r)));const a=G.fromPositions(n,o);t.addTrackedEditOperation(a,"")}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Lt.fromPositions(n.getEndPosition())}}class sSe{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function DJ(s,e,t){if(t<0)throw new Error("Unexpected negative delta");const i=s.getLineCount();let n=new J(i,s.getLineMaxColumn(i));for(let r=e.lineNumber;r<=i;r++)if(r===e.lineNumber){const o=t-s.getLineMaxColumn(e.lineNumber)+e.column;if(o<=0){n=new J(e.lineNumber,e.column+t);break}t=o}else{const o=t-s.getLineMaxColumn(r);if(o<=0){n=new J(r,t);break}t=o}return n}class kR{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class Ht{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-OX(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new J(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),o=Uv.atomicPosition(r,t.column-1,i,0);if(o!==-1&&o+1>=n)return new J(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?Ht.leftPositionAtomicSoftTabs(t,i,e.tabSize):Ht.leftPosition(t,i);return new kR(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,r){let o,a;if(i.hasSelection()&&!n)o=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(r-1)),c=t.normalizePosition(Ht.clipPositionColumn(l,t),0),h=Ht.left(e,t,c);o=h.lineNumber,a=h.column}return i.move(n,o,a,0)}static clipPositionColumn(e,t){return new J(e.lineNumber,Ht.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+j6(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new J(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,r){if(i<e.getLineIndentColumn(t)){const o=e.getLineContent(t),a=Uv.atomicPosition(o,i-1,n,1);if(a!==-1)return new J(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?Ht.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):Ht.rightPosition(t,i.lineNumber,i.column);return new kR(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,r){let o,a;if(i.hasSelection()&&!n)o=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,r-1),c=t.normalizePosition(Ht.clipPositionColumn(l,t),1),h=Ht.right(e,t,c);o=h.lineNumber,a=h.column}return i.move(n,o,a,0)}static vertical(e,t,i,n,r,o,a,l){const c=Ai.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+r,h=t.getLineCount(),d=i===1&&n===1,g=i===h&&n===t.getLineMaxColumn(i),p=o<i?d:g;if(i=o,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>h?(i=h,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,c),p?r=0:r=c-Ai.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){const _=new J(i,n),b=t.normalizePosition(_,l);r=r+(n-b.column),i=b.lineNumber,n=b.column}return new kR(i,n,r)}static down(e,t,i,n,r,o,a){return this.vertical(e,t,i,n,r,i+o,a,4)}static moveDown(e,t,i,n,r){let o,a;i.hasSelection()&&!n?(o=i.selection.endLineNumber,a=i.selection.endColumn):(o=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=Ht.down(e,t,o+l,a,i.leftoverVisibleColumns,r,!0),t.normalizePosition(new J(c.lineNumber,c.column),2).lineNumber>o)break;while(l++<10&&o+l<t.getLineCount());return i.move(n,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,r=Ht.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Ht.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new es(new G(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new J(o.lineNumber,o.column),o.leftoverVisibleColumns)}static up(e,t,i,n,r,o,a){return this.vertical(e,t,i,n,r,i-o,a,3)}static moveUp(e,t,i,n,r){let o,a;i.hasSelection()&&!n?(o=i.selection.startLineNumber,a=i.selection.startColumn):(o=i.position.lineNumber,a=i.position.column);const l=Ht.up(e,t,o,a,i.leftoverVisibleColumns,r,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,r=Ht.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Ht.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new es(new G(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new J(o.lineNumber,o.column),o.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let r=i.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,i,n){const r=t.getLineCount();let o=i.position.lineNumber;for(;o<r&&this._isBlankLine(t,o);)o++;for(;o<r&&!this._isBlankLine(t,o);)o++;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToBeginningOfLine(e,t,i,n){const r=i.position.lineNumber,o=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||o;let l;return i.position.column===a?l=o:l=a,i.move(n,r,l,0)}static moveToEndOfLine(e,t,i,n,r){const o=i.position.lineNumber,a=t.getLineMaxColumn(o);return i.move(n,o,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const r=t.getLineCount(),o=t.getLineMaxColumn(r);return i.move(n,r,o,0)}}class hm{static deleteRight(e,t,i,n){const r=[];let o=e!==3;for(let a=0,l=n.length;a<l;a++){const c=n[a],h=this.getDeleteRightRange(c,i,t);if(h.isEmpty()){r[a]=null;continue}h.startLineNumber!==h.endLineNumber&&(o=!0),r[a]=new Wr(h,"")}return[o,r]}static getDeleteRightRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition(),r=Ht.right(i,t,n);if(i.trimWhitespaceOnDelete&&r.lineNumber!==n.lineNumber){const o=t.getLineFirstNonWhitespaceColumn(n.lineNumber)>0,a=t.getLineFirstNonWhitespaceColumn(r.lineNumber);if(o&&a>0)return new G(r.lineNumber,a,n.lineNumber,n.column)}return new G(r.lineNumber,r.column,n.lineNumber,n.column)}static isAutoClosingPairDelete(e,t,i,n,r,o,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=o.length;l<c;l++){const h=o[l],d=h.getPosition();if(!h.isEmpty())return!1;const g=r.getLineContent(d.lineNumber);if(d.column<2||d.column>=g.length+1)return!1;const p=g.charAt(d.column-2),_=n.get(p);if(!_)return!1;if(Od(p)){if(i==="never")return!1}else if(t==="never")return!1;const b=g.charAt(d.column-1);let C=!1;for(const x of _)x.open===p&&x.close===b&&(C=!0);if(!C)return!1;if(e==="auto"){let x=!1;for(let S=0,y=a.length;S<y;S++){const k=a[S];if(d.lineNumber===k.startLineNumber&&d.column===k.startColumn){x=!0;break}}if(!x)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].getPosition(),l=new G(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[r]=new Wr(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,r))return this._runAutoClosingPairDelete(t,i,n);const o=[];let a=e!==2;for(let l=0,c=n.length;l<c;l++){const h=hm.getDeleteLeftRange(n[l],i,t);if(h.isEmpty()){o[l]=null;continue}h.startLineNumber!==h.endLineNumber&&(a=!0),o[l]=new Wr(h,"")}return[a,o]}static getDeleteLeftRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const r=t.getLineContent(n.lineNumber),o=qr(r),a=o===-1?r.length+1:o+1;if(n.column<=a){const l=i.visibleColumnFromColumn(t,n),c=Ai.prevIndentTabStop(l,i.indentSize),h=i.columnFromVisibleColumn(t,n.lineNumber,c);return new G(n.lineNumber,h,n.lineNumber,n.column)}}return G.fromPositions(hm.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=p_e(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new J(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const n=[];let r=null;i.sort((o,a)=>J.compare(o.getStartPosition(),a.getEndPosition()));for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let h,d,g,p;c.lineNumber<t.getLineCount()?(h=c.lineNumber,d=1,g=c.lineNumber+1,p=1):c.lineNumber>1&&(r==null?void 0:r.endLineNumber)!==c.lineNumber?(h=c.lineNumber-1,d=t.getLineMaxColumn(c.lineNumber-1),g=c.lineNumber,p=t.getLineMaxColumn(c.lineNumber)):(h=c.lineNumber,d=1,g=c.lineNumber,p=t.getLineMaxColumn(c.lineNumber));const _=new G(h,d,g,p);r=_,_.isEmpty()?n[o]=null:n[o]=new Wr(_,"")}else n[o]=null;else n[o]=new Wr(l,"")}return new gr(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Xi{static _createWord(e,t,i,n,r){return{start:n,end:r,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;const r=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let o=i.column-2;o>=0;o--){const a=e.charCodeAt(o),l=t.get(a);if(r&&o===r.index)return this._createIntlWord(r,l);if(l===0){if(n===2)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const r=t.findNextIntlWordAtOrAfterOffset(e,n),o=e.length;for(let a=n;a<o;a++){const l=e.charCodeAt(a),c=t.get(l);if(r&&a===r.index+r.segment.length||c===1||i===1&&c===2||i===2&&c===0)return a}return o}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const r=e.length,o=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<r;a++){const l=e.charCodeAt(a),c=t.get(l);if(o&&a===o.index)return this._createIntlWord(o,c);if(c===0){if(n===2)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(c===2){if(n===1)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(c===1&&n!==0)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,r-1),r):null}static _findStartOfWord(e,t,i,n){const r=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let o=n;o>=0;o--){const a=e.charCodeAt(o),l=t.get(a);if(r&&o===r.index)return o;if(l===1||i===1&&l===2||i===2&&l===0)return o+1}return 0}static moveWordLeft(e,t,i,n,r){let o=i.lineNumber,a=i.column;a===1&&o>1&&(o=o-1,a=t.getLineMaxColumn(o));let l=Xi._findPreviousWordOnLine(e,t,new J(o,a));if(n===0)return new J(o,l?l.start+1:1);if(n===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=Xi._findPreviousWordOnLine(e,t,new J(o,l.start+1))),new J(o,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=Xi._findPreviousWordOnLine(e,t,new J(o,l.start+1));return new J(o,l?l.start+1:1)}return l&&a<=l.end+1&&(l=Xi._findPreviousWordOnLine(e,t,new J(o,l.start+1))),new J(o,l?l.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new J(i-1,e.getLineMaxColumn(i-1)):t;const r=e.getLineContent(i);for(let o=t.column-1;o>1;o--){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a===95&&l!==95)return new J(i,o);if(a===45&&l!==45)return new J(i,o);if((Qp(a)||zS(a))&&jh(l))return new J(i,o);if(jh(a)&&jh(l)&&o+1<n){const c=r.charCodeAt(o);if(Qp(c)||zS(c))return new J(i,o)}}return new J(i,1)}static moveWordRight(e,t,i,n){let r=i.lineNumber,o=i.column,a=!1;o===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,o=1);let l=Xi._findNextWordOnLine(e,t,new J(r,o));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=Xi._findNextWordOnLine(e,t,new J(r,l.end+1))),l?o=l.end+1:o=t.getLineMaxColumn(r);else if(n===3){for(a&&(o=0);l&&(l.wordType===2||l.start+1<=o);)l=Xi._findNextWordOnLine(e,t,new J(r,l.end+1));l?o=l.start+1:o=t.getLineMaxColumn(r)}else l&&!a&&o>=l.start+1&&(l=Xi._findNextWordOnLine(e,t,new J(r,l.end+1))),l?o=l.start+1:o=t.getLineMaxColumn(r);return new J(r,o)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new J(i+1,1):t;const r=e.getLineContent(i);for(let o=t.column+1;o<n;o++){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a!==95&&l===95)return new J(i,o);if(a!==45&&l===45)return new J(i,o);if((Qp(a)||zS(a))&&jh(l))return new J(i,o);if(jh(a)&&jh(l)&&o+1<n){const c=r.charCodeAt(o);if(Qp(c)||zS(c))return new J(i,o)}}return new J(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,r=Sm(i,n);return r+1<n?new G(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(hm.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const d=e.selection.getPosition();return new G(d.lineNumber,d.column-1,d.lineNumber,d.column+1)}const a=new J(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(o){const d=this._deleteWordLeftWhitespace(n,a);if(d)return d}let h=Xi._findPreviousWordOnLine(i,n,a);return t===0?h?c=h.start+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l)):(h&&c<=h.end+1&&(h=Xi._findPreviousWordOnLine(i,n,new J(l,h.start+1))),h?c=h.end+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l))),new G(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new J(i.positionLineNumber,i.positionColumn),r=this._deleteInsideWordWhitespace(t,n);return r||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,r))return null;let o=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,o))return null;for(;r>0&&this._charAtIsWhitespace(i,r-1);)r--;for(;o+1<n&&this._charAtIsWhitespace(i,o+1);)o++;return new G(t.lineNumber,r+1,t.lineNumber,o+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),r=n.length;if(r===0)return i.lineNumber>1?new G(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new G(i.lineNumber,1,i.lineNumber+1,1):new G(i.lineNumber,1,i.lineNumber,1);const o=d=>d.start+1<=i.column&&i.column<=d.end+1,a=(d,g)=>(d=Math.min(d,i.column),g=Math.max(g,i.column),new G(i.lineNumber,d,i.lineNumber,g)),l=d=>{let g=d.start+1,p=d.end+1,_=!1;for(;p-1<r&&this._charAtIsWhitespace(n,p-1);)_=!0,p++;if(!_)for(;g>1&&this._charAtIsWhitespace(n,g-2);)g--;return a(g,p)},c=Xi._findPreviousWordOnLine(e,t,i);if(c&&o(c))return l(c);const h=Xi._findNextWordOnLine(e,t,i);return h&&o(h)?l(h):c&&h?a(c.end+1,h.start+1):c?a(c.start+1,c.end+1):h?a(h.start+1,h.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=Xi._moveWordPartLeft(e,i);return new G(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const r=e.charAt(n);if(r!==" "&&r!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,r=this._findFirstNonWhitespaceChar(i,n);return n+1<r?new G(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;const a=new J(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;const h=n.getLineCount(),d=n.getLineMaxColumn(l);if(l===h&&c===d)return null;if(o){const p=this._deleteWordRightWhitespace(n,a);if(p)return p}let g=Xi._findNextWordOnLine(i,n,a);return t===2?g?c=g.end+1:c<d||l===h?c=d:(l++,g=Xi._findNextWordOnLine(i,n,new J(l,1)),g?c=g.start+1:c=n.getLineMaxColumn(l)):(g&&c>=g.start+1&&(g=Xi._findNextWordOnLine(i,n,new J(l,g.end+1))),g?c=g.start+1:c<d||l===h?c=d:(l++,g=Xi._findNextWordOnLine(i,n,new J(l,1)),g?c=g.start+1:c=n.getLineMaxColumn(l))),new G(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=Xi._moveWordPartRight(e,i);return new G(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new G(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){const r=x1(t,i),o=Xi._findPreviousWordOnLine(r,e,n);if(o&&o.wordType===1&&o.start<=n.column-1&&n.column-1<=o.end)return Xi._createWordAtPosition(e,n.lineNumber,o);const a=Xi._findNextWordOnLine(r,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?Xi._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,r){const o=x1(e.wordSeparators,e.wordSegmenterLocales),a=Xi._findPreviousWordOnLine(o,t,r),l=Xi._findNextWordOnLine(o,t,r);if(!n){let p,_;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end||a&&a.wordType===2&&a.start<=r.column-1&&r.column-1<a.end?(p=a.start+1,_=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end||l&&l.wordType===2&&l.start<=r.column-1&&r.column-1<l.end?(p=l.start+1,_=l.end+1):(a?p=a.end+1:p=1,l?_=l.start+1:_=t.getLineMaxColumn(r.lineNumber)),new es(new G(r.lineNumber,p,r.lineNumber,_),1,0,new J(r.lineNumber,_),0)}let c,h;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(c=a.start+1,h=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(c=l.start+1,h=l.end+1):(c=r.column,h=r.column);const d=r.lineNumber;let g;if(i.selectionStart.containsPosition(r))g=i.selectionStart.endColumn;else if(r.isBeforeOrEqual(i.selectionStart.getStartPosition())){g=c;const p=new J(d,g);i.selectionStart.containsPosition(p)&&(g=i.selectionStart.endColumn)}else{g=h;const p=new J(d,g);i.selectionStart.containsPosition(p)&&(g=i.selectionStart.startColumn)}return i.move(!0,d,g,0)}}class Ms{static addCursorDown(e,t,i){const n=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];n[r++]=new wt(l.modelState,l.viewState),i?n[r++]=wt.fromModelState(Ht.translateDown(e.cursorConfig,e.model,l.modelState)):n[r++]=wt.fromViewState(Ht.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){const n=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];n[r++]=new wt(l.modelState,l.viewState),i?n[r++]=wt.fromModelState(Ht.translateUp(e.cursorConfig,e.model,l.modelState)):n[r++]=wt.fromViewState(Ht.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,r=t.modelState.position.column,o=n===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!o&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return wt.fromViewState(Ht.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return wt.fromModelState(Ht.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=this._moveToLineEnd(e,l,i,n)}return r}static _moveToLineEnd(e,t,i,n){const r=t.viewState.position,o=e.getLineMaxColumn(r.lineNumber),a=r.column===o,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),h=o-r.column===c-l.column;return a||h?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return wt.fromViewState(Ht.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return wt.fromModelState(Ht.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,r=t.length;n<r;n++){const o=t[n],a=o.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=o.modelState.selection.endLineNumber,h;c===l?h=e.model.getLineMaxColumn(l):(c++,h=1),i[n]=wt.fromModelState(new es(new G(a,1,a,1),0,0,new J(c,h),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=wt.fromModelState(Ht.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=wt.fromModelState(Ht.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return wt.fromModelState(new es(new G(1,1,1,1),0,0,new J(i,n),0))}static line(e,t,i,n,r){const o=e.model.validatePosition(n),a=r?e.coordinatesConverter.validateViewPosition(new J(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!i){const c=e.model.getLineCount();let h=o.lineNumber+1,d=1;return h>c&&(h=c,d=e.model.getLineMaxColumn(h)),wt.fromModelState(new es(new G(o.lineNumber,1,h,d),2,0,new J(h,d),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<l)return wt.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(o.lineNumber>l){const c=e.getLineCount();let h=a.lineNumber+1,d=1;return h>c&&(h=c,d=e.getLineMaxColumn(h)),wt.fromViewState(t.viewState.move(!0,h,d,0))}else{const c=t.modelState.selectionStart.getEndPosition();return wt.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,n){const r=e.model.validatePosition(n);return wt.fromModelState(Xi.word(e.cursorConfig,e.model,t.modelState,i,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new wt(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return wt.fromViewState(new es(new G(i,n,i,n),0,0,new J(i,n),0))}static moveTo(e,t,i,n,r){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,r)}const o=e.model.validatePosition(n),a=r?e.coordinatesConverter.validateViewPosition(new J(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return wt.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,r,o){switch(i){case 0:return o===4?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,r);case 1:return o===4?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,r);case 2:return o===2?this._moveUpByViewLines(e,t,n,r):this._moveUpByModelLines(e,t,n,r);case 3:return o===2?this._moveDownByViewLines(e,t,n,r):this._moveDownByModelLines(e,t,n,r);case 4:return o===2?t.map(a=>wt.fromViewState(Ht.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>wt.fromModelState(Ht.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 5:return o===2?t.map(a=>wt.fromViewState(Ht.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>wt.fromModelState(Ht.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,r){const o=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(o);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 14:{const l=[];for(let c=0,h=t.length;c<h;c++){const d=t[c];l[c]=this.findPositionInViewportIfOutside(e,d,o,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const r=t.viewState.position.lineNumber;if(i.startLineNumber<=r&&r<=i.endLineNumber-1)return new wt(t.modelState,t.viewState);{let o;r>i.endLineNumber-1?o=i.endLineNumber-1:r<i.startLineNumber?o=i.startLineNumber:o=r;const a=Ht.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,o,!1);return wt.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(r=>{const a=e.getTextDirection(r.viewState.position.lineNumber)===xo.RTL;return wt.fromViewState(a?Ht.moveRight(e.cursorConfig,e,r.viewState,i,n):Ht.moveLeft(e.cursorConfig,e,r.viewState,i,n))})}static _moveHalfLineLeft(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[r]=wt.fromViewState(Ht.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveRight(e,t,i,n){return t.map(r=>{const a=e.getTextDirection(r.viewState.position.lineNumber)===xo.RTL;return wt.fromViewState(a?Ht.moveLeft(e.cursorConfig,e,r.viewState,i,n):Ht.moveRight(e.cursorConfig,e,r.viewState,i,n))})}static _moveHalfLineRight(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[r]=wt.fromViewState(Ht.moveRight(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveDownByViewLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=wt.fromViewState(Ht.moveDown(e.cursorConfig,e,l.viewState,i,n))}return r}static _moveDownByModelLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=wt.fromModelState(Ht.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return r}static _moveUpByViewLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=wt.fromViewState(Ht.moveUp(e.cursorConfig,e,l.viewState,i,n))}return r}static _moveUpByModelLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=wt.fromModelState(Ht.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return r}static _moveToViewPosition(e,t,i,n,r){return wt.fromViewState(t.viewState.move(i,n,r,0))}static _moveToModelPosition(e,t,i,n,r){return wt.fromModelState(t.modelState.move(i,n,r,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}}var Ok;(function(s){const e=function(i){if(!ar(i))return!1;const n=i;return!(!ns(n.to)||!yo(n.select)&&!aM(n.select)||!yo(n.by)&&!ns(n.by)||!yo(n.value)&&!Cm(n.value)||!yo(n.noHistory)&&!aM(n.noHistory))};s.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
					* 'noHistory': If 'true' does not add the movement to navigation history. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1},noHistory:{type:"boolean",default:!1}}}}]},s.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let n;switch(i.to){case s.RawDirection.Left:n=0;break;case s.RawDirection.Right:n=1;break;case s.RawDirection.Up:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.PrevBlankLine:n=4;break;case s.RawDirection.NextBlankLine:n=5;break;case s.RawDirection.WrappedLineStart:n=6;break;case s.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case s.RawDirection.WrappedLineColumnCenter:n=8;break;case s.RawDirection.WrappedLineEnd:n=9;break;case s.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case s.RawDirection.ViewPortTop:n=11;break;case s.RawDirection.ViewPortBottom:n=13;break;case s.RawDirection.ViewPortCenter:n=12;break;case s.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let r=0;switch(i.by){case s.RawUnit.Line:r=1;break;case s.RawUnit.WrappedLine:r=2;break;case s.RawUnit.Character:r=3;break;case s.RawUnit.HalfLine:r=4;break}return{direction:n,unit:r,select:!!i.select,value:i.value||1,noHistory:!!i.noHistory}}s.parse=t})(Ok||(Ok={}));class rSe{constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new TJ(e,i)}shouldIncrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}}class H7{constructor(e,t){this.model=e,this.indentationLineProcessor=new TJ(e,t)}getProcessedTokenContextAroundRange(e){const t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);const t=this.model.tokenization.getLineTokens(e.startLineNumber),i=ug(t,e.startColumn-1);let n;if(W7(this.model,e.getStartPosition())){const o=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+o;n=t.sliceAndInflate(a,l,0)}else{const o=e.startColumn-1;n=t.sliceAndInflate(0,o,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){const t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);const i=this.model.tokenization.getLineTokens(t.lineNumber),n=ug(i,t.column-1),r=t.column-1-n.firstCharOffset,o=n.firstCharOffset+r,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(o,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){const t=p=>{this.model.tokenization.forceTokenization(p);const _=this.model.tokenization.getLineTokens(p),b=this.model.getLineMaxColumn(p)-1;return ug(_,b)};this.model.tokenization.forceTokenization(e.startLineNumber);const i=this.model.tokenization.getLineTokens(e.startLineNumber),n=ug(i,e.startColumn-1),r=Rn.createEmpty("",n.languageIdCodec),o=e.startLineNumber-1;if(o===0||!(n.firstCharOffset===0))return r;const c=t(o);if(!(n.languageId===c.languageId))return r;const d=c.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(d)}}class TJ{constructor(e,t){this.model=e,this.languageConfigurationService=t}getProcessedLine(e,t){var o,a;const i=(l,c)=>{const h=sr(l);return c+l.substring(h.length)};(a=(o=this.model.tokenization).forceTokenization)==null||a.call(o,e);const n=this.model.tokenization.getLineTokens(e);let r=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(r=i(r,t)),r}getProcessedTokens(e){const t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),o=[];return e.forEach(l=>{const c=e.getStandardTokenType(l);let h=e.getTokenText(l);t(c)&&(h=h.replace(r,""));const d=e.getMetadata(l);o.push({text:h,metadata:d})}),Rn.createFromTextAndMetadata(o,e.languageIdCodec)}}function W7(s,e){s.tokenization.forceTokenization(e.lineNumber);const t=s.tokenization.getLineTokens(e.lineNumber),i=ug(t,e.column-1),n=i.firstCharOffset===0,r=t.getLanguageId(0)===i.languageId;return!n&&!r}function z7(s,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);const n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=i.getLanguageConfiguration(n);if(!r)return null;const a=new H7(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),c=a.beforeRangeProcessedTokens.getLineContent(),h=a.afterRangeProcessedTokens.getLineContent(),d=r.onEnter(s,l,c,h);if(!d)return null;const g=d.indentAction;let p=d.appendText;const _=d.removeText||0;p?g===cr.Indent&&(p="	"+p):g===cr.Indent||g===cr.IndentOutdent?p="	":p="";let b=NZ(e,t.startLineNumber,t.startColumn);return _&&(b=b.substring(0,b.length-_)),{indentAction:g,appendText:p,removeText:_,indentation:b}}var oSe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},aSe=function(s,e){return function(t,i){e(t,i,s)}},Jx;const ER=Object.create(null);function gf(s,e){if(e<=0)return"";ER[s]||(ER[s]=["",s]);const t=ER[s];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+s;return t[e]}let dm=Jx=class{static unshiftIndent(e,t,i,n,r){const o=Ai.visibleColumnFromColumn(e,t,i);if(r){const a=gf(" ",n),c=Ai.prevIndentTabStop(o,n)/n;return gf(a,c)}else{const c=Ai.prevRenderTabStop(o,i)/i;return gf("	",c)}}static shiftIndent(e,t,i,n,r){const o=Ai.visibleColumnFromColumn(e,t,i);if(r){const a=gf(" ",n),c=Ai.nextIndentTabStop(o,n)/n;return gf(a,c)}else{const c=Ai.nextRenderTabStop(o,i)/i;return gf("	",c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);const{tabSize:r,indentSize:o,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,h=0;for(let d=i;d<=n;d++,c=h){h=0;const g=e.getLineContent(d);let p=qr(g);if(this._opts.isUnshift&&(g.length===0||p===0)||!l&&!this._opts.isUnshift&&g.length===0)continue;if(p===-1&&(p=g.length),d>1&&Ai.visibleColumnFromColumn(g,p+1,r)%o!==0&&e.tokenization.isCheapToTokenize(d-1)){const C=z7(this._opts.autoIndent,e,new G(d-1,e.getLineMaxColumn(d-1),d-1,e.getLineMaxColumn(d-1)),this._languageConfigurationService);if(C){if(h=c,C.appendText)for(let x=0,S=C.appendText.length;x<S&&h<o&&C.appendText.charCodeAt(x)===32;x++)h++;C.removeText&&(h=Math.max(0,h-C.removeText));for(let x=0;x<h&&!(p===0||g.charCodeAt(p-1)!==32);x++)p--}}if(this._opts.isUnshift&&p===0)continue;let _;this._opts.isUnshift?_=Jx.unshiftIndent(g,p+1,r,o,a):_=Jx.shiftIndent(g,p+1,r,o,a),this._addEditOperation(t,new G(d,1,d,p+1),_),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=p+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?gf(" ",o):"	";for(let h=i;h<=n;h++){const d=e.getLineContent(h);let g=qr(d);if(!(this._opts.isUnshift&&(d.length===0||g===0))&&!(!l&&!this._opts.isUnshift&&d.length===0)&&(g===-1&&(g=d.length),!(this._opts.isUnshift&&g===0)))if(this._opts.isUnshift){g=Math.min(g,o);for(let p=0;p<g;p++)if(d.charCodeAt(p)===9){g=p+1;break}this._addEditOperation(t,new G(h,1,h,g+1),"")}else this._addEditOperation(t,new G(h,1,h,1),c),h===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const n=t.getInverseEditOperations()[0];return new Lt(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new Lt(i.startLineNumber,n,i.endLineNumber,i.endColumn):new Lt(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};dm=Jx=oSe([aSe(2,kc)],dm);class lSe{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new G(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new G(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection||null)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,r=i[1].range;return new Lt(n.endLineNumber,n.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}}class cSe{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new G(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new Lt(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}function uSe(s,e,t){const i=s.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,r=-1;for(n=e-1;n>=1;n--){if(s.tokenization.getLanguageIdAtPosition(n,0)!==i)return r;const o=s.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(o)||o===""){r=n;continue}return n}}return-1}function Pk(s,e,t,i=!0,n){if(s<4)return null;const r=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;const o=new rSe(e,r,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const a=uSe(e,t,o);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(o.shouldIncrease(a)||o.shouldIndentNextLine(a)){const l=e.getLineContent(a);return{indentation:sr(l),action:cr.Indent,line:a}}else if(o.shouldDecrease(a)){const l=e.getLineContent(a);return{indentation:sr(l),action:null,line:a}}else{if(a===1)return{indentation:sr(e.getLineContent(a)),action:null,line:a};const l=a-1,c=r.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let h=0;for(let d=l-1;d>0;d--)if(!o.shouldIndentNextLine(d)){h=d;break}return{indentation:sr(e.getLineContent(h+1)),action:null,line:h+1}}if(i)return{indentation:sr(e.getLineContent(a)),action:null,line:a};for(let h=a;h>0;h--){if(o.shouldIncrease(h))return{indentation:sr(e.getLineContent(h)),action:cr.Indent,line:h};if(o.shouldIndentNextLine(h)){let d=0;for(let g=h-1;g>0;g--)if(!o.shouldIndentNextLine(h)){d=g;break}return{indentation:sr(e.getLineContent(d+1)),action:null,line:d+1}}else if(o.shouldDecrease(h))return{indentation:sr(e.getLineContent(h)),action:null,line:h}}return{indentation:sr(e.getLineContent(1)),action:null,line:1}}}function hSe(s,e,t,i,n){if(s<4)return null;const r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=n.getLanguageConfiguration(r).indentRulesSupport;if(!o)return null;e.tokenization.forceTokenization(t.startLineNumber);const l=new H7(e,n).getProcessedTokenContextAroundRange(t),c=l.afterRangeProcessedTokens,h=l.beforeRangeProcessedTokens,d=sr(h.getLineContent()),g=fSe(e,t.startLineNumber,h),p=W7(e,t.getStartPosition()),_=e.getLineContent(t.startLineNumber),b=sr(_),C=Pk(s,g,t.startLineNumber+1,void 0,n);if(!C){const S=p?b:d;return{beforeEnter:S,afterEnter:S}}let x=p?b:C.indentation;return C.action===cr.Indent&&(x=i.shiftIndent(x)),o.shouldDecrease(c.getLineContent())&&(x=i.unshiftIndent(x)),{beforeEnter:p?b:d,afterEnter:x}}function dSe(s,e,t,i,n,r){const o=s.autoIndent;if(o<4||W7(e,t.getStartPosition()))return null;const l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),c=r.getLanguageConfiguration(l).indentRulesSupport;if(!c)return null;const d=new H7(e,r).getProcessedTokenContextAroundRange(t),g=d.beforeRangeProcessedTokens.getLineContent(),p=d.afterRangeProcessedTokens.getLineContent(),_=g+p,b=g+i+p;if(!c.shouldDecrease(_)&&c.shouldDecrease(b)){const x=Pk(o,e,t.startLineNumber,!1,r);if(!x)return null;let S=x.indentation;return x.action!==cr.Indent&&(S=n.unshiftIndent(S)),S}const C=t.startLineNumber-1;if(C>0){const x=e.getLineContent(C);if(c.shouldIndentNextLine(x)&&c.shouldIncrease(b)){const S=Pk(o,e,t.startLineNumber,!1,r),y=S==null?void 0:S.indentation;if(y!==void 0){const k=e.getLineContent(t.startLineNumber),D=sr(k),N=n.shiftIndent(y)===D,A=/^\s*$/.test(_),M=s.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),V=M&&M.length>0&&A;if(N&&V)return y}}}return null}function fSe(s,e,t){return{tokenization:{getLineTokens:n=>n===e?t:s.tokenization.getLineTokens(n),getLanguageId:()=>s.getLanguageId(),getLanguageIdAtPosition:(n,r)=>s.getLanguageIdAtPosition(n,r)},getLineContent:n=>n===e?t.getLineContent():s.getLineContent(n)}}class gSe{static getEdits(e,t,i,n,r){if(!r&&this._isAutoIndentType(e,t,i)){const o=[];for(const l of i){const c=this._findActualIndentationForSelection(e,t,l,n);if(c===null)return;o.push({selection:l,indentation:c})}const a=C5.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,o,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,r=i.length;n<r;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){const r=dSe(e,t,i,n,{shiftIndent:a=>$7(e,a),unshiftIndent:a=>Fk(e,a)},e.languageConfigurationService);if(r===null)return null;const o=NZ(t,i.startLineNumber,i.startColumn);return r===e.normalizeIndentation(o)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,r){const o=i.map(({selection:l,indentation:c})=>{if(r!==null){const h=this._getEditFromIndentationAndSelection(e,t,c,l,n,!1);return new LSe(h,l,n,r)}else{const h=this._getEditFromIndentationAndSelection(e,t,c,l,n,!0);return kf(h.range,h.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new gr(4,o,a)}static _getEditFromIndentationAndSelection(e,t,i,n,r,o=!0){const a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a);let c=e.normalizeIndentation(i);if(l!==0){const d=t.getLineContent(a);c+=d.substring(l-1,n.startColumn-1)}return c+=o?r:"",{range:new G(a,1,n.endLineNumber,n.endColumn),text:c}}}class mSe{static getEdits(e,t,i,n,r,o){if(IJ(t,i,n,r,o))return this._runAutoClosingOvertype(e,n,o)}static _runAutoClosingOvertype(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const l=t[r].getPosition(),c=new G(l.lineNumber,l.column,l.lineNumber,l.column+1);n[r]=new Wr(c,i)}return new gr(4,n,{shouldPushStackElementBefore:WD(e,4),shouldPushStackElementAfter:!1})}}class pSe{static getEdits(e,t,i,n,r){if(IJ(e,t,i,n,r)){const o=i.map(a=>new Wr(new G(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new gr(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class C5{static getEdits(e,t,i,n,r,o){if(!o){const a=this.getAutoClosingPairClose(e,t,i,n,r);if(a!==null)return this._runAutoClosingOpenCharType(i,n,r,a)}}static _runAutoClosingOpenCharType(e,t,i,n){const r=[];for(let o=0,a=e.length;o<a;o++){const l=e[o];r[o]=new xSe(l,t,!i,n)}return new gr(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,r){for(const _ of i)if(!_.isEmpty())return null;const o=i.map(_=>{const b=_.getPosition();return r?{lineNumber:b.lineNumber,beforeColumn:b.column-n.length,afterColumn:b.column}:{lineNumber:b.lineNumber,beforeColumn:b.column,afterColumn:b.column}}),a=this._findAutoClosingPairOpen(e,t,o.map(_=>new J(_.lineNumber,_.beforeColumn)),n);if(!a)return null;let l,c;if(Od(n)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const d=this._findContainedAutoClosingPair(e,a),g=d?d.close:"";let p=!0;for(const _ of o){const{lineNumber:b,beforeColumn:C,afterColumn:x}=_,S=t.getLineContent(b),y=S.substring(0,C-1),k=S.substring(x-1);if(k.startsWith(g)||(p=!1),k.length>0){const A=k.charAt(0);if(!this._isBeforeClosingBrace(e,k)&&!c(A))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){const A=x1(e.wordSeparators,[]);if(y.length>0){const M=y.charCodeAt(y.length-1);if(A.get(M)===0)return null}}if(!t.tokenization.isCheapToTokenize(b))return null;t.tokenization.forceTokenization(b);const D=t.tokenization.getLineTokens(b),R=ug(D,C-1);if(!a.shouldAutoClose(R,C-R.firstCharOffset))return null;const N=a.findNeutralCharacter();if(N){const A=t.tokenization.getTokenTypeIfInsertingCharacter(b,C,N);if(!a.isOK(A))return null}}return p?a.close.substring(0,a.close.length-g.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let r=null;for(const o of n)o.open!==t.open&&t.open.includes(o.open)&&t.close.endsWith(o.close)&&(!r||o.open.length>r.open.length)&&(r=o);return r}static _findAutoClosingPairOpen(e,t,i,n){const r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!r)return null;let o=null;for(const a of r)if(o===null||a.open.length>o.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new G(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+n!==a.open){l=!1;break}l&&(o=a)}return o}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],o=n.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!o&&a}}class ej{static getEdits(e,t){if(!(e.inputMode==="overtype"))return null;const n=t.map(r=>new nSe(r.insertedTextRange));return new gr(4,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}class _Se{static getEdits(e,t,i,n,r){if(!r&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=e.surroundingPairs[i];n[r]=new lSe(a,i,l)}return new gr(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!RJ(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const r=Od(n);for(const o of i){if(o.isEmpty())return!1;let a=!0;for(let l=o.startLineNumber;l<=o.endLineNumber;l++){const c=t.getLineContent(l),h=l===o.startLineNumber?o.startColumn-1:0,d=l===o.endLineNumber?o.endColumn-1:c.length,g=c.substring(h,d);if(/[^ \t]/.test(g)){a=!1;break}}if(a)return!1;if(r&&o.startLineNumber===o.endLineNumber&&o.startColumn+1===o.endColumn){const l=t.getValueInRange(o);if(Od(l))return!1}}return!0}}class bSe{static getEdits(e,t,i,n,r,o){if(!o&&this._isTypeInterceptorElectricChar(t,i,n)){const a=this._typeInterceptorElectricChar(e,t,i,n[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,r){if(!t.electricChars.hasOwnProperty(r)||!n.isEmpty())return null;const o=n.getPosition();i.tokenization.forceTokenization(o.lineNumber);const a=i.tokenization.getLineTokens(o.lineNumber);let l;try{l=t.onElectricCharacter(r,a,o.column)}catch(c){return $t(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,h=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:o.lineNumber,column:c},500);if(h){if(h.startLineNumber===o.lineNumber)return null;const d=i.getLineContent(h.startLineNumber),g=sr(d),p=t.normalizeIndentation(g),_=i.getLineContent(o.lineNumber),b=i.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,C=_.substring(b-1,o.column-1),x=p+C+r,S=new G(o.lineNumber,1,o.lineNumber,o.column),y=new Wr(S,x);return new gr(j7(x,e),[y],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class wSe{static getEdits(e,t,i,n,r){const o=[];for(let l=0,c=i.length;l<c;l++){const h=e.inputMode==="overtype"&&!r?v5:Wr;o[l]=new h(i[l],n)}const a=j7(n,t);return new gr(a,o,{shouldPushStackElementBefore:WD(t,a),shouldPushStackElementAfter:!1})}}class NJ{static getEdits(e,t,i,n,r){if(!r&&n===`
`){const o=[];for(let a=0,l=i.length;a<l;a++)o[a]=this._enter(e,t,!1,i[a]);return new gr(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return kf(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(n.startLineNumber),c=sr(l).substring(0,n.startColumn-1);return kf(n,`
`+e.normalizeIndentation(c),i)}const r=z7(e.autoIndent,t,n,e.languageConfigurationService);if(r){if(r.indentAction===cr.None)return kf(n,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===cr.Indent)return kf(n,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===cr.IndentOutdent){const l=e.normalizeIndentation(r.indentation),c=e.normalizeIndentation(r.indentation+r.appendText),h=`
`+c+`
`+l;return i?new Zx(n,h,!0):new Mk(n,h,-1,c.length-l.length,!0)}else if(r.indentAction===cr.Outdent){const l=Fk(e,r.indentation);return kf(n,`
`+e.normalizeIndentation(l+r.appendText),i)}}const o=t.getLineContent(n.startLineNumber),a=sr(o).substring(0,n.startColumn-1);if(e.autoIndent>=4){const l=hSe(e.autoIndent,t,n,{unshiftIndent:c=>Fk(e,c),shiftIndent:c=>$7(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,n.getEndPosition());const h=n.endColumn,d=t.getLineContent(n.endLineNumber),g=qr(d);if(g>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,g+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new Zx(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let p=0;return h<=g+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),p=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Mk(n,`
`+e.normalizeIndentation(l.afterEnter),0,p,!0)}}}return kf(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++){let a=i[r].positionLineNumber;if(a===1)n[r]=new Zx(new G(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);n[r]=this._enter(e,t,!1,new G(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].positionLineNumber,l=t.getLineMaxColumn(a);n[r]=this._enter(e,t,!1,new G(a,l,a,l))}return n}static lineBreakInsert(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=this._enter(e,t,!0,i[r]);return n}}class vSe{static getEdits(e,t,i,n,r,o){const a=this._distributePasteToCursors(e,i,n,r,o);return a?(i=i.sort(G.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,r)}static _distributePasteToCursors(e,t,i,n,r){if(n||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));const o=K1(i);if(o.length===t.length)return o}return null}static _distributedPaste(e,t,i,n){const r=[];for(let o=0,a=i.length;o<a;o++){const c=e.overtypeOnPaste&&e.inputMode==="overtype"?v5:Wr;r[o]=new c(i[o],n[o])}return new gr(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,r){const o=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],h=c.getPosition();if(r&&!c.isEmpty()&&(r=!1),r&&n.indexOf(`
`)!==n.length-1&&(r=!1),r){const d=new G(h.lineNumber,1,h.lineNumber,1);o[a]=new sSe(d,n,c,!0)}else{const g=e.overtypeOnPaste&&e.inputMode==="overtype"?v5:Wr;o[a]=new g(c,n)}}return new gr(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class CSe{static getEdits(e,t,i,n,r,o,a,l){const c=n.map(h=>this._compositionType(i,h,r,o,a,l));return new gr(4,c,{shouldPushStackElementBefore:WD(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,r,o){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-n),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),h=new G(a.lineNumber,l,a.lineNumber,c);return new Mk(h,i,0,o)}}class ySe{static getEdits(e,t,i){const n=[];for(let o=0,a=t.length;o<a;o++)n[o]=new Wr(t[o],i);const r=j7(i,e);return new gr(r,n,{shouldPushStackElementBefore:WD(e,r),shouldPushStackElementAfter:!1})}}class SSe{static getCommands(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const h=e.normalizeIndentation(c);if(!l.startsWith(h)){n[r]=new Wr(new G(a.startLineNumber,1,a.startLineNumber,l.length+1),h,!0);continue}}n[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[r]=new dm(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,r="";const o=Pk(e.autoIndent,t,i,!1,e.languageConfigurationService);if(o)n=o.action,r=o.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const h=t.getLineContent(a);if(Sm(h)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=z7(e.autoIndent,t,new G(a,l,a,l),e.languageConfigurationService);c&&(r=c.indentation+c.appendText)}return n&&(n===cr.Indent&&(r=$7(e,r)),n===cr.Outdent&&(r=Fk(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,i,n){let r="";const o=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,o),l=e.indentSize,c=l-a%l;for(let h=0;h<c;h++)r+=" "}else r="	";return new Wr(i,r,n)}}class U7 extends Mk{constructor(e,t,i,n,r,o){super(e,t,i,n),this._openCharacter=r,this._closeCharacter=o,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new G(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new G(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}}class xSe extends U7{constructor(e,t,i,n){const r=(i?t:"")+n,o=0,a=-n.length;super(e,r,o,a,t,n)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}}class LSe extends U7{constructor(e,t,i,n){const r=i+n,o=0,a=i.length;super(t,r,o,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");const n=i[0].range,r=i[1].range,o=n.plusRange(r);return this._computeCursorStateWithRange(e,o,t)}}function j7(s,e){return s===" "?e===5||e===6?6:5:4}function WD(s,e){return ij(s)&&!ij(e)?!0:s===5?!1:tj(s)!==tj(e)}function tj(s){return s===6||s===5?"space":s}function ij(s){return s===4||s===5||s===6}function IJ(s,e,t,i,n){if(s.autoClosingOvertype==="never"||!s.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(!a.isEmpty())return!1;const l=a.getPosition(),c=e.getLineContent(l.lineNumber);if(c.charAt(l.column-1)!==n)return!1;const d=Od(n);if((l.column>2?c.charCodeAt(l.column-2):0)===92&&d)return!1;if(s.autoClosingOvertype==="auto"){let p=!1;for(let _=0,b=i.length;_<b;_++){const C=i[_];if(l.lineNumber===C.startLineNumber&&l.column===C.startColumn){p=!0;break}}if(!p)return!1}}return!0}function kf(s,e,t){return t?new Zx(s,e,!0):new Wr(s,e,!0)}function $7(s,e,t){return t=t||1,dm.shiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function Fk(s,e,t){return t=t||1,dm.unshiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function RJ(s,e){return Od(e)?s.autoSurround==="quotes"||s.autoSurround==="languageDefined":s.autoSurround==="brackets"||s.autoSurround==="languageDefined"}class Wf{static indent(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=new dm(i[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=new dm(i[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static paste(e,t,i,n,r,o){return vSe.getEdits(e,t,i,n,r,o)}static tab(e,t,i){return SSe.getCommands(e,t,i)}static compositionType(e,t,i,n,r,o,a,l){return CSe.getEdits(e,t,i,n,r,o,a,l)}static compositionEndWithInterceptors(e,t,i,n,r,o){if(!n)return null;let a=null;for(const g of n)if(a===null)a=g.insertedText;else if(a!==g.insertedText)return null;if(!a||a.length!==1)return ej.getEdits(t,n);const l=a;let c=!1;for(const g of n)if(g.deletedText.length!==0){c=!0;break}if(c){if(!RJ(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const g=Od(l);for(const b of n)if(b.deletedSelectionStart!==0||b.deletedSelectionEnd!==b.deletedText.length||/^[ \t]+$/.test(b.deletedText)||g&&Od(b.deletedText))return null;const p=[];for(const b of r){if(!b.isEmpty())return null;p.push(b.getPosition())}if(p.length!==n.length)return null;const _=[];for(let b=0,C=p.length;b<C;b++)_.push(new cSe(p[b],n[b].deletedText,t.surroundingPairs[l]));return new gr(4,_,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const h=pSe.getEdits(t,i,r,o,l);if(h!==void 0)return h;const d=C5.getEdits(t,i,r,l,!0,!1);return d!==void 0?d:ej.getEdits(t,n)}static typeWithInterceptors(e,t,i,n,r,o,a){const l=NJ.getEdits(i,n,r,a,e);if(l!==void 0)return l;const c=gSe.getEdits(i,n,r,a,e);if(c!==void 0)return c;const h=mSe.getEdits(t,i,n,r,o,a);if(h!==void 0)return h;const d=C5.getEdits(i,n,r,a,!1,e);if(d!==void 0)return d;const g=_Se.getEdits(i,n,r,a,e);if(g!==void 0)return g;const p=bSe.getEdits(t,i,n,r,a,e);return p!==void 0?p:wSe.getEdits(i,t,r,a,e)}static typeWithoutInterceptors(e,t,i,n,r){return ySe.getEdits(e,n,r)}}class kSe{constructor(e,t,i,n,r,o,a){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=n,this.insertedSelectionStart=r,this.insertedSelectionEnd=o,this.insertedTextRange=a}}var Oe;(function(s){s.editorSimpleInput=new He("editorSimpleInput",!1,!0),s.editorTextFocus=new He("editorTextFocus",!1,v(681,"Whether the editor text has focus (cursor is blinking)")),s.focus=new He("editorFocus",!1,v(682,"Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),s.textInputFocus=new He("textInputFocus",!1,v(683,"Whether an editor or a rich text input has focus (cursor is blinking)")),s.readOnly=new He("editorReadonly",!1,v(684,"Whether the editor is read-only")),s.inDiffEditor=new He("inDiffEditor",!1,v(685,"Whether the context is a diff editor")),s.isEmbeddedDiffEditor=new He("isEmbeddedDiffEditor",!1,v(686,"Whether the context is an embedded diff editor")),s.inMultiDiffEditor=new He("inMultiDiffEditor",!1,v(687,"Whether the context is a multi diff editor")),s.multiDiffEditorAllCollapsed=new He("multiDiffEditorAllCollapsed",void 0,v(688,"Whether all files in multi diff editor are collapsed")),s.hasChanges=new He("diffEditorHasChanges",!1,v(689,"Whether the diff editor has changes")),s.comparingMovedCode=new He("comparingMovedCode",!1,v(690,"Whether a moved code block is selected for comparison")),s.accessibleDiffViewerVisible=new He("accessibleDiffViewerVisible",!1,v(691,"Whether the accessible diff viewer is visible")),s.diffEditorRenderSideBySideInlineBreakpointReached=new He("diffEditorRenderSideBySideInlineBreakpointReached",!1,v(692,"Whether the diff editor render side by side inline breakpoint is reached")),s.diffEditorInlineMode=new He("diffEditorInlineMode",!1,v(693,"Whether inline mode is active")),s.diffEditorOriginalWritable=new He("diffEditorOriginalWritable",!1,v(694,"Whether modified is writable in the diff editor")),s.diffEditorModifiedWritable=new He("diffEditorModifiedWritable",!1,v(695,"Whether modified is writable in the diff editor")),s.diffEditorOriginalUri=new He("diffEditorOriginalUri","",v(696,"The uri of the original document")),s.diffEditorModifiedUri=new He("diffEditorModifiedUri","",v(697,"The uri of the modified document")),s.columnSelection=new He("editorColumnSelection",!1,v(698,"Whether `editor.columnSelection` is enabled")),s.writable=s.readOnly.toNegated(),s.hasNonEmptySelection=new He("editorHasSelection",!1,v(699,"Whether the editor has text selected")),s.hasOnlyEmptySelection=s.hasNonEmptySelection.toNegated(),s.hasMultipleSelections=new He("editorHasMultipleSelections",!1,v(700,"Whether the editor has multiple selections")),s.hasSingleSelection=s.hasMultipleSelections.toNegated(),s.tabMovesFocus=new He("editorTabMovesFocus",!1,v(701,"Whether `Tab` will move focus out of the editor")),s.tabDoesNotMoveFocus=s.tabMovesFocus.toNegated(),s.isInEmbeddedEditor=new He("isInEmbeddedEditor",!1,!0),s.canUndo=new He("canUndo",!1,!0),s.canRedo=new He("canRedo",!1,!0),s.hoverVisible=new He("editorHoverVisible",!1,v(702,"Whether the editor hover is visible")),s.hoverFocused=new He("editorHoverFocused",!1,v(703,"Whether the editor hover is focused")),s.stickyScrollFocused=new He("stickyScrollFocused",!1,v(704,"Whether the sticky scroll is focused")),s.stickyScrollVisible=new He("stickyScrollVisible",!1,v(705,"Whether the sticky scroll is visible")),s.standaloneColorPickerVisible=new He("standaloneColorPickerVisible",!1,v(706,"Whether the standalone color picker is visible")),s.standaloneColorPickerFocused=new He("standaloneColorPickerFocused",!1,v(707,"Whether the standalone color picker is focused")),s.inCompositeEditor=new He("inCompositeEditor",void 0,v(708,"Whether the editor is part of a larger editor (e.g. notebooks)")),s.notInCompositeEditor=s.inCompositeEditor.toNegated(),s.languageId=new He("editorLangId","",v(709,"The language identifier of the editor")),s.hasCompletionItemProvider=new He("editorHasCompletionItemProvider",!1,v(710,"Whether the editor has a completion item provider")),s.hasCodeActionsProvider=new He("editorHasCodeActionsProvider",!1,v(711,"Whether the editor has a code actions provider")),s.hasCodeLensProvider=new He("editorHasCodeLensProvider",!1,v(712,"Whether the editor has a code lens provider")),s.hasDefinitionProvider=new He("editorHasDefinitionProvider",!1,v(713,"Whether the editor has a definition provider")),s.hasDeclarationProvider=new He("editorHasDeclarationProvider",!1,v(714,"Whether the editor has a declaration provider")),s.hasImplementationProvider=new He("editorHasImplementationProvider",!1,v(715,"Whether the editor has an implementation provider")),s.hasTypeDefinitionProvider=new He("editorHasTypeDefinitionProvider",!1,v(716,"Whether the editor has a type definition provider")),s.hasHoverProvider=new He("editorHasHoverProvider",!1,v(717,"Whether the editor has a hover provider")),s.hasDocumentHighlightProvider=new He("editorHasDocumentHighlightProvider",!1,v(718,"Whether the editor has a document highlight provider")),s.hasDocumentSymbolProvider=new He("editorHasDocumentSymbolProvider",!1,v(719,"Whether the editor has a document symbol provider")),s.hasReferenceProvider=new He("editorHasReferenceProvider",!1,v(720,"Whether the editor has a reference provider")),s.hasRenameProvider=new He("editorHasRenameProvider",!1,v(721,"Whether the editor has a rename provider")),s.hasSignatureHelpProvider=new He("editorHasSignatureHelpProvider",!1,v(722,"Whether the editor has a signature help provider")),s.hasInlayHintsProvider=new He("editorHasInlayHintsProvider",!1,v(723,"Whether the editor has an inline hints provider")),s.hasDocumentFormattingProvider=new He("editorHasDocumentFormattingProvider",!1,v(724,"Whether the editor has a document formatting provider")),s.hasDocumentSelectionFormattingProvider=new He("editorHasDocumentSelectionFormattingProvider",!1,v(725,"Whether the editor has a document selection formatting provider")),s.hasMultipleDocumentFormattingProvider=new He("editorHasMultipleDocumentFormattingProvider",!1,v(726,"Whether the editor has multiple document formatting providers")),s.hasMultipleDocumentSelectionFormattingProvider=new He("editorHasMultipleDocumentSelectionFormattingProvider",!1,v(727,"Whether the editor has multiple document selection formatting providers"))})(Oe||(Oe={}));const kt=0;class Fi extends lm{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var hs;(function(s){const e=function(i){if(!ar(i))return!1;const n=i;return!(!ns(n.to)||!yo(n.by)&&!ns(n.by)||!yo(n.value)&&!Cm(n.value)||!yo(n.revealCursor)&&!aM(n.revealCursor))};s.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},s.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let n;switch(i.to){case s.RawDirection.Up:n=1;break;case s.RawDirection.Right:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.Left:n=4;break;default:return null}let r;switch(i.by){case s.RawUnit.Line:r=1;break;case s.RawUnit.WrappedLine:r=2;break;case s.RawUnit.Page:r=3;break;case s.RawUnit.HalfPage:r=4;break;case s.RawUnit.Editor:r=5;break;case s.RawUnit.Column:r=6;break;default:r=2}const o=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:n,unit:r,value:o,revealCursor:a,select:!!i.select}}s.parse=t})(hs||(hs={}));var o_;(function(s){const e=function(t){if(!ar(t))return!1;const i=t;return!(!Cm(i.lineNumber)&&!ns(i.lineNumber)||!yo(i.at)&&!ns(i.at))};s.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},s.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(o_||(o_={}));class y5{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(In).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const n=Kn();return n&&gl(n)?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(In).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}var Hn;(function(s){class e extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){if(!y.position)return;S.model.pushStackElement(),S.setCursorStates(y.source,3,[Ms.moveTo(S,S.getPrimaryCursorState(),this._inSelectionMode,y.position,y.viewPosition)])&&y.revealType!==2&&S.revealAllCursors(y.source,!0,!0)}}s.MoveTo=ot(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),s.MoveToSelect=ot(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends Fi{runCoreEditorCommand(S,y){S.model.pushStackElement();const k=this._getColumnSelectResult(S,S.getPrimaryCursorState(),S.getCursorColumnSelectData(),y);k!==null&&(S.setCursorStates(y.source,3,k.viewStates.map(D=>wt.fromViewState(D))),S.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:k.fromLineNumber,fromViewVisualColumn:k.fromVisualColumn,toViewLineNumber:k.toLineNumber,toViewVisualColumn:k.toVisualColumn}),k.reversed?S.revealTopMostCursor(y.source):S.revealBottomMostCursor(y.source))}}s.ColumnSelect=ot(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(x,S,y,k){if(typeof k.position>"u"||typeof k.viewPosition>"u"||typeof k.mouseColumn>"u")return null;const D=x.model.validatePosition(k.position),R=x.coordinatesConverter.validateViewPosition(new J(k.viewPosition.lineNumber,k.viewPosition.column),D),N=k.doColumnSelect?y.fromViewLineNumber:R.lineNumber,A=k.doColumnSelect?y.fromViewVisualColumn:k.mouseColumn-1;return Hf.columnSelect(x.cursorConfig,x,N,A,R.lineNumber,k.mouseColumn-1)}}),s.CursorColumnSelectLeft=ot(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(x,S,y,k){return Hf.columnSelectLeft(x.cursorConfig,x,y)}}),s.CursorColumnSelectRight=ot(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(x,S,y,k){return Hf.columnSelectRight(x.cursorConfig,x,y)}});class i extends t{constructor(S){super(S),this._isPaged=S.isPaged}_getColumnSelectResult(S,y,k,D){return Hf.columnSelectUp(S.cursorConfig,S,k,this._isPaged)}}s.CursorColumnSelectUp=ot(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3600,linux:{primary:0}}})),s.CursorColumnSelectPageUp=ot(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends t{constructor(S){super(S),this._isPaged=S.isPaged}_getColumnSelectResult(S,y,k,D){return Hf.columnSelectDown(S.cursorConfig,S,k,this._isPaged)}}s.CursorColumnSelectDown=ot(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3602,linux:{primary:0}}})),s.CursorColumnSelectPageDown=ot(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3596,linux:{primary:0}}}));class r extends Fi{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Ok.metadata})}runCoreEditorCommand(S,y){const k=Ok.parse(y);k&&this._runCursorMove(S,y.source,k)}_runCursorMove(S,y,k){const D=k.noHistory?"api":y;S.model.pushStackElement(),S.setCursorStates(D,3,r._move(S,S.getCursorStates(),k)),S.revealAllCursors(D,!0)}static _move(S,y,k){const D=k.select,R=k.value;switch(k.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return Ms.simpleMove(S,y,k.direction,D,R,k.unit);case 11:case 13:case 12:case 14:return Ms.viewportMove(S,y,k.direction,D,R);default:return null}}}s.CursorMoveImpl=r,s.CursorMove=ot(new r);class o extends Fi{constructor(S){super(S),this._staticArgs=S.args}runCoreEditorCommand(S,y){let k=this._staticArgs;this._staticArgs.value===-1&&(k={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:y.pageSize||S.cursorConfig.pageSize}),S.model.pushStackElement(),S.setCursorStates(y.source,3,Ms.simpleMove(S,S.getCursorStates(),k.direction,k.select,k.value,k.unit)),S.revealAllCursors(y.source,!0)}}s.CursorLeft=ot(new o({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),s.CursorLeftSelect=ot(new o({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1039}})),s.CursorRight=ot(new o({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),s.CursorRightSelect=ot(new o({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1041}})),s.CursorUp=ot(new o({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),s.CursorUpSelect=ot(new o({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),s.CursorPageUp=ot(new o({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:11}})),s.CursorPageUpSelect=ot(new o({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1035}})),s.CursorDown=ot(new o({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),s.CursorDownSelect=ot(new o({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),s.CursorPageDown=ot(new o({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:12}})),s.CursorPageDownSelect=ot(new o({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1036}})),s.CreateCursor=ot(new class extends Fi{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(x,S){if(!S.position)return;let y;S.wholeLine?y=Ms.line(x,x.getPrimaryCursorState(),!1,S.position,S.viewPosition):y=Ms.moveTo(x,x.getPrimaryCursorState(),!1,S.position,S.viewPosition);const k=x.getCursorStates();if(k.length>1){const D=y.modelState?y.modelState.position:null,R=y.viewState?y.viewState.position:null;for(let N=0,A=k.length;N<A;N++){const M=k[N];if(!(D&&!M.modelState.selection.containsPosition(D))&&!(R&&!M.viewState.selection.containsPosition(R))){k.splice(N,1),x.model.pushStackElement(),x.setCursorStates(S.source,3,k);return}}}k.push(y),x.model.pushStackElement(),x.setCursorStates(S.source,3,k)}}),s.LastCursorMoveToSelect=ot(new class extends Fi{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(x,S){if(!S.position)return;const y=x.getLastAddedCursorIndex(),k=x.getCursorStates(),D=k.slice(0);D[y]=Ms.moveTo(x,k[y],!0,S.position,S.viewPosition),x.model.pushStackElement(),x.setCursorStates(S.source,3,D)}});class a extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){S.model.pushStackElement(),S.setCursorStates(y.source,3,Ms.moveToBeginningOfLine(S,S.getCursorStates(),this._inSelectionMode)),S.revealAllCursors(y.source,!0)}}s.CursorHome=ot(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),s.CursorHomeSelect=ot(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){S.model.pushStackElement(),S.setCursorStates(y.source,3,this._exec(S.getCursorStates())),S.revealAllCursors(y.source,!0)}_exec(S){const y=[];for(let k=0,D=S.length;k<D;k++){const R=S[k],N=R.modelState.position.lineNumber;y[k]=wt.fromModelState(R.modelState.move(this._inSelectionMode,N,1,0))}return y}}s.CursorLineStart=ot(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:0,mac:{primary:287}}})),s.CursorLineStartSelect=ot(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){S.model.pushStackElement(),S.setCursorStates(y.source,3,Ms.moveToEndOfLine(S,S.getCursorStates(),this._inSelectionMode,y.sticky||!1)),S.revealAllCursors(y.source,!0)}}s.CursorEnd=ot(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:kt,kbExpr:Oe.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:v(66,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),s.CursorEndSelect=ot(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:kt,kbExpr:Oe.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:v(67,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class h extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){S.model.pushStackElement(),S.setCursorStates(y.source,3,this._exec(S,S.getCursorStates())),S.revealAllCursors(y.source,!0)}_exec(S,y){const k=[];for(let D=0,R=y.length;D<R;D++){const N=y[D],A=N.modelState.position.lineNumber,M=S.model.getLineMaxColumn(A);k[D]=wt.fromModelState(N.modelState.move(this._inSelectionMode,A,M,0))}return k}}s.CursorLineEnd=ot(new h({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:0,mac:{primary:291}}})),s.CursorLineEndSelect=ot(new h({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:0,mac:{primary:1315}}}));class d extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){S.model.pushStackElement(),S.setCursorStates(y.source,3,Ms.moveToBeginningOfBuffer(S,S.getCursorStates(),this._inSelectionMode)),S.revealAllCursors(y.source,!0)}}s.CursorTop=ot(new d({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:2062,mac:{primary:2064}}})),s.CursorTopSelect=ot(new d({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3086,mac:{primary:3088}}}));class g extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){S.model.pushStackElement(),S.setCursorStates(y.source,3,Ms.moveToEndOfBuffer(S,S.getCursorStates(),this._inSelectionMode)),S.revealAllCursors(y.source,!0)}}s.CursorBottom=ot(new g({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:2061,mac:{primary:2066}}})),s.CursorBottomSelect=ot(new g({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:3085,mac:{primary:3090}}}));class p extends Fi{constructor(){super({id:"editorScroll",precondition:void 0,metadata:hs.metadata})}determineScrollMethod(S){const y=[6],k=[1,2,3,4,5,6],D=[4,2],R=[1,3];return y.includes(S.unit)&&D.includes(S.direction)?this._runHorizontalEditorScroll.bind(this):k.includes(S.unit)&&R.includes(S.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(S,y){const k=hs.parse(y);if(!k)return;const D=this.determineScrollMethod(k);D&&D(S,y.source,k)}_runVerticalEditorScroll(S,y,k){const D=this._computeDesiredScrollTop(S,k);if(k.revealCursor){const R=S.getCompletelyVisibleViewRangeAtScrollTop(D);S.setCursorStates(y,3,[Ms.findPositionInViewportIfOutside(S,S.getPrimaryCursorState(),R,k.select)])}S.viewLayout.setScrollPosition({scrollTop:D},0)}_computeDesiredScrollTop(S,y){if(y.unit===1){const R=S.viewLayout.getFutureViewport(),N=S.getCompletelyVisibleViewRangeAtScrollTop(R.top),A=S.coordinatesConverter.convertViewRangeToModelRange(N);let M;y.direction===1?M=Math.max(1,A.startLineNumber-y.value):M=Math.min(S.model.getLineCount(),A.startLineNumber+y.value);const O=S.coordinatesConverter.convertModelPositionToViewPosition(new J(M,1));return S.viewLayout.getVerticalOffsetForLineNumber(O.lineNumber)}if(y.unit===5){let R=0;return y.direction===3&&(R=S.model.getLineCount()-S.cursorConfig.pageSize),S.viewLayout.getVerticalOffsetForLineNumber(R)}let k;y.unit===3?k=S.cursorConfig.pageSize*y.value:y.unit===4?k=Math.round(S.cursorConfig.pageSize/2)*y.value:k=y.value;const D=(y.direction===1?-1:1)*k;return S.viewLayout.getCurrentScrollTop()+D*S.cursorConfig.lineHeight}_runHorizontalEditorScroll(S,y,k){const D=this._computeDesiredScrollLeft(S,k);S.viewLayout.setScrollPosition({scrollLeft:D},0)}_computeDesiredScrollLeft(S,y){const k=(y.direction===4?-1:1)*y.value;return S.viewLayout.getCurrentScrollLeft()+k*S.cursorConfig.typicalHalfwidthCharacterWidth}}s.EditorScrollImpl=p,s.EditorScroll=ot(new p),s.ScrollLineUp=ot(new class extends Fi{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Up,by:hs.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollPageUp=ot(new class extends Fi{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Up,by:hs.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollEditorTop=ot(new class extends Fi{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Up,by:hs.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollLineDown=ot(new class extends Fi{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Down,by:hs.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollPageDown=ot(new class extends Fi{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Down,by:hs.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollEditorBottom=ot(new class extends Fi{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Down,by:hs.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollLeft=ot(new class extends Fi{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Left,by:hs.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:S.source})}}),s.ScrollRight=ot(new class extends Fi{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus}})}runCoreEditorCommand(x,S){s.EditorScroll.runCoreEditorCommand(x,{to:hs.RawDirection.Right,by:hs.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:S.source})}});class _ extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){y.position&&(S.model.pushStackElement(),S.setCursorStates(y.source,3,[Ms.word(S,S.getPrimaryCursorState(),this._inSelectionMode,y.position)]),y.revealType!==2&&S.revealAllCursors(y.source,!0,!0))}}s.WordSelect=ot(new _({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),s.WordSelectDrag=ot(new _({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),s.LastCursorWordSelect=ot(new class extends Fi{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(x,S){if(!S.position)return;const y=x.getLastAddedCursorIndex(),k=x.getCursorStates(),D=k.slice(0),R=k[y];D[y]=Ms.word(x,R,R.modelState.hasSelection(),S.position),x.model.pushStackElement(),x.setCursorStates(S.source,3,D)}});class b extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){y.position&&(S.model.pushStackElement(),S.setCursorStates(y.source,3,[Ms.line(S,S.getPrimaryCursorState(),this._inSelectionMode,y.position,y.viewPosition)]),y.revealType!==2&&S.revealAllCursors(y.source,!1,!0))}}s.LineSelect=ot(new b({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),s.LineSelectDrag=ot(new b({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class C extends Fi{constructor(S){super(S),this._inSelectionMode=S.inSelectionMode}runCoreEditorCommand(S,y){if(!y.position)return;const k=S.getLastAddedCursorIndex(),D=S.getCursorStates(),R=D.slice(0);R[k]=Ms.line(S,D[k],this._inSelectionMode,y.position,y.viewPosition),S.model.pushStackElement(),S.setCursorStates(y.source,3,R)}}s.LastCursorLineSelect=ot(new C({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),s.LastCursorLineSelectDrag=ot(new C({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),s.CancelSelection=ot(new class extends Fi{constructor(){super({id:"cancelSelection",precondition:Oe.hasNonEmptySelection,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(x,S){x.model.pushStackElement(),x.setCursorStates(S.source,3,[Ms.cancelSelection(x,x.getPrimaryCursorState())]),x.revealAllCursors(S.source,!0)}}),s.RemoveSecondaryCursors=ot(new class extends Fi{constructor(){super({id:"removeSecondaryCursors",precondition:Oe.hasMultipleSelections,kbOpts:{weight:kt+1,kbExpr:Oe.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(x,S){x.model.pushStackElement(),x.setCursorStates(S.source,3,[x.getPrimaryCursorState()]),x.revealAllCursors(S.source,!0),xk(v(68,"Removed secondary cursors"))}}),s.RevealLine=ot(new class extends Fi{constructor(){super({id:"revealLine",precondition:void 0,metadata:o_.metadata})}runCoreEditorCommand(x,S){const y=S,k=y.lineNumber||0;let D=typeof k=="number"?k+1:parseInt(k)+1;D<1&&(D=1);const R=x.model.getLineCount();D>R&&(D=R);const N=new G(D,1,D,x.model.getLineMaxColumn(D));let A=0;if(y.at)switch(y.at){case o_.RawAtArgument.Top:A=3;break;case o_.RawAtArgument.Center:A=1;break;case o_.RawAtArgument.Bottom:A=4;break}const M=x.coordinatesConverter.convertModelRangeToViewRange(N);x.revealRange(S.source,!1,M,A,0)}}),s.SelectAll=new class extends y5{constructor(){super(Tbe)}runDOMCommand(x){Kr&&(x.focus(),x.select()),x.ownerDocument.execCommand("selectAll")}runEditorCommand(x,S,y){const k=S._getViewModel();k&&this.runCoreEditorCommand(k,y)}runCoreEditorCommand(x,S){x.model.pushStackElement(),x.setCursorStates("keyboard",3,[Ms.selectAll(x,x.getPrimaryCursorState())])}},s.SetSelection=ot(new class extends Fi{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(x,S){S.selection&&(x.model.pushStackElement(),x.setCursorStates(S.source,3,[wt.fromModelSelection(S.selection)]))}})})(Hn||(Hn={}));const ESe=xt.and(Oe.textInputFocus,Oe.columnSelection);function tb(s,e){Hd.registerKeybindingRule({id:s,primary:e,when:ESe,weight:kt+1})}tb(Hn.CursorColumnSelectLeft.id,1039);tb(Hn.CursorColumnSelectRight.id,1041);tb(Hn.CursorColumnSelectUp.id,1040);tb(Hn.CursorColumnSelectPageUp.id,1035);tb(Hn.CursorColumnSelectDown.id,1042);tb(Hn.CursorColumnSelectPageDown.id,1036);function nj(s){return s.register(),s}var sj;(function(s){class e extends lm{runEditorCommand(i,n,r){const o=n._getViewModel();o&&this.runCoreEditingCommand(n,o,r||{})}}s.CoreEditingCommand=e,s.LineBreakInsert=ot(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:Oe.writable,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,NJ.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection)))}}),s.Outdent=ot(new class extends e{constructor(){super({id:"outdent",precondition:Oe.writable,kbOpts:{weight:kt,kbExpr:xt.and(Oe.editorTextFocus,Oe.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Wf.outdent(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),s.Tab=ot(new class extends e{constructor(){super({id:"tab",precondition:Oe.writable,kbOpts:{weight:kt,kbExpr:xt.and(Oe.editorTextFocus,Oe.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Wf.tab(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),s.DeleteLeft=ot(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,n){const[r,o]=hm.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(2)}}),s.DeleteRight=ot(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:kt,kbExpr:Oe.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,n){const[r,o]=hm.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(3)}}),s.Undo=new class extends y5{constructor(){super(_Z)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(104)===!0))return i.getModel().undo()}},s.Redo=new class extends y5{constructor(){super(bZ)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(104)===!0))return i.getModel().redo()}}})(sj||(sj={}));class rj extends ED{constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){const i=e.get(In).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function Am(s,e){nj(new rj("default:"+s,s)),nj(new rj(s,s,e))}Am("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Am("replacePreviousChar");Am("compositionType");Am("compositionStart");Am("compositionEnd");Am("paste");Am("cut");class DSe{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Hn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new J(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(86)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(86)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=Gr&&t.get(121),n=t.get(28),r=t.get(171);e.middleButton&&!i?r||this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Hn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Hn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Hn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Hn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Hn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Hn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Hn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Hn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Hn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Hn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Hn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Hn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Hn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class AJ{constructor(e){this._lineFactory=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new $e("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let r=0,o=0;for(let l=i;l<=n;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(o===0?(r=c,o=1):o++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(r,o)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const n=this.getStartLineNumber(),r=this.getEndLineNumber();let o=!1;for(let a=e;a<=i;a++)a>=n&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),o=!0);return o}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,n=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>r)return null;if(i+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);const o=[];for(let d=0;d<i;d++)o[d]=this._lineFactory.createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),h=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(o).concat(c),h}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let r=0,o=e.length;r<o;r++){const a=e[r];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let h=l;h<=c;h++){const d=h-this._rendLineNumberStart;this._lines[d].onTokensChanged(),n=!0}}return n}}class MJ{constructor(e,t){this._viewContext=e,this._lineFactory=t,this.domNode=this._createDomNode(),this._linesCollection=new AJ(this._lineFactory)}_createDomNode(){const e=Tt(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(165)}onFlushed(e,t){var i;if(t){const n=this._linesCollection.getStartLineNumber(),r=this._linesCollection.getEndLineNumber();for(let o=n;o<=r;o++)(i=this._linesCollection.getLine(o).getDomNode())==null||i.remove()}return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const r=t[i].getDomNode();r==null||r.remove()}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const r=t[i].getDomNode();r==null||r.remove()}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new S5(this.domNode.domNode,this._lineFactory,e,this._viewContext),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}}const bu=class bu{constructor(e,t,i,n){this._domNode=e,this._lineFactory=t,this._viewportData=i,this._viewContext=n}render(e,t,i,n){const r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||i<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=i-t+1,r.lines=[];for(let o=t;o<=i;o++)r.lines[o-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,n),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(i-r.rendLineNumberStart,r.linesLength-1),n,t),r.rendLineNumberStart>t){const o=t,a=Math.min(i,r.rendLineNumberStart-1);o<=a&&(this._insertLinesBefore(r,o,a,n,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart<t){const o=Math.min(r.linesLength,t-r.rendLineNumberStart);o>0&&(this._removeLinesBefore(r,o),r.linesLength-=o)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<i){const o=r.rendLineNumberStart+r.linesLength,a=i;o<=a&&(this._insertLinesAfter(r,o,a,n,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart+r.linesLength-1>i){const o=Math.max(0,i-r.rendLineNumberStart+1),l=r.linesLength-1-o+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,n),r}_renderUntouchedLines(e,t,i,n,r){const o=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=o+l;a[l].layoutLine(c,n[c-r],this._lineHeightForLineNumber(c))}}_insertLinesBefore(e,t,i,n,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this._lineFactory.createLine();e.lines=o.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const n=e.lines[i].getDomNode();n==null||n.remove()}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(o)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++){const r=e.lines[i+n].getDomNode();r==null||r.remove()}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){bu._ttPolicy&&(i=bu._ttPolicy.createHTML(i));const r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=i:r.insertAdjacentHTML("afterend",i);let o=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];n[a]&&(l.setDomNode(o),o=o.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");bu._ttPolicy&&(t=bu._ttPolicy.createHTML(t)),n.innerHTML=t;for(let r=0;r<e.linesLength;r++){const o=e.lines[r];if(i[r]){const a=n.firstChild;o.getDomNode().replaceWith(a),o.setDomNode(a)}}}_finishRendering(e,t,i){const n=bu._sb,r=e.linesLength,o=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let c=!1;for(let h=0;h<r;h++){const d=o[h];if(l[h]=!1,d.getDomNode())continue;const p=h+a;d.renderLine(p,i[h],this._lineHeightForLineNumber(p),this._viewportData,n)&&(l[h]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let c=!1;const h=[];for(let d=0;d<r;d++){const g=o[d];if(h[d]=!1,l[d])continue;const p=d+a;g.renderLine(p,i[d],this._lineHeightForLineNumber(p),this._viewportData,n)&&(h[d]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,n.build(),h)}}_lineHeightForLineNumber(e){return this._viewContext.viewLayout.getLineHeightForLineNumber(e)}};bu._ttPolicy=Wd("editorViewLayer",{createHTML:e=>e}),bu._sb=new J1(1e5);let S5=bu;class OJ extends br{constructor(e){super(e),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new MJ(this._context,{createLine:()=>new TSe(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(59);vs(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._context.configuration.options.get(59);return vs(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){const r=t[i];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class TSe{constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Tt(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,r){let o="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){const c=this._dynamicOverlays[a];o+=c.render(n.startLineNumber,e)}return this._renderedContent===o?!1:(this._renderedContent=o,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(i)),r.appendString("px;line-height:"),r.appendString(String(i)),r.appendString('px;">'),r.appendString(o),r.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i),this._domNode.setLineHeight(i))}}class NSe extends OJ{constructor(e){super(e);const i=this._context.configuration.options.get(165);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class ISe extends OJ{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),vs(this.domNode,t.get(59))}onConfigurationChanged(e){const t=this._context.configuration.options;vs(this.domNode,t.get(59));const i=t.get(165);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class zD{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;(t=this.onKeyDown)==null||t.call(this,e)}emitKeyUp(e){var t;(t=this.onKeyUp)==null||t.call(this,e)}emitContextMenu(e){var t;(t=this.onContextMenu)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;(t=this.onMouseMove)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;(t=this.onMouseLeave)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;(t=this.onMouseDown)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;(t=this.onMouseUp)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;(t=this.onMouseDrag)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;(t=this.onMouseDrop)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;(e=this.onMouseDropCanceled)==null||e.call(this)}emitMouseWheel(e){var t;(t=this.onMouseWheel)==null||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return zD.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new J(e.afterLineNumber,1)).lineNumber}}}class RSe extends br{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=Tt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(165),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);const r=i.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0;const i=e.getDecorationsInViewport();for(const n of i){if(!n.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=Tt(document.createElement("div")),this.domNode.appendChild(r));let o,a;n.options.blockIsAfterEnd?(o=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(o=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[l,c,h,d]=n.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+n.options.blockClassName),r.setLeft(this.contentLeft-d),r.setWidth(this.contentWidth+d+c),r.setTop(o-e.scrollTop-l),r.setHeight(a-o+l+h),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}}class ASe extends br{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Tt(document.createElement("div")),wl.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Tt(document.createElement("div")),wl.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new MSe(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,r){this._widgets[e.getId()].setPosition(t,i,n,r),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class MSe{constructor(e,t,i){this._primaryAnchor=new c0(null,null),this._secondaryAnchor=new c0(null,null),this._context=e,this._viewDomNode=t,this._actual=i;const n=this._context.configuration.options,r=n.get(165),o=n.get(4);this.domNode=Tt(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=(this._actual.allowEditorOverflow||!1)&&o,this.suppressMouseDown=this._actual.suppressMouseDown||!1,this._fixedOverflowWidgets=n.get(51),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(e.hasChanged(165)){const i=t.get(165);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(r,o,a){if(!r)return new c0(null,null);const l=o.model.validatePosition(r);if(o.coordinatesConverter.modelPositionIsVisible(l)){const c=o.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new c0(r,c)}return new c0(r,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?(t==null?void 0:t.innerWidth)||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){const r=e.top,o=r,a=e.top+e.height,l=n.viewportHeight-a,c=r-i,h=o>=i,d=a,g=l>=i;let p=e.left;return p+t>n.scrollLeft+n.viewportWidth&&(p=n.scrollLeft+n.viewportWidth-t),p<n.scrollLeft&&(p=n.scrollLeft),{fitsAbove:h,aboveTop:c,fitsBelow:g,belowTop:d,left:p}}_layoutHorizontalSegmentInPage(e,t,i,n){const a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),h=this._viewDomNode.domNode.ownerDocument.defaultView;let d=t.left+i-((h==null?void 0:h.scrollX)??0);if(d+n>l){const g=d-(l-n);d-=g,i-=g}if(d<a){const g=d-a;d-=g,i-=g}return[i,d]}_layoutBoxInPage(e,t,i,n){const r=e.top-i,o=e.top+e.height,a=ta(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,c=l.defaultView,h=a.top+r-((c==null?void 0:c.scrollY)??0),d=a.top+o-((c==null?void 0:c.scrollY)??0),g=T4(l.body),[p,_]=this._layoutHorizontalSegmentInPage(g,a,e.left-n.scrollLeft+this._contentLeft,t),b=22,C=22,x=h>=b,S=d+i<=g.height-C;return this._fixedOverflowWidgets?{fitsAbove:x,aboveTop:Math.max(h,b),fitsBelow:S,belowTop:d,left:_}:{fitsAbove:x,aboveTop:r,fitsBelow:S,belowTop:o,left:p}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new u0(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){var o,a;const t=r(this._primaryAnchor.viewPosition,this._affinity),i=((o=this._secondaryAnchor.viewPosition)==null?void 0:o.lineNumber)===((a=this._primaryAnchor.viewPosition)==null?void 0:a.lineNumber)?this._secondaryAnchor.viewPosition:null,n=r(i,this._affinity);return{primary:t,secondary:n};function r(l,c){if(!l)return null;const h=e.visibleRangeForPosition(l);if(!h)return null;const d=l.column===1&&c===3?0:h.left,g=e.getVerticalOffsetForLineNumber(l.lineNumber)-e.scrollTop,p=e.getLineHeightForLineNumber(l.lineNumber);return new oj(g,d,p)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const n=this._context.configuration.options.get(59);let r=t.left;return r<e.left?r=Math.max(r,e.left-i+n.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+i-n.typicalFullwidthCharacterWidth),new oj(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let o=null;if(typeof this._actual.beforeRender=="function"&&(o=DR(this._actual.beforeRender,this._actual)),o)this._cachedDomNodeOffsetWidth=o.width,this._cachedDomNodeOffsetHeight=o.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let r;this.allowEditorOverflow?r=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let o=1;o<=2;o++)for(const a of this._preference)if(a===1){if(!r)return null;if(o===2||r.fitsAbove)return{kind:"inViewport",coordinate:new u0(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(o===2||r.fitsBelow)return{kind:"inViewport",coordinate:new u0(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new u0(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new u0(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){var t;if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,((t=this._renderData)==null?void 0:t.kind)==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&DR(this._actual.afterRender,this._actual,null,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&DR(this._actual.afterRender,this._actual,this._renderData.position,this._renderData.coordinate)}}class c0{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class u0{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class oj{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function DR(s,e,...t){try{return s.call(e,...t)}catch{return null}}class zd extends Im{}const Zr=gt("themeService");function Mp(s){return{id:s}}function x5(s){switch(s){case na.DARK:return r_.VS_DARK;case na.HIGH_CONTRAST_DARK:return r_.HC_BLACK;case na.HIGH_CONTRAST_LIGHT:return r_.HC_LIGHT;default:return r_.VS}}const PJ={ThemingContribution:"base.contributions.theming"};class OSe extends le{constructor(){super(),this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=this._register(new Z)}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),qe(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const FJ=new OSe;ss.add(PJ.ThemingContribution,FJ);function lh(s){return FJ.onColorThemeChange(s)}class PSe extends le{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}const BJ=j("editor.lineHighlightBackground",null,v(610,"Background color for the highlight of line at the cursor position.")),aj=j("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Nt},v(611,"Background color for the border around the line at the cursor position."));j("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},v(612,"Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:rn,hcLight:rn},v(613,"Background color of the border around highlighted ranges."));j("editor.symbolHighlightBackground",{dark:sd,light:sd,hcDark:null,hcLight:null},v(614,"Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:rn,hcLight:rn},v(615,"Background color of the border around highlighted symbols."));const UD=j("editorCursor.foreground",{dark:"#AEAFAD",light:me.black,hcDark:me.white,hcLight:"#0F4A85"},v(616,"Color of the editor cursor.")),q7=j("editorCursor.background",null,v(617,"The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),VJ=j("editorMultiCursor.primary.foreground",UD,v(618,"Color of the primary editor cursor when multiple cursors are present.")),FSe=j("editorMultiCursor.primary.background",q7,v(619,"The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),HJ=j("editorMultiCursor.secondary.foreground",UD,v(620,"Color of secondary editor cursors when multiple cursors are present.")),BSe=j("editorMultiCursor.secondary.background",q7,v(621,"The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),G7=j("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},v(622,"Color of whitespace characters in the editor.")),VSe=j("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:me.white,hcLight:"#292929"},v(623,"Color of editor line numbers.")),HSe=j("editorIndentGuide.background",G7,v(624,"Color of the editor indentation guides."),!1,v(625,"'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),WSe=j("editorIndentGuide.activeBackground",G7,v(626,"Color of the active editor indentation guides."),!1,v(627,"'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),JC=j("editorIndentGuide.background1",HSe,v(628,"Color of the editor indentation guides (1).")),zSe=j("editorIndentGuide.background2","#00000000",v(629,"Color of the editor indentation guides (2).")),USe=j("editorIndentGuide.background3","#00000000",v(630,"Color of the editor indentation guides (3).")),jSe=j("editorIndentGuide.background4","#00000000",v(631,"Color of the editor indentation guides (4).")),$Se=j("editorIndentGuide.background5","#00000000",v(632,"Color of the editor indentation guides (5).")),qSe=j("editorIndentGuide.background6","#00000000",v(633,"Color of the editor indentation guides (6).")),ey=j("editorIndentGuide.activeBackground1",WSe,v(634,"Color of the active editor indentation guides (1).")),GSe=j("editorIndentGuide.activeBackground2","#00000000",v(635,"Color of the active editor indentation guides (2).")),KSe=j("editorIndentGuide.activeBackground3","#00000000",v(636,"Color of the active editor indentation guides (3).")),YSe=j("editorIndentGuide.activeBackground4","#00000000",v(637,"Color of the active editor indentation guides (4).")),QSe=j("editorIndentGuide.activeBackground5","#00000000",v(638,"Color of the active editor indentation guides (5).")),XSe=j("editorIndentGuide.activeBackground6","#00000000",v(639,"Color of the active editor indentation guides (6).")),ZSe=j("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:rn,hcLight:rn},v(640,"Color of editor active line number"),!1,v(641,"Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));j("editorLineNumber.activeForeground",ZSe,v(642,"Color of editor active line number"));const JSe=j("editorLineNumber.dimmedForeground",null,v(643,"Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),exe=j("editorRuler.foreground",{dark:"#5A5A5A",light:me.lightgrey,hcDark:me.white,hcLight:"#292929"},v(644,"Color of the editor rulers."));j("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},v(645,"Foreground color of editor CodeLens"));j("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},v(646,"Background color behind matching brackets"));j("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Nt,hcLight:Nt},v(647,"Color for matching brackets boxes"));const txe=j("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},v(648,"Color of the overview ruler border.")),ixe=j("editorOverviewRuler.background",null,v(649,"Background color of the editor overview ruler."));j("editorGutter.background",Oa,v(650,"Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));j("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:me.fromHex("#fff").transparent(.8),hcLight:Nt},v(651,"Border color of unnecessary (unused) source code in the editor."));const nxe=j("editorUnnecessaryCode.opacity",{dark:me.fromHex("#000a"),light:me.fromHex("#0007"),hcDark:null,hcLight:null},v(652,`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));j("editorGhostText.border",{dark:null,light:null,hcDark:me.fromHex("#fff").transparent(.8),hcLight:me.fromHex("#292929").transparent(.8)},v(653,"Border color of ghost text in the editor."));j("editorGhostText.foreground",{dark:me.fromHex("#ffffff56"),light:me.fromHex("#0007"),hcDark:null,hcLight:null},v(654,"Foreground color of the ghost text in the editor."));j("editorGhostText.background",null,v(655,"Background color of the ghost text in the editor."));const sxe=new me(new ae(0,122,204,.6));j("editorOverviewRuler.rangeHighlightForeground",sxe,v(656,"Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const rxe=j("editorOverviewRuler.errorForeground",{dark:new me(new ae(255,18,18,.7)),light:new me(new ae(255,18,18,.7)),hcDark:new me(new ae(255,50,50,1)),hcLight:"#B5200D"},v(657,"Overview ruler marker color for errors.")),oxe=j("editorOverviewRuler.warningForeground",{dark:Ad,light:Ad,hcDark:Dk,hcLight:Dk},v(658,"Overview ruler marker color for warnings.")),axe=j("editorOverviewRuler.infoForeground",{dark:cm,light:cm,hcDark:Tk,hcLight:Tk},v(659,"Overview ruler marker color for infos.")),WJ=j("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},v(660,"Foreground color of brackets (1). Requires enabling bracket pair colorization.")),zJ=j("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},v(661,"Foreground color of brackets (2). Requires enabling bracket pair colorization.")),UJ=j("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},v(662,"Foreground color of brackets (3). Requires enabling bracket pair colorization.")),jJ=j("editorBracketHighlight.foreground4","#00000000",v(663,"Foreground color of brackets (4). Requires enabling bracket pair colorization.")),$J=j("editorBracketHighlight.foreground5","#00000000",v(664,"Foreground color of brackets (5). Requires enabling bracket pair colorization.")),qJ=j("editorBracketHighlight.foreground6","#00000000",v(665,"Foreground color of brackets (6). Requires enabling bracket pair colorization.")),lxe=j("editorBracketHighlight.unexpectedBracket.foreground",{dark:new me(new ae(255,18,18,.8)),light:new me(new ae(255,18,18,.8)),hcDark:new me(new ae(255,50,50,1)),hcLight:"#B5200D"},v(666,"Foreground color of unexpected brackets.")),cxe=j("editorBracketPairGuide.background1","#00000000",v(667,"Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),uxe=j("editorBracketPairGuide.background2","#00000000",v(668,"Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),hxe=j("editorBracketPairGuide.background3","#00000000",v(669,"Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),dxe=j("editorBracketPairGuide.background4","#00000000",v(670,"Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),fxe=j("editorBracketPairGuide.background5","#00000000",v(671,"Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),gxe=j("editorBracketPairGuide.background6","#00000000",v(672,"Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),mxe=j("editorBracketPairGuide.activeBackground1","#00000000",v(673,"Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),pxe=j("editorBracketPairGuide.activeBackground2","#00000000",v(674,"Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),_xe=j("editorBracketPairGuide.activeBackground3","#00000000",v(675,"Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),bxe=j("editorBracketPairGuide.activeBackground4","#00000000",v(676,"Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),wxe=j("editorBracketPairGuide.activeBackground5","#00000000",v(677,"Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),vxe=j("editorBracketPairGuide.activeBackground6","#00000000",v(678,"Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));j("editorUnicodeHighlight.border",Ad,v(679,"Border color used to highlight unicode characters."));j("editorUnicodeHighlight.background",Fve,v(680,"Background color used to highlight unicode characters."));lh((s,e)=>{const t=s.getColor(Oa),i=s.getColor(BJ),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});class GJ extends zd{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(165);this._renderLineHighlight=t.get(110),this._renderLineHighlightOnlyWhenFocus=t.get(111),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Lt(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=new Set;for(const r of this._selections)t.add(r.positionLineNumber);const i=Array.from(t);i.sort((r,o)=>r-o),Sn(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const n=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._renderLineHighlight=t.get(110),this._renderLineHighlightOnlyWhenFocus=t.get(111),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let o=t;o<=i;o++){const a=o-t;n[a]=""}if(this._wordWrap){const o=this._renderOne(e,!1);for(const a of this._cursorLineNumbers){const l=this._context.viewModel.coordinatesConverter,c=l.convertViewPositionToModelPosition(new J(a,1)).lineNumber,h=l.convertModelPositionToViewPosition(new J(c,1)).lineNumber,d=l.convertModelPositionToViewPosition(new J(c,this._context.viewModel.model.getLineMaxColumn(c))).lineNumber,g=Math.max(h,t),p=Math.min(d,i);for(let _=g;_<=p;_++){const b=_-t;n[b]=o}}}const r=this._renderOne(e,!0);for(const o of this._cursorLineNumbers){if(o<t||o>i)continue;const a=o-t;n[a]=r}this._renderData=n}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class Cxe extends GJ{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class yxe extends GJ{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}lh((s,e)=>{const t=s.getColor(BJ);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||s.defines(aj)){const i=s.getColor(aj);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),W_(s.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class Sxe extends zd{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let l=0,c=t.length;l<c;l++){const h=t[l];h.options.className&&(i[n++]=h)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const h=l.options.className,d=c.options.className;return h<d?-1:h>d?1:G.compareRangesUsingStarts(l.range,c.range)});const r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=o;l++){const c=l-r;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const n=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let o=0,a=t.length;o<a;o++){const l=t[o];if(!l.options.isWholeLine)continue;const c='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',h=Math.max(l.range.startLineNumber,n),d=Math.min(l.range.endLineNumber,r);for(let g=h;g<=d;g++){const p=g-n;i[p]+=c}}}_renderNormalDecorations(e,t,i){const n=e.visibleRange.startLineNumber;let r=null,o=!1,a=null,l=!1;for(let c=0,h=t.length;c<h;c++){const d=t[c];if(d.options.isWholeLine)continue;const g=d.options.className,p=!!d.options.showIfCollapsed;let _=d.range;if(p&&_.endColumn===1&&_.endLineNumber!==_.startLineNumber&&(_=new G(_.startLineNumber,_.startColumn,_.endLineNumber-1,this._context.viewModel.getLineMaxColumn(_.endLineNumber-1))),r===g&&o===p&&G.areIntersectingOrTouching(a,_)){a=G.plusRange(a,_);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,o,n,i),r=g,o=p,a=_,l=d.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,o,n,i)}_renderNormalDecoration(e,t,i,n,r,o,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,h=l.length;c<h;c++){const d=l[c];if(d.outsideRenderedLine)continue;const g=d.lineNumber-o;if(r&&d.ranges.length===1){const p=d.ranges[0];if(p.width<this._typicalHalfwidthCharacterWidth){const _=Math.round(p.left+p.width/2),b=Math.max(0,Math.round(_-this._typicalHalfwidthCharacterWidth/2));d.ranges[0]=new ZC(b,this._typicalHalfwidthCharacterWidth)}}for(let p=0,_=d.ranges.length;p<_;p++){const b=n&&d.continuesOnNextLine&&_===1,C=d.ranges[p],x='<div class="cdr '+i+'" style="left:'+String(C.left)+"px;width:"+(b?"100%;":String(C.width)+"px;")+'"></div>';a[g]+=x}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class xxe extends br{constructor(e,t,i,n){super(e);const r=this._context.configuration.options,o=r.get(117),a=r.get(83),l=r.get(49),c=r.get(120),h=r.get(158),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+x5(e.theme.type),useShadows:!1,lazyRender:!0,vertical:o.vertical,horizontal:o.horizontal,verticalHasArrows:o.verticalHasArrows,horizontalHasArrows:o.horizontalHasArrows,verticalScrollbarSize:o.verticalScrollbarSize,verticalSliderSize:o.verticalSliderSize,horizontalScrollbarSize:o.horizontalScrollbarSize,horizontalSliderSize:o.horizontalSliderSize,handleMouseWheel:o.handleMouseWheel,alwaysConsumeMouseWheel:o.alwaysConsumeMouseWheel,arrowSize:o.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:o.scrollByPage,inertialScroll:h};this.scrollbar=this._register(new HD(t.domNode,d,this._context.viewLayout.getScrollable())),wl.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Tt(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const g=(p,_,b)=>{const C={};{const x=p.scrollTop;x&&(C.scrollTop=this._context.viewLayout.getCurrentScrollTop()+x,p.scrollTop=0)}if(b){const x=p.scrollLeft;x&&(C.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+x,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(C,1)};this._register(ie(i.domNode,"scroll",p=>g(i.domNode,!0,!0))),this._register(ie(t.domNode,"scroll",p=>g(t.domNode,!0,!1))),this._register(ie(n.domNode,"scroll",p=>g(n.domNode,!0,!1))),this._register(ie(this.scrollbarDomNode.domNode,"scroll",p=>g(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(165);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(81).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(117)||e.hasChanged(83)||e.hasChanged(49)){const t=this._context.configuration.options,i=t.get(117),n=t.get(83),r=t.get(49),o=t.get(120),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:r,scrollPredominantAxis:o};this.scrollbar.updateOptions(a)}return e.hasChanged(165)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+x5(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class L5{constructor(e,t,i,n,r){this.startLineNumber=e,this.endLineNumber=t,this.className=i,this.tooltip=n,this._decorationToRenderBrand=void 0,this.zIndex=r??0}}class Lxe{constructor(e,t,i){this.className=e,this.zIndex=t,this.tooltip=i}}class kxe{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class KJ extends zd{_render(e,t,i){const n=[];for(let a=e;a<=t;a++){const l=a-e;n[l]=new kxe}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,o=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],h=c.className,d=c.zIndex;let g=Math.max(c.startLineNumber,e)-e;const p=Math.min(c.endLineNumber,t)-e;r===h?(g=Math.max(o+1,g),o=Math.max(o,p)):(r=h,o=p);for(let _=g;_<=o;_++)n[_].add(new Lxe(h,d,c.tooltip))}return n}}class Exe extends br{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(165);this.domNode=Tt(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(75),this._glyphMargin=t.get(66),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._lineHeight=t.get(75),this._glyphMargin=t.get(66),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=Tt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&G.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets[t]){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){var o;const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(const a of r){const l=a.options.glyphMarginClassName;if(!l)continue;const c=Math.max(a.range.startLineNumber,i),h=Math.min(a.range.endLineNumber,n),d=((o=a.options.glyphMargin)==null?void 0:o.position)??Rd.Center,g=a.options.zIndex??0;for(let p=c;p<=h;p++){const _=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(p,0)),b=this._context.viewModel.glyphLanes.getLanesAtLine(_.lineNumber).indexOf(d);t.push(new Dxe(p,b,g,l))}}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(const r of Object.values(this._widgets)){const o=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(G.lift(o));if(!a||!l||l<i||a>n)continue;const c=Math.max(a,i),h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(c,0)),d=this._context.viewModel.glyphLanes.getLanesAtLine(h.lineNumber).indexOf(r.preference.lane);t.push(new Txe(c,d,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const n of Object.values(this._widgets))n.renderInfo=null;const t=new eh(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const n=t.peek();if(!n)break;const r=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!r||r.length===0)break;const o=r[0];if(o.type===0){const a=[];for(const l of r){if(l.zIndex!==o.zIndex||l.type!==o.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(o.accept(a.join(" ")))}else o.widget.renderInfo={lineNumber:o.lineNumber,laneIndex:o.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(r),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const n=this._decorationGlyphsToRender[i],r=n.lineNumber,o=e.viewportData.relativeVerticalOffset[r-e.viewportData.startLineNumber],a=this._glyphMarginLeft+n.laneIndex*this._lineHeight;let l;i<this._managedDomNodes.length?l=this._managedDomNodes[i]:(l=Tt(document.createElement("div")),this._managedDomNodes.push(l),this.domNode.appendChild(l));const c=this._context.viewLayout.getLineHeightForLineNumber(r);l.setClassName("cgmr codicon "+n.combinedClassName),l.setPosition("absolute"),l.setTop(o),l.setLeft(a),l.setWidth(t),l.setHeight(c)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}}}class Dxe{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.className=n,this.type=0}accept(e){return new Nxe(this.lineNumber,this.laneIndex,e)}}class Txe{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.widget=n,this.type=1}}class Nxe{constructor(e,t,i){this.lineNumber=e,this.laneIndex=t,this.combinedClassName=i}}class YJ extends le{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function Ixe(s,e){let t=0,i=0;const n=s.length;for(;i<n;){const r=s.charCodeAt(i);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var kg;(function(s){s[s.Disabled=0]="Disabled",s[s.EnabledForActive=1]="EnabledForActive",s[s.Enabled=2]="Enabled"})(kg||(kg={}));class hg{constructor(e,t,i,n,r,o){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=n,this.forWrappedLinesAfterColumn=r,this.forWrappedLinesBeforeOrAtColumn=o,e!==-1==(t!==-1))throw new Error}}class nw{constructor(e,t){this.top=e,this.endColumn=t}}class Rxe extends YJ{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return Ixe(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new $e("Illegal value for lineNumber");const r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide);let a=-2,l=-1,c=-2,h=-1;const d=N=>{if(a!==-1&&(a===-2||a>N-1)){a=-1,l=-1;for(let A=N-2;A>=0;A--){const M=this._computeIndentLevel(A);if(M>=0){a=A,l=M;break}}}if(c===-2){c=-1,h=-1;for(let A=N;A<n;A++){const M=this._computeIndentLevel(A);if(M>=0){c=A,h=M;break}}}};let g=-2,p=-1,_=-2,b=-1;const C=N=>{if(g===-2){g=-1,p=-1;for(let A=N-2;A>=0;A--){const M=this._computeIndentLevel(A);if(M>=0){g=A,p=M;break}}}if(_!==-1&&(_===-2||_<N-1)){_=-1,b=-1;for(let A=N;A<n;A++){const M=this._computeIndentLevel(A);if(M>=0){_=A,b=M;break}}}};let x=0,S=!0,y=0,k=!0,D=0,R=0;for(let N=0;S||k;N++){const A=e-N,M=e+N;N>1&&(A<1||A<t)&&(S=!1),N>1&&(M>n||M>i)&&(k=!1),N>5e4&&(S=!1,k=!1);let O=-1;if(S&&A>=1){const H=this._computeIndentLevel(A-1);H>=0?(c=A-1,h=H,O=Math.ceil(H/this.textModel.getOptions().indentSize)):(d(A),O=this._getIndentLevelForWhitespaceLine(o,l,h))}let V=-1;if(k&&M<=n){const H=this._computeIndentLevel(M-1);H>=0?(g=M-1,p=H,V=Math.ceil(H/this.textModel.getOptions().indentSize)):(C(M),V=this._getIndentLevelForWhitespaceLine(o,p,b))}if(N===0){R=O;continue}if(N===1){if(M<=n&&V>=0&&R+1===V){S=!1,x=M,y=M,D=V;continue}if(A>=1&&O>=0&&O-1===R){k=!1,x=A,y=A,D=O;continue}if(x=e,y=e,D=R,D===0)return{startLineNumber:x,endLineNumber:y,indent:D}}S&&(O>=D?x=A:S=!1),k&&(V>=D?y=M:k=!1)}return{startLineNumber:x,endLineNumber:y,indent:D}}getLinesBracketGuides(e,t,i,n){var d;const r=[];for(let g=e;g<=t;g++)r.push([]);const o=!0,a=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new G(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let l;if(i&&a.length>0){const g=(e<=i.lineNumber&&i.lineNumber<=t?a:this.textModel.bracketPairs.getBracketPairsInRange(G.fromPositions(i)).toArray()).filter(p=>G.strictContainsPosition(p.range,i));l=(d=pk(g,p=>o))==null?void 0:d.range}const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,h=new QJ;for(const g of a){if(!g.closingBracketRange)continue;const p=l&&g.range.equalsRange(l);if(!p&&!n.includeInactive)continue;const _=h.getInlineClassName(g.nestingLevel,g.nestingLevelOfEqualBracketType,c)+(n.highlightActive&&p?" "+h.activeClassName:""),b=g.openingBracketRange.getStartPosition(),C=g.closingBracketRange.getStartPosition(),x=n.horizontalGuides===kg.Enabled||n.horizontalGuides===kg.EnabledForActive&&p;if(g.range.startLineNumber===g.range.endLineNumber){x&&r[g.range.startLineNumber-e].push(new hg(-1,g.openingBracketRange.getEndPosition().column,_,new nw(!1,C.column),-1,-1));continue}const S=this.getVisibleColumnFromPosition(C),y=this.getVisibleColumnFromPosition(g.openingBracketRange.getStartPosition()),k=Math.min(y,S,g.minVisibleColumnIndentation+1);let D=!1;qr(this.textModel.getLineContent(g.closingBracketRange.startLineNumber))<g.closingBracketRange.startColumn-1&&(D=!0);const A=Math.max(b.lineNumber,e),M=Math.min(C.lineNumber,t),O=D?1:0;for(let V=A;V<M+O;V++)r[V-e].push(new hg(k,-1,_,null,V===b.lineNumber?b.column:-1,V===C.lineNumber?C.column:-1));x&&(b.lineNumber>=e&&y>k&&r[b.lineNumber-e].push(new hg(k,-1,_,new nw(!1,b.column),-1,-1)),C.lineNumber<=t&&S>k&&r[C.lineNumber-e].push(new hg(k,-1,_,new nw(!D,C.column),-1,-1)))}for(const g of r)g.sort((p,_)=>p.visibleColumn-_.visibleColumn);return r}getVisibleColumnFromPosition(e){return Ai.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide),a=new Array(t-e+1);let l=-2,c=-1,h=-2,d=-1;for(let g=e;g<=t;g++){const p=g-e,_=this._computeIndentLevel(g-1);if(_>=0){l=g-1,c=_,a[p]=Math.ceil(_/n.indentSize);continue}if(l===-2){l=-1,c=-1;for(let b=g-2;b>=0;b--){const C=this._computeIndentLevel(b);if(C>=0){l=b,c=C;break}}}if(h!==-1&&(h===-2||h<g-1)){h=-1,d=-1;for(let b=g;b<i;b++){const C=this._computeIndentLevel(b);if(C>=0){h=b,d=C;break}}}a[p]=this._getIndentLevelForWhitespaceLine(o,c,d)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class QJ{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class Axe extends zd{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(166),n=t.get(59);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(22),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(166),n=t.get(59);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(22),!0}onCursorStateChanged(e){var n;const i=e.selections[0].getPosition();return(n=this._primaryPosition)!=null&&n.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var l,c;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,r=this._primaryPosition,o=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),r),a=[];for(let h=t;h<=i;h++){const d=h-t,g=o[d];let p="";const _=((l=e.visibleRangeForPosition(new J(h,1)))==null?void 0:l.left)??0;for(const b of g){const C=b.column===-1?_+(b.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new J(h,b.column)).left;if(C>n||this._maxIndentLeft>0&&C>this._maxIndentLeft)break;const x=b.horizontalLine?b.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",S=b.horizontalLine?(((c=e.visibleRangeForPosition(new J(h,b.horizontalLine.endColumn)))==null?void 0:c.left)??C+this._spaceWidth)-C:this._spaceWidth;p+=`<div class="core-guide ${b.className} ${x}" style="left:${C}px;width:${S}px"></div>`}a[d]=p}this._renderResult=a}getGuidesByLine(e,t,i){const n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?kg.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?kg.EnabledForActive:kg.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let o=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const d=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);o=d.startLineNumber,a=d.endLineNumber,l=d.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),h=[];for(let d=e;d<=t;d++){const g=new Array;h.push(g);const p=n?n[d-e]:[],_=new eh(p),b=r?r[d-e]:0;for(let C=1;C<=b;C++){const x=(C-1)*c+1,S=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||p.length===0)&&o<=d&&d<=a&&C===l;g.push(..._.takeWhile(k=>k.visibleColumn<x)||[]);const y=_.peek();(!y||y.visibleColumn!==x||y.horizontalLine)&&g.push(new hg(x,-1,`core-guide-indent lvl-${(C-1)%30}`+(S?" indent-active":""),null,-1,-1))}g.push(..._.takeWhile(C=>!0)||[])}return h}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function Op(s){if(!(s&&s.isTransparent()))return s}lh((s,e)=>{const t=[{bracketColor:WJ,guideColor:cxe,guideColorActive:mxe},{bracketColor:zJ,guideColor:uxe,guideColorActive:pxe},{bracketColor:UJ,guideColor:hxe,guideColorActive:_xe},{bracketColor:jJ,guideColor:dxe,guideColorActive:bxe},{bracketColor:$J,guideColor:fxe,guideColorActive:wxe},{bracketColor:qJ,guideColor:gxe,guideColorActive:vxe}],i=new QJ,n=[{indentColor:JC,indentColorActive:ey},{indentColor:zSe,indentColorActive:GSe},{indentColor:USe,indentColorActive:KSe},{indentColor:jSe,indentColorActive:YSe},{indentColor:$Se,indentColorActive:QSe},{indentColor:qSe,indentColorActive:XSe}],r=t.map(a=>{const l=s.getColor(a.bracketColor),c=s.getColor(a.guideColor),h=s.getColor(a.guideColorActive),d=Op(Op(c)??(l==null?void 0:l.transparent(.3))),g=Op(Op(h)??l);if(!(!d||!g))return{guideColor:d,guideColorActive:g}}).filter(Xo),o=n.map(a=>{const l=s.getColor(a.indentColor),c=s.getColor(a.indentColorActive),h=Op(l),d=Op(c);if(!(!h||!d))return{indentColor:h,indentColorActive:d}}).filter(Xo);if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});const oE=class oE extends zd{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new J(1,1),this._renderResult=null,this._activeModelLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(75);const t=e.get(76);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(109);const i=e.get(165);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeModelLineNumber!==this._lastCursorModelPosition.lineNumber&&(this._activeModelLineNumber=this._lastCursorModelPosition.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);const n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=Gr?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(c=>!!c.options.lineNumberClassName);r.sort((c,h)=>G.compareRangesUsingEnds(c.range,h.range));let o=0;const a=this._context.viewModel.getLineCount(),l=[];for(let c=i;c<=n;c++){const h=c-i,d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(c,1)).lineNumber;let g=this._getLineRenderLineNumber(c),p="";for(;o<r.length&&r[o].range.endLineNumber<c;)o++;for(let _=o;_<r.length;_++){const{range:b,options:C}=r[_];b.startLineNumber<=c&&(p+=" "+C.lineNumberClassName)}if(!g&&!p){l[h]="";continue}c===a&&this._context.viewModel.getLineLength(c)===0&&(this._renderFinalNewline==="off"&&(g=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeModelLineNumber&&(p+=" active-line-number"),l[h]=`<div class="${oE.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${g}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};oE.CLASS_NAME="line-numbers";let Bk=oE;lh((s,e)=>{const t=s.getColor(VSe),i=s.getColor(JSe);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});const U_="monaco-mouse-cursor-text";class TR{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class Vk{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(59);this.renderWhitespace=i.get(113),this.experimentalWhitespaceRendering=i.get(47),this.renderControlCharacters=i.get(108),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(40),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(75),this.stopRenderingLineAfter=i.get(133),this.fontLigatures=i.get(60),this.verticalScrollbarSize=i.get(117).verticalScrollbarSize,this.useGpu=i.get(46)==="on"}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.experimentalWhitespaceRendering===e.experimentalWhitespaceRendering&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures&&this.verticalScrollbarSize===e.verticalScrollbarSize&&this.useGpu===e.useGpu}}class Mxe{constructor(){this._currentVisibleRange=new G(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class Oxe{constructor(e,t,i,n,r,o,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=r,this.stopScrollTop=o,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class Pxe{constructor(e,t,i,n,r){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=r,this.type="selections";let o=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const h=t[l];o=Math.min(o,h.startLineNumber),a=Math.max(a,h.endLineNumber)}this.minLineNumber=o,this.maxLineNumber=a}}const aE=class aE extends br{constructor(e,t,i){super(e);const n=this._context.configuration,r=this._context.configuration.options,o=r.get(59),a=r.get(166);this._lineHeight=r.get(75),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=a.isViewportWrapping,this._revealHorizontalRightPadding=r.get(114),this._cursorSurroundingLines=r.get(35),this._cursorSurroundingLinesStyle=r.get(36),this._canUseLayerHinting=!r.get(39),this._viewLineOptions=new Vk(n,this._context.theme.type),this._linesContent=i,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new MJ(this._context,{createLine:()=>new Nu(t,this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,wl.write(this.domNode,8),this.domNode.setClassName(`view-lines ${U_}`),vs(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Es(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Es(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new Mxe,this._horizontalRevealRequest=null,this._stickyScrollEnabled=r.get(131).enabled,this._maxNumberStickyLines=r.get(131).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(166)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(59),n=t.get(166);return this._lineHeight=t.get(75),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(114),this._cursorSurroundingLines=t.get(35),this._cursorSurroundingLinesStyle=t.get(36),this._canUseLayerHinting=!t.get(39),this._stickyScrollEnabled=t.get(131).enabled,this._maxNumberStickyLines=t.get(131).maxLineCount,vs(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(165)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new Vk(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let r=t;r<=i;r++)n=this._visibleLines.getVisibleLine(r).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e,this._viewLineOptions.useGpu);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new Oxe(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new Pxe(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new J(n,1);const r=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber();if(n<r||n>o)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new J(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Nu.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){const r=this._visibleLines.getVisibleLine(n);if(e===r.getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const n=new TR(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=G.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;const r=[];let o=0;const a=new TR(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(n.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),h=this._visibleLines.getEndLineNumber();for(let d=n.startLineNumber;d<=n.endLineNumber;d++){if(d<c||d>h)continue;const g=d===n.startLineNumber?n.startColumn:1,p=d!==i,_=p?this._context.viewModel.getLineMaxColumn(d):n.endColumn,C=this._visibleLines.getVisibleLine(d).getVisibleRangesForRange(d,g,_,a);if(C){if(t&&d<i){const x=l;if(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(d+1,1)).lineNumber,x!==l){const S=C.ranges[C.ranges.length-1];S.width+=this._typicalHalfwidthCharacterWidth,this._context.viewModel.getTextDirection(x)===xo.RTL&&(S.left-=this._typicalHalfwidthCharacterWidth)}}r[o++]=new bJ(C.outsideRenderedLine,d,ZC.from(C.ranges),p)}}return this._updateLineWidthsSlowIfDomDidLayout(a),o===0?null:r}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const n=new TR(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),r}_lineIsRenderedRTL(e){return e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber()?!1:this._visibleLines.getVisibleLine(e).isRenderedRTL()}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new wJ(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,r=!0;for(let o=t;o<=i;o++){const a=this._visibleLines.getVisibleLine(o);if(e&&!a.getWidthIsFast()){r=!1;continue}n=Math.max(n,a.getWidth(null))}return r&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++){const o=this._visibleLines.getVisibleLine(r);if(o.needsMonospaceFontCheck()){const a=o.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=i;r<=n;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const n=this._computeScrollLeftToReveal(i);n&&(!this._isViewportWrapping&&!n.hasRTL&&this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Gr&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,r,o){const a=e.top,l=e.height,c=a+l;let h,d,g;if(r&&r.length>0){let x=r[0].startLineNumber,S=r[0].endLineNumber;for(let y=1,k=r.length;y<k;y++){const D=r[y];x=Math.min(x,D.startLineNumber),S=Math.max(S,D.endLineNumber)}h=!1,d=this._context.viewLayout.getVerticalOffsetForLineNumber(x),g=this._context.viewLayout.getVerticalOffsetForLineNumber(S)+this._lineHeight}else if(n)h=!0,d=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),g=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;const p=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let _=0,b=0;if(p)i||(_=this._lineHeight);else{const x=l/this._lineHeight,S=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),y=Math.min(x/2,S);_=y*this._lineHeight,b=Math.max(0,y-1)*this._lineHeight}i||(o===0||o===4)&&(b+=this._lineHeight),d-=_,g+=b;let C;if(g-d>l){if(!h)return-1;C=d}else if(o===5||o===6)if(o===6&&a<=d&&g<=c)C=a;else{const x=Math.max(5*this._lineHeight,l*.2),S=d-x,y=g-l;C=Math.max(y,S)}else if(o===1||o===2)if(o===2&&a<=d&&g<=c)C=a;else{const x=(d+g)/2;C=Math.max(0,x-l/2)}else C=this._computeMinimumScrolling(a,c,d,g,o===3,o===4);return C}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(165),n=t.left,r=n+t.width-i.verticalScrollbarWidth;let o=1073741824,a=0,l=!1;if(e.type==="range"){l=this._lineIsRenderedRTL(e.lineNumber);const h=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!h)return null;for(const d of h.ranges)o=Math.min(o,Math.round(d.left)),a=Math.max(a,Math.round(d.left+d.width))}else for(const h of e.selections){if(h.startLineNumber!==h.endLineNumber)return null;const d=this._visibleRangesForLineRange(h.startLineNumber,h.startColumn,h.endColumn);if(l||(l=this._lineIsRenderedRTL(h.startLineNumber)),!d)return null;for(const g of d.ranges)o=Math.min(o,Math.round(g.left)),a=Math.max(a,Math.round(g.left+g.width))}return e.minimalReveal||(o=Math.max(0,o-aE.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-o>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,r,o,a),maxHorizontalOffset:a,hasRTL:l}}_computeMinimumScrolling(e,t,i,n,r,o){e=e|0,t=t|0,i=i|0,n=n|0,r=!!r,o=!!o;const a=t-e;if(n-i<a){if(r)return i;if(o)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}};aE.HORIZONTAL_EXTRA_PX=30;let k5=aE;class Fxe extends KJ{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(165);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[n++]=new L5(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,c));const h=a.options.firstLineDecorationClassName;h&&(i[n++]=new L5(a.range.startLineNumber,a.range.startLineNumber,h,a.options.linesDecorationsTooltip??null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),r=this._decorationsLeft.toString(),o=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+o+'px;"></div>',l=[];for(let c=t;c<=i;c++){const h=c-t,d=n[h].getDecorations();let g="";for(const p of d){let _='<div class="cldr '+p.className;p.tooltip!==null&&(_+='" title="'+p.tooltip),_+=a,g+=_}l[h]=g}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const v_=class v_ extends br{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._canUseLayerHinting=!t.get(39),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=Tt(document.createElement("div")),this._domNode.setClassName(v_.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Tt(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(v_.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._canUseLayerHinting=!t.get(39),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};v_.CLASS_NAME="glyph-margin",v_.OUTER_CLASS_NAME="margin";let Hk=v_;class Bxe extends KJ{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[n++]=new L5(a.range.startLineNumber,a.range.endLineNumber,l,null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),r=[];for(let o=t;o<=i;o++){const a=o-t,l=n[a].getDecorations();let c="";for(const h of l)c+='<div class="cmdr '+h.className+'" style=""></div>';r[a]=c}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const qh=class qh{constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=qh._clamp(e),this.g=qh._clamp(t),this.b=qh._clamp(i),this.a=qh._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};qh.Empty=new qh(0,0,0,0);let Ku=qh;const lE=class lE extends le{static getInstance(){return this._INSTANCE||(this._INSTANCE=new lE),this._INSTANCE}constructor(){super(),this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(hn.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=hn.getColorMap();if(!e){this._colors=[Ku.Empty],this._backgroundIsLight=!0;return}this._colors=[Ku.Empty];for(let i=1;i<e.length;i++){const n=e[i].rgba;this._colors[i]=new Ku(n.r,n.g,n.b,Math.round(n.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};lE._INSTANCE=null;let Wk=lE;const Vxe=(()=>{const s=[];for(let e=32;e<=126;e++)s.push(e);return s.push(65533),s})(),Hxe=(s,e)=>(s-=32,s<0||s>96?e<=2?(s+96)%96:95:s);class $v{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=$v.soften(e,12/15),this.charDataLight=$v.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,r=e.length;n<r;n++)i[n]=fk(e[n]*t);return i}renderChar(e,t,i,n,r,o,a,l,c,h,d){const g=1*this.scale,p=2*this.scale,_=d?1:p;if(t+g>e.width||i+_>e.height){console.warn("bad render request outside image data");return}const b=h?this.charDataLight:this.charDataNormal,C=Hxe(n,c),x=e.width*4,S=a.r,y=a.g,k=a.b,D=r.r-S,R=r.g-y,N=r.b-k,A=Math.max(o,l),M=e.data;let O=C*g*p,V=i*x+t*4;for(let H=0;H<_;H++){let U=V;for(let X=0;X<g;X++){const Y=b[O++]/255*(o/255);M[U++]=S+D*Y,M[U++]=y+R*Y,M[U++]=k+N*Y,M[U++]=A}V+=x}}blockRenderChar(e,t,i,n,r,o,a,l){const c=1*this.scale,h=2*this.scale,d=l?1:h;if(t+c>e.width||i+d>e.height){console.warn("bad render request outside image data");return}const g=e.width*4,p=.5*(r/255),_=o.r,b=o.g,C=o.b,x=n.r-_,S=n.g-b,y=n.b-C,k=_+x*p,D=b+S*p,R=C+y*p,N=Math.max(r,a),A=e.data;let M=i*g+t*4;for(let O=0;O<d;O++){let V=M;for(let H=0;H<c;H++)A[V++]=k,A[V++]=D,A[V++]=R,A[V++]=N;M+=g}}}const lj={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},cj=s=>{const e=new Uint8ClampedArray(s.length/2);for(let t=0;t<s.length;t+=2)e[t>>1]=lj[s[t]]<<4|lj[s[t+1]]&15;return e},uj={1:wv(()=>cj("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:wv(()=>cj("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class sw{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return uj[e]?i=new $v(uj[e](),e):i=sw.createFromSampleData(sw.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=960,t.style.width="960px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const r of Vxe)i.fillText(String.fromCharCode(r),n,16/2),n+=10;return i.getImageData(0,0,960,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const n=sw._downsample(e,t);return new $v(n,t)}static _downsampleChar(e,t,i,n,r){const o=1*r,a=2*r;let l=n,c=0;for(let h=0;h<a;h++){const d=h/a*16,g=(h+1)/a*16;for(let p=0;p<o;p++){const _=p/o*10,b=(p+1)/o*10;let C=0,x=0;for(let y=d;y<g;y++){const k=t+Math.floor(y)*3840,D=1-(y-Math.floor(y));for(let R=_;R<b;R++){const N=1-(R-Math.floor(R)),A=k+Math.floor(R)*4,M=N*D;x+=M,C+=e[A]*e[A+3]/255*M}}const S=C/x;c=Math.max(c,S),i[l++]=fk(S)}}return c}static _downsample(e,t){const i=2*t*1*t,n=i*96,r=new Uint8ClampedArray(n);let o=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,r,o,t)),o+=i,a+=40;if(l>0){const c=255/l;for(let h=0;h<n;h++)r[h]*=c}return r}}const Wxe=Rr?'"Segoe WPC", "Segoe UI", sans-serif':_t?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';class XJ{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}function zxe(s,e){return!(e.options.hideInCommentTokens&&Uxe(s,e)||e.options.hideInStringTokens&&jxe(s,e))}function Uxe(s,e){return ZJ(s,e.range,t=>t===1)}function jxe(s,e){return ZJ(s,e.range,t=>t===2)}function ZJ(s,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const n=s.tokenization.getLineTokens(i),r=i===e.startLineNumber,o=i===e.endLineNumber;let a=r?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(o&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}const $xe=140,qxe=2;class j_{constructor(e,t,i){const n=e.options,r=n.get(163),o=n.get(165),a=o.minimap,l=n.get(59),c=n.get(81);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(119),this.paddingTop=n.get(96).top,this.paddingBottom=n.get(96).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(75),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=o.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=o.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=Wxe,this.sectionHeaderFontSize=c.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=c.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=j_._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=wv(()=>sw.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=j_._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=j_._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(iCe);return i?new Ku(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(nCe);return t?Ku._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){const i=e.getColor(YC);return i?new Ku(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class rw{constructor(e,t,i,n,r,o,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=r,this.sliderHeight=o,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,r,o,a,l,c,h,d){const g=e.pixelRatio,p=e.minimapLineHeight,_=Math.floor(e.canvasInnerHeight/p),b=e.lineHeight;if(e.minimapHeightIsEditorHeight){let R=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(R+=Math.max(0,r-e.lineHeight-e.paddingBottom));const N=Math.max(1,Math.floor(r*r/R)),A=Math.max(0,e.minimapHeight-N),M=A/(h-r),O=c*M,V=A>0,H=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),U=Math.floor(e.paddingTop/e.lineHeight);return new rw(c,h,V,M,O,N,U,1,Math.min(a,H))}let C;if(o&&i!==a){const R=i-t+1;C=Math.floor(R*p/g)}else{const R=r/b;C=Math.floor(R*p/g)}const x=Math.floor(e.paddingTop/b);let S=Math.floor(e.paddingBottom/b);if(e.scrollBeyondLastLine){const R=r/b;S=Math.max(S,R-1)}let y;if(S>0){const R=r/b;y=(x+a+S-R-1)*p/g}else y=Math.max(0,(x+a)*p/g-C);y=Math.min(e.minimapHeight-C,y);const k=y/(h-r),D=c*k;if(_>=x+a+S){const R=y>0;return new rw(c,h,R,k,D,C,x,1,a)}else{let R;t>1?R=t+x:R=Math.max(1,c/b);let N,A=Math.max(1,Math.floor(R-D*g/p));A<x?(N=x-A+1,A=1):(N=0,A=Math.max(1,A-x)),d&&d.scrollHeight===h&&(d.scrollTop>c&&(A=Math.min(A,d.startLineNumber),N=Math.max(N,d.topPaddingLineCount)),d.scrollTop<c&&(A=Math.max(A,d.startLineNumber),N=Math.min(N,d.topPaddingLineCount)));const M=Math.min(a,A-N+_-1),O=(c-n)/b;let V;return c>=e.paddingTop?V=(t-A+N+O)*p/g:V=c/e.paddingTop*(N+O)*p/g,new rw(c,h,!0,k,V,C,N,A,M)}}}const cE=class cE{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}};cE.INVALID=new cE(-1);let zk=cE;class hj{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new AJ({createLine:()=>zk.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let n=0,r=i.length;n<r;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class K7{constructor(e,t,i,n){this._backgroundFillData=K7._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,r=i.g,o=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let h=0;h<t;h++)for(let d=0;d<e;d++)l[c]=n,l[c+1]=r,l[c+2]=o,l[c+3]=a,c+=4;return l}}class qv{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:n}=A_.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/n,o=r/2;if(!i||i.minimapLines.length===0){const C=[];if(C[0]=1,n>1){for(let x=0,S=n-1;x<S;x++)C[x]=Math.round(x*r+o);C[n-1]=t}return[new qv(r,C),[]]}const a=i.minimapLines,l=a.length,c=[];let h=0,d=0,g=1;const p=10;let _=[],b=null;for(let C=0;C<n;C++){const x=Math.max(g,Math.round(C*r)),S=Math.max(x,Math.round((C+1)*r));for(;h<l&&a[h]<x;){if(_.length<p){const k=h+1+d;b&&b.type==="deleted"&&b._oldIndex===h-1?b.deleteToLineNumber++:(b={type:"deleted",_oldIndex:h,deleteFromLineNumber:k,deleteToLineNumber:k},_.push(b)),d--}h++}let y;if(h<l&&a[h]<=S)y=a[h],h++;else if(C===0?y=1:C+1===n?y=t:y=Math.round(C*r+o),_.length<p){const k=h+1+d;b&&b.type==="inserted"&&b._i===C-1?b.insertToLineNumber++:(b={type:"inserted",_i:C,insertFromLineNumber:k,insertToLineNumber:k},_.push(b)),d++}c[C]=y,g=y}if(_.length<p)for(;h<l;){const C=h+1+d;b&&b.type==="deleted"&&b._oldIndex===h-1?b.deleteToLineNumber++:(b={type:"deleted",_oldIndex:h,deleteFromLineNumber:C,deleteToLineNumber:C},_.push(b)),d--,h++}else _=[{type:"flush"}];return[new qv(r,c),_]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const r=this.minimapLines[i];if(r<e||r>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,r),n=Math.max(n,r)):this.minimapLines[r]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class Gxe extends br{constructor(e){super(e),this._sectionHeaderCache=new jC(10,1.5),this.tokensColorTracker=Wk.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new j_(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=qv.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new a_(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new j_(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged(e)}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=qv.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let r=0,o=t-e+1;r<o;r++)i[r]?n[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):n[r]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Lt(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){return this._getMinimapDecorationsInViewport(e,t).filter(i=>{var n;return!((n=i.options.minimap)!=null&&n.sectionHeaderStyle)})}getSectionHeaderDecorationsInViewport(e,t){const i=this.options.sectionHeaderFontSize/this.options.minimapLineHeight;return e=Math.floor(Math.max(1,e-i)),this._getMinimapDecorationsInViewport(e,t).filter(n=>{var r;return!!((r=n.options.minimap)!=null&&r.sectionHeaderStyle)})}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const r=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new G(r,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new G(e,1,t,this._context.viewModel.getLineMaxColumn(t));const n=this._context.viewModel.getMinimapDecorationsInRange(i);if(this._samplingState){const r=[];for(const o of n){if(!o.options.minimap)continue;const a=o.range,l=this._samplingState.modelLineToMinimapLine(a.startLineNumber),c=this._samplingState.modelLineToMinimapLine(a.endLineNumber);r.push(new XJ(new G(l,a.startColumn,c,a.endColumn),o.options))}return r}return n}getSectionHeaderText(e,t){var o;const i=(o=e.options.minimap)==null?void 0:o.sectionHeaderText;if(!i)return null;const n=this._sectionHeaderCache.get(i);if(n)return n;const r=t(i);return this._sectionHeaderCache.set(i,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new G(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class a_ extends le{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._isMouseOverMinimap=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(KU),this._domNode=Tt(document.createElement("div")),wl.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Tt(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Tt(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Tt(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Tt(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Tt(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._hideDelayedScheduler=this._register(new Es(()=>this._hideImmediatelyIfMouseIsOutside(),500)),this._register(bs(this._domNode.domNode,Le.MOUSE_OVER,()=>{this._isMouseOverMinimap=!0})),this._register(bs(this._domNode.domNode,Le.MOUSE_LEAVE,()=>{this._isMouseOverMinimap=!1})),this._pointerDownListener=bs(this._domNode.domNode,Le.POINTER_DOWN,i=>{i.preventDefault();const n=i.pointerType==="mouse",r=i.button===0;if(this._model.options.renderMinimap!==0&&this._lastRenderData){if(this._model.options.size!=="proportional"){if(r&&this._lastRenderData){const a=ta(this._slider.domNode),l=a.top+a.height/2;this._startSliderDragging(i,l,this._lastRenderData.renderedLayout)}return}if(r||!n){const a=this._model.options.minimapLineHeight,l=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let h=Math.floor(l/a)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;h=Math.min(h,this._model.getLineCount()),this._model.revealLineNumber(h)}}}),this._sliderPointerMoveMonitor=new MD,this._sliderPointerDownListener=bs(this._slider.domNode,Le.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=fr.addTarget(this._domNode.domNode),this._sliderTouchStartListener=ie(this._domNode.domNode,hi.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=ie(this._domNode.domNode,hi.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=bs(this._domNode.domNode,hi.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_hideSoon(){this._hideDelayedScheduler.cancel(),this._hideDelayedScheduler.schedule()}_hideImmediatelyIfMouseIsOutside(){if(this._isMouseOverMinimap){this._hideSoon();return}this._domNode.toggleClassName("active",!1)}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const n=e.pageX;this._slider.toggleClassName("active",!0);const r=(o,a)=>{const l=ta(this._domNode.domNode),c=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(Rr&&c>$xe){this._model.setScrollTop(i.scrollTop);return}const h=o-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(h))};e.pageY!==t&&r(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>r(o.pageY,o.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide==="mouseover"?e.push("minimap-autohide-mouseover"):this._model.options.autohide==="scroll"&&e.push("minimap-autohide-scroll"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new K7(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesDeleted(e,t),!0}onLinesInserted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesInserted(e,t),!0}onScrollChanged(e){return this._model.options.autohide==="scroll"&&(e.scrollTopChanged||e.scrollHeightChanged)&&(this._domNode.toggleClassName("active",!0),this._hideSoon()),this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(KU),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=rw.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(G.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((g,p)=>(g.options.zIndex||0)-(p.options.zIndex||0));const{canvasInnerWidth:n,canvasInnerHeight:r}=this._model.options,o=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,n,r);const h=new dj(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,h,e,o),this._renderDecorationsLineHighlights(c,i,h,e,o);const d=new dj(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,d,e,o,l,a,n),this._renderDecorationsHighlights(c,i,d,e,o,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let o=0,a=0;for(const l of t){const c=n.intersectWithViewport(l);if(!c)continue;const[h,d]=c;for(let _=h;_<=d;_++)i.set(_,!0);const g=n.getYForLineNumber(h,r),p=n.getYForLineNumber(d,r);a>=g||(a>o&&e.fillRect(Ol,o,e.canvas.width,a-o),o=g),a=p}a>o&&e.fillRect(Ol,o,e.canvas.width,a-o)}_renderDecorationsLineHighlights(e,t,i,n,r){const o=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==1)continue;const h=n.intersectWithViewport(l.range);if(!h)continue;const[d,g]=h,p=c.getColor(this._theme.value);if(!p||p.isTransparent())continue;let _=o.get(p.toString());_||(_=p.transparent(.5).toString(),o.set(p.toString(),_)),e.fillStyle=_;for(let b=d;b<=g;b++){if(i.has(b))continue;i.set(b,!0);const C=n.getYForLineNumber(d,r);e.fillRect(Ol,C,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,i,n,r,o,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const h=n.intersectWithViewport(c);if(!h)continue;const[d,g]=h;for(let p=d;p<=g;p++)this.renderDecorationOnLine(e,i,c,this._selectionColor,n,p,r,r,o,a,l)}}_renderDecorationsHighlights(e,t,i,n,r,o,a,l){for(const c of t){const h=c.options.minimap;if(!h)continue;const d=n.intersectWithViewport(c.range);if(!d)continue;const[g,p]=d,_=h.getColor(this._theme.value);if(!(!_||_.isTransparent()))for(let b=g;b<=p;b++)switch(h.position){case 1:this.renderDecorationOnLine(e,i,c.range,_,n,b,r,r,o,a,l);continue;case 2:{const C=n.getYForLineNumber(b,r);this.renderDecoration(e,_,2,C,qxe,r);continue}}}}renderDecorationOnLine(e,t,i,n,r,o,a,l,c,h,d){const g=r.getYForLineNumber(o,l);if(g+a<0||g>this._model.options.canvasInnerHeight)return;const{startLineNumber:p,endLineNumber:_}=i,b=p===o?i.startColumn:1,C=_===o?i.endColumn:this._model.getLineMaxColumn(o),x=this.getXOffsetForPosition(t,o,b,c,h,d),S=this.getXOffsetForPosition(t,o,C,c,h,d);this.renderDecoration(e,n,x,g,S-x,a)}getXOffsetForPosition(e,t,i,n,r,o){if(i===1)return Ol;if((i-1)*r>=o)return o;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Ol];let h=Ol;for(let d=1;d<c.length+1;d++){const g=c.charCodeAt(d-1),p=g===9?n*r:ih(g)?2*r:r,_=h+p;if(_>=o){l[d]=o;break}l[d]=_,h=_}e.set(t,l)}return i-1<l.length?l[i-1]:o}renderDecoration(e,t,i,n,r,o){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,r,o)}_renderSectionHeaders(e){var b;const t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,r=i*1.5,{canvasInnerWidth:o}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,c=this._model.options.sectionHeaderFontColor,h=`rgb(${c.r} ${c.g} ${c.b})`,d=h,g=this._decorationsCanvas.domNode.getContext("2d");g.letterSpacing=n+"px",g.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,g.strokeStyle=d,g.lineWidth=.4;const p=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);p.sort((C,x)=>C.range.startLineNumber-x.range.startLineNumber);const _=a_._fitSectionHeader.bind(null,g,o-Ol);for(const C of p){const x=e.getYForLineNumber(C.range.startLineNumber,t)+i,S=x-i,y=S+2,k=this._model.getSectionHeaderText(C,_);a_._renderSectionLabel(g,k,((b=C.options.minimap)==null?void 0:b.sectionHeaderStyle)===2,l,h,o,S,r,x,y)}}static _fitSectionHeader(e,t,i){if(!i)return i;const n="",r=e.measureText(i).width,o=e.measureText(n).width;if(r<=t||r<=o)return i;const a=i.length,l=r/i.length,c=Math.floor((t-o)/l)-1;let h=Math.ceil(c/2);for(;h>0&&/\s/.test(i[h-1]);)--h;return i.substring(0,h)+n+i.substring(a-(c-h))}static _renderSectionLabel(e,t,i,n,r,o,a,l,c,h){t&&(e.fillStyle=n,e.fillRect(0,a,o,l),e.fillStyle=r,e.fillText(t,Ol,c)),i&&(e.beginPath(),e.moveTo(0,h),e.lineTo(o,h),e.closePath(),e.stroke())}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const Y=this._lastRenderData._get();return new hj(e,Y.imageData,Y.lines)}const r=this._getBuffer();if(!r)return null;const[o,a,l]=a_._renderUntouchedLines(r,e.topPaddingLineCount,t,i,n,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),h=this._model.getOptions().tabSize,d=this._model.options.defaultBackgroundColor,g=this._model.options.backgroundColor,p=this._model.options.foregroundAlpha,_=this._model.tokensColorTracker,b=_.backgroundIsLight(),C=this._model.options.renderMinimap,x=this._model.options.charRenderer(),S=this._model.options.fontScale,y=this._model.options.minimapCharWidth,D=(C===1?2:3)*S,R=n>D?Math.floor((n-D)/2):0,N=g.a/255,A=new Ku(Math.round((g.r-d.r)*N+d.r),Math.round((g.g-d.g)*N+d.g),Math.round((g.b-d.b)*N+d.b),255);let M=e.topPaddingLineCount*n;const O=[];for(let Y=0,q=i-t+1;Y<q;Y++)l[Y]&&a_._renderLine(r,A,g.a,b,C,y,_,p,x,M,R,h,c[Y],S,n),O[Y]=new zk(M),M+=n;const V=o===-1?0:o,U=(a===-1?r.height:a)-V;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,V,r.width,U),new hj(e,r,O)}static _renderUntouchedLines(e,t,i,n,r,o){const a=[];if(!o){for(let M=0,O=n-i+1;M<O;M++)a[M]=!0;return[-1,-1,a]}const l=o._get(),c=l.imageData.data,h=l.rendLineNumberStart,d=l.lines,g=d.length,p=e.width,_=e.data,b=(n-i+1)*r*p*4;let C=-1,x=-1,S=-1,y=-1,k=-1,D=-1,R=t*r;for(let M=i;M<=n;M++){const O=M-i,V=M-h,H=V>=0&&V<g?d[V].dy:-1;if(H===-1){a[O]=!0,R+=r;continue}const U=H*p*4,X=(H+r)*p*4,Y=R*p*4,q=(R+r)*p*4;y===U&&D===Y?(y=X,D=q):(S!==-1&&(_.set(c.subarray(S,y),k),C===-1&&S===0&&S===k&&(C=y),x===-1&&y===b&&S===k&&(x=S)),S=U,y=X,k=Y,D=q),a[O]=!1,R+=r}S!==-1&&(_.set(c.subarray(S,y),k),C===-1&&S===0&&S===k&&(C=y),x===-1&&y===b&&S===k&&(x=S));const N=C===-1?-1:C/(p*4),A=x===-1?-1:x/(p*4);return[N,A,a]}static _renderLine(e,t,i,n,r,o,a,l,c,h,d,g,p,_,b){const C=p.content,x=p.tokens,S=e.width-o,y=b===1;let k=Ol,D=0,R=0;for(let N=0,A=x.getCount();N<A;N++){const M=x.getEndOffset(N),O=x.getForeground(N),V=a.getColor(O);for(;D<M;D++){if(k>S)return;const H=C.charCodeAt(D);if(H===9){const U=g-(D+R)%g;R+=U-1,k+=U*o}else if(H===32)k+=o;else{const U=ih(H)?2:1;for(let X=0;X<U;X++)if(r===2?c.blockRenderChar(e,k,h+d,V,l,t,i,y):c.renderChar(e,k,h+d,H,V,l,t,i,_,n,y),k+=o,k>S)return}}}}}class dj{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,r=this._endLineNumber-this._startLineNumber+1;n<r;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class Kxe extends br{constructor(e,t){super(e),this._viewDomNode=t;const n=this._context.configuration.options.get(165);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Tt(document.createElement("div")),wl.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Tt(document.createElement("div")),wl.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}_widgetCanOverflow(e){const i=this._context.configuration.options.get(4);return(e.allowEditorOverflow||!1)&&i}addWidget(e){const t=Tt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._widgetCanOverflow(e)?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()],n=t?t.preference:null,r=t==null?void 0:t.stackOridinal;return i.preference===n&&i.stack===r?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var i,n;let e=0;const t=Object.keys(this._widgets);for(let r=0,o=t.length;r<o;r++){const a=t[r],c=(n=(i=this._widgets[a].widget).getMinContentWidthInPx)==null?void 0:n.call(i);typeof c<"u"&&(e=Math.max(e,c))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){const i=e.domNode;if(e.preference===null){i.setTop("");return}const n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){const r=i.domNode.clientHeight;i.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{const{top:r,left:o}=e.preference;if(this._context.configuration.options.get(51)&&this._widgetCanOverflow(e.widget)){const l=this._viewDomNodeRect;i.setTop(r+l.top),i.setLeft(o+l.left),i.setPosition("fixed")}else i.setTop(r),i.setLeft(o),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=ta(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,r)=>(this._widgets[n].stack||0)-(this._widgets[r].stack||0));for(let n=0,r=t.length;n<r;n++){const o=t[n];this._renderWidget(this._widgets[o],i)}}}class Yxe{constructor(e,t){const i=e.options;this.lineHeight=i.get(75),this.pixelRatio=i.get(163),this.overviewRulerLanes=i.get(95),this.renderBorder=i.get(94);const n=t.getColor(txe);this.borderColor=n?n.toString():null,this.hideCursor=i.get(68);const r=t.getColor(UD);this.cursorColorSingle=r?r.transparent(.7).toString():null;const o=t.getColor(VJ);this.cursorColorPrimary=o?o.transparent(.7).toString():null;const a=t.getColor(HJ);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;const l=i.get(81),c=l.enabled,h=l.side,d=t.getColor(ixe),g=hn.getDefaultBackground();d?this.backgroundColor=d:c&&h==="right"?this.backgroundColor=g:this.backgroundColor=null;const _=i.get(165).overviewRuler;this.top=_.top,this.right=_.right,this.domWidth=_.width,this.domHeight=_.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[b,C]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=b,this.w=C}_initLanes(e,t,i){const n=t-e;if(i>=3){const r=Math.floor(n/3),o=Math.floor(n/3),a=n-r-o,l=e,c=l+r,h=l+r+a;return[[0,l,c,l,h,l,c,l],[0,r,a,r+a,o,r+a+o,a+o,r+a+o]]}else if(i===2){const r=Math.floor(n/2),o=n-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,o,r+o,r+o,r+o]]}else{const r=e,o=n;return[[0,r,r,r,r,r,r,r],[0,o,o,o,o,o,o,o]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&me.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class Qxe extends br{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=Tt(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=hn.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new J(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Yxe(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>J.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?me.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Pv.compareByRenderingProps),this._actualShouldRender===1&&!Pv.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!Sn(this._renderedCursorPositions,this._cursorPositions,(_,b)=>_.position.lineNumber===b.position.lineNumber&&_.color===b.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,n=this._settings.canvasHeight,r=this._settings.lineHeight,o=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,c=6*this._settings.pixelRatio|0,h=c/2|0,d=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(d.fillStyle=me.Format.CSS.formatHexA(e),d.fillRect(0,0,i,n)):(d.clearRect(0,0,i,n),d.fillStyle=me.Format.CSS.formatHexA(e),d.fillRect(0,0,i,n)):d.clearRect(0,0,i,n);const g=this._settings.x,p=this._settings.w;for(const _ of t){const b=_.color,C=_.data;d.fillStyle=b;let x=0,S=0,y=0;for(let k=0,D=C.length/3;k<D;k++){const R=C[3*k],N=C[3*k+1],A=C[3*k+2];let M=o.getVerticalOffsetForLineNumber(N)*l|0,O=(o.getVerticalOffsetForLineNumber(A)+r)*l|0;if(O-M<c){let H=(M+O)/2|0;H<h?H=h:H+h>n&&(H=n-h),M=H-h,O=H+h}M>y+1||R!==x?(k!==0&&d.fillRect(g[x],S,p[x],y-S),x=R,S=M,y=O):O>y&&(y=O)}d.fillRect(g[x],S,p[x],y-S)}if(!this._settings.hideCursor){const _=2*this._settings.pixelRatio|0,b=_/2|0,C=this._settings.x[7],x=this._settings.w[7];let S=-100,y=-100,k=null;for(let D=0,R=this._cursorPositions.length;D<R;D++){const N=this._cursorPositions[D].color;if(!N)continue;const A=this._cursorPositions[D].position;let M=o.getVerticalOffsetForLineNumber(A.lineNumber)*l|0;M<b?M=b:M+b>n&&(M=n-b);const O=M-b,V=O+_;O>y+1||N!==k?(D!==0&&k&&d.fillRect(C,S,x,y-S),S=O,y=V):V>y&&(y=V),k=N,d.fillStyle=N}k&&d.fillRect(C,S,x,y-S)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(d.beginPath(),d.lineWidth=1,d.strokeStyle=this._settings.borderColor,d.moveTo(0,0),d.lineTo(0,n),d.moveTo(1,0),d.lineTo(i,0),d.stroke())}}class fj{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class JJ{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class Xxe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(JJ.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),r=i/n,o=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const h=this._zones[l];if(!e){const k=h.getColorZones();if(k){a.push(k);continue}}const d=this._getVerticalOffsetForLine(h.startLineNumber),g=h.heightInLines===0?this._getVerticalOffsetForLine(h.endLineNumber)+t:d+h.heightInLines*t,p=Math.floor(r*d),_=Math.floor(r*g);let b=Math.floor((p+_)/2),C=_-b;C<o&&(C=o),b-C<0&&(b=C),b+C>i&&(b=i-C);const x=h.color;let S=this._color2Id[x];S||(S=++this._lastAssignedId,this._color2Id[x]=S,this._id2Color[S]=x);const y=new fj(b-C,b+C,S);h.setColorZone(y),a.push(y)}return this._colorZonesInvalid=!1,a.sort(fj.compare),a}}class Zxe extends Im{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=Tt(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Xxe(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(75)),this._zoneManager.setPixelRatio(i.get(163)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(75)&&(this._zoneManager.setLineHeight(t.get(75)),this._render()),e.hasChanged(163)&&(this._zoneManager.setPixelRatio(t.get(163)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(r,i,n,e),!0}_renderOneLane(e,t,i,n){let r=0,o=0,a=0;for(const l of t){const c=l.colorId,h=l.from,d=l.to;c!==r?(e.fillRect(0,o,n,a-o),r=c,e.fillStyle=i[r],o=h,a=d):a>=h?a=Math.max(a,d):(e.fillRect(0,o,n,a-o),o=h,a=d)}e.fillRect(0,o,n,a-o)}}class Jxe extends br{constructor(e){super(e),this.domNode=Tt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(116),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(116),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.viewModel.model.getOptions(),r=n;let o=t-e;for(;o>0;){const a=Tt(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),o--}return}let i=e-t;for(;i>0;){const n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const n=this._renderedRulers[t],r=this._rulers[t];n.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}}class eLe extends br{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(117);this._useShadows=i.useShadows,this._domNode=Tt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(165);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(117);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class tLe{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class iLe{constructor(e,t){this.lineNumber=e,this.ranges=t}}function nLe(s){return new tLe(s)}function sLe(s){return new iLe(s.lineNumber,s.ranges.map(nLe))}const Ui=class Ui extends zd{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._roundedSelection=t.get(115),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._roundedSelection=t.get(115),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let r=null,o=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!r&&c<i.length;c++)i[c].lineNumber===a&&(r=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!o&&c>=0;c--)i[c].lineNumber===l&&(o=i[c].ranges[0]);r&&!r.startStyle&&(r=null),o&&!o.startStyle&&(o=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],h=c.left,d=c.left+c.width,g={top:0,bottom:0},p={top:0,bottom:0};if(a>0){const _=t[a-1].ranges[0].left,b=t[a-1].ranges[0].left+t[a-1].ranges[0].width;ex(h-_)<n?g.top=2:h>_&&(g.top=1),ex(d-b)<n?p.top=2:_<d&&d<b&&(p.top=1)}else r&&(g.top=r.startStyle.top,p.top=r.endStyle.top);if(a+1<l){const _=t[a+1].ranges[0].left,b=t[a+1].ranges[0].left+t[a+1].ranges[0].width;ex(h-_)<n?g.bottom=2:_<h&&h<b&&(g.bottom=1),ex(d-b)<n?p.bottom=2:d<b&&(p.bottom=1)}else o&&(g.bottom=o.startStyle.bottom,p.bottom=o.endStyle.bottom);c.startStyle=g,c.endStyle=p}}_getVisibleRangesWithStyle(e,t,i){const r=(t.linesVisibleRangesForRange(e,!0)||[]).map(sLe);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,i),r}_createSelectionPiece(e,t,i,n,r){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;const r=!!n[0].ranges[0].startStyle,o=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,c=n.length;l<c;l++){const h=n[l],d=h.lineNumber,g=d-t,p=i&&d===o?1:0,_=i&&d!==o&&d===a?1:0;let b="",C="";for(let x=0,S=h.ranges.length;x<S;x++){const y=h.ranges[x];if(r){const D=y.startStyle,R=y.endStyle;if(D.top===1||D.bottom===1){b+=this._createSelectionPiece(p,_,Ui.SELECTION_CLASS_NAME,y.left-Ui.ROUNDED_PIECE_WIDTH,Ui.ROUNDED_PIECE_WIDTH);let N=Ui.EDITOR_BACKGROUND_CLASS_NAME;D.top===1&&(N+=" "+Ui.SELECTION_TOP_RIGHT),D.bottom===1&&(N+=" "+Ui.SELECTION_BOTTOM_RIGHT),b+=this._createSelectionPiece(p,_,N,y.left-Ui.ROUNDED_PIECE_WIDTH,Ui.ROUNDED_PIECE_WIDTH)}if(R.top===1||R.bottom===1){b+=this._createSelectionPiece(p,_,Ui.SELECTION_CLASS_NAME,y.left+y.width,Ui.ROUNDED_PIECE_WIDTH);let N=Ui.EDITOR_BACKGROUND_CLASS_NAME;R.top===1&&(N+=" "+Ui.SELECTION_TOP_LEFT),R.bottom===1&&(N+=" "+Ui.SELECTION_BOTTOM_LEFT),b+=this._createSelectionPiece(p,_,N,y.left+y.width,Ui.ROUNDED_PIECE_WIDTH)}}let k=Ui.SELECTION_CLASS_NAME;if(r){const D=y.startStyle,R=y.endStyle;D.top===0&&(k+=" "+Ui.SELECTION_TOP_LEFT),D.bottom===0&&(k+=" "+Ui.SELECTION_BOTTOM_LEFT),R.top===0&&(k+=" "+Ui.SELECTION_TOP_RIGHT),R.bottom===0&&(k+=" "+Ui.SELECTION_BOTTOM_RIGHT)}C+=this._createSelectionPiece(p,_,k,y.left,y.width)}e[g][0]+=b,e[g][1]+=C}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let o=i;o<=n;o++){const a=o-i;t[a]=["",""]}const r=[];for(let o=0,a=this._selections.length;o<a;o++){const l=this._selections[o];if(l.isEmpty()){r[o]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[o]);r[o]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([o,a])=>o+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Ui.SELECTION_CLASS_NAME="selected-text",Ui.SELECTION_TOP_LEFT="top-left-radius",Ui.SELECTION_BOTTOM_LEFT="bottom-left-radius",Ui.SELECTION_TOP_RIGHT="top-right-radius",Ui.SELECTION_BOTTOM_RIGHT="bottom-right-radius",Ui.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",Ui.ROUNDED_PIECE_WIDTH=10;let E5=Ui;lh((s,e)=>{const t=s.getColor(Vve);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function ex(s){return s<0?-s:s}class gj{constructor(e,t,i,n,r,o,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=n,this.height=r,this.textContent=o,this.textContentClassName=a}}var Ou;(function(s){s[s.Single=0]="Single",s[s.MultiPrimary=1]="MultiPrimary",s[s.MultiSecondary=2]="MultiSecondary"})(Ou||(Ou={}));class mj{constructor(e,t){this._context=e;const i=this._context.configuration.options,n=i.get(59);this._cursorStyle=i.get(161),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(37),this._typicalHalfwidthCharacterWidth),this._lineCursorHeight=i.get(38),this._isVisible=!0,this._domNode=Tt(document.createElement("div")),this._domNode.setClassName(`cursor ${U_}`),this._domNode.setHeight(this._context.viewLayout.getLineHeightForLineNumber(1)),this._domNode.setTop(0),this._domNode.setLeft(0),vs(this._domNode,n),this._domNode.setDisplay("none"),this._position=new J(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case Ou.Single:this._pluralityClass="";break;case Ou.MultiPrimary:this._pluralityClass="cursor-primary";break;case Ou.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(59);return this._cursorStyle=t.get(161),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(37),this._typicalHalfwidthCharacterWidth),this._lineCursorHeight=t.get(38),vs(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,r]=h_e(i,t-1);return[new J(e,n+1),i.substring(n,r)]}_prepareRender(e){let t="",i="";const[n,r]=this._getGraphemeAwarePosition(),o=this._context.viewLayout.getLineHeightForLineNumber(n.lineNumber),a=this._lineCursorHeight===0?o:Math.min(o,this._lineCursorHeight),l=(o-a)/2;if(this._cursorStyle===Dn.Line||this._cursorStyle===Dn.LineThin){const b=e.visibleRangeForPosition(n);if(!b||b.outsideRenderedLine)return null;const C=Ue(this._domNode.domNode);let x;this._cursorStyle===Dn.Line?(x=Tz(C,this._lineCursorWidth>0?this._lineCursorWidth:2),x>2&&(t=r,i=this._getTokenClassName(n))):x=Tz(C,1);let S=b.left,y=0;x>=2&&S>=1&&(y=1,S-=y);const k=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta+l;return new gj(k,S,y,x,a,t,i)}const c=e.linesVisibleRangesForRange(new G(n.lineNumber,n.column,n.lineNumber,n.column+r.length),!1);if(!c||c.length===0)return null;const h=c[0];if(h.outsideRenderedLine||h.ranges.length===0)return null;const d=h.ranges[0],g=r==="	"?this._typicalHalfwidthCharacterWidth:d.width<1?this._typicalHalfwidthCharacterWidth:d.width;this._cursorStyle===Dn.Block&&(t=r,i=this._getTokenClassName(n));let p=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,_=o;return(this._cursorStyle===Dn.Underline||this._cursorStyle===Dn.UnderlineThin)&&(p+=o-2,_=2),new gj(p,d.left,0,g,_,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${U_} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}const Hw=class Hw extends br{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(104),this._cursorBlinking=t.get(32),this._cursorStyle=t.get(161),this._cursorSmoothCaretAnimation=t.get(33),this._editContextEnabled=t.get(170),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new mj(this._context,Ou.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=Tt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new _c,this._cursorFlatBlinkInterval=new o7,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(104),this._cursorBlinking=t.get(32),this._cursorStyle=t.get(161),this._cursorSmoothCaretAnimation=t.get(33),this._editContextEnabled=t.get(170),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?Ou.MultiPrimary:Ou.Single),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){const r=t.length-this._secondaryCursors.length;for(let o=0;o<r;o++){const a=new mj(this._context,Ou.MultiSecondary);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const r=this._secondaryCursors.length-t.length;for(let o=0;o<r;o++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],n)}onCursorStateChanged(e){const t=[];for(let n=0,r=e.selections.length;n<r;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let n=0,r=e.ranges.length;n<r;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput&&!this._editContextEnabled||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},Hw.BLINK_INTERVAL,Ue(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},Hw.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case Dn.Line:e+=" cursor-line-style";break;case Dn.Block:e+=" cursor-block-style";break;case Dn.Underline:e+=" cursor-underline-style";break;case Dn.LineThin:e+=" cursor-line-thin-style";break;case Dn.BlockOutline:e+=" cursor-block-outline-style";break;case Dn.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let r=0,o=this._secondaryCursors.length;r<o;r++){const a=this._secondaryCursors[r].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};Hw.BLINK_INTERVAL=500;let D5=Hw;lh((s,e)=>{const t=[{class:".cursor",foreground:UD,background:q7},{class:".cursor-primary",foreground:VJ,background:FSe},{class:".cursor-secondary",foreground:HJ,background:BSe}];for(const i of t){const n=s.getColor(i.foreground);if(n){let r=s.getColor(i.background);r||(r=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${r}; }`),W_(s.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});const NR=()=>{throw new Error("Invalid change accessor")};class rLe extends br{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._lineHeight=t.get(75),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=Tt(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Tt(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l],h=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=h.isInHiddenArea;const d=t.get(l);d&&(d.afterLineNumber!==h.afterViewLineNumber||d.height!==h.heightInPx)&&(n.changeOneWhitespace(l,h.afterViewLineNumber,h.heightInPx),this._safeCallOnComputedHeight(c.delegate,h.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._lineHeight=t.get(75),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(75)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const o=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new J(o,this._context.viewModel.model.getLineMaxColumn(o))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!r,afterViewLineNumber:n.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const n={addZone:r=>(t=!0,this._addZone(i,r)),removeZone:r=>{r&&(t=this._removeZone(i,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(i,r)||t)}};oLe(e,n),n.addZone=NR,n.removeZone=NR,n.layoutZone=NR}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:Tt(t.domNode),marginDomNode:t.marginDomNode?Tt(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,i.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){$t(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){$t(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const o of t)this._zones[o.id].isInHiddenArea||(i[o.id]=o,n=!0);const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l];let h=0,d=0,g="none";i.hasOwnProperty(l)?(h=i[l].verticalOffset-e.bigNumbersDelta,d=i[l].height,g="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(h),c.domNode.setHeight(d),c.domNode.setDisplay(g),c.marginDomNode&&(c.marginDomNode.setTop(h),c.marginDomNode.setHeight(d),c.marginDomNode.setDisplay(g))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function oLe(s,e){try{return s(e)}catch(t){$t(t);return}}class aLe extends zd{constructor(e){super(),this._context=e,this._options=new pj(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new pj(this._context.configuration);return this._options.equals(t)?e.hasChanged(165):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,r=new Array(n);for(let o=0;o<n;o++)r[o]=!0;this._renderResult=[];for(let o=e.viewportData.startLineNumber;o<=e.viewportData.endLineNumber;o++){const a=o-e.viewportData.startLineNumber,l=this._context.viewModel.getViewLineRenderingData(o);let c=null;if(this._options.renderWhitespace==="selection"){const h=this._selection;for(const d of h){if(d.endLineNumber<o||d.startLineNumber>o)continue;const g=d.startLineNumber===o?d.startColumn:l.minColumn,p=d.endLineNumber===o?d.endColumn:l.maxColumn;g<p&&(c||(c=[]),c.push(new ze(g-1,p-1)))}}this._renderResult[a]=this._applyRenderWhitespace(e,o,c,l)}}_applyRenderWhitespace(e,t,i,n){if(n.hasVariableFonts||this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";const r=this._context.theme.getColor(G7),o=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=n.continuesWithWrappedLine,h=n.minColumn-1,d=this._options.renderWhitespace==="boundary",g=this._options.renderWhitespace==="trailing",p=e.getLineHeightForLineNumber(t),_=this._options.middotWidth,b=this._options.wsmiddotWidth,C=this._options.spaceWidth,x=Math.abs(b-C),S=Math.abs(_-C),y=x<S?11825:183,k=this._options.canUseHalfwidthRightwardsArrow;let D="",R=!1,N=qr(a),A;N===-1?(R=!0,N=l,A=l):A=Sm(a);let M=0,O=i&&i[M],V=0;for(let H=h;H<l;H++){const U=a.charCodeAt(H);if(O&&O.endExclusive<=H&&(M++,O=i&&i[M]),U!==9&&U!==32||g&&!R&&H<=A)continue;if(d&&H>=N&&H<=A&&U===32){const Y=H-1>=0?a.charCodeAt(H-1):0,q=H+1<l?a.charCodeAt(H+1):0;if(Y!==32&&q!==32)continue}if(d&&c&&H===l-1){const Y=H-1>=0?a.charCodeAt(H-1):0;if(U===32&&Y!==32&&Y!==9)continue}if(i&&!(O&&O.start<=H&&H<O.endExclusive))continue;const X=e.visibleRangeForPosition(new J(t,H+1));X&&(o?(V=Math.max(V,X.left),U===9?D+=this._renderArrow(p,C,X.left):D+=`<circle cx="${(X.left+C/2).toFixed(2)}" cy="${(p/2).toFixed(2)}" r="${(C/7).toFixed(2)}" />`):U===9?D+=`<div class="mwh" style="left:${X.left}px;height:${p}px;">${k?"":""}</div>`:D+=`<div class="mwh" style="left:${X.left}px;height:${p}px;">${String.fromCharCode(y)}</div>`)}return o?(V=Math.round(V+C),`<svg style="bottom:0;position:absolute;width:${V}px;height:${p}px" viewBox="0 0 ${V} ${p}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+D+"</svg>"):D}_renderArrow(e,t,i){const n=t/7,r=t,o=e/2,a=i,l={x:0,y:n/2},c={x:100/125*r,y:l.y},h={x:c.x-.2*c.x,y:c.y+.2*c.x},d={x:h.x+.1*c.x,y:h.y+.1*c.x},g={x:d.x+.35*c.x,y:d.y-.35*c.x},p={x:g.x,y:-g.y},_={x:d.x,y:-d.y},b={x:h.x,y:-h.y},C={x:c.x,y:-c.y},x={x:l.x,y:-l.y};return`<path d="M ${[l,c,h,d,g,p,_,b,C,x].map(k=>`${(a+k.x).toFixed(2)} ${(o+k.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class pj{constructor(e){const t=e.options,i=t.get(59),n=t.get(47);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(113),this.renderWithSVG=!0):(this.renderWhitespace=t.get(113),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(75),this.stopRenderingLineAfter=t.get(133)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}class lLe{constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new G(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class cLe{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class uLe{constructor(e,t,i){this.configuration=e,this.theme=new cLe(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}const Eg=new Float32Array([1,0,1,1,0,1,0,0,0,1,1,0]);function A1(s){if(!s)throw new Error(`Value "${s}" cannot be null`);return s}function eee(s,e,t){let i=new e.ResizeObserver(n=>{const r=n.find(l=>l.target===s);if(!r)return;if(!("devicePixelContentBoxSize"in r)){i==null||i.disconnect(),i=void 0;return}const o=r.devicePixelContentBoxSize[0].inlineSize,a=r.devicePixelContentBoxSize[0].blockSize;o>0&&a>0&&t(o,a)});try{i.observe(s,{box:["device-pixel-content-box"]})}catch{throw i.disconnect(),i=void 0,new $e("Could not observe device pixel dimensions")}return qe(()=>i==null?void 0:i.disconnect())}var hLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};let dLe=0;class Uk extends le{get cacheKey(){return`${this.fontFamily}_${this.fontSize}px`}constructor(e,t,i,n){super(),this.fontSize=e,this.fontFamily=t,this.devicePixelRatio=i,this._decorationStyleCache=n,this.id=dLe++,this._workGlyph={source:null,boundingBox:{left:0,bottom:0,right:0,top:0},originOffset:{x:0,y:0},fontBoundingBoxAscent:0,fontBoundingBoxDescent:0},this._workGlyphConfig={chars:void 0,tokenMetadata:0,decorationStyleSetId:0},this._antiAliasing=_t?"greyscale":"subpixel";const r=Math.ceil(this.fontSize*i);this._canvas=new OffscreenCanvas(r*3,r*3),this._ctx=A1(this._canvas.getContext("2d",{willReadFrequently:!0,alpha:this._antiAliasing==="greyscale"})),this._ctx.textBaseline="top",this._ctx.fillStyle="#FFFFFF",this._ctx.font=`${r}px ${this.fontFamily}`,this._textMetrics=this._ctx.measureText("A")}rasterizeGlyph(e,t,i,n){return e===""?{source:this._canvas,boundingBox:{top:0,left:0,bottom:-1,right:-1},originOffset:{x:0,y:0},fontBoundingBoxAscent:0,fontBoundingBoxDescent:0}:this._workGlyphConfig.chars===e&&this._workGlyphConfig.tokenMetadata===t&&this._workGlyphConfig.decorationStyleSetId===i?this._workGlyph:(this._workGlyphConfig.chars=e,this._workGlyphConfig.tokenMetadata=t,this._workGlyphConfig.decorationStyleSetId=i,this._rasterizeGlyph(e,t,i,n))}_rasterizeGlyph(e,t,i,n){const r=Math.ceil(this.fontSize*this.devicePixelRatio),o=r*3;this._canvas.width!==o&&(this._canvas.width=o,this._canvas.height=o),this._ctx.save();const a=(t&15)/10,l=_o.getBackground(t),c=n[l],h=this._decorationStyleCache.getStyleSet(i);this._antiAliasing==="subpixel"?(this._ctx.fillStyle=c,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)):this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);const d=new J1(200),g=_o.getFontStyle(t);g&1&&d.appendString("italic "),(h==null?void 0:h.bold)!==void 0?h.bold&&d.appendString("bold "):g&2&&d.appendString("bold "),d.appendString(`${r}px ${this.fontFamily}`),this._ctx.font=d.build();const p=r,_=r;(h==null?void 0:h.color)!==void 0?this._ctx.fillStyle=`#${h.color.toString(16).padStart(8,"0")}`:this._ctx.fillStyle=n[_o.getForeground(t)],this._ctx.textBaseline="top",(h==null?void 0:h.opacity)!==void 0&&(this._ctx.globalAlpha=h.opacity),this._ctx.fillText(e,p+a,_),this._ctx.restore();const b=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height);if(this._antiAliasing==="subpixel"){const C=parseInt(c.substring(1,3),16),x=parseInt(c.substring(3,5),16),S=parseInt(c.substring(5,7),16);this._clearColor(b,C,x,S),this._ctx.putImageData(b,0,0)}return this._findGlyphBoundingBox(b,this._workGlyph.boundingBox),this._workGlyph.source=this._canvas,this._workGlyph.originOffset.x=this._workGlyph.boundingBox.left-p,this._workGlyph.originOffset.y=this._workGlyph.boundingBox.top-_,this._workGlyph.fontBoundingBoxAscent=this._textMetrics.fontBoundingBoxAscent,this._workGlyph.fontBoundingBoxDescent=this._textMetrics.fontBoundingBoxDescent,this._workGlyph}_clearColor(e,t,i,n){for(let r=0;r<e.data.length;r+=4)e.data[r]===t&&e.data[r+1]===i&&e.data[r+2]===n&&(e.data[r+3]=0)}_findGlyphBoundingBox(e,t){const i=this._canvas.height,n=this._canvas.width;let r=!1;for(let o=0;o<i;o++){for(let a=0;a<n;a++){const l=o*n*4+a*4+3;if(e.data[l]!==0){t.top=o,r=!0;break}}if(r)break}t.left=0,r=!1;for(let o=0;o<n;o++){for(let a=0;a<i;a++){const l=a*n*4+o*4+3;if(e.data[l]!==0){t.left=o,r=!0;break}}if(r)break}t.right=n,r=!1;for(let o=n-1;o>=t.left;o--){for(let a=0;a<i;a++){const l=a*n*4+o*4+3;if(e.data[l]!==0){t.right=o,r=!0;break}}if(r)break}t.bottom=t.top,r=!1;for(let o=i-1;o>=0;o--){for(let a=0;a<n;a++){const l=o*n*4+a*4+3;if(e.data[l]!==0){t.bottom=o,r=!0;break}}if(r)break}}getTextMetrics(e){return this._ctx.measureText(e)}}hLe([Vi],Uk.prototype,"cacheKey",null);var fLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},gLe=function(s,e){return function(t,i){e(t,i,s)}};let jk=class extends le{constructor(e){super(),this._logService=e,this._tasks=[],this._i=0,this._register(qe(()=>this.clear()))}enqueue(e){this._tasks.push(e),this._start()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,n=e.timeRemaining(),r=0;for(;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),i=Math.max(t,i),r=e.timeRemaining(),i*1.5>r){n-t<-20&&this._logService.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),this._start();return}n=r}this.clear()}};jk=fLe([gLe(0,pr)],jk);class mLe extends jk{_requestCallback(e){return Kt().setTimeout(()=>e(this._createDeadline(16)))}_cancelCallback(e){Kt().clearTimeout(e)}_createDeadline(e){const t=Date.now()+e;return{timeRemaining:()=>Math.max(0,t-Date.now())}}}class pLe extends jk{_requestCallback(e){return Kt().requestIdleCallback(e)}_cancelCallback(e){Kt().cancelIdleCallback(e)}}const _Le="requestIdleCallback"in Kt()?pLe:mLe;class bLe{constructor(e,t){this._canvas=e,this._textureIndex=t,this._currentRow={x:0,y:0,h:0},this._allocatedGlyphs=new Set,this._nextIndex=0,this._ctx=A1(this._canvas.getContext("2d",{willReadFrequently:!0}))}allocate(e){const t=e.boundingBox.right-e.boundingBox.left+1,i=e.boundingBox.bottom-e.boundingBox.top+1;if(t>this._canvas.width||i>this._canvas.height)throw new $e("Glyph is too large for the atlas page");if(e.boundingBox.right-e.boundingBox.left+1>this._canvas.width-this._currentRow.x&&(this._currentRow.x=0,this._currentRow.y+=this._currentRow.h,this._currentRow.h=1),this._currentRow.y+e.boundingBox.bottom-e.boundingBox.top+1>this._canvas.height)return;this._ctx.drawImage(e.source,e.boundingBox.left,e.boundingBox.top,t,i,this._currentRow.x,this._currentRow.y,t,i);const n={pageIndex:this._textureIndex,glyphIndex:this._nextIndex++,x:this._currentRow.x,y:this._currentRow.y,w:t,h:i,originOffsetX:e.originOffset.x,originOffsetY:e.originOffset.y,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent};return this._currentRow.x+=t,this._currentRow.h=Math.max(this._currentRow.h,i),this._allocatedGlyphs.add(n),n}getUsagePreview(){const e=this._canvas.width,t=this._canvas.height,i=new OffscreenCanvas(e,t),n=A1(i.getContext("2d"));n.fillStyle="#808080",n.fillRect(0,0,e,t);const r=new Map,o=new Map;for(const a of this._allocatedGlyphs)r.set(a.y,Math.max(r.get(a.y)??0,a.h)),o.set(a.y,Math.max(o.get(a.y)??0,a.x+a.w));for(const a of this._allocatedGlyphs)n.fillStyle="#4040FF",n.fillRect(a.x,a.y,a.w,a.h),n.fillStyle="#FF0000",n.fillRect(a.x,a.y+a.h,a.w,r.get(a.y)-a.h);for(const[a,l]of o.entries())a!==this._currentRow.y&&(n.fillStyle="#FF0000",n.fillRect(l,a,e-l,r.get(a)));return i.convertToBlob()}getStats(){const e=this._canvas.width,t=this._canvas.height;let i=0,n=0;const r=e*t,o=new Map,a=new Map;for(const l of this._allocatedGlyphs)o.set(l.y,Math.max(o.get(l.y)??0,l.h)),a.set(l.y,Math.max(a.get(l.y)??0,l.x+l.w));for(const l of this._allocatedGlyphs)i+=l.w*l.h,n+=l.w*(o.get(l.y)-l.h);for(const[l,c]of a.entries())l!==this._currentRow.y&&(n+=(e-c)*o.get(l));return[`page${this._textureIndex}:`,`     Total: ${r} (${e}x${t})`,`      Used: ${i} (${(i/r*100).toPrecision(2)}%)`,`    Wasted: ${n} (${(n/r*100).toPrecision(2)}%)`,`Efficiency: ${(i/(i+n)*100).toPrecision(2)}%`].join(`
`)}}class wLe{constructor(e,t,i){this._canvas=e,this._textureIndex=t,this._slabs=[],this._activeSlabsByDims=new kD,this._unusedRects=[],this._openRegionsByHeight=new Map,this._openRegionsByWidth=new Map,this._allocatedGlyphs=new Set,this._nextIndex=0,this._ctx=A1(this._canvas.getContext("2d",{willReadFrequently:!0})),this._slabW=Math.min((i==null?void 0:i.slabW)??64<<Math.max(Math.floor(Kt().devicePixelRatio)-1,0),this._canvas.width),this._slabH=Math.min((i==null?void 0:i.slabH)??this._slabW,this._canvas.height),this._slabsPerRow=Math.floor(this._canvas.width/this._slabW),this._slabsPerColumn=Math.floor(this._canvas.height/this._slabH)}allocate(e){const t=e.boundingBox.right-e.boundingBox.left+1,i=e.boundingBox.bottom-e.boundingBox.top+1;if(t>this._canvas.width||i>this._canvas.height)throw new $e("Glyph is too large for the atlas page");if(t>this._slabW||i>this._slabH){if(this._allocatedGlyphs.size>0)return;let c=this._canvas.width;for(;t<c/2&&i<c/2;)c/=2;this._slabW=c,this._slabH=c,this._slabsPerRow=Math.floor(this._canvas.width/this._slabW),this._slabsPerColumn=Math.floor(this._canvas.height/this._slabH)}const n={w:t,h:i};let r=this._activeSlabsByDims.get(n.w,n.h);if(r){const c=Math.floor(this._slabW/r.entryW)*Math.floor(this._slabH/r.entryH);r.count>=c&&(r=void 0)}let o,a;if(!r)if(t<i){const c=this._openRegionsByWidth.get(t);if(c!=null&&c.length)for(let h=c.length-1;h>=0;h--){const d=c[h];if(d.w>=t&&d.h>=i){o=d.x,a=d.y,t<d.w&&this._unusedRects.push({x:d.x+t,y:d.y,w:d.w-t,h:i}),d.y+=i,d.h-=i,d.h===0&&(h===c.length-1?c.pop():this._unusedRects.splice(h,1));break}}}else{const c=this._openRegionsByHeight.get(i);if(c!=null&&c.length)for(let h=c.length-1;h>=0;h--){const d=c[h];if(d.w>=t&&d.h>=i){o=d.x,a=d.y,i<d.h&&this._unusedRects.push({x:d.x,y:d.y+i,w:t,h:d.h-i}),d.x+=t,d.w-=t,d.h===0&&(h===c.length-1?c.pop():this._unusedRects.splice(h,1));break}}}if(o===void 0||a===void 0){if(!r){if(this._slabs.length>=this._slabsPerRow*this._slabsPerColumn)return;r={x:Math.floor(this._slabs.length%this._slabsPerRow)*this._slabW,y:Math.floor(this._slabs.length/this._slabsPerRow)*this._slabH,entryW:n.w,entryH:n.h,count:0};const h=this._slabW%r.entryW,d=this._slabH%r.entryH;h&&_j(this._openRegionsByWidth,h,{x:r.x+this._slabW-h,w:h,y:r.y,h:this._slabH-(d??0)}),d&&_j(this._openRegionsByHeight,d,{x:r.x,w:this._slabW,y:r.y+this._slabH-d,h:d}),this._slabs.push(r),this._activeSlabsByDims.set(r,n.w,n.h)}const c=Math.floor(this._slabW/r.entryW);o=r.x+Math.floor(r.count%c)*r.entryW,a=r.y+Math.floor(r.count/c)*r.entryH,r.count++}this._ctx.drawImage(e.source,e.boundingBox.left,e.boundingBox.top,t,i,o,a,t,i);const l={pageIndex:this._textureIndex,glyphIndex:this._nextIndex++,x:o,y:a,w:t,h:i,originOffsetX:e.originOffset.x,originOffsetY:e.originOffset.y,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent};return this._allocatedGlyphs.add(l),l}getUsagePreview(){const e=this._canvas.width,t=this._canvas.height,i=new OffscreenCanvas(e,t),n=A1(i.getContext("2d"));n.fillStyle="#808080",n.fillRect(0,0,e,t);let r=0,o=0,a=0;const l=64<<Math.floor(Kt().devicePixelRatio)-1,c=l;for(const d of this._slabs){let g=0,p=0;for(let C=0;C<d.count;C++)g+d.entryW>l&&(g=0,p+=d.entryH),n.fillStyle="#FF0000",n.fillRect(d.x+g,d.y+p,d.entryW,d.entryH),r+=d.entryW*d.entryH,g+=d.entryW;const _=Math.floor(l/d.entryW),b=Math.floor(c/d.entryH);d.entryW*_*d.entryH*b}for(const d of this._allocatedGlyphs)o+=d.w*d.h,n.fillStyle="#4040FF",n.fillRect(d.x,d.y,d.w,d.h);const h=Array.from(this._openRegionsByWidth.values()).flat().concat(Array.from(this._openRegionsByHeight.values()).flat());for(const d of h)n.fillStyle="#FF000088",n.fillRect(d.x,d.y,d.w,d.h),a+=d.w*d.h;return n.globalAlpha=.5,n.drawImage(this._canvas,0,0),n.globalAlpha=1,i.convertToBlob()}getStats(){const e=this._canvas.width,t=this._canvas.height;let i=0,n=0,r=0,o=0,a=0;const l=e*t,c=64<<Math.floor(Kt().devicePixelRatio)-1,h=c;for(const _ of this._slabs){let b=0,C=0;for(let k=0;k<_.count;k++)b+_.entryW>c&&(b=0,C+=_.entryH),i+=_.entryW*_.entryH,b+=_.entryW;const x=Math.floor(c/_.entryW),S=Math.floor(h/_.entryH),y=_.entryW*x*_.entryH*S;r+=c*h-y}for(const _ of this._allocatedGlyphs)n+=_.w*_.h;const d=Array.from(this._openRegionsByWidth.values()).flat().concat(Array.from(this._openRegionsByHeight.values()).flat());for(const _ of d)a+=_.w*_.h;const g=r-a;o=i-(n-g);const p=n/(n+o+a);return[`page[${this._textureIndex}]:`,`     Total: ${l}px (${e}x${t})`,`      Used: ${n}px (${(n/l*100).toFixed(2)}%)`,`    Wasted: ${o}px (${(o/l*100).toFixed(2)}%)`,`Restricted: ${a}px (${(a/l*100).toFixed(2)}%) (hard to allocate)`,`Efficiency: ${p===1?"100":(p*100).toFixed(2)}%`,`     Slabs: ${this._slabs.length} of ${Math.floor(this._canvas.width/c)*Math.floor(this._canvas.height/h)}`].join(`
`)}}function _j(s,e,t){let i=s.get(e);i||(i=[],s.set(e,i)),i.push(t)}var vLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},bj=function(s,e){return function(t,i){e(t,i,s)}},T5,Mg;let nl=(Mg=class extends le{get version(){return this._version}get usedArea(){return this._usedArea}get source(){return this._canvas}get glyphs(){return this._glyphInOrderSet.values()}constructor(e,t,i,n,r){switch(super(),this._logService=n,this._version=0,this._usedArea={left:0,top:0,right:0,bottom:0},this._glyphMap=new kD,this._glyphInOrderSet=new Set,this._canvas=new OffscreenCanvas(t,t),this._colorMap=r.getColorTheme().tokenColorMap,i){case"shelf":this._allocator=new bLe(this._canvas,e);break;case"slab":this._allocator=new wLe(this._canvas,e);break;default:this._allocator=i(this._canvas,e);break}this._register(qe(()=>{this._canvas.width=1,this._canvas.height=1}))}getGlyph(e,t,i,n){return this._glyphMap.get(t,i,n,e.cacheKey)??this._createGlyph(e,t,i,n)}_createGlyph(e,t,i,n){if(this._glyphInOrderSet.size>=T5.maximumGlyphCount)return;const r=e.rasterizeGlyph(t,i,n,this._colorMap),o=this._allocator.allocate(r);if(o!==void 0)return this._glyphMap.set(o,t,i,n,e.cacheKey),this._glyphInOrderSet.add(o),this._version++,this._usedArea.right=Math.max(this._usedArea.right,o.x+o.w-1),this._usedArea.bottom=Math.max(this._usedArea.bottom,o.y+o.h-1),this._logService.getLevel()===jn.Trace&&this._logService.trace("New glyph",{chars:t,tokenMetadata:i,decorationStyleSetId:n,rasterizedGlyph:r,glyph:o}),o}getUsagePreview(){return this._allocator.getUsagePreview()}getStats(){return this._allocator.getStats()}},T5=Mg,Mg.maximumGlyphCount=5e3,Mg);nl=T5=vLe([bj(3,pr),bj(4,Zr)],nl);var CLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},wj=function(s,e){return function(t,i){e(t,i,s)}},eL,Og;let rd=(Og=class extends le{get pages(){return this._pages}constructor(e,t,i,n,r){super(),this._maxTextureSize=e,this._decorationStyleCache=i,this._themeService=n,this._instantiationService=r,this._warmUpTask=this._register(new Yn),this._warmedUpRasterizers=new Set,this._pages=[],this._glyphPageIndex=new kD,this._onDidDeleteGlyphs=this._register(new Z),this.onDidDeleteGlyphs=this._onDidDeleteGlyphs.event,this._allocatorType=(t==null?void 0:t.allocatorType)??"slab",this._register(Se.runAndSubscribe(this._themeService.onDidColorThemeChange,()=>{this._colorMap&&this.clear(),this._colorMap=this._themeService.getColorTheme().tokenColorMap}));const o=Math.max(1,Math.floor(Kt().devicePixelRatio));this.pageSize=Math.min(1024*o,this._maxTextureSize),this._initFirstPage(),this._register(qe(()=>_n(this._pages)))}_initFirstPage(){const e=this._instantiationService.createInstance(nl,0,this.pageSize,this._allocatorType);this._pages.push(e);const t=new Uk(1,"",1,this._decorationStyleCache);e.getGlyph(t,"",0,0),t.dispose()}clear(){for(const e of this._pages)e.dispose();this._pages.length=0,this._glyphPageIndex.clear(),this._warmedUpRasterizers.clear(),this._warmUpTask.clear(),this._initFirstPage(),this._onDidDeleteGlyphs.fire()}getGlyph(e,t,i,n,r){return i&=-2048,i|=Math.floor(r%1*10),this._warmedUpRasterizers.has(e.id)||(this._warmUpAtlas(e),this._warmedUpRasterizers.add(e.id)),this._tryGetGlyph(this._glyphPageIndex.get(t,i,n,e.cacheKey)??0,e,t,i,n)}_tryGetGlyph(e,t,i,n,r){return this._glyphPageIndex.set(e,i,n,r,t.cacheKey),this._pages[e].getGlyph(t,i,n,r)??(e+1<this._pages.length?this._tryGetGlyph(e+1,t,i,n,r):void 0)??this._getGlyphFromNewPage(t,i,n,r)}_getGlyphFromNewPage(e,t,i,n){if(this._pages.length>=eL.maximumPageCount)throw new Error(`Attempt to create a texture atlas page past the limit ${eL.maximumPageCount}`);return this._pages.push(this._instantiationService.createInstance(nl,this._pages.length,this.pageSize,this._allocatorType)),this._glyphPageIndex.set(this._pages.length-1,t,i,n,e.cacheKey),this._pages[this._pages.length-1].getGlyph(e,t,i,n)}getStats(){return this._pages.map(e=>e.getStats())}_warmUpAtlas(e){var n;const t=this._colorMap;if(!t)throw new $e("Cannot warm atlas without color map");(n=this._warmUpTask.value)==null||n.clear();const i=this._warmUpTask.value=this._instantiationService.createInstance(_Le);for(let r=65;r<=90;r++)for(const o of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(r),o<<15&16744448,0,a)});for(let r=97;r<=122;r++)for(const o of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(r),o<<15&16744448,0,a)});for(let r=33;r<=126;r++)for(const o of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(r),o<<15&16744448,0,a)})}},eL=Og,Og.maximumPageCount=16,Og);rd=eL=CLe([wj(3,Zr),wj(4,It)],rd);var Gv;(function(s){s[s.Ignore=0]="Ignore",s[s.Info=1]="Info",s[s.Warning=2]="Warning",s[s.Error=3]="Error"})(Gv||(Gv={}));(function(s){const e="error",t="warning",i="warn",n="info",r="ignore";function o(l){return l?og(e,l)?s.Error:og(t,l)||og(i,l)?s.Warning:og(n,l)?s.Info:s.Ignore:s.Ignore}s.fromValue=o;function a(l){switch(l){case s.Error:return e;case s.Warning:return t;case s.Info:return n;default:return r}}s.toString=a})(Gv||(Gv={}));var Ji=Gv,tee=Ji;const Ba=gt("notificationService");class yLe{}var Er;(function(s){async function e(n){try{if(!navigator.gpu)throw new Error("This browser does not support WebGPU");const r=await navigator.gpu.requestAdapter();if(!r)throw new Error("This browser supports WebGPU but it appears to be disabled");return IR(await r.requestDevice())}catch(r){throw n&&n(r.message),r}}s.requestDevice=e;function t(n,r,o){const a=n.createBuffer(r);return o&&n.queue.writeBuffer(a,0,_1(o)?o():o),IR(a)}s.createBuffer=t;function i(n,r){return IR(n.createTexture(r))}s.createTexture=i})(Er||(Er={}));function IR(s){return{object:s,dispose:()=>s.destroy()}}class SLe{get dataOffset(){return this._startIndex}get dirtySize(){if(!(this._startIndex===void 0||this._endIndex===void 0))return this._endIndex-this._startIndex+1}get isDirty(){return this._startIndex!==void 0}flag(e,t=1){return this._flag(e),t>1&&this._flag(e+t-1),e}_flag(e){(this._startIndex===void 0||e<this._startIndex)&&(this._startIndex=e),(this._endIndex===void 0||e>this._endIndex)&&(this._endIndex=e)}clear(){this._startIndex=void 0,this._endIndex=void 0}}function xLe(s,e){return new LLe(s,e)}class LLe extends le{get entryCount(){return this._entries.size}get dirtyTracker(){return this._dirtyTracker}constructor(e,t){super(),this.propertySpecs=e,this.capacity=t,this._dirtyTracker=new SLe,this._propertySpecsMap=new Map,this._entries=new Dr,this._onDidChange=this._register(new Z),this._onDidChangeBuffer=this._register(new Z),this.onDidChangeBuffer=this._onDidChangeBuffer.event,this.view=new Float32Array(t*e.length),this.buffer=this.view.buffer,this._entrySize=e.length;for(let i=0;i<e.length;i++){const n={offset:i,...e[i]};this._propertySpecsMap.set(n.name,n)}this._register(qe(()=>_n(this._entries)))}createEntry(e){this._entries.size===this.capacity&&(this._expandBuffer(),this._onDidChangeBuffer.fire());const t=new kLe(this.view,this._propertySpecsMap,this._dirtyTracker,this._entries.size,e),i=this._entries.push(t),n=[];return n.push(Se.forward(t.onDidChange,this._onDidChange)),n.push(t.onWillDispose(()=>{const r=t.i;i(),this.view.set(this.view.subarray(r*this._entrySize+2,this._entries.size*this._entrySize+2),r*this._entrySize);for(const o of this._entries)o.i>r&&o.i--;this._dirtyTracker.flag(r,(this._entries.size-r)*this._entrySize),_n(n)})),t}_expandBuffer(){this.capacity*=2;const e=new Float32Array(this.capacity*this._entrySize);e.set(this.view),this.view=e,this.buffer=this.view.buffer}}class kLe extends le{constructor(e,t,i,n,r){super(),this._view=e,this._propertySpecsMap=t,this._dirtyTracker=i,this.i=n,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._onWillDispose=this._register(new Z),this.onWillDispose=this._onWillDispose.event;for(const o of this._propertySpecsMap.values())this._view[this.i*this._propertySpecsMap.size+o.offset]=r[o.name];this._dirtyTracker.flag(this.i*this._propertySpecsMap.size,this._propertySpecsMap.size)}dispose(){this._onWillDispose.fire(),super.dispose()}setRaw(e){if(e.length!==this._propertySpecsMap.size)throw new Error(`Data length ${e.length} does not match the number of properties in the collection (${this._propertySpecsMap.size})`);this._view.set(e,this.i*this._propertySpecsMap.size),this._dirtyTracker.flag(this.i*this._propertySpecsMap.size,this._propertySpecsMap.size)}}const ELe=`

struct Vertex {
	@location(0) position: vec2f,
};

struct LayoutInfo {
	canvasDims: vec2f,
	viewportOffset: vec2f,
	viewportDims: vec2f,
}

struct ScrollOffset {
	offset: vec2f,
}

struct Shape {
	position: vec2f,
	size: vec2f,
	color: vec4f,
};

struct VSOutput {
	@builtin(position) position: vec4f,
	@location(1)       color:    vec4f,
};

// Uniforms
@group(0) @binding(1) var<uniform>       layoutInfo:      LayoutInfo;

// Storage buffers
@group(0) @binding(0)            var<storage, read> shapes:          array<Shape>;
@group(0) @binding(2)      var<uniform>       scrollOffset:    ScrollOffset;

@vertex fn vs(
	vert: Vertex,
	@builtin(instance_index) instanceIndex: u32,
	@builtin(vertex_index) vertexIndex : u32
) -> VSOutput {
	let shape = shapes[instanceIndex];

	var vsOut: VSOutput;
	vsOut.position = vec4f(
		(
			// Top left corner
			vec2f(-1,  1) +
			// Convert pixel position to clipspace
			vec2f( 2, -2) / layoutInfo.canvasDims *
			// Shape position and size
			(layoutInfo.viewportOffset - scrollOffset.offset + shape.position + vert.position * shape.size)
		),
		0.0,
		1.0
	);
	vsOut.color = shape.color;
	return vsOut;
}

@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {
	return vsOut.color;
}
`;class DLe extends Im{constructor(e,t,i,n,r,o){super(),this._context=e,this._contentLeft=t,this._devicePixelRatio=i,this._canvas=n,this._ctx=r,this._shapeBindBuffer=this._register(new Yn),this._initialized=!1,this._shapeCollection=this._register(xLe([{name:"x"},{name:"y"},{name:"width"},{name:"height"},{name:"red"},{name:"green"},{name:"blue"},{name:"alpha"}],32)),this._context.addEventHandler(this),this._initWebgpu(o)}async _initWebgpu(e){if(this._device=await e,this._store.isDisposed)return;const t=navigator.gpu.getPreferredCanvasFormat();this._ctx.configure({device:this._device,format:t,alphaMode:"premultiplied"}),this._renderPassColorAttachment={view:null,loadOp:"load",storeOp:"store"},this._renderPassDescriptor={label:"Monaco rectangle renderer render pass",colorAttachments:[this._renderPassColorAttachment]};let i;{const a=new Float32Array(6),l=(c=this._canvas.width,h=this._canvas.height)=>(a[0]=c,a[1]=h,a[2]=Math.ceil(this._context.configuration.options.get(165).contentLeft*Kt().devicePixelRatio),a[3]=0,a[4]=a[0]-a[2],a[5]=a[1]-a[3],a);i=this._register(Er.createBuffer(this._device,{label:"Monaco rectangle renderer uniform buffer",size:24,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>l())).object,this._register(eee(this._canvas,Kt(),(c,h)=>{this._device.queue.writeBuffer(i,0,l(c,h))}))}const n=2;this._scrollOffsetBindBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco rectangle renderer scroll offset buffer",size:n*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(n);const r=()=>Er.createBuffer(this._device,{label:"Monaco rectangle renderer shape buffer",size:this._shapeCollection.buffer.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});this._shapeBindBuffer.value=r(),this._register(Se.runAndSubscribe(this._shapeCollection.onDidChangeBuffer,()=>{this._shapeBindBuffer.value=r(),this._pipeline&&this._updateBindGroup(this._pipeline,i)})),this._vertexBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco rectangle renderer vertex buffer",size:Eg.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST},Eg)).object;const o=this._device.createShaderModule({label:"Monaco rectangle renderer shader module",code:ELe});this._pipeline=this._device.createRenderPipeline({label:"Monaco rectangle renderer render pipeline",layout:"auto",vertex:{module:o,buffers:[{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]}]},fragment:{module:o,targets:[{format:t,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"}}}]}}),this._updateBindGroup(this._pipeline,i),this._initialized=!0}_updateBindGroup(e,t){this._bindGroup=this._device.createBindGroup({label:"Monaco rectangle renderer bind group",layout:e.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._shapeBindBuffer.value.object}},{binding:1,resource:{buffer:t}},{binding:2,resource:{buffer:this._scrollOffsetBindBuffer}}]})}register(e,t,i,n,r,o,a,l){return this._shapeCollection.createEntry({x:e,y:t,width:i,height:n,red:r,green:o,blue:a,alpha:l})}onScrollChanged(e){if(this._device){const t=Kt().devicePixelRatio;this._scrollOffsetValueBuffer[0]=this._context.viewLayout.getCurrentScrollLeft()*t,this._scrollOffsetValueBuffer[1]=this._context.viewLayout.getCurrentScrollTop()*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer)}return!0}_update(){if(!this._device)return;const e=this._shapeCollection;e.dirtyTracker.isDirty&&(this._device.queue.writeBuffer(this._shapeBindBuffer.value.object,0,e.buffer,e.dirtyTracker.dataOffset,e.dirtyTracker.dirtySize*e.view.BYTES_PER_ELEMENT),e.dirtyTracker.clear())}draw(e){if(!this._initialized)return;this._update();const t=this._device.createCommandEncoder({label:"Monaco rectangle renderer command encoder"});this._renderPassColorAttachment.view=this._ctx.getCurrentTexture().createView();const i=t.beginRenderPass(this._renderPassDescriptor);i.setPipeline(this._pipeline),i.setVertexBuffer(0,this._vertexBuffer),i.setBindGroup(0,this._bindGroup);const n=Math.ceil(this._contentLeft.get()*this._devicePixelRatio.get());i.setScissorRect(n,0,this._canvas.width-n,this._canvas.height),i.draw(Eg.length/2,this._shapeCollection.entryCount),i.end();const r=t.finish();this._device.queue.submit([r])}}class TLe extends le{constructor(){super(),this._ruleCache=new Map,this._container=Ke("div.monaco-decoration-css-rule-extractor"),this._dummyElement=Ke("span"),this._container.appendChild(this._dummyElement),this._register(qe(()=>this._container.remove()))}getStyleRules(e,t){const i=this._ruleCache.get(t);if(i)return i;this._dummyElement.className=t,e.appendChild(this._container);const n=this._getStyleRules(t);return this._ruleCache.set(t,n),e.removeChild(this._container),n}_getStyleRules(e){const t=[],n=[...gD().styleSheets];for(let r=0;r<n.length;r++){const o=n[r];for(const a of o.cssRules)if(a instanceof CSSImportRule)a.styleSheet&&n.push(a.styleSheet);else if(a instanceof CSSStyleRule){const l=`.${e}`,c=a.selectorText.indexOf(l);if(c!==-1){const h=c+l.length;(a.selectorText.length===h||a.selectorText.substring(h,h+1).match(/[ :]/))&&t.push(a)}}}return t}}class NLe{constructor(){this._nextId=1,this._cacheById=new Map,this._cacheByStyle=new kD}getOrCreateEntry(e,t,i){if(e===void 0&&t===void 0&&i===void 0)return 0;const n=this._cacheByStyle.get(e??0,t?1:0,i===void 0?"":i.toFixed(2));if(n)return n.id;const r=this._nextId++,o={id:r,color:e,bold:t,opacity:i};return this._cacheById.set(r,o),this._cacheByStyle.set(o,e??0,t?1:0,i===void 0?"":i.toFixed(2)),r}getStyleSet(e){if(e!==0)return this._cacheById.get(e)}}function ow(s,e){let t,i=!0;return i1e({changeTracker:{createChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(n,r)=>{if(n.didChange(s)){const o=n.change;o!==void 0&&r.deltas.push(o),r.didChange=!0}return!0}}},(n,r)=>{const o=s.read(n),a=t;r.didChange&&(t=o,e(o,a,r.deltas)),i&&(i=!1,t=o)})}var ILe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},RR=function(s,e){return function(t,i){e(t,i,s)}},tr,yd;let Qo=(yd=class extends le{static get decorationCssRuleExtractor(){return tr._decorationCssRuleExtractor}static get decorationStyleCache(){return tr._decorationStyleCache}static get atlas(){if(!tr._atlas)throw new $e("Cannot call ViewGpuContext.textureAtlas before device is resolved");return tr._atlas}get atlas(){return tr.atlas}constructor(e,t,i,n){super(),this._instantiationService=t,this._notificationService=i,this.configurationService=n,this.maxGpuCols=2e3,this.canvas=Tt(document.createElement("canvas")),this.canvas.setClassName("editorCanvas"),this._register(Se.runAndSubscribe(n.onDidChangeConfiguration,l=>{var c;if(!l||l.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")){const h=((c=n.getValue("editor").scrollbar)==null?void 0:c.verticalScrollbarSize)??14;this.canvas.domNode.style.boxSizing="border-box",this.canvas.domNode.style.paddingRight=`${h}px`}})),this.ctx=A1(this.canvas.domNode.getContext("webgpu")),tr.device||(tr.device=Er.requestDevice(l=>{const c=[{label:v(78,"Use DOM-based rendering"),run:()=>this.configurationService.updateValue("editor.experimentalGpuAcceleration","off")}];this._notificationService.prompt(tee.Warning,l,c)}).then(l=>(tr.deviceSync=l.object,tr._atlas||(tr._atlas=this._instantiationService.createInstance(rd,l.object.limits.maxTextureDimension2D,void 0,tr.decorationStyleCache)),l.object)));const r=lt(this,Kt().devicePixelRatio);this._register(ie(Kt(),"resize",()=>{r.set(Kt().devicePixelRatio,void 0)})),this.devicePixelRatio=r,this._register(ow(this.devicePixelRatio,()=>{var l;return(l=tr.atlas)==null?void 0:l.clear()}));const o=lt(this,{width:this.canvas.domNode.width,height:this.canvas.domNode.height});this._register(eee(this.canvas.domNode,Kt(),(l,c)=>{this.canvas.domNode.width=l,this.canvas.domNode.height=c,o.set({width:l,height:c},void 0)})),this.canvasDevicePixelDimensions=o;const a=lt(this,0);this._register(this.configurationService.onDidChangeConfiguration(l=>{a.set(e.configuration.options.get(165).contentLeft,void 0)})),this.contentLeft=a,this.rectangleRenderer=this._instantiationService.createInstance(DLe,e,this.contentLeft,this.devicePixelRatio,this.canvas.domNode,this.ctx,tr.device)}canRender(e,t,i){const n=t.getViewLineRenderingData(i);if(n.containsRTL||n.maxColumn>this.maxGpuCols)return!1;if(n.inlineDecorations.length>0){let r=!0;for(const o of n.inlineDecorations){if(o.type!==0){r=!1;break}const a=tr._decorationCssRuleExtractor.getStyleRules(this.canvas.domNode,o.inlineClassName);if(r&&(r=a.every(l=>{if(l.selectorText.includes(":"))return!1;for(const c of l.style)if(!vj(c,l.style))return!1;return!0})),!r)break}return r}return!0}canRenderDetailed(e,t,i){const n=t.getViewLineRenderingData(i),r=[];if(n.containsRTL&&r.push("containsRTL"),n.maxColumn>this.maxGpuCols&&r.push("maxColumn > maxGpuCols"),n.inlineDecorations.length>0){let o=!0;const a=[],l=[],c=[];for(const h of n.inlineDecorations){if(h.type!==0){a.push(h.type),o=!1;continue}const d=tr._decorationCssRuleExtractor.getStyleRules(this.canvas.domNode,h.inlineClassName);o&&(o=d.every(g=>{if(g.selectorText.includes(":"))return l.push(g.selectorText),!1;for(const p of g.style)if(!vj(p,g.style))return c.push(`${p}: ${g.style[p]}`),!1;return!0}))}a.length>0&&r.push(`inlineDecorations with unsupported types (${a.map(h=>`\`${h}\``).join(", ")})`),c.length>0&&r.push(`inlineDecorations with unsupported CSS rules (${c.map(h=>`\`${h}\``).join(", ")})`),l.length>0&&r.push(`inlineDecorations with unsupported CSS selectors (${l.map(h=>`\`${h}\``).join(", ")})`)}return r}},tr=yd,yd._decorationCssRuleExtractor=new TLe,yd._decorationStyleCache=new NLe,yd);Qo=tr=ILe([RR(1,It),RR(2,Ba),RR(3,yi)],Qo);const RLe=["color","font-weight","opacity"];function vj(s,e){return!!RLe.includes(s)}function $k(s,e){return s.isBasicASCII&&e.useMonospaceOptimizations?new ALe(s):new MLe(s)}class ALe{constructor(e){this._content=e.content}getSegmentAtIndex(e){return this._content[e]}}class MLe{constructor(e){this._segments=[];const t=e.content,i=KC.Segmenter(void 0,{granularity:"grapheme"}).value,n=Array.from(i.segment(t));let r=0;for(let o=0;o<t.length;o++){const a=n[r];if(!a)break;if(a.index!==o){this._segments.push(void 0);continue}r++,this._segments.push(a)}}getSegmentAtIndex(e){var t;return(t=this._segments[e])==null?void 0:t.segment}}class iee extends Im{get glyphRasterizer(){return this._glyphRasterizer.value}constructor(e,t,i,n){super(),this._context=e,this._viewGpuContext=t,this._device=i,this._glyphRasterizer=n,this._context.addEventHandler(this)}}const nee=`
struct GlyphInfo {
	position: vec2f,
	size: vec2f,
	origin: vec2f,
};

struct Vertex {
	@location(0) position: vec2f,
};

struct Cell {
	position: vec2f,
	unused1: vec2f,
	glyphIndex: f32,
	textureIndex: f32
};

struct LayoutInfo {
	canvasDims: vec2f,
	viewportOffset: vec2f,
	viewportDims: vec2f,
}

struct ScrollOffset {
	offset: vec2f
}

struct VSOutput {
	@builtin(position) position:   vec4f,
	@location(1)       layerIndex: f32,
	@location(0)       texcoord:   vec2f,
};

// Uniforms
@group(0) @binding(4)       var<uniform>       layoutInfo:      LayoutInfo;
@group(0) @binding(5)  var<uniform>       atlasDims:       vec2f;
@group(0) @binding(6)            var<uniform>       scrollOffset:    ScrollOffset;

// Storage buffers
@group(0) @binding(0)               var<storage, read> glyphInfo:       array<array<GlyphInfo, ${nl.maximumGlyphCount}>, ${rd.maximumPageCount}>;
@group(0) @binding(1)                   var<storage, read> cells:           array<Cell>;

@vertex fn vs(
	vert: Vertex,
	@builtin(instance_index) instanceIndex: u32,
	@builtin(vertex_index) vertexIndex : u32
) -> VSOutput {
	let cell = cells[instanceIndex];
	var glyph = glyphInfo[u32(cell.textureIndex)][u32(cell.glyphIndex)];

	var vsOut: VSOutput;
	// Multiple vert.position by 2,-2 to get it into clipspace which ranged from -1 to 1
	vsOut.position = vec4f(
		// Make everything relative to top left instead of center
		vec2f(-1, 1) +
		((vert.position * vec2f(2, -2)) / layoutInfo.canvasDims) * glyph.size +
		((cell.position * vec2f(2, -2)) / layoutInfo.canvasDims) +
		((glyph.origin * vec2f(2, -2)) / layoutInfo.canvasDims) +
		(((layoutInfo.viewportOffset - scrollOffset.offset * vec2(1, -1)) * 2) / layoutInfo.canvasDims),
		0.0,
		1.0
	);

	vsOut.layerIndex = cell.textureIndex;
	// Textures are flipped from natural direction on the y-axis, so flip it back
	vsOut.texcoord = vert.position;
	vsOut.texcoord = (
		// Glyph offset (0-1)
		(glyph.position / atlasDims) +
		// Glyph coordinate (0-1)
		(vsOut.texcoord * (glyph.size / atlasDims))
	);

	return vsOut;
}

@group(0) @binding(2) var ourSampler: sampler;
@group(0) @binding(3)        var ourTexture: texture_2d_array<f32>;

@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {
	return textureSample(ourTexture, ourSampler, vsOut.texcoord, u32(vsOut.layerIndex));
}
`,zl=class zl extends iee{get bindGroupEntries(){return[{binding:1,resource:{buffer:this._cellBindBuffer}},{binding:6,resource:{buffer:this._scrollOffsetBindBuffer}}]}constructor(e,t,i,n){super(e,t,i,n),this.type="viewport",this.wgsl=nee,this._cellBindBufferLineCapacity=63,this._activeDoubleBufferIndex=0,this._visibleObjectCount=0,this._scrollInitialized=!1,this._onDidChangeBindGroupEntries=this._register(new Z),this.onDidChangeBindGroupEntries=this._onDidChangeBindGroupEntries.event,this._rebuildCellBuffer(this._cellBindBufferLineCapacity);const r=2;this._scrollOffsetBindBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco scroll offset buffer",size:r*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(r)}_rebuildCellBuffer(e){var n;(n=this._cellBindBuffer)==null||n.destroy();const t=(Math.floor(e/32)+1)*32,i=t*zl.maxSupportedColumns*6*Float32Array.BYTES_PER_ELEMENT;this._cellBindBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco full file cell buffer",size:i,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._cellValueBuffers=[new ArrayBuffer(i),new ArrayBuffer(i)],this._cellBindBufferLineCapacity=t,this._onDidChangeBindGroupEntries.fire()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onTokensChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onLinesChanged(e){return!0}onScrollChanged(e){const t=Kt().devicePixelRatio;return this._scrollOffsetValueBuffer[0]=((e==null?void 0:e.scrollLeft)??this._context.viewLayout.getCurrentScrollLeft())*t,this._scrollOffsetValueBuffer[1]=((e==null?void 0:e.scrollTop)??this._context.viewLayout.getCurrentScrollTop())*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer),!0}onThemeChanged(e){return!0}onLineMappingChanged(e){return!0}onZonesChanged(e){return!0}reset(){for(const e of[0,1]){const t=new Float32Array(this._cellValueBuffers[e]);t.fill(0,0,t.length),this._device.queue.writeBuffer(this._cellBindBuffer,0,t.buffer,0,t.byteLength)}}update(e,t){var U;let i="",n,r=0,o=0,a=0,l=0,c=0,h=0,d,g=0,p=0,_=0,b=0,C,x,S,y,k,D=0,R=0,N;const A=Kt().devicePixelRatio;let M;this._scrollInitialized||(this.onScrollChanged(),this._scrollInitialized=!0),this._cellBindBufferLineCapacity<e.endLineNumber-e.startLineNumber+1&&this._rebuildCellBuffer(e.endLineNumber-e.startLineNumber+1);const O=new Float32Array(this._cellValueBuffers[this._activeDoubleBufferIndex]);O.fill(0);const V=zl.maxSupportedColumns*6;for(o=e.startLineNumber;o<=e.endLineNumber;o++)if(this._viewGpuContext.canRender(t,e,o)){y=e.getViewLineRenderingData(o),h=0,M=$k(y,t),r=t.spaceWidth*A,l=0,N=y.tokens,p=y.minColumn-1,_=0;for(let X=0,Y=N.getCount();X<Y;X++)if(_=N.getEndOffset(X),!(_<=p)){for(b=N.getMetadata(X),a=p;a<_&&!(a>zl.maxSupportedColumns);a++){if(n=M.getSegmentAtIndex(a),n===void 0)continue;i=n,y.isBasicASCII&&t.useMonospaceOptimizations||(r=this.glyphRasterizer.getTextMetrics(i).width),x=void 0,C=void 0,S=void 0;for(k of y.inlineDecorations){if(o<k.range.startLineNumber||o>k.range.endLineNumber||o===k.range.startLineNumber&&a<k.range.startColumn-1||o===k.range.endLineNumber&&a>=k.range.endColumn-1)continue;const ee=Qo.decorationCssRuleExtractor.getStyleRules(this._viewGpuContext.canvas.domNode,k.inlineClassName);for(const ue of ee)for(const oe of ue.style){const Ee=((U=ue.styleMap.get(oe))==null?void 0:U.toString())??"";switch(oe){case"color":{const $=me.Format.CSS.parse(Ee);if(!$)throw new $e("Invalid color format "+Ee);x=$.toNumber32Bit();break}case"font-weight":{OLe(Ee)>=400?C=!0:C=!1;break}case"opacity":{S=PLe(Ee);break}default:throw new $e("Unexpected inline decoration style")}}}if(i===" "||i==="	"){if(g=((o-1)*zl.maxSupportedColumns+a)*6,O.fill(0,g,g+6),i==="	"){const ee=a+h;h=Ai.nextRenderTabStop(a+h,y.tabSize),l+=r*(h-ee),h-=a+1}else l+=r;continue}const q=Qo.decorationStyleCache.getOrCreateEntry(x,C,S);d=this._viewGpuContext.atlas.getGlyph(this.glyphRasterizer,i,b,q,l),c=Math.round(e.relativeVerticalOffset[o-e.startLineNumber]*A+Math.floor((e.lineHeight*A-(d.fontBoundingBoxAscent+d.fontBoundingBoxDescent))/2)+d.fontBoundingBoxAscent),g=((o-e.startLineNumber)*zl.maxSupportedColumns+a)*6,O[g+0]=Math.floor(l),O[g+1]=c,O[g+4]=d.glyphIndex,O[g+5]=d.pageIndex,l+=r}p=_}D=((o-e.startLineNumber)*zl.maxSupportedColumns+_)*6,R=(o-e.startLineNumber)*zl.maxSupportedColumns*6,O.fill(0,D,R)}const H=(e.endLineNumber-e.startLineNumber+1)*V;return this._device.queue.writeBuffer(this._cellBindBuffer,0,O.buffer,0,(e.endLineNumber-e.startLineNumber)*V*Float32Array.BYTES_PER_ELEMENT),this._activeDoubleBufferIndex=this._activeDoubleBufferIndex?0:1,this._visibleObjectCount=H,H}draw(e,t){if(this._visibleObjectCount<=0)throw new $e("Attempt to draw 0 objects");e.draw(Eg.length/2,this._visibleObjectCount)}};zl.maxSupportedColumns=2e3;let N5=zl;function OLe(s){switch(s){case"lighter":case"normal":return 400;case"bolder":case"bold":return 700}return parseInt(s)}function PLe(s){return s.endsWith("%")?parseFloat(s.substring(0,s.length-1))/100:s.match(/^\d+(?:\.\d*)/)?parseFloat(s):1}const gs=class gs extends iee{get bindGroupEntries(){return[{binding:1,resource:{buffer:this._cellBindBuffer}},{binding:6,resource:{buffer:this._scrollOffsetBindBuffer}}]}constructor(e,t,i,n){super(e,t,i,n),this.type="fullfile",this.wgsl=nee,this._activeDoubleBufferIndex=0,this._upToDateLines=[new Set,new Set],this._visibleObjectCount=0,this._finalRenderedLine=0,this._scrollInitialized=!1,this._queuedBufferUpdates=[[],[]];const r=gs.maxSupportedLines*gs.maxSupportedColumns*6*Float32Array.BYTES_PER_ELEMENT;this._cellBindBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco full file cell buffer",size:r,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._cellValueBuffers=[new ArrayBuffer(r),new ArrayBuffer(r)];const o=2;this._scrollOffsetBindBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco scroll offset buffer",size:o*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(o)}onConfigurationChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}onDecorationsChanged(e){return this._invalidateAllLines(),!0}onTokensChanged(e){for(const t of e.ranges)this._invalidateLineRange(t.fromLineNumber,t.toLineNumber);return!0}onLinesDeleted(e){return this._invalidateLinesFrom(e.fromLineNumber),this._queueBufferUpdate(e),!0}onLinesInserted(e){return this._invalidateLinesFrom(e.fromLineNumber),!0}onLinesChanged(e){return this._invalidateLineRange(e.fromLineNumber,e.fromLineNumber+e.count),!0}onScrollChanged(e){const t=Kt().devicePixelRatio;return this._scrollOffsetValueBuffer[0]=((e==null?void 0:e.scrollLeft)??this._context.viewLayout.getCurrentScrollLeft())*t,this._scrollOffsetValueBuffer[1]=((e==null?void 0:e.scrollTop)??this._context.viewLayout.getCurrentScrollTop())*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer),!0}onThemeChanged(e){return this._invalidateAllLines(),!0}onLineMappingChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}onZonesChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}_invalidateAllLines(){this._upToDateLines[0].clear(),this._upToDateLines[1].clear()}_invalidateLinesFrom(e){for(const t of[0,1]){const i=this._upToDateLines[t];for(const n of i)n>=e&&i.delete(n)}}_invalidateLineRange(e,t){for(let i=e;i<=t;i++)this._upToDateLines[0].delete(i),this._upToDateLines[1].delete(i)}reset(){this._invalidateAllLines();for(const e of[0,1]){const t=new Float32Array(this._cellValueBuffers[e]);t.fill(0,0,t.length),this._device.queue.writeBuffer(this._cellBindBuffer,0,t.buffer,0,t.byteLength)}this._finalRenderedLine=0}update(e,t){var ee;let i="",n,r=0,o=0,a=0,l=0,c=0,h=0,d,g=0,p=0,_=0,b=0,C,x,S,y,k,D=0,R=0,N;const A=Kt().devicePixelRatio;let M;this._scrollInitialized||(this.onScrollChanged(),this._scrollInitialized=!0);const O=new Float32Array(this._cellValueBuffers[this._activeDoubleBufferIndex]),V=gs.maxSupportedColumns*6,H=this._upToDateLines[this._activeDoubleBufferIndex];let U=3e3,X=0;const Y=this._queuedBufferUpdates[this._activeDoubleBufferIndex];for(;Y.length;){const ue=Y.shift();switch(ue.type){case 2:case 8:case 17:{O.fill(0),U=1,X=Math.max(X,this._finalRenderedLine),this._finalRenderedLine=0;break}case 10:{const oe=(ue.fromLineNumber-1)*gs.maxSupportedColumns*6,Ee=ue.toLineNumber*gs.maxSupportedColumns*6,$=(this._finalRenderedLine-(ue.toLineNumber-ue.fromLineNumber+1))*gs.maxSupportedColumns*6;O.set(O.subarray(Ee),oe),O.fill(0,$),U=Math.min(U,ue.fromLineNumber),X=Math.max(X,this._finalRenderedLine),this._finalRenderedLine-=ue.toLineNumber-ue.fromLineNumber+1;break}}}for(o=e.startLineNumber;o<=e.endLineNumber;o++){if(!this._viewGpuContext.canRender(t,e,o)){D=(o-1)*gs.maxSupportedColumns*6,R=o*gs.maxSupportedColumns*6,O.fill(0,D,R),U=Math.min(U,o),X=Math.max(X,o);continue}if(!H.has(o)){U=Math.min(U,o),X=Math.max(X,o),y=e.getViewLineRenderingData(o),h=0,M=$k(y,t),r=t.spaceWidth*A,l=0,N=y.tokens,p=y.minColumn-1,_=0;for(let ue=0,oe=N.getCount();ue<oe;ue++)if(_=N.getEndOffset(ue),!(_<=p)){for(b=N.getMetadata(ue),a=p;a<_&&!(a>gs.maxSupportedColumns);a++){if(n=M.getSegmentAtIndex(a),n===void 0)continue;i=n,y.isBasicASCII&&t.useMonospaceOptimizations||(r=this.glyphRasterizer.getTextMetrics(i).width),x=void 0,C=void 0,S=void 0;for(k of y.inlineDecorations){if(o<k.range.startLineNumber||o>k.range.endLineNumber||o===k.range.startLineNumber&&a<k.range.startColumn-1||o===k.range.endLineNumber&&a>=k.range.endColumn-1)continue;const $=Qo.decorationCssRuleExtractor.getStyleRules(this._viewGpuContext.canvas.domNode,k.inlineClassName);for(const ce of $)for(const de of ce.style){const xe=((ee=ce.styleMap.get(de))==null?void 0:ee.toString())??"";switch(de){case"color":{const Re=me.Format.CSS.parse(xe);if(!Re)throw new $e("Invalid color format "+xe);x=Re.toNumber32Bit();break}case"font-weight":{FLe(xe)>=400?C=!0:C=!1;break}case"opacity":{S=BLe(xe);break}default:throw new $e("Unexpected inline decoration style")}}}if(i===" "||i==="	"){if(g=((o-1)*gs.maxSupportedColumns+a)*6,O.fill(0,g,g+6),i==="	"){const $=a+h;h=Ai.nextRenderTabStop(a+h,y.tabSize),l+=r*(h-$),h-=a+1}else l+=r;continue}const Ee=Qo.decorationStyleCache.getOrCreateEntry(x,C,S);d=this._viewGpuContext.atlas.getGlyph(this.glyphRasterizer,i,b,Ee,l),c=Math.round(e.relativeVerticalOffset[o-e.startLineNumber]*A+Math.floor((e.lineHeight*A-(d.fontBoundingBoxAscent+d.fontBoundingBoxDescent))/2)+d.fontBoundingBoxAscent),g=((o-1)*gs.maxSupportedColumns+a)*6,O[g+0]=Math.floor(l),O[g+1]=c,O[g+4]=d.glyphIndex,O[g+5]=d.pageIndex,l+=r}p=_}D=((o-1)*gs.maxSupportedColumns+_)*6,R=o*gs.maxSupportedColumns*6,O.fill(0,D,R),H.add(o)}}const q=(e.endLineNumber-e.startLineNumber+1)*V;return U=Math.min(U,gs.maxSupportedLines),X=Math.min(X,gs.maxSupportedLines),U<=X&&this._device.queue.writeBuffer(this._cellBindBuffer,(U-1)*V*Float32Array.BYTES_PER_ELEMENT,O.buffer,(U-1)*V*Float32Array.BYTES_PER_ELEMENT,(X-U+1)*V*Float32Array.BYTES_PER_ELEMENT),this._finalRenderedLine=Math.max(this._finalRenderedLine,X),this._activeDoubleBufferIndex=this._activeDoubleBufferIndex?0:1,this._visibleObjectCount=q,q}draw(e,t){if(this._visibleObjectCount<=0)throw new $e("Attempt to draw 0 objects");e.draw(Eg.length/2,this._visibleObjectCount,void 0,(t.startLineNumber-1)*gs.maxSupportedColumns)}_queueBufferUpdate(e){this._queuedBufferUpdates[0].push(e),this._queuedBufferUpdates[1].push(e)}};gs.maxSupportedLines=3e3,gs.maxSupportedColumns=200;let zf=gs;function FLe(s){switch(s){case"lighter":case"normal":return 400;case"bolder":case"bold":return 700}return parseInt(s)}function BLe(s){return s.endsWith("%")?parseFloat(s.substring(0,s.length-1))/100:s.match(/^\d+(?:\.\d*)/)?parseFloat(s):1}var VLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Cj=function(s,e){return function(t,i){e(t,i,s)}};let I5=class extends br{constructor(e,t,i,n){super(e),this._viewGpuContext=t,this._instantiationService=i,this._logService=n,this._atlasGpuTextureVersions=[],this._initialized=!1,this._glyphRasterizer=this._register(new Yn),this._renderStrategy=this._register(new Yn),this.canvas=this._viewGpuContext.canvas.domNode,this._register(vt(r=>{this._viewGpuContext.canvasDevicePixelDimensions.read(r);const o=this._lastViewportData;o&&setTimeout(()=>{o===this._lastViewportData&&this.renderText(o)})})),this.initWebgpu()}async initWebgpu(){if(this._device=Qo.deviceSync||await Qo.device,this._store.isDisposed)return;const e=Qo.atlas;this._register(e.onDidDeleteGlyphs(()=>{this._atlasGpuTextureVersions.length=0,this._atlasGpuTextureVersions[0]=0,this._atlasGpuTextureVersions[1]=0,this._renderStrategy.value.reset()}));const t=navigator.gpu.getPreferredCanvasFormat();this._viewGpuContext.ctx.configure({device:this._device,format:t,alphaMode:"premultiplied"}),this._renderPassColorAttachment={view:null,loadOp:"load",storeOp:"store"},this._renderPassDescriptor={label:"Monaco render pass",colorAttachments:[this._renderPassColorAttachment]};let i;{const l=new Float32Array(6),c=(h=this.canvas.width,d=this.canvas.height)=>(l[0]=h,l[1]=d,l[2]=Math.ceil(this._context.configuration.options.get(165).contentLeft*Kt().devicePixelRatio),l[3]=0,l[4]=l[0]-l[2],l[5]=l[1]-l[3],l);i=this._register(Er.createBuffer(this._device,{label:"Monaco uniform buffer",size:24,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>c())).object,this._register(ow(this._viewGpuContext.canvasDevicePixelDimensions,({width:h,height:d})=>{this._device.queue.writeBuffer(i,0,c(h,d))})),this._register(ow(this._viewGpuContext.contentLeft,()=>{this._device.queue.writeBuffer(i,0,c())}))}let n;n=this._register(Er.createBuffer(this._device,{label:"Monaco atlas info uniform buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>{const l=new Float32Array(2);return l[0]=e.pageSize,l[1]=e.pageSize,l})).object;const r=this._context.configuration.options.get(58),o=this._context.configuration.options.get(61);this._glyphRasterizer.value=this._register(new Uk(o,r,this._viewGpuContext.devicePixelRatio.get(),Qo.decorationStyleCache)),this._register(ow(this._viewGpuContext.devicePixelRatio,()=>{this._refreshGlyphRasterizer()})),this._renderStrategy.value=this._instantiationService.createInstance(zf,this._context,this._viewGpuContext,this._device,this._glyphRasterizer),this._glyphStorageBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco glyph storage buffer",size:rd.maximumPageCount*(nl.maximumGlyphCount*24),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._atlasGpuTextureVersions[0]=0,this._atlasGpuTextureVersions[1]=0,this._atlasGpuTexture=this._register(Er.createTexture(this._device,{label:"Monaco atlas texture",format:"rgba8unorm",size:{width:e.pageSize,height:e.pageSize,depthOrArrayLayers:rd.maximumPageCount},dimension:"2d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT})).object,this._updateAtlasStorageBufferAndTexture(),this._vertexBuffer=this._register(Er.createBuffer(this._device,{label:"Monaco vertex buffer",size:Eg.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST},Eg)).object;const a=this._device.createShaderModule({label:"Monaco shader module",code:this._renderStrategy.value.wgsl});if(this._pipeline=this._device.createRenderPipeline({label:"Monaco render pipeline",layout:"auto",vertex:{module:a,buffers:[{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]}]},fragment:{module:a,targets:[{format:t,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"}}}]}}),this._rebuildBindGroup=()=>{this._bindGroup=this._device.createBindGroup({label:"Monaco bind group",layout:this._pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._glyphStorageBuffer}},{binding:2,resource:this._device.createSampler({label:"Monaco atlas sampler",magFilter:"nearest",minFilter:"nearest"})},{binding:3,resource:this._atlasGpuTexture.createView()},{binding:4,resource:{buffer:i}},{binding:5,resource:{buffer:n}},...this._renderStrategy.value.bindGroupEntries]})},this._rebuildBindGroup(),this._initialized=!0,this._initViewportData){for(const l of this._initViewportData)this.renderText(l);this._initViewportData=void 0}}_refreshRenderStrategy(e){var i,n;if(((i=this._renderStrategy.value)==null?void 0:i.type)==="viewport"||e.endLineNumber<zf.maxSupportedLines&&this._viewportMaxColumn(e)<zf.maxSupportedColumns)return;this._logService.trace(`File is larger than ${zf.maxSupportedLines} lines or ${zf.maxSupportedColumns} columns, switching to viewport render strategy`);const t=this._instantiationService.createInstance(N5,this._context,this._viewGpuContext,this._device,this._glyphRasterizer);this._renderStrategy.value=t,this._register(t.onDidChangeBindGroupEntries(()=>{var r;return(r=this._rebuildBindGroup)==null?void 0:r.call(this)})),(n=this._rebuildBindGroup)==null||n.call(this)}_viewportMaxColumn(e){let t=0,i;for(let n=e.startLineNumber;n<=e.endLineNumber;n++)i=e.getViewLineRenderingData(n),t=Math.max(t,i.maxColumn);return t}_updateAtlasStorageBufferAndTexture(){for(const[e,t]of Qo.atlas.pages.entries()){if(e>=rd.maximumPageCount){console.log(`Attempt to upload atlas page [${e}], only ${rd.maximumPageCount} are supported currently`);continue}if(t.version===this._atlasGpuTextureVersions[e])continue;this._logService.trace("Updating atlas page[",e,"] from version ",this._atlasGpuTextureVersions[e]," to version ",t.version);const i=6*nl.maximumGlyphCount,n=new Float32Array(i);let r=0;for(const o of t.glyphs)n[r+0]=o.x,n[r+0+1]=o.y,n[r+2]=o.w,n[r+2+1]=o.h,n[r+4]=o.originOffsetX,n[r+4+1]=o.originOffsetY,r+=6;if(r/6>nl.maximumGlyphCount)throw new Error(`Attempting to write more glyphs (${r/6}) than the GPUBuffer can hold (${nl.maximumGlyphCount})`);this._device.queue.writeBuffer(this._glyphStorageBuffer,e*6*nl.maximumGlyphCount*Float32Array.BYTES_PER_ELEMENT,n,0,6*nl.maximumGlyphCount),t.usedArea.right-t.usedArea.left>0&&t.usedArea.bottom-t.usedArea.top>0&&this._device.queue.copyExternalImageToTexture({source:t.source},{texture:this._atlasGpuTexture,origin:{x:t.usedArea.left,y:t.usedArea.top,z:e}},{width:t.usedArea.right-t.usedArea.left+1,height:t.usedArea.bottom-t.usedArea.top+1}),this._atlasGpuTextureVersions[e]=t.version}}prepareRender(e){throw new $e("Should not be called")}render(e){throw new $e("Should not be called")}onConfigurationChanged(e){return this._refreshGlyphRasterizer(),!0}onCursorStateChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onLineMappingChanged(e){return!0}onRevealRangeRequest(e){return!0}onScrollChanged(e){return!0}onThemeChanged(e){return!0}onZonesChanged(e){return!0}_refreshGlyphRasterizer(){const e=this._glyphRasterizer.value;if(!e)return;const t=this._context.configuration.options.get(58),i=this._context.configuration.options.get(61),n=this._viewGpuContext.devicePixelRatio.get();(e.fontFamily!==t||e.fontSize!==i||e.devicePixelRatio!==n)&&(this._glyphRasterizer.value=new Uk(i,t,n,Qo.decorationStyleCache))}renderText(e){if(this._initialized)return this._refreshRenderStrategy(e),this._renderText(e);this._initViewportData=this._initViewportData??[],this._initViewportData.push(e)}_renderText(e){this._viewGpuContext.rectangleRenderer.draw(e);const t=new Vk(this._context.configuration,this._context.theme.type);this._renderStrategy.value.update(e,t),this._updateAtlasStorageBufferAndTexture();const i=this._device.createCommandEncoder({label:"Monaco command encoder"});this._renderPassColorAttachment.view=this._viewGpuContext.ctx.getCurrentTexture().createView({label:"Monaco canvas texture view"});const n=i.beginRenderPass(this._renderPassDescriptor);n.setPipeline(this._pipeline),n.setVertexBuffer(0,this._vertexBuffer);const r=Math.ceil(this._viewGpuContext.contentLeft.get()*this._viewGpuContext.devicePixelRatio.get());n.setScissorRect(r,0,this.canvas.width-r,this.canvas.height),n.setBindGroup(0,this._bindGroup),this._renderStrategy.value.draw(n,e),n.end();const o=i.finish();this._device.queue.submit([o]),this._lastViewportData=e,this._lastViewLineOptions=t}linesVisibleRangesForRange(e,t){if(!this._lastViewportData)return null;const i=e.endLineNumber,n=G.intersectRanges(e,this._lastViewportData.visibleRange);if(!n)return null;const r=this._lastViewportData.startLineNumber,o=this._lastViewportData.endLineNumber,a=this._lastViewportData,l=this._lastViewLineOptions;if(!a||!l)return null;const c=[];let h=0;t&&(h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(n.startLineNumber,1)).lineNumber);for(let d=n.startLineNumber;d<=n.endLineNumber;d++){if(d<r||d>o)continue;const g=d===n.startLineNumber?n.startColumn:1,p=d!==i,_=p?this._context.viewModel.getLineMaxColumn(d):n.endColumn,b=this._visibleRangesForLineRange(d,g,_);if(b){if(t&&d<i){const C=h;h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new J(d+1,1)).lineNumber,C!==h&&(b.ranges[b.ranges.length-1].width+=l.spaceWidth)}c.push(new bJ(b.outsideRenderedLine,d,ZC.from(b.ranges),p))}}return c.length===0?null:c}_visibleRangesForLineRange(e,t,i){if(this.shouldRender())return null;const n=this._lastViewportData,r=this._lastViewLineOptions;if(!n||!r||e<n.startLineNumber||e>n.endLineNumber)return null;const o=n.getViewLineRenderingData(e),a=o.content;let l;o.isBasicASCII&&r.useMonospaceOptimizations||(l=$k(o,r));let c="",h=0,d=0;for(let b=0;b<t-1;b++){if(o.isBasicASCII&&r.useMonospaceOptimizations)c=a.charAt(b);else{if(c=l.getSegmentAtIndex(b),c===void 0)continue;d+=this._renderStrategy.value.glyphRasterizer.getTextMetrics(c).width/Kt().devicePixelRatio-r.spaceWidth}c==="	"?h=Ai.nextRenderTabStop(h,o.tabSize):h++}let g=h,p=0;for(let b=t-1;b<i-1;b++){if(o.isBasicASCII&&r.useMonospaceOptimizations)c=a.charAt(b);else{if(c=l.getSegmentAtIndex(b),c===void 0)continue;p+=this._renderStrategy.value.glyphRasterizer.getTextMetrics(c).width/Kt().devicePixelRatio-r.spaceWidth}c==="	"?g=Ai.nextRenderTabStop(g,o.tabSize):g++}return new p5(!1,[new Cd(h*r.spaceWidth+d,(g-h)*r.spaceWidth+p)])}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new wJ(t.outsideRenderedLine,t.ranges[0].left):null}getLineWidth(e){if(!this._lastViewportData||!this._lastViewLineOptions||!this._viewGpuContext.canRender(this._lastViewLineOptions,this._lastViewportData,e))return;const t=this._lastViewportData.getViewLineRenderingData(e),i=this._visibleRangesForLineRange(e,1,t.maxColumn),n=i==null?void 0:i.ranges.at(-1);if(n)return n.width}getPositionAtCoordinate(e,t){if(!this._lastViewportData||!this._lastViewLineOptions||!this._viewGpuContext.canRender(this._lastViewLineOptions,this._lastViewportData,e))return;const i=this._lastViewportData.getViewLineRenderingData(e),n=i.content,r=Kt().devicePixelRatio,o=t*r,a=this._lastViewLineOptions.spaceWidth*r,l=$k(i,this._lastViewLineOptions);let c=0,h=0,d=0,g=0;for(let p=0;p<n.length;p++){const _=l.getSegmentAtIndex(p);if(_===void 0){g++;continue}if(_==="	"){const b=p+d;d=Ai.nextRenderTabStop(p+d,i.tabSize),h=a*(d-b),d-=p+1}else i.isBasicASCII&&this._lastViewLineOptions.useMonospaceOptimizations?h=a:h=this._renderStrategy.value.glyphRasterizer.getTextMetrics(_).width;if(o<c+h/2)break;c+=h,g++}return new J(e,g+1)}};I5=VLe([Cj(2,It),Cj(3,pr)],I5);class HLe{constructor(){this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const rc=new HLe,rs=gt("keybindingService");class see extends br{}class ree{_getPageOfLine(e,t){return Math.floor((e-1)/t)}_getRangeForPage(e,t){const i=e*t,n=i+1,r=i+t;return new G(n,1,r+1,1)}fromEditorSelection(e,t,i,n){const o=this._getPageOfLine(t.startLineNumber,i),a=this._getRangeForPage(o,i),l=this._getPageOfLine(t.endLineNumber,i),c=this._getRangeForPage(l,i);let h=a.intersectRanges(new G(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(h,1)>500){const y=e.modifyPosition(h.getEndPosition(),-500);h=G.fromPositions(y,h.getEndPosition())}const d=e.getValueInRange(h,1),g=e.getLineCount(),p=e.getLineMaxColumn(g);let _=c.intersectRanges(new G(t.endLineNumber,t.endColumn,g,p));if(n&&e.getValueLengthInRange(_,1)>500){const y=e.modifyPosition(_.getStartPosition(),500);_=G.fromPositions(_.getStartPosition(),y)}const b=e.getValueInRange(_,1);let C;if(o===l||o+1===l)C=e.getValueInRange(t,1);else{const y=a.intersectRanges(t),k=c.intersectRanges(t);C=e.getValueInRange(y,1)+""+e.getValueInRange(k,1)}n&&C.length>2*500&&(C=C.substring(0,500)+""+C.substring(C.length-500,C.length));let x,S;return t.getDirection()===0?(x=d.length,S=d.length+C.length):(S=d.length,x=d.length+C.length),{value:d+C+b,selection:t,selectionStart:x,selectionEnd:S,startPositionWithinEditor:h.getStartPosition(),newlineCountBeforeSelection:h.endLineNumber-h.startLineNumber}}}function R5(s,e){var i,n,r;if(s.get(2)===1){const o=(i=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))==null?void 0:i.getAriaLabel(),a=(n=e.lookupKeybinding("workbench.action.showCommands"))==null?void 0:n.getAriaLabel(),l=(r=e.lookupKeybinding("workbench.action.openGlobalKeybindings"))==null?void 0:r.getAriaLabel(),c=v(61,"The editor is not accessible at this time.");return o?v(62,"{0} To enable screen reader optimized mode, use {1}",c,o):a?v(63,"{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",c,a):l?v(64,"{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",c,l):c}return s.get(8)}function yj(s){let e=0,t=-1;do{if(t=s.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var WLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Sj=function(s,e){return function(t,i){e(t,i,s)}};class zLe{constructor(e,t,i,n,r){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=r,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new J(this.modelLineNumber,this.distanceToModelLineStart+1),i=new J(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const AR=Kr;let A5=class extends see{constructor(e,t,i,n,r,o){super(e),this._keybindingService=r,this._instantiationService=o,this._primaryCursorPosition=new J(1,1),this._primaryCursorVisibleRange=null,this._viewController=i,this._visibleRangeProvider=n,this._scrollLeft=0,this._scrollTop=0;const a=this._context.configuration.options,l=a.get(165);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(59),this._emptySelectionClipboard=a.get(45),this._copyWithSyntaxHighlighting=a.get(31),this._visibleTextArea=null,this._selections=[new Lt(1,1,1,1)],this._modelSelections=[new Lt(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Tt(document.createElement("textarea")),wl.write(this.textArea,7),this.textArea.setClassName(`inputarea ${U_}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:c}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${c*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",R5(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(9)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(140))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",v(65,"editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(104)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Tt(document.createElement("div")),this.textAreaCover.setPosition("absolute"),t.appendChild(this.textArea),t.appendChild(this.textAreaCover);const h=new ree,d={getDataToCopy:()=>kJ(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const _=this._selections[0];if(_t&&_.isEmpty()){const C=_.getStartPosition();let x=this._getWordBeforePosition(C);if(x.length===0&&(x=this._getCharacterBeforePosition(C)),x.length>0)return new zs(x,x.length,x.length,G.fromPositions(C),0)}if(_t&&!_.isEmpty()&&this._context.viewModel.getValueLengthInRange(_,0)<500){const C=this._context.viewModel.getValueInRange(_,0);return new zs(C,0,C.length,_,0)}if(nm&&!_.isEmpty()){const C="vscode-placeholder";return new zs(C,0,C.length,null,void 0)}return zs.EMPTY}if(dz){const _=this._selections[0];if(_.isEmpty()){const b=_.getStartPosition(),[C,x]=this._getAndroidWordAtPosition(b);if(C.length>0)return new zs(C,x,x,G.fromPositions(b),0)}return zs.EMPTY}const p=h.fromEditorSelection(this._context.viewModel,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return zs.fromScreenReaderContentState(p)},deduceModelPosition:(p,_,b)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(p,_,b)},g=this._register(new Gye(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(w5,d,g,Na,{isAndroid:dz,isChrome:BC,isFirefox:Kr,isSafari:nm})),this._register(this._textAreaInput.onKeyDown(p=>{this._viewController.emitKeyDown(p)})),this._register(this._textAreaInput.onKeyUp(p=>{this._viewController.emitKeyUp(p)})),this._register(this._textAreaInput.onPaste(p=>{let _=!1,b=null,C=null;p.metadata&&(_=this._emptySelectionClipboard&&!!p.metadata.isFromEmptySelection,b=typeof p.metadata.multicursorText<"u"?p.metadata.multicursorText:null,C=p.metadata.mode),this._viewController.paste(p.text,_,b,C)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(p=>{p.replacePrevCharCnt||p.replaceNextCharCnt||p.positionDelta?this._viewController.compositionType(p.text,p.replacePrevCharCnt,p.replaceNextCharCnt,p.positionDelta):this._viewController.type(p.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(p=>{this._viewController.setSelection(p)})),this._register(this._textAreaInput.onCompositionStart(p=>{const _=this.textArea.domNode,b=this._modelSelections[0],{distanceToModelLineStart:C,widthOfHiddenTextBefore:x}=(()=>{const y=_.value.substring(0,Math.min(_.selectionStart,_.selectionEnd)),k=y.lastIndexOf(`
`),D=y.substring(k+1),R=D.lastIndexOf("	"),N=D.length-R-1,A=b.getStartPosition(),M=Math.min(A.column-1,N),O=A.column-1-M,V=D.substring(0,D.length-M),{tabSize:H}=this._context.viewModel.model.getOptions(),U=ULe(this.textArea.domNode.ownerDocument,V,this._fontInfo,H);return{distanceToModelLineStart:O,widthOfHiddenTextBefore:U}})(),{distanceToModelLineEnd:S}=(()=>{const y=_.value.substring(Math.max(_.selectionStart,_.selectionEnd)),k=y.indexOf(`
`),D=k===-1?y:y.substring(0,k),R=D.indexOf("	"),N=R===-1?D.length:D.length-R-1,A=b.getEndPosition(),M=Math.min(this._context.viewModel.model.getLineMaxColumn(A.lineNumber)-A.column,N);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(A.lineNumber)-A.column-M}})();this._context.viewModel.revealRange("keyboard",!0,G.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new zLe(this._context,b.startLineNumber,C,x,S),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${U_} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(p=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${U_}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(rc.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}get domNode(){return this.textArea}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),n=x1(t,[]);let r=!0,o=e.column,a=!0,l=e.column,c=0;for(;c<50&&(r||a);){if(r&&o<=1&&(r=!1),r){const h=i.charCodeAt(o-2);n.get(h)!==0?r=!1:o--}if(a&&l>i.length&&(a=!1),a){const h=i.charCodeAt(l-1);n.get(h)!==0?a=!1:l++}c++}return[i.substring(o-1,l-1),e.column-o]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=x1(this._context.configuration.options.get(148),[]);let n=e.column,r=0;for(;n>1;){const o=t.charCodeAt(n-2);if(i.get(o)!==0||r>50)return t.substring(n-1,e.column-1);r++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!Tn(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===mo.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const n=e.get(165).wrappingColumn;if(n!==-1&&this._accessibilitySupport!==1){const r=e.get(59);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(n*r.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=AR?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(59),this._emptySelectionClipboard=t.get(45),this._copyWithSyntaxHighlighting=t.get(31),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:n}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${n*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",R5(t,this._keybindingService)),this.textArea.setAttribute("aria-required",t.get(9)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(140))),(e.hasChanged(41)||e.hasChanged(104))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!rc.enabled||e.get(41)&&e.get(104)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){var t;this._primaryCursorPosition=new J(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),(t=this._visibleTextArea)==null||t.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const i=this._visibleTextArea.visibleTextareaStart,n=this._visibleTextArea.visibleTextareaEnd,r=this._visibleTextArea.startPosition,o=this._visibleTextArea.endPosition;if(r&&o&&i&&n&&n.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){const a=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,l=yj(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let c=this._visibleTextArea.widthOfHiddenLineTextBefore,h=this._contentLeft+i.left-this._scrollLeft,d=n.left-i.left+1;if(h<this._contentLeft){const y=this._contentLeft-h;h+=y,c+=y,d-=y}d>this._contentWidth&&(d=this._contentWidth);const g=this._context.viewLayout.getLineHeightForLineNumber(r.lineNumber),p=this._context.viewModel.getFontSizeAtPosition(this._primaryCursorPosition),_=this._context.viewModel.getViewLineData(r.lineNumber),b=_.tokens.findTokenIndexAtOffset(r.column-1),C=_.tokens.findTokenIndexAtOffset(o.column-1),x=b===C,S=this._visibleTextArea.definePresentation(x?_.tokens.getPresentation(b):null);this.textArea.domNode.scrollTop=l*g,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:a,left:h,width:d,height:g,useCover:!1,color:(hn.getColorMap()||[])[S.foreground],italic:S.italic,bold:S.bold,underline:S.underline,strikethrough:S.strikethrough,fontSize:p})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(_t||this._accessibilitySupport===2){const i=this._primaryCursorPosition.lineNumber,n=this._context.viewLayout.getLineHeightForLineNumber(i);this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:n,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const r=this._textAreaInput.textAreaState.newlineCountBeforeSelection??yj(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=r*n;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:AR?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:AR?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;vs(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setLineHeight(e.height),t.setFontSize(e.fontSize??this._fontInfo.fontSize),t.setColor(e.color?me.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(66)?i.setClassName("monaco-editor-background textAreaCover "+Hk.OUTER_CLASS_NAME):n.get(76).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+Bk.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};A5=WLe([Sj(4,rs),Sj(5,It)],A5);function ULe(s,e,t,i){if(e.length===0)return 0;const n=s.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const r=s.createElement("span");vs(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${i*t.spaceWidth}px`,r.append(e),n.appendChild(r),s.body.appendChild(n);const o=r.offsetWidth;return n.remove(),o}var jLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$Le=function(s,e){return function(t,i){e(t,i,s)}};let M5=class extends le{constructor(e,t,i){super(),this._domNode=t,this._onFocusChange=i,this._isFocused=!1,this._isPaused=!1,this._register(ie(this._domNode,"focus",()=>{e.trace("NativeEditContext.focus"),!this._isPaused&&this.refreshFocusState()})),this._register(ie(this._domNode,"blur",()=>{e.trace("NativeEditContext.blur"),!this._isPaused&&this._handleFocusedChanged(!1)}))}pause(){this._isPaused=!0}resume(){this._isPaused=!1,this.refreshFocusState()}_handleFocusedChanged(e){this._isFocused!==e&&(this._isFocused=e,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus(),this.refreshFocusState()}refreshFocusState(){const e=om(this._domNode),t=e?e.activeElement:Kn(),i=this._domNode===t;this._handleFocusedChanged(i)}get isFocused(){return this._isFocused}};M5=jLe([$Le(0,pr)],M5);function h0(s,e,t,i){return s.addEventListener(e,t,i),{dispose(){s.removeEventListener(e,t)}}}var qLe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},GLe=function(s,e){return function(t,i){e(t,i,s)}};const MR=Wd("richScreenReaderContent",{createHTML:s=>s}),OR="data-line-number";let O5=class extends le{constructor(e,t,i,n){super(),this._domNode=e,this._context=t,this._viewController=i,this._accessibilityService=n,this._selectionChangeListener=this._register(new Yn),this._accessibilityPageSize=1,this._ignoreSelectionChangeTime=0,this._state=Kv.NULL,this._strategy=new QLe,this._renderedLines=new Map,this._renderedSelection=new Lt(1,1,1,1),this.onConfigurationChanged(this._context.configuration.options)}updateScreenReaderContent(e){const t=Kt().document.activeElement;if(!t||t!==this._domNode.domNode)return;if(this._accessibilityService.isScreenReaderOptimized()){const n=this._getScreenReaderContentLineIntervals(e);this._state.equals(n)||(this._state=n,this._renderedLines=this._renderScreenReaderContent(n)),this._renderedSelection.equalsSelection(e)||(this._renderedSelection=e,this._setSelectionOnScreenReaderContent(this._context,this._renderedLines,e))}else this._state=Kv.NULL,this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.textContent=""}updateScrollTop(e){const t=this._state.intervals;if(!t.length)return;const i=this._context.viewModel.viewLayout,n=t[0].startLine,r=i.getVerticalOffsetForLineNumber(n),o=i.getVerticalOffsetForLineNumber(e.positionLineNumber);this._domNode.domNode.scrollTop=o-r}onFocusChange(e){e?this._selectionChangeListener.value=this._setSelectionChangeListener():this._selectionChangeListener.value=void 0}onConfigurationChanged(e){this._accessibilityPageSize=e.get(3)}onWillCut(){this._setIgnoreSelectionChangeTime("onCut")}onWillPaste(){this._setIgnoreSelectionChangeTime("onWillPaste")}_setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}_setSelectionChangeListener(){let e=0;return ie(this._domNode.domNode.ownerDocument,"selectionchange",()=>{if(!(Kt().document.activeElement===this._domNode.domNode)||!this._accessibilityService.isScreenReaderOptimized()||!rc.enabled)return;const r=Date.now(),o=r-e;if(e=r,o<5)return;const a=r-this._ignoreSelectionChangeTime;if(this._ignoreSelectionChangeTime=0,a<100)return;const l=this._getEditorSelectionFromDomRange();l&&this._viewController.setSelection(l)})}_renderScreenReaderContent(e){const t=[],i=new Map;for(const n of e.intervals)for(let r=n.startLine;r<=n.endLine;r++){const o=this._renderLine(r);i.set(r,o),t.push(o.domNode)}return this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.replaceChildren(...t),i}_renderLine(e){const t=this._context.viewModel,i=t.getViewLineRenderingData(e),n=this._context.configuration.options,r=n.get(59),o=n.get(133),a=n.get(108),l=n.get(60),c=n.get(40),h=ia.filter(i.inlineDecorations,e,i.minColumn,i.maxColumn),d=r.isMonospace&&!c,g=l!==Nd.OFF;let p;n.get(47)==="off"?p=n.get(113):p="none";const b=new Tm(d,r.canUseHalfwidthRightwardsArrow,i.content,i.continuesWithWrappedLine,i.isBasicASCII,i.containsRTL,i.minColumn-1,i.tokens,h,i.tabSize,i.startVisibleColumn,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,o,p,a,g,null,null,0,!0),C=new J1(1e4),x=RD(b,C),S=C.build(),y=(MR==null?void 0:MR.createHTML(S))??S,k=t.viewLayout.getLineHeightForLineNumber(e)+"px",D=document.createElement("div");return D.innerHTML=y,D.style.lineHeight=k,D.style.height=k,D.setAttribute(OR,e.toString()),new KLe(D,x.characterMapping)}_setSelectionOnScreenReaderContent(e,t,i){const r=Kt().document.getSelection();if(!r)return;const o=i.startLineNumber,a=i.endLineNumber,l=t.get(o),c=t.get(a);if(!l||!c)return;const h=e.viewModel,d=h.model,g=h.coordinatesConverter,p=new G(o,1,o,i.selectionStartColumn),_=g.convertViewRangeToModelRange(p),b=d.getCharacterCountInRange(_),C=new G(a,1,a,i.positionColumn),x=g.convertViewRangeToModelRange(C),S=d.getCharacterCountInRange(x),y=l.characterMapping.getDomPosition(b),k=c.characterMapping.getDomPosition(S),D=l.domNode.firstChild,R=c.domNode.firstChild,N=D.childNodes,A=R.childNodes,M=N.item(y.partIndex),O=A.item(k.partIndex);!M.firstChild||!O.firstChild||(this._setIgnoreSelectionChangeTime("setRange"),r.setBaseAndExtent(M.firstChild,i.startColumn===1?0:y.charIndex+1,O.firstChild,i.endColumn===1?0:k.charIndex+1))}_getScreenReaderContentLineIntervals(e){return this._strategy.fromEditorSelection(this._context.viewModel,e,this._accessibilityPageSize)}_getEditorSelectionFromDomRange(){var S,y,k,D;if(!this._renderedLines)return;const e=Kt().document.getSelection();if(!e||e.rangeCount===0)return;const i=e.getRangeAt(0),n=i.startContainer,r=i.endContainer,o=n.parentElement,a=r.parentElement;if(!o||!nn(o)||!a||!nn(a))return;const l=(S=o.parentElement)==null?void 0:S.parentElement,c=(y=a.parentElement)==null?void 0:y.parentElement;if(!l||!c)return;const h=l.getAttribute(OR),d=c.getAttribute(OR);if(!h||!d)return;const g=parseInt(h),p=parseInt(d),_=(k=this._renderedLines.get(g))==null?void 0:k.characterMapping,b=(D=this._renderedLines.get(p))==null?void 0:D.characterMapping;if(!_||!b)return;const C=zv(_,o,i.startOffset),x=zv(b,a,i.endOffset);return e.direction==="forward"?new Lt(g,C,p,x):new Lt(p,x,g,C)}};O5=qLe([GLe(3,Mo)],O5);class KLe{constructor(e,t){this.domNode=e,this.characterMapping=t}}class YLe{constructor(e,t){this.startLine=e,this.endLine=t}}class Kv{constructor(e,t){this.intervals=t;let i="";for(const n of t)for(let r=n.startLine;r<=n.endLine;r++)i+=e.getLineContent(r)+`
`;this.value=i}equals(e){return this.value===e.value}static get NULL(){const e={getLineContent:()=>"",getLineCount:()=>1,getLineMaxColumn:()=>1,getValueInRange:()=>"",getValueLengthInRange:()=>0,modifyPosition:(t,i)=>t};return new Kv(e,[])}}class QLe{constructor(){}_getPageOfLine(e,t){return Math.floor((e-1)/t)}_getRangeForPage(e,t,i){const n=t*i,r=n+1,o=Math.min(n+i,e.getLineCount());return new YLe(r,o)}fromEditorSelection(e,t,i){const n=this._getPageOfLine(t.startLineNumber,i),r=this._getRangeForPage(e,n,i),o=this._getPageOfLine(t.endLineNumber,i),a=this._getRangeForPage(e,o,i),l=[{startLine:r.startLine,endLine:r.endLine}];return n+1<o&&l.push({startLine:a.startLine,endLine:a.endLine}),new Kv(e,l)}}class XLe{constructor(e){this.replacements=e;let t=-1;for(const i of e){if(!(i.replaceRange.start>=t))throw new $e(`Edits must be disjoint and sorted. Found ${i} after ${t}`);t=i.replaceRange.endExclusive}}toString(){return`[${this.replacements.map(t=>t.toString()).join(", ")}]`}normalize(){const e=[];let t;for(const i of this.replacements)if(!(i.getNewLength()===0&&i.replaceRange.length===0)){if(t&&t.replaceRange.endExclusive===i.replaceRange.start){const n=t.tryJoinTouching(i);if(n){t=n;continue}}t&&e.push(t),t=i}return t&&e.push(t),this._createNew(e)}compose(e){const t=this.normalize(),i=e.normalize();if(t.isEmpty())return i;if(i.isEmpty())return t;const n=[...t.replacements],r=[];let o=0;for(const a of i.replacements){for(;;){const d=n[0];if(!d||d.replaceRange.start+o+d.getNewLength()>=a.replaceRange.start)break;n.shift(),r.push(d),o+=d.getNewLength()-d.replaceRange.length}const l=o;let c,h;for(;;){const d=n[0];if(!d||d.replaceRange.start+o>a.replaceRange.endExclusive)break;c||(c=d),h=d,n.shift(),o+=d.getNewLength()-d.replaceRange.length}if(!c)r.push(a.delta(-o));else{const d=Math.min(c.replaceRange.start,a.replaceRange.start-l),g=a.replaceRange.start-(c.replaceRange.start+l);if(g>0){const C=c.slice(ze.emptyAt(d),new ze(0,g));r.push(C)}if(!h)throw new $e("Invariant violation: lastIntersecting is undefined");const p=h.replaceRange.endExclusive+o-a.replaceRange.endExclusive;if(p>0){const C=h.slice(ze.ofStartAndLength(h.replaceRange.endExclusive,0),new ze(h.getNewLength()-p,h.getNewLength()));n.unshift(C),o-=C.getNewLength()-C.replaceRange.length}const _=new ze(d,a.replaceRange.endExclusive-o),b=a.slice(_,new ze(0,a.getNewLength()));r.push(b)}}for(;;){const a=n.shift();if(!a)break;r.push(a)}return this._createNew(r).normalize()}getNewRanges(){const e=[];let t=0;for(const i of this.replacements)e.push(ze.ofStartAndLength(i.replaceRange.start+t,i.getNewLength())),t+=i.getLengthDelta();return e}isEmpty(){return this.replacements.length===0}}class ZLe{constructor(e){this.replaceRange=e}delta(e){return this.slice(this.replaceRange.delta(e),new ze(0,this.getNewLength()))}getLengthDelta(){return this.getNewLength()-this.replaceRange.length}toString(){return`{ ${this.replaceRange.toString()} -> ${this.getNewLength()} }`}get isEmpty(){return this.getNewLength()===0&&this.replaceRange.length===0}getRangeAfterReplace(){return new ze(this.replaceRange.start,this.replaceRange.start+this.getNewLength())}}class JLe extends XLe{apply(e){const t=[];let i=0;for(const n of this.replacements)t.push(e.substring(i,n.replaceRange.start)),t.push(n.newText),i=n.replaceRange.endExclusive;return t.push(e.substring(i)),t.join("")}}class eke extends ZLe{constructor(e,t){super(e),this.newText=t}getNewLength(){return this.newText.length}toString(){return`${this.replaceRange} -> ${JSON.stringify(this.newText)}`}replace(e){return e.substring(0,this.replaceRange.start)+this.newText+e.substring(this.replaceRange.endExclusive)}removeCommonSuffixPrefix(e){const t=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),i=b1(t,this.newText),n=Math.min(t.length-i,this.newText.length-i,w1(t,this.newText)),r=new ze(this.replaceRange.start+i,this.replaceRange.endExclusive-n),o=this.newText.substring(i,this.newText.length-n);return new dg(r,o)}removeCommonSuffixAndPrefix(e){return this.removeCommonSuffix(e).removeCommonPrefix(e)}removeCommonPrefix(e){const t=this.replaceRange.substring(e),i=b1(t,this.newText);return i===0?this:this.slice(this.replaceRange.deltaStart(i),new ze(i,this.newText.length))}removeCommonSuffix(e){const t=this.replaceRange.substring(e),i=w1(t,this.newText);return i===0?this:this.slice(this.replaceRange.deltaEnd(-i),new ze(0,this.newText.length-i))}toJson(){return{txt:this.newText,pos:this.replaceRange.start,len:this.replaceRange.length}}}const C_=class C_ extends JLe{static compose(e){if(e.length===0)return C_.empty;let t=e[0];for(let i=1;i<e.length;i++)t=t.compose(e[i]);return t}constructor(e){super(e)}_createNew(e){return new C_(e)}};C_.empty=new C_([]);let P5=C_;class dg extends eke{static insert(e,t){return new dg(ze.emptyAt(e),t)}static replace(e,t){return new dg(e,t)}equals(e){return this.replaceRange.equals(e.replaceRange)&&this.newText===e.newText}tryJoinTouching(e){return new dg(this.replaceRange.joinRightTouching(e.replaceRange),this.newText+e.newText)}slice(e,t){return new dg(e,t?t.substring(this.newText):this.newText)}}q0e({StringEdit:P5,StringReplacement:dg,TextReplacement:il,TextEdit:Av,TextLength:Yr});var tke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ike=function(s,e){return function(t,i){e(t,i,s)}};let F5=class extends le{constructor(e,t,i,n){super(),this._domNode=e,this._context=t,this._viewController=i,this._accessibilityService=n,this._selectionChangeListener=this._register(new Yn),this._accessibilityPageSize=1,this._ignoreSelectionChangeTime=0,this._strategy=new ree,this.onConfigurationChanged(this._context.configuration.options)}updateScreenReaderContent(e){const t=this._domNode.domNode,i=Kt().document.activeElement;if(!i||i!==t)return;if(this._accessibilityService.isScreenReaderOptimized()){this._state=this._getScreenReaderContentState(e),t.textContent!==this._state.value&&(this._setIgnoreSelectionChangeTime("setValue"),t.textContent=this._state.value);const r=Kt().document.getSelection();if(!r)return;const o=this._getScreenReaderRange(this._state.selectionStart,this._state.selectionEnd);if(!o)return;this._setIgnoreSelectionChangeTime("setRange"),r.setBaseAndExtent(o.anchorNode,o.anchorOffset,o.focusNode,o.focusOffset)}else this._state=void 0,this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.textContent=""}updateScrollTop(e){if(!this._state)return;const t=this._context.viewModel.viewLayout,i=this._state.startPositionWithinEditor.lineNumber,n=t.getVerticalOffsetForLineNumber(i),r=t.getVerticalOffsetForLineNumber(e.positionLineNumber);this._domNode.domNode.scrollTop=r-n}onFocusChange(e){e?this._selectionChangeListener.value=this._setSelectionChangeListener():this._selectionChangeListener.value=void 0}onConfigurationChanged(e){this._accessibilityPageSize=e.get(3)}onWillCut(){this._setIgnoreSelectionChangeTime("onCut")}onWillPaste(){this._setIgnoreSelectionChangeTime("onWillPaste")}_setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}_setSelectionChangeListener(){let e=0;return ie(this._domNode.domNode.ownerDocument,"selectionchange",()=>{const t=this._accessibilityService.isScreenReaderOptimized();if(!this._state||!t||!rc.enabled||!(Kt().document.activeElement===this._domNode.domNode))return;const r=Kt().document.getSelection();if(!r||r.rangeCount===0)return;const a=r.getRangeAt(0),l=Date.now(),c=l-e;if(e=l,c<5)return;const h=l-this._ignoreSelectionChangeTime;this._ignoreSelectionChangeTime=0,!(h<100)&&this._viewController.setSelection(this._getEditorSelectionFromDomRange(this._context,this._state,r.direction,a))})}_getScreenReaderContentState(e){const t=this._strategy.fromEditorSelection(this._context.viewModel,e,this._accessibilityPageSize,this._accessibilityService.getAccessibilitySupport()===0),i=this._context.viewModel.model.getPositionAt(1/0);let n=t.value;return i.column===1&&e.getEndPosition().equals(i)&&(n+=`
`),t.value=n,t}_getScreenReaderRange(e,t){const i=this._domNode.domNode.firstChild;if(!i)return;const n=new globalThis.Range;return n.setStart(i,e),n.setEnd(i,t),{anchorNode:i,anchorOffset:e,focusNode:i,focusOffset:t}}_getEditorSelectionFromDomRange(e,t,i,n){const r=e.viewModel,o=r.model,l=r.coordinatesConverter.convertViewPositionToModelPosition(t.startPositionWithinEditor),c=o.getOffsetAt(l);let h=n.startOffset+c,d=n.endOffset+c;if(o.getEndOfLineSequence()===1){const x=t.value,S=new ND(x),y=S.getPosition(n.startOffset),k=S.getPosition(n.endOffset);h+=y.lineNumber-1,d+=k.lineNumber-1}const p=o.getPositionAt(h),_=o.getPositionAt(d),b=i==="forward"?p:_,C=i==="forward"?_:p;return Lt.fromPositions(b,C)}};F5=tke([ike(3,Mo)],F5);var nke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xj=function(s,e){return function(t,i){e(t,i,s)}};let B5=class extends le{constructor(e,t,i,n,r){super(),this._domNode=e,this._context=t,this._viewController=i,this._keybindingService=n,this._accessibilityService=r,this._contentLeft=1,this._contentWidth=1,this._contentHeight=1,this._divWidth=1,this._primarySelection=new Lt(1,1,1,1),this._primaryCursorVisibleRange=null,this._state=this._register(new Yn),this._instantiateScreenReaderContent(),this._updateConfigurationSettings(),this._updateDomAttributes()}onWillPaste(){var e;(e=this._state.value)==null||e.onWillPaste()}onWillCut(){var e;(e=this._state.value)==null||e.onWillCut()}handleFocusChange(e){var t;(t=this._state.value)==null||t.onFocusChange(e),this.writeScreenReaderContent()}onConfigurationChanged(e){this._instantiateScreenReaderContent(),this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_instantiateScreenReaderContent(){const e=this._context.configuration.options.get(107);this._renderRichContent!==e&&(this._renderRichContent=e,this._state.value=this._createScreenReaderContent(e))}_createScreenReaderContent(e){return e?new O5(this._domNode,this._context,this._viewController,this._accessibilityService):new F5(this._domNode,this._context,this._viewController,this._accessibilityService)}_updateConfigurationSettings(){var n;const e=this._context.configuration.options,t=e.get(165),i=t.wrappingColumn;this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._contentHeight=t.height,this._fontInfo=e.get(59),this._divWidth=Math.round(i*this._fontInfo.typicalHalfwidthCharacterWidth),(n=this._state.value)==null||n.onConfigurationChanged(e)}_updateDomAttributes(){const e=this._context.configuration.options;this._domNode.domNode.setAttribute("role","textbox"),this._domNode.domNode.setAttribute("aria-required",e.get(9)?"true":"false"),this._domNode.domNode.setAttribute("aria-multiline","true"),this._domNode.domNode.setAttribute("aria-autocomplete",e.get(104)?"none":"both"),this._domNode.domNode.setAttribute("aria-roledescription",v(60,"editor")),this._domNode.domNode.setAttribute("aria-label",R5(e,this._keybindingService));const t=this._context.viewModel.model.getOptions().tabSize,i=e.get(59).spaceWidth;this._domNode.domNode.style.tabSize=`${t*i}px`;const n=e.get(154),r=n==="inherit"?e.get(153):n,o=r==="inherit"?e.get(149):r;this._domNode.domNode.style.textWrap=o==="off"?"nowrap":"wrap"}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new Lt(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent(),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primarySelection.getPosition())}render(e){var l;if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const t=this._context.viewLayout.getCurrentScrollLeft(),i=this._contentLeft+this._primaryCursorVisibleRange.left-t;if(i<this._contentLeft||i>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const n=this._context.viewLayout.getCurrentScrollTop(),r=this._primarySelection.positionLineNumber,o=this._context.viewLayout.getVerticalOffsetForLineNumber(r)-n;if(o<0||o>this._contentHeight){this._renderAtTopLeft();return}const a=this._context.viewLayout.getLineHeightForLineNumber(r);this._doRender(o,this._contentLeft,this._divWidth,a),(l=this._state.value)==null||l.updateScrollTop(this._primarySelection)}_renderAtTopLeft(){this._doRender(0,0,this._contentWidth,1)}_doRender(e,t,i,n){vs(this._domNode,this._fontInfo),this._domNode.setTop(e),this._domNode.setLeft(t),this._domNode.setWidth(i),this._domNode.setHeight(n),this._domNode.setLineHeight(n)}setAriaOptions(e){e.activeDescendant?(this._domNode.setAttribute("aria-haspopup","true"),this._domNode.setAttribute("aria-autocomplete","list"),this._domNode.setAttribute("aria-activedescendant",e.activeDescendant)):(this._domNode.setAttribute("aria-haspopup","false"),this._domNode.setAttribute("aria-autocomplete","both"),this._domNode.removeAttribute("aria-activedescendant")),e.role&&this._domNode.setAttribute("role",e.role)}writeScreenReaderContent(){var e;(e=this._state.value)==null||e.updateScreenReaderContent(this._primarySelection)}};B5=nke([xj(3,rs),xj(4,Mo)],B5);var V5;(function(s){function e(t,i){return new t.EditContext(i)}s.create=e})(V5||(V5={}));class ske{constructor(){this._nativeEditContextMapping=new Map}register(e,t){return this._nativeEditContextMapping.set(e,t),{dispose:()=>{this._nativeEditContextMapping.delete(e)}}}get(e){return this._nativeEditContextMapping.get(e)}}const rke=new ske;var oke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Lj=function(s,e){return function(t,i){e(t,i,s)}},aw;(function(s){s.NONE="edit-context-composition-none",s.SECONDARY="edit-context-composition-secondary",s.PRIMARY="edit-context-composition-primary"})(aw||(aw={}));let qk=class extends see{constructor(e,t,i,n,r,o,a){super(t),this._viewController=n,this._visibleRangeProvider=r,this.logService=a,this._previousEditContextSelection=new ze(0,0),this._editContextPrimarySelection=new Lt(1,1,1,1),this._decorations=[],this._primarySelection=new Lt(1,1,1,1),this._targetWindowId=-1,this._scrollTop=0,this._scrollLeft=0,this._linesVisibleRanges=null,this.domNode=new ck(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._imeTextArea=new ck(document.createElement("textarea")),this._imeTextArea.setClassName("ime-text-area"),this._imeTextArea.setAttribute("readonly","true"),this._imeTextArea.setAttribute("tabindex","-1"),this._imeTextArea.setAttribute("aria-hidden","true"),this.domNode.setAttribute("autocorrect","off"),this.domNode.setAttribute("autocapitalize","off"),this.domNode.setAttribute("autocomplete","off"),this.domNode.setAttribute("spellcheck","false"),this._updateDomAttributes(),i.appendChild(this.domNode),i.appendChild(this._imeTextArea),this._parent=i.domNode,this._focusTracker=this._register(new M5(a,this.domNode.domNode,d=>{a.trace("NativeEditContext#handleFocusChange : ",d),this._screenReaderSupport.handleFocusChange(d),this._context.viewModel.setHasFocus(d)}));const l=Ue(this.domNode.domNode);this._editContext=V5.create(l),this.setEditContextOnDomNode(),this._screenReaderSupport=this._register(o.createInstance(B5,this.domNode,t,this._viewController)),this._register(ie(this.domNode.domNode,"copy",d=>{this.logService.trace("NativeEditContext#copy"),this._ensureClipboardGetsEditorSelection(d)})),this._register(ie(this.domNode.domNode,"cut",d=>{this.logService.trace("NativeEditContext#cut"),this._screenReaderSupport.onWillCut(),this._ensureClipboardGetsEditorSelection(d),this.logService.trace("NativeEditContext#cut (before viewController.cut)"),this._viewController.cut()})),this._register(ie(this.domNode.domNode,"keyup",d=>this._onKeyUp(d))),this._register(ie(this.domNode.domNode,"keydown",async d=>this._onKeyDown(d))),this._register(ie(this._imeTextArea.domNode,"keyup",d=>this._onKeyUp(d))),this._register(ie(this._imeTextArea.domNode,"keydown",async d=>this._onKeyDown(d))),this._register(ie(this.domNode.domNode,"beforeinput",async d=>{(d.inputType==="insertParagraph"||d.inputType==="insertLineBreak")&&this._onType(this._viewController,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0})})),this._register(ie(this.domNode.domNode,"paste",d=>{if(this.logService.trace("NativeEditContext#paste"),d.preventDefault(),!d.clipboardData)return;let[g,p]=Rk.getTextData(d.clipboardData);if(this.logService.trace("NativeEditContext#paste with id : ",p==null?void 0:p.id," with text.length: ",g.length),!g)return;p=p||Lg.INSTANCE.get(g);let _=!1,b=null,C=null;p&&(_=this._context.configuration.options.get(45)&&!!p.isFromEmptySelection,b=typeof p.multicursorText<"u"?p.multicursorText:null,C=p.mode),this.logService.trace("NativeEditContext#paste (before viewController.paste)"),this._viewController.paste(g,_,b,C)})),this._register(h0(this._editContext,"textformatupdate",d=>this._handleTextFormatUpdate(d))),this._register(h0(this._editContext,"characterboundsupdate",d=>this._updateCharacterBounds(d)));let c;this._register(h0(this._editContext,"textupdate",d=>{const g=d.text;if(g.length===1){const p=g.charCodeAt(0);if(Tn(p)){c=g;return}if(im(p)&&c){const _={text:c+g,selectionEnd:d.selectionEnd,selectionStart:d.selectionStart,updateRangeStart:d.updateRangeStart-1,updateRangeEnd:d.updateRangeEnd-1};c=void 0,this._emitTypeEvent(this._viewController,_);return}}this._emitTypeEvent(this._viewController,d)})),this._register(h0(this._editContext,"compositionstart",d=>{this._updateEditContext(),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(h0(this._editContext,"compositionend",d=>{this._updateEditContext(),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}));let h=!1;this._register(rc.onDidChange(()=>{rc.enabled&&h&&(this._focusTracker.resume(),this.domNode.focus(),h=!1),!rc.enabled&&this.isFocused()&&(this._focusTracker.pause(),this._imeTextArea.focus(),h=!0)})),this._register(rke.register(e,this))}dispose(){this.domNode.domNode.editContext=void 0,this.domNode.domNode.blur(),this.domNode.domNode.remove(),this._imeTextArea.domNode.remove(),super.dispose()}setAriaOptions(e){this._screenReaderSupport.setAriaOptions(e)}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._screenReaderSupport.prepareRender(e),this._updateSelectionAndControlBoundsData(e)}onDidRender(){this._updateSelectionAndControlBoundsAfterRender()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new Lt(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),this._updateEditContext(),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.fromLineNumber+e.count-1),!0}onLinesDeleted(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.toLineNumber),!0}onLinesInserted(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.toLineNumber),!0}_updateEditContextOnLineChange(e,t){this._editContextPrimarySelection.endLineNumber<e||this._editContextPrimarySelection.startLineNumber>t||this._updateEditContext()}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}onWillPaste(){this.logService.trace("NativeEditContext#onWillPaste"),this._onWillPaste()}_onWillPaste(){this._screenReaderSupport.onWillPaste()}onWillCopy(){this.logService.trace("NativeEditContext#onWillCopy"),this.logService.trace("NativeEditContext#isFocused : ",this.domNode.domNode===Kn())}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus(),this.refreshFocusState()}refreshFocusState(){this._focusTracker.refreshFocusState()}setEditContextOnDomNode(){const e=Ue(this.domNode.domNode),t=Dv(e);this._targetWindowId!==t&&(this.domNode.domNode.editContext=this._editContext,this._targetWindowId=t)}_onKeyUp(e){this._viewController.emitKeyUp(new si(e))}_onKeyDown(e){const t=new si(e);t.keyCode===114&&t.stopPropagation(),this._viewController.emitKeyDown(t)}_updateDomAttributes(){const e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(140)))}_updateEditContext(){const e=this._getNewEditContextState();e&&(this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text??" "),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._editContextPrimarySelection=e.editContextPrimarySelection,this._previousEditContextSelection=new ze(e.selectionStartOffset,e.selectionEndOffset))}_emitTypeEvent(e,t){if(!this._editContext)return;const i=this._previousEditContextSelection.endExclusive,n=this._previousEditContextSelection.start;this._previousEditContextSelection=new ze(t.selectionStart,t.selectionEnd);let r=0,o=0;t.updateRangeEnd>i&&(r=t.updateRangeEnd-i),t.updateRangeStart<n&&(o=n-t.updateRangeStart);let a="";n<t.updateRangeStart&&(a+=this._editContext.text.substring(n,t.updateRangeStart)),a+=t.text,i>t.updateRangeEnd&&(a+=this._editContext.text.substring(t.updateRangeEnd,i));let l=0;t.selectionStart===t.selectionEnd&&n===i&&(l=t.selectionStart-(t.updateRangeStart+t.text.length));const c={text:a,replacePrevCharCnt:o,replaceNextCharCnt:r,positionDelta:l};this._onType(e,c)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_getNewEditContextState(){const e=this._primarySelection,t=this._context.viewModel.model;if(!t.isValidRange(e))return;const i=e.startLineNumber,n=e.endLineNumber,r=t.getLineMaxColumn(n),o=new G(i,1,n,r),a=t.getValueInRange(o,0),l=e.startColumn-1,c=a.length+e.endColumn-r;return{text:a,selectionStartOffset:l,selectionEndOffset:c,editContextPrimarySelection:e}}_editContextStartPosition(){return new J(this._editContextPrimarySelection.startLineNumber,1)}_handleTextFormatUpdate(e){if(!this._editContext)return;const t=e.getTextFormats(),i=this._editContextStartPosition(),n=[];t.forEach(r=>{const o=this._context.viewModel.model,a=o.getOffsetAt(i),l=o.getPositionAt(a+r.rangeStart),c=o.getPositionAt(a+r.rangeEnd),h=G.fromPositions(l,c),d=r.underlineThickness.toLowerCase();let g=aw.NONE;switch(d){case"thin":g=aw.SECONDARY;break;case"thick":g=aw.PRIMARY;break}n.push({range:h,options:{description:"textFormatDecoration",inlineClassName:g}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,n)}_updateSelectionAndControlBoundsData(e){const t=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(this._primarySelection);if(this._primarySelection.isEmpty()){const i=e.visibleRangeForPosition(t.getStartPosition());this._linesVisibleRanges=i}else this._linesVisibleRanges=null}_updateSelectionAndControlBoundsAfterRender(){const t=this._context.configuration.options.get(165).contentLeft,i=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(this._primarySelection),n=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),r=this._context.viewLayout.getVerticalOffsetAfterLineNumber(i.endLineNumber),o=this._parent.getBoundingClientRect(),a=o.top+n-this._scrollTop,l=r-n;let c=o.left+t-this._scrollLeft,h;this._primarySelection.isEmpty()?(this._linesVisibleRanges&&(c+=this._linesVisibleRanges.left),h=0):h=o.width-t;const d=new DOMRect(c,a,h,l);this._editContext.updateSelectionBounds(d),this._editContext.updateControlBounds(d)}_updateCharacterBounds(e){const t=this._context.configuration.options,i=t.get(59).typicalHalfwidthCharacterWidth,n=t.get(165).contentLeft,r=this._parent.getBoundingClientRect(),o=[],a=new ND(this._editContext.text);for(let l=e.rangeStart;l<e.rangeEnd;l++){const c=a.getPosition(l),h=this._editContextPrimarySelection.startLineNumber-1,d=new J(h+c.lineNumber,c.column),g=d.delta(0,1),p=G.fromPositions(d,g),_=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(p),b=this._visibleRangeProvider.linesVisibleRangesForRange(_,!0)??[],C=_.startLineNumber,x=this._context.viewLayout.getVerticalOffsetForLineNumber(C),S=r.top+x-this._scrollTop;let y=0,k=i;if(b.length>0)for(const R of b[0].ranges){y=R.left,k=R.width;break}const D=this._context.viewLayout.getLineHeightForLineNumber(C);o.push(new DOMRect(r.left+n+y-this._scrollLeft,S,k,D))}this._editContext.updateCharacterBounds(e.rangeStart,o)}_ensureClipboardGetsEditorSelection(e){const t=this._context.configuration.options,i=t.get(45),n=t.get(31),r=this._context.viewModel.getCursorStates().map(c=>c.modelState.selection),o=kJ(this._context.viewModel,r,i,n);let a;this.logService.getLevel()===jn.Trace&&(a=V7());const l={version:1,id:a,isFromEmptySelection:o.isFromEmptySelection,multicursorText:o.multicursorText,mode:o.mode};Lg.INSTANCE.set(Kr?o.text.replace(/\r\n/g,`
`):o.text,l),e.preventDefault(),e.clipboardData&&Rk.setTextData(e.clipboardData,o.text,o.html,l),this.logService.trace("NativeEditContext#_ensureClipboardGetsEditorSelectios with id : ",a," with text.length: ",o.text.length)}};qk=oke([Lj(5,It),Lj(6,pr)],qk);class ake extends br{constructor(e,t){super(e),this._viewGpuContext=t,this._gpuShapes=[],this._register(vt(i=>this._updateEntries(i)))}onConfigurationChanged(e){return this._updateEntries(void 0),!0}prepareRender(e){}render(e){}_updateEntries(e){const t=this._context.configuration.options,i=t.get(116),n=t.get(59).typicalHalfwidthCharacterWidth,r=this._viewGpuContext.devicePixelRatio.read(e);for(let o=0,a=i.length;o<a;o++){const l=i[o],c=this._gpuShapes[o],h=l.color?me.fromHex(l.color):this._context.theme.getColor(exe)??me.white,d=[l.column*n*r,0,Math.max(1,Math.ceil(r)),Number.MAX_SAFE_INTEGER,h.rgba.r/255,h.rgba.g/255,h.rgba.b/255,h.rgba.a];c?c.setRaw(d):this._gpuShapes[o]=this._viewGpuContext.rectangleRenderer.register(...d)}for(;this._gpuShapes.length>i.length;)this._gpuShapes.splice(-1,1)[0].dispose()}}const uE=class uE extends zd{constructor(e,t){super(),this._viewGpuContext=t,this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onCursorStateChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return!0}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.viewportData,r=new Vk(this._context.configuration,this._context.theme.type),o=[];for(let a=t;a<=i;a++){const l=a-t,c=this._viewGpuContext.canRenderDetailed(r,n,a);o[l]=c.length?`<div class="${uE.CLASS_NAME}" title="Cannot render on GPU: ${c.join(", ")}"></div>`:""}this._renderResult=o}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};uE.CLASS_NAME="gpu-mark";let H5=uE;var lke=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},cke=function(s,e){return function(t,i){e(t,i,s)}};let W5=class extends Im{constructor(e,t,i,n,r,o,a,l,c){super(),this._instantiationService=c,this._shouldRecomputeGlyphMarginLanes=!1,this._ownerID=t,this._widgetFocusTracker=this._register(new uke(e,l)),this._register(this._widgetFocusTracker.onChange(()=>{this._context.viewModel.setHasWidgetFocus(this._widgetFocusTracker.hasFocus())})),this._selections=[new Lt(1,1,1,1)],this._renderAnimationFrame=null,this._overflowGuardContainer=Tt(document.createElement("div")),wl.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._viewController=new DSe(n,o,a,i),this._context=new uLe(n,r,o),this._context.addEventHandler(this),this._viewParts=[],this._editContextEnabled=this._context.configuration.options.get(170),this._accessibilitySupport=this._context.configuration.options.get(2),this._editContext=this._instantiateEditContext(),this._viewParts.push(this._editContext),this._linesContent=Tt(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Tt(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._context.configuration.options.get(46)==="on"&&(this._viewGpuContext=this._instantiationService.createInstance(Qo,this._context)),this._scrollbar=new xxe(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new k5(this._context,this._viewGpuContext,this._linesContent),this._viewGpuContext&&(this._viewLinesGpu=this._instantiationService.createInstance(I5,this._context,this._viewGpuContext)),this._viewZones=new rLe(this._context),this._viewParts.push(this._viewZones);const h=new Qxe(this._context);this._viewParts.push(h);const d=new eLe(this._context);this._viewParts.push(d);const g=new NSe(this._context);this._viewParts.push(g),g.addDynamicOverlay(new Cxe(this._context)),g.addDynamicOverlay(new E5(this._context)),g.addDynamicOverlay(new Axe(this._context)),g.addDynamicOverlay(new Sxe(this._context)),g.addDynamicOverlay(new aLe(this._context));const p=new ISe(this._context);this._viewParts.push(p),p.addDynamicOverlay(new yxe(this._context)),p.addDynamicOverlay(new Bxe(this._context)),p.addDynamicOverlay(new Fxe(this._context)),p.addDynamicOverlay(new Bk(this._context)),this._viewGpuContext&&p.addDynamicOverlay(new H5(this._context,this._viewGpuContext)),this._glyphMarginWidgets=new Exe(this._context),this._viewParts.push(this._glyphMarginWidgets);const _=new Hk(this._context);_.getDomNode().appendChild(this._viewZones.marginDomNode),_.getDomNode().appendChild(p.getDomNode()),_.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(_),this._contentWidgets=new ASe(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new D5(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Kxe(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const b=this._viewGpuContext?new ake(this._context,this._viewGpuContext):new Jxe(this._context);this._viewParts.push(b);const C=new RSe(this._context);this._viewParts.push(C);const x=new Gxe(this._context);if(this._viewParts.push(x),h){const S=this._scrollbar.getOverviewRulerLayoutInfo();S.parent.insertBefore(h.getDomNode(),S.insertBefore)}this._linesContent.appendChild(g.getDomNode()),"domNode"in b&&this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(_.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._viewGpuContext&&this._overflowGuardContainer.appendChild(this._viewGpuContext.canvas),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(x.getDomNode()),this._overflowGuardContainer.appendChild(C.domNode),this.domNode.appendChild(this._overflowGuardContainer),l?(l.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),l.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new Qye(this._context,this._viewController,this._createPointerHandlerHelper()))}_instantiateEditContext(){return this._context.configuration.options.get(170)?this._instantiationService.createInstance(qk,this._ownerID,this._context,this._overflowGuardContainer,this._viewController,this._createTextAreaHandlerHelper()):this._instantiationService.createInstance(A5,this._context,this._overflowGuardContainer,this._viewController,this._createTextAreaHandlerHelper())}_updateEditContext(){const e=this._context.configuration.options.get(170),t=this._context.configuration.options.get(2);if(this._editContextEnabled===e&&this._accessibilitySupport===t)return;this._editContextEnabled=e,this._accessibilitySupport=t;const i=this._editContext.isFocused(),n=this._viewParts.indexOf(this._editContext);this._editContext.dispose(),this._editContext=this._instantiateEditContext(),i&&this._editContext.focus(),n!==-1&&this._viewParts.splice(n,1,this._editContext)}_computeGlyphMarginLanes(){const e=this._context.viewModel.model,t=this._context.viewModel.glyphLanes;let i=[],n=0;i=i.concat(e.getAllMarginDecorations().map(r=>{var a,l;const o=((a=r.options.glyphMargin)==null?void 0:a.position)??Rd.Center;return n=Math.max(n,r.range.endLineNumber),{range:r.range,lane:o,persist:(l=r.options.glyphMargin)==null?void 0:l.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(r=>{const o=e.validateRange(r.preference.range);return n=Math.max(n,o.endLineNumber),{range:o,lane:r.preference.lane}})),i.sort((r,o)=>G.compareRangesUsingStarts(r.range,o.range)),t.reset(n);for(const r of i)t.push(r.lane,r.range,r.persist);return t}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,viewLinesGpu:this._viewLinesGpu,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._editContext.domNode.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._editContext.getLastRenderData();return new Cye(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>{var n;this._flushAccumulatedAndRenderNow();const i=new J(e,t);return this._viewLines.visibleRangeForPosition(i)??((n=this._viewLinesGpu)==null?void 0:n.visibleRangeForPosition(i))??null},getLineWidth:e=>{if(this._flushAccumulatedAndRenderNow(),this._viewLinesGpu){const t=this._viewLinesGpu.getLineWidth(e);if(t!==void 0)return t}return this._viewLines.getLineWidth(e)}}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e)),linesVisibleRangesForRange:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.linesVisibleRangesForRange(e,t))}}_applyLayout(){const t=this._context.configuration.options.get(165);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const e=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(162)+" "+x5(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._updateEditContext(),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){var e,t;this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),(e=this._viewGpuContext)==null||e.dispose(),this._viewLines.dispose(),(t=this._viewLinesGpu)==null||t.dispose();for(const i of this._viewParts)i.dispose();super.dispose()}_scheduleRender(){var e;if(this._store.isDisposed)throw new $e;if(this._renderAnimationFrame===null){this._editContext instanceof qk&&this._editContext.setEditContextOnDomNode();const t=this._createCoordinatedRendering();this._renderAnimationFrame=z5.INSTANCE.scheduleCoordinatedRendering({window:Ue((e=this.domNode)==null?void 0:e.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new $e;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new $e;return t.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new $e;return t.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new $e;return t.render(i,n)}})}}_flushAccumulatedAndRenderNow(){const e=this._createCoordinatedRendering();od(()=>e.prepareRenderText());const t=od(()=>e.renderText());if(t){const[i,n]=t;od(()=>e.prepareRender(i,n)),od(()=>e.render(i,n))}}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}nd.onRenderStart()},renderText:()=>{var n;if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new lLe(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),(n=this._viewLinesGpu)!=null&&n.shouldRender()&&(this._viewLinesGpu.renderText(i),this._viewLinesGpu.onDidRender()),[e,new pye(this._context.viewLayout,i,this._viewLines,this._viewLinesGpu)]},prepareRender:(e,t)=>{for(const i of e)i.prepareRender(t)},render:(e,t)=>{for(const i of e)i.render(t),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const r=this._viewLines.visibleRangeForPosition(new J(n.lineNumber,n.column));return r?r.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?zD.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new Zxe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._editContext.writeScreenReaderContent(e)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}isWidgetFocused(){return this._widgetFocusTracker.hasFocus()}setAriaOptions(e){this._editContext.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,n,r;this._contentWidgets.setWidgetPosition(e.widget,((t=e.position)==null?void 0:t.position)??null,((i=e.position)==null?void 0:i.secondaryPosition)??null,((n=e.position)==null?void 0:n.preference)??null,((r=e.position)==null?void 0:r.positionAffinity)??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};W5=lke([cke(8,It)],W5);function od(s){try{return s()}catch(e){return $t(e),null}}const hE=class hE{constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{const t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(const[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){const t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,ZX(e,t,100))}}_onRenderScheduled(){const e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of e)od(()=>i.prepareRenderText());const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];t[i]=od(()=>r.renderText())}for(let i=0,n=e.length;i<n;i++){const r=e[i],o=t[i];if(!o)continue;const[a,l]=o;od(()=>r.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){const r=e[i],o=t[i];if(!o)continue;const[a,l]=o;od(()=>r.render(a,l))}}};hE.INSTANCE=new hE;let z5=hE;class uke extends le{constructor(e,t){super(),this._onChange=this._register(new Z),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(C1(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(C1(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class lw{constructor(e,t,i,n,r){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&n>this.injectionOffsets[r];r++)n<this.injectionOffsets[r]+this.injectionOptions[r].content.length?n=this.injectionOffsets[r]:n-=this.injectionOptions[r].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,r=0,o=0;for(;i<=n;){r=i+(n-i)/2|0;const l=this.breakOffsets[r];if(o=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=o)n=r-1;else if(e>l)i=r+1;else break;else if(e<o)n=r-1;else if(e>=l)i=r+1;else break}let a=e-o;return r>0&&(a+=this.wrappedTextIndentLength),new tx(r,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const n=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(r!==n)return this.offsetInInputWithInjectionsToOutputPosition(r,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new tx(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new tx(e+1,this.getMinOutputOffset(e+1))}return new tx(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&kj(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(Ej(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let r=i.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[i.injectedTextIndex]&&!(kj(this.injectionOptions[r].cursorStops)||(n-=this.injectionOptions[r].content.length,Ej(this.injectionOptions[r].cursorStops)));)r--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,r=i.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)n+=this.injectionOptions[r+1].content.length,r++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,r=i.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)n-=this.injectionOptions[r-1].content.length,r--;return n}E6()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let r=0;r<t.length;r++){const o=i[r].content.length,a=t[r]+n,l=t[r]+n+o;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:o};n+=o}}}}function kj(s){return s==null?!0:s===L1.Right||s===L1.Both}function Ej(s){return s==null?!0:s===L1.Left||s===L1.Both}class tx{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new J(e+this.outputLineIndex,this.outputOffset+1)}}class hke{constructor(){this.changeType=1}}class vl{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(const r of t)i+=e.substring(n,r.column-1),n=r.column-1,i+=r.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new vl(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new vl(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}constructor(e,t,i,n,r){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=r}}class Dj{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class dke{constructor(e,t,i,n){this.ownerId=e,this.decorationId=t,this.lineNumber=i,this.lineHeight=n}}class fke{constructor(e,t){this.ownerId=e,this.lineNumber=t}}class gke{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class mke{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class pke{constructor(){this.changeType=5}}class $_{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,r=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing;return new $_(i,n,r,o)}}class oee{constructor(e){this.changes=e}}let aee=class{constructor(e){this.changes=e}},lee=class{constructor(e){this.changes=e}};class Dg{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=$_.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=Dg._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new Dg(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.eol,r=t.versionId,o=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:c,versionId:r,isUndoing:o,isRedoing:a,isFlush:l,detailedReasons:e.detailedReasons.concat(t.detailedReasons),detailedReasonsChangeLengths:e.detailedReasonsChangeLengths.concat(t.detailedReasonsChangeLengths)}}}const PR=Wd("domLineBreaksComputer",{createHTML:s=>s});class Y7{static create(e){return new Y7(new WeakRef(e))}constructor(e){this.targetWindow=e}createLineBreaksComputer(e,t,i,n,r,o){const a=[],l=[];return{addRequest:(c,h,d)=>{a.push(c),l.push(h)},finalize:()=>_ke(sX(this.targetWindow.deref()),a,e,t,i,n,r,l)}}}function _ke(s,e,t,i,n,r,o,a){function l(M){const O=a[M];if(O){const V=vl.applyInjectedText(e[M],O),H=O.map(X=>X.options),U=O.map(X=>X.column-1);return new lw(U,H,[V.length],[],0)}else return null}if(n===-1){const M=[];for(let O=0,V=e.length;O<V;O++)M[O]=l(O);return M}const c=Math.round(n*t.typicalHalfwidthCharacterWidth),d=Math.round(i*(r===3?2:r===2?1:0)),g=Math.ceil(t.spaceWidth*d),p=document.createElement("div");vs(p,t);const _=new J1(1e4),b=[],C=[],x=[],S=[],y=[];for(let M=0;M<e.length;M++){const O=vl.applyInjectedText(e[M],a[M]);let V=0,H=0,U=c;if(r!==0)if(V=qr(O),V===-1)V=0;else{for(let ee=0;ee<V;ee++){const ue=O.charCodeAt(ee)===9?i-H%i:1;H+=ue}const q=Math.ceil(t.spaceWidth*H);q+t.typicalFullwidthCharacterWidth>c?(V=0,H=0):U=c-q}const X=O.substr(V),Y=bke(X,H,i,U,_,g);b[M]=V,C[M]=H,x[M]=X,S[M]=Y[0],y[M]=Y[1]}const k=_.build(),D=(PR==null?void 0:PR.createHTML(k))??k;p.innerHTML=D,p.style.position="absolute",p.style.top="10000",o==="keepAll"?(p.style.wordBreak="keep-all",p.style.overflowWrap="anywhere"):(p.style.wordBreak="inherit",p.style.overflowWrap="break-word"),s.document.body.appendChild(p);const R=document.createRange(),N=Array.prototype.slice.call(p.children,0),A=[];for(let M=0;M<e.length;M++){const O=N[M],V=wke(R,O,x[M],S[M]);if(V===null){A[M]=l(M);continue}const H=b[M],U=C[M]+d,X=y[M],Y=[];for(let oe=0,Ee=V.length;oe<Ee;oe++)Y[oe]=X[V[oe]];if(H!==0)for(let oe=0,Ee=V.length;oe<Ee;oe++)V[oe]+=H;let q,ee;const ue=a[M];ue?(q=ue.map(oe=>oe.options),ee=ue.map(oe=>oe.column-1)):(q=null,ee=null),A[M]=new lw(ee,q,V,Y,U)}return p.remove(),A}function bke(s,e,t,i,n,r){if(r!==0){const g=String(r);n.appendString('<div style="text-indent: -'),n.appendString(g),n.appendString("px; padding-left: "),n.appendString(g),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');const o=s.length;let a=e,l=0;const c=[],h=[];let d=0<o?s.charCodeAt(0):0;n.appendString("<span>");for(let g=0;g<o;g++){g!==0&&g%16384===0&&n.appendString("</span><span>"),c[g]=l,h[g]=a;const p=d;d=g+1<o?s.charCodeAt(g+1):0;let _=1,b=1;switch(p){case 9:_=t-a%t,b=_;for(let C=1;C<=_;C++)C<_?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:d===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:ih(p)&&b++,p<32?n.appendCharCode(9216+p):n.appendCharCode(p)}l+=_,a+=b}return n.appendString("</span>"),c[s.length]=l,h[s.length]=a,n.appendString("</div>"),[c,h]}function wke(s,e,t,i){if(t.length<=1)return null;const n=Array.prototype.slice.call(e.children,0),r=[];try{U5(s,n,i,0,null,t.length-1,null,r)}catch(o){return console.log(o),null}return r.length===0?null:(r.push(t.length),r)}function U5(s,e,t,i,n,r,o,a){if(i===r||(n=n||FR(s,e,t[i],t[i+1]),o=o||FR(s,e,t[r],t[r+1]),Math.abs(n[0].top-o[0].top)<=.1))return;if(i+1===r){a.push(r);return}const l=i+(r-i)/2|0,c=FR(s,e,t[l],t[l+1]);U5(s,e,t,i,n,l,c,a),U5(s,e,t,l,c,r,o,a)}function FR(s,e,t,i){return s.setStart(e[t/16384|0].firstChild,t%16384),s.setEnd(e[i/16384|0].firstChild,i%16384),s.getClientRects()}class vke extends le{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new A6),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t){if(this._pending.has(n.id)){$t(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register($S(Ue(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register($S(Ue(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register($S(Ue(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){var e;return $S(Ue((e=this._editor)==null?void 0:e.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){$t(i)}}}}class cee{constructor(e,t,i,n,r,o,a){this.id=e,this.label=t,this.alias=i,this.metadata=n,this._precondition=r,this._run=o,this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}function M1(s){let e=0,t=0,i=0,n=0;for(let r=0,o=s.length;r<o;r++){const a=s.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<o&&s.charCodeAt(r+1)===10?(n|=2,r++):n|=3,i=r+1):a===10&&(n|=1,e===0&&(t=r),e++,i=r+1)}return e===0&&(t=s.length),[e,t,s.length-i,n]}class Tj{constructor(e,t,i,n){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=n}}class Cke{constructor(e,t,i,n,r,o){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n,this.nestingLevelOfEqualBracketType=r,this.bracketPairNode=o}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class yke extends Cke{constructor(e,t,i,n,r,o,a){super(e,t,i,n,r,o),this.minVisibleColumnIndentation=a}}function Ske(s,e,t,i){return s!==t?Zi(t-s,i):Zi(0,i-e)}const Nr=0;function Gk(s){return s===0}const Lo=2**26;function Zi(s,e){return s*Lo+e}function oa(s){const e=s,t=Math.floor(e/Lo),i=e-t*Lo;return new Yr(t,i)}function xke(s){return Math.floor(s/Lo)}function pn(s,e){let t=s+e;return e>=Lo&&(t=t-s%Lo),t}function Lke(s,e){return s.reduce((t,i)=>pn(t,e(i)),Nr)}function uee(s,e){return s===e}function Yv(s,e){const t=s,i=e;if(i-t<=0)return Nr;const r=Math.floor(t/Lo),o=Math.floor(i/Lo),a=i-o*Lo;if(r===o){const l=t-r*Lo;return Zi(0,a-l)}else return Zi(o-r,a)}function q_(s,e){return s<e}function G_(s,e){return s<=e}function R0(s,e){return s>=e}function l_(s){return Zi(s.lineNumber-1,s.column-1)}function Tg(s,e){const t=s,i=Math.floor(t/Lo),n=t-i*Lo,r=e,o=Math.floor(r/Lo),a=r-o*Lo;return new G(i+1,n+1,o+1,a+1)}function kke(s){const e=K1(s);return Zi(e.length-1,e[e.length-1].length)}class Pu{static fromModelContentChanges(e){return e.map(i=>{const n=G.lift(i.range);return new Pu(l_(n.getStartPosition()),l_(n.getEndPosition()),kke(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${oa(this.startOffset)}...${oa(this.endOffset)}) -> ${oa(this.newLength)}`}}class Eke{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>Q7.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:Yv(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Zi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Zi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=oa(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Zi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Zi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(G_(i,e)){this.nextEditIdx++;const n=oa(i),r=oa(this.translateOldToCur(t.endOffsetBeforeObj)),o=n.lineCount-r.lineCount;this.deltaOldToNewLineCount+=o;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class Q7{static from(e){return new Q7(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=oa(t),this.endOffsetAfterObj=oa(pn(e,i)),this.offsetObj=oa(e)}}const ix=[],$o=class $o{static create(e,t){if(e<=128&&t.length===0){let i=$o.cache[e];return i||(i=new $o(e,t),$o.cache[e]=i),i}return new $o(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let n=i>>5;if(n===0){const o=1<<i|this.items;return o===this.items?this:$o.create(o,this.additionalItems)}n--;const r=this.additionalItems.slice(0);for(;r.length<n;)r.push(0);return r[n]|=1<<(i&31),$o.create(this.items,r)}merge(e){const t=this.items|e.items;if(this.additionalItems===ix&&e.additionalItems===ix)return t===this.items?this:t===e.items?e:$o.create(t,ix);const i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const r=this.additionalItems[n]||0,o=e.additionalItems[n]||0;i.push(r|o)}return $o.create(t,i)}intersects(e){if((this.items&e.items)!==0)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if((this.additionalItems[t]&e.additionalItems[t])!==0)return!0;return!1}};$o.cache=new Array(129),$o.empty=$o.create(0,ix);let zr=$o;const Nj={getKey(s){return s}};class Dke{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class X7{get length(){return this._length}constructor(e){this._length=e}}class Qv extends X7{static create(e,t,i){let n=e.length;return t&&(n=pn(n,t.length)),i&&(n=pn(n,i.length)),new Qv(n,e,t,i,t?t.missingOpeningBracketIds:zr.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,n,r){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=r}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new Qv(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(pn(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class wc extends X7{static create23(e,t,i,n=!1){let r=e.length,o=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(r=pn(r,t.length),o=o.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");r=pn(r,i.length),o=o.merge(i.missingOpeningBracketIds)}return n?new Tke(r,e.listHeight+1,e,t,i,o):new Xv(r,e.listHeight+1,e,t,i,o)}static getEmpty(){return new Nke(Nr,0,[],zr.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new $e;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const r=this.getChild(n);t=pn(t,r.length),i=i.merge(r.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let r=0;r<this.childrenLength;r++){const o=this.getChild(r);o&&(i=Math.min(i,o.computeMinIndentation(n,t)),n=pn(n,o.length))}return this.cachedMinIndentation=i,i}}class Xv extends wc{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,n,r,o){super(e,t,o),this._item1=i,this._item2=n,this._item3=r}deepClone(){return new Xv(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class Tke extends Xv{toMutable(){return new Xv(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class Kk extends wc{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,n){super(e,t,n),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new Kk(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class Nke extends Kk{toMutable(){return new Kk(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const Ike=[];class Z7 extends X7{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return Ike}deepClone(){return this}}class Uf extends Z7{get kind(){return 0}get missingOpeningBracketIds(){return zr.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=oa(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,r=xke(pn(e,this.length))+1;let o=Number.MAX_SAFE_INTEGER;for(let a=n;a<=r;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const h=Ai.visibleColumnFromColumn(c,l,t.getOptions().tabSize);o=Math.min(o,h)}return o}}class Yk extends Z7{static create(e,t,i){return new Yk(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return zr.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class Rke extends Z7{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let Jh=class{constructor(e,t,i,n,r){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=r}};class Ake{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new Mke(this.textModel,this.bracketTokens),this._offset=Nr,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Zi(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=pn(this._offset,e);const t=oa(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=pn(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class Mke{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const r=this.lineTokens,o=r.getCount();let a=null;if(this.lineTokenOffset<o){const l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<o&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=_o.getTokenType(l)===0,h=_o.containsBalancedBrackets(l),d=r.getEndOffset(this.lineTokenOffset);if(h&&c&&this.lineCharOffset<d){const g=r.getLanguageId(this.lineTokenOffset),p=this.line.substring(this.lineCharOffset,d),_=this.bracketTokens.getSingleLanguageBracketTokens(g),b=_.regExpGlobal;if(b){b.lastIndex=0;const C=b.exec(p);C&&(a=_.getToken(C[0]),a&&(this.lineCharOffset+=C.index))}}if(i+=d-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=d}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const n=Ske(e,t,this.lineIdx,this.lineCharOffset);return new Jh(n,0,-1,zr.getEmpty(),new Uf(n))}}class Oke{constructor(e,t){this.text=e,this._offset=Nr,this.idx=0;const i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,r=[];let o,a=0,l=0,c=0,h=0;const d=[];for(let _=0;_<60;_++)d.push(new Jh(Zi(0,_),0,-1,zr.getEmpty(),new Uf(Zi(0,_))));const g=[];for(let _=0;_<60;_++)g.push(new Jh(Zi(1,_),0,-1,zr.getEmpty(),new Uf(Zi(1,_))));if(n)for(n.lastIndex=0;(o=n.exec(e))!==null;){const _=o.index,b=o[0];if(b===`
`)a++,l=_+1;else{if(c!==_){let C;if(h===a){const x=_-c;if(x<d.length)C=d[x];else{const S=Zi(0,x);C=new Jh(S,0,-1,zr.getEmpty(),new Uf(S))}}else{const x=a-h,S=_-l;if(x===1&&S<g.length)C=g[S];else{const y=Zi(x,S);C=new Jh(y,0,-1,zr.getEmpty(),new Uf(y))}}r.push(C)}r.push(t.getToken(b)),c=_+b.length,h=a}}const p=e.length;if(c!==p){const _=h===a?Zi(0,p-c):Zi(a-h,p-l);r.push(new Jh(_,0,-1,zr.getEmpty(),new Uf(_)))}this.length=Zi(a,p-l),this.tokens=r}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new nme}}class J7{static createFromLanguage(e,t){function i(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}const n=new Map;for(const r of e.bracketsNew.openingBrackets){const o=Zi(0,r.bracketText.length),a=i(r),l=zr.getEmpty().add(a,Nj);n.set(r.bracketText,new Jh(o,1,a,l,Yk.create(o,r,l)))}for(const r of e.bracketsNew.closingBrackets){const o=Zi(0,r.bracketText.length);let a=zr.getEmpty();const l=r.getOpeningBrackets();for(const c of l)a=a.add(i(c),Nj);n.set(r.bracketText,new Jh(o,2,i(l[0]),a,Yk.create(o,r,a)))}return new J7(n)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>Pke(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function Pke(s){let e=pc(s);return/^[\w ]+/.test(s)&&(e=`\\b${e}`),/[\w ]+$/.test(s)&&(e=`${e}\\b`),e}class Fke{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=J7.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function Bke(s){if(s.length===0)return null;if(s.length===1)return s[0];let e=0;function t(){if(e>=s.length)return null;const o=e,a=s[o].listHeight;for(e++;e<s.length&&s[e].listHeight===a;)e++;return e-o>=2?hee(o===0&&e===s.length?s:s.slice(o,e),!1):s[o]}let i=t(),n=t();if(!n)return i;for(let o=t();o;o=t())Ij(i,n)<=Ij(n,o)?(i=BR(i,n),n=o):n=BR(n,o);return BR(i,n)}function hee(s,e=!1){if(s.length===0)return null;if(s.length===1)return s[0];let t=s.length;for(;t>3;){const i=t>>1;for(let n=0;n<i;n++){const r=n<<1;s[n]=wc.create23(s[r],s[r+1],r+3===t?s[r+2]:null,e)}t=i}return wc.create23(s[0],s[1],t>=3?s[2]:null,e)}function Ij(s,e){return Math.abs(s.listHeight-e.listHeight)}function BR(s,e){return s.listHeight===e.listHeight?wc.create23(s,e,null,!1):s.listHeight>e.listHeight?Vke(s,e):Hke(e,s)}function Vke(s,e){s=s.toMutable();let t=s;const i=[];let n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let r=i.length-1;r>=0;r--){const o=i[r];n?o.childrenLength>=3?n=wc.create23(o.unappendChild(),n,null,!1):(o.appendChildOfSameHeight(n),n=void 0):o.handleChildrenChanged()}return n?wc.create23(s,n,null,!1):s}function Hke(s,e){s=s.toMutable();let t=s;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let r=i.length-1;r>=0;r--){const o=i[r];n?o.childrenLength>=3?n=wc.create23(n,o.unprependChild(),null,!1):(o.prependChildOfSameHeight(n),n=void 0):o.handleChildrenChanged()}return n?wc.create23(n,s,null,!1):s}class Wke{constructor(e){this.lastOffset=Nr,this.nextNodes=[e],this.offsets=[Nr],this.idxs=[]}readLongestNodeAt(e,t){if(q_(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=d0(this.nextNodes);if(!i)return;const n=d0(this.offsets);if(q_(e,n))return;if(q_(n,e))if(pn(n,i.length)<=e)this.nextNodeAfterCurrent();else{const r=VR(i);r!==-1?(this.nextNodes.push(i.getChild(r)),this.offsets.push(n),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const r=VR(i);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(r)),this.offsets.push(n),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){const e=d0(this.offsets),t=d0(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=d0(this.nextNodes),n=VR(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(pn(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}}function VR(s,e=-1){for(;;){if(e++,e>=s.childrenLength)return-1;if(s.getChild(e))return e}}function d0(s){return s.length>0?s[s.length-1]:void 0}function Rj(s,e,t,i){return new zke(s,e,t,i).parseDocument()}class zke{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new Wke(i):void 0,this.positionMapper=new Eke(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(zr.getEmpty(),0);return e||(e=wc.getEmpty()),e}parseList(e,t){const i=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){const o=this.tokenizer.peek();if(!o||o.kind===2&&o.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||i.push(r)}return this.oldNodeReader?Bke(i):hee(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Gk(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!q_(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new Rke(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new Uf(i.length);const n=e.merge(i.bracketIds),r=this.parseList(n,t+1),o=this.tokenizer.peek();return o&&o.kind===2&&(o.bracketId===i.bracketId||o.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),Qv.create(i.astNode,r,o.astNode)):Qv.create(i.astNode,r,null)}default:throw new Error("unexpected")}}}function Qk(s,e){if(s.length===0)return e;if(e.length===0)return s;const t=new eh(Aj(s)),i=Aj(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function r(c){if(c===void 0){const d=t.takeWhile(g=>!0)||[];return n&&d.unshift(n),d}const h=[];for(;n&&!Gk(c);){const[d,g]=n.splitAt(c);h.push(d),c=Yv(d.lengthAfter,c),n=g??t.dequeue()}return Gk(c)||h.push(new ad(!1,c,c)),h}const o=[];function a(c,h,d){if(o.length>0&&uee(o[o.length-1].endOffset,c)){const g=o[o.length-1];o[o.length-1]=new Pu(g.startOffset,h,pn(g.newLength,d))}else o.push({startOffset:c,endOffset:h,newLength:d})}let l=Nr;for(const c of i){const h=r(c.lengthBefore);if(c.modified){const d=Lke(h,p=>p.lengthBefore),g=pn(l,d);a(l,g,c.lengthAfter),l=g}else for(const d of h){const g=l;l=pn(l,d.lengthBefore),d.modified&&a(g,l,d.lengthAfter)}}return o}class ad{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=Yv(e,this.lengthAfter);return uee(t,Nr)?[this,void 0]:this.modified?[new ad(this.modified,this.lengthBefore,e),new ad(this.modified,Nr,t)]:[new ad(this.modified,e,e),new ad(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${oa(this.lengthBefore)} -> ${oa(this.lengthAfter)}`}}function Aj(s){const e=[];let t=Nr;for(const i of s){const n=Yv(t,i.startOffset);Gk(n)||e.push(new ad(!1,n,n));const r=Yv(i.startOffset,i.endOffset);e.push(new ad(!0,r,i.newLength)),t=i.endOffset}return e}class Uke extends le{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new Z,this.denseKeyProvider=new Dke,this.brackets=new Fke(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),n=new Oke(this.textModel.getValue(),i);this.initialAstWithoutTokens=Rj(n,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Pu(Zi(i.fromLineNumber-1,0),Zi(i.toLineNumber,0),Zi(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Pu.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=Qk(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=Qk(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const n=t,r=new Ake(this.textModel,this.brackets);return Rj(r,e,n,i)}getBracketsInRange(e,t){this.flushQueue();const i=Zi(e.startLineNumber-1,e.startColumn-1),n=Zi(e.endLineNumber-1,e.endColumn-1);return new Cg(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens;j5(o,Nr,o.length,i,n,r,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=l_(e.getStartPosition()),n=l_(e.getEndPosition());return new Cg(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens,a=new jke(r,t,this.textModel);$5(o,Nr,o.length,i,n,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return fee(t,Nr,t.length,l_(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return dee(t,Nr,t.length,l_(e))}}function dee(s,e,t,i){if(s.kind===4||s.kind===2){const n=[];for(const r of s.children)t=pn(e,r.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=n.length-1;r>=0;r--){const{nodeOffsetStart:o,nodeOffsetEnd:a}=n[r];if(q_(o,i)){const l=dee(s.children[r],o,a,i);if(l)return l}}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=Tg(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function fee(s,e,t,i){if(s.kind===4||s.kind===2){for(const n of s.children){if(t=pn(e,n.length),q_(i,t)){const r=fee(n,e,t,i);if(r)return r}e=t}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=Tg(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function j5(s,e,t,i,n,r,o,a,l,c,h=!1){if(o>200)return!0;e:for(;;)switch(s.kind){case 4:{const d=s.childrenLength;for(let g=0;g<d;g++){const p=s.getChild(g);if(p){if(t=pn(e,p.length),G_(e,n)&&R0(t,i)){if(R0(t,n)){s=p;continue e}if(!j5(p,e,t,i,n,r,o,0,l,c))return!1}e=t}}return!0}case 2:{const d=!c||!s.closingBracket||s.closingBracket.bracketInfo.closesColorized(s.openingBracket.bracketInfo);let g=0;if(l){let _=l.get(s.openingBracket.text);_===void 0&&(_=0),g=_,d&&(_++,l.set(s.openingBracket.text,_))}const p=s.childrenLength;for(let _=0;_<p;_++){const b=s.getChild(_);if(b){if(t=pn(e,b.length),G_(e,n)&&R0(t,i)){if(R0(t,n)&&b.kind!==1){s=b,d?(o++,a=g+1):a=g;continue e}if((d||b.kind!==1||!s.closingBracket)&&!j5(b,e,t,i,n,r,d?o+1:o,d?g+1:g,l,c,!s.closingBracket))return!1}e=t}}return l==null||l.set(s.openingBracket.text,g),!0}case 3:{const d=Tg(e,t);return r(new Tj(d,o-1,0,!0))}case 1:{const d=Tg(e,t);return r(new Tj(d,o-1,a-1,h))}case 0:return!0}}class jke{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function $5(s,e,t,i,n,r,o,a){var c;if(o>200)return!0;let l=!0;if(s.kind===2){let h=0;if(a){let p=a.get(s.openingBracket.text);p===void 0&&(p=0),h=p,p++,a.set(s.openingBracket.text,p)}const d=pn(e,s.openingBracket.length);let g=-1;if(r.includeMinIndentation&&(g=s.computeMinIndentation(e,r.textModel)),l=r.push(new yke(Tg(e,t),Tg(e,d),s.closingBracket?Tg(pn(d,((c=s.child)==null?void 0:c.length)||Nr),t):void 0,o,h,s,g)),e=d,l&&s.child){const p=s.child;if(t=pn(e,p.length),G_(e,n)&&R0(t,i)&&(l=$5(p,e,t,i,n,r,o+1,a),!l))return!1}a==null||a.set(s.openingBracket.text,h)}else{let h=e;for(const d of s.children){const g=h;if(h=pn(h,d.length),G_(g,n)&&G_(i,h)&&(l=$5(d,g,h,i,n,r,o,a),!l))return!1}}return l}class $ke extends le{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new Yn),this.onDidChangeEmitter=new Z,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(e){var t;(!e.languageId||(t=this.bracketPairsTree.value)!=null&&t.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;(e=this.bracketPairsTree.value)==null||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new Pe;this.bracketPairsTree.value=qke(e.add(new Uke(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!1))||Cg.empty}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!0))||Cg.empty}getBracketsInRange(e,t=!1){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)==null?void 0:i.object.getBracketsInRange(e,t))||Cg.empty}findMatchingBracketUp(e,t,i){const n=this.textModel.validatePosition(t),r=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column);if(this.canBuildAST){const o=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew.getClosingBracketInfo(e);if(!o)return null;const a=this.getBracketPairsInRange(G.fromPositions(t,t)).findLast(l=>o.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const o=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(r).brackets;if(!a)return null;const l=a.textIsBracket[o];return l?nx(this._findMatchingBracketUp(l,n,HR(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(G.fromPositions(e,e)).filter(n=>n.closingBracketRange!==void 0&&(n.openingBracketRange.containsPosition(e)||n.closingBracketRange.containsPosition(e))).findLastMaxBy(Do(n=>n.openingBracketRange.containsPosition(e)?n.openingBracketRange:n.closingBracketRange,G.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=HR(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,n){const r=t.getCount(),o=t.getLanguageId(n);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=n-1;c>=0;c--){const h=t.getEndOffset(c);if(h<=a)break;if(Pl(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){a=h;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=n+1;c<r;c++){const h=t.getStartOffset(c);if(h>=l)break;if(Pl(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){l=h;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.tokenization.getLineTokens(i),r=this.textModel.getLineContent(i),o=n.findTokenIndexAtOffset(e.column-1);if(o<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(o)).brackets;if(a&&!Pl(n.getStandardTokenType(o))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,n,a,o),h=null;for(;;){const d=ya.findNextBracketInRange(a.forwardRegex,i,r,l,c);if(!d)break;if(d.startColumn<=e.column&&e.column<=d.endColumn){const g=r.substring(d.startColumn-1,d.endColumn-1).toLowerCase(),p=this._matchFoundBracket(d,a.textIsBracket[g],a.textIsOpenBracket[g],t);if(p){if(p instanceof Su)return null;h=p}}l=d.endColumn-1}if(h)return h}if(o>0&&n.getStartOffset(o)===e.column-1){const l=o-1,c=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(l)).brackets;if(c&&!Pl(n.getStandardTokenType(l))){const{searchStartOffset:h,searchEndOffset:d}=this._establishBracketSearchOffsets(e,n,c,l),g=ya.findPrevBracketInRange(c.reversedRegex,i,r,h,d);if(g&&g.startColumn<=e.column&&e.column<=g.endColumn){const p=r.substring(g.startColumn-1,g.endColumn-1).toLowerCase(),_=this._matchFoundBracket(g,c.textIsBracket[p],c.textIsOpenBracket[p],t);if(_)return _ instanceof Su?null:_}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const r=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return r?r instanceof Su?r:[e,r]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,r=e.reversedRegex;let o=-1,a=0;const l=(c,h,d,g)=>{for(;;){if(i&&++a%100===0&&!i())return Su.INSTANCE;const p=ya.findPrevBracketInRange(r,c,h,d,g);if(!p)break;const _=h.substring(p.startColumn-1,p.endColumn-1).toLowerCase();if(e.isOpen(_)?o++:e.isClose(_)&&o--,o===0)return p;g=p.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const h=this.textModel.tokenization.getLineTokens(c),d=h.getCount(),g=this.textModel.getLineContent(c);let p=d-1,_=g.length,b=g.length;c===t.lineNumber&&(p=h.findTokenIndexAtOffset(t.column-1),_=t.column-1,b=t.column-1);let C=!0;for(;p>=0;p--){const x=h.getLanguageId(p)===n&&!Pl(h.getStandardTokenType(p));if(x)C?_=h.getStartOffset(p):(_=h.getStartOffset(p),b=h.getEndOffset(p));else if(C&&_!==b){const S=l(c,g,_,b);if(S)return S}C=x}if(C&&_!==b){const x=l(c,g,_,b);if(x)return x}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,r=e.forwardRegex;let o=1,a=0;const l=(h,d,g,p)=>{for(;;){if(i&&++a%100===0&&!i())return Su.INSTANCE;const _=ya.findNextBracketInRange(r,h,d,g,p);if(!_)break;const b=d.substring(_.startColumn-1,_.endColumn-1).toLowerCase();if(e.isOpen(b)?o++:e.isClose(b)&&o--,o===0)return _;g=_.endColumn-1}return null},c=this.textModel.getLineCount();for(let h=t.lineNumber;h<=c;h++){const d=this.textModel.tokenization.getLineTokens(h),g=d.getCount(),p=this.textModel.getLineContent(h);let _=0,b=0,C=0;h===t.lineNumber&&(_=d.findTokenIndexAtOffset(t.column-1),b=t.column-1,C=t.column-1);let x=!0;for(;_<g;_++){const S=d.getLanguageId(_)===n&&!Pl(d.getStandardTokenType(_));if(S)x||(b=d.getStartOffset(_)),C=d.getEndOffset(_);else if(x&&b!==C){const y=l(h,p,b,C);if(y)return y}x=S}if(x&&b!==C){const S=l(h,p,b,C);if(S)return S}}return null}findPrevBracket(e){var o;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((o=this.bracketPairsTree.value)==null?void 0:o.object.getFirstBracketBefore(t))||null;let i=null,n=null,r=null;for(let a=t.lineNumber;a>=1;a--){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),h=this.textModel.getLineContent(a);let d=c-1,g=h.length,p=h.length;if(a===t.lineNumber){d=l.findTokenIndexAtOffset(t.column-1),g=t.column-1,p=t.column-1;const b=l.getLanguageId(d);i!==b&&(i=b,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let _=!0;for(;d>=0;d--){const b=l.getLanguageId(d);if(i!==b){if(n&&r&&_&&g!==p){const x=ya.findPrevBracketInRange(n.reversedRegex,a,h,g,p);if(x)return this._toFoundBracket(r,x);_=!1}i=b,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}const C=!!n&&!Pl(l.getStandardTokenType(d));if(C)_?g=l.getStartOffset(d):(g=l.getStartOffset(d),p=l.getEndOffset(d));else if(r&&n&&_&&g!==p){const x=ya.findPrevBracketInRange(n.reversedRegex,a,h,g,p);if(x)return this._toFoundBracket(r,x)}_=C}if(r&&n&&_&&g!==p){const b=ya.findPrevBracketInRange(n.reversedRegex,a,h,g,p);if(b)return this._toFoundBracket(r,b)}}return null}findNextBracket(e){var a;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((a=this.bracketPairsTree.value)==null?void 0:a.object.getFirstBracketAfter(t))||null;const i=this.textModel.getLineCount();let n=null,r=null,o=null;for(let l=t.lineNumber;l<=i;l++){const c=this.textModel.tokenization.getLineTokens(l),h=c.getCount(),d=this.textModel.getLineContent(l);let g=0,p=0,_=0;if(l===t.lineNumber){g=c.findTokenIndexAtOffset(t.column-1),p=t.column-1,_=t.column-1;const C=c.getLanguageId(g);n!==C&&(n=C,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let b=!0;for(;g<h;g++){const C=c.getLanguageId(g);if(n!==C){if(o&&r&&b&&p!==_){const S=ya.findNextBracketInRange(r.forwardRegex,l,d,p,_);if(S)return this._toFoundBracket(o,S);b=!1}n=C,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const x=!!r&&!Pl(c.getStandardTokenType(g));if(x)b||(p=c.getStartOffset(g)),_=c.getEndOffset(g);else if(o&&r&&b&&p!==_){const S=ya.findNextBracketInRange(r.forwardRegex,l,d,p,_);if(S)return this._toFoundBracket(o,S)}b=x}if(o&&r&&b&&p!==_){const C=ya.findNextBracketInRange(r.forwardRegex,l,d,p,_);if(C)return this._toFoundBracket(o,C)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const p=G.fromPositions(i),_=this.getBracketPairsInRange(G.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(p));return _?[_.openingBracketRange,_.closingBracketRange]:null}const n=HR(t),r=this.textModel.getLineCount(),o=new Map;let a=[];const l=(p,_)=>{if(!o.has(p)){const b=[];for(let C=0,x=_?_.brackets.length:0;C<x;C++)b[C]=0;o.set(p,b)}a=o.get(p)};let c=0;const h=(p,_,b,C,x)=>{for(;;){if(n&&++c%100===0&&!n())return Su.INSTANCE;const S=ya.findNextBracketInRange(p.forwardRegex,_,b,C,x);if(!S)break;const y=b.substring(S.startColumn-1,S.endColumn-1).toLowerCase(),k=p.textIsBracket[y];if(k&&(k.isOpen(y)?a[k.index]++:k.isClose(y)&&a[k.index]--,a[k.index]===-1))return this._matchFoundBracket(S,k,!1,n);C=S.endColumn-1}return null};let d=null,g=null;for(let p=i.lineNumber;p<=r;p++){const _=this.textModel.tokenization.getLineTokens(p),b=_.getCount(),C=this.textModel.getLineContent(p);let x=0,S=0,y=0;if(p===i.lineNumber){x=_.findTokenIndexAtOffset(i.column-1),S=i.column-1,y=i.column-1;const D=_.getLanguageId(x);d!==D&&(d=D,g=this.languageConfigurationService.getLanguageConfiguration(d).brackets,l(d,g))}let k=!0;for(;x<b;x++){const D=_.getLanguageId(x);if(d!==D){if(g&&k&&S!==y){const N=h(g,p,C,S,y);if(N)return nx(N);k=!1}d=D,g=this.languageConfigurationService.getLanguageConfiguration(d).brackets,l(d,g)}const R=!!g&&!Pl(_.getStandardTokenType(x));if(R)k||(S=_.getStartOffset(x)),y=_.getEndOffset(x);else if(g&&k&&S!==y){const N=h(g,p,C,S,y);if(N)return nx(N)}k=R}if(g&&k&&S!==y){const D=h(g,p,C,S,y);if(D)return nx(D)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.getBracketInfo(i);return n?{range:t,bracketInfo:n}:null}}function qke(s,e){return{object:s,dispose:()=>e==null?void 0:e.dispose()}}function HR(s){if(typeof s>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=s}}const dE=class dE{constructor(){this._searchCanceledBrand=void 0}};dE.INSTANCE=new dE;let Su=dE;function nx(s){return s instanceof Su?null:s}class Gke extends le{constructor(e){super(),this.textModel=e,this.colorProvider=new gee,this.onDidChangeEmitter=new Z,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,n){return n?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(o=>({id:`bracket${o.range.toString()}-${o.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(o,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:o.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new G(1,1,this.textModel.getLineCount(),1),e,t):[]}}class gee{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}lh((s,e)=>{const t=[WJ,zJ,UJ,jJ,$J,qJ],i=new gee;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${s.getColor(lxe)}; }`);const n=t.map(r=>s.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){const o=n[r%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(r)} { color: ${o}; }`)}});function sx(s){return s.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class ps{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${sx(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${sx(this.oldText)}")`:`(replace@${this.oldPosition} "${sx(this.oldText)}" with "${sx(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;el(e,n,i),i+=4;for(let r=0;r<n;r++)V_e(e,t.charCodeAt(r),i),i+=2;return i}static _readString(e,t){const i=Ja(e,t);return t+=4,qbe(e,t,i)}writeSize(){return 8+ps._writeStringSize(this.oldText)+ps._writeStringSize(this.newText)}write(e,t){return el(e,this.oldPosition,t),t+=4,el(e,this.newPosition,t),t+=4,t=ps._writeString(e,this.oldText,t),t=ps._writeString(e,this.newText,t),t}static read(e,t,i){const n=Ja(e,t);t+=4;const r=Ja(e,t);t+=4;const o=ps._readString(e,t);t+=ps._writeStringSize(o);const a=ps._readString(e,t);return t+=ps._writeStringSize(a),i.push(new ps(n,o,r,a)),t}}function Kke(s,e){return s===null||s.length===0?e:new Vl(s,e).compress()}class Vl{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[c,h]=Vl._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(c),n=h;continue}if(i.newPosition<n.oldPosition){const[c,h]=Vl._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(c),i=h;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[c,h]=Vl._splitPrev(i,n.oldLength);a=c,l=n,i=h,n=this._getCurr(++t)}else{const[c,h]=Vl._splitCurr(n,i.newLength);a=i,l=c,i=this._getPrev(++e),n=h}this._result[this._resultLen++]=new ps(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const r=Vl._merge(this._result);return Vl._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=Vl._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=Vl._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new ps(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new ps(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new ps(e.oldPosition,e.oldText,e.newPosition,i),new ps(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new ps(e.oldPosition,i,e.newPosition,e.newText),new ps(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,n=e[0];for(let r=1;r<e.length;r++){const o=e[r];n.oldEnd===o.oldPosition?n=new ps(n.oldPosition,n.oldText+o.oldText,n.newPosition,n.newText+o.newText):(t[i++]=n,n=o)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const r=e[n];r.oldText!==r.newText&&(t[i++]=r)}return t}}const Yke=Symbol("TextModelEditSource");class mee{constructor(e,t){this.metadata=e}toString(){return`${this.metadata.source}`}getType(){const e=this.metadata;switch(e.source){case"cursor":return e.kind;case"inlineCompletionAccept":return e.source+(e.$nes?":nes":"");case"unknown":return e.name||"unknown";default:return e.source}}toKey(e,t={}){const i=this.metadata;return Object.entries(i).filter(([r,o])=>{const a=t[r];return a!==void 0?a:(r.match(/\$/g)||[]).length<=e&&o!==void 0&&o!==null&&o!==""}).map(([r,o])=>`${r}:${o}`).join("-")}}function yr(s){return new mee(s,Yke)}const Ko={unknown(s){return yr({source:"unknown",name:s.name})},rename:()=>yr({source:"rename"}),chatApplyEdits(s){var e,t;return yr({source:"Chat.applyEdits",$modelId:Mj(s.modelId),$extensionId:(e=s.extensionId)==null?void 0:e.extensionId,$extensionVersion:(t=s.extensionId)==null?void 0:t.version,$$languageId:s.languageId,$$sessionId:s.sessionId,$$requestId:s.requestId,$$mode:s.mode,$$codeBlockSuggestionId:s.codeBlockSuggestionId})},chatUndoEdits:()=>yr({source:"Chat.undoEdits"}),chatReset:()=>yr({source:"Chat.reset"}),inlineCompletionAccept(s){return yr({source:"inlineCompletionAccept",$nes:s.nes,...rx(s.providerId),$$requestUuid:s.requestUuid,$$languageId:s.languageId})},inlineCompletionPartialAccept(s){return yr({source:"inlineCompletionPartialAccept",type:s.type,$nes:s.nes,...rx(s.providerId),$$requestUuid:s.requestUuid,$$languageId:s.languageId})},inlineChatApplyEdit(s){var e,t;return yr({source:"inlineChat.applyEdits",$modelId:Mj(s.modelId),$extensionId:(e=s.extensionId)==null?void 0:e.extensionId,$extensionVersion:(t=s.extensionId)==null?void 0:t.version,$$sessionId:s.sessionId,$$requestId:s.requestId,$$languageId:s.languageId})},reloadFromDisk:()=>yr({source:"reloadFromDisk"}),cursor(s){return yr({source:"cursor",kind:s.kind,detailedSource:s.detailedSource})},setValue:()=>yr({source:"setValue"}),eolChange:()=>yr({source:"eolChange"}),applyEdits:()=>yr({source:"applyEdits"}),snippet:()=>yr({source:"snippet"}),suggest:s=>yr({source:"suggest",...rx(s.providerId)}),codeAction:s=>yr({source:"codeAction",$kind:s.kind,...rx(s.providerId)})};function rx(s){return s?{$extensionId:s.extensionId,$extensionVersion:s.extensionVersion,$providerId:s.providerId}:{}}function Mj(s){if(s!==void 0)return s.replaceAll("/","|")}class Xk{static fromText(e){const t=Yr.ofText(e).lineCount,i=e.length;return new Xk(t,0,i,0)}static tryCreate(e,t,i,n){if(!(e===void 0||t===void 0||i===void 0||n===void 0))return new Xk(e,t,i,n)}constructor(e,t,i,n){this.linesAdded=e,this.linesRemoved=t,this.charsAdded=i,this.charsRemoved=n}}var Oj;(function(s){function e(t){const i=t?t("sgt"):jye("sgt");return i}s.newId=e})(Oj||(Oj={}));function Pp(s){return s.toString()}class Wn{static create(e,t){const i=e.getAlternativeVersionId(),n=q5(e);return new Wn(i,i,n,n,t,t,[])}constructor(e,t,i,n,r,o,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=r,this.afterCursorState=o,this.changes=a}append(e,t,i,n,r){t.length>0&&(this.changes=Kke(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,i){if(el(e,t?t.length:0,i),i+=4,t)for(const n of t)el(e,n.selectionStartLineNumber,i),i+=4,el(e,n.selectionStartColumn,i),i+=4,el(e,n.positionLineNumber,i),i+=4,el(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=Ja(e,t);t+=4;for(let r=0;r<n;r++){const o=Ja(e,t);t+=4;const a=Ja(e,t);t+=4;const l=Ja(e,t);t+=4;const c=Ja(e,t);t+=4,i.push(new Lt(o,a,l,c))}return t}serialize(){let e=10+Wn._writeSelectionsSize(this.beforeCursorState)+Wn._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;el(t,this.beforeVersionId,i),i+=4,el(t,this.afterVersionId,i),i+=4,bz(t,this.beforeEOL,i),i+=1,bz(t,this.afterEOL,i),i+=1,i=Wn._writeSelections(t,this.beforeCursorState,i),i=Wn._writeSelections(t,this.afterCursorState,i),el(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=Ja(t,i);i+=4;const r=Ja(t,i);i+=4;const o=_z(t,i);i+=1;const a=_z(t,i);i+=1;const l=[];i=Wn._readSelections(t,i,l);const c=[];i=Wn._readSelections(t,i,c);const h=Ja(t,i);i+=4;const d=[];for(let g=0;g<h;g++)i=ps.read(t,i,d);return new Wn(n,r,o,a,l,c,d)}}class pee{get type(){return 0}get resource(){return mt.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,n){this.label=e,this.code=t,this.model=i,this._data=Wn.create(i,n)}toString(){return(this._data instanceof Wn?this._data:Wn.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(mt.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Wn}append(e,t,i,n,r){this._data instanceof Wn&&this._data.append(e,t,i,n,r)}close(){this._data instanceof Wn&&(this._data=this._data.serialize())}open(){this._data instanceof Wn||(this._data=Wn.deserialize(this._data))}undo(){if(mt.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Wn&&(this._data=this._data.serialize());const e=Wn.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(mt.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Wn&&(this._data=this._data.serialize());const e=Wn.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Wn&&(this._data=this._data.serialize()),this._data.byteLength+168}}class Qke{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const r=Pp(n.resource);this._editStackElementsMap.set(r,n)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=Pp(e);return this._editStackElementsMap.has(t)}setModel(e){const t=Pp(mt.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=Pp(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,r){const o=Pp(e.uri);this._editStackElementsMap.get(o).append(e,t,i,n,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=Pp(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${m7(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function q5(s){return s.getEOL()===`
`?0:1}function xu(s){return s?s instanceof pee||s instanceof Qke:!1}class e8{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);xu(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);xu(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(xu(i)&&i.canAppend(this._model))return i;const n=new pee(v(785,"Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],q5(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n,r=Ko.unknown({name:"pushEditOperation"})){const o=this._getOrCreateEditStackElement(e,n),a=this._model.applyEdits(t,!0,r),l=e8._computeCursorState(i,a),c=a.map((h,d)=>({index:d,textChange:h.textChange}));return c.sort((h,d)=>h.textChange.oldPosition===d.textChange.oldPosition?h.index-d.index:h.textChange.oldPosition-d.textChange.oldPosition),o.append(this._model,c.map(h=>h.textChange),q5(this._model),this._model.getAlternativeVersionId(),l),l}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return $t(i),null}}}class Xke{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function Zke(s,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<i;r++){const g=s.charCodeAt(r),p=t.charCodeAt(r);if(g!==p)break}let o=0,a=0;for(let g=r;g<e;g++)s.charCodeAt(g)===32?o++:a++;let l=0,c=0;for(let g=r;g<i;g++)t.charCodeAt(g)===32?l++:c++;if(o>0&&a>0||l>0&&c>0)return;const h=Math.abs(a-c),d=Math.abs(o-l);if(h===0){n.spacesDiff=d,d>0&&0<=l-1&&l-1<s.length&&l<t.length&&t.charCodeAt(l)!==32&&s.charCodeAt(l-1)===32&&s.charCodeAt(s.length-1)===44&&(n.looksLikeAlignment=!0);return}if(d%h===0){n.spacesDiff=d/h;return}}function Pj(s,e,t){const i=Math.min(s.getLineCount(),1e4);let n=0,r=0,o="",a=0;const l=[2,4,6,8,3,5,7],c=8,h=[0,0,0,0,0,0,0,0,0],d=new Xke;for(let _=1;_<=i;_++){const b=s.getLineLength(_),C=s.getLineContent(_),x=b<=65536;let S=!1,y=0,k=0,D=0;for(let N=0,A=b;N<A;N++){const M=x?C.charCodeAt(N):s.getLineCharCode(_,N);if(M===9)D++;else if(M===32)k++;else{S=!0,y=N;break}}if(!S||(D>0?n++:k>1&&r++,Zke(o,a,C,y,d),d.looksLikeAlignment&&!(t&&e===d.spacesDiff)))continue;const R=d.spacesDiff;R<=c&&h[R]++,o=C,a=y}let g=t;n!==r&&(g=n<r);let p=e;if(g){let _=g?0:.1*i;l.forEach(b=>{const C=h[b];C>_&&(_=C,p=b)}),p===4&&h[4]>0&&h[2]>0&&h[2]>=h[4]/2&&(p=2)}return{insertSpaces:g,tabSize:p}}function Sr(s){return(s.metadata&1)>>>0}function pi(s,e){s.metadata=s.metadata&254|e<<0}function Cs(s){return(s.metadata&2)>>>1===1}function fi(s,e){s.metadata=s.metadata&253|(e?1:0)<<1}function _ee(s){return(s.metadata&4)>>>2===1}function Fj(s,e){s.metadata=s.metadata&251|(e?1:0)<<2}function bee(s){return(s.metadata&64)>>>6===1}function Bj(s,e){s.metadata=s.metadata&191|(e?1:0)<<6}function wee(s){return(s.metadata&128)>>>7===1}function Vj(s,e){s.metadata=s.metadata&127|(e?1:0)<<7}function Jke(s){return(s.metadata&24)>>>3}function Hj(s,e){s.metadata=s.metadata&231|e<<3}function e2e(s){return(s.metadata&32)>>>5===1}function Wj(s,e){s.metadata=s.metadata&223|(e?1:0)<<5}class vee{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,pi(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,Fj(this,!1),Bj(this,!1),Hj(this,1),Wj(this,!1),Vj(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,fi(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;Fj(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),Bj(this,this.options.glyphMarginClassName!==null),Hj(this,this.options.stickiness),Wj(this,this.options.collapseOnReplaceEdit),Vj(this,this.options.affectsFont??!1)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const ut=new vee(null,0,0);ut.parent=ut;ut.left=ut;ut.right=ut;pi(ut,0);class WR{constructor(){this.root=ut,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,r,o,a){return this.root===ut?[]:l2e(this,e,t,i,n,r,o,a)}search(e,t,i,n,r){return this.root===ut?[]:a2e(this,e,t,i,n,r)}collectNodesFromOwner(e){return r2e(this,e)}collectNodesPostOrder(){return o2e(this)}insert(e){zj(this,e),this._normalizeDeltaIfNecessary()}delete(e){Uj(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const r=i.start+n,o=i.end+n;i.setCachedOffsets(r,o,t)}acceptReplace(e,t,i,n){const r=n2e(this,e,e+t);for(let o=0,a=r.length;o<a;o++){const l=r[o];Uj(this,l)}this._normalizeDeltaIfNecessary(),s2e(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let o=0,a=r.length;o<a;o++){const l=r[o];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,i2e(l,e,e+t,i,n),l.maxEnd=l.end,zj(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,t2e(this))}}function t2e(s){let e=s.root,t=0;for(;e!==ut;){if(e.left!==ut&&!Cs(e.left)){e=e.left;continue}if(e.right!==ut&&!Cs(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Pd(e),fi(e,!0),fi(e.left,!1),fi(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}fi(s.root,!1)}function Fp(s,e,t,i){return s<t?!0:s>t||i===1?!1:i===2?!0:e}function i2e(s,e,t,i,n){const r=Jke(s),o=r===0||r===2,a=r===1||r===2,l=t-e,c=i,h=Math.min(l,c),d=s.start;let g=!1;const p=s.end;let _=!1;e<=d&&p<=t&&e2e(s)&&(s.start=e,g=!0,s.end=e,_=!0);{const C=n?1:l>0?2:0;!g&&Fp(d,o,e,C)&&(g=!0),!_&&Fp(p,a,e,C)&&(_=!0)}if(h>0&&!n){const C=l>c?2:0;!g&&Fp(d,o,e+h,C)&&(g=!0),!_&&Fp(p,a,e+h,C)&&(_=!0)}{const C=n?1:0;!g&&Fp(d,o,t,C)&&(s.start=e+c,g=!0),!_&&Fp(p,a,t,C)&&(s.end=e+c,_=!0)}const b=c-l;g||(s.start=Math.max(0,d+b)),_||(s.end=Math.max(0,p+b)),s.start>s.end&&(s.end=s.start)}function n2e(s,e,t){let i=s.root,n=0,r=0,o=0,a=0;const l=[];let c=0;for(;i!==ut;){if(Cs(i)){fi(i.left,!1),fi(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!Cs(i.left)){if(r=n+i.maxEnd,r<e){fi(i,!0);continue}if(i.left!==ut){i=i.left;continue}}if(o=n+i.start,o>t){fi(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(o,a,0),l[c++]=i),fi(i,!0),i.right!==ut&&!Cs(i.right)){n+=i.delta,i=i.right;continue}}return fi(s.root,!1),l}function s2e(s,e,t,i){let n=s.root,r=0,o=0,a=0;const l=i-(t-e);for(;n!==ut;){if(Cs(n)){fi(n.left,!1),fi(n.right,!1),n===n.parent.right&&(r-=n.parent.delta),Pd(n),n=n.parent;continue}if(!Cs(n.left)){if(o=r+n.maxEnd,o<e){fi(n,!0);continue}if(n.left!==ut){n=n.left;continue}}if(a=r+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(s.requestNormalizeDelta=!0),fi(n,!0);continue}if(fi(n,!0),n.right!==ut&&!Cs(n.right)){r+=n.delta,n=n.right;continue}}fi(s.root,!1)}function r2e(s,e){let t=s.root;const i=[];let n=0;for(;t!==ut;){if(Cs(t)){fi(t.left,!1),fi(t.right,!1),t=t.parent;continue}if(t.left!==ut&&!Cs(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),fi(t,!0),t.right!==ut&&!Cs(t.right)){t=t.right;continue}}return fi(s.root,!1),i}function o2e(s){let e=s.root;const t=[];let i=0;for(;e!==ut;){if(Cs(e)){fi(e.left,!1),fi(e.right,!1),e=e.parent;continue}if(e.left!==ut&&!Cs(e.left)){e=e.left;continue}if(e.right!==ut&&!Cs(e.right)){e=e.right;continue}t[i++]=e,fi(e,!0)}return fi(s.root,!1),t}function a2e(s,e,t,i,n,r){let o=s.root,a=0,l=0,c=0;const h=[];let d=0;for(;o!==ut;){if(Cs(o)){fi(o.left,!1),fi(o.right,!1),o===o.parent.right&&(a-=o.parent.delta),o=o.parent;continue}if(o.left!==ut&&!Cs(o.left)){o=o.left;continue}l=a+o.start,c=a+o.end,o.setCachedOffsets(l,c,n);let g=!0;if(e&&o.ownerId&&o.ownerId!==e&&(g=!1),t&&_ee(o)&&(g=!1),i&&wee(o)&&(g=!1),r&&!bee(o)&&(g=!1),g&&(h[d++]=o),fi(o,!0),o.right!==ut&&!Cs(o.right)){a+=o.delta,o=o.right;continue}}return fi(s.root,!1),h}function l2e(s,e,t,i,n,r,o,a){let l=s.root,c=0,h=0,d=0,g=0;const p=[];let _=0;for(;l!==ut;){if(Cs(l)){fi(l.left,!1),fi(l.right,!1),l===l.parent.right&&(c-=l.parent.delta),l=l.parent;continue}if(!Cs(l.left)){if(h=c+l.maxEnd,h<e){fi(l,!0);continue}if(l.left!==ut){l=l.left;continue}}if(d=c+l.start,d>t){fi(l,!0);continue}if(g=c+l.end,g>=e){l.setCachedOffsets(d,g,o);let b=!0;i&&l.ownerId&&l.ownerId!==i&&(b=!1),n&&_ee(l)&&(b=!1),r&&wee(l)&&(b=!1),a&&!bee(l)&&(b=!1),b&&(p[_++]=l)}if(fi(l,!0),l.right!==ut&&!Cs(l.right)){c+=l.delta,l=l.right;continue}}return fi(s.root,!1),p}function zj(s,e){if(s.root===ut)return e.parent=ut,e.left=ut,e.right=ut,pi(e,0),s.root=e,s.root;c2e(s,e),zh(e.parent);let t=e;for(;t!==s.root&&Sr(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;Sr(i)===1?(pi(t.parent,0),pi(i,0),pi(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,cw(s,t)),pi(t.parent,0),pi(t.parent.parent,1),uw(s,t.parent.parent))}else{const i=t.parent.parent.left;Sr(i)===1?(pi(t.parent,0),pi(i,0),pi(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,uw(s,t)),pi(t.parent,0),pi(t.parent.parent,1),cw(s,t.parent.parent))}return pi(s.root,0),e}function c2e(s,e){let t=0,i=s.root;const n=e.start,r=e.end;for(;;)if(h2e(n,r,i.start+t,i.end+t)<0)if(i.left===ut){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===ut){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=ut,e.right=ut,pi(e,1)}function Uj(s,e){let t,i;if(e.left===ut?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===ut?(t=e.left,i=e):(i=u2e(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(s.requestNormalizeDelta=!0)),i===s.root){s.root=t,pi(t,0),e.detach(),zR(),Pd(t),s.root.parent=ut;return}const n=Sr(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,pi(i,Sr(e)),e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==ut&&(i.left.parent=i),i.right!==ut&&(i.right.parent=i)),e.detach(),n){zh(t.parent),i!==e&&(zh(i),zh(i.parent)),zR();return}zh(t),zh(t.parent),i!==e&&(zh(i),zh(i.parent));let r;for(;t!==s.root&&Sr(t)===0;)t===t.parent.left?(r=t.parent.right,Sr(r)===1&&(pi(r,0),pi(t.parent,1),cw(s,t.parent),r=t.parent.right),Sr(r.left)===0&&Sr(r.right)===0?(pi(r,1),t=t.parent):(Sr(r.right)===0&&(pi(r.left,0),pi(r,1),uw(s,r),r=t.parent.right),pi(r,Sr(t.parent)),pi(t.parent,0),pi(r.right,0),cw(s,t.parent),t=s.root)):(r=t.parent.left,Sr(r)===1&&(pi(r,0),pi(t.parent,1),uw(s,t.parent),r=t.parent.left),Sr(r.left)===0&&Sr(r.right)===0?(pi(r,1),t=t.parent):(Sr(r.left)===0&&(pi(r.right,0),pi(r,1),cw(s,r),r=t.parent.left),pi(r,Sr(t.parent)),pi(t.parent,0),pi(r.left,0),uw(s,t.parent),t=s.root));pi(t,0),zR()}function u2e(s){for(;s.left!==ut;)s=s.left;return s}function zR(){ut.parent=ut,ut.delta=0,ut.start=0,ut.end=0}function cw(s,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==ut&&(t.left.parent=e),t.parent=e.parent,e.parent===ut?s.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Pd(e),Pd(t)}function uw(s,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(s.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==ut&&(t.right.parent=e),t.parent=e.parent,e.parent===ut?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Pd(e),Pd(t)}function Cee(s){let e=s.end;if(s.left!==ut){const t=s.left.maxEnd;t>e&&(e=t)}if(s.right!==ut){const t=s.right.maxEnd+s.delta;t>e&&(e=t)}return e}function Pd(s){s.maxEnd=Cee(s)}function zh(s){for(;s!==ut;){const e=Cee(s);if(s.maxEnd===e)return;s.maxEnd=e,s=s.parent}}function h2e(s,e,t,i){return s===t?e-i:s-t}class G5{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==et)return t8(this.right);let e=this;for(;e.parent!==et&&e.parent.left!==e;)e=e.parent;return e.parent===et?et:e.parent}prev(){if(this.left!==et)return yee(this.left);let e=this;for(;e.parent!==et&&e.parent.right!==e;)e=e.parent;return e.parent===et?et:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const et=new G5(null,0);et.parent=et;et.left=et;et.right=et;et.color=0;function t8(s){for(;s.left!==et;)s=s.left;return s}function yee(s){for(;s.right!==et;)s=s.right;return s}function i8(s){return s===et?0:s.size_left+s.piece.length+i8(s.right)}function n8(s){return s===et?0:s.lf_left+s.piece.lineFeedCnt+n8(s.right)}function UR(){et.parent=et}function hw(s,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==et&&(t.left.parent=e),t.parent=e.parent,e.parent===et?s.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function dw(s,e){const t=e.left;e.left=t.right,t.right!==et&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===et?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function ox(s,e){let t,i;if(e.left===et?(i=e,t=i.right):e.right===et?(i=e,t=i.left):(i=t8(e.right),t=i.right),i===s.root){s.root=t,t.color=0,e.detach(),UR(),s.root.parent=et;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,A0(s,t)):(i.parent===e?t.parent=i:t.parent=i.parent,A0(s,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==et&&(i.left.parent=i),i.right!==et&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,A0(s,i)),e.detach(),t.parent.left===t){const o=i8(t),a=n8(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,au(s,t.parent,l,c)}}if(A0(s,t.parent),n){UR();return}let r;for(;t!==s.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,hw(s,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,dw(s,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,hw(s,t.parent),t=s.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,dw(s,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,hw(s,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,dw(s,t.parent),t=s.root));t.color=0,UR()}function jj(s,e){for(A0(s,e);e!==s.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,hw(s,e)),e.parent.color=0,e.parent.parent.color=1,dw(s,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,dw(s,e)),e.parent.color=0,e.parent.parent.color=1,hw(s,e.parent.parent))}s.root.color=0}function au(s,e,t,i){for(;e!==s.root&&e!==et;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function A0(s,e){let t=0,i=0;if(e!==s.root){for(;e!==s.root&&e===e.parent.right;)e=e.parent;if(e!==s.root)for(e=e.parent,t=i8(e.left)-e.size_left,i=n8(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==s.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const nu=65535;function See(s){let e;return s[s.length-1]<65536?e=new Uint16Array(s.length):e=new Uint32Array(s.length),e.set(s,0),e}class d2e{constructor(e,t,i,n,r){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=r}}function hu(s,e=!0){const t=[0];let i=1;for(let n=0,r=s.length;n<r;n++){const o=s.charCodeAt(n);o===13?n+1<r&&s.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:o===10&&(t[i++]=n+1)}return e?See(t):t}function f2e(s,e){s.length=0,s[0]=0;let t=1,i=0,n=0,r=0,o=!0;for(let l=0,c=e.length;l<c;l++){const h=e.charCodeAt(l);h===13?l+1<c&&e.charCodeAt(l+1)===10?(r++,s[t++]=l+2,l++):(i++,s[t++]=l+1):h===10?(n++,s[t++]=l+1):o&&h!==9&&(h<32||h>126)&&(o=!1)}const a=new d2e(See(s),i,n,r,o);return s.length=0,a}class Fr{constructor(e,t,i,n,r){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=r}}class jf{constructor(e,t){this.buffer=e,this.lineStarts=t}}class g2e{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==et&&e.iterate(e.root,i=>(i!==et&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class m2e{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const r=i[n];if(r.node.parent===null||r.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const r of i)r!==null&&n.push(r);this._cache=n}}}class p2e{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new jf("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=et,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let r=0,o=e.length;r<o;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=hu(e[r].buffer));const a=new Fr(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),n=this.rbInsertRight(n,a)}this._searchCache=new m2e(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=nu,i=t-Math.floor(t/3),n=i*2;let r="",o=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),h=c.length;if(o<=i||o+h<n)return r+=c,o+=h,!0;const d=r.replace(/\r\n|\r|\n/g,e);return a.push(new jf(d,hu(d))),r=c,o=h,!0}),o>0){const l=r.replace(/\r\n|\r|\n/g,e);a.push(new jf(l,hu(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new g2e(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==et;)if(n.left!==et&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const r=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=r+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==et;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const r=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+r.index,r.index===0){const o=this.getOffsetAt(i+1,1),a=n-o;return new J(i+1,a+1)}return new J(i+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===et){const r=this.getOffsetAt(i+1,1),o=n-e-r;return new J(i+1,o+1)}else t=t.right;return new J(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=n.substring(r+e.remainder,r+i.piece.length);for(i=i.next();i!==et;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,r=>{if(r===et)return!0;const o=r.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,h=o.start.line,d=o.end.line;let g=c[h]+o.start.column;if(n&&(l.charCodeAt(g)===10&&(g++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(h===d)return!this._EOLNormalized&&l.charCodeAt(g+a-1)===13?(n=!0,i+=l.substr(g,a-1)):i+=l.substr(g,a),!0;i+=this._EOLNormalized?l.substring(g,Math.max(g,c[h+1]-this._EOLLength)):l.substring(g,c[h+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let p=h+1;p<d;p++)i=this._EOLNormalized?l.substring(c[p],c[p+1]-this._EOLLength):l.substring(c[p],c[p+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[d]+o.end.column-1)===13?(n=!0,o.end.column===0?t--:i=l.substr(c[d],o.end.column-1)):i=l.substr(c[d],o.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===et)return"";const n=this._buffers[i.piece.bufferIndex],r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.substring(r,r+i.piece.length)}else{const i=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=n+t.remainder,o=n+t.node.piece.length;return i.buffer.substring(r,o)}}findMatchesInNode(e,t,i,n,r,o,a,l,c,h,d){const g=this._buffers[e.piece.bufferIndex],p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),_=this.offsetInBuffer(e.piece.bufferIndex,r),b=this.offsetInBuffer(e.piece.bufferIndex,o);let C;const x={line:0,column:0};let S,y;t._wordSeparators?(S=g.buffer.substring(_,b),y=k=>k+_,t.reset(0)):(S=g.buffer,y=k=>k,t.reset(_));do if(C=t.next(S),C){if(y(C.index)>=b)return h;this.positionInBuffer(e,y(C.index)-p,x);const k=this.getLineFeedCnt(e.piece.bufferIndex,r,x),D=x.line===r.line?x.column-r.column+n:x.column+1,R=D+C[0].length;if(d[h++]=Mf(new G(i+k,D,i+k,R),C,l),y(C.index)+C[0].length>=b||h>=c)return h}while(C);return h}findMatchesLineByLine(e,t,i,n){const r=[];let o=0;const a=new e_(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let h=this.positionInBuffer(l.node,l.remainder);const d=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,h,d,t,i,n,o,r),r;let g=e.startLineNumber,p=l.node;for(;p!==c.node;){const b=this.getLineFeedCnt(p.piece.bufferIndex,h,p.piece.end);if(b>=1){const x=this._buffers[p.piece.bufferIndex].lineStarts,S=this.offsetInBuffer(p.piece.bufferIndex,p.piece.start),y=x[h.line+b],k=g===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(p,a,g,k,h,this.positionInBuffer(p,y-S),t,i,n,o,r),o>=n)return r;g+=b}const C=g===e.startLineNumber?e.startColumn-1:0;if(g===e.endLineNumber){const x=this.getLineContent(g).substring(C,e.endColumn-1);return o=this._findMatchesInLine(t,a,x,e.endLineNumber,C,o,r,i,n),r}if(o=this._findMatchesInLine(t,a,this.getLineContent(g).substr(C),g,C,o,r,i,n),o>=n)return r;g++,l=this.nodeAt2(g,1),p=l.node,h=this.positionInBuffer(l.node,l.remainder)}if(g===e.endLineNumber){const b=g===e.startLineNumber?e.startColumn-1:0,C=this.getLineContent(g).substring(b,e.endColumn-1);return o=this._findMatchesInLine(t,a,C,e.endLineNumber,b,o,r,i,n),r}const _=g===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,g,_,h,d,t,i,n,o,r),r}_findMatchesInLine(e,t,i,n,r,o,a,l,c){const h=e.wordSeparators;if(!l&&e.simpleSearch){const g=e.simpleSearch,p=g.length,_=i.length;let b=-p;for(;(b=i.indexOf(g,b+p))!==-1;)if((!h||b7(h,i,_,b,p))&&(a[o++]=new Rv(new G(n,b+1+r,n,b+1+p+r),null),o>=c))return o;return o}let d;t.reset(0);do if(d=t.next(i),d&&(a[o++]=Mf(new G(n,d.index+1+r,n,d.index+1+d[0].length+r),d,l),o>=c))return o;while(d);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==et){const{node:n,remainder:r,nodeStartOffset:o}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,c=this.positionInBuffer(n,r);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<nu){this.appendToNode(n,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(o+n.piece.length>e){const h=[];let d=new Fr(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,r)===10){const b={line:d.start.line+1,column:0};d=new Fr(d.bufferIndex,b,d.end,this.getLineFeedCnt(d.bufferIndex,b,d.end),d.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,r-1)===13){const b=this.positionInBuffer(n,r-1);this.deleteNodeTail(n,b),t="\r"+t,n.piece.length===0&&h.push(n)}else this.deleteNodeTail(n,c);else this.deleteNodeTail(n,c);const g=this.createNewPieces(t);d.length>0&&this.rbInsertRight(n,d);let p=n;for(let _=0;_<g.length;_++)p=this.rbInsertRight(p,g[_]);this.deleteNodes(h)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let r=this.rbInsertLeft(null,n[0]);for(let o=1;o<n.length;o++)r=this.rbInsertRight(r,n[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===et)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),r=i.node,o=n.node;if(r===o){const g=this.positionInBuffer(r,i.remainder),p=this.positionInBuffer(r,n.remainder);if(i.nodeStartOffset===e){if(t===r.piece.length){const _=r.next();ox(this,r),this.validateCRLFWithPrevNode(_),this.computeBufferMetadata();return}this.deleteNodeHead(r,p),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(i.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,g),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,g,p),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(r,i.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);const c=this.positionInBuffer(o,n.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);const h=r.next();for(let g=h;g!==et&&g!==o;g=g.next())a.push(g);const d=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},l=new Fr(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,au(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let r=this.rbInsertLeft(t,n[n.length-1]);for(let o=n.length-2;o>=0;o--)r=this.rbInsertLeft(r,n[o]);this.validateCRLFWithPrevNode(r),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let r=n;for(let o=1;o<i.length;o++)r=this.rbInsertRight(r,i[o]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,r=e.piece.bufferIndex,o=this._buffers[r].lineStarts,l=o[n.start.line]+n.start.column+t;let c=n.start.line,h=n.end.line,d=0,g=0,p=0;for(;c<=h&&(d=c+(h-c)/2|0,p=o[d],d!==h);)if(g=o[d+1],l<p)h=d-1;else if(l>=g)c=d+1;else break;return i?(i.line=d,i.column=l-p,null):{line:d,column:l-p}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const r=n[i.line+1],o=n[i.line]+i.column;if(r>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)ox(this,e[t])}createNewPieces(e){if(e.length>nu){const h=[];for(;e.length>nu;){const g=e.charCodeAt(nu-1);let p;g===13||g>=55296&&g<=56319?(p=e.substring(0,nu-1),e=e.substring(nu-1)):(p=e.substring(0,nu),e=e.substring(nu));const _=hu(p);h.push(new Fr(this._buffers.length,{line:0,column:0},{line:_.length-1,column:p.length-_[_.length-1]},_.length-1,p.length)),this._buffers.push(new jf(p,_))}const d=hu(e);return h.push(new Fr(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length)),this._buffers.push(new jf(e,d)),h}let t=this._buffers[0].buffer.length;const i=hu(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let h=0;h<i.length;h++)i[h]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let h=0;h<i.length;h++)i[h]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new Fr(0,n,l,this.getLineFeedCnt(0,n,l),r-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,n="";const r=this._searchCache.get2(e);if(r){i=r.node;const o=this.getAccumulatedValue(i,e-r.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(r.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+o,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-r.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;i!==et;)if(i.left!==et&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),h=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),h.substring(d+l,d+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=c.substring(h+l,h+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==et;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=o.substring(l,l+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=o.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==et;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),r=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(o!==r)return{index:o,remainder:0}}return{index:r,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,r=i.start.line+t+1;return r>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[r]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),l=this.getLineFeedCnt(i.bufferIndex,i.start,o),c=l-n,h=a-r,d=i.length+h;e.piece=new Fr(i.bufferIndex,i.start,o,l,d),au(this,e,h,c)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),l=this.offsetInBuffer(i.bufferIndex,o),c=a-n,h=r-l,d=i.length+h;e.piece=new Fr(i.bufferIndex,o,i.end,a,d),au(this,e,h,c)}shrinkNode(e,t,i){const n=e.piece,r=n.start,o=n.end,a=n.length,l=n.lineFeedCnt,c=t,h=this.getLineFeedCnt(n.bufferIndex,n.start,c),d=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,r);e.piece=new Fr(n.bufferIndex,n.start,c,h,d),au(this,e,d-a,h-l);const g=new Fr(n.bufferIndex,i,o,this.getLineFeedCnt(n.bufferIndex,i,o),this.offsetInBuffer(n.bufferIndex,o)-this.offsetInBuffer(n.bufferIndex,i)),p=this.rbInsertRight(e,g);this.validateCRLFWithPrevNode(p)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const r=hu(t,!1);for(let p=0;p<r.length;p++)r[p]+=n;if(i){const p=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-p}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,h=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,l),g=d-h;e.piece=new Fr(e.piece.bufferIndex,e.piece.start,l,d,c),this._lastChangeBufferPos=l,au(this,e,t.length,g)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==et;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==et;)if(i.left!==et&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(r+t-1,o),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2);if(r+t-1<=i.piece.length)return{node:i,remainder:r+t-1,nodeStartOffset:n};t-=i.piece.length-r;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==et;){if(i.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,r),nodeStartOffset:o}}else if(i.piece.length>=t-1){const r=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:r}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===et||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,r=i[n]+t.start.column;return n===i.length-1||i[n+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===et||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Fr(e.piece.bufferIndex,e.piece.start,r,a,o),au(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,h=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Fr(t.piece.bufferIndex,l,t.piece.end,h,c),au(this,t,-1,-1),t.piece.length===0&&i.push(t);const d=this.createNewPieces(`\r
`);this.rbInsertRight(e,d[0]);for(let g=0;g<i.length;g++)ox(this,i[g])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)ox(this,i);else{const n=i.piece,r={line:n.start.line+1,column:0},o=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,r,n.end);i.piece=new Fr(n.bufferIndex,r,n.end,a,o),au(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===et)return t(et);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===et)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),r=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,r)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new G5(t,1);if(i.left=et,i.right=et,i.parent=et,i.size_left=0,i.lf_left=0,this.root===et)this.root=i,i.color=0;else if(e.right===et)e.right=i,i.parent=e;else{const r=t8(e.right);r.left=i,i.parent=r}return jj(this,i),i}rbInsertLeft(e,t){const i=new G5(t,1);if(i.left=et,i.right=et,i.parent=et,i.size_left=0,i.lf_left=0,this.root===et)this.root=i,i.color=0;else if(e.left===et)e.left=i,i.parent=e;else{const n=yee(e.left);n.right=i,i.parent=n}return jj(this,i),i}}class K_ extends le{constructor(e,t,i,n,r,o,a){super(),this._onDidChangeContent=this._register(new Z),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=r,this._pieceTree=new p2e(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),r=this.getPositionAt(i);return new G(n.lineNumber,n.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=e.endLineNumber-e.startLineNumber;r=l*c}return n-i+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,r=e.endLineNumber;for(let o=n;o<=r;o++){const a=this.getLineContent(o),l=o===n?e.startColumn-1:0,c=o===r?e.endColumn-1:a.length;for(let h=l;h<c;h++)Tn(a.charCodeAt(h))?(i=i+1,h=h+1):i=i+1}return i+=this._getEndOfLine(t).length*(r-n),i}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=qr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Sm(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let b=0;b<e.length;b++){const C=e[b];a&&C._isTracked&&(a=!1);const x=C.range;if(C.text){let R=!0;o||(R=!$6(C.text),o=R),!n&&R&&(n=Sv(C.text)),!r&&R&&(r=FX(C.text))}let S="",y=0,k=0,D=0;if(C.text){let R;[y,k,D,R]=M1(C.text);const N=this.getEOL();R===0||R===(N===`\r
`?2:1)?S=C.text:S=C.text.replace(/\r\n|\r|\n/g,N)}l[b]={sortIndex:b,identifier:C.identifier||null,range:x,rangeOffset:this.getOffsetAt(x.startLineNumber,x.startColumn),rangeLength:this.getValueLengthInRange(x),text:S,eolCount:y,firstLineLength:k,lastLineLength:D,forceMoveMarkers:!!C.forceMoveMarkers,isAutoWhitespaceEdit:C.isAutoWhitespaceEdit||!1}}l.sort(K_._sortOpsAscending);let c=!1;for(let b=0,C=l.length-1;b<C;b++){const x=l[b].range.getEndPosition(),S=l[b+1].range.getStartPosition();if(S.isBeforeOrEqual(x)){if(S.isBefore(x))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const h=i||t?K_._getInverseEditRanges(l):[],d=[];if(t)for(let b=0;b<l.length;b++){const C=l[b],x=h[b];if(C.isAutoWhitespaceEdit&&C.range.isEmpty())for(let S=x.startLineNumber;S<=x.endLineNumber;S++){let y="";S===x.startLineNumber&&(y=this.getLineContent(C.range.startLineNumber),qr(y)!==-1)||d.push({lineNumber:S,oldContent:y})}}let g=null;if(i){let b=0;g=[];for(let C=0;C<l.length;C++){const x=l[C],S=h[C],y=this.getValueInRange(x.range),k=x.rangeOffset+b;b+=x.text.length-y.length,g[C]={sortIndex:x.sortIndex,identifier:x.identifier,range:S,text:y,textChange:new ps(x.rangeOffset,y,k,x.text)}}c||g.sort((C,x)=>C.sortIndex-x.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=o;const p=this._doApplyEdits(l);let _=null;if(t&&d.length>0){d.sort((b,C)=>C.lineNumber-b.lineNumber),_=[];for(let b=0,C=d.length;b<C;b++){const x=d[b].lineNumber;if(b>0&&d[b-1].lineNumber===x)continue;const S=d[b].oldContent,y=this.getLineContent(x);y.length===0||y===S||qr(y)!==-1||_.push(x)}}return this._onDidChangeContent.fire(),new A0e(g,p,_)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,r=new G(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let p=0,_=e.length;p<_;p++){const b=e[p],C=b.range;t=t||b.forceMoveMarkers,l.push(this.getValueInRange(new G(o,a,C.startLineNumber,C.startColumn))),b.text.length>0&&l.push(b.text),o=C.endLineNumber,a=C.endColumn}const c=l.join(""),[h,d,g]=M1(c);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:c,eolCount:h,firstLineLength:d,lastLineLength:g,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(K_._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(r===a&&o===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new G(r,o,a,l);t.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,r=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c,h;r?r.range.endLineNumber===l.range.startLineNumber?(c=i,h=n+(l.range.startColumn-r.range.endColumn)):(c=i+(l.range.startLineNumber-r.range.endLineNumber),h=l.range.startColumn):(c=l.range.startLineNumber,h=l.range.startColumn);let d;if(l.text.length>0){const g=l.eolCount+1;g===1?d=new G(c,h,c,h+l.firstLineLength):d=new G(c,h,c+g-1,l.lastLineLength+1)}else d=new G(c,h,c,h);i=d.endLineNumber,n=d.endColumn,t.push(d),r=l}return t}static _sortOpsAscending(e,t){const i=G.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=G.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class _2e{constructor(e,t,i,n,r,o,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=r,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,o=i.length;r<o;r++){const a=i[r].buffer.replace(/\r\n|\r|\n/g,t),l=hu(a);i[r]=new jf(a,l)}const n=new K_(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class xee{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&G6(e)&&(this.BOM=g_e,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=f2e(this._tmpLineStarts,e);this.chunks.push(new jf(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Sv(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=FX(e)))}finish(e=!0){return this._finish(),new _2e(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=hu(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}function Zv(s,e=Is.ofCaller()){return typeof s=="string"?new $j(s,void 0,e):new $j(void 0,s,e)}class $j extends X1{get debugName(){return new hr(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t,i){super(i),this._debugName=e,this._owner=t}trigger(e,t){if(!e){tn(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this._observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}class b2e extends X1{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i,n){super(n),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){var e,t;if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const i of this._deltas){(e=ks())==null||e.handleObservableUpdated(this,{change:i,didChange:!0,oldValue:"(unknown)",newValue:this._value,hadValue:!0});for(const n of this._observers)n.handleChange(this,i)}this._deltas.length=0}else{(t=ks())==null||t.handleObservableUpdated(this,{change:void 0,didChange:!0,oldValue:"(unknown)",newValue:this._value,hadValue:!0});for(const i of this._observers)i.handleChange(this,void 0)}}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this._observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this._observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this._observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this._observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new WC(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(r,o)=>{},handlePossibleChange:r=>{}},this),this._updateCounter>1)for(const r of this._observers)r.handlePossibleChange(this)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function fw(s,e,t=Is.ofCaller()){return s.lazy?new b2e(new hr(s.owner,s.debugName,void 0),e,s.equalsFn??pl,t):new Ev(new hr(s.owner,s.debugName,void 0),e,s.equalsFn??pl,t)}class w2e{constructor(){this._onDidChangeVisibleRanges=new Z,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set,this._viewsChanged=Zv(this),this.visibleLineRanges=sc({owner:this,equalsFn:L4(q_e())},e=>(this._viewsChanged.read(e),Qe.joinMany([...this._views].map(i=>{var n;return((n=i.state.read(e))==null?void 0:n.visibleLineRanges)??[]}))))}attachView(){const e=new C2e(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),this._viewsChanged.trigger(void 0),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0}),this._viewsChanged.trigger(void 0)}}class v2e{constructor(e,t){this.visibleLineRanges=e,this.stabilized=t}equals(e){return this===e?!0:!(!Sn(this.visibleLineRanges,e.visibleLineRanges,(t,i)=>t.equals(i))||this.stabilized!==e.stabilized)}}class C2e{get state(){return this._state}constructor(e){this.handleStateChange=e,this._state=fw({owner:this,equalsFn:D0((t,i)=>t.equals(i))},void 0)}setVisibleLines(e,t){const i=e.map(r=>new Qe(r.startLineNumber,r.endLineNumber+1)),n=new v2e(i,t);this._state.set(n,void 0,void 0),this.handleStateChange(n)}}class y2e extends le{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new Es(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){Sn(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class Lee extends le{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t){super(),this._languageIdCodec=e,this._textModel=t,this._onDidChangeTokens=this._register(new Z),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}}function S2e(s,e){const t=s.gotoNextSibling(),i=e.gotoNextSibling();if(t!==i)throw new Error("Trees are out of sync");return t&&i}function kee(s,e){const t=s.gotoParent(),i=e.gotoParent();if(t!==i)throw new Error("Trees are out of sync");return t&&i}function x2e(s,e,t){const i=s.gotoFirstChild(),n=e.gotoFirstChild();if(i!==n)throw new Error("Trees are out of sync");if(t===0)return i&&n;for(let r=1;r<=t;r++){const o=s.gotoNextSibling(),a=e.gotoNextSibling();if(o!==a)throw new Error("Trees are out of sync");if(!o||!a)return!1}return i&&n}function qj(s,e){do{if(s.currentNode.nextSibling)return S2e(s,e);s.currentNode.parent&&kee(s,e)}while(s.currentNode.nextSibling||s.currentNode.parent);return!1}function L2e(s,e){const t=e.walk();t.resetTo(s);const i=s.currentNode;do if(t.currentNode.previousSibling&&t.currentNode.endIndex-t.currentNode.startIndex!==0)t.gotoPreviousSibling();else{for(;!t.currentNode.previousSibling&&t.currentNode.parent;)t.gotoParent();t.gotoPreviousSibling()}while(t.currentNode.endIndex>i.startIndex&&(t.currentNode.parent||t.currentNode.previousSibling)&&t.currentNode.id!==i.id);if(t.currentNode.id!==i.id&&t.currentNode.endIndex<=i.startIndex)return t.currentNode}var k2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Gj=function(s,e){return function(t,i){e(t,i,s)}};let K5=class extends le{constructor(e,t,i,n,r,o,a){super(),this.languageId=e,this._ranges=t,this._parser=i,this._parserClass=n,this.textModel=r,this._logService=o,this._telemetryService=a,this._tree=lt(this,void 0),this.tree=this._tree,this._treeLastParsedVersion=lt(this,-1),this.treeLastParsedVersion=this._treeLastParsedVersion,this._onDidChangeContentQueue=new I_e,this._tree=lt(this,void 0),this.tree=this._tree,this._register(qe(()=>{var l,c,h;(l=this._tree.get())==null||l.delete(),(c=this._lastFullyParsed)==null||c.delete(),(h=this._lastFullyParsedWithEdits)==null||h.delete(),this._parser.delete()})),this.handleContentChange(void 0,this._ranges)}handleContentChange(e,t){const i=this.textModel.getVersionId();let n=[];t&&(n=this._setRanges(t)),e&&this._applyEdits(e.changes),this._onDidChangeContentQueue.clearPending(),this._onDidChangeContentQueue.schedule(async()=>{if(this._store.isDisposed)return;const r=this._lastFullyParsed;let o;this._lastFullyParsedWithEdits&&this._lastFullyParsed&&(o=this._findChangedNodes(this._lastFullyParsedWithEdits,this._lastFullyParsed));const a=await this._parseAndUpdateTree(i);if(a){let l;o?r&&o&&(l=this._findTreeChanges(a,o,n)):this._ranges&&(l=this._ranges.map(h=>({newRange:new G(h.startPosition.row+1,h.startPosition.column+1,h.endPosition.row+1,h.endPosition.column+1),oldRangeLength:h.endIndex-h.startIndex,newRangeStartOffset:h.startIndex,newRangeEndOffset:h.endIndex}))),l||(l=[{newRange:this.textModel.getFullModelRange(),newRangeStartOffset:0,newRangeEndOffset:this.textModel.getValueLength()}]);const c=this._tree.get();tn(h=>{this._tree.set(a,h,{ranges:l,versionId:i}),this._treeLastParsedVersion.set(i,h)}),c==null||c.delete()}})}_applyEdits(e){var t,i;for(const n of e){const r=Yr.ofRange(G.lift(n.range)),o=Yr.ofText(n.text),a=n.text.length===0?o:r.add(o),l={startIndex:n.rangeOffset,oldEndIndex:n.rangeOffset+n.rangeLength,newEndIndex:n.rangeOffset+n.text.length,startPosition:{row:n.range.startLineNumber-1,column:n.range.startColumn-1},oldEndPosition:{row:n.range.endLineNumber-1,column:n.range.endColumn-1},newEndPosition:{row:n.range.startLineNumber+a.lineCount-1,column:a.lineCount?a.columnCount:n.range.endColumn+a.columnCount}};(t=this._tree.get())==null||t.edit(l),(i=this._lastFullyParsedWithEdits)==null||i.edit(l)}}_findChangedNodes(e,t){if(this._ranges&&this._ranges.every(a=>a.startPosition.row!==e.rootNode.startPosition.row)||e.rootNode.startPosition.row!==0)return[];const i=e.walk(),n=t.walk(),r=[];let o=!0;do if(i.currentNode.hasChanges){const a=i.currentNode.children,l=[],c=a.filter((h,d)=>h!=null&&h.hasChanges||n.currentNode.children.length<=d?(l.push(d),!0):!1);if(c.length===0||i.currentNode.hasError!==n.currentNode.hasError){for(;i.currentNode.parent&&o&&!i.currentNode.isNamed;)o=kee(i,n);const h=i.currentNode,d=L2e(i,e)??h;r.push({startIndex:d.startIndex,endIndex:h.endIndex,startPosition:d.startPosition,endPosition:h.endPosition}),o=qj(i,n)}else c.length>=1&&(o=x2e(i,n,l[0]))}else o=qj(i,n);while(o);return i.delete(),n.delete(),r}_findTreeChanges(e,t,i){let n=0;const r=[];for(let o=0;o<t.length;o++){const a=t[o];if(r.length>0&&a.startIndex>=r[r.length-1].newRangeStartOffset&&a.endIndex<=r[r.length-1].newRangeEndOffset)continue;const l=e.walk(),c=()=>l.startIndex<a.startIndex&&l.endIndex>a.endIndex;for(;c();){let b=l.gotoFirstChild(),C=!1;for(;b;)if(c()&&l.currentNode.isNamed){C=!0;break}else b=l.gotoNextSibling();if(!C){l.gotoParent();break}if(l.currentNode.childCount===0)break}const h=l.currentNode.startPosition,d=l.currentNode.endPosition,g=l.currentNode.startIndex,p=l.currentNode.endIndex,_={newRange:new G(h.row+1,h.column+1,d.row+1,d.column+1),newRangeStartOffset:g,newRangeEndOffset:p};n<i.length&&Kj(i[n],{startIndex:g,endIndex:p})?(i[n].startIndex<_.newRangeStartOffset&&(_.newRange=_.newRange.setStartPosition(i[n].startPosition.row+1,i[n].startPosition.column+1),_.newRangeStartOffset=i[n].startIndex),i[n].endIndex>_.newRangeEndOffset&&(_.newRange=_.newRange.setEndPosition(i[n].endPosition.row+1,i[n].endPosition.column+1),_.newRangeEndOffset=i[n].endIndex),n++):n<i.length&&i[n].endIndex<_.newRangeStartOffset&&r.push({newRange:new G(i[n].startPosition.row+1,i[n].startPosition.column+1,i[n].endPosition.row+1,i[n].endPosition.column+1),newRangeStartOffset:i[n].startIndex,newRangeEndOffset:i[n].endIndex}),r.length>0&&r[r.length-1].newRangeEndOffset>=_.newRangeStartOffset?(r[r.length-1].newRange=G.fromPositions(r[r.length-1].newRange.getStartPosition(),_.newRange.getEndPosition()),r[r.length-1].newRangeEndOffset=_.newRangeEndOffset):r.push(_)}return this._constrainRanges(r)}_constrainRanges(e){if(!this._ranges)return e;const t=[];let i=0,n=0;for(;i<e.length&&n<this._ranges.length;){const r=e[i],o=this._ranges[n];if(r.newRangeEndOffset<o.startIndex)i++;else if(r.newRangeStartOffset>o.endIndex)n++;else{const a=Math.max(r.newRangeStartOffset,o.startIndex),l=Math.min(r.newRangeEndOffset,o.endIndex),c=r.newRange.intersectRanges(new G(o.startPosition.row+1,o.startPosition.column+1,o.endPosition.row+1,o.endPosition.column+1));t.push({newRange:c,newRangeEndOffset:l,newRangeStartOffset:a}),l<r.newRangeEndOffset?(r.newRange=G.fromPositions(c.getEndPosition(),r.newRange.getEndPosition()),r.newRangeStartOffset=l+1):i++}}return t}async _parseAndUpdateTree(e){var i,n;const t=await this._parse();if(t)return(i=this._lastFullyParsed)==null||i.delete(),this._lastFullyParsed=t.copy(),(n=this._lastFullyParsedWithEdits)==null||n.delete(),this._lastFullyParsedWithEdits=t.copy(),t;this._tree.get()||this._parser.reset()}_parse(){let e="fullParse";return this._tree.get()&&(e="incrementalParse"),this._parseAndYield(e)}async _parseAndYield(e){let t=0,i=0;const n=this.textModel.getVersionId();let r;const o=E2e();do{const a=performance.now();r=this._parser.parse((l,c)=>this._parseCallback(l),this._tree.get(),{progressCallback:o,includedRanges:this._ranges}),t+=performance.now()-a,i++,await new Promise(l=>PC(l))}while(!this._store.isDisposed&&!r&&n===this.textModel.getVersionId());return this._sendParseTimeTelemetry(e,t,i),r&&n===this.textModel.getVersionId()?r:void 0}_parseCallback(e){try{return this.textModel.getTextBuffer().getNearestChunk(e)}catch(t){this._logService.debug("Error getting chunk for tree-sitter parsing",t)}}_setRanges(e){const t=[];if(this._ranges)for(const i of e){let n=!1;for(let r=0;r<this._ranges.length;r++){const o=this._ranges[r];if(D2e(o,i)||Kj(o,i)){n=!0;break}}n||t.push(i)}else t.push(...e);return this._ranges=e,t}_sendParseTimeTelemetry(e,t,i){this._logService.debug(`Tree parsing (${e}) took ${t} ms and ${i} passes.`),e==="fullParse"?this._telemetryService.publicLog2("treeSitter.fullParse",{languageId:this.languageId,time:t,passes:i}):this._telemetryService.publicLog2("treeSitter.incrementalParse",{languageId:this.languageId,time:t,passes:i})}createParsedTreeSync(e){const t=new this._parserClass;t.setLanguage(this._parser.language);const i=t.parse(e);return t.delete(),i??void 0}};K5=k2e([Gj(5,pr),Gj(6,ah)],K5);function E2e(){let s=performance.now();return function(t){const i=performance.now();return i-s>50?(s=i,!0):!1}}function D2e(s,e){return s.startPosition.row===e.startPosition.row&&s.startPosition.column===e.startPosition.column&&s.endPosition.row===e.endPosition.row&&s.endPosition.column===e.endPosition.column&&s.startIndex===e.startIndex&&s.endIndex===e.endIndex}function Kj(s,e){return s.startIndex<=e.startIndex&&s.endIndex>=e.startIndex||e.startIndex<=s.startIndex&&e.endIndex>=s.startIndex}class T2e{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const n=this._store.slice(0,e),r=this._store.slice(e+t),o=N2e(i,this._default);this._store=n.concat(o,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=nD(this._store,e,i)}}function N2e(s,e){const t=[];for(let i=0;i<s;i++)t[i]=e;return t}class I2e{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class Y5{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new I2e(e,[t]))}finalize(){return this._tokens}}class R2e{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new Q5(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class A2e extends R2e{constructor(e,t,i,n){super(e,t),this._textModel=i,this._languageIdCodec=n}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const n=this.getFirstInvalidLine();if(!n||n.lineNumber>t)break;const r=this._textModel.getLineContent(n.lineNumber),o=f0(this._languageIdCodec,i,this.tokenizationSupport,r,!0,n.startState);e.add(n.lineNumber,o.tokens),this.store.setEndState(n.lineNumber,o.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const n=this._textModel.getLanguageId(),r=this._textModel.getLineContent(e.lineNumber),o=r.substring(0,e.column-1)+t+r.substring(e.column-1),a=f0(this._languageIdCodec,n,this.tokenizationSupport,o,!0,i),l=new Rn(a.tokens,o,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLinesAt(e,t){const i=this.getStartState(e);if(!i)return null;const n=this._textModel.getLanguageId(),r=[];let o=i;for(const a of t){const l=f0(this._languageIdCodec,n,this.tokenizationSupport,a,!0,o);r.push(new Rn(l.tokens,a,this._languageIdCodec)),o=l.endState}return r}hasAccurateTokensForLine(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let n=this.guessStartState(t);const r=this._textModel.getLanguageId();for(let o=t;o<=i;o++){const a=this._textModel.getLineContent(o),l=f0(this._languageIdCodec,r,this.tokenizationSupport,a,!0,n);e.add(o,l.tokens),n=l.endState}return{heuristicTokens:!0}}guessStartState(e){let{likelyRelevantLines:t,initialState:i}=Eee(this._textModel,e,this);i||(i=this.tokenizationSupport.getInitialState());const n=this._textModel.getLanguageId();let r=i;for(const o of t)r=f0(this._languageIdCodec,n,this.tokenizationSupport,o,!1,r).endState;return r}}function Eee(s,e,t){let i=s.getLineFirstNonWhitespaceColumn(e);const n=[];let r=null;for(let o=e-1;i>1&&o>=1;o--){const a=s.getLineFirstNonWhitespaceColumn(o);if(a!==0&&a<i&&(n.push(s.getLineContent(o)),i=a,r=t==null?void 0:t.getStartState(o),r))break}return n.reverse(),{likelyRelevantLines:n,initialState:r??void 0}}class Q5{constructor(e){this.lineCount=e,this._tokenizationStateStore=new M2e,this._invalidEndStatesLineNumbers=new O2e,this._invalidEndStatesLineNumbers.addRange(new ze(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new $e("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new ze(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new ze(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=M1(t.text);this.acceptChange(new Qe(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new ze(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new $e("Start state must be defined");return{lineNumber:t,startState:i}}}class M2e{constructor(){this._lineEndStates=new T2e(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class O2e{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new ze(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new ze(i.start,e):this._ranges.splice(t,1,new ze(i.start,e),new ze(e+1,i.endExclusive))}}addRange(e){ze.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;const r=t-e.length;for(let o=n;o<this._ranges.length;o++)this._ranges[o]=this._ranges[o].delta(r);if(i===n){const o=new ze(e.start,e.start+t);o.isEmpty||this._ranges.splice(i,0,o)}else{const o=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new ze(o,a+r);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function f0(s,e,t,i,n,r){let o=null;if(t)try{o=t.tokenizeEncoded(i,n,r.clone())}catch(a){$t(a)}return o||(o=x7(s.encodeLanguageId(e),r)),Rn.convertToEndOffset(o.tokens,i.length),o}class P2e{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Q6(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?PC(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new Y5,i=th.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){var i;const t=(i=this._tokenizerWithStateStore)==null?void 0:i.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Qe(e,t))}}class fm{get children(){return this._children}get length(){return this._length}constructor(e){this.height=e,this._children=[],this._length=0}static create(e,t){const i=new fm(e.height+1);return i.appendChild(e),i.appendChild(t),i}canAppendChild(){return this._children.length<3}appendChild(e){if(!this.canAppendChild())throw new Error("Cannot insert more than 3 children in a ListNode");this._children.push(e),this._length+=e.length,this._updateParentLength(e.length),ir(e)||(e.parent=this)}_updateParentLength(e){let t=this.parent;for(;t;)t._length+=e,t=t.parent}unappendChild(){const e=this._children.pop();return this._length-=e.length,this._updateParentLength(-e.length),e}prependChild(e){if(this._children.length>=3)throw new Error("Cannot prepend more than 3 children in a ListNode");this._children.unshift(e),this._length+=e.length,this._updateParentLength(e.length),ir(e)||(e.parent=this)}unprependChild(){const e=this._children.shift();return this._length-=e.length,this._updateParentLength(-e.length),e}lastChild(){return this._children[this._children.length-1]}dispose(){this._children.splice(0,this._children.length)}}var po;(function(s){s[s.None=0]="None",s[s.ViewportGuess=1]="ViewportGuess",s[s.EditGuess=2]="EditGuess",s[s.Accurate=3]="Accurate"})(po||(po={}));function ir(s){return s.token!==void 0}function Dee(s,e){let t=s;const i=[];let n;for(;;){if(e.height===t.height){n=e;break}if(ir(t))throw new Error("unexpected");i.push(t),t=t.lastChild()}for(let r=i.length-1;r>=0;r--){const o=i[r];n&&(o.children.length>=3?n=fm.create(o.unappendChild(),n):(o.appendChild(n),n=void 0))}if(n){const r=new fm(n.height+1);return r.appendChild(s),r.appendChild(n),r}else return s}function F2e(s,e){let t=s;const i=[];for(;e.height!==t.height;){if(ir(t))throw new Error("unexpected");i.push(t),t=t.children[0]}let n=e;for(let r=i.length-1;r>=0;r--){const o=i[r];n&&(o.children.length>=3?n=fm.create(n,o.unprependChild()):(o.prependChild(n),n=void 0))}return n?fm.create(n,s):s}function B2e(s,e){return s.height===e.height?fm.create(s,e):s.height>e.height?Dee(s,e):F2e(e,s)}class V2e{constructor(e){this._textModel=e,this._root=this.createEmptyRoot()}createEmptyRoot(){return{length:this._textModel.getValueLength(),token:0,height:0,tokenQuality:po.None}}buildStore(e,t){this._root=this.createFromUpdates(e,t)}createFromUpdates(e,t){if(e.length===0)return this.createEmptyRoot();let i={length:e[0].length,token:e[0].token,height:0,tokenQuality:t};for(let n=1;n<e.length;n++)i=Dee(i,{length:e[n].length,token:e[n].token,height:0,tokenQuality:t});return i}update(e,t,i){t.length!==0&&this.replace(e,t[0].startOffsetInclusive,t,i)}delete(e,t){this.replace(e,t,[],po.EditGuess)}replace(e,t,i,n){const r=t+e,o=[],a=[],l=[{node:this._root,offset:0}];for(;l.length>0;){const d=l.pop(),g=d.offset;if(g<t&&g+d.node.length<=t){ir(d.node)||(d.node.parent=void 0),o.push(d.node);continue}else ir(d.node)&&g<t&&o.push({length:t-g,token:d.node.token,height:0,tokenQuality:d.node.tokenQuality});if(!(t<=g&&g+d.node.length<=r)){if(g>=r){ir(d.node)||(d.node.parent=void 0),a.push(d.node);continue}else if(ir(d.node)&&g+d.node.length>r){a.push({length:g+d.node.length-r,token:d.node.token,height:0,tokenQuality:d.node.tokenQuality});continue}if(!ir(d.node)){let p=g+d.node.length;for(let _=d.node.children.length-1;_>=0;_--)p-=d.node.children[_].length,l.push({node:d.node.children[_],offset:p})}}}let c;i.length>0?c=o.concat(this.createFromUpdates(i,n),a):c=o.concat(a);let h=c[0];for(let d=1;d<c.length;d++)h=B2e(h,c[d]);this._root=h??this.createEmptyRoot()}traverseInOrderInRange(e,t,i){const n=[{node:this._root,offset:0}];for(;n.length>0;){const{node:r,offset:o}=n.pop();if(!(o+r.length<=e||o>=t)){if(i(r,o))return;if(!ir(r)){let l=o+r.length;for(let c=r.children.length-1;c>=0;c--)l-=r.children[c].length,n.push({node:r.children[c],offset:l})}}}}getTokenAt(e){let t;return this.traverseInOrderInRange(e,this._root.length,(i,n)=>ir(i)?(t={token:i.token,startOffsetInclusive:n,length:i.length},!0):!1),t}getTokensInRange(e,t){const i=[];return this.traverseInOrderInRange(e,t,(n,r)=>{if(ir(n)){let o=n.length,a=r;r<e&&r+n.length>t?(a=e,o=t-e):r<e?(o-=e-r,a=e):r+n.length>t&&(o-=r+n.length-t),i.push({token:n.token,startOffsetInclusive:a,length:o})}return!1}),i}markForRefresh(e,t){this.traverseInOrderInRange(e,t,i=>(ir(i)&&(i.tokenQuality=po.None),!1))}rangeHasTokens(e,t,i){let n=!0;return this.traverseInOrderInRange(e,t,r=>(ir(r)&&r.tokenQuality<i&&(n=!1),!1)),n}rangeNeedsRefresh(e,t){let i=!1;return this.traverseInOrderInRange(e,t,n=>(ir(n)&&n.tokenQuality!==po.Accurate&&(i=!0),!1)),i}getNeedsRefresh(){const e=[];return this.traverseInOrderInRange(0,this._textModel.getValueLength(),(t,i)=>(ir(t)&&t.tokenQuality!==po.Accurate&&(e.length>0&&e[e.length-1].endOffset===i?e[e.length-1].endOffset+=t.length:e.push({startOffset:i,endOffset:i+t.length})),!1)),e}dispose(){const e=[[this._root,!1]];for(;e.length>0;){const[t,i]=e.pop();if(!ir(t))if(i)t.dispose(),t.parent=void 0;else{e.push([t,!0]);for(let n=t.children.length-1;n>=0;n--)e.push([t.children[n],!1])}}this._root=void 0}}const H2e=gt("treeSitterThemeService");function W2e(s){return{createChangeSummary:e=>({changes:[]}),handleChange(e,t){for(const i in s)e.didChange(s[i])&&t.changes.push({key:i,change:e.change});return!0},beforeUpdate(e,t){for(const i in s){if(i==="changes")throw new $e('property name "changes" is reserved for change tracking');t[i]=s[i].read(e)}}}}var z2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},U2e=function(s,e){return function(t,i){e(t,i,s)}};let X5=class extends le{get _textModel(){return this._tree.textModel}constructor(e,t,i,n,r){super(),this._tree=e,this._highlightingQueries=t,this._languageIdCodec=i,this._visibleLineRanges=n,this._treeSitterThemeService=r,this._onDidChangeTokens=this._register(new Z),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidCompleteBackgroundTokenization=this._register(new Z),this.onDidChangeBackgroundTokenization=this._onDidCompleteBackgroundTokenization.event,this._encodedLanguageId=this._languageIdCodec.encodeLanguageId(this._tree.languageId),this._register(ow(this._treeSitterThemeService.onChange,()=>{this._updateTheme()})),this._tokenStore=this._register(new V2e(this._textModel)),this._accurateVersion=this._textModel.getVersionId(),this._guessVersion=this._textModel.getVersionId(),this._tokenStore.buildStore(this._createEmptyTokens(),po.None),this._register(vt(o=>{const a=this._visibleLineRanges.read(o);this._parseAndTokenizeViewPort(a)})),this._register(Z1({owner:this,changeTracker:W2e({tree:this._tree.tree})},(o,a)=>{var c;const l=(c=a.changes.at(0))==null?void 0:c.change;if(a.changes.length>1)throw new $e("The tree changed twice in one transaction. This is currently not supported and should not happen.");if(!l)a.tree&&this._firstTreeUpdate(this._tree.treeLastParsedVersion.read(o));else{if(this.hasTokens())for(const h of l.ranges)this._markForRefresh(h.newRange);this.hasTokens()?this._handleTreeUpdate(l.ranges,l.versionId):this._firstTreeUpdate(l.versionId)}}))}handleContentChanged(e){this._guessVersion=e.versionId;for(const t of e.changes)if(t.text.length>t.rangeLength){const i=t.rangeOffset>0?t.rangeOffset-1:t.rangeOffset,n=this._tokenStore.getTokenAt(i);let r;n?(r={startOffsetInclusive:n.startOffsetInclusive,length:n.length+t.text.length-t.rangeLength,token:n.token},this._tokenStore.markForRefresh(i,t.rangeOffset+(t.text.length>t.rangeLength?t.text.length:t.rangeLength))):r={startOffsetInclusive:i,length:t.text.length,token:0},this._tokenStore.update((n==null?void 0:n.length)??0,[r],po.EditGuess)}else if(t.text.length<t.rangeLength){const i=t.rangeLength-t.text.length;this._tokenStore.delete(i,t.rangeOffset)}}getLineTokens(e){const t=this._textModel.getLineContent(e),i=this.getTokens(e);return new Rn(i,t,this._languageIdCodec)}_createEmptyTokens(){const e=this._emptyToken(),t=this._textModel.getValueLength();return[this._emptyTokensForOffsetAndLength(0,t,e)]}_emptyToken(){return this._treeSitterThemeService.findMetadata([],this._encodedLanguageId,!1,void 0)}_emptyTokensForOffsetAndLength(e,t,i){return{token:i,length:e+t,startOffsetInclusive:0}}hasAccurateTokensForLine(e){return this.hasTokens(new G(e,1,e,this._textModel.getLineMaxColumn(e)))}tokenizeLinesAt(e,t){const i=this._guessTokensForLinesContent(e,t),n=[];if(!i)return null;for(let r=0;r<i.length;r++)n.push(new Rn(i[r],t[r],this._languageIdCodec));return n}_rangeHasTokens(e,t){return this._tokenStore.rangeHasTokens(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()),t)}hasTokens(e){return!e||this._guessVersion===this._accurateVersion?!0:!this._tokenStore.rangeNeedsRefresh(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()))}getTokens(e){const t=this._textModel.getOffsetAt({lineNumber:e,column:1}),i=this._textModel.getOffsetAt({lineNumber:e,column:this._textModel.getLineLength(e)+1}),n=this._tokenStore.getTokensInRange(t,i),r=new Uint32Array(n.length*2);for(let o=0;o<n.length;o++)r[o*2]=n[o].startOffsetInclusive-t+n[o].length,r[o*2+1]=n[o].token;return r}getTokensInRange(e,t,i,n){const r=n?this._tokenizeCapturesWithMetadata(n,t,i):this._tokenize(e,t,i);if(r!=null&&r.endOffsetsAndMetadata)return this._rangeTokensAsUpdates(t,r.endOffsetsAndMetadata)}_updateTokensInStore(e,t,i){this._accurateVersion=e;for(const n of t){const r=n.newTokens.length>0?n.newTokens[n.newTokens.length-1]:void 0;let o;r&&this._guessVersion>=e?o=r.startOffsetInclusive+r.length-n.newTokens[0].startOffsetInclusive:n.oldRangeLength?o=n.oldRangeLength:o=0,this._tokenStore.update(o,n.newTokens,i)}}_markForRefresh(e){this._tokenStore.markForRefresh(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()))}_getNeedsRefresh(){const e=this._tokenStore.getNeedsRefresh();return e?e.map(t=>({range:G.fromPositions(this._textModel.getPositionAt(t.startOffset),this._textModel.getPositionAt(t.endOffset)),startOffset:t.startOffset,endOffset:t.endOffset})):[]}_parseAndTokenizeViewPort(e){const t=e.map(i=>i.toInclusiveRange()).filter(Xo);for(const i of t){const n=this._textModel.getOffsetAt(i.getStartPosition()),r=this._textModel.getOffsetAt(i.getEndPosition()),o=this._textModel.getVersionId();if(this._rangeHasTokens(i,po.ViewportGuess))continue;const a=this._textModel.getValueInRange(i),l=this._forceParseAndTokenizeContent(i,n,r,a,!0);if(!l||this._rangeHasTokens(i,po.ViewportGuess)||l.length===0)continue;const c=l[l.length-1],h=c.startOffsetInclusive+c.length-l[0].startOffsetInclusive;this._updateTokensInStore(o,[{newTokens:l,oldRangeLength:h}],po.ViewportGuess),this._onDidChangeTokens.fire({changes:{semanticTokensApplied:!1,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]}})}}_guessTokensForLinesContent(e,t){if(t.length===0)return;const i=t.join(this._textModel.getEOL()),n=new G(1,1,e+t.length,t[t.length-1].length+1),r=this._textModel.getOffsetAt({lineNumber:e,column:1}),o=this._forceParseAndTokenizeContent(n,r,r+i.length,i,!1);if(!o)return;const a=new Array(t.length);let l=0,c=0,h=0;for(let d=0;d<t.length;d++){const g=[];let p=!1;for(let _=l;!p&&_<o.length;_++){const b=o[_],C=b.endOffset-h,x=c-h;if(C<=t[d].length)g.push({endOffset:C,metadata:b.metadata}),l++;else if(x<t[d].length){const S={endOffset:t[d].length,metadata:b.metadata};g.push(S),p=!0}else p=!0;c=b.endOffset}a[d]=this._endOffsetTokensToUint32Array(g),h+=t[d].length+this._textModel.getEOL().length}return a}_forceParseAndTokenizeContent(e,t,i,n,r){const o=Eee(this._textModel,e.startLineNumber).likelyRelevantLines,a=o.join(this._textModel.getEOL()),l=this._tree.createParsedTreeSync(`${a}${n}`);if(!l)return;const c=new G(1,1,e.endLineNumber-e.startLineNumber+1+o.length,e.endColumn),h=this.captureAtRange(c),d=this._tokenizeCapturesWithMetadata(h,a.length,i-t+a.length);if(l.delete(),!!d)return r?this._rangeTokensAsUpdates(t,d.endOffsetsAndMetadata,a.length):d.endOffsetsAndMetadata}_firstTreeUpdate(e){return this._setViewPortTokens(e)}_setViewPortTokens(e){const t=this._visibleLineRanges.get().map(i=>{const n=i.toInclusiveRange();if(!n)return;const r=this._textModel.getOffsetAt(n.getStartPosition()),o=this._textModel.getOffsetAt(n.getEndPosition());return{newRange:n,newRangeEndOffset:o,newRangeStartOffset:r}}).filter(Xo);return this._handleTreeUpdate(t,e)}_handleTreeUpdate(e,t){const i=[];for(let o=0;o<e.length;o++)if(e[o].newRange.endLineNumber-e[o].newRange.startLineNumber>1e3){const l=e[o].newRange.endLineNumber;let c=e[o].newRange.startLineNumber,h=e[o].newRange.startColumn,d=c+1e3;do{const g=new J(c,h),p=d===e[o].newRange.endLineNumber?e[o].newRange.endColumn:this._textModel.getLineMaxColumn(d),_=new J(d,p),b=G.fromPositions(g,_);i.push({range:b,startOffset:this._textModel.getOffsetAt(b.getStartPosition()),endOffset:this._textModel.getOffsetAt(b.getEndPosition())}),c=d+1,h=1,d<l&&d+1e3>l?d=l:d=d+1e3}while(d<=l)}else if(o===0||i[o-1].endOffset<e[o].newRangeStartOffset)i.push({range:e[o].newRange,startOffset:e[o].newRangeStartOffset,endOffset:e[o].newRangeEndOffset});else if(i[o-1].endOffset<e[o].newRangeEndOffset){const l=this._textModel.getPositionAt(i[o-1].endOffset+1),c=new G(l.lineNumber,l.column,e[o].newRange.endLineNumber,e[o].newRange.endColumn);i.push({range:c,startOffset:i[o-1].endOffset+1,endOffset:e[o].newRangeEndOffset})}const r=i.map(o=>this._getCaptures(o.range));return this._updateTreeForRanges(i,t,r).then(()=>{!this._textModel.isDisposed()&&this._tree.treeLastParsedVersion.get()===this._textModel.getVersionId()&&this._refreshNeedsRefresh(t)})}async _updateTreeForRanges(e,t,i){let n;for(let r=0;r<e.length&&!(!this._textModel.isDisposed()&&t!==this._textModel.getVersionId());r++){const o=i[r],a=e[r],l=this.getTokensInRange(a.range,a.startOffset,a.endOffset,o);l?n={newTokens:l}:n={newTokens:[]},this._updateTokensInStore(t,[n],po.Accurate),this._onDidChangeTokens.fire({changes:{semanticTokensApplied:!1,ranges:[{fromLineNumber:a.range.getStartPosition().lineNumber,toLineNumber:a.range.getEndPosition().lineNumber}]}}),await new Promise(c=>PC(c))}this._onDidCompleteBackgroundTokenization.fire()}_refreshNeedsRefresh(e){const t=this._getNeedsRefresh();if(t.length===0)return;const i=new Array(t.length);for(let n=0;n<t.length;n++){const r=t[n];i[n]={newRange:r.range,newRangeStartOffset:r.startOffset,newRangeEndOffset:r.endOffset}}this._handleTreeUpdate(i,e)}_rangeTokensAsUpdates(e,t,i){const n=[];let r=0;for(const o of t){if(o.endOffset<=r||i&&o.endOffset<i)continue;let a;i&&r<i?a={startOffsetInclusive:e+i,length:o.endOffset-i,token:o.metadata}:a={startOffsetInclusive:e+r,length:o.endOffset-r,token:o.metadata},n.push(a),r=o.endOffset}return n}_updateTheme(){const e=this._textModel.getFullModelRange();this._markForRefresh(e),this._parseAndTokenizeViewPort(this._visibleLineRanges.get())}captureAtRange(e){const t=this._tree.tree.get();return t?this._highlightingQueries.captures(t.rootNode,{startPosition:{row:e.startLineNumber-1,column:e.startColumn-1},endPosition:{row:e.endLineNumber-1,column:e.endColumn-1}}).map(i=>({name:i.name,text:i.node.text,node:{startIndex:i.node.startIndex,endIndex:i.node.endIndex,startPosition:{lineNumber:i.node.startPosition.row+1,column:i.node.startPosition.column+1},endPosition:{lineNumber:i.node.endPosition.row+1,column:i.node.endPosition.column+1}},encodedLanguageId:this._encodedLanguageId})):[]}captureAtRangeWithInjections(e){const t=this.captureAtRange(e);for(let i=0;i<t.length;i++){const n=t[i],r=n.node.startPosition.lineNumber,o=n.node.endPosition.lineNumber,a=n.node.startPosition.column,l=n.node.endPosition.column,c=r>e.startLineNumber&&r<e.endLineNumber?r:e.startLineNumber,h=o>e.startLineNumber&&o<e.endLineNumber?o:e.endLineNumber,d=r===e.startLineNumber?a<e.startColumn?e.startColumn:a:r<e.startLineNumber?e.startColumn:a,g=o===e.endLineNumber?l>e.endColumn?e.endColumn:l:o>e.endLineNumber?e.endColumn:l,p=new G(c,d,h,g),_=this._getInjectionCaptures(n,p);_&&_.length>0&&(t.splice(i+1,0,..._),i+=_.length)}return t}tokenizeEncoded(e){const t=this._tokenizeEncoded(e);if(!t)return;const i=this._rangeTokensAsUpdates(this._textModel.getOffsetAt({lineNumber:e,column:1}),t.result);t.versionId===this._textModel.getVersionId()&&this._updateTokensInStore(t.versionId,[{newTokens:i,oldRangeLength:this._textModel.getLineLength(e)}],po.Accurate)}_getCaptures(e){return this.captureAtRangeWithInjections(e)}_tokenize(e,t,i){const n=this._getCaptures(e),r=this._tokenizeCapturesWithMetadata(n,t,i);if(r)return{...r,versionId:this._tree.treeLastParsedVersion.get()}}_createTokensFromCaptures(e,t,i){const n=this._tree.tree.get(),r=th.create(),o=i-t,a=this._languageIdCodec.encodeLanguageId(this._tree.languageId),l=j2e[this._tree.languageId]||"source";if(e.length===0)return n?(r.stop(),{endOffsets:[{endOffset:o,scopes:[],encodedLanguageId:a}],captureTime:r.elapsed()}):void 0;const c=Array(e.length);c.fill({endOffset:0,scopes:[l],encodedLanguageId:a});let h=0;const d=()=>{c.push({endOffset:0,scopes:[l],encodedLanguageId:a})},g=(b,C)=>b.name.includes("punctuation")&&b.text?Array.from(b.text.matchAll($2e)).map(x=>C+x.index):void 0,p=(b,C,x,S)=>{if(S!==void 0){const y=c[S].scopes;let k=c[S].bracket;if((S>0?c[S-1].endOffset:0)!==C){let R;if(k&&k.length>0){R=[];const N=[];for(let A=0;A<k.length;A++){const M=k[A];M<C?R.push(M):M>x&&N.push(M)}R.length===0&&(R=void 0),N.length===0?k=void 0:k=N}c.splice(S,0,{endOffset:C,scopes:[...y],bracket:R,encodedLanguageId:b.encodedLanguageId}),S++,d(),h++}c.splice(S,0,{endOffset:x,scopes:[...y,b.name],bracket:g(b,C),encodedLanguageId:b.encodedLanguageId}),c[h].bracket=k}else c[h]={endOffset:x,scopes:[l,b.name],bracket:g(b,C),encodedLanguageId:b.encodedLanguageId};h++};for(let b=0;b<e.length;b++){const C=e[b],x=C.node.endIndex<i?C.node.endIndex<t?t:C.node.endIndex:i,S=C.node.startIndex<t?t:C.node.startIndex,y=x-t;let k;const D=x-S;b>0?k=c[h-1].endOffset:k=S-t-1;const R=y-D;if(k>=0&&k<R&&(c[h]={endOffset:R,scopes:[l],encodedLanguageId:this._encodedLanguageId},h++,d()),!(D<0))if(k>=y){let N=h-1,A=c[N].endOffset,M=N>=2?c[N-1].endOffset:0;do{if(M+D===A){if(M===R){c[N].scopes.push(C.name);const O=c[N].bracket;c[N].bracket=O&&O.length>0?O:g(C,R)}}else if(M<=R){p(C,R,y,N);break}N--,M=N>=1?c[N-1].endOffset:0,A=N>=0?c[N].endOffset:0}while(A>R)}else p(C,R,y)}c[h-1].endOffset<o&&o-c[h-1].endOffset>0&&(d(),c[h]={endOffset:o,scopes:c[h].scopes,encodedLanguageId:this._encodedLanguageId},h++);for(let b=0;b<c.length;b++)if(c[b].endOffset===0&&b!==0){c.splice(b,c.length-b);break}const _=r.elapsed();return{endOffsets:c,captureTime:_}}_getInjectionCaptures(e,t){return[]}_tokenizeCapturesWithMetadata(e,t,i){const n=th.create(),r=this._createTokensFromCaptures(e,t,i);if(!r)return;const o=r.endOffsets;for(let l=0;l<o.length;l++){const c=o[l];c.metadata=this._treeSitterThemeService.findMetadata(c.scopes,c.encodedLanguageId,!!c.bracket&&c.bracket.length>0,void 0)}const a=n.elapsed();return{endOffsetsAndMetadata:o,captureTime:r.captureTime,metadataTime:a}}_tokenizeEncoded(e){const t=this._textModel.getOffsetAt({lineNumber:e,column:1}),i=this._textModel.getLineCount(),n=e+1<=i?this._textModel.getOffsetAt({lineNumber:e+1,column:1}):this._textModel.getValueLength(),r=n-t,o=this._tokenize(new G(e,1,e,r+1),t,n);if(o)return{result:o.endOffsetsAndMetadata,captureTime:o.captureTime,metadataTime:o.metadataTime,versionId:o.versionId}}_endOffsetTokensToUint32Array(e){const t=new Uint32Array(e.length*2);for(let i=0;i<e.length;i++)t[i*2]=e[i].endOffset,t[i*2+1]=e[i].metadata;return t}};X5=z2e([U2e(4,H2e)],X5);const j2e={css:"source.css",typescript:"source.ts",ini:"source.ini",regex:"source.regex"},$2e=/[\{\}\[\]\<\>\(\)]/g,s8=gt("treeSitterLibraryService");class q2e{constructor(e){this._value=lt(this,void 0),this.promiseResult=this._value,this.promise=e.then(t=>(tn(i=>{this._value.set(new Yj(t,void 0),i)}),t),t=>{throw tn(i=>{this._value.set(new Yj(void 0,t),i)}),t})}}class Yj{constructor(e,t){this.data=e,this.error=t}getDataOrThrow(){if(this.error)throw this.error;return this.data}}var G2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Qj=function(s,e){return function(t,i){e(t,i,s)}};let Z5=class extends Lee{constructor(e,t,i,n,r,o){super(t,i),this._languageIdObs=e,this._treeSitterLibraryService=r,this._instantiationService=o,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new Z),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;const a=new q2e(this._treeSitterLibraryService.getParserClass()),l=We(this,c=>{var d,g;return(g=(d=a.promiseResult)==null?void 0:d.read(c))==null?void 0:g.getDataOrThrow()});this._tree=We(this,c=>{const h=l.read(c);if(!h)return;const d=this._languageIdObs.read(c),g=this._treeSitterLibraryService.getLanguage(d,!1,c);if(!g)return;const p=new h;if(c.store.add(qe(()=>{p.delete()})),p.setLanguage(g),this._treeSitterLibraryService.getInjectionQueries(d,c)!==void 0)return c.store.add(this._instantiationService.createInstance(K5,d,void 0,p,h,this._textModel))}),this._tokenizationImpl=We(this,c=>{const h=this._tree.read(c);if(!h)return;const d=this._treeSitterLibraryService.getHighlightingQueries(h.languageId,c);if(d)return c.store.add(this._instantiationService.createInstance(X5,h,d,this._languageIdCodec,n))}),this._register(vt(c=>{const h=this._tokenizationImpl.read(c);h&&(c.store.add(h.onDidChangeTokens(d=>{this._onDidChangeTokens.fire(d.changes)})),c.store.add(h.onDidChangeBackgroundTokenization(d=>{this._backgroundTokenizationState=2,this._onDidChangeBackgroundTokenizationState.fire()})))}))}getLineTokens(e){const t=this._tokenizationImpl.get();if(!t){const i=this._textModel.getLineContent(e);return Rn.createEmpty(i,this._languageIdCodec)}return t.getLineTokens(e)}todo_resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}handleDidChangeAttached(){}handleDidChangeContent(e){if(e.isFlush)this.todo_resetTokenization(!1);else{const i=this._tokenizationImpl.get();i==null||i.handleContentChanged(e)}const t=this._tree.get();t==null||t.handleContentChange(e)}forceTokenization(e){const t=this._tokenizationImpl.get();t&&(t.hasAccurateTokensForLine(e)||t.tokenizeEncoded(e))}hasAccurateTokensForLine(e){const t=this._tokenizationImpl.get();return t?t.hasAccurateTokensForLine(e):!1}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,t,i){return 0}tokenizeLinesAt(e,t){const i=this._tokenizationImpl.get();return i?i.tokenizeLinesAt(e,t):null}get hasTokens(){const e=this._tokenizationImpl.get();return e?e.hasTokens():!1}};Z5=G2e([Qj(4,s8),Qj(5,It)],Z5);class r8{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t,i=void 0){if(this._pieces=e||[],this._isComplete=t,i)for(const n of this._pieces)n.reportIfInvalid(i)}setPartial(e,t){let i=e;if(t.length>0){const r=t[0].getRange(),o=t[t.length-1].getRange();if(!r||!o)return e;i=e.plusRange(r).plusRange(o)}let n=null;for(let r=0,o=this._pieces.length;r<o;r++){const a=this._pieces[r];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:r};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(r,1),r--,o--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:r};continue}const[l,c]=a.split(i);if(l.isEmpty()){n=n||{index:r};continue}c.isEmpty()||(this._pieces.splice(r,1,l,c),r++,o++,n=n||{index:r})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=nD(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getTextLength()===0)return t;const i=this._pieces;if(i.length===0)return t;const n=r8._findFirstPieceWithLine(i,e),r=i[n].getLineTokens(e);if(!r)return t;const o=t.getCount(),a=r.getCount();let l=0;const c=[];let h=0,d=0;const g=(p,_)=>{p!==d&&(d=p,c[h++]=p,c[h++]=_)};for(let p=0;p<a;p++){const _=Math.min(r.getStartCharacter(p),t.getTextLength()),b=Math.min(r.getEndCharacter(p),t.getTextLength()),C=r.getMetadata(p),x=((C&1?2048:0)|(C&2?4096:0)|(C&4?8192:0)|(C&8?16384:0)|(C&16?16744448:0)|(C&32?4278190080:0))>>>0,S=~x>>>0;for(;l<o&&t.getEndOffset(l)<=_;)g(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<o&&t.getStartOffset(l)<_&&g(_,t.getMetadata(l));l<o&&t.getEndOffset(l)<b;)g(t.getEndOffset(l),t.getMetadata(l)&S|C&x),l++;if(l<o)g(b,t.getMetadata(l)&S|C&x),t.getEndOffset(l)===b&&l++;else{const y=Math.min(Math.max(0,l-1),o-1);g(b,t.getMetadata(y)&S|C&x)}}for(;l<o;)g(t.getEndOffset(l),t.getMetadata(l)),l++;return new Rn(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let r=i+Math.floor((n-i)/2);if(e[r].endLineNumber<t)i=r+1;else if(e[r].startLineNumber>t)n=r-1;else{for(;r>i&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return i}acceptEdit(e,t,i,n,r){for(let o=0;o<this._pieces.length;o++){const a=this._pieces[o];a.acceptEdit(e,t,i,n,r),a.isEmpty()&&(this._pieces.splice(o,1),o--)}}}const du=new Uint32Array(0).buffer;class jl{static deleteBeginning(e,t){return e===null||e===du?e:jl.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===du)return e;const i=Iu(e),n=i[i.length-2];return jl.delete(e,t,n)}static delete(e,t,i){if(e===null||e===du||t===i)return e;const n=Iu(e),r=n.length>>>1;if(t===0&&n[n.length-2]===i)return du;const o=Rn.findIndexInTokensArray(n,t),a=o>0?n[o-1<<1]:0,l=n[o<<1];if(i<l){const p=i-t;for(let _=o;_<r;_++)n[_<<1]-=p;return e}let c,h;a!==t?(n[o<<1]=t,c=o+1<<1,h=t):(c=o<<1,h=a);const d=i-t;for(let p=o+1;p<r;p++){const _=n[p<<1]-d;_>h&&(n[c++]=_,n[c++]=n[(p<<1)+1],h=_)}if(c===n.length)return e;const g=new Uint32Array(c);return g.set(n.subarray(0,c),0),g.buffer}static append(e,t){if(t===du)return e;if(e===du)return t;if(e===null)return e;if(t===null)return null;const i=Iu(e),n=Iu(t),r=n.length>>>1,o=new Uint32Array(i.length+n.length);o.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<r;c++)o[a++]=n[c<<1]+l,o[a++]=n[(c<<1)+1];return o.buffer}static insert(e,t,i){if(e===null||e===du)return e;const n=Iu(e),r=n.length>>>1;let o=Rn.findIndexInTokensArray(n,t);o>0&&n[o-1<<1]===t&&o--;for(let a=o;a<r;a++)n[a<<1]+=i;return e}}function Iu(s){return s instanceof Uint32Array?s:new Uint32Array(s)}class Jv{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==du)return new Rn(Iu(n),i,this._languageIdCodec);const r=new Uint32Array(2);return r[0]=i.length,r[1]=Xj(this._languageIdCodec.encodeLanguageId(e)),new Rn(r,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?Iu(i):null;if(t===0){let r=!1;if(n&&n.length>1&&(r=_o.getLanguageId(n[1])!==e),!r)return du}if(!n||n.length===0){const r=new Uint32Array(2);return r[0]=t,r[1]=Xj(e),r.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=nD(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,r){const o=Jv._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=o,r?!Jv._equals(a,o):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=Iu(e),n=Iu(t);if(i.length!==n.length)return!1;for(let r=0,o=i.length;r<o;r++)if(i[r]!==n[r])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new J(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=jl.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=jl.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=jl.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=jl.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=jl.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=jl.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=jl.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];let a=0,l=0,c=!1;for(let h=o.startLineNumber;h<=o.endLineNumber;h++)c?(this.setTokens(t.getLanguageId(),h-1,t.getLineLength(h),o.getLineTokens(h),!1),l=h):this.setTokens(t.getLanguageId(),h-1,t.getLineLength(h),o.getLineTokens(h),!0)&&(c=!0,a=h,l=h);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function Xj(s){return(s<<0|0|0|32768|2<<24|1024)>>>0}class K2e extends Lee{constructor(e,t,i,n){super(e,t),this.getLanguageId=i,this._tokenizer=null,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new Z),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new Yn),this._tokens=new Jv(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new Yn),this._attachedViewStates=this._register(new A6),this._register(hn.onDidChange(r=>{const o=this.getLanguageId();r.changedLanguages.indexOf(o)!==-1&&this.todo_resetTokenization()})),this.todo_resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:r,state:o})=>{if(o){let a=this._attachedViewStates.get(r);a||(a=new y2e(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(o)}else this._attachedViewStates.deleteAndDispose(r)}))}todo_resetTokenization(e=!0){var r;this._tokens.flush(),(r=this._debugBackgroundTokens)==null||r.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new Q5(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const o=hn.get(this.getLanguageId());if(!o)return[null,null];let a;try{a=o.getInitialState()}catch(l){return $t(l),[null,null]}return[o,a]},[i,n]=t();if(i&&n?this._tokenizer=new A2e(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const o={setTokens:a=>{this.setTokens(a)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const a=2;this._backgroundTokenizationState=a,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(a,l)=>{var h;if(!this._tokenizer)return;const c=this._tokenizer.store.getFirstInvalidEndStateLineNumber();c!==null&&a>=c&&((h=this._tokenizer)==null||h.store.setEndState(a,l))}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new P2e(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i!=null&&i.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new Jv(this._languageIdCodec),this._debugBackgroundStates=new Q5(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:a=>{var l;(l=this._debugBackgroundTokens)==null||l.setMultilineTokens(a,this._textModel)},backgroundTokenizationFinished(){},setEndState:(a,l)=>{var c;(c=this._debugBackgroundStates)==null||c.setEndState(a,l)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var e;(e=this._defaultBackgroundTokenizer)==null||e.handleChanges()}handleDidChangeContent(e){var t,i,n;if(e.isFlush)this.todo_resetTokenization(!1);else if(!e.isEolChange){for(const r of e.changes){const[o,a]=M1(r.text);this._tokens.acceptEdit(r.range,o,a),(t=this._debugBackgroundTokens)==null||t.acceptEdit(r.range,o,a)}(i=this._debugBackgroundStates)==null||i.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),(n=this._defaultBackgroundTokenizer)==null||n.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=Qe.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){var o,a;if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const i=new Y5,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),r=this.setTokens(i.finalize());if(n)for(const l of r.changes)(o=this._backgroundTokenizer.value)==null||o.requestTokens(l.fromLineNumber,l.toLineNumber+1);(a=this._defaultBackgroundTokenizer)==null||a.checkFinished()}forceTokenization(e){var i,n;const t=new Y5;(i=this._tokenizer)==null||i.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),(n=this._defaultBackgroundTokenizer)==null||n.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){var n;const t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const r=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(r)&&((n=this._debugBackgroundTokenizer.value)!=null&&n.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const n=this._textModel.validatePosition(new J(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLinesAt(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLinesAt(e,t)):null}get hasTokens(){return this._tokens.hasTokens}}var Y2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ax=function(s,e){return function(t,i){e(t,i,s)}},tL;let J5=tL=class extends YJ{constructor(e,t,i,n,r,o,a,l){super(),this._textModel=e,this._bracketPairsTextModelPart=t,this._languageId=i,this._attachedViews=n,this._languageService=r,this._languageConfigurationService=o,this._instantiationService=a,this._treeSitterLibraryService=l,this._languageIdObs=lt(this,this._languageId),this._useTreeSitter=We(this,h=>{const d=this._languageIdObs.read(h);return this._treeSitterLibraryService.supportsLanguage(d,h)}),this.tokens=We(this,h=>{let d;return this._useTreeSitter.read(h)?d=h.store.add(this._instantiationService.createInstance(Z5,this._languageIdObs,this._languageService.languageIdCodec,this._textModel,this._attachedViews.visibleLineRanges)):d=h.store.add(new K2e(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews)),h.store.add(d.onDidChangeTokens(g=>{this._emitModelTokensChangedEvent(g)})),h.store.add(d.onDidChangeBackgroundTokenizationState(g=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),d});let c=!1;this.tokens.recomputeInitiallyAndOnChange(this._store,h=>{c&&h.todo_resetTokenization(),c=!0}),this._semanticTokens=new r8(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new Z),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new Z),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new Z),this.onDidChangeTokens=this._onDidChangeTokens.event}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,n,r]=M1(t.text);this._semanticTokens.acceptEdit(t.range,i,n,r,t.text.length>0?t.text.charCodeAt(0):0)}this.tokens.get().handleDidChangeContent(e)}handleDidChangeAttached(){this.tokens.get().handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this.tokens.get().getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new $e("Illegal value for lineNumber")}get hasTokens(){return this.tokens.get().hasTokens}resetTokenization(){this.tokens.get().todo_resetTokenization()}get backgroundTokenizationState(){return this.tokens.get().backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this.tokens.get().forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this.tokens.get().hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this.tokens.get().isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this.tokens.get().tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this.tokens.get().getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLinesAt(e,t){return this.tokens.get().tokenizeLinesAt(e,t)}setSemanticTokens(e,t){this._semanticTokens.set(e,t,this._textModel),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),n=this.getLineTokens(t.lineNumber),r=n.findTokenIndexAtOffset(t.column-1),[o,a]=tL._findLanguageBoundaries(n,r),l=Cv(t.column,this.getLanguageConfiguration(n.getLanguageId(r)).getWordDefinition(),i.substring(o,a),o);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(r>0&&o===t.column-1){const[c,h]=tL._findLanguageBoundaries(n,r-1),d=Cv(t.column,this.getLanguageConfiguration(n.getLanguageId(r-1)).getWordDefinition(),i.substring(c,h),c);if(d&&d.startColumn<=e.column&&e.column<=d.endColumn)return d}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let o=t;o>=0&&e.getLanguageId(o)===i;o--)n=e.getStartOffset(o);let r=e.getLineContent().length;for(let o=t,a=e.getCount();o<a&&e.getLanguageId(o)===i;o++)r=e.getEndOffset(o);return[n,r]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new J(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._languageIdObs.set(e,void 0),this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};J5=tL=Y2e([ax(4,Qn),ax(5,kc),ax(6,It),ax(7,s8)],J5);const o8=gt("undoRedoService");class Tee{constructor(e,t){this.resource=e,this.elements=t}}const y_=class y_{constructor(){this.id=y_._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};y_._ID=0,y_.None=new y_;let eO=y_;const S_=class S_{constructor(){this.id=S_._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};S_._ID=0,S_.None=new S_;let $f=S_;var Zj;function Q2e(s,e){const t=[],i=[];for(const n of s)e.has(n)||t.push(n);for(const n of e)s.has(n)||i.push(n);return{removed:t,added:i}}function Nee(s,e){const t=new Set;for(const i of e)s.has(i)&&t.add(i);return t}class Jj{constructor(e,t){this.toKey=t,this._map=new Map,this[Zj]="SetWithKey";for(const i of e)this.add(i)}get size(){return this._map.size}add(e){const t=this.toKey(e);return this._map.set(t,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(const e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,t){this._map.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}}Zj=Symbol.toStringTag;var X2e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lx=function(s,e){return function(t,i){e(t,i,s)}},Ef;function Z2e(s){const e=new xee;return e.acceptChunk(s),e.finish()}function J2e(s){const e=new xee;let t;for(;typeof(t=s.read())=="string";)e.acceptChunk(t);return e.finish()}function e$(s,e){let t;return typeof s=="string"?t=Z2e(s):I0e(s)?t=J2e(s):t=s,t.create(e)}let cx=0;const eEe=999,tEe=1e4,iEe=300;class nEe{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}}const g0=()=>{throw new Error("Invalid change accessor")};var ol;let tO=(ol=class extends le{static resolveOptions(e,t){if(t.detectIndentation){const i=Pj(e,t.tabSize,t.insertSpaces);return new qx({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new qx(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}get onDidChangeOptions(){return this._onDidChangeOptions.event}get onDidChangeAttached(){return this._onDidChangeAttached.event}get onDidChangeLineHeight(){return this._onDidChangeLineHeight.event}get onDidChangeFont(){return this._onDidChangeFont.event}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return nc(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,n=null,r,o,a,l){super(),this._undoRedoService=r,this._languageService=o,this._languageConfigurationService=a,this.instantiationService=l,this._onWillDispose=this._register(new Z),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new cEe((_,b,C)=>this.handleBeforeFireDecorationsChangedEvent(_,b,C))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new Z),this._onDidChangeAttached=this._register(new Z),this._onDidChangeInjectedText=this._register(new Z),this._onDidChangeLineHeight=this._register(new Z),this._onDidChangeFont=this._register(new Z),this._eventEmitter=this._register(new uEe),this._languageSelectionListener=this._register(new Yn),this._deltaDecorationCallCnt=0,this._attachedViews=new w2e,cx++,this.id="$model"+cx,this.isForSimpleWidget=i.isForSimpleWidget,typeof n>"u"||n===null?this._associatedResource=mt.parse("inmemory://model/"+cx):this._associatedResource=n,this._attachedEditorCount=0;const{textBuffer:c,disposable:h}=e$(e,i.defaultEOL);this._buffer=c,this._bufferDisposable=h;const d=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new G(1,1,d,this._buffer.getLineLength(d)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>Ef.LARGE_FILE_SIZE_THRESHOLD||d>Ef.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>Ef.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._options=Ef.resolveOptions(this._buffer,i);const p=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new $ke(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new Rxe(this,this._languageConfigurationService)),this._decorationProvider=this._register(new Gke(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(J5,this,this._bracketPairs,p,this._attachedViews),this._isTooLargeForSyncing=g>Ef._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=BX(cx),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new t$,this._commandManager=new e8(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(_=>{this._bracketPairs.handleLanguageConfigurationServiceChange(_),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(_)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new K_([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=le.None}_assertNotDisposed(){if(this._isDisposed)throw new $e("Model is disposed!")}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new Dg(e,t)))}setValue(e,t=Ko.setValue()){if(this._assertNotDisposed(),e==null)throw sD();const{textBuffer:i,disposable:n}=e$(e,this._options.defaultEOL);this._setValueFromTextBuffer(i,n,t)}_createContentChanged2(e,t,i,n,r,o,a,l,c,h){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:c,versionId:this.getVersionId(),isUndoing:o,isRedoing:a,isFlush:l,detailedReasons:[h],detailedReasonsChangeLengths:[1]}}_setValueFromTextBuffer(e,t,i){this._assertNotDisposed();const n=this.getFullModelRange(),r=this.getValueLengthInRange(n),o=this.getLineCount(),a=this.getLineMaxColumn(o);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new t$,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new $_([new hke],this._versionId,!1,!1),this._createContentChanged2(new G(1,1,o,a),0,r,new J(o,a),this.getValue(),!1,!1,!0,!1,i))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new $_([new pke],this._versionId,!1,!1),this._createContentChanged2(new G(1,1,r,o),0,n,new J(r,o),this.getValue(),!1,!1,!1,!0,Ko.eolChange()))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const r=t[i],o=r.range,a=r.cachedAbsoluteStart-r.start,l=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),c=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);r.cachedAbsoluteStart=l,r.cachedAbsoluteEnd=c,r.cachedVersionId=e,r.start=l-a,r.end=c-a,Pd(r)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const r=this._buffer.getLineLength(n);r>=tEe?t+=r:e+=r}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,n=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,r=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new qx({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:r,bracketPairColorizationOptions:o});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=Pj(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),EJ(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(PX.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new $e("Operation would exceed heap memory limits");const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new nEe(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new $e("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let r=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),o=Math.floor(typeof n=="number"&&!isNaN(n)?n:1);if(r<1)r=1,o=1;else if(r>t)r=t,o=this.getLineMaxColumn(r);else if(o<=1)o=1;else{const d=this.getLineMaxColumn(r);o>=d&&(o=d)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),h=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,h=1;else if(c>t)c=t,h=this.getLineMaxColumn(c);else if(h<=1)h=1;else{const d=this.getLineMaxColumn(c);h>=d&&(h=d)}return i===r&&n===o&&a===c&&l===h&&e instanceof G&&!(e instanceof Lt)?e:new G(r,o,c,h)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const n=this._buffer.getLineCount();if(e>n)return!1;if(t===1)return!0;const r=this.getLineMaxColumn(e);if(t>r)return!1;if(i===1){const o=this._buffer.getLineCharCode(e,t-2);if(Tn(o))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),o=this._buffer.getLineCount();if(n<1)return new J(1,1);if(n>o)return new J(o,this.getLineMaxColumn(o));if(r<=1)return new J(n,1);const a=this.getLineMaxColumn(n);if(r>=a)return new J(n,a);if(i===1){const l=this._buffer.getLineCharCode(n,r-2);if(Tn(l))return new J(n,r-1)}return new J(n,r)}validatePosition(e){return this._assertNotDisposed(),e instanceof J&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}isValidRange(e){return this._isValidRange(e,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(i,n,0)||!this._isValidPosition(r,o,0))return!1;if(t===1){const a=n>1?this._buffer.getLineCharCode(i,n-2):0,l=o>1&&o<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,o-2):0,c=Tn(a),h=Tn(l);return!c&&!h}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof G&&!(e instanceof Lt)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),r=i.lineNumber,o=i.column,a=n.lineNumber,l=n.column;{const c=o>1?this._buffer.getLineCharCode(r,o-2):0,h=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,d=Tn(c),g=Tn(h);return!d&&!g?new G(r,o,a,l):r===a&&o===l?new G(r,o-1,a,l-1):d&&g?new G(r,o-1,a,l+1):d?new G(r,o-1,a,l):new G(r,o,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new G(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,r,o,a=eEe){this._assertNotDisposed();let l=null;t!==null&&typeof t!="boolean"&&(Array.isArray(t)||(t=[t]),t.every(d=>G.isIRange(d))&&(l=t.map(d=>this.validateRange(d)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((d,g)=>d.startLineNumber-g.startLineNumber||d.startColumn-g.startColumn);const c=[];c.push(l.reduce((d,g)=>G.areIntersecting(d,g)?d.plusRange(g):(c.push(d),g)));let h;if(!i&&e.indexOf(`
`)<0){const g=new Np(e,i,n,r).parseSearchRequest();if(!g)return[];h=p=>this.findMatchesLineByLine(p,g,o,a)}else h=d=>KS.findMatches(this,new Np(e,i,n,r),d,o,a);return c.map(h).reduce((d,g)=>d.concat(g),[])}findNextMatch(e,t,i,n,r,o){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new Np(e,i,n,r).parseSearchRequest();if(!c)return null;const h=this.getLineCount();let d=new G(a.lineNumber,a.column,h,this.getLineMaxColumn(h)),g=this.findMatchesLineByLine(d,c,o,1);return KS.findNextMatch(this,new Np(e,i,n,r),a,o),g.length>0||(d=new G(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),g=this.findMatchesLineByLine(d,c,o,1),g.length>0)?g[0]:null}return KS.findNextMatch(this,new Np(e,i,n,r),a,o)}findPreviousMatch(e,t,i,n,r,o){this._assertNotDisposed();const a=this.validatePosition(t);return KS.findPreviousMatch(this,new Np(e,i,n,r),a,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof vR?e:new vR(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,n,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,n,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,n,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const o=t.map(l=>({range:this.validateRange(l.range),text:l.text}));let a=!0;if(e)for(let l=0,c=e.length;l<c;l++){const h=e[l];let d=!1;for(let g=0,p=o.length;g<p;g++){const _=o[g].range,b=_.startLineNumber>h.endLineNumber,C=h.startLineNumber>_.endLineNumber;if(!b&&!C){d=!0;break}}if(!d){a=!1;break}}if(a)for(let l=0,c=this._trimAutoWhitespaceLines.length;l<c;l++){const h=this._trimAutoWhitespaceLines[l],d=this.getLineMaxColumn(h);let g=!0;for(let p=0,_=o.length;p<_;p++){const b=o[p].range,C=o[p].text;if(!(h<b.startLineNumber||h>b.endLineNumber)&&!(h===b.startLineNumber&&b.startColumn===d&&b.isEmpty()&&C&&C.length>0&&C.charAt(0)===`
`)&&!(h===b.startLineNumber&&b.startColumn===1&&b.isEmpty()&&C&&C.length>0&&C.charAt(C.length-1)===`
`)){g=!1;break}}if(g){const p=new G(h,1,h,d);t.push(new vR(null,p,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,n,r)}_applyUndo(e,t,i,n){const r=e.map(o=>{const a=this.getPositionAt(o.newPosition),l=this.getPositionAt(o.newEnd);return{range:new G(a.lineNumber,a.column,l.lineNumber,l.column),text:o.oldText}});this._applyUndoRedoEdits(r,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const r=e.map(o=>{const a=this.getPositionAt(o.oldPosition),l=this.getPositionAt(o.oldEnd);return{range:new G(a.lineNumber,a.column,l.lineNumber,l.column),text:o.newText}});this._applyUndoRedoEdits(r,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,r,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(r)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t,i){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const n=this._validateEditOperations(e);return this._doApplyEdits(n,t??!1,i??Ko.applyEdits())}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t,i){const n=this._buffer.getLineCount(),r=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),o=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let h=0,d=a.length;h<d;h++){const g=a[h];this._decorationsTree.acceptReplace(g.rangeOffset,g.rangeLength,g.text.length,g.forceMoveMarkers)}const l=[];this._increaseVersionId();let c=n;for(let h=0,d=a.length;h<d;h++){const g=a[h],[p]=M1(g.text);this._onDidChangeDecorations.fire();const _=g.range.startLineNumber,b=g.range.endLineNumber,C=b-_,x=p,S=Math.min(C,x),y=x-C,k=o-c-y+_,D=k,R=k+x,N=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new J(D,1)),this.getOffsetAt(new J(R,this.getLineMaxColumn(R))),0),A=vl.fromDecorations(N),M=new eh(A);for(let O=S;O>=0;O--){const V=_+O,H=k+O;M.takeFromEndWhile(X=>X.lineNumber>H);const U=M.takeFromEndWhile(X=>X.lineNumber===H);l.push(new Dj(V,this.getLineContent(H),U))}if(S<C){const O=_+S;l.push(new gke(O+1,b))}if(S<x){const O=new eh(A),V=_+S,H=x-S,U=o-c-H+V+1,X=[],Y=[];for(let q=0;q<H;q++){const ee=U+q;Y[q]=this.getLineContent(ee),O.takeWhile(ue=>ue.lineNumber<ee),X[q]=O.takeWhile(ue=>ue.lineNumber===ee)}l.push(new mke(V+1,_+x,Y,X))}c+=y}this._emitContentChangedEvent(new $_(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1,detailedReasons:[i],detailedReasonsChangeLengths:[a.length]})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e,t,i){if(e&&e.size>0){const r=Array.from(e).map(o=>new Dj(o,this.getLineContent(o),this._getInjectedTextInLine(o)));this._onDidChangeInjectedText.fire(new oee(r))}if(t&&t.size>0){const r=Array.from(t).map(o=>new dke(o.ownerId,o.decorationId,o.lineNumber,o.lineHeight));this._onDidChangeLineHeight.fire(new aee(r))}if(i&&i.size>0){const r=Array.from(i).map(o=>new fke(o.ownerId,o.lineNumber));this._onDidChangeFont.fire(new lee(r))}}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(r,o)=>this._deltaDecorationsImpl(e,[],[{range:r,options:o}])[0],changeDecoration:(r,o)=>{this._changeDecorationImpl(e,r,o)},changeDecorationOptions:(r,o)=>{this._changeDecorationOptionsImpl(e,r,n$(o))},removeDecoration:r=>{this._deltaDecorationsImpl(e,[r],[])},deltaDecorations:(r,o)=>r.length===0&&o.length===0?[]:this._deltaDecorationsImpl(e,r,o)};let n=null;try{n=t(i)}catch(r){$t(r)}return i.addDecoration=g0,i.changeDecoration=g0,i.changeDecorationOptions=g0,i.removeDecoration=g0,i.deltaDecorations=g0,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),$t(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:i$[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const r=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),o,a,r),n.setOptions(i$[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const r=t[i];this._decorationsTree.delete(r),delete this._decorations[r.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i,n)}getLinesDecorations(e,t,i=0,n=!1,r=!1,o=!1){const a=this.getLineCount(),l=Math.min(a,Math.max(1,e)),c=Math.min(a,Math.max(1,t)),h=this.getLineMaxColumn(c),d=new G(l,1,c,h),g=this._getDecorationsInRange(d,i,n,r,o);return sM(g,this._decorationProvider.getDecorationsInRange(d,i,n)),g}getDecorationsInRange(e,t=0,i=!1,n=!1,r=!1,o=!1){const a=this.validateRange(e),l=this._getDecorationsInRange(a,t,i,n,o);return sM(l,this._decorationProvider.getDecorationsInRange(a,t,i,r)),l}getOverviewRulerDecorations(e=0,t=!1,i=!1){return this._decorationsTree.getAll(this,e,t,i,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}getCustomLineHeightsDecorations(e=0){return this._decorationsTree.getAllCustomLineHeights(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return vl.fromDecorations(n).filter(r=>r.lineNumber===e)}getFontDecorationsInRange(e,t=0){const i=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),n=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getFontDecorationsInInterval(this,i,n,t)}getAllDecorations(e=0,t=!1,i=!1){let n=this._decorationsTree.getAll(this,e,t,i,!1,!1);return n=n.concat(this._decorationProvider.getAllDecorations(e,t)),n}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!1,!0)}_getDecorationsInRange(e,t,i,n,r){const o=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),a=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,o,a,t,i,n,r)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t,i){const n=this._decorations[t];if(!n)return;if(n.options.after){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(n.options.before){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}if(n.options.lineHeight!==null){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,l.startLineNumber,null)}if(n.options.affectsFont){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,n.id,l.startLineNumber)}const r=this._validateRangeRelaxedNoAllocations(i),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),o,a,r),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber),n.options.lineHeight!==null&&this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,r.startLineNumber,n.options.lineHeight),n.options.affectsFont&&this._onDidChangeDecorations.recordLineAffectedByFontChange(e,n.id,r.startLineNumber)}_changeDecorationOptionsImpl(e,t,i){const n=this._decorations[t];if(!n)return;const r=!!(n.options.overviewRuler&&n.options.overviewRuler.color),o=!!(i.overviewRuler&&i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(i),n.options.after||i.after){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(c.endLineNumber)}if(n.options.before||i.before){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(c.startLineNumber)}if(n.options.lineHeight!==null||i.lineHeight!==null){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,c.startLineNumber,i.lineHeight)}if(n.options.affectsFont||i.affectsFont){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,t,c.startLineNumber)}const a=r!==o,l=rEe(i)!==iL(n);a||l?(this._decorationsTree.delete(n),n.setOptions(i),this._decorationsTree.insert(n)):n.setOptions(i)}_deltaDecorationsImpl(e,t,i,n=!1){const r=this.getVersionId(),o=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const h=new Array(l);for(;a<o||c<l;){let d=null;if(a<o){let g;do g=t[a++],d=this._decorations[g];while(!d&&a<o);if(d){if(d.options.after){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.endLineNumber)}if(d.options.before){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.startLineNumber)}if(d.options.lineHeight!==null){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,g,p.startLineNumber,null)}if(d.options.affectsFont){const p=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,g,p.startLineNumber)}this._decorationsTree.delete(d),n||this._onDidChangeDecorations.checkAffectedAndFire(d.options)}}if(c<l){if(!d){const x=++this._lastDecorationId,S=`${this._instanceId};${x}`;d=new vee(S,0,0),this._decorations[S]=d}const g=i[c],p=this._validateRangeRelaxedNoAllocations(g.range),_=n$(g.options),b=this._buffer.getOffsetAt(p.startLineNumber,p.startColumn),C=this._buffer.getOffsetAt(p.endLineNumber,p.endColumn);d.ownerId=e,d.reset(r,b,C,p),d.setOptions(_),d.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.endLineNumber),d.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(p.startLineNumber),d.options.lineHeight!==null&&this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,d.id,p.startLineNumber,d.options.lineHeight),d.options.affectsFont&&this._onDidChangeDecorations.recordLineAffectedByFontChange(e,d.id,p.startLineNumber),n||this._onDidChangeDecorations.checkAffectedAndFire(_),this._decorationsTree.insert(d),h[c]=d.id,c++}else d&&delete this._decorations[d.id]}return h}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return sEe(this.getLineContent(e))+1}toString(){return`TextModel(${this.uri.toString()})`}},Ef=ol,ol._MODEL_SYNC_LIMIT=50*1024*1024,ol.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024,ol.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3,ol.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024,ol.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:_s.tabSize,indentSize:_s.indentSize,insertSpaces:_s.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:_s.trimAutoWhitespace,largeFileOptimizations:_s.largeFileOptimizations,bracketPairColorizationOptions:_s.bracketPairColorizationOptions},ol);tO=Ef=X2e([lx(4,o8),lx(5,Qn),lx(6,kc),lx(7,It)],tO);function sEe(s){let e=0;for(const t of s)if(t===" "||t==="	")e++;else break;return e}function jR(s){return!!(s.options.overviewRuler&&s.options.overviewRuler.color)}function rEe(s){return!!s.after||!!s.before}function iL(s){return!!s.options.after||!!s.options.before}class t${constructor(){this._decorationsTree0=new WR,this._decorationsTree1=new WR,this._injectedTextDecorationsTree=new WR}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,r,o,a){const l=e.getVersionId(),c=this._intervalSearch(t,i,n,r,o,l,a);return this._ensureNodesHaveRanges(e,c)}_intervalSearch(e,t,i,n,r,o,a){const l=this._decorationsTree0.intervalSearch(e,t,i,n,r,o,a),c=this._decorationsTree1.intervalSearch(e,t,i,n,r,o,a),h=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,r,o,a);return l.concat(c).concat(h)}getInjectedTextInInterval(e,t,i,n){const r=e.getVersionId(),o=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,!1,r,!1);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getFontDecorationsInInterval(e,t,i,n){const r=e.getVersionId(),o=this._decorationsTree0.intervalSearch(t,i,n,!1,!1,r,!1);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.affectsFont)}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAllCustomLineHeights(e,t){const i=e.getVersionId(),n=this._search(t,!1,!1,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(r=>typeof r.options.lineHeight=="number")}getAll(e,t,i,n,r,o){const a=e.getVersionId(),l=this._search(t,i,n,r,a,o);return this._ensureNodesHaveRanges(e,l)}_search(e,t,i,n,r,o){if(n)return this._decorationsTree1.search(e,t,i,r,o);{const a=this._decorationsTree0.search(e,t,i,r,o),l=this._decorationsTree1.search(e,t,i,r,o),c=this._injectedTextDecorationsTree.search(e,t,i,r,o);return a.concat(l).concat(c)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){iL(e)?this._injectedTextDecorationsTree.insert(e):jR(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){iL(e)?this._injectedTextDecorationsTree.delete(e):jR(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){iL(e)?this._injectedTextDecorationsTree.resolveNode(e,t):jR(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function Rl(s){return s.replace(/[^a-z0-9\-_]/gi," ")}class Iee{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class oEe extends Iee{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:mk.Center}getColor(e){return this._resolvedColor||(Rm(e.type)&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class aEe{constructor(e){this.position=(e==null?void 0:e.position)??Rd.Center,this.persistLane=e==null?void 0:e.persistLane}}class lEe extends Iee{constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(Rm(e.type)&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?me.fromHex(e):t.getColor(e.id)}}class eC{static from(e){return e instanceof eC?e:new eC(e)}constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class Nn{static register(e){return new Nn(e)}static createDynamic(e){return new Nn(e)}constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?Rl(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Rl(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.lineHeight=e.lineHeight?Math.min(e.lineHeight,iEe):null,this.fontSize=e.fontSize||null,this.affectsFont=!!e.fontSize||!!e.fontFamily||!!e.fontWeight||!!e.fontStyle,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new oEe(e.overviewRuler):null,this.minimap=e.minimap?new lEe(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new aEe(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?Rl(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Rl(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?Rl(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?o_e(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Rl(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Rl(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Rl(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Rl(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Rl(e.afterContentClassName):null,this.after=e.after?eC.from(e.after):null,this.before=e.before?eC.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1,this.textDirection=e.textDirection??null}}Nn.EMPTY=Nn.register({description:"empty"});const i$=[Nn.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Nn.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Nn.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Nn.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function n$(s){return s instanceof Nn?s:Nn.createDynamic(s)}class s${static toKey(e){return`${e.ownerId};${e.decorationId};${e.lineNumber}`}constructor(e,t,i,n){this.ownerId=e,this.decorationId=t,this.lineNumber=i,this.lineHeight=n}}class r${static toKey(e){return`${e.ownerId};${e.decorationId};${e.lineNumber}`}constructor(e,t,i){this.ownerId=e,this.decorationId=t,this.lineNumber=i}}class cEe extends le{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new Z),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._affectedLineHeights=null,this._affectedFontLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e,t,i;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(e=this._affectedInjectedTextLines)==null||e.clear(),this._affectedInjectedTextLines=null,(t=this._affectedLineHeights)==null||t.clear(),this._affectedLineHeights=null,(i=this._affectedFontLines)==null||i.clear(),this._affectedFontLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}recordLineAffectedByLineHeightChange(e,t,i,n){this._affectedLineHeights||(this._affectedLineHeights=new Jj([],s$.toKey)),this._affectedLineHeights.add(new s$(e,t,i,n))}recordLineAffectedByFontChange(e,t,i){this._affectedFontLines||(this._affectedFontLines=new Jj([],r$.toKey)),this._affectedFontLines.add(new r$(e,t,i))}checkAffectedAndFire(e){var t,i;this._affectsMinimap||(this._affectsMinimap=!!((t=e.minimap)!=null&&t.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!((i=e.overviewRuler)!=null&&i.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!e.glyphMarginClassName),this._affectsLineNumber||(this._affectsLineNumber=!!e.lineNumberClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines,this._affectedLineHeights,this._affectedFontLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class uEe extends le{constructor(){super(),this._fastEmitter=this._register(new Z),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new Z),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}class a8{static create(e){return new a8(e.get(151),e.get(150))}constructor(e,t){this.classifier=new hEe(e,t)}createLineBreaksComputer(e,t,i,n,r,o){const a=[],l=[],c=[];return{addRequest:(h,d,g)=>{a.push(h),l.push(d),c.push(g)},finalize:()=>{const h=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,d=[];for(let g=0,p=a.length;g<p;g++){const _=l[g],b=c[g],C=a[g],x=o&&C.includes('"')&&C.includes("\\n");b&&!b.injectionOptions&&!_&&!x?d[g]=dEe(this.classifier,b,C,t,i,h,n,r):d[g]=fEe(this.classifier,C,_,t,i,h,n,r,x)}return iO.length=0,nO.length=0,d}}}}class hEe extends GC{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let iO=[],nO=[];function dEe(s,e,t,i,n,r,o,a){if(n===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",h=e.breakOffsets,d=e.breakOffsetsVisibleColumn,g=Ree(t,i,n,r,o),p=n-g,_=iO,b=nO;let C=0,x=0,S=0,y=n;const k=h.length;let D=0;if(D>=0){let R=Math.abs(d[D]-y);for(;D+1<k;){const N=Math.abs(d[D+1]-y);if(N>=R)break;R=N,D++}}for(;D<k;){let R=D<0?0:h[D],N=D<0?0:d[D];x>R&&(R=x,N=S);let A=0,M=0,O=0,V=0;if(N<=y){let U=N,X=R===0?0:t.charCodeAt(R-1),Y=R===0?0:s.get(X),q=!0;for(let ee=R;ee<l;ee++){const ue=ee,oe=t.charCodeAt(ee);let Ee,$;if(Tn(oe)?(ee++,Ee=0,$=2):(Ee=s.get(oe),$=gw(oe,U,i,r)),ue>x&&sO(X,Y,oe,Ee,c)&&(A=ue,M=U),U+=$,U>y){ue>x?(O=ue,V=U-$):(O=ee+1,V=U),U-M>p&&(A=0),q=!1;break}X=oe,Y=Ee}if(q){C>0&&(_[C]=h[h.length-1],b[C]=d[h.length-1],C++);break}}if(A===0){let U=N,X=t.charCodeAt(R),Y=s.get(X),q=!1;for(let ee=R-1;ee>=x;ee--){const ue=ee+1,oe=t.charCodeAt(ee);if(oe===9){q=!0;break}let Ee,$;if(im(oe)?(ee--,Ee=0,$=2):(Ee=s.get(oe),$=ih(oe)?r:1),U<=y){if(O===0&&(O=ue,V=U),U<=y-p)break;if(sO(oe,Ee,X,Y,c)){A=ue,M=U;break}}U-=$,X=oe,Y=Ee}if(A!==0){const ee=p-(V-M);if(ee<=i){const ue=t.charCodeAt(O);let oe;Tn(ue)?oe=2:oe=gw(ue,V,i,r),ee-oe<0&&(A=0)}}if(q){D--;continue}}if(A===0&&(A=O,M=V),A<=x){const U=t.charCodeAt(x);Tn(U)?(A=x+2,M=S+2):(A=x+1,M=S+gw(U,S,i,r))}for(x=A,_[C]=A,S=M,b[C]=M,C++,y=M+p;D<0||D<k&&d[D]<M;)D++;let H=Math.abs(d[D]-y);for(;D+1<k;){const U=Math.abs(d[D+1]-y);if(U>=H)break;H=U,D++}}return C===0?null:(_.length=C,b.length=C,iO=e.breakOffsets,nO=e.breakOffsetsVisibleColumn,e.breakOffsets=_,e.breakOffsetsVisibleColumn=b,e.wrappedTextIndentLength=g,e)}function fEe(s,e,t,i,n,r,o,a,l){const c=vl.applyInjectedText(e,t);let h,d;if(t&&t.length>0?(h=t.map(O=>O.options),d=t.map(O=>O.column-1)):(h=null,d=null),n===-1)return h?new lw(d,h,[c.length],[],0):null;const g=c.length;if(g<=1)return h?new lw(d,h,[c.length],[],0):null;const p=a==="keepAll",_=Ree(c,i,n,r,o),b=n-_,C=[],x=[];let S=0,y=0,k=0,D=n,R=c.charCodeAt(0),N=s.get(R),A=gw(R,0,i,r),M=1;Tn(R)&&(A+=1,R=c.charCodeAt(1),N=s.get(R),M++);for(let O=M;O<g;O++){const V=O,H=c.charCodeAt(O);let U,X,Y=!1;Tn(H)?(O++,U=0,X=2):(U=s.get(H),X=gw(H,A,i,r)),l&&gEe(c,O)?(y=V,k=A,Y=!0):sO(R,N,H,U,p)&&(y=V,k=A),A+=X,(A>D||Y)&&((y===0||A-k>b)&&(y=V,k=A-X),C[S]=y,x[S]=k,S++,D=k+b,y=0),R=H,N=U}return S===0&&(!t||t.length===0)?null:(C[S]=g,x[S]=A,new lw(d,h,C,x,_))}function gw(s,e,t,i){return s===9?t-e%t:ih(s)||s<32?i:1}function o$(s,e){return e-s%e}function gEe(s,e){if(e>=2&&s.charAt(e-1)==="n"){let t=0;for(let i=e-2;i>=0;i--)if(s.charAt(i)==="\\")t++;else return t%2===1}return!1}function sO(s,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function Ree(s,e,t,i,n){let r=0;if(n!==0){const o=qr(s);if(o!==-1){for(let l=0;l<o;l++){const c=s.charCodeAt(l)===9?o$(r,e):1;r+=c}const a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){const c=o$(r,e);r+=c}r+i>t&&(r=0)}}return r}class Zk{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new es(new G(1,1,1,1),0,0,new J(1,1),0),new es(new G(1,1,1,1),0,0,new J(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new wt(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?Lt.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):Lt.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),o=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,o),l=this._validatePositionWithCache(e,r,n,a);return i.equals(o)&&n.equals(a)&&r.equals(l)?t:new es(G.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,o,t.leftoverVisibleColumns+i.column-o.column)}_setState(e,t,i){if(i&&(i=Zk._validateViewState(e.viewModel,i)),t){const n=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,o=e.model.validatePosition(t.position),a=t.position.equals(o)?t.leftoverVisibleColumns:0;t=new es(n,t.selectionStartKind,r,o,a)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new es(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,r,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new es(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new J(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new J(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),o=new G(n.lineNumber,n.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new es(o,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class a${constructor(e){this.context=e,this.cursors=[new Zk(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return U0e(this.cursors,Do(e=>e.viewState.position,J.compare)).viewState.position}getBottomMostViewPosition(){return z0e(this.cursors,Do(e=>e.viewState.position,J.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(wt.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const n=i-t;for(let r=0;r<n;r++)this._addSecondaryCursor()}else if(t>i){const n=t-i;for(let r=0;r<n;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Zk(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(Do(i=>i.selection,G.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1],o=n.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||o.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(o.getEndPosition()):l=a.getStartPosition().isBefore(o.getEndPosition()),l){const c=n.index<r.index?i:i+1,h=n.index<r.index?i+1:i,d=t[h].index,g=t[c].index,p=t[h].selection,_=t[c].selection;if(!p.equalsSelection(_)){const b=p.plusRange(_),C=p.selectionStartLineNumber===p.startLineNumber&&p.selectionStartColumn===p.startColumn,x=_.selectionStartLineNumber===_.startLineNumber&&_.selectionStartColumn===_.startColumn;let S;d===this.lastAddedCursorIndex?(S=C,this.lastAddedCursorIndex=g):S=x;let y;S?y=new Lt(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):y=new Lt(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn),t[c].selection=y;const k=wt.fromModelSelection(y);e[g].setState(this.context,k.modelState,k.viewState)}for(const b of t)b.index>d&&b.index--;e.splice(d,1),t.splice(h,1),this._removeSecondaryCursor(d-1),i--}}}}class l${constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class mEe{constructor(){this.type=0}}class pEe{constructor(){this.type=1}}class _Ee{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class bEe{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class mf{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class ux{constructor(){this.type=5}}class wEe{constructor(e){this.type=6,this.isFocused=e}}class vEe{constructor(){this.type=7}}class hx{constructor(){this.type=8}}class Aee{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class rO{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class oO{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class mw{constructor(e,t,i,n,r,o,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=r,this.revealHorizontal=o,this.scrollType=a,this.type=12}}class CEe{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class yEe{constructor(e){this.theme=e,this.type=14}}class SEe{constructor(e){this.type=15,this.ranges=e}}class xEe{constructor(){this.type=16}}let LEe=class{constructor(){this.type=17}};class kEe extends le{constructor(){super(),this._onEvent=this._register(new Z),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new EEe),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class EEe{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class l8{constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new l8(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class jD{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new jD(this.oldHasFocus,e.hasFocus)}}class DEe{constructor(e,t){this.kind=2,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new jD(this.oldHasFocus,e.hasFocus)}}class c8{constructor(e,t,i,n,r,o,a,l){this.kind=3,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=r,this.scrollLeft=o,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new c8(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class TEe{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class NEe{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class Jk{constructor(e,t,i,n,r,o,a){this.kind=7,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=r,this.reason=o,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,n=t.length;if(i!==n)return!1;for(let r=0;r<i;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return Jk._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new Jk(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class IEe{constructor(){this.kind=6}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class REe{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class AEe{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class MEe{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class OEe{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class PEe{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class FEe{constructor(e){this.event=e,this.kind=13}isNoOp(){return!1}attemptToMerge(e){return null}}class BEe{constructor(e){this.event=e,this.kind=14}isNoOp(){return!1}attemptToMerge(e){return null}}class VEe{constructor(e){this.event=e,this.kind=15}isNoOp(){return!1}attemptToMerge(e){return null}}class HEe extends le{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new l$(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new a$(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=_n(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new l$(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let r=!1;const o=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>o&&(n=n.slice(0,o),r=!0);const a=pw.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,r,o){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=G.fromPositions(a[0],a[0]),e.emitViewEvent(new mw(t,i,l,c,n,r,o))}revealPrimary(e,t,i,n,r,o){const l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new mw(t,i,null,l,n,r,o))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const r=t[i];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];let a=1,l=1;o.position&&o.position.lineNumber&&(a=o.position.lineNumber),o.position&&o.position.column&&(l=o.position.column);let c=a,h=l;o.selectionStart&&o.selectionStart.lineNumber&&(c=o.selectionStart.lineNumber),o.selectionStart&&o.selectionStart.column&&(h=o.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:h,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,wt.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof oee){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new a$(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const r=wt.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{const r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,wt.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,wt.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const r=this._model.deltaDecorations([],i),o=this._model.deltaDecorations([],n);this._autoClosedActions.push(new c$(this._model,r,o))}_executeEditOperation(e,t){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const i=WEe.executeCommands(this._model,this._cursors.getSelections(),e.commands,t);if(i){this._interpretCommandResult(i);const n=[],r=[];for(let o=0;o<e.commands.length;o++){const a=e.commands[o];a instanceof U7&&a.enclosingRange&&a.closeCharacterRange&&(n.push(a.closeCharacterRange),r.push(a.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,r),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,r){const o=pw.from(this._model,this);if(o.equals(n))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new bEe(l,a,i)),!n||n.cursorState.length!==o.cursorState.length||o.cursorState.some((c,h)=>!c.modelState.equals(n.cursorState[h].modelState))){const c=n?n.cursorState.map(d=>d.modelState.selection):null,h=n?n.modelVersionId:0;e.emitOutgoingEvent(new Jk(c,a,h,o.modelVersionId,t||"keyboard",i,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];if(!r.text||r.text.indexOf(`
`)>=0)return null;const o=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!o)return null;const a=o[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,h=r.text.length-o[2].length-1,d=r.text.lastIndexOf(c,h-1);if(d===-1)return null;t.push([d,h])}return t}executeEdits(e,t,i,n,r){let o=null;t==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);const a=[],l=[],c=this._model.pushEditOperations(this.getSelections(),i,h=>{if(o)for(let g=0,p=o.length;g<p;g++){const[_,b]=o[g],C=h[g],x=C.range.startLineNumber,S=C.range.startColumn-1+_,y=C.range.startColumn-1+b;a.push(new G(x,y+1,x,y+2)),l.push(new G(x,S+1,x,y+2))}const d=n(h);return d&&(this._isHandling=!0),d},void 0,r);c&&(this._isHandling=!1,this.setSelections(e,t,c,0)),a.length>0&&this._pushAutoClosedAction(a,l)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const r=pw.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(o){$t(o)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,r,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return c$.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new _w(this._model,this.getSelections())}endComposition(e,t){const i=Ko.cursor({kind:"compositionEnd",detailedSource:t}),n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Wf.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()),i)},e,t)}type(e,t,i){const n=Ko.cursor({kind:"type",detailedSource:i});this._executeEdit(()=>{if(i==="keyboard"){const r=t.length;let o=0;for(;o<r;){const a=j6(t,o),l=t.substr(o,a);this._executeEditOperation(Wf.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),l),n),o+=a}}else this._executeEditOperation(Wf.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t),n)},e,i)}compositionType(e,t,i,n,r,o){const a=Ko.cursor({kind:"compositionType",detailedSource:o});if(t.length===0&&i===0&&n===0){if(r!==0){const l=this.getSelections().map(c=>{const h=c.getPosition();return new Lt(h.lineNumber,h.column+r,h.lineNumber,h.column+r)});this.setSelections(e,o,l,0)}return}this._executeEdit(()=>{this._executeEditOperation(Wf.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,r),a)},e,o)}paste(e,t,i,n,r){const o=Ko.cursor({kind:"paste",detailedSource:r});this._executeEdit(()=>{this._executeEditOperation(Wf.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]),o)},e,r,4)}cut(e,t){const i=Ko.cursor({kind:"cut",detailedSource:t});this._executeEdit(()=>{this._executeEditOperation(hm.cut(this.context.cursorConfig,this._model,this.getSelections()),i)},e,t)}executeCommand(e,t,i){const n=Ko.cursor({kind:"executeCommand",detailedSource:i});this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new gr(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}),n)},e,i)}executeCommands(e,t,i){const n=Ko.cursor({kind:"executeCommands",detailedSource:i});this._executeEdit(()=>{this._executeEditOperation(new gr(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}),n)},e,i)}}class pw{static from(e,t){return new pw(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class c${static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(G.compareRangesUsingStarts),e.sort(G.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class WEe{static executeCommands(e,t,i,n=Ko.unknown({name:"executeCommands"})){const r={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(r,i,n);for(let a=0,l=r.trackedRanges.length;a<l;a++)r.model._setTrackedRange(r.trackedRanges[a],null,0);return o}static _innerExecuteCommands(e,t,i){if(this._arrayIsEmpty(t))return null;const n=this._getEditOperations(e,t);if(n.operations.length===0)return null;const r=n.operations,o=this._getLoserCursorMap(r);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const a=[];for(let h=0,d=r.length;h<d;h++)o.hasOwnProperty(r[h].identifier.major.toString())||a.push(r[h]);n.hadTrackedEditOperation&&a.length>0&&(a[0]._isTracked=!0);let l=e.model.pushEditOperations(e.selectionsBefore,a,h=>{const d=[];for(let _=0;_<e.selectionsBefore.length;_++)d[_]=[];for(const _ of h)_.identifier&&d[_.identifier.major].push(_);const g=(_,b)=>_.identifier.minor-b.identifier.minor,p=[];for(let _=0;_<e.selectionsBefore.length;_++)d[_].length>0?(d[_].sort(g),p[_]=t[_].computeCursorState(e.model,{getInverseEditOperations:()=>d[_],getTrackedSelection:b=>{const C=parseInt(b,10),x=e.model._getTrackedRange(e.trackedRanges[C]);return e.trackedRangesDirection[C]===0?new Lt(x.startLineNumber,x.startColumn,x.endLineNumber,x.endColumn):new Lt(x.endLineNumber,x.endColumn,x.startLineNumber,x.startColumn)}})):p[_]=e.selectionsBefore[_];return p},void 0,i);l||(l=e.selectionsBefore);const c=[];for(const h in o)o.hasOwnProperty(h)&&c.push(parseInt(h,10));c.sort((h,d)=>d-h);for(const h of c)l.splice(h,1);return l}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(a){const l=this._getEditOperationsFromCommand(e,r,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let r=0;const o=(d,g,p=!1)=>{G.isEmpty(d)&&g===""||n.push({identifier:{major:t,minor:r++},range:d,text:g,forceMoveMarkers:p,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const h={addEditOperation:o,addTrackedEditOperation:(d,g,p)=>{a=!0,o(d,g,p)},trackSelection:(d,g)=>{const p=Lt.liftSelection(d);let _;if(p.isEmpty())if(typeof g=="boolean")g?_=2:_=3;else{const x=e.model.getLineMaxColumn(p.startLineNumber);p.startColumn===x?_=2:_=3}else _=1;const b=e.trackedRanges.length,C=e.model._setTrackedRange(null,p,_);return e.trackedRanges[b]=C,e.trackedRangesDirection[b]=p.getDirection(),b.toString()}};try{i.getEditOperations(e.model,h)}catch(d){return $t(d),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-G.compareRangesUsingEnds(i.range,n.range));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],r=e[i];if(G.getStartPosition(n.range).isBefore(G.getEndPosition(r.range))){let o;n.identifier.major>r.identifier.major?o=n.identifier.major:o=r.identifier.major,t[o.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===o&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class zEe{constructor(e,t,i,n){this.text=e,this.lineNumber=t,this.startSelectionOffset=i,this.endSelectionOffset=n}}class _w{static _capture(e,t){const i=[];for(const n of t){if(n.startLineNumber!==n.endLineNumber)return null;const r=n.startLineNumber;i.push(new zEe(e.getLineContent(r),r,n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=_w._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=_w._capture(e,t);if(!i||this._original.length!==i.length)return null;const n=[];for(let r=0,o=this._original.length;r<o;r++)n.push(_w._deduceOutcome(this._original[r],i[r]));return n}static _deduceOutcome(e,t){const i=Math.min(e.startSelectionOffset,t.startSelectionOffset,b1(e.text,t.text)),n=Math.min(e.text.length-e.endSelectionOffset,t.text.length-t.endSelectionOffset,w1(e.text,t.text)),r=e.text.substring(i,e.text.length-n),o=i,a=t.text.length-n,l=t.text.substring(o,a),c=new G(t.lineNumber,o+1,t.lineNumber,a+1);return new kSe(r,e.startSelectionOffset-i,e.endSelectionOffset-i,l,t.startSelectionOffset-i,t.endSelectionOffset-i,c)}}const u$={getInitialState:()=>Ov,tokenizeEncoded:(s,e,t)=>x7(0,t)};async function UEe(s,e,t){if(!t)return h$(e,s.languageIdCodec,u$);const i=await hn.getOrCreate(t);return h$(e,s.languageIdCodec,i||u$)}function jEe(s,e,t,i,n,r,o){let a="<div>",l=0,c=0,h=!0;for(let d=0,g=e.getCount();d<g;d++){const p=e.getEndOffset(d);let _="";for(;l<p&&l<n;l++){const b=s.charCodeAt(l),C=b===9;if(c+=ih(b)?2:C?0:1,l<i){if(C){const x=c%r;c+=x===0?r:r-x}continue}switch(b){case 9:{const x=c%r,S=x===0?r:r-x;c+=S;let y=S;for(;y>0;)o&&h?(_+="&#160;",h=!1):(_+=" ",h=!0),y--;break}case 60:_+="&lt;",h=!1;break;case 62:_+="&gt;",h=!1;break;case 38:_+="&amp;",h=!1;break;case 0:_+="&#00;",h=!1;break;case 65279:case 8232:case 8233:case 133:_+="",h=!1;break;case 13:_+="&#8203",h=!1;break;case 32:o&&h?(_+="&#160;",h=!1):(_+=" ",h=!0);break;default:_+=String.fromCharCode(b),h=!1}}if(!(p<=i)&&(a+=`<span style="${e.getInlineStyle(d,t)}">${_}</span>`,p>n||l>=n||i>=n))break}return a+="</div>",a}function h$(s,e,t){let i='<div class="monaco-tokenized-source">';const n=K1(s);let r=t.getInitialState();for(let o=0,a=n.length;o<a;o++){const l=n[o];o>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,r);Rn.convertToEndOffset(c.tokens,l.length);const d=new Rn(c.tokens,l,e).inflate();let g=0;for(let p=0,_=d.getCount();p<_;p++){const b=d.getClassName(p),C=d.getEndOffset(p);i+=`<span class="${b}">${Ra(l.substring(g,C))}</span>`,g=C}r=c.endState}return i+="</div>",i}class $Ee{constructor(e,t,i,n,r){this.decorationId=e,this.index=t,this.lineNumber=i,this.specialHeight=n,this.prefixSum=r,this.maximumSpecialHeight=n,this.deleted=!1}}class d${constructor(e,t){if(this._decorationIDToCustomLine=new $R,this._orderedCustomLines=[],this._pendingSpecialLinesToInsert=[],this._invalidIndex=0,this._hasPending=!1,this._defaultLineHeight=e,t.length>0){for(const i of t)this.insertOrChangeCustomLineHeight(i.decorationId,i.startLineNumber,i.endLineNumber,i.lineHeight);this.commit()}}set defaultLineHeight(e){this._defaultLineHeight=e}get defaultLineHeight(){return this._defaultLineHeight}removeCustomLineHeight(e){const t=this._decorationIDToCustomLine.get(e);if(t){this._decorationIDToCustomLine.delete(e);for(const i of t)i.deleted=!0,this._invalidIndex=Math.min(this._invalidIndex,i.index);this._hasPending=!0}}insertOrChangeCustomLineHeight(e,t,i,n){this.removeCustomLineHeight(e);for(let r=t;r<=i;r++){const o=new $Ee(e,-1,r,n,0);this._pendingSpecialLinesToInsert.push(o)}this._hasPending=!0}heightForLineNumber(e){const t=this._binarySearchOverOrderedCustomLinesArray(e);return t>=0?this._orderedCustomLines[t].maximumSpecialHeight:this._defaultLineHeight}getAccumulatedLineHeightsIncludingLineNumber(e){const t=this._binarySearchOverOrderedCustomLinesArray(e);if(t>=0)return this._orderedCustomLines[t].prefixSum+this._orderedCustomLines[t].maximumSpecialHeight;if(t===-1)return this._defaultLineHeight*e;const i=-(t+1),n=this._orderedCustomLines[i-1];return n.prefixSum+n.maximumSpecialHeight+this._defaultLineHeight*(e-n.lineNumber)}onLinesDeleted(e,t){const i=t-e+1,n=this._orderedCustomLines.length,r=this._binarySearchOverOrderedCustomLinesArray(e);let o;if(r>=0){o=r;for(let d=r-1;d>=0&&this._orderedCustomLines[d].lineNumber===e;d--)o--}else o=r===-(n+1)&&r!==-1?n-1:-(r+1);const a=this._binarySearchOverOrderedCustomLinesArray(t);let l;if(a>=0){l=a;for(let d=a+1;d<n&&this._orderedCustomLines[d].lineNumber===t;d++)l++}else l=a===-(n+1)&&a!==-1?n-1:-(a+1);const c=l>o,h=l===o&&this._orderedCustomLines[o]&&this._orderedCustomLines[o].lineNumber>=e&&this._orderedCustomLines[o].lineNumber<=t;if(c||h){let d=0;for(let R=o;R<=l;R++)d=Math.max(d,this._orderedCustomLines[R].maximumSpecialHeight);let g=0;if(o>0){const R=this._orderedCustomLines[o-1];g=R.prefixSum+R.maximumSpecialHeight+this._defaultLineHeight*(e-R.lineNumber-1)}else g=e>0?(e-1)*this._defaultLineHeight:0;const p=this._orderedCustomLines[o],_=this._orderedCustomLines[l],b=this._orderedCustomLines[l+1],C=b&&b.lineNumber===t+1?b.maximumSpecialHeight:this._defaultLineHeight,x=_.prefixSum+_.maximumSpecialHeight-p.prefixSum+this._defaultLineHeight*(t-_.lineNumber)+this._defaultLineHeight*(p.lineNumber-e)+C-d,S=new Set,y=[],k=new $R;let D=0;for(let R=0;R<this._orderedCustomLines.length;R++){const N=this._orderedCustomLines[R];if(R<o)y.push(N),k.add(N.decorationId,N);else if(R>=o&&R<=l){const A=N.decorationId;S.has(A)?D++:(N.index-=D,N.lineNumber=e,N.prefixSum=g,N.maximumSpecialHeight=d,y.push(N),k.add(N.decorationId,N))}else R>l&&(N.index-=D,N.lineNumber-=i,N.prefixSum-=x,y.push(N),k.add(N.decorationId,N));S.add(N.decorationId)}this._orderedCustomLines=y,this._decorationIDToCustomLine=k}else{const d=i*this._defaultLineHeight;for(let g=l;g<this._orderedCustomLines.length;g++){const p=this._orderedCustomLines[g];p.lineNumber>t&&(p.lineNumber-=i,p.prefixSum-=d)}}}onLinesInserted(e,t){const i=t-e+1,n=this._binarySearchOverOrderedCustomLinesArray(e);let r;if(n>=0){r=n;for(let h=n-1;h>=0&&this._orderedCustomLines[h].lineNumber===e;h--)r--}else r=-(n+1);const o=[],a=new Set;for(let h=r;h<this._orderedCustomLines.length;h++)this._orderedCustomLines[h].lineNumber===e&&a.add(this._orderedCustomLines[h].decorationId);const l=new Set;for(let h=r-1;h>=0;h--)this._orderedCustomLines[h].lineNumber===e-1&&l.add(this._orderedCustomLines[h].decorationId);const c=Nee(l,a);for(let h=r;h<this._orderedCustomLines.length;h++)this._orderedCustomLines[h].lineNumber+=i,this._orderedCustomLines[h].prefixSum+=this._defaultLineHeight*i;if(c.size>0){for(const h of c){const d=this._decorationIDToCustomLine.get(h);if(d){const g=d.reduce((b,C)=>Math.min(b,C.lineNumber),e),p=d.reduce((b,C)=>Math.max(b,C.lineNumber),e),_=d.reduce((b,C)=>Math.max(b,C.specialHeight),0);o.push({decorationId:h,startLineNumber:g,endLineNumber:p,lineHeight:_})}}for(const h of o)this.insertOrChangeCustomLineHeight(h.decorationId,h.startLineNumber,h.endLineNumber,h.lineHeight);this.commit()}}commit(){if(!this._hasPending)return;for(const r of this._pendingSpecialLinesToInsert){const o=this._binarySearchOverOrderedCustomLinesArray(r.lineNumber),a=o>=0?o:-(o+1);this._orderedCustomLines.splice(a,0,r),this._invalidIndex=Math.min(this._invalidIndex,a)}this._pendingSpecialLinesToInsert=[];const e=new $R,t=[];for(let r=0;r<this._invalidIndex;r++){const o=this._orderedCustomLines[r];t.push(o),e.add(o.decorationId,o)}let i=0,n=this._invalidIndex>0?t[this._invalidIndex-1]:void 0;for(let r=this._invalidIndex;r<this._orderedCustomLines.length;r++){const o=this._orderedCustomLines[r];if(o.deleted){i++;continue}if(o.index=r-i,n&&n.lineNumber===o.lineNumber)o.maximumSpecialHeight=n.maximumSpecialHeight,o.prefixSum=n.prefixSum;else{let a=o.specialHeight;for(let c=r;c<this._orderedCustomLines.length;c++){const h=this._orderedCustomLines[c];if(!h.deleted){if(h.lineNumber!==o.lineNumber)break;a=Math.max(a,h.specialHeight)}}o.maximumSpecialHeight=a;let l;n?l=n.prefixSum+n.maximumSpecialHeight+this._defaultLineHeight*(o.lineNumber-n.lineNumber-1):l=this._defaultLineHeight*(o.lineNumber-1),o.prefixSum=l}n=o,t.push(o),e.add(o.decorationId,o)}this._orderedCustomLines=t,this._decorationIDToCustomLine=e,this._invalidIndex=1/0,this._hasPending=!1}_binarySearchOverOrderedCustomLinesArray(e){return tX(this._orderedCustomLines.length,t=>{const i=this._orderedCustomLines[t];return i.lineNumber===e?0:i.lineNumber<e?-1:1})}}class $R{constructor(){this._map=new Map}add(e,t){const i=this._map.get(e);i?i.push(t):this._map.set(e,[t])}get(e){return this._map.get(e)}delete(e){this._map.delete(e)}}class qEe{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class GEe{constructor(e,t,i,n,r){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=r,this.prefixSum=0}}var Sd;let KEe=(Sd=class{constructor(e,t,i,n,r){this._instanceId=BX(++Sd.INSTANCE_COUNT),this._pendingChanges=new qEe,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._paddingTop=i,this._paddingBottom=n,this._lineHeightsManager=new d$(t,r)}static findInsertionIndex(e,t,i){let n=0,r=e.length;for(;n<r;){const o=n+r>>>1;t===e[o].afterLineNumber?i<e[o].ordinal?r=o:n=o+1:t<e[o].afterLineNumber?r=o:n=o+1}return n}setDefaultLineHeight(e){this._lineHeightsManager.defaultLineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e,t){this._lineCount=e,this._lineHeightsManager=new d$(this._lineHeightsManager.defaultLineHeight,t)}changeLineHeights(e){let t=!1;try{e({insertOrChangeCustomLineHeight:(n,r,o,a)=>{t=!0,this._lineHeightsManager.insertOrChangeCustomLineHeight(n,r,o,a)},removeCustomLineHeight:n=>{t=!0,this._lineHeightsManager.removeCustomLineHeight(n)}})}finally{this._lineHeightsManager.commit()}return t}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,r,o,a)=>{t=!0,n=n|0,r=r|0,o=o|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new GEe(l,n,r,o,a)),l},changeOneWhitespace:(n,r,o)=>{t=!0,r=r|0,o=o|0,this._pendingChanges.change({id:n,newAfterLineNumber:r,newHeight:o})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const n=new Set;for(const l of i)n.add(l.id);const r=new Map;for(const l of t)r.set(l.id,l);const o=l=>{const c=[];for(const h of l)if(!n.has(h.id)){if(r.has(h.id)){const d=r.get(h.id);h.afterLineNumber=d.newAfterLineNumber,h.height=d.newHeight}c.push(h)}return c},a=o(this._arr).concat(o(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_insertWhitespace(e){const t=Sd.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const r=this._arr[n];this._removeWhitespace(n),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const r=this._arr[i].afterLineNumber;e<=r&&r<=t?this._arr[i].afterLineNumber=e-1:r>t&&(this._arr[i].afterLineNumber-=t-e+1)}this._lineHeightsManager.onLinesDeleted(e,t)}onLinesInserted(e,t){e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const r=this._arr[i].afterLineNumber;e<=r&&(this._arr[i].afterLineNumber+=t-e+1)}this._lineHeightsManager.onLinesInserted(e,t)}getWhitespacesTotalHeight(){return this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){const e=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(this._lineCount),t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const o=(n-i|0)/2|0,a=i+o|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){e=e|0;let i;e>1?i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(e-1):i=0;const n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getLineHeightForLineNumber(e){return this._lineHeightsManager.heightForLineNumber(e)}getVerticalOffsetAfterLineNumber(e,t=!1){e=e|0;const i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(e),n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}getWhitespaceMinWidth(){if(this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:e<this._paddingTop}isInBottomPadding(e){if(this._paddingBottom===0)return!1;const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(e=e|0,e<0)return 1;const t=this._lineCount|0;let i=1,n=t;for(;i<n;){const r=(i+n)/2|0,o=this.getLineHeightForLineNumber(r),a=this.getVerticalOffsetForLineNumber(r)|0;if(e>=a+o)i=r+1;else{if(e>=a)return r;n=r}}return i>t?t:i}getLinesViewportData(e,t){e=e|0,t=t|0;const i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,n=this.getVerticalOffsetForLineNumber(i)|0;let r=this._lineCount|0,o=this.getFirstWhitespaceIndexAfterLineNumber(i)|0;const a=this.getWhitespacesCount()|0;let l,c;o===-1?(o=a,c=r+1,l=0):(c=this.getAfterLineNumberForWhitespaceIndex(o)|0,l=this.getHeightForWhitespaceIndex(o)|0);let h=n,d=h;const g=5e5;let p=0;n>=g&&(p=Math.floor(n/g)*g,p=Math.floor(p/this._lineHeightsManager.defaultLineHeight)*this._lineHeightsManager.defaultLineHeight,d-=p);const _=[],b=e+(t-e)/2;let C=-1;for(let k=i;k<=r;k++){const D=this.getLineHeightForLineNumber(k);if(C===-1){const R=h,N=h+D;(R<=b&&b<N||R>b)&&(C=k)}for(h+=D,_[k-i]=d,d+=D;c===k;)d+=l,h+=l,o++,o>=a?c=r+1:(c=this.getAfterLineNumberForWhitespaceIndex(o)|0,l=this.getHeightForWhitespaceIndex(o)|0);if(h>=t){r=k;break}}C===-1&&(C=r);const x=this.getVerticalOffsetForLineNumber(r)|0;let S=i,y=r;if(S<y&&n<e&&S++,S<y){const k=this.getLineHeightForLineNumber(r);x+k>t&&y--}return{bigNumbersDelta:p,startLineNumber:i,endLineNumber:r,relativeVerticalOffset:_,centeredLineNumber:C,completelyVisibleStartLineNumber:S,completelyVisibleEndLineNumber:y,lineHeight:this._lineHeightsManager.defaultLineHeight}}getVerticalOffsetForWhitespaceIndex(e){e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(t):i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const n=this.getVerticalOffsetForWhitespaceIndex(i),r=this.getHeightForWhitespaceIndex(i);if(e>=n+r)return-1;for(;t<i;){const o=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(e>=a+l)t=o+1;else{if(e>=a)return o;i=o}}return t}getWhitespaceAtVerticalOffset(e){e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),o=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:o,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const r=[];for(let o=i;o<=n;o++){const a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(o),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(o),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._arr.slice(0)}getWhitespacesCount(){return this._arr.length}getIdForWhitespaceIndex(e){return e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return e=e|0,this._arr[e].height}},Sd.INSTANCE_COUNT=0,Sd);const YEe=125;class M0{constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class QEe extends le{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new Z),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new M0(0,0,0,0),this._scrollable=this._register(new eb({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new l8(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class XEe extends le{constructor(e,t,i,n){super(),this._configuration=e;const r=this._configuration.options,o=r.get(165),a=r.get(96);this._linesLayout=new KEe(t,r.get(75),a.top,a.bottom,i),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new QEe(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new M0(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(130)?YEe:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(75)&&this._linesLayout.setDefaultLineHeight(t.get(75)),e.hasChanged(96)){const i=t.get(96);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(165)){const i=t.get(165),n=i.contentWidth,r=i.height,o=this._scrollable.getScrollDimensions(),a=o.contentWidth;this._scrollable.setScrollDimensions(new M0(n,o.contentWidth,r,this._getContentHeight(n,r,a)))}else this._updateHeight();e.hasChanged(130)&&this._configureSmoothScrollDuration()}onFlushed(e,t){this._linesLayout.onFlushed(e,t)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(117);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let r=this._linesLayout.getLinesTotalHeight();return n.get(119)?r+=Math.max(0,t-n.get(75)-n.get(96).bottom):n.get(117).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,i)),r}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new M0(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new AU(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new AU(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(166),n=e.get(59),r=e.get(165);if(i.isViewportWrapping){const o=e.get(81);return t>r.contentWidth+n.typicalHalfwidthCharacterWidth&&o.enabled&&o.side==="right"?t+r.verticalScrollbarWidth:t}else{const o=e.get(118)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+o+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new M0(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}changeSpecialLineHeights(e){const t=this._linesLayout.changeLineHeights(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}getLineHeightForLineNumber(e){return this._linesLayout.getLineHeightForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class bw{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class ZEe{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new bw(new G(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class JEe{constructor(e,t,i,n,r){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,r=e.options;let o;if(r.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new J(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new J(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);o=new G(a.lineNumber,a.column,l.lineNumber,l.column)}else o=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new XJ(o,r),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getDecorationsOnLine(e,t=!1,i=!1){const n=new G(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i)}_getDecorationsInRange(e,t,i){const n=this._linesCollection.getDecorationsInRange(e,this.editorId,JL(this.configuration.options),ek(this.configuration.options),t,i),r=e.startLineNumber,o=e.endLineNumber,a=[];let l=0;const c=[];for(let d=r;d<=o;d++)c[d-r]=[];let h=!1;for(let d=0,g=n.length;d<g;d++){const p=n[d],_=p.options;if(!zxe(this.model,p))continue;const b=this._getOrCreateViewModelDecoration(p),C=b.range;if(a[l++]=b,_.inlineClassName){const x=new bw(C,_.inlineClassName,_.inlineClassNameAffectsLetterSpacing?3:0),S=Math.max(r,C.startLineNumber),y=Math.min(o,C.endLineNumber);for(let k=S;k<=y;k++)c[k-r].push(x)}if(_.beforeContentClassName&&r<=C.startLineNumber&&C.startLineNumber<=o){const x=new bw(new G(C.startLineNumber,C.startColumn,C.startLineNumber,C.startColumn),_.beforeContentClassName,1);c[C.startLineNumber-r].push(x)}if(_.afterContentClassName&&r<=C.endLineNumber&&C.endLineNumber<=o){const x=new bw(new G(C.endLineNumber,C.endColumn,C.endLineNumber,C.endColumn),_.afterContentClassName,2);c[C.endLineNumber-r].push(x)}_.affectsFont&&(h=!0)}return{decorations:a,inlineDecorations:c,hasVariableFonts:h}}}function qR(s,e){return s===null?e?e2.INSTANCE:t2.INSTANCE:new eDe(s,e)}class eDe{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,r=this._projectionData.breakOffsets[i];let o;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,h)=>new vl(0,0,c+1,this._projectionData.injectionOptions[h],0));o=vl.applyInjectedText(e.getLineContent(t),a).substring(n,r)}else o=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:r+1});return i>0&&(o=f$(this._projectionData.wrappedTextIndentLength)+o),o}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,r,o,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,h=l.injectionOptions;let d=null;if(c){d=[];let p=0,_=0;for(let b=0;b<l.getOutputLineCount();b++){const C=new Array;d[b]=C;const x=b>0?l.breakOffsets[b-1]:0,S=l.breakOffsets[b];for(;_<c.length;){const y=h[_].content.length,k=c[_]+p,D=k+y;if(k>S)break;if(x<D){const R=h[_];if(R.inlineClassName){const N=b>0?l.wrappedTextIndentLength:0,A=N+Math.max(k-x,0),M=N+Math.min(D-x,S-x);A!==M&&C.push(new ZEe(A,M,R.inlineClassName,R.inlineClassNameAffectsLetterSpacing))}}if(D<=S)p+=y,_++;else break}}}let g;if(c){const p=[];for(let _=0;_<c.length;_++){const b=c[_],C=h[_].tokens;C?C.forEach((x,S)=>{p.push({offset:b,text:x.substring(h[_].content),tokenMetadata:S.metadata})}):p.push({offset:b,text:h[_].content,tokenMetadata:Rn.defaultTokenMetadata})}g=e.tokenization.getLineTokens(t).withInserted(p)}else g=e.tokenization.getLineTokens(t);for(let p=i;p<i+n;p++){const _=r+p-i;if(!o[_]){a[_]=null;continue}a[_]=this._getViewLineData(g,d?d[p]:null,p)}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,r=i>0?n.wrappedTextIndentLength:0,o=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(o,a,r);let c=l.getLineContent();i>0&&(c=f$(n.wrappedTextIndentLength)+c);const h=this._projectionData.getMinOutputOffset(i)+1,d=c.length+1,g=i+1<this.getViewLineCount(),p=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new k7(c,g,h,d,p,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}const fE=class fE{constructor(){}isVisible(){return!0}setVisible(e){return e?this:t2.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.tokenization.getLineTokens(t),r=n.getLineContent();return new k7(r,!1,1,r.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,r,o,a){if(!o[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new J(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}};fE.INSTANCE=new fE;let e2=fE;const gE=class gE{constructor(){}isVisible(){return!1}setVisible(e){return e?e2.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,r,o,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}};gE.INSTANCE=new gE;let t2=gE;const GR=[""];function f$(s){if(s>=GR.length)for(let e=1;e<=s;e++)GR[e]=tDe(e);return GR[s]}function tDe(s){return new Array(s+1).join(" ")}class iDe{constructor(e){this._model=e}_validPosition(e){return this._model.validatePosition(e)}_validRange(e){return this._model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}class nDe{constructor(e,t,i,n,r,o,a,l,c,h,d){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=r,this.tabSize=o,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=h,this.wrapOnEscapedLineFeeds=d,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new rDe(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),r=i.length,o=this.createLineBreaksComputer(),a=new eh(vl.fromDecorations(n));for(let b=0;b<r;b++){const C=a.takeWhile(x=>x.lineNumber===b+1);o.addRequest(i[b],C,t?t[b]:null)}const l=o.finalize(),c=[],h=this.hiddenAreasDecorationIds.map(b=>this.model.getDecorationRange(b)).sort(G.compareRangesUsingStarts);let d=1,g=0,p=-1,_=p+1<h.length?g+1:r+2;for(let b=0;b<r;b++){const C=b+1;C===_&&(p++,d=h[p].startLineNumber,g=h[p].endLineNumber,_=p+1<h.length?g+1:r+2);const x=C>=d&&C<=g,S=qR(l[b],!x);c[b]=S.getViewLineCount(),this.modelLineProjections[b]=S}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new Dwe(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(g=>this.model.validateRange(g)),i=sDe(t),n=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(G.compareRangesUsingStarts);if(i.length===n.length){let g=!1;for(let p=0;p<i.length;p++)if(!i[p].equalsRange(n[p])){g=!0;break}if(!g)return!1}const r=i.map(g=>({range:g,options:Nn.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);const o=i;let a=1,l=0,c=-1,h=c+1<o.length?l+1:this.modelLineProjections.length+2,d=!1;for(let g=0;g<this.modelLineProjections.length;g++){const p=g+1;p===h&&(c++,a=o[c].startLineNumber,l=o[c].endLineNumber,h=c+1<o.length?l+1:this.modelLineProjections.length+2);let _=!1;if(p>=a&&p<=l?this.modelLineProjections[g].isVisible()&&(this.modelLineProjections[g]=this.modelLineProjections[g].setVisible(!1),_=!0):(d=!0,this.modelLineProjections[g].isVisible()||(this.modelLineProjections[g]=this.modelLineProjections[g].setVisible(!0),_=!0)),_){const b=this.modelLineProjections[g].getViewLineCount();this.projectedModelLineLineCounts.setValue(g,b)}}return d||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,r){const o=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===n,h=this.wordBreak===r;if(o&&a&&l&&c&&h)return!1;const d=o&&a&&!l&&c&&h;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=r;let g=null;if(d){g=[];for(let p=0,_=this.modelLineProjections.length;p<_;p++)g[p]=this.modelLineProjections[p].getProjectionData()}return this._constructLines(!1,g),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak,this.wrapOnEscapedLineFeeds)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new rO(n,r)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const r=t>2&&!this.modelLineProjections[t-2].isVisible(),o=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let h=0,d=n.length;h<d;h++){const g=qR(n[h],!r);l.push(g);const p=g.getViewLineCount();a+=p,c[h]=p}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new oO(o,o+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,r=this.modelLineProjections[n].getViewLineCount(),o=this.modelLineProjections[n].isVisible(),a=qR(i,o);this.modelLineProjections[n]=a;const l=this.modelLineProjections[n].getViewLineCount();let c=!1,h=0,d=-1,g=0,p=-1,_=0,b=-1;r>l?(h=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=h+l-1,_=d+1,b=_+(r-l)-1,c=!0):r<l?(h=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=h+r-1,g=d+1,p=g+(l-r)-1,c=!0):(h=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=h+l-1),this.projectedModelLineLineCounts.setValue(n,l);const C=h<=d?new Aee(h,d-h+1):null,x=g<=p?new oO(g,p):null,S=_<=b?new rO(_,b):null;return[c,C,x,S]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,r.lineNumber,o.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new g$(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new J(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new J(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),r=new Array;let o=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const h=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,d=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let g=h;g<d;g++)a.push(new g$(l,g))}if(!c.isVisible()&&o){const h=new J(l-1,this.model.getLineMaxColumn(l-1)+1),d=G.fromPositions(o,h);r.push(new m$(d,a)),a=[],o=null}else c.isVisible()&&!o&&(o=new J(l,1))}if(o){const l=G.fromPositions(o,this.getModelEndPositionOfViewLine(n));r.push(new m$(l,a))}return r}getViewLinesBracketGuides(e,t,i,n){const r=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,o=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,n);for(const h of a.viewLines){const g=c[h.modelLineNumber-l].map(p=>{if(p.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[h.modelLineNumber-1].getViewPositionOfModelPosition(0,p.forWrappedLinesAfterColumn).lineNumber>=h.modelLineWrappedLineIdx||p.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[h.modelLineNumber-1].getViewPositionOfModelPosition(0,p.forWrappedLinesBeforeOrAtColumn).lineNumber<h.modelLineWrappedLineIdx)return;if(!p.horizontalLine)return p;let _=-1;if(p.column!==-1){const x=this.modelLineProjections[h.modelLineNumber-1].getViewPositionOfModelPosition(0,p.column);if(x.lineNumber===h.modelLineWrappedLineIdx)_=x.column;else if(x.lineNumber<h.modelLineWrappedLineIdx)_=this.getMinColumnOfViewLine(h);else if(x.lineNumber>h.modelLineWrappedLineIdx)return}const b=this.convertModelPositionToViewPosition(h.modelLineNumber,p.horizontalLine.endColumn),C=this.modelLineProjections[h.modelLineNumber-1].getViewPositionOfModelPosition(0,p.horizontalLine.endColumn);return C.lineNumber===h.modelLineWrappedLineIdx?new hg(p.visibleColumn,_,p.className,new nw(p.horizontalLine.top,b.column),-1,-1):C.lineNumber<h.modelLineWrappedLineIdx||p.visibleColumn!==-1?void 0:new hg(p.visibleColumn,_,p.className,new nw(p.horizontalLine.top,this.getMaxColumnOfViewLine(h)),-1,-1)});o.push(g.filter(p=>!!p))}}return o}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let r=[];const o=[],a=[],l=i.lineNumber-1,c=n.lineNumber-1;let h=null;for(let _=l;_<=c;_++){const b=this.modelLineProjections[_];if(b.isVisible()){const C=b.getViewLineNumberOfModelPosition(0,_===l?i.column:1),x=b.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(_+1)),S=x-C+1;let y=0;S>1&&b.getViewLineMinColumn(this.model,_+1,x)===1&&(y=C===0?1:2),o.push(S),a.push(y),h===null&&(h=new J(_+1,0))}else h!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(h.lineNumber,_)),h=null)}h!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(h.lineNumber,n.lineNumber)),h=null);const d=t-e+1,g=new Array(d);let p=0;for(let _=0,b=r.length;_<b;_++){let C=r[_];const x=Math.min(d-p,o[_]),S=a[_];let y;S===2?y=0:S===1?y=1:y=x;for(let k=0;k<x;k++)k===y&&(C=0),g[p++]=C}return g}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let r=e;const o=n.index,a=n.remainder,l=[];for(let c=o,h=this.model.getLineCount();c<h;c++){const d=this.modelLineProjections[c];if(!d.isVisible())continue;const g=c===o?a:0;let p=d.getViewLineCount()-g,_=!1;if(r+p>t&&(_=!0,p=t-r+1),d.getViewLinesData(this.model,c+1,g,p,r-e,i,l),r+=p,_)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),r=n.index,o=n.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,o),c=a.getViewLineMaxColumn(this.model,r+1,o);t<l&&(t=l),t>c&&(t=c);const h=a.getModelColumnOfViewPosition(o,t);return this.model.validatePosition(new J(r+1,h)).equals(i)?new J(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new G(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new J(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new G(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,r=!1){const o=this.model.validatePosition(new J(e,t)),a=o.lineNumber,l=o.column;let c=a-1,h=!1;if(r)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,h=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,h=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new J(n?0:1,1);const d=1+this.projectedModelLineLineCounts.getPrefixSum(c);let g;return h?r?g=this.modelLineProjections[c].getViewPositionOfModelPosition(d,1,i):g=this.modelLineProjections[c].getViewPositionOfModelPosition(d,this.model.getLineMaxColumn(c+1),i):g=this.modelLineProjections[a-1].getViewPositionOfModelPosition(d,l,i),g}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return G.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new G(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const r=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(r,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,r,o){const a=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),l=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(l.lineNumber-a.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new G(a.lineNumber,1,l.lineNumber,l.column),t,i,n,r,o);let c=[];const h=a.lineNumber-1,d=l.lineNumber-1;let g=null;for(let C=h;C<=d;C++)if(this.modelLineProjections[C].isVisible())g===null&&(g=new J(C+1,C===h?a.column:1));else if(g!==null){const S=this.model.getLineMaxColumn(C);c=c.concat(this.model.getDecorationsInRange(new G(g.lineNumber,g.column,C,S),t,i,n,r)),g=null}g!==null&&(c=c.concat(this.model.getDecorationsInRange(new G(g.lineNumber,g.column,l.lineNumber,l.column),t,i,n,r)),g=null),c.sort((C,x)=>{const S=G.compareRangesUsingStarts(C.range,x.range);return S===0?C.id<x.id?-1:C.id>x.id?1:0:S});const p=[];let _=0,b=null;for(const C of c){const x=C.id;b!==x&&(b=x,p[_++]=C)}return p}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function sDe(s){if(s.length===0)return[];const e=s.slice();e.sort(G.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,n=e[0].endLineNumber;for(let r=1,o=e.length;r<o;r++){const a=e[r];a.startLineNumber>n+1?(t.push(new G(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new G(i,1,n,1)),t}class g${constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class m${constructor(e,t){this.modelRange=e,this.viewLines=t}}class rDe{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class oDe{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new iDe(this.model)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new rO(t,i)}onModelLinesInserted(e,t,i,n){return new oO(t,i)}onModelLineChanged(e,t,i){return[!1,new Aee(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let r=0;r<i;r++)n[r]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new k7(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const r=[];for(let o=e;o<=t;o++){const a=o-e;r[a]=i[a]?this.getViewLineData(o):null}return r}getDecorationsInRange(e,t,i,n,r,o){return this.model.getDecorationsInRange(e,t,i,n,r,o)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}const pf=Rd.Right;class aDe{constructor(e){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((e+1)*pf/8))}reset(e){const t=Math.ceil((e+1)*pf/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const r=pf*n+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){const t=[];let i=pf*e;for(let n=0;n<pf;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[Rd.Center]}countAtLine(e){let t=pf*e,i=0;for(let n=0;n<pf;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}}let lDe=class extends le{constructor(e,t,i,n,r,o,a,l,c,h){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this._transactionalTarget=h,this.hiddenAreasModel=new uDe,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new kEe,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Ap(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Es(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=u8.create(this.model),this.glyphLanes=new aDe(0),this.model.isTooLargeForTokenization())this._lines=new oDe(this.model);else{const d=this._configuration.options,g=d.get(59),p=d.get(156),_=d.get(166),b=d.get(155),C=d.get(146),x=d.get(160);this._lines=new nDe(this._editorId,this.model,n,r,g,this.model.getOptions().tabSize,p,_.wrappingColumn,b,C,x)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new HEe(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new XEe(this._configuration,this.getLineCount(),this._getCustomLineHeights(),o)),this._register(this.viewLayout.onDidScroll(d=>{d.scrollTopChanged&&this._handleVisibleLinesChanged(),d.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new CEe(d)),this._eventDispatcher.emitOutgoingEvent(new c8(d.oldScrollWidth,d.oldScrollLeft,d.oldScrollHeight,d.oldScrollTop,d.scrollWidth,d.scrollLeft,d.scrollHeight,d.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(d=>{this._eventDispatcher.emitOutgoingEvent(d)})),this._decorations=new JEe(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(d=>{try{const g=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(g,d)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Wk.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new xEe)})),this._register(this._themeService.onDidColorThemeChange(d=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new yEe(d))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_getCustomLineHeights(){return this._configuration.options.get(5)?this.model.getCustomLineHeightsDecorations(this._editorId).map(i=>{const n=i.range.startLineNumber,r=this.coordinatesConverter.convertModelRangeToViewRange(new G(n,1,n,this.model.getLineMaxColumn(n)));return{decorationId:i.id,startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,lineHeight:i.options.lineHeight||0}}):[]}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new G(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new wEe(e)),this._eventDispatcher.emitOutgoingEvent(new jD(!e,e))}setHasWidgetFocus(e){this._eventDispatcher.emitOutgoingEvent(new DEe(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new mEe)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new pEe)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new J(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new _$(t,this._viewportStart.startLineDelta)}return new _$(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),n=this._configuration.options,r=n.get(59),o=n.get(156),a=n.get(166),l=n.get(155),c=n.get(146);this._lines.setWrappingSettings(r,o,a.wrappingColumn,l,c)&&(e.emitViewEvent(new ux),e.emitViewEvent(new hx),e.emitViewEvent(new mf(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(104)&&(this._decorations.reset(),e.emitViewEvent(new mf(null))),t.hasChanged(112)&&(this._decorations.reset(),e.emitViewEvent(new mf(null))),e.emitViewEvent(new _Ee(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Ap.shouldRecreate(t)&&(this.cursorConfig=new Ap(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(i=>{try{const r=this._eventDispatcher.beginEmitViewEvents();let o=!1,a=!1;const l=i instanceof Dg?i.rawContentChangedEvent.changes:i.changes,c=i instanceof Dg?i.rawContentChangedEvent.versionId:null,h=this._lines.createLineBreaksComputer();for(const p of l)switch(p.changeType){case 4:{for(let _=0;_<p.detail.length;_++){const b=p.detail[_];let C=p.injectedTexts[_];C&&(C=C.filter(x=>!x.ownerId||x.ownerId===this._editorId)),h.addRequest(b,C,null)}break}case 2:{let _=null;p.injectedText&&(_=p.injectedText.filter(b=>!b.ownerId||b.ownerId===this._editorId)),h.addRequest(p.detail,_,null);break}}const d=h.finalize(),g=new eh(d);for(const p of l)switch(p.changeType){case 1:{this._lines.onModelFlushed(),r.emitViewEvent(new ux),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),o=!0;break}case 3:{const _=this._lines.onModelLinesDeleted(c,p.fromLineNumber,p.toLineNumber);_!==null&&(r.emitViewEvent(_),this.viewLayout.onLinesDeleted(_.fromLineNumber,_.toLineNumber)),o=!0;break}case 4:{const _=g.takeCount(p.detail.length),b=this._lines.onModelLinesInserted(c,p.fromLineNumber,p.toLineNumber,_);b!==null&&(r.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),o=!0;break}case 2:{const _=g.dequeue(),[b,C,x,S]=this._lines.onModelLineChanged(c,p.lineNumber,_);a=b,C&&r.emitViewEvent(C),x&&(r.emitViewEvent(x),this.viewLayout.onLinesInserted(x.fromLineNumber,x.toLineNumber)),S&&(r.emitViewEvent(S),this.viewLayout.onLinesDeleted(S.fromLineNumber,S.toLineNumber));break}case 5:break}c!==null&&this._lines.acceptVersionId(c),this.viewLayout.onHeightMaybeChanged(),!o&&a&&(r.emitViewEvent(new hx),r.emitViewEvent(new mf(null)),this._cursor.onLineMappingChanged(r),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){const r=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(r){const o=this.coordinatesConverter.convertModelPositionToViewPosition(r.getStartPosition()),a=this.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber);this.viewLayout.setScrollPosition({scrollTop:a+this._viewportStart.startLineDelta},1)}}try{const r=this._eventDispatcher.beginEmitViewEvents();i instanceof Dg&&r.emitOutgoingEvent(new OEe(i.contentChangedEvent)),this._cursor.onModelContentChanged(r,i)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._configuration.options.get(5)&&this._register(this.model.onDidChangeLineHeight(i=>{const n=i.changes.filter(r=>r.ownerId===this._editorId||r.ownerId===0);if(this.viewLayout.changeSpecialLineHeights(r=>{for(const o of n){const{decorationId:a,lineNumber:l,lineHeight:c}=o,h=this.coordinatesConverter.convertModelRangeToViewRange(new G(l,1,l,this.model.getLineMaxColumn(l)));c!==null?r.insertOrChangeCustomLineHeight(a,h.startLineNumber,h.endLineNumber,c):r.removeCustomLineHeight(a)}}),n.length>0){const r=new aee(n);this._eventDispatcher.emitOutgoingEvent(new BEe(r))}})),this._configuration.options.get(172)&&this._register(this.model.onDidChangeFont(i=>{const n=i.changes.filter(r=>r.ownerId===this._editorId||r.ownerId===0);if(n.length>0){const r=new lee(n);this._eventDispatcher.emitOutgoingEvent(new VEe(r))}})),this._register(this.model.onDidChangeTokens(i=>{const n=[];for(let r=0,o=i.ranges.length;r<o;r++){const a=i.ranges[r],l=this.coordinatesConverter.convertModelPositionToViewPosition(new J(a.fromLineNumber,1)).lineNumber,c=this.coordinatesConverter.convertModelPositionToViewPosition(new J(a.toLineNumber,this.model.getLineMaxColumn(a.toLineNumber))).lineNumber;n[r]={fromLineNumber:l,toLineNumber:c}}this._eventDispatcher.emitSingleViewEvent(new SEe(n)),this._eventDispatcher.emitOutgoingEvent(new FEe(i))})),this._register(this.model.onDidChangeLanguageConfiguration(i=>{this._eventDispatcher.emitSingleViewEvent(new vEe),this.cursorConfig=new Ap(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new MEe(i))})),this._register(this.model.onDidChangeLanguage(i=>{this.cursorConfig=new Ap(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new AEe(i))})),this._register(this.model.onDidChangeOptions(i=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new ux),n.emitViewEvent(new hx),n.emitViewEvent(new mf(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Ap(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new PEe(i))})),this._register(this.model.onDidChangeDecorations(i=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new mf(i)),this._eventDispatcher.emitOutgoingEvent(new REe(i))}))}getFontSizeAtPosition(e){if(!this._configuration.options.get(172))return null;const i=this.model.getFontDecorationsInRange(G.fromPositions(e),this._editorId);let n=this._configuration.options.get(59).fontSize+"px";for(const r of i)if(r.options.fontSize){n=r.options.fontSize;break}return n}setHiddenAreas(e,t,i){var a;this.hiddenAreasModel.setHiddenAreas(t,e);const n=this.hiddenAreasModel.getMergedRanges();if(n===this.previousHiddenAreas&&!i)return;this.previousHiddenAreas=n;const r=this._captureStableViewport();let o=!1;try{const l=this._eventDispatcher.beginEmitViewEvents();o=this._lines.setHiddenAreas(n),o&&(l.emitViewEvent(new ux),l.emitViewEvent(new hx),l.emitViewEvent(new mf(null)),this._cursor.onLineMappingChanged(l),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),this.viewLayout.onHeightMaybeChanged());const c=(a=r.viewportStartModelPosition)==null?void 0:a.lineNumber;c&&n.some(d=>d.startLineNumber<=c&&c<=d.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),o&&this._eventDispatcher.emitOutgoingEvent(new NEe)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(165),t=this._configuration.options.get(75),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),r=Math.max(1,n.completelyVisibleStartLineNumber-i),o=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new G(r,this.getLineMinColumn(r),o,this.getLineMaxColumn(o)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const n=[];let r=0,o=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let h=0,d=i.length;h<d;h++){const g=i[h].startLineNumber,p=i[h].endLineNumber;p<o||g>l||(o<g&&(n[r++]=new G(o,a,g-1,this.model.getLineMaxColumn(g-1))),o=p+1,a=1)}return(o<l||o===l&&a<c)&&(n[r++]=new G(o,a,l,c)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new G(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new G(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new J(i,this.getLineMinColumn(i))),r=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:r}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=qr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Sm(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}_getTextDirection(e,t){let i=0;for(const n of t){const r=n.range;if(r.startLineNumber>e||r.endLineNumber<e)continue;const o=n.options.textDirection;o===xo.RTL?i++:o===xo.LTR&&i--}return i>0?xo.RTL:xo.LTR}getTextDirection(e){const t=this._decorations.getDecorationsOnLine(e);return this._getTextDirection(e,t.decorations)}getViewportViewLineRenderingData(e,t){const i=this._decorations.getDecorationsViewportData(e),n=i.inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,n,i.hasVariableFonts,i.decorations)}getViewLineRenderingData(e){const t=this._decorations.getDecorationsOnLine(e);return this._getViewLineRenderingData(e,t.inlineDecorations[0],t.hasVariableFonts,t.decorations)}_getViewLineRenderingData(e,t,i,n){const r=this.model.mightContainRTL(),o=this.model.mightContainNonBasicASCII(),a=this.getTabSize(),l=this._lines.getViewLineData(e);return l.inlineDecorations&&(t=[...t,...l.inlineDecorations.map(c=>c.toInlineDecoration(e))]),new Ro(l.minColumn,l.maxColumn,l.content,l.continuesWithWrappedLine,r,o,l.tokens,t,a,l.startVisibleColumn,this._getTextDirection(e,n),i)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new Xwe(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,JL(this._configuration.options),ek(this._configuration.options)),i=new cDe;for(const n of t){const r=n.options,o=r.overviewRuler;if(!o)continue;const a=o.position;if(a===0)continue;const l=o.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),h=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(l,r.zIndex,c,h,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i==null||i.invalidateCachedColor();const n=t.options.minimap;n==null||n.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e),n=this.model.modifyPosition(i,t);return this.coordinatesConverter.convertModelPositionToViewPosition(n)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const o=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(o)}getPlainTextToCopy(e,t,i){const n=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(G.compareRangesUsingStarts);let r=!1,o=!1;for(const l of e)l.isEmpty()?r=!0:o=!0;if(!o){if(!t)return"";const l=e.map(h=>h.startLineNumber);let c="";for(let h=0;h<l.length;h++)h>0&&l[h-1]===l[h]||(c+=this.model.getLineContent(l[h])+n);return c}if(r&&t){const l=[];let c=0;for(const h of e){const d=h.startLineNumber;h.isEmpty()?d!==c&&l.push(this.model.getLineContent(d)):l.push(this.model.getValueInRange(h,i?2:0)),c=d}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===Aa||e.length!==1)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const h=n.startLineNumber;n=new G(h,this.model.getLineMinColumn(h),h,this.model.getLineMaxColumn(h))}const r=this._configuration.options.get(59),o=this._getColorMap(),l=/[:;\\\/<>]/.test(r.fontFamily)||r.fontFamily===ra.fontFamily;let c;return l?c=ra.fontFamily:(c=r.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${ra.fontFamily}`),{mode:i,html:`<div style="color: ${o[1]};background-color: ${o[2]};font-family: ${c};font-weight: ${r.fontWeight};font-size: ${r.fontSize}px;line-height: ${r.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,o)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=r;c++){const h=this.model.tokenization.getLineTokens(c),d=h.getLineContent(),g=c===i?n-1:0,p=c===r?o-1:d.length;d===""?l+="<br>":l+=jEe(d,h.inflate(),t,g,p,a,Rr)}return l}_getColorMap(){const e=hn.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=me.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(n=>this._cursor.setStates(n,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(n=>this._cursor.setSelections(n,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new IEe);return}this._withViewEventsCollector(e)}executeEdits(e,t,i,n){this._executeCursorEdit(r=>this._cursor.executeEdits(r,e,t,i,n))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,n,r){this._executeCursorEdit(o=>this._cursor.compositionType(o,e,t,i,n,r))}paste(e,t,i,n){this._executeCursorEdit(r=>this._cursor.paste(r,e,t,i,n))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealAllCursors(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealAll(n,e,i,0,t,0))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealPrimary(n,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new G(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new mw(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new G(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new mw(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,n,r){this._withViewEventsCollector(o=>o.emitViewEvent(new mw(e,!1,i,null,n,t,r)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new LEe),this._eventDispatcher.emitOutgoingEvent(new TEe))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class u8{static create(e){const t=e._setTrackedRange(null,new G(1,1,1,1),1);return new u8(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,n,r){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=n,this._startLineDelta=r}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new J(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new G(i.lineNumber,i.column,i.lineNumber,i.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),o=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=o-r}invalidate(){this._isValid=!1}}class cDe{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,r){const o=this._asMap[e];if(o){const a=o.data,l=a[a.length-3],c=a[a.length-1];if(l===r&&c+1>=i){n>c&&(a[a.length-1]=n);return}a.push(r,i,n)}else{const a=new Pv(e,t,[r,i,n]);this._asMap[e]=a,this.asArray.push(a)}}}class uDe{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&p$(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>hDe(t,i),[]);return p$(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function hDe(s,e){const t=[];let i=0,n=0;for(;i<s.length&&n<e.length;){const r=s[i],o=e[n];if(r.endLineNumber<o.startLineNumber-1)t.push(s[i++]);else if(o.endLineNumber<r.startLineNumber-1)t.push(e[n++]);else{const a=Math.min(r.startLineNumber,o.startLineNumber),l=Math.max(r.endLineNumber,o.endLineNumber);t.push(new G(a,1,l,1)),i++,n++}}for(;i<s.length;)t.push(s[i++]);for(;n<e.length;)t.push(e[n++]);return t}function p$(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].equalsRange(e[t]))return!1;return!0}class _${constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}}class ib{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}var dDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},su=function(s,e){return function(t,i){e(t,i,s)}},Df,Pg;let i2=(Pg=class extends le{get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}get contextKeyService(){return this._contextKeyService}constructor(e,t,i,n,r,o,a,l,c,h,d,g){super(),this.languageConfigurationService=d,this._deliveryQueue=Eme(),this._contributions=this._register(new vke),this._onDidDispose=this._register(new Z),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeLineHeight=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeLineHeight=this._onDidChangeLineHeight.event,this._onDidChangeFont=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeFont=this._onDidChangeFont.event,this._onDidChangeModelTokens=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new Os(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new b$({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new b$({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new Os(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new Os(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new Os(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new Os(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new Os(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new Os(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new Os(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new Os(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new Os(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new Os(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onWillTriggerEditorOperationEvent=this._register(new Z),this._onBeginUpdate=this._register(new Z),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new Z),this.onEndUpdate=this._onEndUpdate.event,this._onBeforeExecuteEdit=this._register(new Z),this.onBeforeExecuteEdit=this._onBeforeExecuteEdit.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),this.inComposition=!1,r.willCreateCodeEditor();const p={...t};if(this._domElement=e,this._overflowWidgetsDomNode=p.overflowWidgetsDomNode,delete p.overflowWidgetsDomNode,this._id=++fDe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?xn.SimpleEditorContext:xn.EditorContext),p,h)),this._register(this._configuration.onDidChange(C=>{this._onDidChangeConfiguration.fire(C);const x=this._configuration.options;if(C.hasChanged(165)){const S=x.get(165);this._onDidLayoutChange.fire(S)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),i.contextKeyValues)for(const[C,x]of Object.entries(i.contextKeyValues))this._contextKeyService.createKey(C,x);this._notificationService=c,this._codeEditorService=r,this._commandService=o,this._themeService=l,this._register(new mDe(this,this._contextKeyService)),this._register(new pDe(this,this._contextKeyService,g)),this._instantiationService=this._register(n.createChild(new ib([Ot,this._contextKeyService]))),this._modelData=null,this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let _;Array.isArray(i.contributions)?_=i.contributions:_=F_.getEditorContributions(),this._contributions.initialize(this,_,this._instantiationService);for(const C of F_.getEditorActions()){if(this._actions.has(C.id)){$t(new Error(`Cannot have two actions with the same id ${C.id}`));continue}const x=new cee(C.id,C.label,C.alias,C.metadata,C.precondition??void 0,S=>this._instantiationService.invokeFunction(y=>Promise.resolve(C.runEditorCommand(y,this,S))),this._contextKeyService);this._actions.set(x.id,x)}const b=()=>!this._configuration.options.get(104)&&this._configuration.options.get(43).enabled;this._register(new I1e(this._domElement,{onDragOver:C=>{if(!b())return;const x=this.getTargetAtClientPoint(C.clientX,C.clientY);x!=null&&x.position&&this.showDropIndicatorAt(x.position)},onDrop:async C=>{if(!b()||(this.removeDropIndicator(),!C.dataTransfer))return;const x=this.getTargetAtClientPoint(C.clientX,C.clientY);x!=null&&x.position&&this._onDropIntoEditor.fire({position:x.position,event:C})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;(t=this._modelData)==null||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i,n){return new r5(e,t,i,this._domElement,n)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return ID.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Xi.getWordAtPosition(this._modelData.model,this._configuration.options.get(148),this._configuration.options.get(147),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){var t;try{this._beginUpdate();const i=e;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;const n={oldModelUrl:((t=this._modelData)==null?void 0:t.model.uri)||null,newModelUrl:(i==null?void 0:i.uri)||null};this._onWillChangeModel.fire(n);const r=this.hasTextFocus(),o=this._detachModel();this._attachModel(i),this.hasModel()?r&&this.focus():(this._editorTextFocus.setValue(!1),this._editorWidgetFocus.setValue(!1)),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(o),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(o.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?Df._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?Df._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber,n)}getBottomForLineNumber(e,t=!1){if(!this._modelData)return-1;const i=this._modelData.model.getLineMaxColumn(e);return Df._getVerticalOffsetAfterPosition(this._modelData,e,i,t)}getLineHeightForPosition(e){if(!this._modelData)return-1;const t=this._modelData.viewModel,i=t.coordinatesConverter,n=J.lift(e);if(i.modelPositionIsVisible(n)){const r=i.convertModelPositionToViewPosition(n);return t.viewLayout.getLineHeightForLineNumber(r.lineNumber)}return 0}setHiddenAreas(e,t,i){var n;(n=this._modelData)==null||n.viewModel.setHiddenAreas(e.map(r=>G.lift(r)),t,i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return Ai.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!J.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!G.isIRange(e))throw new Error("Invalid arguments");const r=this._modelData.model.validateRange(e),o=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(r);this._modelData.viewModel.revealRange("api",i,o,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new G(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!J.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new G(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=Lt.isISelection(e),n=G.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const r={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(r,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new Lt(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new G(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!G.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(G.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let n=0,r=e.length;n<r;n++)if(!Lt.isISelection(e[n]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const n=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(n)}}handleInitialized(){var e;(e=this._getViewModel())==null||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){i=i||{};try{switch(this._onWillTriggerEditorOperationEvent.fire({source:e,handlerId:t,payload:i}),this._beginUpdate(),t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const r=i;this._type(e,r.text||"");return}case"replacePreviousChar":{const r=i;this._compositionType(e,r.text||"",r.replaceCharCnt||0,0,0);return}case"compositionType":{const r=i;this._compositionType(e,r.text||"",r.replacePrevCharCnt||0,r.replaceNextCharCnt||0,r.positionDelta||0);return}case"paste":{const r=i;this._paste(e,r.text||"",r.pasteOnNewLine||!1,r.multicursorText||null,r.mode||null,r.clipboardEvent);return}case"cut":this._cut(e);return}const n=this.getAction(t);if(n){Promise.resolve(n.run(i)).then(void 0,$t);return}if(!this._modelData||this._triggerEditorCommand(e,t,i))return;this._triggerCommand(t,i)}finally{this._endUpdate()}}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this.inComposition=!0,this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this.inComposition=!1,this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,n,r){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,r,e)}_paste(e,t,i,n,r,o){if(!this._modelData)return;const a=this._modelData.viewModel,l=a.getSelection().getStartPosition();a.paste(t,i,n,e);const c=a.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:o,range:new G(l.lineNumber,l.column,c.lineNumber,c.column),languageId:r})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=F_.getEditorCommand(t);return n?(i=i||{},ar(i)&&(i.source=e),this._instantiationService.invokeFunction(r=>{Promise.resolve(n.runEditorCommand(r,this,i)).then(void 0,$t)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(104)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(104)?!1:(this._modelData.model.popStackElement(),!0)}edit(e,t){return this.executeEdits(t,e.replacements.map(i=>({range:i.range,text:i.text})),void 0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(104))return!1;let n;i?Array.isArray(i)?n=()=>i:n=i:n=()=>null;let r,o;return e instanceof mee?(o=e,r=e.metadata.source):(o=Ko.unknown({name:r}),r=e),this._onBeforeExecuteEdit.fire({source:r??void 0}),this._modelData.viewModel.executeEdits(r,t,n,o),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new _De(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){if(!this._modelData)return null;const t=this._configuration.options;return this._modelData.model.getLineDecorations(e,this._id,JL(t),ek(t))}getDecorationsInRange(e){if(!this._modelData)return null;const t=this._configuration.options;return this._modelData.model.getDecorationsInRange(e,this._id,JL(t),ek(t))}getFontSizeAtPosition(e){return this._modelData?this._modelData.viewModel.getFontSizeAtPosition(e):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.changeDecorations(i=>i.deltaDecorations(t,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(165)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,t=!1){this._configuration.observeContainer(e),t||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isWidgetFocused()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),n=this._configuration.options.get(165),r=Df._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),o=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft(),a=this.getLineHeightForPosition(t);return{top:r,left:o,height:a}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){vs(e,this._configuration.options.get(59))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),n=new lDe(this._id,this._configuration,e,Y7.create(Ue(this._domElement)),a8.create(this._configuration.options),a=>Ar(Ue(this._domElement),a),this.languageConfigurationService,this._themeService,i,{batchChanges:a=>{try{return this._beginUpdate(),a()}finally{this._endUpdate()}}});t.push(e.onWillDispose(()=>this.setModel(null))),t.push(n.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._editorWidgetFocus.setValue(a.hasFocus);break;case 3:this._onDidScrollChange.fire(a);break;case 4:this._onDidChangeViewZones.fire();break;case 5:this._onDidChangeHiddenAreas.fire();break;case 6:this._onDidAttemptReadOnlyEdit.fire();break;case 7:{if(a.reachedMaxCursorCount){const d=this.getOption(89),g=v(83,"The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",d);this._notificationService.prompt(tee.Warning,g,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:v(84,"Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let d=0,g=a.selections.length;d<g;d++)l[d]=a.selections[d].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const h={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(h);break}case 8:this._onDidChangeModelDecorations.fire(a.event);break;case 9:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 10:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 11:this._onDidChangeModelContent.fire(a.event);break;case 12:this._onDidChangeModelOptions.fire(a.event);break;case 13:this._onDidChangeModelTokens.fire(a.event);break;case 14:this._onDidChangeLineHeight.fire(a.event);break;case 15:this._onDidChangeFont.fire(a.event);break}}));const[r,o]=this._createView(n);if(o){this._domElement.appendChild(r.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const h=a[l];r.addContentWidget(this._contentWidgets[h])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const h=a[l];r.addOverlayWidget(this._overlayWidgets[h])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const h=a[l];r.addGlyphMarginWidget(this._glyphMarginWidgets[h])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new gDe(e,n,r,o,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(r,o,a,l)=>{this._paste("keyboard",r,o,a,l)},type:r=>{this._type("keyboard",r)},compositionType:(r,o,a,l)=>{this._compositionType("keyboard",r,o,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(r,o,a,l)=>{const c={text:r,pasteOnNewLine:o,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:r=>{const o={text:r};this._commandService.executeCommand("type",o)},compositionType:(r,o,a,l)=>{if(a||l){const c={text:r,replacePrevCharCnt:o,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:r,replaceCharCnt:o};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new zD(e.coordinatesConverter);return i.onKeyDown=r=>this._onKeyDown.fire(r),i.onKeyUp=r=>this._onKeyUp.fire(r),i.onContextMenu=r=>this._onContextMenu.fire(r),i.onMouseMove=r=>this._onMouseMove.fire(r),i.onMouseLeave=r=>this._onMouseLeave.fire(r),i.onMouseDown=r=>this._onMouseDown.fire(r),i.onMouseUp=r=>this._onMouseUp.fire(r),i.onMouseDrag=r=>this._onMouseDrag.fire(r),i.onMouseDrop=r=>this._onMouseDrop.fire(r),i.onMouseDropCanceled=r=>this._onMouseDropCanceled.fire(r),i.onMouseWheel=r=>this._onMouseWheel.fire(r),[new W5(this._domElement,this.getId(),t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e==null||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){var i;if((i=this._contributionsDisposable)==null||i.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&t.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new G(e.lineNumber,e.column,e.lineNumber,e.column),options:Df.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}},Df=Pg,Pg.dropIntoEditorDecorationOptions=Nn.register({description:"workbench-dnd-target",className:"dnd-target"}),Pg);i2=Df=dDe([su(3,It),su(4,In),su(5,Ao),su(6,Ot),su(7,Zr),su(8,Ba),su(9,Mo),su(10,kc),su(11,mi)],i2);let fDe=0,gDe=class{constructor(e,t,i,n,r,o){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=r,this.attachedView=o}dispose(){_n(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};class b$ extends le{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new Z(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new Z(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class Os extends Z{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class mDe extends le{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=Oe.editorSimpleInput.bindTo(t),this._editorFocus=Oe.focus.bindTo(t),this._textInputFocus=Oe.textInputFocus.bindTo(t),this._editorTextFocus=Oe.editorTextFocus.bindTo(t),this._tabMovesFocus=Oe.tabMovesFocus.bindTo(t),this._editorReadonly=Oe.readOnly.bindTo(t),this._inDiffEditor=Oe.inDiffEditor.bindTo(t),this._editorColumnSelection=Oe.columnSelection.bindTo(t),this._hasMultipleSelections=Oe.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=Oe.hasNonEmptySelection.bindTo(t),this._canUndo=Oe.canUndo.bindTo(t),this._canRedo=Oe.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(Ek.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(e.get(164)||Ek.getTabFocusMode()),this._editorReadonly.set(e.get(104)),this._inDiffEditor.set(e.get(70)),this._editorColumnSelection.set(e.get(28))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class pDe extends le{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=Oe.languageId.bindTo(t),this._hasCompletionItemProvider=Oe.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=Oe.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=Oe.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=Oe.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=Oe.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=Oe.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=Oe.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=Oe.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=Oe.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=Oe.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=Oe.hasReferenceProvider.bindTo(t),this._hasRenameProvider=Oe.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=Oe.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=Oe.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=Oe.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=Oe.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=Oe.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=Oe.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInEmbeddedEditor=Oe.isInEmbeddedEditor.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===tt.walkThroughSnippet||e.uri.scheme===tt.vscodeChatCodeBlock)})}}class _De{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}}const bDe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),wDe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function Bp(s){return bDe+encodeURIComponent(s.toString())+wDe}const vDe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),CDe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function w$(s){return vDe+encodeURIComponent(s.toString())+CDe}lh((s,e)=>{const t=s.getColor(N7);t&&(e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${Bp(t)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-error-decoration: url("data:image/svg+xml,${Bp(t)}"); }`));const i=s.getColor(Ad);i&&(e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${Bp(i)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-warning-decoration: url("data:image/svg+xml,${Bp(i)}"); }`));const n=s.getColor(cm);n&&(e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${Bp(n)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-info-decoration: url("data:image/svg+xml,${Bp(n)}"); }`));const r=s.getColor(Bve);r&&(e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${w$(r)}") no-repeat bottom left; }`),e.addRule(`:root { --monaco-editor-hint-decoration: url("data:image/svg+xml,${w$(r)}"); }`));const o=s.getColor(nxe);o&&(e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${o.rgba.a}; }`),e.addRule(`:root { --monaco-editor-unnecessary-decoration-opacity: ${o.rgba.a}; }`))});var yDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},SDe=function(s,e){return function(t,i){e(t,i,s)}};let aO=class extends le{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new Z),this._onCodeEditorAdd=this._register(new Z),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new Z),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new Z),this._onDiffEditorAdd=this._register(new Z),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new Z),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new Dr,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let r;this._modelProperties.has(n)?r=this._modelProperties.get(n):(r=new Map,this._modelProperties.set(n,r)),r.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const n of this._codeEditorOpenHandlers){const r=await n(e,t,i);if(r!==null)return r}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return qe(t)}};aO=yDe([SDe(0,Zr)],aO);var xDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},v$=function(s,e){return function(t,i){e(t,i,s)}};let n2=class extends aO{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,n,r)=>n?this.doOpenEditor(n,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const r=t.resource.scheme;if(r===tt.http||r===tt.https)return rZ(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const r={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};n2=xDe([v$(0,Ot),v$(1,Zr)],n2);yt(In,n2,0);const ch=gt("layoutService");var Mee=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Oee=function(s,e){return function(t,i){e(t,i,s)}};let s2=class{get mainContainer(){var e;return((e=this._codeEditorService.listCodeEditors().at(0))==null?void 0:e.getContainerDomNode())??ni.document.body}get activeContainer(){const e=this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor();return(e==null?void 0:e.getContainerDomNode())??this.mainContainer}get mainContainerDimension(){return T4(this.mainContainer)}get activeContainerDimension(){return T4(this.activeContainer)}get containers(){return x6(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())==null||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=Se.None,this.onDidLayoutActiveContainer=Se.None,this.onDidLayoutContainer=Se.None,this.onDidChangeActiveContainer=Se.None,this.onDidAddContainer=Se.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};s2=Mee([Oee(0,In)],s2);let lO=class extends s2{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};lO=Mee([Oee(1,In)],lO);yt(ch,s2,1);const Pee=gt("dialogService");var LDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},C$=function(s,e){return function(t,i){e(t,i,s)}};function dx(s){return s.scheme===tt.file?s.fsPath:s.path}let Fee=0;class fx{constructor(e,t,i,n,r,o,a){this.id=++Fee,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class y${constructor(e,t){this.resourceLabel=e,this.reason=t}}class S${constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(v(2030,"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(v(2031,"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class kDe{constructor(e,t,i,n,r,o,a){this.id=++Fee,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new S$),this.removedResources.has(t)||this.removedResources.set(t,new y$(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new S$),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new y$(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Bee{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new Tee(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,r=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,r=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}r!==-1&&(this._past=this._past.slice(0,r)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class KR{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const Vee=new Bee("","");Vee.locked=!0;let cO=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=eO.None,i=$f.None){if(e.type===0){const n=dx(e.resource),r=this.getUriComparisonKey(e.resource);this._pushElement(new fx(e,n,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,r=[],o=[];for(const a of e.resources){const l=dx(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),r.push(l),o.push(c))}r.length===1?this._pushElement(new fx(e,r[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new kDe(e,r,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],r=e.strResources[t];let o;this._editStacks.has(r)?o=this._editStacks.get(r):(o=new Bee(n,r),this._editStacks.set(r,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const r of i){const o=dx(r.resource),a=this.getUriComparisonKey(r.resource),l=new fx(r,o,a,0,0,0,0);n.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const r of i){const o=dx(r.resource),a=this.getUriComparisonKey(r.resource),l=new fx(r,o,a,0,0,0,0);n.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new Tee(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=n)}return[t,i]}canUndo(e){if(e instanceof $f){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){$t(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,r){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),n.dispose(),r()),l=>(o(),n.dispose(),this._onError(l,e))):(o(),n.dispose(),r())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return le.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?le.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(le.None);const i=e.actual.prepareUndoRedo();return i?rD(i)?t(i):i.then(n=>t(n)):t(le.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||Vee);return new KR(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new gx(this._undo(e,0,!0));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(n),new gx}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,v(2032,"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,v(2033,"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndUndo(e,t,null,v(2034,"Could not undo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,v(2035,"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,v(2036,"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),r=this._checkWorkspaceUndo(e,t,n,!1);return r?r.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,n){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(h){h[h.All=0]="All",h[h.This=1]="This",h[h.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:Ji.Info,message:v(2037,"Would you like to undo '{0}' across all files?",t.label),buttons:[{label:v(2038,"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:v(2039,"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;n=!0}let r;try{r=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return r.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,r,()=>this._continueUndoInGroup(t.groupId,n))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=v(2040,"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new KR([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof $f){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),r=n.getClosestPastElement();if(!r)return;if(r.groupId){const[a,l]=this._findClosestUndoElementInGroup(r.groupId);if(r!==a&&l)return this._undo(l,t,i)}if((r.sourceId!==t||r.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,r);try{return r.type===1?this._workspaceUndo(e,r,i):this._resourceUndo(n,r,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:v(2041,"Would you like to undo '{0}'?",i.label),primaryButton:v(2042,"&&Yes"),cancelButton:v(2043,"No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=n)}return[t,i]}canRedo(e){if(e instanceof $f){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new gx(this._redo(e));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(n),new gx}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,v(2044,"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,v(2045,"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndRedo(e,t,null,v(2046,"Could not redo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,v(2047,"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,v(2048,"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let n;try{n=await this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const r=this._checkWorkspaceRedo(e,t,i,!0);if(r)return n.dispose(),r.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=v(2049,"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new KR([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof $f){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,r]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&r)return this._redo(r)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};cO=LDe([C$(0,Pee),C$(1,Ba)],cO);class gx{constructor(e){this.returnValue=e}}yt(o8,cO,1);function xr(s,e,t){return Math.min(Math.max(s,e),t)}class Hee{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class EDe{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const Wee=gt("environmentService");var DDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},x$=function(s,e){return function(t,i){e(t,i,s)}};const TDe=gt("ILanguageFeatureDebounceService");var r2;(function(s){const e=new WeakMap;let t=0;function i(n){let r=e.get(n);return r===void 0&&(r=++t,e.set(n,r)),r}s.of=i})(r2||(r2={}));class NDe{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class IDe{constructor(e,t,i,n,r,o){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=r,this._max=o,this._cache=new jC(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>dD(r2.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?xr(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new EDe(6),this._cache.set(i,n));const r=xr(n.update(t),this._min,this._max);return X6(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){const e=new Hee;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return xr(e,this._min,this._max)}}let uO=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){const n=(i==null?void 0:i.min)??50,r=(i==null?void 0:i.max)??n**2,o=(i==null?void 0:i.key)??void 0,a=`${r2.of(e)},${n}${o?","+o:""}`;let l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new NDe(n*1.5)):l=new IDe(this._logService,t,e,this._overallAverage()|0||n*1.5,n,r),this._data.set(a,l)),l}_overallAverage(){const e=new Hee;for(const t of this._data.values())e.update(t.default());return e.value}};uO=DDe([x$(0,pr),x$(1,Wee)],uO);yt(TDe,uO,1);var RDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},YR=function(s,e){return function(t,i){e(t,i,s)}};let hO=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new dO}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),r=this._hashTable.get(e,t,n);let o;if(r)o=r.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let d=0;c>0&&d<this._legend.tokenModifiers.length;d++)c&1&&l.push(this._legend.tokenModifiers[d]),c=c>>1;const h=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof h>"u")o=2147483647;else{if(o=0,typeof h.italic<"u"){const d=(h.italic?1:0)<<11;o|=d|1}if(typeof h.bold<"u"){const d=(h.bold?2:0)<<11;o|=d|2}if(typeof h.underline<"u"){const d=(h.underline?4:0)<<11;o|=d|4}if(typeof h.strikethrough<"u"){const d=(h.strikethrough?8:0)<<11;o|=d|8}if(h.foreground){const d=h.foreground<<15;o|=d|16}o===0&&(o=2147483647)}}else o=2147483647,a="not-in-legend";this._hashTable.add(e,t,n,o)}return o}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,n,r){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${n} is outside the previous data (length ${r}).`))}};hO=RDe([YR(1,Zr),YR(2,Qn),YR(3,pr)],hO);class ADe{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}const wu=class wu{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=wu._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<wu._SIZES.length?2/3*this._currentLength:0),this._elements=[],wu._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let r=this._elements[n];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===i)return r;r=r.next}return null}add(e,t,i,n){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const r=this._elements;this._currentLengthIndex++,this._currentLength=wu._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<wu._SIZES.length?2/3*this._currentLength:0),this._elements=[],wu._nullOutEntries(this._elements,this._currentLength);for(const o of r){let a=o;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new ADe(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}};wu._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];let dO=wu;const MDe=gt("semanticTokensStylingService");var ODe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},QR=function(s,e){return function(t,i){e(t,i,s)}};let fO=class extends le{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new hO(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};fO=ODe([QR(0,Zr),QR(1,pr),QR(2,Qn)],fO);yt(MDe,fO,1);const mx="**",L$="/",nL="[/\\\\]",sL="[^/\\\\]",PDe=/\//g;function k$(s,e){switch(s){case 0:return"";case 1:return`${sL}*?`;default:return`(?:${nL}|${sL}+${nL}${e?`|${nL}${sL}+`:""})*?`}}function E$(s,e){if(!s)return[];const t=[];let i=!1,n=!1,r="";for(const o of s){switch(o){case e:if(!i&&!n){t.push(r),r="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}r+=o}return r&&t.push(r),t}function zee(s){if(!s)return"";let e="";const t=E$(s,L$);if(t.every(i=>i===mx))e=".*";else{let i=!1;t.forEach((n,r)=>{if(n===mx){if(i)return;e+=k$(2,r===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const h of n){if(h!=="}"&&o){a+=h;continue}if(l&&(h!=="]"||!c)){let d;h==="-"?d=h:(h==="^"||h==="!")&&!c?d="^":h===L$?d="":d=pc(h),c+=d;continue}switch(h){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const g=`(?:${E$(a,",").map(p=>zee(p)).join("|")})`;e+=g,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=sL;continue;case"*":e+=k$(1);continue;default:e+=pc(h)}}r<t.length-1&&(t[r+1]!==mx||r+2<t.length)&&(e+=nL)}i=n===mx})}return e}const FDe=/^\*\*\/\*\.[\w\.-]+$/,BDe=/^\*\*\/([\w\.-]+)\/?$/,VDe=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,HDe=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,WDe=/^\*\*((\/[\w\.-]+)+)\/?$/,zDe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,D$=new jC(1e4),T$=function(){return!1},oc=function(){return null};function h8(s,e){if(!s)return oc;let t;typeof s!="string"?t=s.pattern:t=s,t=t.trim();const i=e.ignoreCase??!1,n={...e,equals:i?og:(l,c)=>l===c,endsWith:i?c_e:(l,c)=>l.endsWith(c),isEqualOrParent:(l,c)=>F4(l,c,!Gr||i)},r=`${i?t.toLowerCase():t}_${!!e.trimForExclusions}_${i}`;let o=D$.get(r);if(o)return N$(o,s,n);let a;return FDe.test(t)?o=UDe(t.substring(4),t,n):(a=BDe.exec(XR(t,n)))?o=jDe(a[1],t,n):(e.trimForExclusions?HDe:VDe).test(t)?o=$De(t,n):(a=WDe.exec(XR(t,n)))?o=I$(a[1].substring(1),t,!0,n):(a=zDe.exec(XR(t,n)))?o=I$(a[1],t,!1,n):o=qDe(t,n),D$.set(r,o),N$(o,s,n)}function N$(s,e,t){if(typeof e=="string")return s;const i=function(n,r){return t.isEqualOrParent(n,e.base)?s(lD(n.substring(e.base.length),bd),r):null};return i.allBasenames=s.allBasenames,i.allPaths=s.allPaths,i.basenames=s.basenames,i.patterns=s.patterns,i}function XR(s,e){return e.trimForExclusions&&s.endsWith("/**")?s.substring(0,s.length-2):s}function UDe(s,e,t){return function(i,n){return typeof i=="string"&&t.endsWith(i,s)?e:null}}function jDe(s,e,t){const i=`/${s}`,n=`\\${s}`,r=function(a,l){return typeof a!="string"?null:l?t.equals(l,s)?e:null:t.equals(a,s)||t.endsWith(a,i)||t.endsWith(a,n)?e:null},o=[s];return r.basenames=o,r.patterns=[e],r.allBasenames=o,r}function $De(s,e){const t=jee(s.slice(1,-1).split(",").map(a=>h8(a,e)).filter(a=>a!==oc),s),i=t.length;if(!i)return oc;if(i===1)return t[0];const n=function(a,l){for(let c=0,h=t.length;c<h;c++)if(t[c](a,l))return s;return null},r=t.find(a=>!!a.allBasenames);r&&(n.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function I$(s,e,t,i){const n=bd===dn.sep,r=n?s:s.replace(PDe,bd),o=bd+r,a=dn.sep+s;let l;return t?l=function(c,h){return typeof c=="string"&&(i.equals(c,r)||i.endsWith(c,o)||!n&&(i.equals(c,s)||i.endsWith(c,a)))?e:null}:l=function(c,h){return typeof c=="string"&&(i.equals(c,r)||!n&&i.equals(c,s))?e:null},l.allPaths=[(t?"*/":"./")+s],l}function qDe(s,e){try{const t=new RegExp(`^${zee(s)}$`,e.ignoreCase?"i":void 0);return function(i){return t.lastIndex=0,typeof i=="string"&&t.test(i)?s:null}}catch{return oc}}function GDe(s,e,t){return!s||typeof e!="string"?!1:Uee(s,t)(e)}function Uee(s,e={}){if(!s)return T$;if(typeof s=="string"||KDe(s)){const t=h8(s,e);if(t===oc)return T$;const i=function(n,r){return!!t(n,r)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return YDe(s,e)}function KDe(s){const e=s;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function YDe(s,e){const t=jee(Object.getOwnPropertyNames(s).map(a=>QDe(a,s[a],e)).filter(a=>a!==oc)),i=t.length;if(!i)return oc;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(h,d){let g;for(let p=0,_=t.length;p<_;p++){const b=t[p](h,d);if(typeof b=="string")return b;w4(b)&&(g||(g=[]),g.push(b))}return g?(async()=>{for(const p of g){const _=await p;if(typeof _=="string")return _}return null})():null},l=t.find(h=>!!h.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((h,d)=>d.allPaths?h.concat(d.allPaths):h,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let h,d;for(let g=0,p=t.length;g<p;g++){const _=t[g];_.requiresSiblings&&c&&(l||(l=kX(a)),h||(h=l.substring(0,l.length-Hpe(a).length)));const b=_(a,l,h,c);if(typeof b=="string")return b;w4(b)&&(d||(d=[]),d.push(b))}return d?(async()=>{for(const g of d){const p=await g;if(typeof p=="string")return p}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(n.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function QDe(s,e,t){if(e===!1)return oc;const i=h8(s,t);if(i===oc)return oc;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const r=(o,a,l,c)=>{if(!c||!i(o,a))return null;const h=n.replace("$(basename)",()=>l),d=c(h);return w4(d)?d.then(g=>g?s:null):d?s:null};return r.requiresSiblings=!0,r}}return i}function jee(s,e){const t=s.filter(a=>!!a.basenames);if(t.length<2)return s;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const r=function(a,l){if(typeof a!="string")return null;if(!l){let h;for(h=a.length;h>0;h--){const d=a.charCodeAt(h-1);if(d===47||d===92)break}l=a.substring(h)}const c=i.indexOf(l);return c!==-1?n[c]:null};r.basenames=i,r.patterns=n,r.allBasenames=i;const o=s.filter(a=>!a.basenames);return o.push(r),o}function $ee(s,e,t,i,n,r){if(Array.isArray(s)){let o=0;for(const a of s){const l=$ee(a,e,t,i,n,r);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof s=="string")return i?s==="*"?5:s===t?10:0:0;if(s){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:h}=s;if(!i&&!c)return 0;h&&n&&(e=n);let d=0;if(l)if(l===e.scheme)d=10;else if(l==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(h)if(h===r)d=10;else if(h==="*"&&r!==void 0)d=Math.max(d,5);else return 0;if(a){let g;if(typeof a=="string"?g=a:g={...a,base:LX(a.base)},g===e.fsPath||GDe(g,e.fsPath))d=10;else return 0}return d}else return 0}}function qee(s){return typeof s=="string"?!1:Array.isArray(s)?s.every(qee):!!s.exclusive}class R${constructor(e,t,i,n,r){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n,this.recursive=r}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)==null?void 0:t.toString())===((i=e.notebookUri)==null?void 0:i.toString())&&this.recursive===e.recursive}}class Ni{get onDidChange(){return this._onDidChange.event}constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new Z}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),qe(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,n=>i.push(n.provider)),i}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,!1,r=>{i&&n===r._score?i.push(r.provider):(n=r._score,i=[r.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const n of this._entries)n._score>0&&i(n)}_updateScores(e,t){var r,o;const i=(r=this._notebookInfoResolver)==null?void 0:r.call(this,e.uri),n=i?new R$(e.uri,e.getLanguageId(),i.uri,i.type,t):new R$(e.uri,e.getLanguageId(),void 0,void 0,t);if(!((o=this._lastCandidate)!=null&&o.equals(n))){this._lastCandidate=n;for(const a of this._entries)if(a._score=$ee(a.selector,n.uri,n.languageId,M0e(e),n.notebookUri,n.notebookType),qee(a.selector)&&a._score>0)if(t)a._score=0;else{for(const l of this._entries)l._score=0;a._score=1e3;break}this._entries.sort(Ni._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:O0(e.selector)&&!O0(t.selector)?1:!O0(e.selector)&&O0(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function O0(s){return typeof s=="string"?!1:Array.isArray(s)?s.some(O0):!!s.isBuiltin}class XDe{constructor(){this.referenceProvider=new Ni(this._score.bind(this)),this.renameProvider=new Ni(this._score.bind(this)),this.newSymbolNamesProvider=new Ni(this._score.bind(this)),this.codeActionProvider=new Ni(this._score.bind(this)),this.definitionProvider=new Ni(this._score.bind(this)),this.typeDefinitionProvider=new Ni(this._score.bind(this)),this.declarationProvider=new Ni(this._score.bind(this)),this.implementationProvider=new Ni(this._score.bind(this)),this.documentSymbolProvider=new Ni(this._score.bind(this)),this.inlayHintsProvider=new Ni(this._score.bind(this)),this.colorProvider=new Ni(this._score.bind(this)),this.codeLensProvider=new Ni(this._score.bind(this)),this.documentFormattingEditProvider=new Ni(this._score.bind(this)),this.documentRangeFormattingEditProvider=new Ni(this._score.bind(this)),this.onTypeFormattingEditProvider=new Ni(this._score.bind(this)),this.signatureHelpProvider=new Ni(this._score.bind(this)),this.hoverProvider=new Ni(this._score.bind(this)),this.documentHighlightProvider=new Ni(this._score.bind(this)),this.multiDocumentHighlightProvider=new Ni(this._score.bind(this)),this.selectionRangeProvider=new Ni(this._score.bind(this)),this.foldingRangeProvider=new Ni(this._score.bind(this)),this.linkProvider=new Ni(this._score.bind(this)),this.inlineCompletionsProvider=new Ni(this._score.bind(this)),this.completionProvider=new Ni(this._score.bind(this)),this.linkedEditingRangeProvider=new Ni(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new Ni(this._score.bind(this)),this.documentSemanticTokensProvider=new Ni(this._score.bind(this)),this.documentDropEditProvider=new Ni(this._score.bind(this)),this.documentPasteEditProvider=new Ni(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)==null?void 0:t.call(this,e)}}yt(mi,XDe,1);var ZDe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},A$=function(s,e){return function(t,i){e(t,i,s)}};const ty=gt("hoverService");let tC=class extends le{get delay(){var e;return this.isInstantlyHovering()?0:(e=this.hoverOptions)!=null&&e.dynamicDelay?t=>{var i,n;return((n=(i=this.hoverOptions)==null?void 0:i.dynamicDelay)==null?void 0:n.call(i,t))??this._delay}:this._delay}constructor(e,t,i={},n,r){super(),this.placement=e,this.hoverOptions=t,this.overrideOptions=i,this.configurationService=n,this.hoverService=r,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new Pe),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(e,t){const i=typeof this.overrideOptions=="function"?this.overrideOptions(e,t):this.overrideOptions;this.hoverDisposables.clear();const n=nn(e.target)?[e.target]:e.target.targetElements;for(const o of n)this.hoverDisposables.add(bs(o,"keydown",a=>{a.equals(9)&&this.hoverService.hideHover()}));const r=nn(e.content)?void 0:typeof e.content=="string"?e.content.toString():e.content.value;return this.hoverService.showInstantHover({...e,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:r,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},t)}isInstantlyHovering(){var e;return!!((e=this.hoverOptions)!=null&&e.instantHover)&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){var e;this.hoverDisposables.clear(),(e=this.hoverOptions)!=null&&e.instantHover&&(this.lastHoverHideTime=Date.now())}};tC=ZDe([A$(3,yi),A$(4,ty)],tC);const iy=gt("contextViewService"),uh=gt("contextMenuService"),px=Ke;let JDe=class extends le{constructor(e){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.classList.toggle("fade-in",!!e),this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new F7(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class d8 extends le{static render(e,t,i){return new d8(e,t,i)}constructor(e,t,i){super(),this.actionLabel=t.label,this.actionKeybindingLabel=i,this.actionContainer=Be(e,px("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=Be(this.actionContainer,px("a.action")),this.action.setAttribute("role","button"),t.iconClass&&Be(this.action,px("span.icon")).classList.add(...t.iconClass.split(" ")),this.actionRenderedLabel=i?`${t.label} (${i})`:t.label;const n=Be(this.action,px("span"));n.textContent=this.actionRenderedLabel,this._store.add(new tTe(this.actionContainer,t.run)),this._store.add(new iTe(this.actionContainer,t.run,[3,10])),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function eTe(s,e){return s&&e?v(7,"Inspect this in the accessible view with {0}.",e):s?v(8,"Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class tTe extends le{constructor(e,t){super(),this._register(ie(e,Le.CLICK,i=>{i.stopPropagation(),i.preventDefault(),t(e)}))}}class iTe extends le{constructor(e,t,i){super(),this._register(ie(e,Le.KEY_DOWN,n=>{const r=new si(n);i.some(o=>r.equals(o))&&(n.stopPropagation(),n.preventDefault(),t(e))}))}}function Gee(...s){return function(e,t){for(let i=0,n=s.length;i<n;i++){const r=s[i](e,t);if(r)return r}return null}}Kee.bind(void 0,!1);const o2=Kee.bind(void 0,!0);function Kee(s,e,t){if(!t||t.length<e.length)return null;let i;return s?i=W6(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function nTe(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t===-1?null:[{start:t,end:t+s.length}]}function sTe(s,e){return gO(s.toLowerCase(),e.toLowerCase(),0,0)}function gO(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]===e[i]){let n=null;return(n=gO(s,e,t+1,i+1))?Qee({start:i,end:i+1},n):null}return gO(s,e,t,i+1)}function f8(s){return 97<=s&&s<=122}function $D(s){return 65<=s&&s<=90}function g8(s){return 48<=s&&s<=57}function rTe(s){return s===32||s===9||s===10||s===13}const oTe=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(s=>oTe.add(s.charCodeAt(0)));function Yee(s){return f8(s)||$D(s)||g8(s)}function Qee(s,e){return e.length===0?e=[s]:s.end===e[0].start?e[0].start=s.start:e.unshift(s),e}function Xee(s,e){for(let t=e;t<s.length;t++){const i=s.charCodeAt(t);if($D(i)||g8(i)||t>0&&!Yee(s.charCodeAt(t-1)))return t}return s.length}function mO(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]!==e[i].toLowerCase())return null;{let n=null,r=i+1;for(n=mO(s,e,t+1,i+1);!n&&(r=Xee(e,r))<e.length;)n=mO(s,e,t+1,r),r++;return n===null?null:Qee({start:i,end:i+1},n)}}function aTe(s){let e=0,t=0,i=0,n=0,r=0;for(let h=0;h<s.length;h++)r=s.charCodeAt(h),$D(r)&&e++,f8(r)&&t++,Yee(r)&&i++,g8(r)&&n++;const o=e/s.length,a=t/s.length,l=i/s.length,c=n/s.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function lTe(s){const{upperPercent:e,lowerPercent:t}=s;return t===0&&e>.6}function cTe(s){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=s;return t>.2&&e<.8&&i>.6&&n<.2}function uTe(s){let e=0,t=0,i=0,n=0;for(let r=0;r<s.length;r++)i=s.charCodeAt(r),$D(i)&&e++,f8(i)&&t++,rTe(i)&&n++;return(e===0||t===0)&&n===0?s.length<=30:e<=5}function Zee(s,e){if(!e||(e=e.trim(),e.length===0)||!uTe(s))return null;e.length>60&&(e=e.substring(0,60));const t=aTe(e);if(!cTe(t)){if(!lTe(t))return null;e=e.toLowerCase()}let i=null,n=0;for(s=s.toLowerCase();n<e.length&&(i=mO(s,e,0,n))===null;)n=Xee(e,n+1);return i}const hTe=Gee(o2,Zee,nTe),dTe=Gee(o2,Zee,sTe),M$=new jC(1e4);function O$(s,e,t=!1){if(typeof s!="string"||typeof e!="string")return null;let i=M$.get(s);i||(i=new RegExp(l_e(s),"i"),M$.set(s,i));const n=i.exec(e);return n?[{start:n.index,end:n.index+n[0].length}]:t?dTe(s,e):hTe(s,e)}function fTe(s,e){const t=tte(s,s.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?gTe(t):null}function gTe(s){if(typeof s>"u")return[];const e=[],t=s[1];for(let i=s.length-1;i>1;i--){const n=s[i]+t,r=e[e.length-1];r&&r.end===n?r.end=n+1:e.push({start:n,end:n+1})}return e}const ld=128;function m8(){const s=[],e=[];for(let t=0;t<=ld;t++)e[t]=0;for(let t=0;t<=ld;t++)s.push(e.slice(0));return s}function Jee(s){const e=[];for(let t=0;t<=s;t++)e[t]=0;return e}const ete=Jee(2*ld),pO=Jee(2*ld),ru=m8(),_f=m8(),_x=m8();function bx(s,e){if(e<0||e>=s.length)return!1;const t=s.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!q6(t)}}function P$(s,e){if(e<0||e>=s.length)return!1;switch(s.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function rL(s,e,t){return e[s]!==t[s]}function mTe(s,e,t,i,n,r,o=!1){for(;e<t&&n<r;)s[e]===i[n]&&(o&&(ete[e]=n),e+=1),n+=1;return e===t}var Ng;(function(s){s.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}s.isDefault=e})(Ng||(Ng={}));const h9=class h9{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};h9.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};let _O=h9;function tte(s,e,t,i,n,r,o=_O.default){const a=s.length>ld?ld:s.length,l=i.length>ld?ld:i.length;if(t>=a||r>=l||a-t>l-r||!mTe(e,t,a,n,r,l,!0))return;pTe(a,l,t,r,e,n);let c=1,h=1,d=t,g=r;const p=[!1];for(c=1,d=t;d<a;c++,d++){const S=ete[d],y=pO[d],k=d+1<a?pO[d+1]:l;for(h=S-r+1,g=S;g<k;h++,g++){let D=Number.MIN_SAFE_INTEGER,R=!1;g<=y&&(D=_Te(s,e,d,t,i,n,g,l,r,ru[c-1][h-1]===0,p));let N=0;D!==Number.MIN_SAFE_INTEGER&&(R=!0,N=D+_f[c-1][h-1]);const A=g>S,M=A?_f[c][h-1]+(ru[c][h-1]>0?-5:0):0,O=g>S+1&&ru[c][h-1]>0,V=O?_f[c][h-2]+(ru[c][h-2]>0?-5:0):0;if(O&&(!A||V>=M)&&(!R||V>=N))_f[c][h]=V,_x[c][h]=3,ru[c][h]=0;else if(A&&(!R||M>=N))_f[c][h]=M,_x[c][h]=2,ru[c][h]=0;else if(R)_f[c][h]=N,_x[c][h]=1,ru[c][h]=ru[c-1][h-1]+1;else throw new Error("not possible")}}if(!p[0]&&!o.firstMatchCanBeWeak)return;c--,h--;const _=[_f[c][h],r];let b=0,C=0;for(;c>=1;){let S=h;do{const y=_x[c][S];if(y===3)S=S-2;else if(y===2)S=S-1;else break}while(S>=1);b>1&&e[t+c-1]===n[r+h-1]&&!rL(S+r-1,i,n)&&b+1>ru[c][S]&&(S=h),S===h?b++:b=1,C||(C=S),c--,h=S-1,_.push(h)}l-r===a&&o.boostFullMatch&&(_[0]+=2);const x=C-a;return _[0]-=x,_}function pTe(s,e,t,i,n,r){let o=s-1,a=e-1;for(;o>=t&&a>=i;)n[o]===r[a]&&(pO[o]=a,o--),a--}function _Te(s,e,t,i,n,r,o,a,l,c,h){if(e[t]!==r[o])return Number.MIN_SAFE_INTEGER;let d=1,g=!1;return o===t-i?d=s[t]===n[o]?7:5:rL(o,n,r)&&(o===0||!rL(o-1,n,r))?(d=s[t]===n[o]?7:5,g=!0):bx(r,o)&&(o===0||!bx(r,o-1))?d=5:(bx(r,o-1)||P$(r,o-1))&&(d=5,g=!0),d>1&&t===i&&(h[0]=!0),g||(g=rL(o,n,r)||bx(r,o-1)||P$(r,o-1)),t===i?o>l&&(d-=g?3:5):c?d+=g?2:0:d+=g?0:1,o+1===a&&(d-=g?3:5),d}const bTe="$(",p8=new RegExp(`\\$\\(${Ct.iconNameExpression}(?:${Ct.iconModifierExpression})?\\)`,"g"),wTe=new RegExp(`(\\\\)?${p8.source}`,"g");function vTe(s){return s.replace(wTe,(e,t)=>t?e:`\\${e}`)}const CTe=new RegExp(`\\\\${p8.source}`,"g");function yTe(s){return s.replace(CTe,e=>`\\${e}`)}const STe=new RegExp(`(\\s)?(\\\\)?${p8.source}(\\s)?`,"g");function ite(s){return s.indexOf(bTe)===-1?s:s.replace(STe,(e,t,i,n)=>i?e:t||n||"")}function nte(s){return s?s.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const ZR=new RegExp(`\\$\\(${Ct.iconNameCharacter}+\\)`,"g");function fg(s){ZR.lastIndex=0;let e="";const t=[];let i=0;for(;;){const n=ZR.lastIndex,r=ZR.exec(s),o=s.substring(n,r==null?void 0:r.index);if(o.length>0){e+=o;for(let a=0;a<o.length;a++)t.push(i)}if(!r)break;i+=r[0].length}return{text:e,iconOffsets:t}}function ww(s,e,t=!1){const{text:i,iconOffsets:n}=e;if(!n||n.length===0)return O$(s,i,t);const r=lD(i," "),o=i.length-r.length,a=O$(s,r,t);if(a)for(const l of a){const c=n[l.start+o]+o;l.start+=c,l.end+=c}return a}class ste{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw sD("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1,this.supportAlertSyntax=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1,this.supportAlertSyntax=t.supportAlertSyntax??!1)}appendText(e,t=0){return this.value+=LTe(this.supportThemeIcons?vTe(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${kTe(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(pc(t),"g");return e.replace(i,(n,r)=>e.charAt(r-1)!=="\\"?`\\${n}`:n)}}function vw(s){return s instanceof ste?!0:s&&typeof s=="object"?typeof s.value=="string"&&(typeof s.isTrusted=="boolean"||typeof s.isTrusted=="object"||s.isTrusted===void 0)&&(typeof s.supportThemeIcons=="boolean"||s.supportThemeIcons===void 0)&&(typeof s.supportAlertSyntax=="boolean"||s.supportAlertSyntax===void 0):!1}function xTe(s,e){return s===e?!0:!s||!e?!1:s.value===e.value&&s.isTrusted===e.isTrusted&&s.supportThemeIcons===e.supportThemeIcons&&s.supportHtml===e.supportHtml&&s.supportAlertSyntax===e.supportAlertSyntax&&(s.baseUri===e.baseUri||!!s.baseUri&&!!e.baseUri&&pbe(mt.from(s.baseUri),mt.from(e.baseUri)))}function LTe(s){return s.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function kTe(s,e){var n;const t=((n=s.match(/^`+/gm))==null?void 0:n.reduce((r,o)=>r.length>o.length?r:o).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,s,`${"`".repeat(i)}`].join(`
`)}function wx(s){return s.replace(/"/g,"&quot;")}function JR(s){return s&&s.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function ETe(s){const e=[],t=s.split("|").map(n=>n.trim());s=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),r=/width=(\d+)/.exec(i),o=n?n[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:s,dimensions:e}}class rte{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const F$=new rte("id#");function _8(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Mm=_8();function ote(s){Mm=s}const ate=/[&<>"']/,DTe=new RegExp(ate.source,"g"),lte=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,TTe=new RegExp(lte.source,"g"),NTe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},B$=s=>NTe[s];function Yo(s,e){if(e){if(ate.test(s))return s.replace(DTe,B$)}else if(lte.test(s))return s.replace(TTe,B$);return s}const ITe=/(^|[^\[])\^/g;function $i(s,e){let t=typeof s=="string"?s:s.source;e=e||"";const i={replace:(n,r)=>{let o=typeof r=="string"?r:r.source;return o=o.replace(ITe,"$1"),t=t.replace(n,o),i},getRegex:()=>new RegExp(t,e)};return i}function V$(s){try{s=encodeURI(s).replace(/%25/g,"%")}catch{return null}return s}const Cw={exec:()=>null};function H$(s,e){const t=s.replace(/\|/g,(r,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=t.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function m0(s,e,t){const i=s.length;if(i===0)return"";let n=0;for(;n<i&&s.charAt(i-n-1)===e;)n++;return s.slice(0,i-n)}function RTe(s,e){if(s.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<s.length;i++)if(s[i]==="\\")i++;else if(s[i]===e[0])t++;else if(s[i]===e[1]&&(t--,t<0))return i;return-1}function W$(s,e,t,i){const n=e.href,r=e.title?Yo(e.title):null,o=s[1].replace(/\\([\[\]])/g,"$1");if(s[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:n,title:r,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:t,href:n,title:r,text:Yo(o)}}function ATe(s,e){const t=s.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(n=>{const r=n.match(/^\s+/);if(r===null)return n;const[o]=r;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}class a2{constructor(e){an(this,"options");an(this,"rules");an(this,"lexer");this.options=e||Mm}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:m0(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],n=ATe(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const n=m0(i,"#");(this.options.pedantic||!n||/ $/.test(n))&&(i=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:m0(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=m0(t[0],`
`).split(`
`),n="",r="";const o=[];for(;i.length>0;){let a=!1;const l=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))l.push(i[c]),a=!0;else if(!a)l.push(i[c]);else break;i=i.slice(c);const h=l.join(`
`),d=h.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");n=n?`${n}
${h}`:h,r=r?`${r}
${d}`:d;const g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=g,i.length===0)break;const p=o[o.length-1];if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const _=p,b=_.raw+`
`+i.join(`
`),C=this.blockquote(b);o[o.length-1]=C,n=n.substring(0,n.length-_.raw.length)+C.raw,r=r.substring(0,r.length-_.text.length)+C.text;break}else if((p==null?void 0:p.type)==="list"){const _=p,b=_.raw+`
`+i.join(`
`),C=this.list(b);o[o.length-1]=C,n=n.substring(0,n.length-p.raw.length)+C.raw,r=r.substring(0,r.length-_.raw.length)+C.raw,i=b.substring(o[o.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:o,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const n=i.length>1,r={type:"list",raw:"",ordered:n,start:n?+i.slice(0,-1):"",loose:!1,items:[]};i=n?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=n?i:"[*+-]");const o=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a=!1;for(;e;){let l=!1,c="",h="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(/^\t+/,x=>" ".repeat(3*x.length)),g=e.split(`
`,1)[0],p=!d.trim(),_=0;if(this.options.pedantic?(_=2,h=d.trimStart()):p?_=t[1].length+1:(_=t[2].search(/[^ ]/),_=_>4?1:_,h=d.slice(_),_+=t[1].length),p&&/^ *$/.test(g)&&(c+=g+`
`,e=e.substring(g.length+1),l=!0),!l){const x=new RegExp(`^ {0,${Math.min(3,_-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),S=new RegExp(`^ {0,${Math.min(3,_-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),y=new RegExp(`^ {0,${Math.min(3,_-1)}}(?:\`\`\`|~~~)`),k=new RegExp(`^ {0,${Math.min(3,_-1)}}#`);for(;e;){const D=e.split(`
`,1)[0];if(g=D,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),y.test(g)||k.test(g)||x.test(g)||S.test(e))break;if(g.search(/[^ ]/)>=_||!g.trim())h+=`
`+g.slice(_);else{if(p||d.search(/[^ ]/)>=4||y.test(d)||k.test(d)||S.test(d))break;h+=`
`+g}!p&&!g.trim()&&(p=!0),c+=D+`
`,e=e.substring(D.length+1),d=g.slice(_)}}r.loose||(a?r.loose=!0:/\n *\n *$/.test(c)&&(a=!0));let b=null,C;this.options.gfm&&(b=/^\[[ xX]\] /.exec(h),b&&(C=b[0]!=="[ ] ",h=h.replace(/^\[[ xX]\] +/,""))),r.items.push({type:"list_item",raw:c,task:!!b,checked:C,loose:!1,text:h,tokens:[]}),r.raw+=c}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd(),r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd(),r.raw=r.raw.trimEnd();for(let l=0;l<r.items.length;l++)if(this.lexer.state.top=!1,r.items[l].tokens=this.lexer.blockTokens(r.items[l].text,[]),!r.loose){const c=r.items[l].tokens.filter(d=>d.type==="space"),h=c.length>0&&c.some(d=>/\n.*\n/.test(d.raw));r.loose=h}if(r.loose)for(let l=0;l<r.items.length;l++)r.items[l].loose=!0;return r}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=H$(t[1]),n=t[2].replace(/^\||\| *$/g,"").split("|"),r=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===n.length){for(const a of n)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<i.length;a++)o.header.push({text:i[a],tokens:this.lexer.inline(i[a]),header:!0,align:o.align[a]});for(const a of r)o.rows.push(H$(a,o.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[c]})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Yo(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=m0(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=RTe(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],r=o[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),W$(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const n=(i[2]||i[1]).replace(/\s+/g," "),r=t[n.toLowerCase()];if(!r){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return W$(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(n[1]||n[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const o=[...n[0]].length-1;let a,l,c=o,h=0;const d=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(n=d.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(l=[...a].length,n[3]||n[4]){c+=l;continue}else if((n[5]||n[6])&&o%3&&!((o+l)%3)){h+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+h);const g=[...n[0]][0].length,p=e.slice(0,o+n.index+g+l);if(Math.min(o,l)%2){const b=p.slice(1,-1);return{type:"em",raw:p,text:b,tokens:this.lexer.inlineTokens(b)}}const _=p.slice(2,-2);return{type:"strong",raw:p,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const n=/[^ ]/.test(i),r=/^ /.test(i)&&/ $/.test(i);return n&&r&&(i=i.substring(1,i.length-1)),i=Yo(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,n;return t[2]==="@"?(i=Yo(t[1]),n="mailto:"+i):(i=Yo(t[1]),n=i),{type:"link",raw:t[0],text:i,href:n,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=Yo(t[0]),r="mailto:"+n;else{let o;do o=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(o!==t[0]);n=Yo(t[0]),t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=Yo(t[0]),{type:"text",raw:t[0],text:i}}}}const MTe=/^(?: *(?:\n|$))+/,OTe=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,PTe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ny=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,FTe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,cte=/(?:[*+-]|\d{1,9}[.)])/,ute=$i(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,cte).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),b8=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,BTe=/^[^\n]+/,w8=/(?!\s*\])(?:\\.|[^\[\]\\])+/,VTe=$i(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",w8).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),HTe=$i(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,cte).getRegex(),qD="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",v8=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,WTe=$i("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",v8).replace("tag",qD).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),hte=$i(b8).replace("hr",ny).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qD).getRegex(),zTe=$i(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",hte).getRegex(),C8={blockquote:zTe,code:OTe,def:VTe,fences:PTe,heading:FTe,hr:ny,html:WTe,lheading:ute,list:HTe,newline:MTe,paragraph:hte,table:Cw,text:BTe},z$=$i("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ny).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qD).getRegex(),UTe={...C8,table:z$,paragraph:$i(b8).replace("hr",ny).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",z$).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qD).getRegex()},jTe={...C8,html:$i(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",v8).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Cw,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:$i(b8).replace("hr",ny).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ute).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},dte=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,$Te=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,fte=/^( {2,}|\\)\n(?!\s*$)/,qTe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,sy="\\p{P}\\p{S}",GTe=$i(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,sy).getRegex(),KTe=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,YTe=$i(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,sy).getRegex(),QTe=$i("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,sy).getRegex(),XTe=$i("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,sy).getRegex(),ZTe=$i(/\\([punct])/,"gu").replace(/punct/g,sy).getRegex(),JTe=$i(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),eNe=$i(v8).replace("(?:-->|$)","-->").getRegex(),tNe=$i("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",eNe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),l2=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,iNe=$i(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",l2).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),gte=$i(/^!?\[(label)\]\[(ref)\]/).replace("label",l2).replace("ref",w8).getRegex(),mte=$i(/^!?\[(ref)\](?:\[\])?/).replace("ref",w8).getRegex(),nNe=$i("reflink|nolink(?!\\()","g").replace("reflink",gte).replace("nolink",mte).getRegex(),y8={_backpedal:Cw,anyPunctuation:ZTe,autolink:JTe,blockSkip:KTe,br:fte,code:$Te,del:Cw,emStrongLDelim:YTe,emStrongRDelimAst:QTe,emStrongRDelimUnd:XTe,escape:dte,link:iNe,nolink:mte,punctuation:GTe,reflink:gte,reflinkSearch:nNe,tag:tNe,text:qTe,url:Cw},sNe={...y8,link:$i(/^!?\[(label)\]\((.*?)\)/).replace("label",l2).getRegex(),reflink:$i(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",l2).getRegex()},bO={...y8,escape:$i(dte).replace("])","~|])").getRegex(),url:$i(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},rNe={...bO,br:$i(fte).replace("{2,}","*").getRegex(),text:$i(bO.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},vx={normal:C8,gfm:UTe,pedantic:jTe},p0={normal:y8,gfm:bO,breaks:rNe,pedantic:sNe};class Jl{constructor(e){an(this,"tokens");an(this,"options");an(this,"state");an(this,"tokenizer");an(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Mm,this.options.tokenizer=this.options.tokenizer||new a2,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:vx.normal,inline:p0.normal};this.options.pedantic?(t.block=vx.pedantic,t.inline=p0.pedantic):this.options.gfm&&(t.block=vx.gfm,this.options.breaks?t.inline=p0.breaks:t.inline=p0.gfm),this.tokenizer.rules=t}static get rules(){return{block:vx,inline:p0}}static lex(e,t){return new Jl(t).lex(e)}static lexInline(e,t){return new Jl(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let n,r,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(h=>{c=h.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(o=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o))){r=t[t.length-1],i&&(r==null?void 0:r.type)==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),i=o.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,n,r,o=e,a,l,c;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)h.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(h=>(i=h.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,c)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(r=e,this.options.extensions&&this.options.extensions.startInline){let h=1/0;const d=e.slice(1);let g;this.options.extensions.startInline.forEach(p=>{g=p.call({lexer:this},d),typeof g=="number"&&g>=0&&(h=Math.min(h,g))}),h<1/0&&h>=0&&(r=e.substring(0,h+1))}if(i=this.tokenizer.inlineText(r)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,n=t[t.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return t}}class iC{constructor(e){an(this,"options");an(this,"parser");this.options=e||Mm}space(e){return""}code({text:e,lang:t,escaped:i}){var o;const n=(o=(t||"").match(/^\S*/))==null?void 0:o[0],r=e.replace(/\n$/,"")+`
`;return n?'<pre><code class="language-'+Yo(n)+'">'+(i?r:Yo(r,!0))+`</code></pre>
`:"<pre><code>"+(i?r:Yo(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let n="";for(let a=0;a<e.items.length;a++){const l=e.items[a];n+=this.listitem(l)}const r=t?"ol":"ul",o=t&&i!==1?' start="'+i+'"':"";return"<"+r+o+`>
`+n+"</"+r+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let r=0;r<e.header.length;r++)i+=this.tablecell(e.header[r]);t+=this.tablerow({text:i});let n="";for(let r=0;r<e.rows.length;r++){const o=e.rows[r];i="";for(let a=0;a<o.length;a++)i+=this.tablecell(o[a]);n+=this.tablerow({text:i})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const n=this.parser.parseInline(i),r=V$(e);if(r===null)return n;e=r;let o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>",o}image({href:e,title:t,text:i}){const n=V$(e);if(n===null)return i;e=n;let r=`<img src="${e}" alt="${i}"`;return t&&(r+=` title="${t}"`),r+=">",r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class S8{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class ec{constructor(e){an(this,"options");an(this,"renderer");an(this,"textRenderer");this.options=e||Mm,this.options.renderer=this.options.renderer||new iC,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new S8}static parse(e,t){return new ec(t).parse(e)}static parseInline(e,t){return new ec(t).parseInline(e)}parse(e,t=!0){let i="";for(let n=0;n<e.length;n++){const r=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=r,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){i+=l||"";continue}}const o=r;switch(o.type){case"space":{i+=this.renderer.space(o);continue}case"hr":{i+=this.renderer.hr(o);continue}case"heading":{i+=this.renderer.heading(o);continue}case"code":{i+=this.renderer.code(o);continue}case"table":{i+=this.renderer.table(o);continue}case"blockquote":{i+=this.renderer.blockquote(o);continue}case"list":{i+=this.renderer.list(o);continue}case"html":{i+=this.renderer.html(o);continue}case"paragraph":{i+=this.renderer.paragraph(o);continue}case"text":{let a=o,l=this.renderer.text(a);for(;n+1<e.length&&e[n+1].type==="text";)a=e[++n],l+=`
`+this.renderer.text(a);t?i+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):i+=l;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let n=0;n<e.length;n++){const r=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=this.options.extensions.renderers[r.type].call({parser:this},r);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){i+=a||"";continue}}const o=r;switch(o.type){case"escape":{i+=t.text(o);break}case"html":{i+=t.html(o);break}case"link":{i+=t.link(o);break}case"image":{i+=t.image(o);break}case"strong":{i+=t.strong(o);break}case"em":{i+=t.em(o);break}case"codespan":{i+=t.codespan(o);break}case"br":{i+=t.br(o);break}case"del":{i+=t.del(o);break}case"text":{i+=t.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}}class yw{constructor(e){an(this,"options");this.options=e||Mm}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}an(yw,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class pte{constructor(...e){an(this,"defaults",_8());an(this,"options",this.setOptions);an(this,"parse",this.parseMarkdown(Jl.lex,ec.parse));an(this,"parseInline",this.parseMarkdown(Jl.lexInline,ec.parseInline));an(this,"Parser",ec);an(this,"Renderer",iC);an(this,"TextRenderer",S8);an(this,"Lexer",Jl);an(this,"Tokenizer",a2);an(this,"Hooks",yw);this.use(...e)}walkTokens(e,t){var n,r;let i=[];for(const o of e)switch(i=i.concat(t.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)i=i.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const c of l)i=i.concat(this.walkTokens(c.tokens,t));break}case"list":{const a=o;i=i.concat(this.walkTokens(a.items,t));break}default:{const a=o;(r=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&r[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);i=i.concat(this.walkTokens(c,t))}):a.tokens&&(i=i.concat(this.walkTokens(a.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const n={...i};if(n.async=this.defaults.async||n.async||!1,i.extensions&&(i.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const o=t.renderers[r.name];o?t.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[r.level];o?o.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),n.extensions=t),i.renderer){const r=this.defaults.renderer||new iC(this.defaults);for(const o in i.renderer){if(!(o in r))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o,l=i.renderer[a],c=r[a];r[a]=(...h)=>{let d=l.apply(r,h);return d===!1&&(d=c.apply(r,h)),d||""}}n.renderer=r}if(i.tokenizer){const r=this.defaults.tokenizer||new a2(this.defaults);for(const o in i.tokenizer){if(!(o in r))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,l=i.tokenizer[a],c=r[a];r[a]=(...h)=>{let d=l.apply(r,h);return d===!1&&(d=c.apply(r,h)),d}}n.tokenizer=r}if(i.hooks){const r=this.defaults.hooks||new yw;for(const o in i.hooks){if(!(o in r))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,l=i.hooks[a],c=r[a];yw.passThroughHooks.has(o)?r[a]=h=>{if(this.defaults.async)return Promise.resolve(l.call(r,h)).then(g=>c.call(r,g));const d=l.call(r,h);return c.call(r,d)}:r[a]=(...h)=>{let d=l.apply(r,h);return d===!1&&(d=c.apply(r,h)),d}}n.hooks=r}if(i.walkTokens){const r=this.defaults.walkTokens,o=i.walkTokens;n.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),r&&(l=l.concat(r.call(this,a))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Jl.lex(e,t??this.defaults)}parser(e,t){return ec.parse(e,t??this.defaults)}parseMarkdown(e,t){return(n,r)=>{const o={...r},a={...this.defaults,...o},l=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&o.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>t(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(l);try{a.hooks&&(n=a.hooks.preprocess(n));let c=e(n,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let h=t(c,a);return a.hooks&&(h=a.hooks.postprocess(h)),h}catch(c){return l(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const n="<p>An error occurred:</p><pre>"+Yo(i.message+"",!0)+"</pre>";return t?Promise.resolve(n):n}if(t)return Promise.reject(i);throw i}}}const gm=new pte;function Bi(s,e){return gm.parse(s,e)}Bi.options=Bi.setOptions=function(s){return gm.setOptions(s),Bi.defaults=gm.defaults,ote(Bi.defaults),Bi};Bi.getDefaults=_8;Bi.defaults=Mm;Bi.use=function(...s){return gm.use(...s),Bi.defaults=gm.defaults,ote(Bi.defaults),Bi};Bi.walkTokens=function(s,e){return gm.walkTokens(s,e)};Bi.parseInline=gm.parseInline;Bi.Parser=ec;Bi.parser=ec.parse;Bi.Renderer=iC;Bi.TextRenderer=S8;Bi.Lexer=Jl;Bi.lexer=Jl.lex;Bi.Tokenizer=a2;Bi.Hooks=yw;Bi.parse=Bi;Bi.options;Bi.setOptions;Bi.use;Bi.walkTokens;Bi.parseInline;const oNe=Bi;ec.parse;const nC=Jl.lex;function aNe(s){return JSON.stringify(s,lNe)}function wO(s){let e=JSON.parse(s);return e=vO(e),e}function lNe(s,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function vO(s,e=0){if(!s||e>200)return s;if(typeof s=="object"){switch(s.$mid){case 1:return mt.revive(s);case 2:return new RegExp(s.source,s.flags);case 17:return new Date(s.source)}if(s instanceof hD||s instanceof Uint8Array)return s;if(Array.isArray(s))for(let t=0;t<s.length;++t)s[t]=vO(s[t],e+1);else for(const t in s)Object.hasOwnProperty.call(s,t)&&(s[t]=vO(s[t],e+1))}return s}/*! @license DOMPurify 3.2.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.7/LICENSE */const{entries:_te,setPrototypeOf:U$,isFrozen:cNe,getPrototypeOf:uNe,getOwnPropertyDescriptor:hNe}=Object;let{freeze:Qr,seal:Pa,create:bte}=Object,{apply:CO,construct:yO}=typeof Reflect<"u"&&Reflect;Qr||(Qr=function(e){return e});Pa||(Pa=function(e){return e});CO||(CO=function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return e.apply(t,n)});yO||(yO=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return new e(...i)});const Cx=Xr(Array.prototype.forEach),dNe=Xr(Array.prototype.lastIndexOf),j$=Xr(Array.prototype.pop),_0=Xr(Array.prototype.push),fNe=Xr(Array.prototype.splice),oL=Xr(String.prototype.toLowerCase),eA=Xr(String.prototype.toString),tA=Xr(String.prototype.match),b0=Xr(String.prototype.replace),gNe=Xr(String.prototype.indexOf),mNe=Xr(String.prototype.trim),Xa=Xr(Object.prototype.hasOwnProperty),Br=Xr(RegExp.prototype.test),w0=pNe(TypeError);function Xr(s){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return CO(s,e,i)}}function pNe(s){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return yO(s,t)}}function ei(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oL;U$&&U$(s,null);let i=e.length;for(;i--;){let n=e[i];if(typeof n=="string"){const r=t(n);r!==n&&(cNe(e)||(e[i]=r),n=r)}s[n]=!0}return s}function _Ne(s){for(let e=0;e<s.length;e++)Xa(s,e)||(s[e]=null);return s}function lu(s){const e=bte(null);for(const[t,i]of _te(s))Xa(s,t)&&(Array.isArray(i)?e[t]=_Ne(i):i&&typeof i=="object"&&i.constructor===Object?e[t]=lu(i):e[t]=i);return e}function v0(s,e){for(;s!==null;){const i=hNe(s,e);if(i){if(i.get)return Xr(i.get);if(typeof i.value=="function")return Xr(i.value)}s=uNe(s)}function t(){return null}return t}const $$=Qr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),iA=Qr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","slot","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nA=Qr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bNe=Qr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),sA=Qr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),wNe=Qr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),q$=Qr(["#text"]),G$=Qr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),rA=Qr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),K$=Qr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),yx=Qr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vNe=Pa(/\{\{[\w\W]*|[\w\W]*\}\}/gm),CNe=Pa(/<%[\w\W]*|[\w\W]*%>/gm),yNe=Pa(/\$\{[\w\W]*/gm),SNe=Pa(/^data-[\-\w.\u00B7-\uFFFF]+$/),xNe=Pa(/^aria-[\-\w]+$/),wte=Pa(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),LNe=Pa(/^(?:\w+script|data):/i),kNe=Pa(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vte=Pa(/^html$/i),ENe=Pa(/^[a-z][.\w]*(-[.\w]+)+$/i);var Y$=Object.freeze({__proto__:null,ARIA_ATTR:xNe,ATTR_WHITESPACE:kNe,CUSTOM_ELEMENT:ENe,DATA_ATTR:SNe,DOCTYPE_NAME:vte,ERB_EXPR:CNe,IS_ALLOWED_URI:wte,IS_SCRIPT_OR_DATA:LNe,MUSTACHE_EXPR:vNe,TMPLIT_EXPR:yNe});const C0={element:1,text:3,progressingInstruction:7,comment:8,document:9},DNe=function(){return typeof window>"u"?null:window},TNe=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}},Q$=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Cte(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DNe();const e=ct=>Cte(ct);if(e.version="3.2.7",e.removed=[],!s||!s.document||s.document.nodeType!==C0.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const i=t,n=i.currentScript,{DocumentFragment:r,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:h=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:d,DOMParser:g,trustedTypes:p}=s,_=l.prototype,b=v0(_,"cloneNode"),C=v0(_,"remove"),x=v0(_,"nextSibling"),S=v0(_,"childNodes"),y=v0(_,"parentNode");if(typeof o=="function"){const ct=t.createElement("template");ct.content&&ct.content.ownerDocument&&(t=ct.content.ownerDocument)}let k,D="";const{implementation:R,createNodeIterator:N,createDocumentFragment:A,getElementsByTagName:M}=t,{importNode:O}=i;let V=Q$();e.isSupported=typeof _te=="function"&&typeof y=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:H,ERB_EXPR:U,TMPLIT_EXPR:X,DATA_ATTR:Y,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:ee,ATTR_WHITESPACE:ue,CUSTOM_ELEMENT:oe}=Y$;let{IS_ALLOWED_URI:Ee}=Y$,$=null;const ce=ei({},[...$$,...iA,...nA,...sA,...q$]);let de=null;const xe=ei({},[...G$,...rA,...K$,...yx]);let Re=Object.seal(bte(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Xe=null,ht=null,bi=!0,qt=!0,An=!1,vr=!0,li=!1,on=!0,qi=!1,pe=!1,ye=!1,Fe=!1,st=!1,Q=!1,T=!0,F=!1;const W="user-content-";let ne=!0,he=!1,Ce={},Ze=null;const Ft=ei({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Si=null;const zt=ei({},["audio","video","img","source","image","track"]);let At=null;const Mn=ei({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jr="http://www.w3.org/1998/Math/MathML",Ks="http://www.w3.org/2000/svg",Mi="http://www.w3.org/1999/xhtml";let On=Mi,bn=!1,rb=null;const lT=ei({},[Jr,Ks,Mi],eA);let Vm=ei({},["mi","mo","mn","ms","mtext"]),Nc=ei({},["annotation-xml"]);const Hm=ei({},["title","style","font","a","script"]);let Ll=null;const Ic=["application/xhtml+xml","text/html"],Wm="text/html";let wn=null,fh=null;const fy=t.createElement("form"),zm=function(re){return re instanceof RegExp||re instanceof Function},Rc=function(){let re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(fh&&fh===re)){if((!re||typeof re!="object")&&(re={}),re=lu(re),Ll=Ic.indexOf(re.PARSER_MEDIA_TYPE)===-1?Wm:re.PARSER_MEDIA_TYPE,wn=Ll==="application/xhtml+xml"?eA:oL,$=Xa(re,"ALLOWED_TAGS")?ei({},re.ALLOWED_TAGS,wn):ce,de=Xa(re,"ALLOWED_ATTR")?ei({},re.ALLOWED_ATTR,wn):xe,rb=Xa(re,"ALLOWED_NAMESPACES")?ei({},re.ALLOWED_NAMESPACES,eA):lT,At=Xa(re,"ADD_URI_SAFE_ATTR")?ei(lu(Mn),re.ADD_URI_SAFE_ATTR,wn):Mn,Si=Xa(re,"ADD_DATA_URI_TAGS")?ei(lu(zt),re.ADD_DATA_URI_TAGS,wn):zt,Ze=Xa(re,"FORBID_CONTENTS")?ei({},re.FORBID_CONTENTS,wn):Ft,Xe=Xa(re,"FORBID_TAGS")?ei({},re.FORBID_TAGS,wn):lu({}),ht=Xa(re,"FORBID_ATTR")?ei({},re.FORBID_ATTR,wn):lu({}),Ce=Xa(re,"USE_PROFILES")?re.USE_PROFILES:!1,bi=re.ALLOW_ARIA_ATTR!==!1,qt=re.ALLOW_DATA_ATTR!==!1,An=re.ALLOW_UNKNOWN_PROTOCOLS||!1,vr=re.ALLOW_SELF_CLOSE_IN_ATTR!==!1,li=re.SAFE_FOR_TEMPLATES||!1,on=re.SAFE_FOR_XML!==!1,qi=re.WHOLE_DOCUMENT||!1,Fe=re.RETURN_DOM||!1,st=re.RETURN_DOM_FRAGMENT||!1,Q=re.RETURN_TRUSTED_TYPE||!1,ye=re.FORCE_BODY||!1,T=re.SANITIZE_DOM!==!1,F=re.SANITIZE_NAMED_PROPS||!1,ne=re.KEEP_CONTENT!==!1,he=re.IN_PLACE||!1,Ee=re.ALLOWED_URI_REGEXP||wte,On=re.NAMESPACE||Mi,Vm=re.MATHML_TEXT_INTEGRATION_POINTS||Vm,Nc=re.HTML_INTEGRATION_POINTS||Nc,Re=re.CUSTOM_ELEMENT_HANDLING||{},re.CUSTOM_ELEMENT_HANDLING&&zm(re.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Re.tagNameCheck=re.CUSTOM_ELEMENT_HANDLING.tagNameCheck),re.CUSTOM_ELEMENT_HANDLING&&zm(re.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Re.attributeNameCheck=re.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),re.CUSTOM_ELEMENT_HANDLING&&typeof re.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Re.allowCustomizedBuiltInElements=re.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),li&&(qt=!1),st&&(Fe=!0),Ce&&($=ei({},q$),de=[],Ce.html===!0&&(ei($,$$),ei(de,G$)),Ce.svg===!0&&(ei($,iA),ei(de,rA),ei(de,yx)),Ce.svgFilters===!0&&(ei($,nA),ei(de,rA),ei(de,yx)),Ce.mathMl===!0&&(ei($,sA),ei(de,K$),ei(de,yx))),re.ADD_TAGS&&($===ce&&($=lu($)),ei($,re.ADD_TAGS,wn)),re.ADD_ATTR&&(de===xe&&(de=lu(de)),ei(de,re.ADD_ATTR,wn)),re.ADD_URI_SAFE_ATTR&&ei(At,re.ADD_URI_SAFE_ATTR,wn),re.FORBID_CONTENTS&&(Ze===Ft&&(Ze=lu(Ze)),ei(Ze,re.FORBID_CONTENTS,wn)),ne&&($["#text"]=!0),qi&&ei($,["html","head","body"]),$.table&&(ei($,["tbody"]),delete Xe.tbody),re.TRUSTED_TYPES_POLICY){if(typeof re.TRUSTED_TYPES_POLICY.createHTML!="function")throw w0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof re.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw w0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=re.TRUSTED_TYPES_POLICY,D=k.createHTML("")}else k===void 0&&(k=TNe(p,n)),k!==null&&typeof D=="string"&&(D=k.createHTML(""));Qr&&Qr(re),fh=re}},gy=ei({},[...iA,...nA,...bNe]),ob=ei({},[...sA,...wNe]),my=function(re){let Ve=y(re);(!Ve||!Ve.tagName)&&(Ve={namespaceURI:On,tagName:"template"});const Je=oL(re.tagName),Di=oL(Ve.tagName);return rb[re.namespaceURI]?re.namespaceURI===Ks?Ve.namespaceURI===Mi?Je==="svg":Ve.namespaceURI===Jr?Je==="svg"&&(Di==="annotation-xml"||Vm[Di]):!!gy[Je]:re.namespaceURI===Jr?Ve.namespaceURI===Mi?Je==="math":Ve.namespaceURI===Ks?Je==="math"&&Nc[Di]:!!ob[Je]:re.namespaceURI===Mi?Ve.namespaceURI===Ks&&!Nc[Di]||Ve.namespaceURI===Jr&&!Vm[Di]?!1:!ob[Je]&&(Hm[Je]||!gy[Je]):!!(Ll==="application/xhtml+xml"&&rb[re.namespaceURI]):!1},Oo=function(re){_0(e.removed,{element:re});try{y(re).removeChild(re)}catch{C(re)}},Ha=function(re,Ve){try{_0(e.removed,{attribute:Ve.getAttributeNode(re),from:Ve})}catch{_0(e.removed,{attribute:null,from:Ve})}if(Ve.removeAttribute(re),re==="is")if(Fe||st)try{Oo(Ve)}catch{}else try{Ve.setAttribute(re,"")}catch{}},Um=function(re){let Ve=null,Je=null;if(ye)re="<remove></remove>"+re;else{const Ki=tA(re,/^[\r\n\t ]+/);Je=Ki&&Ki[0]}Ll==="application/xhtml+xml"&&On===Mi&&(re='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+re+"</body></html>");const Di=k?k.createHTML(re):re;if(On===Mi)try{Ve=new g().parseFromString(Di,Ll)}catch{}if(!Ve||!Ve.documentElement){Ve=R.createDocument(On,"template",null);try{Ve.documentElement.innerHTML=bn?D:Di}catch{}}const Pn=Ve.body||Ve.documentElement;return re&&Je&&Pn.insertBefore(t.createTextNode(Je),Pn.childNodes[0]||null),On===Mi?M.call(Ve,qi?"html":"body")[0]:qi?Ve.documentElement:Pn},ab=function(re){return N.call(re.ownerDocument||re,re,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},jm=function(re){return re instanceof d&&(typeof re.nodeName!="string"||typeof re.textContent!="string"||typeof re.removeChild!="function"||!(re.attributes instanceof h)||typeof re.removeAttribute!="function"||typeof re.setAttribute!="function"||typeof re.namespaceURI!="string"||typeof re.insertBefore!="function"||typeof re.hasChildNodes!="function")},Wa=function(re){return typeof a=="function"&&re instanceof a};function Gi(ct,re,Ve){Cx(ct,Je=>{Je.call(e,re,Ve,fh)})}const Ys=function(re){let Ve=null;if(Gi(V.beforeSanitizeElements,re,null),jm(re))return Oo(re),!0;const Je=wn(re.nodeName);if(Gi(V.uponSanitizeElement,re,{tagName:Je,allowedTags:$}),on&&re.hasChildNodes()&&!Wa(re.firstElementChild)&&Br(/<[/\w!]/g,re.innerHTML)&&Br(/<[/\w!]/g,re.textContent)||re.nodeType===C0.progressingInstruction||on&&re.nodeType===C0.comment&&Br(/<[/\w]/g,re.data))return Oo(re),!0;if(!$[Je]||Xe[Je]){if(!Xe[Je]&&$m(Je)&&(Re.tagNameCheck instanceof RegExp&&Br(Re.tagNameCheck,Je)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(Je)))return!1;if(ne&&!Ze[Je]){const Di=y(re)||re.parentNode,Pn=S(re)||re.childNodes;if(Pn&&Di){const Ki=Pn.length;for(let wi=Ki-1;wi>=0;--wi){const ua=b(Pn[wi],!0);ua.__removalCount=(re.__removalCount||0)+1,Di.insertBefore(ua,x(re))}}}return Oo(re),!0}return re instanceof l&&!my(re)||(Je==="noscript"||Je==="noembed"||Je==="noframes")&&Br(/<\/no(script|embed|frames)/i,re.innerHTML)?(Oo(re),!0):(li&&re.nodeType===C0.text&&(Ve=re.textContent,Cx([H,U,X],Di=>{Ve=b0(Ve,Di," ")}),re.textContent!==Ve&&(_0(e.removed,{element:re.cloneNode()}),re.textContent=Ve)),Gi(V.afterSanitizeElements,re,null),!1)},Ac=function(re,Ve,Je){if(T&&(Ve==="id"||Ve==="name")&&(Je in t||Je in fy))return!1;if(!(qt&&!ht[Ve]&&Br(Y,Ve))){if(!(bi&&Br(q,Ve))){if(!de[Ve]||ht[Ve]){if(!($m(re)&&(Re.tagNameCheck instanceof RegExp&&Br(Re.tagNameCheck,re)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(re))&&(Re.attributeNameCheck instanceof RegExp&&Br(Re.attributeNameCheck,Ve)||Re.attributeNameCheck instanceof Function&&Re.attributeNameCheck(Ve,re))||Ve==="is"&&Re.allowCustomizedBuiltInElements&&(Re.tagNameCheck instanceof RegExp&&Br(Re.tagNameCheck,Je)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(Je))))return!1}else if(!At[Ve]){if(!Br(Ee,b0(Je,ue,""))){if(!((Ve==="src"||Ve==="xlink:href"||Ve==="href")&&re!=="script"&&gNe(Je,"data:")===0&&Si[re])){if(!(An&&!Br(ee,b0(Je,ue,"")))){if(Je)return!1}}}}}}return!0},$m=function(re){return re!=="annotation-xml"&&tA(re,oe)},py=function(re){Gi(V.beforeSanitizeAttributes,re,null);const{attributes:Ve}=re;if(!Ve||jm(re))return;const Je={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:de,forceKeepAttr:void 0};let Di=Ve.length;for(;Di--;){const Pn=Ve[Di],{name:Ki,namespaceURI:wi,value:ua}=Pn,Mc=wn(Ki),za=ua;let vn=Ki==="value"?za:mNe(za);if(Je.attrName=Mc,Je.attrValue=vn,Je.keepAttr=!0,Je.forceKeepAttr=void 0,Gi(V.uponSanitizeAttribute,re,Je),vn=Je.attrValue,F&&(Mc==="id"||Mc==="name")&&(Ha(Ki,re),vn=W+vn),on&&Br(/((--!?|])>)|<\/(style|title|textarea)/i,vn)){Ha(Ki,re);continue}if(Mc==="attributename"&&tA(vn,"href")){Ha(Ki,re);continue}if(Je.forceKeepAttr)continue;if(!Je.keepAttr){Ha(Ki,re);continue}if(!vr&&Br(/\/>/i,vn)){Ha(Ki,re);continue}li&&Cx([H,U,X],lb=>{vn=b0(vn,lb," ")});const _y=wn(re.nodeName);if(!Ac(_y,Mc,vn)){Ha(Ki,re);continue}if(k&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!wi)switch(p.getAttributeType(_y,Mc)){case"TrustedHTML":{vn=k.createHTML(vn);break}case"TrustedScriptURL":{vn=k.createScriptURL(vn);break}}if(vn!==za)try{wi?re.setAttributeNS(wi,Ki,vn):re.setAttribute(Ki,vn),jm(re)?Oo(re):j$(e.removed)}catch{Ha(Ki,re)}}Gi(V.afterSanitizeAttributes,re,null)},cT=function ct(re){let Ve=null;const Je=ab(re);for(Gi(V.beforeSanitizeShadowDOM,re,null);Ve=Je.nextNode();)Gi(V.uponSanitizeShadowNode,Ve,null),Ys(Ve),py(Ve),Ve.content instanceof r&&ct(Ve.content);Gi(V.afterSanitizeShadowDOM,re,null)};return e.sanitize=function(ct){let re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ve=null,Je=null,Di=null,Pn=null;if(bn=!ct,bn&&(ct="<!-->"),typeof ct!="string"&&!Wa(ct))if(typeof ct.toString=="function"){if(ct=ct.toString(),typeof ct!="string")throw w0("dirty is not a string, aborting")}else throw w0("toString is not a function");if(!e.isSupported)return ct;if(pe||Rc(re),e.removed=[],typeof ct=="string"&&(he=!1),he){if(ct.nodeName){const ua=wn(ct.nodeName);if(!$[ua]||Xe[ua])throw w0("root node is forbidden and cannot be sanitized in-place")}}else if(ct instanceof a)Ve=Um("<!---->"),Je=Ve.ownerDocument.importNode(ct,!0),Je.nodeType===C0.element&&Je.nodeName==="BODY"||Je.nodeName==="HTML"?Ve=Je:Ve.appendChild(Je);else{if(!Fe&&!li&&!qi&&ct.indexOf("<")===-1)return k&&Q?k.createHTML(ct):ct;if(Ve=Um(ct),!Ve)return Fe?null:Q?D:""}Ve&&ye&&Oo(Ve.firstChild);const Ki=ab(he?ct:Ve);for(;Di=Ki.nextNode();)Ys(Di),py(Di),Di.content instanceof r&&cT(Di.content);if(he)return ct;if(Fe){if(st)for(Pn=A.call(Ve.ownerDocument);Ve.firstChild;)Pn.appendChild(Ve.firstChild);else Pn=Ve;return(de.shadowroot||de.shadowrootmode)&&(Pn=O.call(i,Pn,!0)),Pn}let wi=qi?Ve.outerHTML:Ve.innerHTML;return qi&&$["!doctype"]&&Ve.ownerDocument&&Ve.ownerDocument.doctype&&Ve.ownerDocument.doctype.name&&Br(vte,Ve.ownerDocument.doctype.name)&&(wi="<!DOCTYPE "+Ve.ownerDocument.doctype.name+`>
`+wi),li&&Cx([H,U,X],ua=>{wi=b0(wi,ua," ")}),k&&Q?k.createHTML(wi):wi},e.setConfig=function(){let ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rc(ct),pe=!0},e.clearConfig=function(){fh=null,pe=!1},e.isValidAttribute=function(ct,re,Ve){fh||Rc({});const Je=wn(ct),Di=wn(re);return Ac(Je,Di,Ve)},e.addHook=function(ct,re){typeof re=="function"&&_0(V[ct],re)},e.removeHook=function(ct,re){if(re!==void 0){const Ve=dNe(V[ct],re);return Ve===-1?void 0:fNe(V[ct],Ve,1)[0]}return j$(V[ct])},e.removeHooks=function(ct){V[ct]=[]},e.removeAllHooks=function(){V=Q$()},e}var Up=Cte();const yte=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","s","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),Ste=Object.freeze(["href","target","src","alt","title","for","name","role","tabindex","x-dispatch","required","checked","placeholder","type","start","width","height","align"]),oA="vscode-relative-path";function X$(s,e){if(e.override==="*")return!0;try{const t=new URL(s,oA+"://");return!!(e.override.includes(t.protocol.replace(/:$/,""))||e.allowRelativePaths&&t.protocol===oA+":"&&!s.trim().toLowerCase().startsWith(oA))}catch{return!1}}function NNe(s,e){Up.addHook("afterSanitizeAttributes",t=>{for(const i of["href","src"])if(t.hasAttribute(i)){const n=t.getAttribute(i);i==="href"?!n.startsWith("#")&&!X$(n,s)&&t.removeAttribute(i):X$(n,e)||t.removeAttribute(i)}})}const INe=Object.freeze({ALLOWED_TAGS:[...yte],ALLOWED_ATTR:[...Ste],ALLOW_UNKNOWN_PROTOCOLS:!0});function RNe(s,e){return xte(s,e,"trusted")}function xte(s,e,t){var i,n;try{const r={...INe};e!=null&&e.allowedTags&&(e.allowedTags.override&&(r.ALLOWED_TAGS=[...e.allowedTags.override]),e.allowedTags.augment&&(r.ALLOWED_TAGS=[...r.ALLOWED_TAGS??[],...e.allowedTags.augment]));let o=[...Ste];e!=null&&e.allowedAttributes&&(e.allowedAttributes.override&&(o=[...e.allowedAttributes.override]),e.allowedAttributes.augment&&(o=[...o,...e.allowedAttributes.augment])),o=o.map(c=>typeof c=="string"?c.toLowerCase():{attributeName:c.attributeName.toLowerCase(),shouldKeep:c.shouldKeep});const a=new Set(o.map(c=>typeof c=="string"?c:c.attributeName)),l=new Map;for(const c of o)typeof c=="string"?l.delete(c):l.set(c.attributeName,c);return r.ALLOWED_ATTR=Array.from(a),NNe({override:((i=e==null?void 0:e.allowedLinkProtocols)==null?void 0:i.override)??[tt.http,tt.https],allowRelativePaths:(e==null?void 0:e.allowRelativeLinkPaths)??!1},{override:((n=e==null?void 0:e.allowedMediaProtocols)==null?void 0:n.override)??[tt.http,tt.https],allowRelativePaths:(e==null?void 0:e.allowRelativeMediaPaths)??!1}),e!=null&&e.replaceWithPlaintext&&Up.addHook("uponSanitizeElement",MNe),l.size&&Up.addHook("uponSanitizeAttribute",(c,h)=>{const d=l.get(h.attrName);if(d){const g=d.shouldKeep(c,h);typeof g=="string"?(h.keepAttr=!0,h.attrValue=g):h.keepAttr=g}else h.keepAttr=a.has(h.attrName)}),t==="dom"?Up.sanitize(s,{...r,RETURN_DOM_FRAGMENT:!0}):Up.sanitize(s,{...r,RETURN_TRUSTED_TYPE:!0})}finally{Up.removeAllHooks()}}const ANe=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],MNe=(s,e,t)=>{var i,n;if(!e.allowedTags[e.tagName]&&e.tagName!=="body"){const r=Lte(s);r&&(s.nodeType===Node.COMMENT_NODE?(i=s.parentElement)==null||i.insertBefore(r,s):(n=s.parentElement)==null||n.replaceChild(r,s))}};function Lte(s){if(!s.ownerDocument)return;let e,t;if(s.nodeType===Node.COMMENT_NODE)e=`<!--${s.textContent}-->`;else if(s instanceof Element){const o=s.tagName.toLowerCase(),a=ANe.includes(o),l=s.attributes.length?" "+Array.from(s.attributes).map(c=>`${c.name}="${c.value}"`).join(" "):"";e=`<${o}${l}>`,a||(t=`</${o}>`)}else return;const i=document.createDocumentFragment(),n=s.ownerDocument.createTextNode(e);for(i.appendChild(n);s.firstChild;)i.appendChild(s.firstChild);const r=t?s.ownerDocument.createTextNode(t):void 0;return r&&i.appendChild(r),i}function kte(s,e,t){const i=xte(e,t,"dom");Ds(s,i)}const ONe=new RegExp(`(\\\\)?\\$\\((${Ct.iconNameExpression}(?:${Ct.iconModifierExpression})?)\\)`,"g");function Ig(s){const e=new Array;let t,i=0,n=0;for(;(t=ONe.exec(s))!==null;){n=t.index||0,i<n&&e.push(s.substring(i,n)),i=(t.index||0)+t[0].length;const[,r,o]=t;e.push(r?`$(${o})`:sC({id:o}))}return i<s.length&&e.push(s.substring(i)),e}function sC(s){const e=Ke("span");return e.classList.add(...Ct.asClassNameArray(s)),e}const aA=Object.freeze({image:({href:s,title:e,text:t})=>{let i=[],n=[];return s&&({href:s,dimensions:i}=ETe(s),n.push(`src="${wx(s)}"`)),t&&n.push(`alt="${wx(t)}"`),e&&n.push(`title="${wx(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>`},link({href:s,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof s!="string"?"":(s===i&&(i=JR(i)),e=typeof e=="string"?wx(JR(e)):"",s=JR(s),s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${s}" title="${e||s}" draggable="false">${i}</a>`)}});function PNe(s){return function(e){const{tokens:t}=e,i=t[0];if((i==null?void 0:i.type)!=="paragraph")return s.call(this,e);const n=i.tokens;if(!n||n.length===0)return s.call(this,e);const r=n[0];if((r==null?void 0:r.type)!=="text")return s.call(this,e);const o=/^\s*\[!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]\s*?\n*/i,a=r.raw.match(o);if(!a)return s.call(this,e);r.raw=r.raw.replace(o,""),r.text=r.text.replace(o,"");const l={note:"info",tip:"light-bulb",important:"comment",warning:"alert",caution:"stop"},c=a[1],h=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),d=c.toLowerCase(),g=sC({id:l[d]}).outerHTML,p=this.parser.parse(t);return`<blockquote data-severity="${d}"><p><span>${g}${h}</span>${p.substring(3)}</blockquote>
`}}function x8(s,e={},t){var _,b,C;const i=new Pe;let n=!1;const r=new pte(...e.markedExtensions??[]),{renderer:o,codeBlocks:a,syncCodeBlocks:l}=BNe(r,e,s),c=VNe(s);let h;if(e.fillInIncompleteTokens){const x={...r.defaults,...e.markedOptions,renderer:o},S=r.lexer(c,x),y=ZNe(S);h=r.parser(y,x)}else h=r.parse(c,{...e==null?void 0:e.markedOptions,renderer:o,async:!1});s.supportThemeIcons&&(h=Ig(h).map(S=>typeof S=="string"?S:S.outerHTML).join(""));const d=document.createElement("div"),g=Ete(s,e.sanitizerConfig??{});kte(d,h,g),FNe(s,e,d);let p;if(t?(p=t,Ds(t,...d.children)):p=d,a.length>0)Promise.all(a).then(x=>{var k;if(n)return;const S=new Map(x),y=p.querySelectorAll("div[data-code]");for(const D of y){const R=S.get(D.dataset.code??"");R&&Ds(D,R)}(k=e.asyncRenderCallback)==null||k.call(e)});else if(l.length>0){const x=new Map(l),S=p.querySelectorAll("div[data-code]");for(const y of S){const k=x.get(y.dataset.code??"");k&&Ds(y,k)}}if(e.asyncRenderCallback)for(const x of p.getElementsByTagName("img")){const S=i.add(ie(x,"load",()=>{S.dispose(),e.asyncRenderCallback()}))}if(e.actionHandler){const x=S=>{const y=new So(Ue(p),S);!y.leftButton&&!y.middleButton||Z$(s,e,y)};i.add(ie(p,"click",x)),i.add(ie(p,"auxclick",x)),i.add(ie(p,"keydown",S=>{const y=new si(S);!y.equals(10)&&!y.equals(3)||Z$(s,e,y)}))}for(const x of[...p.getElementsByTagName("input")])if(((_=x.attributes.getNamedItem("type"))==null?void 0:_.value)==="checkbox")x.setAttribute("disabled","");else if((b=e.sanitizerConfig)!=null&&b.replaceWithPlaintext){const S=Lte(x);S?(C=x.parentElement)==null||C.replaceChild(S,x):x.remove()}else x.remove();return{element:p,dispose:()=>{n=!0,i.dispose()}}}function FNe(s,e,t){var i;for(const n of t.querySelectorAll("img, audio, video, source")){const r=n.getAttribute("src");if(r){let o=r;try{s.baseUri&&(o=SO(mt.from(s.baseUri),o))}catch{}if(n.setAttribute("src",J$(s,o,!0)),(i=e.sanitizerConfig)!=null&&i.remoteImageIsAllowed){const a=mt.parse(o);a.scheme!==tt.file&&a.scheme!==tt.data&&!e.sanitizerConfig.remoteImageIsAllowed(a)&&n.replaceWith(Ke("",void 0,n.outerHTML))}}}for(const n of t.querySelectorAll("a")){const r=n.getAttribute("href");if(n.setAttribute("href",""),!r||/^data:|javascript:/i.test(r)||/^command:/i.test(r)&&!s.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(r))n.replaceWith(...n.childNodes);else{let o=J$(s,r,!1);s.baseUri&&(o=SO(mt.from(s.baseUri),r)),n.dataset.href=o}}}function BNe(s,e,t){const i=new s.Renderer(e.markedOptions);i.image=aA.image,i.link=aA.link,i.paragraph=aA.paragraph,t.supportAlertSyntax&&(i.blockquote=PNe(i.blockquote));const n=[],r=[];return e.codeBlockRendererSync?i.code=({text:o,lang:a,raw:l})=>{const c=F$.nextId(),h=e.codeBlockRendererSync(eq(a),o,l);return r.push([c,h]),`<div class="code" data-code="${c}">${Ra(o)}</div>`}:e.codeBlockRenderer&&(i.code=({text:o,lang:a})=>{const l=F$.nextId(),c=e.codeBlockRenderer(eq(a),o);return n.push(c.then(h=>[l,h])),`<div class="code" data-code="${l}">${Ra(o)}</div>`}),t.supportHtml||(i.html=({text:o})=>{var l;return(l=e.sanitizerConfig)!=null&&l.replaceWithPlaintext?Ra(o):(t.isTrusted?o.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?o:""}),{renderer:i,codeBlocks:n,syncCodeBlocks:r}}function VNe(s){let e=s.value;return e.length>1e5&&(e=`${e.substr(0,1e5)}`),s.supportThemeIcons&&(e=yTe(e)),e}function Z$(s,e,t){var n;const i=t.target.closest("a[data-href]");if(nn(i))try{let r=i.dataset.href;r&&(s.baseUri&&(r=SO(mt.from(s.baseUri),r)),(n=e.actionHandler)==null||n.call(e,r,s))}catch(r){$t(r)}finally{t.preventDefault()}}function HNe(s,e){let t;try{t=wO(decodeURIComponent(e))}catch{}return t?(t=oX(t,i=>{if(s.uris&&s.uris[i])return mt.revive(s.uris[i])}),encodeURIComponent(JSON.stringify(t))):e}function J$(s,e,t){const i=s.uris&&s.uris[e];let n=mt.revive(i);return t?e.startsWith(tt.data+":")?e:(n||(n=mt.parse(e)),jX.uriToBrowserUri(n).toString(!0)):!n||mt.parse(e).toString()===n.toString()?e:(n.query&&(n=n.with({query:HNe(s,n.query)})),n.toString())}function eq(s){if(!s)return"";const e=s.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:s}function SO(s,e){return/^\w[\w\d+.-]*:/.test(e)?e:s.path.endsWith("/")?Uz(s,e).toString():Uz(_be(s),e).toString()}function WNe(s,e,t={}){const i=Ete(e,t);return RNe(s,i)}const zNe=Object.freeze([...yte,"input"]),UNe=Object.freeze(["align","autoplay","alt","colspan","controls","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","target","title","type","width","start","checked","disabled","value","data-code","data-href","data-severity",{attributeName:"style",shouldKeep:(s,e)=>s.tagName==="SPAN"&&e.attrName==="style"?/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(e.attrValue):!1},{attributeName:"class",shouldKeep:(s,e)=>s.tagName==="SPAN"&&e.attrName==="class"?/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(e.attrValue):!1}]);function Ete(s,e){var n,r,o;const t=s.isTrusted??!1,i=[tt.http,tt.https,tt.mailto,tt.file,tt.vscodeFileResource,tt.vscodeRemote,tt.vscodeRemoteResource,tt.vscodeNotebookCell];return t&&i.push(tt.command),(n=e.allowedLinkSchemes)!=null&&n.augment&&i.push(...e.allowedLinkSchemes.augment),{allowedTags:{override:((r=e.allowedTags)==null?void 0:r.override)??zNe},allowedAttributes:{override:((o=e.allowedAttributes)==null?void 0:o.override)??UNe},allowedLinkProtocols:{override:i},allowRelativeLinkPaths:!!s.baseUri,allowedMediaProtocols:{override:[tt.http,tt.https,tt.data,tt.file,tt.vscodeFileResource,tt.vscodeRemote,tt.vscodeRemoteResource]},allowRelativeMediaPaths:!!s.baseUri,replaceWithPlaintext:e.replaceWithPlaintext}}function jNe(s,e){if(typeof s=="string")return s;let t=s.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}`);const i=oNe(t,{async:!1,renderer:qNe.value});return WNe(i,{isTrusted:!1},{}).toString().replace(/&(#\d+|[a-zA-Z]+);/g,n=>$Ne.get(n)??n).trim()}const $Ne=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function Dte(){const s=new iC;return s.code=({text:e})=>Ra(e),s.blockquote=({text:e})=>e+`
`,s.html=e=>"",s.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.hr=()=>"",s.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},s.listitem=({text:e})=>e+`
`,s.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},s.tablerow=({text:e})=>e,s.tablecell=function({tokens:e}){return this.parser.parseInline(e)},s.strong=({text:e})=>e,s.em=({text:e})=>e,s.codespan=({text:e})=>Ra(e),s.br=e=>`
`,s.del=({text:e})=>e,s.image=e=>"",s.text=({text:e})=>e,s.link=({text:e})=>e,s}const qNe=new lr(Dte);new lr(()=>{const s=Dte();return s.code=({text:e})=>`
\`\`\`
${Ra(e)}
\`\`\`
`,s});function rC(s){let e="";return s.forEach(t=>{e+=t.raw}),e}function Tte(s){var e,t;if(s.tokens)for(let i=s.tokens.length-1;i>=0;i--){const n=s.tokens[i];if(n.type==="text"){const r=n.raw.split(`
`),o=r[r.length-1];if(o.includes("`"))return eIe(s);if(o.includes("**"))return oIe(s);if(o.match(/\*\w/))return tIe(s);if(o.match(/(^|\s)__\w/))return aIe(s);if(o.match(/(^|\s)_\w/))return iIe(s);if(GNe(o)||KNe(o)&&s.tokens.slice(0,i).some(a=>a.type==="text"&&a.raw.match(/\[[^\]]*$/))){const a=s.tokens.slice(i+1);return((e=a[0])==null?void 0:e.type)==="link"&&((t=a[1])==null?void 0:t.type)==="text"&&a[1].raw.match(/^ *"[^"]*$/)||o.match(/^[^"]* +"[^"]*$/)?sIe(s):nIe(s)}else if(o.match(/(^|\s)\[\w*[^\]]*$/))return rIe(s)}}}function GNe(s){return!!s.match(/(^|\s)\[.*\]\(\w*/)}function KNe(s){return!!s.match(/^[^\[]*\]\([^\)]*$/)}function YNe(s){var c;const e=s.items[s.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,i=h=>{const d=h.items.at(-1),g=d==null?void 0:d.tokens.at(-1);return(g==null?void 0:g.type)==="heading"||(g==null?void 0:g.type)==="list"&&i(g)};let n;if((t==null?void 0:t.type)==="text"&&!("inRawBlock"in e))n=Tte(t);else if(i(s)){const h=nC(s.raw.trim()+" &nbsp;")[0];return h.type!=="list"?void 0:h}if(!n||n.type!=="paragraph")return;const r=rC(s.items.slice(0,-1)),o=(c=e.raw.match(/^(\s*(-|\d+\.|\*) +)/))==null?void 0:c[0];if(!o)return;const a=o+rC(e.tokens.slice(0,-1))+n.raw,l=nC(r+a)[0];if(l.type==="list")return l}function QNe(s,e){if(s.raw.match(/-\s*$/))return nC(e+" &nbsp;")}const XNe=3;function ZNe(s){for(let e=0;e<XNe;e++){const t=JNe(s);if(t)s=t;else break}return s}function JNe(s){let e,t;for(e=0;e<s.length;e++){const n=s[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=lIe(s.slice(e));break}}const i=s.at(-1);if(!t&&(i==null?void 0:i.type)==="list"){const n=YNe(i);n&&(t=[n],e=s.length-1)}if(!t&&(i==null?void 0:i.type)==="paragraph"){const n=Tte(i);n&&(t=[n],e=s.length-1)}if(t){const n=[...s.slice(0,e),...t];return n.links=s.links,n}if((i==null?void 0:i.type)==="heading"){const n=QNe(i,rC(s));if(n)return n}return null}function eIe(s){return Ud(s,"`")}function tIe(s){return Ud(s,"*")}function iIe(s){return Ud(s,"_")}function nIe(s){return Ud(s,")",!1)}function sIe(s){return Ud(s,'")',!1)}function rIe(s){return Ud(s,"](https://microsoft.com)",!1)}function oIe(s){return Ud(s,"**")}function aIe(s){return Ud(s,"__")}function Ud(s,e,t=!0){const i=rC(Array.isArray(s)?s:[s]),n=t?i.trimEnd():i;return nC(n+e)[0]}function lIe(s){const e=rC(s),t=e.split(`
`);let i,n=!1;for(let r=0;r<t.length;r++){const o=t[r].trim();if(typeof i>"u"&&o.match(/^\s*\|/)){const a=o.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(o.match(/^\s*\|/)){if(r!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){const r=n?t.slice(0,-1).join(`
`):e,o=!!r.match(/\|\s*$/),a=r+(o?"":"|")+`
|${" --- |".repeat(i)}`;return nC(a)}}const GD=gt("openerService");function cIe(s){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(s.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},s=s.with({fragment:""})),{selection:e,uri:s}}var uIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},hIe=function(s,e){return function(t,i){e(t,i,s)}};const KD=gt("markdownRendererService");let xO=class{constructor(e){this._openerService=e}render(e,t,i){const n={...t};n.actionHandler||(n.actionHandler=(o,a)=>dIe(this._openerService,o,a.isTrusted)),n.codeBlockRenderer||(n.codeBlockRenderer=(o,a)=>{var l;return((l=this._defaultCodeBlockRenderer)==null?void 0:l.renderCodeBlock(o,a,n??{}))??Promise.resolve(document.createElement("span"))});const r=x8(e,n,i);return r.element.classList.add("rendered-markdown"),r}setDefaultCodeBlockRenderer(e){this._defaultCodeBlockRenderer=e}};xO=uIe([hIe(0,GD)],xO);async function dIe(s,e,t,i){try{return await s.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:fIe(t),skipValidation:i})}catch(n){return $t(n),!1}}function fIe(s){return s===!0?!0:s&&Array.isArray(s.enabledCommands)?s.enabledCommands:!1}yt(KD,xO,1);var gIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Sx=function(s,e){return function(t,i){e(t,i,s)}};const Al=Ke;let LO=class extends Ec{get _targetWindow(){return Ue(this._target.targetElements[0])}get _targetDocumentElement(){return Ue(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,n,r){var g,p,_,b,C,x,S,y,k,D,R;if(super(),this._keybindingService=t,this._configurationService=i,this._markdownRenderer=n,this._accessibilityService=r,this._messageListeners=new Pe,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._maxHeightRatioRelativeToWindow=.5,this._onDispose=this._register(new Z),this._onRequestLayout=this._register(new Z),this._linkHandler=e.linkHandler,this._target="targetElements"in e.target?e.target:new mIe(e.target),e.style)switch(e.style){case 1:{e.appearance??(e.appearance={}),(g=e.appearance).compact??(g.compact=!0),(p=e.appearance).showPointer??(p.showPointer=!0);break}case 2:{e.appearance??(e.appearance={}),(_=e.appearance).compact??(_.compact=!0);break}}this._hoverPointer=(b=e.appearance)!=null&&b.showPointer?Al("div.workbench-hover-pointer"):void 0,this._hover=this._register(new JDe(!((C=e.appearance)!=null&&C.skipFadeInAnimation))),this._hover.containerDomNode.classList.add("workbench-hover"),(x=e.appearance)!=null&&x.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),(S=e.position)!=null&&S.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0);const o=(y=e.appearance)==null?void 0:y.maxHeightRatio;o!==void 0&&o>0&&o<=1&&(this._maxHeightRatioRelativeToWindow=o),this._hoverPosition=((k=e.position)==null?void 0:k.hoverPosition)===void 0?3:Cm(e.position.hoverPosition)?e.position.hoverPosition:2,this.onmousedown(this._hover.containerDomNode,N=>N.stopPropagation()),this.onkeydown(this._hover.containerDomNode,N=>{N.equals(9)&&this.dispose()}),this._register(ie(this._targetWindow,"blur",()=>this.dispose()));const a=Al("div.hover-row.markdown-hover"),l=Al("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(nn(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const N=e.content,{element:A}=this._register(this._markdownRenderer.render(N,{actionHandler:this._linkHandler,asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}}));l.appendChild(A)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const N=Al("div.hover-row.status-bar"),A=Al("div.actions");e.actions.forEach(M=>{const O=this._keybindingService.lookupKeybinding(M.commandId),V=O?O.getLabel():null;this._register(d8.render(A,{label:M.label,commandId:M.commandId,run:H=>{M.run(H),this.dispose()},iconClass:M.iconClass},V))}),N.appendChild(A),this._hover.containerDomNode.appendChild(N)}this._hoverContainer=Al("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:((D=e.persistence)==null?void 0:D.hideOnHover)===void 0?c=typeof e.content=="string"||vw(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,(R=e.appearance)!=null&&R.showHoverHint){const N=Al("div.hover-row.status-bar"),A=Al("div.info");A.textContent=v(1699,"Hold {0} key to mouse over",_t?"Option":"Alt"),N.appendChild(A),this._hover.containerDomNode.appendChild(N)}const h=[...this._target.targetElements];c||h.push(this._hoverContainer);const d=this._register(new tq(h));if(this._register(d.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const N=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new tq(N)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=d}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=mD(this._hoverContainer,Al("div")),n=Be(this._hoverContainer,Al("div"));i.tabIndex=0,n.tabIndex=0,this._register(ie(n,"focus",r=>{e.focus(),r.preventDefault()})),this._register(ie(i,"focus",r=>{t.focus(),r.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const r=i;if(typeof r.tabIndex=="number"&&r.tabIndex>=0)return r}const n=this.findLastFocusableChild(i);if(n)return n}}render(e){var n;e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&eTe(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(n=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:n.getAriaLabel());i&&xk(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=h=>{const d=JX(h),g=h.getBoundingClientRect();return{top:g.top*d,bottom:g.bottom*d,right:g.right*d,left:g.left*d}},t=this._target.targetElements.map(h=>e(h)),{top:i,right:n,bottom:r,left:o}=t[0],a=n-o,l=r-i,c={top:i,right:n,bottom:r,left:o,width:a,height:l,center:{x:o+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.offsetHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight*this._maxHeightRatioRelativeToWindow;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const n=this._x+i;(n<e.left||n>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){var e,t;this._isDisposed||(this._onDispose.fire(),(t=(e=this._target).dispose)==null||t.call(e),this._hoverContainer.remove(),this._messageListeners.dispose(),super.dispose()),this._isDisposed=!0}};LO=gIe([Sx(1,rs),Sx(2,yi),Sx(3,KD),Sx(4,Mo)],LO);class tq extends Ec{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e,t=200){super(),this._elements=e,this._eventDebounceDelay=t,this._isMouseIn=!0,this._mouseTimer=this._register(new Yn),this._onMouseOut=this._register(new Z);for(const i of this._elements)this.onmouseover(i,()=>this._onTargetMouseOver()),this.onmouseleave(i,()=>this._onTargetMouseLeave())}_onTargetMouseOver(){this._isMouseIn=!0,this._mouseTimer.clear()}_onTargetMouseLeave(){this._isMouseIn=!1,this._mouseTimer.value=new _c(()=>this._fireIfMouseOutside(),this._eventDebounceDelay)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class mIe{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}var Ss;(function(s){function e(r,o){if(r.start>=o.end||o.start>=r.end)return{start:0,end:0};const a=Math.max(r.start,o.start),l=Math.min(r.end,o.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}s.intersect=e;function t(r){return r.end-r.start<=0}s.isEmpty=t;function i(r,o){return!t(e(r,o))}s.intersects=i;function n(r,o){const a=[],l={start:r.start,end:Math.min(o.start,r.end)},c={start:Math.max(o.end,r.start),end:r.end};return t(l)||a.push(l),t(c)||a.push(c),a}s.relativeComplement=n})(Ss||(Ss={}));function pIe(s){const e=s;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var cd;(function(s){s[s.AVOID=0]="AVOID",s[s.ALIGN=1]="ALIGN"})(cd||(cd={}));function c_(s,e,t){const i=t.mode===cd.ALIGN?t.offset:t.offset+t.size,n=t.mode===cd.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=s-i?i:e<=n?n-e:Math.max(s-e,0):e<=n?n-e:e<=s-i?i:0}const x_=class x_ extends le{constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=le.None,this.toDisposeOnSetContainer=le.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=Ke(".context-view"),Dz(this.view),this.setContainer(e,t),this._register(qe(()=>this.setContainer(null,1)))}setContainer(e,t){var n;this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,(n=this.shadowRootHostElement)==null||n.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=Ke(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=_Ie,this.shadowRoot.appendChild(o),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(Ke("slot"))}else this.container.appendChild(this.view);const r=new Pe;x_.BUBBLE_UP_EVENTS.forEach(o=>{r.add(bs(this.container,o,a=>{this.onDOMEvent(a,!1)}))}),x_.BUBBLE_DOWN_EVENTS.forEach(o=>{r.add(bs(this.container,o,a=>{this.onDOMEvent(a,!0)},!0))}),this.toDisposeOnSetContainer=r}}show(e){var t,i;this.isVisible()&&this.hide(),_l(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",sZ(this.view),this.toDisposeOnClean=e.render(this.view)||le.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)==null||i.call(t)}getViewElement(){return this.view}layout(){var e,t;if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(gc&&VC.pointerEvents)){this.hide();return}(t=(e=this.delegate)==null?void 0:e.layout)==null||t.call(e),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(nn(e)){const _=ta(e),b=JX(e);t={top:_.top*b,left:_.left*b,width:_.width*b,height:_.height*b}}else pIe(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=l7(this.view),n=N4(this.view),r=this.delegate.anchorPosition??0,o=this.delegate.anchorAlignment??0,a=this.delegate.anchorAxisAlignment??0;let l,c;const h=Kt();if(a===0){const _={offset:t.top-h.pageYOffset,size:t.height,position:r===0?0:1},b={offset:t.left,size:t.width,position:o===0?0:1,mode:cd.ALIGN};l=c_(h.innerHeight,n,_)+h.pageYOffset,Ss.intersects({start:l,end:l+n},{start:_.offset,end:_.offset+_.size})&&(b.mode=cd.AVOID),c=c_(h.innerWidth,i,b)}else{const _={offset:t.left,size:t.width,position:o===0?0:1},b={offset:t.top,size:t.height,position:r===0?0:1,mode:cd.ALIGN};c=c_(h.innerWidth,i,_),Ss.intersects({start:c,end:c+i},{start:_.offset,end:_.offset+_.size})&&(b.mode=cd.AVOID),l=c_(h.innerHeight,n,b)+h.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(r===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const d=ta(this.container),g=this.container.scrollTop||0,p=this.container.scrollLeft||0;this.view.style.top=`${l-(this.useFixedPosition?ta(this.view).top:d.top)+g}px`,this.view.style.left=`${c-(this.useFixedPosition?ta(this.view).left:d.left)+p}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),Dz(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,Ue(e).document.activeElement):t&&!Gn(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}};x_.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],x_.BUBBLE_DOWN_EVENTS=["click"];let kO=x_;const _Ie=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Nanum Gothic", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var bIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},wIe=function(s,e){return function(t,i){e(t,i,s)}};let c2=class extends le{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new kO(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let n;t?t===this.layoutService.getContainer(Ue(t))?n=1:i?n=3:n=2:n=1,this.contextView.setContainer(t??this.layoutService.activeContainer,n),this.contextView.show(e);const r={close:()=>{this.openContextView===r&&this.hideContextView()}};return this.openContextView=r,r}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};c2=bIe([wIe(0,ch)],c2);class vIe extends c2{getContextViewElement(){return this.contextView.getViewElement()}}function Nte(s){const e=s;return typeof e=="object"&&"markdown"in e&&"markdownNotSupportedFallback"in e}class CIe{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(ns(e)||nn(e)||e===void 0)n=e;else{this._cancellationTokenSource=new ym;const r=this._cancellationTokenSource.token;let o;if(Nte(e)?_1(e.markdown)?o=e.markdown(r).then(a=>a??e.markdownNotSupportedFallback):o=e.markdown??e.markdownNotSupportedFallback:o=e.element(r),o instanceof Promise?(this._hoverWidget||this.show(v(1700,"Loading..."),t,i),n=await o):n=o,this.isDisposed||r.isCancellationRequested)return}this.show(n,t,i)}show(e,t,i){var r;const n=this._hoverWidget;if(this.hasContent(e)){const o={content:e,target:this.target,actions:i==null?void 0:i.actions,linkHandler:i==null?void 0:i.linkHandler,trapFocus:i==null?void 0:i.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!n,showHoverHint:(r=i==null?void 0:i.appearance)==null?void 0:r.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(o,t)}n==null||n.dispose()}hasContent(e){return e?vw(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)==null?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)==null||e.dispose(),(t=this._cancellationTokenSource)==null||t.dispose(!0),this._cancellationTokenSource=void 0}}var yIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vp=function(s,e){return function(t,i){e(t,i,s)}};let EO=class extends le{constructor(e,t,i,n,r,o){super(),this._instantiationService=e,this._configurationService=t,this._keybindingService=n,this._layoutService=r,this._accessibilityService=o,this._currentDelayedHoverWasShown=!1,this._delayedHovers=new Map,this._managedHovers=new Map,this._register(i.onDidShowContextMenu(()=>this.hideHover())),this._contextViewHandler=this._register(new c2(this._layoutService)),this._register(Hd.registerCommandAndKeybindingRule({id:"workbench.action.showHover",weight:0,primary:yX(2089,2087),handler:()=>{this._showAndFocusHoverForActiveElement()}}))}showInstantHover(e,t,i,n){const r=this._createHover(e,i);if(r)return this._showHover(r,e,t),r}showDelayedHover(e,t){var n;if(e.id===void 0&&(e.id=iq(e.content)),!this._currentDelayedHover||this._currentDelayedHoverWasShown){if((n=this._currentHover)!=null&&n.isLocked)return;if(Bh(this._currentHoverOptions)===Bh(e))return this._currentHover;if(this._currentHover&&!this._currentHover.isDisposed&&this._currentDelayedHoverGroupId!==void 0&&this._currentDelayedHoverGroupId===(t==null?void 0:t.groupId))return this.showInstantHover({...e,appearance:{...e.appearance,skipFadeInAnimation:!0}})}else if(this._currentDelayedHover&&Bh(this._currentHoverOptions)===Bh(e))return this._currentDelayedHover;const i=this._createHover(e,void 0);if(!i){this._currentDelayedHover=void 0,this._currentDelayedHoverWasShown=!1,this._currentDelayedHoverGroupId=void 0;return}return this._currentDelayedHover=i,this._currentDelayedHoverWasShown=!1,this._currentDelayedHoverGroupId=t==null?void 0:t.groupId,v1(this._configurationService.getValue("workbench.hover.delay")).then(()=>{i&&!i.isDisposed&&(this._currentDelayedHoverWasShown=!0,this._showHover(i,e))}),i}setupDelayedHover(e,t,i){const n=()=>({...typeof t=="function"?t():t,target:e});return this._setupDelayedHover(e,n,i)}setupDelayedHoverAtMouse(e,t,i){const n=r=>({...typeof t=="function"?t():t,target:{targetElements:[e],x:r!==void 0?r.x+10:void 0}});return this._setupDelayedHover(e,n,i)}_setupDelayedHover(e,t,i){const n=new Pe;return n.add(ie(e,Le.MOUSE_OVER,r=>{this.showDelayedHover(t(r),{groupId:i==null?void 0:i.groupId})})),i!=null&&i.setupKeyboardEvents&&n.add(ie(e,Le.KEY_DOWN,r=>{const o=new si(r);(o.equals(10)||o.equals(3))&&this.showInstantHover(t(),!0)})),this._delayedHovers.set(e,{show:r=>{this.showInstantHover(t(),r)}}),n.add(qe(()=>this._delayedHovers.delete(e))),n}_createHover(e,t){var a,l,c,h;if(this._currentDelayedHover=void 0,e.content===""||(a=this._currentHover)!=null&&a.isLocked||(e.id===void 0&&(e.id=iq(e.content)),Bh(this._currentHoverOptions)===Bh(e)))return;this._currentHoverOptions=e,this._lastHoverOptions=e;const i=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),n=Kn();t||(i&&n?n.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=n):this._lastFocusedElementBeforeOpen=void 0);const r=new Pe,o=this._instantiationService.createInstance(LO,e);if((l=e.persistence)!=null&&l.sticky&&(o.isLocked=!0),(c=e.position)!=null&&c.hoverPosition&&!Cm(e.position.hoverPosition)&&(e.target={targetElements:nn(e.target)?[e.target]:e.target.targetElements,x:e.position.hoverPosition.x+10}),o.onDispose(()=>{var g,p;((g=this._currentHover)==null?void 0:g.domNode)&&tZ(this._currentHover.domNode)&&((p=this._lastFocusedElementBeforeOpen)==null||p.focus()),Bh(this._currentHoverOptions)===Bh(e)&&this.doHideHover(),r.dispose()},void 0,r),!e.container){const d=nn(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(Ue(d))}if(o.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,r),(h=e.persistence)!=null&&h.sticky)r.add(ie(Ue(e.container).document,Le.MOUSE_DOWN,d=>{Gn(d.target,o.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const g of e.target.targetElements)r.add(ie(g,Le.CLICK,()=>this.hideHover()));else r.add(ie(e.target,Le.CLICK,()=>this.hideHover()));const d=Kn();if(d){const g=Ue(d).document;r.add(ie(d,Le.KEY_DOWN,p=>{var _;return this._keyDown(p,o,!!((_=e.persistence)!=null&&_.hideOnKeyDown))})),r.add(ie(g,Le.KEY_DOWN,p=>{var _;return this._keyDown(p,o,!!((_=e.persistence)!=null&&_.hideOnKeyDown))})),r.add(ie(d,Le.KEY_UP,p=>this._keyUp(p,o))),r.add(ie(g,Le.KEY_UP,p=>this._keyUp(p,o)))}}if("IntersectionObserver"in ni){const d=new IntersectionObserver(p=>this._intersectionChange(p,o),{threshold:0}),g="targetElements"in e.target?e.target.targetElements[0]:e.target;d.observe(g),r.add(qe(()=>d.disconnect()))}return this._currentHover=o,o}_showHover(e,t,i){this._contextViewHandler.showContextView(new xIe(e,i),t.container)}hideHover(e){var t;!e&&((t=this._currentHover)!=null&&t.isLocked)||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showInstantHover(this._lastHoverOptions,!0,!0)}_showAndFocusHoverForActiveElement(){let e=Kn();for(;e;){const t=this._delayedHovers.get(e)??this._managedHovers.get(e);if(t){t.show(!0);return}e=e.parentElement}}_keyDown(e,t,i){var o,a;if(e.key==="Alt"){t.isLocked=!0;return}const n=new si(e);this._keybindingService.resolveKeyboardEvent(n).getSingleModifierDispatchChords().some(l=>!!l)||this._keybindingService.softDispatch(n,n.target).kind!==0||i&&(!((o=this._currentHoverOptions)!=null&&o.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(a=this._lastFocusedElementBeforeOpen)==null||a.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}setupManagedHover(e,t,i,n){if(e.showNativeHover)return SIe(t,i);t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let r,o;const a=(p,_)=>{var C;const b=o!==void 0;p&&(o==null||o.dispose(),o=void 0),_&&(r==null||r.dispose(),r=void 0),b&&((C=e.onDidHideHover)==null||C.call(e),o=void 0)},l=(p,_,b,C)=>new _c(async()=>{(!o||o.isDisposed)&&(o=new CIe(e,b||t,p>0),await o.update(typeof i=="function"?i():i,_,{...n,trapFocus:C}))},p),c=new Pe;let h=!1;c.add(ie(t,Le.MOUSE_DOWN,()=>{h=!0,a(!0,!0)},!0)),c.add(ie(t,Le.MOUSE_UP,()=>{h=!1},!0)),c.add(ie(t,Le.MOUSE_LEAVE,p=>{h=!1,a(!1,p.fromElement===t)},!0)),c.add(ie(t,Le.MOUSE_OVER,p=>{if(r)return;const _=new Pe,b={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const C=x=>{b.x=x.x+10,lA(x,t)||a(!0,!0)};_.add(ie(t,Le.MOUSE_MOVE,C,!0))}r=_,lA(p,t)&&_.add(l(typeof e.delay=="function"?e.delay(i):e.delay,!1,b))},!0));const d=p=>{if(h||r||!lA(p,t))return;const _={targetElements:[t],dispose:()=>{}},b=new Pe,C=()=>a(!0,!0);b.add(ie(t,Le.BLUR,C,!0)),b.add(l(typeof e.delay=="function"?e.delay(i):e.delay,!1,_)),r=b};gl(t)||c.add(ie(t,Le.FOCUS,d,!0));const g={show:p=>{a(!1,!0),l(0,p,void 0,p)},hide:()=>{a(!0,!0)},update:async(p,_)=>{i=p,await(o==null?void 0:o.update(i,void 0,_))},dispose:()=>{this._managedHovers.delete(t),c.dispose(),a(!0,!0)}};return this._managedHovers.set(t,g),g}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};EO=yIe([Vp(0,It),Vp(1,yi),Vp(2,uh),Vp(3,rs),Vp(4,ch),Vp(5,Mo)],EO);function Bh(s){if(s!==void 0)return(s==null?void 0:s.id)??s}function iq(s){if(!nn(s))return typeof s=="string"?s.toString():s.value}function nq(s){const e=typeof s=="function"?s():s;if(ns(e))return ite(e);if(Nte(e))return e.markdownNotSupportedFallback}function SIe(s,e){function t(i){i?s.setAttribute("title",i):s.removeAttribute("title")}return t(nq(e)),{update:i=>t(nq(i)),show:()=>{},hide:()=>{},dispose:()=>t(void 0)}}class xIe{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function lA(s,e){return nn(s.target)&&LIe(s.target,e)===e}function LIe(s,e){for(e=e??Ue(s).document.body;!s.hasAttribute("custom-hover")&&s!==e;)s=s.parentElement;return s}yt(ty,EO,1);lh((s,e)=>{const t=s.getColor(Hve);t&&(e.addRule(`.monaco-hover.workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-hover.workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const kIe={ctrlCmd:!1,alt:!1};var oC;(function(s){s[s.Blur=1]="Blur",s[s.Gesture=2]="Gesture",s[s.Other=3]="Other"})(oC||(oC={}));var $l;(function(s){s[s.NONE=0]="NONE",s[s.FIRST=1]="FIRST",s[s.SECOND=2]="SECOND",s[s.LAST=3]="LAST"})($l||($l={}));var ui;(function(s){s[s.First=1]="First",s[s.Second=2]="Second",s[s.Last=3]="Last",s[s.Next=4]="Next",s[s.Previous=5]="Previous",s[s.NextPage=6]="NextPage",s[s.PreviousPage=7]="PreviousPage",s[s.NextSeparator=8]="NextSeparator",s[s.PreviousSeparator=9]="PreviousSeparator"})(ui||(ui={}));var u2;(function(s){s[s.Title=1]="Title",s[s.Inline=2]="Inline",s[s.Input=3]="Input"})(u2||(u2={}));const Om=gt("quickInputService");var Y_;(function(s){s[s.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",s[s.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Y_||(Y_={}));var qf;(function(s){s[s.None=0]="None",s[s.Initialized=1]="Initialized",s[s.Closed=2]="Closed"})(qf||(qf={}));const mE=class mE extends le{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new vv),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=qf.None,this.cache=new Map,this.flushDelayer=this._register(new zX(mE.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)==null||t.forEach((n,r)=>this.acceptExternal(r,n)),(i=e.deleted)==null||i.forEach(n=>this.acceptExternal(n,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===qf.Closed)return;let i=!1;Zo(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return Zo(i)?t:i}getBoolean(e,t){const i=this.get(e);return Zo(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return Zo(i)?t:parseInt(i,10)}async set(e,t,i=!1){if(this.state===qf.Closed)return;if(Zo(t))return this.delete(e,i);const n=ar(t)||Array.isArray(t)?aNe(t):String(t);if(this.cache.get(e)!==n)return this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===qf.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())==null||t()})}async flush(e){if(!(this.state===qf.Closed||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===Y_.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}};mE.DEFAULT_FLUSH_DELAY=100;let Sw=mE;class cA{constructor(){this.onDidChangeItemsExternal=Se.None,this.items=new Map}async updateItems(e){var t,i;(t=e.insert)==null||t.forEach((n,r)=>this.items.set(r,n)),(i=e.delete)==null||i.forEach(n=>this.items.delete(n))}}const aL="__$__targetStorageMarker",ry=gt("storageService");var xw;(function(s){s[s.NONE=0]="NONE",s[s.SHUTDOWN=1]="SHUTDOWN"})(xw||(xw={}));function EIe(s){const e=s.get(aL);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const pE=class pE extends le{constructor(e={flushInterval:pE.DEFAULT_FLUSH_INTERVAL}){super(),this._onDidChangeValue=this._register(new vv),this._onDidChangeTarget=this._register(new vv),this._onWillSaveState=this._register(new Z),this.onWillSaveState=this._onWillSaveState.event,this.runFlushWhenIdle=this._register(new Yn),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0,this.flushWhenIdleScheduler=this._register(new Es(()=>this.doFlushWhenIdle(),e.flushInterval))}onDidChangeValue(e,t,i){return Se.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Q6(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}emitDidChangeValue(e,t){const{key:i,external:n}=t;if(i===aL){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:n})}get(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.get(e,i)}getBoolean(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getBoolean(e,i)}getNumber(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getNumber(e,i)}store(e,t,i,n,r=!1){if(Zo(t)){this.remove(e,i,r);return}this.withPausedEmitters(()=>{var o;this.updateKeyTarget(e,i,n),(o=this.getStorage(i))==null||o.set(e,t,r)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var n;this.updateKeyTarget(e,t,void 0),(n=this.getStorage(t))==null||n.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,n=!1){var o,a;const r=this.getKeyTargets(t);typeof i=="number"?r[e]!==i&&(r[e]=i,(o=this.getStorage(t))==null||o.set(aL,JSON.stringify(r),n)):typeof r[e]=="number"&&(delete r[e],(a=this.getStorage(t))==null||a.set(aL,JSON.stringify(r),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?EIe(t):Object.create(null)}async flush(e=xw.NONE){this._onWillSaveState.fire({reason:e});const t=this.getStorage(-1),i=this.getStorage(0),n=this.getStorage(1);switch(e){case xw.NONE:await Lv.settled([(t==null?void 0:t.whenFlushed())??Promise.resolve(),(i==null?void 0:i.whenFlushed())??Promise.resolve(),(n==null?void 0:n.whenFlushed())??Promise.resolve()]);break;case xw.SHUTDOWN:await Lv.settled([(t==null?void 0:t.flush(0))??Promise.resolve(),(i==null?void 0:i.flush(0))??Promise.resolve(),(n==null?void 0:n.flush(0))??Promise.resolve()]);break}}};pE.DEFAULT_FLUSH_INTERVAL=60*1e3;let DO=pE;class DIe extends DO{constructor(){super(),this.applicationStorage=this._register(new Sw(new cA,{hint:Y_.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new Sw(new cA,{hint:Y_.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new Sw(new cA,{hint:Y_.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}shouldFlushWhenIdle(){return!1}}var TIe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},sq=function(s,e){return function(t,i){e(t,i,s)}};const NIe=gt("IInlineCompletionsService"),IIe=new He("inlineCompletions.snoozed",!1,v(79,"Whether inline completions are currently snoozed"));let TO=class extends le{get snoozeTimeLeft(){return this._snoozeTimeEnd===void 0?0:Math.max(0,this._snoozeTimeEnd-Date.now())}constructor(e,t){super(),this._contextKeyService=e,this._telemetryService=t,this._onDidChangeIsSnoozing=this._register(new Z),this.onDidChangeIsSnoozing=this._onDidChangeIsSnoozing.event,this._snoozeTimeEnd=void 0,this._recentCompletionIds=[],this._timer=this._register(new _c);const i=IIe.bindTo(this._contextKeyService);this._register(this.onDidChangeIsSnoozing(()=>i.set(this.isSnoozing())))}setSnoozeDuration(e){if(e<0)throw new $e(`Invalid snooze duration: ${e}. Duration must be non-negative.`);if(e===0){this.cancelSnooze();return}const t=this.isSnoozing(),i=this.snoozeTimeLeft;this._snoozeTimeEnd=Date.now()+e,t||this._onDidChangeIsSnoozing.fire(!0),this._timer.cancelAndSet(()=>{if(!this.isSnoozing())this._onDidChangeIsSnoozing.fire(!1);else throw new $e("Snooze timer did not fire as expected")},this.snoozeTimeLeft+1),this._reportSnooze(e-i,e)}isSnoozing(){return this.snoozeTimeLeft>0}cancelSnooze(){this.isSnoozing()&&(this._reportSnooze(-this.snoozeTimeLeft,0),this._snoozeTimeEnd=void 0,this._timer.cancel(),this._onDidChangeIsSnoozing.fire(!1))}reportNewCompletion(e){this._lastCompletionId=e,this._recentCompletionIds.unshift(e),this._recentCompletionIds.length>5&&this._recentCompletionIds.pop()}_reportSnooze(e,t){const i=Math.round(e/1e3),n=Math.round(t/1e3);this._telemetryService.publicLog2("inlineCompletions.snooze",{deltaSeconds:i,totalSeconds:n,lastCompletionId:this._lastCompletionId,recentCompletionIds:this._recentCompletionIds})}};TO=TIe([sq(0,Ot),sq(1,ah)],TO);yt(NIe,TO,1);const RIe=gt("IWorkspaceEditService");class L8{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(Rg.is(t))return Rg.lift(t);if(Q_.is(t))return Q_.lift(t);throw new Error("Unsupported edit")})}}class Rg extends L8{static is(e){return e instanceof Rg?!0:ar(e)&&mt.isUri(e.resource)&&ar(e.textEdit)}static lift(e){return e instanceof Rg?e:new Rg(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class Q_ extends L8{static is(e){return e instanceof Q_?!0:ar(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof Q_?e:new Q_(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const us={enableSplitViewResizing:!0,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},AIe=Object.freeze({id:"editor",order:5,type:"object",title:v(147,"Editor"),scope:6}),h2={...AIe,properties:{"editor.tabSize":{type:"number",default:_s.tabSize,minimum:1,maximum:100,markdownDescription:v(148,"The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:v(149,'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:_s.insertSpaces,markdownDescription:v(150,"Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:_s.detectIndentation,markdownDescription:v(151,"Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:_s.trimAutoWhitespace,description:v(152,"Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:_s.largeFileOptimizations,description:v(153,"Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[v(154,"Turn off Word Based Suggestions."),v(155,"Only suggest words from the active document."),v(156,"Suggest words from all open documents of the same language."),v(157,"Suggest words from all open documents.")],description:v(158,"Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[v(159,"Semantic highlighting enabled for all color themes."),v(160,"Semantic highlighting disabled for all color themes."),v(161,"Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:v(162,"Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:v(163,"Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:v(164,"Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:v(165,"Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:v(166,"Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:v(167,"Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:v(168,"Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `#editor.experimental.preferTreeSitter#` for specific languages will take precedence."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.css":{type:"boolean",default:!1,markdownDescription:v(169,"Controls whether tree sitter parsing should be turned on for css. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for css."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.typescript":{type:"boolean",default:!1,markdownDescription:v(170,"Controls whether tree sitter parsing should be turned on for typescript. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for typescript."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.ini":{type:"boolean",default:!1,markdownDescription:v(171,"Controls whether tree sitter parsing should be turned on for ini. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for ini."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.regex":{type:"boolean",default:!1,markdownDescription:v(172,"Controls whether tree sitter parsing should be turned on for regex. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for regex."),tags:["experimental"],experiment:{mode:"auto"}},"editor.language.brackets":{type:["array","null"],default:null,description:v(173,"Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:v(174,"The opening bracket character or string sequence.")},{type:"string",description:v(175,"The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:v(176,"Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:v(177,"The opening bracket character or string sequence.")},{type:"string",description:v(178,"The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:us.maxComputationTime,description:v(179,"Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:us.maxFileSize,description:v(180,"Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:us.renderSideBySide,description:v(181,"Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:us.renderSideBySideInlineBreakpoint,description:v(182,"If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:us.useInlineViewWhenSpaceIsLimited,description:v(183,"If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:us.renderMarginRevertIcon,description:v(184,"When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:us.renderGutterMenu,description:v(185,"When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:us.ignoreTrimWhitespace,description:v(186,"When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:us.renderIndicators,description:v(187,"Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:us.diffCodeLens,description:v(188,"Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:us.diffWordWrap,markdownEnumDescriptions:[v(189,"Lines will never wrap."),v(190,"Lines will wrap at the viewport width."),v(191,"Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:us.diffAlgorithm,markdownEnumDescriptions:[v(192,"Uses the legacy diffing algorithm."),v(193,"Uses the advanced diffing algorithm.")]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:us.hideUnchangedRegions.enabled,markdownDescription:v(194,"Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:us.hideUnchangedRegions.revealLineCount,markdownDescription:v(195,"Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:us.hideUnchangedRegions.minimumLineCount,markdownDescription:v(196,"Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:us.hideUnchangedRegions.contextLineCount,markdownDescription:v(197,"Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:us.experimental.showMoves,markdownDescription:v(198,"Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:us.experimental.showEmptyDecorations,description:v(199,"Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:us.experimental.useTrueInlineView,description:v(200,"If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function MIe(s){return typeof s.type<"u"||typeof s.anyOf<"u"}for(const s of Yp){const e=s.schema;if(typeof e<"u")if(MIe(e))h2.properties[`editor.${s.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(h2.properties[t]=e[t])}let xx=null;function Ite(){return xx===null&&(xx=Object.create(null),Object.keys(h2.properties).forEach(s=>{xx[s]=!0})),xx}function OIe(s){return Ite()[`editor.${s}`]||!1}function PIe(s){return Ite()[`diffEditor.${s}`]||!1}const FIe=ss.as(Dm.Configuration);FIe.registerConfiguration(h2);class BIe{static insert(e,t){return{range:new G(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function Lx(s){return Object.isFrozen(s)?s:ame(s)}class ts{static createEmptyModel(e){return new ts({},[],[],void 0,e)}constructor(e,t,i,n,r){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=r,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw){const e=(Array.isArray(this.raw)?this.raw:[this.raw]).map(t=>{if(t instanceof ts)return t;const i=new VIe("",this.logService);return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?Yz(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return Lx(i.rawConfiguration.getValue(e))},get override(){return t?Lx(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return Lx(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:r,identifiers:o,keys:a}of i.rawConfiguration.overrides){const l=new ts(r,a,[],void 0,i.logService).getValue(e);l!==void 0&&n.push({identifiers:o,value:l})}return n.length?Lx(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?Yz(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=vu(this.contents),i=vu(this.overrides),n=[...this.keys],r=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(const o of e)if(r.push(...o.raw?Array.isArray(o.raw)?o.raw:[o.raw]:[o]),!o.isEmpty()){this.mergeContents(t,o.contents);for(const a of o.overrides){const[l]=i.filter(c=>Sn(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=Jg(l.keys)):i.push(vu(a))}for(const a of o.keys)n.indexOf(a)===-1&&n.push(a)}return new ts(t,n,i,!r.length||r.every(o=>o instanceof ts)?void 0:r,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of Jg([...Object.keys(this.contents),...Object.keys(t)])){let r=this.contents[n];const o=t[n];o&&(typeof r=="object"&&typeof o=="object"?(r=vu(r),this.mergeContents(r,o)):r=o),i[n]=r}return new ts(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&ar(e[i])&&ar(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=vu(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=r=>{r&&(i?this.mergeContents(i,r):i=vu(r))};for(const r of this.overrides)r.identifiers.length===1&&r.identifiers[0]===e?t=r.contents:r.identifiers.includes(e)&&n(r.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),n0e(this.contents,e),Id.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>Sn(i.identifiers,dk(e))),1))}updateValue(e,t,i){if(LZ(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),Id.test(e)){const n=dk(e),r={identifiers:n,keys:Object.keys(this.contents[e]),contents:z4(this.contents[e],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>Sn(a.identifiers,n));o!==-1?this.overrides[o]=r:this.overrides.push(r)}}}class VIe{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||ts.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new ts(i,n,r,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseRaw(e,t){const i=ss.as(Dm.Configuration),n=i.getConfigurationProperties(),r=i.getExcludedConfigurationProperties(),o=this.filter(e,n,r,!0,t);e=o.raw;const a=z4(e,h=>this.logService.error(`Conflict in settings file ${this._name}: ${h}`)),l=Object.keys(e),c=this.toOverrides(e,h=>this.logService.error(`Conflict in settings file ${this._name}: ${h}`));return{contents:a,keys:l,overrides:c,restricted:o.restricted,hasExcludedProperties:o.hasExcludedProperties}}filter(e,t,i,n,r){var c;let o=!1;if(!(r!=null&&r.scopes)&&!(r!=null&&r.skipRestricted)&&!(r!=null&&r.skipUnregistered)&&!((c=r==null?void 0:r.exclude)!=null&&c.length))return{raw:e,restricted:[],hasExcludedProperties:o};const a={},l=[];for(const h in e)if(Id.test(h)&&n){const d=this.filter(e[h],t,i,!1,r);a[h]=d.raw,o=o||d.hasExcludedProperties,l.push(...d.restricted)}else{const d=t[h];d!=null&&d.restricted&&l.push(h),this.shouldInclude(h,d,i,r)?a[h]=e[h]:o=!0}return{raw:a,restricted:l,hasExcludedProperties:o}}shouldInclude(e,t,i,n){var a,l;if((a=n.exclude)!=null&&a.includes(e))return!1;if((l=n.include)!=null&&l.includes(e))return!0;if(n.skipRestricted&&(t!=null&&t.restricted)||n.skipUnregistered&&!t)return!1;const r=t??i[e],o=r?typeof r.scope<"u"?r.scope:4:void 0;return o===void 0||n.scopes===void 0?!0:n.scopes.includes(o)}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(Id.test(n)){const r={};for(const o in e[n])r[o]=e[n][o];i.push({identifiers:dk(n),keys:Object.keys(r),contents:z4(r,t)})}return i}}class HIe{constructor(e,t,i,n,r,o,a,l,c,h,d,g,p){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=r,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=h,this.workspaceConfiguration=d,this.folderConfigurationModel=g,this.memoryConfigurationModel=p}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class YD{constructor(e,t,i,n,r,o,a,l,c,h){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=r,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=h,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new Ts,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=ts.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),r=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(e,c)!==void 0&&a.add(c);return new HIe(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,r||void 0,o)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration)if(this._remoteUserConfiguration.isEmpty())this._userConfiguration=this._localUserConfiguration;else{const e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new ts(e.contents,e.keys,e.overrides,void 0,this.logService)}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);if(t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){n=n.merge();for(const r of this._policyConfiguration.keys)n.setValue(r,this._policyConfiguration.getValue(r))}return n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const r=this._memoryConfigurationByResource.get(e);r&&(i=i.merge(r))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:r}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),r=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.userLocal,t),a=this.parseConfigurationModel(e.userRemote,t),l=this.parseConfigurationModel(e.workspace,t),c=e.folders.reduce((h,d)=>(h.set(mt.revive(d[0]),this.parseConfigurationModel(d[1],t)),h),new Ts);return new YD(i,n,r,o,a,l,c,ts.createEmptyModel(t),new Ts,t)}static parseConfigurationModel(e,t){return new ts(e.contents,e.keys,e.overrides,e.raw,t)}}class WIe{constructor(e,t,i,n,r){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=r,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=YD.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const r=n+i.length;if(r>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(r);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!$r(l,c)}return!0}}const d2={kind:0},zIe={kind:1};function UIe(s,e,t){return{kind:2,commandId:s,commandArgs:e,isBubble:t}}class Lw{constructor(e,t,i){var n;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const r of e){const o=r.command;o&&o.charAt(0)!=="-"&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Lw.handleRemovals([].concat(e).concat(t));for(let r=0,o=this._keybindings.length;r<o;r++){const a=this._keybindings[r];if(a.chords.length===0)continue;const l=(n=a.when)==null?void 0:n.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let n=0;n<t.length;n++)if(t[n]!==e.chords[n])return!1}return!(i&&i.type!==1&&(!e.when||!tbe(i,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,r=e.length;n<r;n++){const o=e[n];if(o.command&&o.command.charAt(0)==="-"){const a=o.command.substring(1);t.has(a)?t.get(a).push(o):t.set(a,[o])}}if(t.size===0)return e;const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];if(!o.command||o.command.length===0){i.push(o);continue}if(o.command.charAt(0)==="-")continue;const a=t.get(o.command);if(!a||!o.isDefault){i.push(o);continue}let l=!1;for(const c of a){const h=c.when;if(this._isTargetedForRemoval(o,c.chords,h)){l=!0;break}}if(!l){i.push(o);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const r=i[n];if(r.command===t.command)continue;let o=!0;for(let a=1;a<r.chords.length&&a<t.chords.length;a++)if(r.chords[a]!==t.chords[a]){o=!1;break}o&&Lw.whenIsEntirelyIncluded(r.when,t.when)&&this._removeFromLookupMap(r)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:P4(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t,i=!1){const n=this._lookupMap.get(e);if(typeof n>"u"||n.length===0)return null;if(n.length===1&&!i)return n[0];for(let r=n.length-1;r>=0;r--){const o=n[r];if(t.contextMatchesRules(o.when))return o}return i?null:n[n.length-1]}resolve(e,t,i){const n=[...t,i];this._log(`| Resolving ${n}`);const r=this._map.get(n[0]);if(r===void 0)return this._log("\\ No keybinding entries."),d2;let o=null;if(n.length<2)o=r;else{o=[];for(let l=0,c=r.length;l<c;l++){const h=r[l];if(n.length>h.chords.length)continue;let d=!0;for(let g=1;g<n.length;g++)if(h.chords[g]!==n[g]){d=!1;break}d&&o.push(h)}}const a=this._findCommand(e,o);return a?n.length<a.chords.length?(this._log(`\\ From ${o.length} keybinding entries, awaiting ${a.chords.length-n.length} more chord(s), when: ${rq(a.when)}, source: ${oq(a)}.`),zIe):(this._log(`\\ From ${o.length} keybinding entries, matched ${a.command}, when: ${rq(a.when)}, source: ${oq(a)}.`),UIe(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${o.length} keybinding entries, no when clauses matched the context.`),d2)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(Lw._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function rq(s){return s?`${s.serialize()}`:"no when condition"}function oq(s){return s.extensionId?s.isBuiltinExtension?`built-in extension ${s.extensionId}`:`user extension ${s.extensionId}`:s.isDefault?"built-in":"user"}const jIe=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class $Ie extends le{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Se.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,n,r){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=r,this._onDidUpdateKeybindings=this._register(new Z),this._currentChords=[],this._currentChordChecker=new Y6,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=u_.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new _c,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t,i=!1){const n=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService,i);if(n)return n.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),d2;const[n]=i.getDispatchChords();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),d2;const r=this._contextKeyService.getContext(t),o=this._currentChords.map((({keypress:a})=>a));return this._getResolver().resolve(r,o,n)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw QL("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(v(1701,"({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:n})=>n).join(", ");this._currentChordStatusMessage=this._notificationService.status(v(1702,"({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),rc.enabled&&rc.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.close(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],rc.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchChords();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=u_.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=u_.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[r]=i.getChords();return this._ignoreSingleModifiers=new u_(r),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let r=null,o=null;if(i){const[h]=e.getSingleModifierDispatchChords();r=h,o=h?[h]:[]}else[r]=e.getDispatchChords(),o=this._currentChords.map(({keypress:h})=>h);if(r===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,o,r);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const h=this._currentChords.map(({label:d})=>d).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${h}, ${l}".`),this._notificationService.status(v(1703,"The key combination ({0}, {1}) is not a command.",h,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}return n}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(r,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const h=this._currentChords.map(({label:d})=>d).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${h}, ${l}".`),this._notificationService.status(v(1704,"The key combination ({0}, {1}) is not a command.",h,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,h=>this._notificationService.warn(h)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,h=>this._notificationService.warn(h))}finally{this._currentlyDispatchingCommandId=null}jIe.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return n}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}const _E=class _E{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}};_E.EMPTY=new _E(null);let u_=_E;class aq{constructor(e,t,i,n,r,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?NO(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=NO(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=r,this.extensionId=o,this.isBuiltinExtension=a}}function NO(s){const e=[];for(let t=0,i=s.length;t<i;t++){const n=s[t];if(!n)return[];e.push(n)}return e}class QD{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=i(a);if(l===null)return null;n[r]=YIe(a,l,this.modifierLabels[e])}return n.join(" ")}}const k8=new QD({ctrlKey:"",shiftKey:"",altKey:"",metaKey:"",separator:""},{ctrlKey:v(35,"Ctrl"),shiftKey:v(36,"Shift"),altKey:v(37,"Alt"),metaKey:v(38,"Windows"),separator:"+"},{ctrlKey:v(39,"Ctrl"),shiftKey:v(40,"Shift"),altKey:v(41,"Alt"),metaKey:v(42,"Super"),separator:"+"}),qIe=new QD({ctrlKey:v(43,"Control"),shiftKey:v(44,"Shift"),altKey:v(45,"Option"),metaKey:v(46,"Command"),separator:"+"},{ctrlKey:v(47,"Control"),shiftKey:v(48,"Shift"),altKey:v(49,"Alt"),metaKey:v(50,"Windows"),separator:"+"},{ctrlKey:v(51,"Control"),shiftKey:v(52,"Shift"),altKey:v(53,"Alt"),metaKey:v(54,"Super"),separator:"+"}),GIe=new QD({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),KIe=new QD({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function YIe(s,e,t){if(e===null)return"";const i=[];return s.ctrlKey&&i.push(t.ctrlKey),s.shiftKey&&i.push(t.shiftKey),s.altKey&&i.push(t.altKey),s.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class QIe extends v_e{constructor(e,t){if(super(),t.length===0)throw sD("chords");this._os=e,this._chords=t}getLabel(){return k8.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return qIe.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:GIe.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return KIe.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new w_e(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class aC extends QIe{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"";case 16:return"";case 17:return"";case 18:return""}return Lu.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":Lu.toString(e.keyCode)}_getElectronAccelerator(e){return Lu.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=Lu.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return aC.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Lu.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=B6[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof sm)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new sm(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=NO(e.chords.map(n=>this._toKeyCodeChord(n)));return i.length>0?[new aC(i,t)]:[]}}const XIe=gt("labelService"),ZIe=gt("progressService"),E8=gt("editorProgressService");class JIe{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class eRe{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?H6(e,this._value,0,e.length,this._from,this._to):Y1(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class tRe{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?H6(e,this._value,0,e.length,this._from,this._to):Y1(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class iRe{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new tRe(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return uz(e,this._value.scheme);if(this._states[this._stateIdx]===2)return uz(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return m4(e,this._value.query);if(this._states[this._stateIdx]===5)return m4(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}const Ww=class Ww{static wrap(e){return e===void 0?Ww.Val:e}static unwrap(e){return e===Ww.Val?void 0:e}};Ww.Val=Symbol("undefined_placeholder");let fu=Ww;class kx{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}class kw{static forUris(e=()=>!1,t=()=>!1){return new kw(new iRe(e,t))}static forStrings(){return new kw(new JIe)}static forConfigKeys(){return new kw(new eRe)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new kx,this._root.segment=i.value());const r=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new kx,n.left.segment=i.value()),r.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new kx,n.right.segment=i.value()),r.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new kx,n.mid.segment=i.value()),r.push([0,n]),n=n.mid;else break}const o=fu.unwrap(n.value);n.value=fu.wrap(t),n.key=e;for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const h=r[a][0],d=r[a+1][0];if(h===1&&d===1)r[a][1]=l.rotateLeft();else if(h===-1&&d===-1)r[a][1]=l.rotateRight();else if(h===1&&d===-1)l.right=r[a+1][1]=r[a+1][1].rotateRight(),r[a][1]=l.rotateLeft();else if(h===-1&&d===1)l.left=r[a+1][1]=r[a+1][1].rotateLeft(),r[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}return o}get(e){var t;return fu.unwrap((t=this._getNode(e))==null?void 0:t.value)}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let r=this._root;for(;r;){const o=i.cmp(r.segment);if(o>0)n.push([-1,r]),r=r.left;else if(o<0)n.push([1,r]),r=r.right;else if(i.hasNext())i.next(),n.push([0,r]),r=r.mid;else break}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){const o=[[1,r]],a=this._min(r.right,o);if(a.key){r.key=a.key,r.value=a.value,r.segment=a.segment;const l=a.right;if(o.length>1){const[h,d]=o[o.length-1];switch(h){case-1:d.left=l;break;case 0:XL(!1);case 1:XL(!1)}}else r.right=l;const c=this._balanceByStack(o);if(n.length>0){const[h,d]=n[n.length-1];switch(h){case-1:d.left=c;break;case 0:d.mid=c;break;case 1:d.right=c;break}}else this._root=c}}else{const o=r.left??r.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=o;break;case 0:l.mid=o;break;case 1:l.right=o;break}}else this._root=o}this._root=this._balanceByStack(n)??this._root}}_min(e,t){for(;e.left;)t.push([-1,e]),e=e.left;return e}_balanceByStack(e){for(let t=e.length-1;t>=0;t--){const i=e[t][1];i.updateHeight();const n=i.balanceFactor();if(n>1?(i.right.balanceFactor()>=0||(i.right=i.right.rotateRight()),e[t][1]=i.rotateLeft()):n<-1&&(i.left.balanceFactor()<=0||(i.left=i.left.rotateLeft()),e[t][1]=i.rotateRight()),t>0)switch(e[t-1][0]){case-1:e[t-1][1].left=e[t][1];break;case 1:e[t-1][1].right=e[t][1];break;case 0:e[t-1][1].mid=e[t][1];break}else return e[0][1]}}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),n=fu.unwrap(i.value)||n,i=i.mid;else break}return i&&fu.unwrap(i.value)||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const r=i.cmp(n.segment);if(r>0)n=n.left;else if(r<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?fu.unwrap(n.value):void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value!==void 0&&t.push([e.key,fu.unwrap(e.value)]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const nRe=gt("contextService");class sRe{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const rRe="code-workspace";v(2050,"Code Workspace");const oRe="4064f6ec-cb38-4ad0-af64-ee6467e63c82";var lq;(function(s){s.inspectTokensAction=v(786,"Developer: Inspect Tokens")})(lq||(lq={}));var cq;(function(s){s.gotoLineActionLabel=v(787,"Go to Line/Column...")})(cq||(cq={}));var uq;(function(s){s.helpQuickAccessActionLabel=v(788,"Show all Quick Access Providers")})(uq||(uq={}));var hq;(function(s){s.quickCommandActionLabel=v(789,"Command Palette"),s.quickCommandHelp=v(790,"Show And Run Commands")})(hq||(hq={}));var dq;(function(s){s.quickOutlineActionLabel=v(791,"Go to Symbol..."),s.quickOutlineByCategoryActionLabel=v(792,"Go to Symbol by Category...")})(dq||(dq={}));var IO;(function(s){s.editorViewAccessibleLabel=v(793,"Editor content")})(IO||(IO={}));var fq;(function(s){s.toggleHighContrast=v(794,"Toggle High Contrast Theme")})(fq||(fq={}));var RO;(function(s){s.bulkEditServiceSummary=v(795,"Made {0} edits in {1} files")})(RO||(RO={}));const aRe=gt("workspaceTrustManagementService");let O1=[],D8=[],Rte=[];function Ex(s,e=!1){lRe(s,!1,e)}function lRe(s,e,t){const i=cRe(s,e);O1.push(i),i.userConfigured?Rte.push(i):D8.push(i),t&&!i.userConfigured&&O1.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function cRe(s,e){return{id:s.id,mime:s.mime,filename:s.filename,extension:s.extension,filepattern:s.filepattern,firstline:s.firstline,userConfigured:e,filenameLowercase:s.filename?s.filename.toLowerCase():void 0,extensionLowercase:s.extension?s.extension.toLowerCase():void 0,filepatternLowercase:s.filepattern?Uee(s.filepattern.toLowerCase()):void 0,filepatternOnPath:s.filepattern?s.filepattern.indexOf(dn.sep)>=0:!1}}function uRe(){O1=O1.filter(s=>s.userConfigured),D8=[]}function hRe(s,e){return dRe(s,e).map(t=>t.id)}function dRe(s,e){let t;if(s)switch(s.scheme){case tt.file:t=s.fsPath;break;case tt.data:{t=uk.parseMetaData(s).get(uk.META_DATA_LABEL);break}case tt.vscodeNotebookCell:t=void 0;break;default:t=s.path}if(!t)return[{id:"unknown",mime:Du.unknown}];t=t.toLowerCase();const i=kX(t),n=gq(t,i,Rte);if(n)return[n,{id:Aa,mime:Du.text}];const r=gq(t,i,D8);if(r)return[r,{id:Aa,mime:Du.text}];if(e){const o=fRe(e);if(o)return[o,{id:Aa,mime:Du.text}]}return[{id:"unknown",mime:Du.unknown}]}function gq(s,e,t){var o;let i,n,r;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){i=l;break}if(l.filepattern&&(!n||l.filepattern.length>n.filepattern.length)){const c=l.filepatternOnPath?s:e;(o=l.filepatternLowercase)!=null&&o.call(l,c)&&(n=l)}l.extension&&(!r||l.extension.length>r.extension.length)&&e.endsWith(l.extensionLowercase)&&(r=l)}if(i)return i;if(n)return n;if(r)return r}function fRe(s){if(G6(s)&&(s=s.substr(1)),s.length>0)for(let e=O1.length-1;e>=0;e--){const t=O1[e];if(!t.firstline)continue;const i=s.match(t.firstline);if(i&&i.length>0)return t}}const Dx=Object.prototype.hasOwnProperty,mq="vs.editor.nullLanguage";class gRe{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(mq,0),this._register(Aa,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||mq}}const zw=class zw extends le{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,zw.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new gRe,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(S1.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){zw.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},uRe();const e=[].concat(S1.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),ss.as(Dm.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;Dx.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)Ex({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)Ex({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)Ex({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);MX(l)||Ex({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let r=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?r=[null]:r=t.aliases),r!==null)for(const a of r)!a||a.length===0||e.aliases.push(a);const o=r!==null&&r.length>0;if(!(o&&r[0]===null)){const a=(o?r[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?Dx.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return Dx.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&Dx.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:hRe(e,t)}};zw.instanceCount=0;let AO=zw;const Uw=class Uw extends le{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new Z),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new Z),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new Z({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,Uw.instanceCount++,this._registry=this._register(new AO(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){Uw.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){return this._registry.guessLanguageIdByFilepathOrFirstLine(e,t).at(0)??null}createById(e){return new pq(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new pq(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=Aa),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),hn.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}};Uw.instanceCount=0;let MO=Uw;class pq{constructor(e,t){this._value=Ii(this,e,()=>t()),this.onDidChange=Se.fromObservable(this._value)}get languageId(){return this._value.get()}}function Yu(s,e){if(s!==void 0){const t=s.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=Yu(i[1].trim(),e)),`var(${i[0]}, ${e})`}return s}return e}function _q(s){const e=s.replaceAll(/[^_\-a-z0-9]/gi,"");return e!==s&&console.warn(`CSS ident value ${s} modified to ${e} to be safe for CSS`),e}function Vh(s){return`'${s.replaceAll(/'/g,"\\000027")}'`}function vc(s){return s?Vr`url('${CSS.escape(jX.uriToBrowserUri(s).toString(!0))}')`:"url('')"}function Tx(s,e=!1){const t=CSS.escape(s);return!e&&t!==s&&console.warn(`CSS class name ${s} modified to ${t} to be safe for CSS`),t}function Vr(s,...e){return s.reduce((t,i,n)=>{const r=e[n]||"";return t+i+r},"")}class uA{constructor(){this._parts=[]}push(...e){this._parts.push(...e)}join(e=`
`){return this._parts.join(e)}}const Ate={TEXT:Du.text},mRe=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let XD=mRe;const pRe=new lr(()=>XD("mouse",!1)),_Re=new lr(()=>XD("element",!1));function bRe(s){XD=s}function jd(s){return s==="element"?_Re.value:pRe.value}function Mte(){return XD("element",!0)}let Ote={showInstantHover:()=>{},showDelayedHover:()=>{},setupDelayedHover:()=>le.None,setupDelayedHoverAtMouse:()=>le.None,hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>({dispose:()=>{},show:()=>{},hide:()=>{},update:()=>{}}),showManagedHover:()=>{}};function wRe(s){Ote=s}function Sl(){return Ote}class vRe{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}class bf extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function bq(s,e){const t=[];for(const i of e){if(s.start>=i.range.end)continue;if(s.end<i.range.start)break;const n=Ss.intersect(s,i.range);Ss.isEmpty(n)||t.push({range:n,size:i.size})}return t}function OO({start:s,end:e},t){return{start:s+t,end:e+t}}function CRe(s){const e=[];let t=null;for(const i of s){const n=i.range.start,r=i.range.end,o=i.size;if(t&&o===t.size){t.range.end=r;continue}t={range:{start:n,end:r},size:o},e.push(t)}return e}function yRe(...s){return CRe(s.reduce((e,t)=>e.concat(t),[]))}class SRe{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const n=i.length-t,r=bq({start:0,end:e},this.groups),o=bq({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:OO(l.range,n),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=yRe(r,a,o),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const n of this.groups){const r=n.range.end-n.range.start,o=i+r*n.size;if(e<o)return t+Math.floor((e-i)/n.size);t+=r,i=o}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const n of this.groups){const r=n.range.end-n.range.start,o=i+r;if(e<o)return this._paddingTop+t+(e-i)*n.size;t+=r*n.size,i=o}return-1}}class xRe{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const n=Ke(".monaco-list-row"),o=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:o}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}function LRe(s,e,t,i=[]){if(!s.dataTransfer)return;const n=Ke(".monaco-drag-image");n.textContent=t,n.classList.add(...i),(a=>{for(;a&&!a.classList.contains("monaco-workbench");)a=a.parentElement;return a||e.ownerDocument.body})(e).appendChild(n),s.dataTransfer.setDragImage(n,-10,-10),setTimeout(()=>n.remove(),0)}var hh=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};const wf={CurrentDragAndDropData:void 0},Ml={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(s){return[s]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class oy{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class kRe{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class ERe{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function DRe(s,e){return Array.isArray(s)&&Array.isArray(e)?Sn(s,e):s===e}class TRe{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}const bE=class bE{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:cR(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,n=Ml){var o,a;if(this.virtualDelegate=t,this.domId=`list_id_${++bE.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new HC(50),this.splicing=!1,this.dragOverAnimationStopDisposable=le.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=le.None,this.onDragLeaveTimeout=le.None,this.currentSelectionDisposable=le.None,this.disposables=new Pe,this._onDidChangeContentHeight=new Z,this._onDidChangeContentWidth=new Z,this.onDidChangeContentHeight=Se.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(const l of i)this.renderers.set(l.templateId,l);if(this.cache=this.disposables.add(new xRe(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Ml.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new TRe(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Ml.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(fr.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new eb({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:l=>Ar(Ue(this.domNode),l)})),this.scrollableElement=this.disposables.add(new HD(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Ml.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Ml.verticalScrollMode,useShadows:n.useShadows??Ml.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(ie(this.rowsContainer,hi.Change,l=>this.onTouchChange(l))),this.disposables.add(ie(this.scrollableElement.getDomNode(),"scroll",l=>{const c=l.target,h=c.scrollTop;c.scrollTop=0,n.scrollToActiveElement&&this.setScrollTop(this.scrollTop+h)})),this.disposables.add(ie(this.domNode,"dragover",l=>this.onDragOver(this.toDragEvent(l)))),this.disposables.add(ie(this.domNode,"drop",l=>this.onDrop(this.toDragEvent(l)))),this.disposables.add(ie(this.domNode,"dragleave",l=>this.onDragLeave(this.toDragEvent(l)))),this.disposables.add(ie(this.domNode,"dragend",l=>this.onDragEnd(l))),n.userSelection){if(n.dnd)throw new Error("DND and user selection cannot be used simultaneously");this.disposables.add(ie(this.domNode,"mousedown",l=>this.onPotentialSelectionStart(l)))}this.setRowLineHeight=n.setRowLineHeight??Ml.setRowLineHeight,this.setRowHeight=n.setRowHeight??Ml.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Ml.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Ml.dnd),this.layout((o=n.initialSize)==null?void 0:o.height,(a=n.initialSize)==null?void 0:a.width),n.scrollToActiveElement&&this._setupFocusObserver(e)}_setupFocusObserver(e){this.disposables.add(ie(e,"focus",()=>{const t=Kn();this.activeElement!==t&&t!==null&&(this.activeElement=t,this._scrollToActiveElement(this.activeElement,e))},!0))}_scrollToActiveElement(e,t){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect().top-i.top;r<0&&this.setScrollTop(this.scrollTop+r)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(e){return new SRe(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},o=Ss.intersect(n,r),a=new Map;for(let D=o.end-1;D>=o.start;D--){const R=this.items[D];if(R.dragStartDisposable.dispose(),R.checkedDisposable.dispose(),R.row){let N=a.get(R.templateId);N||(N=[],a.set(R.templateId,N));const A=this.renderers.get(R.templateId);A&&A.disposeElement&&A.disposeElement(R.element,D,R.row.templateData,{height:R.size}),N.unshift(R.row)}R.row=null,R.stale=!0}const l={start:e+t,end:this.items.length},c=Ss.intersect(l,n),h=Ss.relativeComplement(l,n),d=i.map(D=>({id:String(this.itemId++),element:D,templateId:this.virtualDelegate.getTemplateId(D),size:this.virtualDelegate.getHeight(D),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(D),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:le.None,checkedDisposable:le.None,stale:!1}));let g;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,d),g=this.items,this.items=d):(this.rangeMap.splice(e,t,d),g=GL(this.items,e,t,d));const p=i.length-t,_=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),b=OO(c,p),C=Ss.intersect(_,b);for(let D=C.start;D<C.end;D++)this.updateItemInDOM(this.items[D],D);const x=Ss.relativeComplement(b,_);for(const D of x)for(let R=D.start;R<D.end;R++)this.removeItemFromDOM(R);const S=h.map(D=>OO(D,p)),k=[{start:e,end:e+i.length},...S].map(D=>Ss.intersect(_,D)).reverse();for(const D of k)for(let R=D.end-1;R>=D.start;R--){const N=this.items[R],A=a.get(N.templateId),M=A==null?void 0:A.pop();this.insertItemInDOM(R,M)}for(const D of a.values())for(const R of D)this.cache.release(R);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),g.map(D=>D.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Ar(Ue(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getVisibleRange(this.lastRenderTop,this.lastRenderHeight).start}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:C1e(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:cR(this.domNode)})}render(e,t,i,n,r,o=!1,a=!1){const l=this.getRenderRange(t,i),c=Ss.relativeComplement(l,e).reverse(),h=Ss.relativeComplement(e,l);if(o){const d=Ss.intersect(e,l);for(let g=d.start;g<d.end;g++)this.updateItemInDOM(this.items[g],g)}this.cache.transact(()=>{for(const d of h)for(let g=d.start;g<d.end;g++)this.removeItemFromDOM(g,a);for(const d of c)for(let g=d.end-1;g>=d.start;g--)this.insertItemInDOM(g)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){var c,h;const i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{const d=this.cache.alloc(i.templateId);i.row=d.row,i.stale||(i.stale=d.isReusingConnectedDomNode)}const n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);const r=this.accessibilityProvider.isChecked(i.element),o=d=>d==="mixed"?"mixed":String(!!d);if(typeof r=="boolean"||r==="mixed")i.row.domNode.setAttribute("aria-checked",o(r));else if(r){const d=g=>i.row.domNode.setAttribute("aria-checked",o(g));d(r.value),i.checkedDisposable=r.onDidChange(()=>d(r.value))}if(i.stale||!i.row.domNode.parentElement){const d=((h=(c=this.items.at(e+1))==null?void 0:c.row)==null?void 0:h.domNode)??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==d)&&this.rowsContainer.insertBefore(i.row.domNode,d),i.stale=!1}this.updateItemInDOM(i,e);const a=this.renderers.get(i.templateId);if(!a)throw new Error(`No renderer found for template id ${i.templateId}`);a==null||a.renderElement(i.element,e,i.row.templateData,{height:i.size});const l=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!l,l&&(i.dragStartDisposable=ie(i.row.domNode,"dragstart",d=>this.onDragStart(i.element,l,d))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=cR(e.row.domNode);const t=Ue(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e,t){const i=this.items[e];if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const n=this.renderers.get(i.templateId);n&&n.disposeElement&&n.disposeElement(i.element,e,i.row.templateData,{height:i.size,onScroll:t}),this.cache.release(i.row),i.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return Se.map(this.disposables.add(new jt(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return Se.map(this.disposables.add(new jt(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return Se.filter(Se.map(this.disposables.add(new jt(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return Se.map(this.disposables.add(new jt(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return Se.map(this.disposables.add(new jt(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return Se.map(this.disposables.add(new jt(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return Se.any(Se.map(this.disposables.add(new jt(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),Se.map(this.disposables.add(new jt(this.domNode,hi.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return Se.map(this.disposables.add(new jt(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return Se.map(this.disposables.add(new jt(this.rowsContainer,hi.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:r}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth,void 0,!0),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){var o,a;if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(Ate.TEXT,t);let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(n,i)),typeof r>"u"&&(r=String(n.length)),LRe(i,this.domNode,r,[this.domId]),this.domNode.classList.add("dragging"),this.currentDragData=new oy(n),wf.CurrentDragAndDropData=new kRe(n),(a=(o=this.dnd).onDragStart)==null||a.call(o,this.currentDragData,i)}onPotentialSelectionStart(e){this.currentSelectionDisposable.dispose();const t=h1e(this.domNode),i=this.currentSelectionDisposable=new Pe,n=i.add(new Pe);n.add(ie(this.domNode,"selectstart",()=>{n.add(ie(t,"mousemove",r=>{var o;((o=t.getSelection())==null?void 0:o.isCollapsed)===!1&&this.setupDragAndDropScrollTopAnimation(r)})),i.add(qe(()=>{const r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.currentSelectionBounds=void 0,this.render(r,this.lastRenderTop,this.lastRenderHeight,void 0,void 0)})),i.add(ie(t,"selectionchange",()=>{const r=t.getSelection();if(!r||r.isCollapsed){n.isDisposed&&i.dispose();return}let o=this.getIndexOfListElement(r.anchorNode),a=this.getIndexOfListElement(r.focusNode);o!==void 0&&a!==void 0&&(a<o&&([o,a]=[a,o]),this.currentSelectionBounds={start:o,end:a})}))})),n.add(ie(t,"mouseup",()=>{var r;n.dispose(),this.teardownDragAndDropScrollTopAnimation(),((r=t.getSelection())==null?void 0:r.isCollapsed)!==!1&&i.dispose()}))}getIndexOfListElement(e){var t;if(!(!e||!this.domNode.contains(e)))for(;e&&e!==this.domNode;){if((t=e.dataset)!=null&&t.index)return Number(e.dataset.index);e=e.parentElement}}onDragOver(e){var r,o;if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),wf.CurrentDragAndDropData&&wf.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(wf.CurrentDragAndDropData)this.currentDragData=wf.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new ERe}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&((r=t.effect)==null?void 0:r.type)===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=Jg(i).filter(a=>a>=-1&&a<this.length).sort((a,l)=>a-l),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(DRe(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=qe(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(const a of i){const l=this.items[a];l.dropTarget=!0,(o=l.row)==null||o.domNode.classList.add(n)}this.currentDragFeedbackDisposable=qe(()=>{var a;for(const l of i){const c=this.items[l];c.dropTarget=!1,(a=c.row)==null||a.domNode.classList.remove(n)}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=C4(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&((i=(t=this.dnd).onDragLeave)==null||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,wf.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){var t,i;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,wf.CurrentDragAndDropData=void 0,(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=le.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=v1e(this.domNode).top;this.dragOverAnimationDisposable=N1e(Ue(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=C4(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;const i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return xr(n,0,3)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;(nn(i)||iZ(i))&&i!==this.rowsContainer&&t.contains(i);){const n=i.getAttribute("data-index");if(n){const r=Number(n);if(!isNaN(r))return r}i=i.parentElement}}getVisibleRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}getRenderRange(e,t){const i=this.getVisibleRange(e,t);if(this.currentSelectionBounds){const n=this.rangeMap.count;i.start=Math.min(i.start,this.currentSelectionBounds.start,n),i.end=Math.min(Math.max(i.end,this.currentSelectionBounds.end+1),n)}return i}_rerender(e,t,i){const n=this.getRenderRange(e,t);let r,o;e===this.elementTop(n.start)?(r=n.start,o=0):n.end-n.start>1&&(r=n.start+1,o=this.elementTop(r)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let h=l.start;h<l.end;h++){const d=this.probeDynamicHeight(h);d!==0&&this.rangeMap.splice(h,1,[this.items[h]]),a+=d,c=c||d!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const h=Ss.relativeComplement(n,l);for(const g of h)for(let p=g.start;p<g.end;p++)this.items[p].row&&this.removeItemFromDOM(p);const d=Ss.relativeComplement(l,n).reverse();for(const g of d)for(let p=g.end-1;p>=g.start;p--)this.insertItemInDOM(p);for(let g=l.start;g<l.end;g++)this.items[g].row&&this.updateItemInDOM(this.items[g],g);if(typeof r=="number"){const g=this.scrollable.getFutureScrollPosition().scrollTop-e,p=this.elementTop(r)-o+g;this.setScrollTop(p,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){var o,a,l;const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const c=this.virtualDelegate.getDynamicHeight(t.element);if(c!==null){const h=t.size;return t.size=c,t.lastDynamicHeightWidth=this.renderWidth,c-h}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!Gn(t.row.domNode,Ue(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;const{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const r=this.renderers.get(t.templateId);if(!r)throw new $e("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,n.templateData),t.size=n.domNode.offsetHeight,(o=r.disposeElement)==null||o.call(r,t.element,e,n.templateData),(l=(a=this.virtualDelegate).setDynamicHeight)==null||l.call(a,t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){var e,t,i;for(const n of this.items)if(n.dragStartDisposable.dispose(),n.checkedDisposable.dispose(),n.row){const r=this.renderers.get(n.row.templateId);r&&((e=r.disposeElement)==null||e.call(r,n.element,-1,n.row.templateData,void 0),r.disposeTemplate(n.row.templateData))}this.items=[],(t=this.domNode)==null||t.remove(),(i=this.dragOverAnimationDisposable)==null||i.dispose(),this.disposables.dispose()}};bE.InstanceCount=0;let Fa=bE;hh([Vi],Fa.prototype,"onMouseClick",null);hh([Vi],Fa.prototype,"onMouseDblClick",null);hh([Vi],Fa.prototype,"onMouseMiddleClick",null);hh([Vi],Fa.prototype,"onMouseDown",null);hh([Vi],Fa.prototype,"onMouseOver",null);hh([Vi],Fa.prototype,"onMouseOut",null);hh([Vi],Fa.prototype,"onContextMenu",null);hh([Vi],Fa.prototype,"onTouchStart",null);hh([Vi],Fa.prototype,"onTap",null);function lC(s){return new NRe(s)}class NRe extends GX{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}var $d=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class IRe{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex(r=>r.templateData===i);if(n>=0){const r=this.renderedElements[n];this.trait.unrender(i),r.index=t}else{const r={index:t,templateData:i};this.renderedElements.push(r)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const r of this.renderedElements)r.index<e?n.push(r):r.index>=e+t&&n.push({index:r.index+i-t,templateData:r.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let f2=class{get onChange(){return this._onChange.event}get name(){return this._trait}get renderer(){return new IRe(this)}constructor(e){this._trait=e,this.indexes=[],this.sortedIndexes=[],this._onChange=new Z}splice(e,t,i){const n=i.length-t,r=e+t,o=[];let a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)o.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&o.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)o.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(o,o)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(vq),t)}_set(e,t,i){const n=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const o=PO(r,e);return this.renderer.renderIndexes(o),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return Kge(this.sortedIndexes,e,vq)>=0}dispose(){_n(this._onChange)}};$d([Vi],f2.prototype,"renderer",null);class RRe extends f2{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class hA{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const r=new Set(n),o=i.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,o)}}function ay(s,e){return s.classList.contains(e)?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:ay(s.parentElement,e)}function P0(s){return ay(s,"monaco-editor")}function ARe(s){return ay(s,"monaco-custom-toggle")}function MRe(s){return ay(s,"action-item")}function Ew(s){return ay(s,"monaco-tree-sticky-row")}function cC(s){return s.classList.contains("monaco-tree-sticky-container")}function Pte(s){return s.tagName==="A"&&s.classList.contains("monaco-button")||s.tagName==="DIV"&&s.classList.contains("monaco-button-dropdown")?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:Pte(s.parentElement)}class Fte{get onKeyDown(){return Se.chain(this.disposables.add(new jt(this.view.domNode,"keydown")).event,e=>e.filter(t=>!gl(t.target)).map(t=>new si(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new Pe,this.multipleSelectionDisposables=new Pe,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(_t?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(nr(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}$d([Vi],Fte.prototype,"onKeyDown",null);var Xl;(function(s){s[s.Automatic=0]="Automatic",s[s.Trigger=1]="Trigger"})(Xl||(Xl={}));var h_;(function(s){s[s.Idle=0]="Idle",s[s.Typing=1]="Typing"})(h_||(h_={}));const ORe=new class{mightProducePrintableCharacter(s){return s.ctrlKey||s.metaKey||s.altKey?!1:s.keyCode>=31&&s.keyCode<=56||s.keyCode>=21&&s.keyCode<=30||s.keyCode>=98&&s.keyCode<=107||s.keyCode>=85&&s.keyCode<=95}};class PRe{constructor(e,t,i,n,r){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=n,this.delegate=r,this.enabled=!1,this.state=h_.Idle,this.mode=Xl.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new Pe,this.disposables=new Pe,this.updateOptions(e.options)}updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??Xl.Automatic}enable(){if(this.enabled)return;let e=!1;const t=Se.chain(this.enabledDisposables.add(new jt(this.view.domNode,"keydown")).event,r=>r.filter(o=>!gl(o.target)).filter(()=>this.mode===Xl.Automatic||this.triggered).map(o=>new si(o)).filter(o=>e||this.keyboardNavigationEventFilter(o)).filter(o=>this.delegate.mightProducePrintableCharacter(o)).forEach(o=>Rt.stop(o,!0)).map(o=>o.browserEvent.key)),i=Se.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);Se.reduce(Se.any(t,i),(r,o)=>o===null?null:(r||"")+o,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var t;const e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){const i=(t=this.list.options.accessibilityProvider)==null?void 0:t.getAriaLabel(this.list.element(e[0]));typeof i=="string"?Vv(i):i&&Vv(i.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=h_.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===h_.Idle?1:0;this.state=h_.Typing;for(let r=0;r<this.list.length;r++){const o=(i+r+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(o)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(o2(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}const c=fTe(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}else if(typeof l>"u"||o2(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class FRe{constructor(e,t){this.list=e,this.view=t,this.disposables=new Pe;const i=Se.chain(this.disposables.add(new jt(t.domNode,"keydown")).event,r=>r.filter(o=>!gl(o.target)).map(o=>new si(o)));Se.chain(i,r=>r.filter(o=>o.keyCode===2&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!n||!nn(n)||n.tabIndex===-1)return;const r=Ue(n).getComputedStyle(n);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function Bte(s){return _t?s.browserEvent.metaKey:s.browserEvent.ctrlKey}function Vte(s){return s.browserEvent.shiftKey}function BRe(s){return u7(s)&&s.button===2}const wq={isSelectionSingleChangeEvent:Bte,isSelectionRangeChangeEvent:Vte};class Hte{get onPointer(){return this._onPointer.event}constructor(e){this.list=e,this.disposables=new Pe,this._onPointer=this.disposables.add(new Z),e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||wq),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(fr.addTarget(e.getHTMLElement()))),Se.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||wq))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){P0(e.browserEvent.target)||Kn()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(gl(e.browserEvent.target)||P0(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||gl(e.browserEvent.target)||P0(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),BRe(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(gl(e.browserEvent.target)||P0(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));const n=Math.min(i,t),r=Math.max(i,t),o=nr(n,r+1),a=this.list.getSelection(),l=zRe(PO(a,[i]),i);if(l.length===0)return;const c=PO(o,URe(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),r=n.filter(o=>o!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}}class VRe{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const n=Yu(e.listFocusAndSelectionOutline,Yu(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.focused,
				.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const r=Yu(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-enable-motion .monaco-table:hover > .monaco-split-view2,
				.monaco-enable-motion .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-enable-motion .monaco-table > .monaco-split-view2,
				.monaco-enable-motion .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}}const HRe={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:me.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:me.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:me.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},WRe={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function zRe(s,e){const t=s.indexOf(e);if(t===-1)return[];const i=[];let n=t-1;for(;n>=0&&s[n]===e-(t-n);)i.push(s[n--]);for(i.reverse(),n=t;n<s.length&&s[n]===e+(n-t);)i.push(s[n++]);return i}function PO(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){t.push(s[i]),i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):t.push(e[n++]);return t}function URe(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):n++;return t}const vq=(s,e)=>s-e;class jRe{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let r=0;for(const o of this.renderers)o.renderElement(e,t,i[r++],n)}disposeElement(e,t,i,n){var o;let r=0;for(const a of this.renderers)(o=a.disposeElement)==null||o.call(a,e,t,i[r],n),r+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class $Re{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return{container:e,disposables:new Pe}}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e),r=n&&typeof n!="string"?n:lC(n);i.disposables.add(vt(a=>{this.setAriaLabel(a.readObservable(r),i.container)}));const o=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof o=="number"?i.container.setAttribute("aria-level",`${o}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}}class qRe{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,e,t)}onDragOver(e,t,i,n,r){return this.dnd.onDragOver(e,t,i,n,r)}onDragLeave(e,t,i,n){var r,o;(o=(r=this.dnd).onDragLeave)==null||o.call(r,e,t,i,n)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}drop(e,t,i,n,r){this.dnd.drop(e,t,i,n,r)}dispose(){this.dnd.dispose()}}class xl{get onDidChangeFocus(){return Se.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return Se.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=Se.chain(this.disposables.add(new jt(this.view.domNode,"keydown")).event,r=>r.map(o=>new si(o)).filter(o=>e=o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>Rt.stop(o,!0)).filter(()=>!1)),i=Se.chain(this.disposables.add(new jt(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(o=>new si(o)).filter(o=>o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>Rt.stop(o,!0)).map(({browserEvent:o})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,h=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:h,browserEvent:o}})),n=Se.chain(this.view.onContextMenu,r=>r.filter(o=>!e).map(({element:o,index:a,browserEvent:l})=>({element:o,index:a,anchor:new So(Ue(this.view.domNode),l),browserEvent:l})));return Se.any(t,i,n)}get onKeyDown(){return this.disposables.add(new jt(this.view.domNode,"keydown")).event}get onDidFocus(){return Se.signal(this.disposables.add(new jt(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return Se.signal(this.disposables.add(new jt(this.view.domNode,"blur",!0)).event)}constructor(e,t,i,n,r=WRe){var c,h,d;this.user=e,this._options=r,this.focus=new f2("focused"),this.anchor=new f2("anchor"),this.eventBufferer=new FC,this._ariaLabel="",this.disposables=new Pe,this._onDidDispose=new Z,this.onDidDispose=this._onDidDispose.event;const o=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(c=this._options.accessibilityProvider)==null?void 0:c.getWidgetRole():"list";this.selection=new RRe(o!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new $Re(this.accessibilityProvider)),(d=(h=this.accessibilityProvider).onDidChangeActiveDescendant)==null||d.call(h,this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(g=>new jRe(g.templateId,[...a,g]));const l={...r,dnd:r.dnd&&new qRe(this,r.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",o),r.styleController)this.styleController=r.styleController(this.view.domId);else{const g=bl(this.view.domNode);this.styleController=new VRe(g,this.view.domId)}if(this.spliceable=new vRe([new hA(this.focus,this.view,r.identityProvider),new hA(this.selection,this.view,r.identityProvider),new hA(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new FRe(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new Fte(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){const g=r.keyboardNavigationDelegate||ORe;this.typeNavigationController=new PRe(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),g),this.disposables.add(this.typeNavigationController)}if(this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider){const g=this.accessibilityProvider.getWidgetAriaLabel(),p=g&&typeof g!="string"?g:lC(g);this.disposables.add(vt(_=>{this.ariaLabel=_.readObservable(p)}))}this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,n){return new Fa(e,t,i,n)}createMouseController(e){return new Hte(this)}updateOptions(e={}){var t,i;this._options={...this._options,...e},(t=this.typeNavigationController)==null||t.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(i=this.keyboardController)==null||i.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new bf(this.user,`Invalid start index: ${e}`);if(t<0)throw new bf(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new bf(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new bf(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new bf(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;const r=this.focus.get(),o=this.findNextIndex(r.length>0?r[0]+e:0,t,n);o>-1&&this.setFocus([o],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;const r=this.focus.get(),o=this.findPreviousIndex(r.length>0?r[0]-e:0,t,n);o>-1&&this.setFocus([o],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){const r=this.findPreviousIndex(i,!1,t);r>-1&&n!==r?this.setFocus([r],e):this.setFocus([i],e)}else{const r=this.view.getScrollTop();let o=r+this.view.renderHeight;i>n&&(o-=this.view.elementHeight(i)),this.view.setScrollTop(o),this.view.getScrollTop()!==r&&(this.setFocus([]),await v1(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n;const r=i(),o=this.view.getScrollTop()+r;o===0?n=this.view.indexAt(o):n=this.view.indexAfter(o-1);const a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){const l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{const l=o;this.view.setScrollTop(o-this.view.renderHeight-r),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await v1(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new bf(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),r=this.view.elementTop(e),o=this.view.elementHeight(e);if(Cm(t)){const a=o-this.view.renderHeight+i;this.view.setScrollTop(a*xr(t,0,1)+r-i)}else{const a=r+o,l=n+this.view.renderHeight;r<n+i&&a>=l||(r<n+i||a>=l&&o>=this.view.renderHeight?this.view.setScrollTop(r-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new bf(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),r=this.view.elementHeight(e);if(n<i+t||n+r>i+this.view.renderHeight)return null;const o=r-this.view.renderHeight+t;return Math.abs((i+t-n)/o)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var t;const e=this.focus.get();if(e.length>0){let i;(t=this.accessibilityProvider)!=null&&t.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}$d([Vi],xl.prototype,"onDidChangeFocus",null);$d([Vi],xl.prototype,"onDidChangeSelection",null);$d([Vi],xl.prototype,"onContextMenu",null);$d([Vi],xl.prototype,"onKeyDown",null);$d([Vi],xl.prototype,"onDidFocus",null);$d([Vi],xl.prototype,"onDidBlur",null);const gg=Ke,Wte="selectOption.entry.template";class GRe{get templateId(){return Wte}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=Be(e,gg(".option-text")),t.detail=Be(e,gg(".option-detail")),t.decoratorRight=Be(e,gg(".option-decorator-right")),t}renderElement(e,t,i){const n=i,r=e.text,o=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=r,n.detail.textContent=o||"",n.decoratorRight.textContent=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}}const Ul=class Ul extends le{constructor(e,t,i,n,r){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._selectionDetailsDisposables=this._register(new Pe),this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=n,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=Ul.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new Z,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(Sl().setupManagedHover(jd("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return Wte}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=Ke(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Be(this.selectDropDownContainer,gg(".select-box-details-pane"));const t=Be(this.selectDropDownContainer,gg(".select-box-dropdown-container-width-control")),i=Be(t,gg(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Be(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=bl(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(ie(this.selectDropDownContainer,Le.DRAG_START,n=>{Rt.stop(n,!0)}))}registerListeners(){this._register(bs(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(ie(this.selectElement,Le.CLICK,t=>{Rt.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(ie(this.selectElement,Le.MOUSE_DOWN,t=>{Rt.stop(t)}));let e;this._register(ie(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(ie(this.selectElement,"touchend",t=>{Rt.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(ie(this.selectElement,Le.KEY_DOWN,t=>{const i=new si(t);let n=!1;_t?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),Rt.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){Sn(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){var e;(e=this.selectList)==null||e.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){const e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){const e=this.styles.selectBackground??"",t=Yu(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;const i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.textContent="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=Ue(this.selectElement),i=ta(this.selectElement),n=Ue(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),o=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-Ul.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),h=Math.max(c,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=h,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let d=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const g=this._hasDetails?this._cachedMaxDetailsHeight:0,p=d+r+g,_=Math.floor((o-r-g)/this.getHeight()),b=Math.floor((a-r-g)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<Ul.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||_<1&&b<1?!1:(_<Ul.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&b>_&&this.options.length>_?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<Ul.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&_<1||this._dropDownPosition===1&&b<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&_+b<1)return this.hideSelectDropDown(!0),!1;p>o&&(d=_*this.getHeight())}else p>a&&(d=b*this.getHeight());return this.selectList.layout(d),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=d+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=d+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=h,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((r,o)=>{const a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,c=r.text.length+a+l;c>n&&(i=o,n=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=l7(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=Be(e,gg(".select-box-dropdown-list-container")),this.listRenderer=new GRe,this.selectList=this._register(new xl("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let r=n.text;return n.detail&&(r+=`. ${n.detail}`),n.decoratorRight&&(r+=`. ${n.decoratorRight}`),n.description&&(r+=`. ${n.description}`),r},getWidgetAriaLabel:()=>v(16,"Select Box"),getRole:()=>_t?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new jt(this.selectDropDownListContainer,"keydown")),i=Se.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(r=>new si(r)));this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(Se.chain(i,n=>n.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(ie(this.selectList.getHTMLElement(),Le.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(ie(this.selectDropDownContainer,Le.FOCUS_OUT,n=>{!this._isVisible||Gn(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;Rt.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const n=Number(i.getAttribute("data-index")),r=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!r&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=r=>{for(let o=0;o<r.childNodes.length;o++){const a=r.childNodes.item(o);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=x8({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this._selectionDetailsDisposables.clear(),this.selectionDetailsPane.textContent="";const t=this.options[e],i=(t==null?void 0:t.description)??"",n=(t==null?void 0:t.descriptionIsMarkdown)??!1;if(i){if(n){const r=t.descriptionMarkdownActionHandler,o=this._selectionDetailsDisposables.add(this.renderDescriptionMarkdown(i,r));this.selectionDetailsPane.appendChild(o.element)}else this.selectionDetailsPane.textContent=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){Rt.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){Rt.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){Rt.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(Rt.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){Rt.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){Rt.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){Rt.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){Rt.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=Lu.toString(e.keyCode);let i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),Rt.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};Ul.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32,Ul.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2,Ul.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;let FO=Ul;class KRe extends le{constructor(e,t,i,n){super(),this.selected=0,this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new Z),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(fr.addTarget(this.selectElement)),[hi.Tap].forEach(e=>{this._register(ie(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(bs(this.selectElement,"click",e=>{Rt.stop(e,!0)})),this._register(bs(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(bs(this.selectElement,"keydown",e=>{let t=!1;_t?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!Sn(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}}class YRe extends Ec{constructor(e,t,i,n,r){super(),_t&&!(r!=null&&r.useCustomDrawn)?this.selectBoxDelegate=new KRe(e,t,n,r):this.selectBoxDelegate=new FO(e,t,i,n,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class sl extends le{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof wd&&this._register(t.onDidChange(n=>{this.element&&this.handleActionChangeEvent(n)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new am)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(fr.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,Kr&&this._register(ie(e,Le.DRAG_START,n=>{var r;return(r=n.dataTransfer)==null?void 0:r.setData(Ate.TEXT,this._action.label)}))),this._register(ie(t,hi.Tap,n=>this.onClick(n,!0))),this._register(ie(t,Le.MOUSE_DOWN,n=>{i||Rt.stop(n,!0),this._action.enabled&&n.button===0&&t.classList.add("active")})),_t&&this._register(ie(t,Le.CONTEXT_MENU,n=>{n.button===0&&n.ctrlKey===!0&&this.onClick(n)})),this._register(ie(t,Le.CLICK,n=>{Rt.stop(n,!0),this.options&&this.options.isMenu||this.onClick(n)})),this._register(ie(t,Le.DBLCLICK,n=>{Rt.stop(n,!0)})),[Le.MOUSE_UP,Le.MOUSE_OUT].forEach(n=>{this._register(ie(t,n,r=>{Rt.stop(r),t.classList.remove("active")}))})}onClick(e,t=!1){var n;Rt.stop(e,!0);const i=Zo(this._context)?(n=this.options)!=null&&n.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}getHoverContents(){return this.getTooltip()}updateTooltip(){if(!this.element)return;const e=this.getHoverContents()??"";if(this.updateAriaLabel(),!this.customHover&&e!==""){const t=this.options.hoverDelegate??jd("element");this.customHover=this._store.add(Sl().setupManagedHover(t,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){const e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class T8 extends sl{constructor(e,t,i){i={...i,icon:i.icon!==void 0?i.icon:!1,label:i.label!==void 0?i.label:!0},super(e,t,i),this.options=i,this.cssClass=""}render(e){super.render(e),_d(this.element);const t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding&&!this.options.keybindingNotRenderedWithLabel){const i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===is.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label,this.options.keybinding&&(e=v(0,"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){var e;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(e=this.label)==null||e.classList.remove("codicon")}updateEnabled(){var e,t;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(e=this.element)==null||e.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(t=this.element)==null||t.classList.add("disabled"))}updateAriaLabel(){if(this.label){const e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class QRe extends sl{constructor(e,t,i,n,r,o,a){super(e,t),this.selectBox=new YRe(i,n,r,o,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){var e;(e=this.selectBox)==null||e.focus()}blur(){var e;(e=this.selectBox)==null||e.blur()}render(e){this.selectBox.render(e)}}class XRe extends am{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new Z),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=Be(e,Ke(".monaco-dropdown")),this._label=Be(this._element,Ke(".dropdown-label"));let i=t.labelRenderer;i||(i=r=>(r.textContent=t.label||"",null));for(const r of[Le.CLICK,Le.MOUSE_DOWN,hi.Tap])this._register(ie(this.element,r,o=>Rt.stop(o,!0)));for(const r of[Le.MOUSE_DOWN,hi.Tap])this._register(ie(this._label,r,o=>{u7(o)&&o.button!==0||(this.visible?this.hide():this.show())}));this._register(ie(this._label,Le.KEY_DOWN,r=>{const o=new si(r);(o.equals(3)||o.equals(10))&&(Rt.stop(r,!0),this.visible?this.hide():this.show())}));const n=i(this._label);n&&this._register(n),this._register(fr.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class ZRe extends XRe{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class g2 extends sl{get onDidChangeVisibility(){return this._onDidChangeVisibility.event}constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new Z),this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=r=>(this.element=Be(r,Ke("a.action-label")),this.renderLabel(this.element)),i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new ZRe(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{var o;(o=this.element)==null||o.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}renderLabel(e){let t=[];return typeof this.options.classNames=="string"?t=this.options.classNames.split(/\s+/g).filter(i=>!!i):this.options.classNames&&(t=this.options.classNames),t.find(i=>i==="icon")||t.push("codicon"),e.classList.add(...t),this._action.label&&this._register(Sl().setupManagedHover(this.options.hoverDelegate??jd("mouse"),e,this._action.label)),null}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){var e;(e=this.dropdownMenu)==null||e.show()}updateEnabled(){var t,i;const e=!this.action.enabled;(t=this.actionItem)==null||t.classList.toggle("disabled",e),(i=this.element)==null||i.classList.toggle("disabled",e)}}function JRe(s){return s?s.condition!==void 0:!1}function eAe(s,e){const t={...e};for(const i in s){const n=s[i];t[i]=n!==void 0?De(n):void 0}return t}const tAe={keybindingLabelBackground:De(RCe),keybindingLabelForeground:De(ACe),keybindingLabelBorder:De(MCe),keybindingLabelBottomBorder:De(OCe),keybindingLabelShadow:De(QC)},iAe={buttonForeground:De(uJ),buttonSeparator:De(bCe),buttonBackground:De(N0),buttonHoverBackground:De(wCe),buttonSecondaryForeground:De(CCe),buttonSecondaryBackground:De(f5),buttonSecondaryHoverBackground:De(yCe),buttonBorder:De(vCe)},nAe={progressBarBackground:De(Pve)},zte={inputActiveOptionBorder:De(aJ),inputActiveOptionForeground:De(cJ),inputActiveOptionBackground:De(lJ)};De(I0),De(SCe),De(xCe),De(LCe),De(kCe),De(ECe),De(DCe);const N8={checkboxBackground:De(M7),checkboxBorder:De(TCe),checkboxForeground:De(O7),checkboxDisabledBackground:De(NCe),checkboxDisabledForeground:De(ICe)};De(Ia),De(PD),De(QC),De(rJ),De(Yve),De(Qve),De(Xve),De(Mve);const Ute={inputBackground:De(sCe),inputForeground:De(rCe),inputBorder:De(oCe),inputValidationInfoBorder:De(uCe),inputValidationInfoBackground:De(lCe),inputValidationInfoForeground:De(cCe),inputValidationWarningBorder:De(fCe),inputValidationWarningBackground:De(hCe),inputValidationWarningForeground:De(dCe),inputValidationErrorBorder:De(pCe),inputValidationErrorBackground:De(gCe),inputValidationErrorForeground:De(mCe)},sAe={listFilterWidgetBackground:De(GCe),listFilterWidgetOutline:De(KCe),listFilterWidgetNoMatchesOutline:De(YCe),listFilterWidgetShadow:De(QCe),inputBoxStyles:Ute,toggleStyles:zte},rAe={badgeBackground:De(Qx),badgeForeground:De(Ove),badgeBorder:De(Nt)};De(Gve),De(qve),De(jU),De(jU),De(Kve);const ly={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:De(PCe),listFocusForeground:De(FCe),listFocusOutline:De(BCe),listActiveSelectionBackground:De(um),listActiveSelectionForeground:De(Wv),listActiveSelectionIconForeground:De(hJ),listFocusAndSelectionOutline:De(VCe),listFocusAndSelectionBackground:De(um),listFocusAndSelectionForeground:De(Wv),listInactiveSelectionBackground:De(HCe),listInactiveSelectionIconForeground:De(zCe),listInactiveSelectionForeground:De(WCe),listInactiveFocusBackground:De(UCe),listInactiveFocusOutline:De(jCe),listHoverBackground:De(dJ),listHoverForeground:De(fJ),listDropOverBackground:De($Ce),listDropBetweenBackground:De(qCe),listSelectionOutline:De(rn),listHoverOutline:De(rn),treeIndentGuidesStroke:De(gJ),treeInactiveIndentGuidesStroke:De(XCe),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:De(T7),tableColumnsBorder:De(ZCe),tableOddRowsBackgroundColor:De(JCe)};function cy(s){return eAe(s,ly)}const oAe={selectBackground:De(FD),selectListBackground:De(_Ce),selectForeground:De(R7),decoratorRightForeground:De(mJ),selectBorder:De(A7),focusBorder:De(bc),listFocusBackground:De(m5),listInactiveSelectionIconForeground:De(pJ),listFocusForeground:De(g5),listFocusOutline:Dve(rn,me.transparent.toString()),listHoverBackground:De(dJ),listHoverForeground:De(fJ),listHoverOutline:De(rn),selectListBorder:De(eJ),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},aAe={shadowColor:De(QC),borderColor:De(eye),foregroundColor:De(tye),backgroundColor:De(iye),selectionForegroundColor:De(nye),selectionBackgroundColor:De(sye),selectionBorderColor:De(rye),separatorColor:De(oye),scrollbarShadow:De(T7),scrollbarSliderBackground:De(XZ),scrollbarSliderHoverBackground:De(ZZ),scrollbarSliderActiveBackground:De(JZ)};function lAe(s,e){if(oh)return!1;const t=cAe(s,e),i=s.getValue("window");return(i==null?void 0:i.menuStyle)==="native"?!(!_t&&!t):(i==null?void 0:i.menuStyle)==="custom"?!1:t}function cAe(s,e){return e||(e=jte(s)),e==="native"}function jte(s){if(oh)return"custom";const e=s.getValue("window");if(e){if(_t&&e.nativeTabs===!0||_t&&e.nativeFullScreen===!1)return"native";const n=e.titleBarStyle;if(n==="native"||n==="custom")return n}return"custom"}function uAe(s){if(oh||_t||jte(s)==="native")return"native";const e=s.getValue("window"),t=e==null?void 0:e.controlsStyle;return t==="custom"||t==="hidden"?t:"native"}var ZD=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},rr=function(s,e){return function(t,i){e(t,i,s)}};function hAe(s,e){const t=[];return dAe(s,t),t}function dAe(s,e,t){const i=id.getInstance(),n=i.keyStatus.altKey||(Rr||Gr)&&i.keyStatus.shiftKey;$te(s,e,n,r=>r==="navigation")}function fAe(s,e,t,i){const n={primary:[],secondary:[]};return gAe(s,n,e,t,i),n}function gAe(s,e,t,i,n){$te(s,e,!1,typeof t=="string"?o=>o===t:t,i,n)}function $te(s,e,t,i=o=>o==="navigation",n=()=>!1,r=!1){let o,a;Array.isArray(e)?(o=e,a=e):(o=e.primary,a=e.secondary);const l=new Set;for(const[c,h]of s){let d;i(c)?(d=o,d.length>0&&r&&d.push(new is)):(d=a,d.length>0&&d.push(new is));for(let g of h){t&&(g=g instanceof $u&&g.alt?g.alt:g);const p=d.push(g);g instanceof _D&&l.add({group:c,action:g,index:p-1})}}for(const{group:c,action:h,index:d}of l){const g=i(c)?o:a,p=h.actions;n(h,c,g.length)&&g.splice(d,1,...p)}}let uC=class extends T8{constructor(e,t,i,n,r,o,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable,keybinding:t==null?void 0:t.keybinding,hoverDelegate:t==null?void 0:t.hoverDelegate,keybindingNotRenderedWithLabel:t==null?void 0:t.keybindingNotRenderedWithLabel}),this._options=t,this._keybindingService=i,this._notificationService=n,this._contextKeyService=r,this._themeService=o,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new Yn),this._altKey=id.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{var r;const n=!!((r=this._menuItemAction.alt)!=null&&r.enabled)&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);n!==this._wantsAltCommand&&(this._wantsAltCommand=n,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(ie(e,"mouseleave",n=>{t=!1,i()})),this._register(ie(e,"mouseenter",n=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var r;const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?v(1644,"{0} ({1})",i,t):i;if(!this._wantsAltCommand&&((r=this._menuItemAction.alt)!=null&&r.enabled)){const o=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),c=l?v(1645,"{0} ({1})",o,l):o;n=v(1646,`{0}
[{1}] {2}`,n,k8.modifierLabels[Na].altKey,c)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const n=this._commandAction.checked&&JRe(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(n)if(Ct.isThemeIcon(n)){const r=Ct.asClassNameArray(n);i.classList.add(...r),this._itemClassDispose.value=qe(()=>{i.classList.remove(...r)})}else i.style.backgroundImage=Rm(this._themeService.getColorTheme().type)?vc(n.dark):vc(n.light),i.classList.add("icon"),this._itemClassDispose.value=nc(qe(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};uC=ZD([rr(2,rs),rr(3,Ba),rr(4,Ot),rr(5,Zr),rr(6,uh),rr(7,Mo)],uC);let BO=class extends g2{constructor(e,t,i,n,r){const o={...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!1,classNames:(t==null?void 0:t.classNames)??(Ct.isThemeIcon(e.item.icon)?Ct.asClassName(e.item.icon):void 0),keybindingProvider:(t==null?void 0:t.keybindingProvider)??(a=>i.lookupKeybinding(a.id))};super(e,{getActions:()=>e.actions},n,o),this._keybindingService=i,this._contextMenuService=n,this._themeService=r}render(e){super.render(e),_d(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!Ct.isThemeIcon(i)){this.element.classList.add("icon");const n=()=>{this.element&&(this.element.style.backgroundImage=Rm(this._themeService.getColorTheme().type)?vc(i.dark):vc(i.light))};n(),this._register(this._themeService.onDidColorThemeChange(()=>{n()}))}}};BO=ZD([rr(2,rs),rr(3,uh),rr(4,Zr)],BO);let VO=class extends sl{constructor(e,t,i,n,r,o,a,l){super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=r,this._menuService=o,this._instaService=a,this._storageService=l,this._defaultActionDisposables=this._register(new Pe),this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c;const h=t!=null&&t.togglePrimaryAction?l.get(this._storageKey,1):void 0;h&&(c=e.actions.find(g=>h===g.id)),c||(c=e.actions[0]),this._defaultAction=this._defaultActionDisposables.add(this._instaService.createInstance(uC,c,{keybinding:this._getDefaultActionKeybindingLabel(c)}));const d={keybindingProvider:g=>this._keybindingService.lookupKeybinding(g.id),...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!0,classNames:(t==null?void 0:t.classNames)??["codicon","codicon-chevron-down"],actionRunner:(t==null?void 0:t.actionRunner)??this._register(new am)};this._dropdown=this._register(new g2(e,e.actions,this._contextMenuService,d)),t!=null&&t.togglePrimaryAction&&this._register(this._dropdown.actionRunner.onDidRun(g=>{g.action instanceof $u&&this.update(g.action)}))}update(e){var t;(t=this._options)!=null&&t.togglePrimaryAction&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultActionDisposables.clear(),this._defaultAction=this._defaultActionDisposables.add(this._instaService.createInstance(uC,e,{keybinding:this._getDefaultActionKeybindingLabel(e)})),this._defaultAction.actionRunner=this._defaultActionDisposables.add(new class extends am{async runAction(i,n){await i.run(void 0)}}),this._container&&this._defaultAction.render(mD(this._container,Ke(".action-container")))}_getDefaultActionKeybindingLabel(e){var i;let t;if((i=this._options)!=null&&i.renderKeybindingWithDefaultActionLabel){const n=this._keybindingService.lookupKeybinding(e.id);n&&(t=`(${n.getLabel()})`)}return t}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}set actionRunner(e){super.actionRunner=e,this._defaultAction.actionRunner=e,this._dropdown.actionRunner=e}get actionRunner(){return super.actionRunner}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=Ke(".action-container");this._defaultAction.render(Be(this._container,t)),this._register(ie(t,Le.KEY_DOWN,n=>{const r=new si(n);r.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),r.stopPropagation())}));const i=Ke(".dropdown-action-container");this._dropdown.render(Be(this._container,i)),this._register(ie(i,Le.KEY_DOWN,n=>{var o;const r=new si(n);r.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(o=this._defaultAction.element)==null||o.focus(),r.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}};VO=ZD([rr(2,rs),rr(3,Ba),rr(4,uh),rr(5,Em),rr(6,It),rr(7,ry)],VO);let HO=class extends QRe{constructor(e,t,i){super(null,e,e.actions.map(n=>({text:n.id===is.ID?"":n.label,isDisabled:!n.enabled})),0,t,oAe,{ariaLabel:e.tooltip,optionsAsChildren:!0,useCustomDrawn:!lAe(i)}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=De(A7)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};HO=ZD([rr(1,iy),rr(2,yi)],HO);function qte(s,e,t){return e instanceof $u?s.createInstance(uC,e,t):e instanceof P_?e.item.isSelection?s.createInstance(HO,e):e.item.isSplitButton?s.createInstance(VO,e,{...t,togglePrimaryAction:typeof e.item.isSplitButton!="boolean"?e.item.isSplitButton.togglePrimaryAction:!1}):s.createInstance(BO,e,t):void 0}class ac extends le{get onDidBlur(){return this._onDidBlur.event}get onDidCancel(){return this._onDidCancel.event}get onDidRun(){return this._onDidRun.event}get onWillRun(){return this._onWillRun.event}constructor(e,t={}){var r,o;super(),this._actionRunnerDisposables=this._register(new Pe),this.viewItemDisposables=this._register(new A6),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new Z),this._onDidCancel=this._register(new Z({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.cancelHasListener=!1,this._onDidRun=this._register(new Z),this._onWillRun=this._register(new Z),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:((r=this.options.triggerKeys)==null?void 0:r.keyDown)??!1,keys:((o=this.options.triggerKeys)==null?void 0:o.keys)??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Mte()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new am,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(a=>this._onDidRun.fire(a))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(a=>this._onWillRun.fire(a))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(ie(this.domNode,Le.KEY_DOWN,a=>{const l=new si(a);let c=!0;const h=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(l.equals(i[0])||l.equals(i[1]))?c=this.focusPrevious():n&&(l.equals(n[0])||l.equals(n[1]))?c=this.focusNext():l.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():l.equals(14)?c=this.focusFirst():l.equals(13)?c=this.focusLast():l.equals(2)&&h instanceof sl&&h.trapsArrowNavigation?c=this.focusNext(void 0,!0):this.isTriggerKeyEvent(l)?this._triggerKeys.keyDown?this.doTrigger(l):this.triggerKeyDown=!0:c=!1,c&&(l.preventDefault(),l.stopPropagation())})),this._register(ie(this.domNode,Le.KEY_UP,a=>{const l=new si(a);this.isTriggerKeyEvent(l)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(l)),l.preventDefault(),l.stopPropagation()):(l.equals(2)||l.equals(1026)||l.equals(16)||l.equals(18)||l.equals(15)||l.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(C1(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Kn()===this.domNode||!Gn(Kn(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof sl&&i.isEnabled());t instanceof sl&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof sl&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){var e,t;for(let i=0;i<this.actionsList.children.length;i++){const n=this.actionsList.children[i];if(Gn(Kn(),n)){this.focusedItem=i,(t=(e=this.viewItems[this.focusedItem])==null?void 0:e.showHover)==null||t.call(e);break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){var t;if(typeof e=="number")return(t=this.viewItems[e])==null?void 0:t.action;if(nn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===e)return this.viewItems[i].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=Cm(t.index)?t.index:null;if(i.forEach(r=>{const o=document.createElement("li");o.className="action-item",o.setAttribute("role","presentation");let a;const l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new T8(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,ie(o,Le.CONTEXT_MENU,c=>{Rt.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(o),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(o),this.viewItems.push(a)):(this.actionsList.insertBefore(o,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),this.focusable){let r=!1;for(const o of this.viewItems){if(!(o instanceof sl))continue;let a;r||o.action.id===is.ID||!o.isEnabled()&&this.options.focusOnlyEnabledItems?a=!1:a=!0,a?(o.setFocusable(!0),r=!0):o.setFocusable(!1)}}typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){const t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),_n(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=_n(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),_l(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const n=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===is.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===is.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var r,o;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((r=this.viewItems[this.previouslyFocusedItem])==null||r.blur());const n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let a=!0;_1(n.focus)||(a=!1),this.options.focusOnlyEnabledItems&&_1(n.isEnabled)&&!n.isEnabled()&&(a=!1),n.action.id===is.ID&&(a=!1),a?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),a&&((o=n.showHover)==null||o.call(n))}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof sl){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=_n(this.viewItems),this.getContainer().remove(),super.dispose()}}const WO=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,dA=/(&amp;)?(&amp;)([^\s&])/g;var m2;(function(s){s[s.Right=0]="Right",s[s.Left=1]="Left"})(m2||(m2={}));var zO;(function(s){s[s.Above=0]="Above",s[s.Below=1]="Below"})(zO||(zO={}));class X_ extends ac{constructor(e,t,i,n){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const r=document.createElement("div");r.classList.add("monaco-menu"),r.setAttribute("role","presentation"),super(r,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,o),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,..._t||Gr?[10]:[]],keyDown:!0}}),this.menuStyles=n,this.menuElement=r,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,n),this._register(fr.addTarget(r)),this._register(ie(r,Le.KEY_DOWN,c=>{new si(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(ie(r,Le.KEY_DOWN,c=>{const h=c.key.toLocaleLowerCase();if(this.mnemonics.has(h)){Rt.stop(c,!0);const d=this.mnemonics.get(h);if(d.length===1&&(d[0]instanceof Cq&&d[0].container&&this.focusItemByElement(d[0].container),d[0].onClick(c)),d.length>1){const g=d.shift();g&&g.container&&(this.focusItemByElement(g.container),d.push(g)),this.mnemonics.set(h,d)}}})),Gr&&this._register(ie(r,Le.KEY_DOWN,c=>{const h=new si(c);h.equals(14)||h.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),Rt.stop(c,!0)):(h.equals(13)||h.equals(12))&&(this.focusedItem=0,this.focusPrevious(),Rt.stop(c,!0))})),this._register(ie(this.domNode,Le.MOUSE_OUT,c=>{const h=c.relatedTarget;Gn(h,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(ie(this.actionsList,Le.MOUSE_OVER,c=>{let h=c.target;if(!(!h||!Gn(h,this.actionsList)||h===this.actionsList)){for(;h.parentElement!==this.actionsList&&h.parentElement!==null;)h=h.parentElement;if(h.classList.contains("action-item")){const d=this.focusedItem;this.setFocusedItem(h),d!==this.focusedItem&&this.updateFocus()}}})),this._register(fr.addTarget(this.actionsList)),this._register(ie(this.actionsList,hi.Tap,c=>{let h=c.initialTarget;if(!(!h||!Gn(h,this.actionsList)||h===this.actionsList)){for(;h.parentElement!==this.actionsList&&h.parentElement!==null;)h=h.parentElement;if(h.classList.contains("action-item")){const d=this.focusedItem;this.setFocusedItem(h),d!==this.focusedItem&&this.updateFocus()}}}));const o={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new F7(r,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,n),this._register(ie(r,hi.Change,c=>{Rt.stop(c,!0);const h=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:h-c.translationY})})),this._register(ie(a,Le.MOUSE_UP,c=>{c.preventDefault()}));const l=Ue(e);r.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,h)=>{var d;return(d=i.submenuIds)!=null&&d.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof is&&(h===t.length-1||h===0||t[h-1]instanceof is))}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof yq)).forEach((c,h,d)=>{c.updatePositionInSet(h+1,d.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(I4(e)?this.styleSheet=bl(e):(X_.globalStyleSheet||(X_.globalStyleSheet=bl()),this.styleSheet=X_.globalStyleSheet)),this.styleSheet.textContent=pAe(t,I4(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",n=t.backgroundColor??"",r=t.borderColor?`1px solid ${t.borderColor}`:"",o="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=r,e.style.borderRadius=o,e.style.color=i,e.style.backgroundColor=n,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){var n,r;if(e instanceof is)return new yq(t.context,e,{icon:!0},this.menuStyles);if(e instanceof _D){const o=new Cq(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const a=o.getMnemonic();if(a&&o.isEnabled()){let l=[];this.mnemonics.has(a)&&(l=this.mnemonics.get(a)),l.push(o),this.mnemonics.set(a,l)}}return o}else{const o=(r=(n=t.getKeyBinding)==null?void 0:n.call(t,e))==null?void 0:r.getLabel(),a={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext,keybinding:o},l=new Gte(t.context,e,a,this.menuStyles);if(t.enableMnemonics){const c=l.getMnemonic();if(c&&l.isEnabled()){let h=[];this.mnemonics.has(c)&&(h=this.mnemonics.get(c)),h.push(l),this.mnemonics.set(c,h)}}return l}}}class Gte extends sl{constructor(e,t,i,n){if(i={...i,isMenu:!0,icon:i.icon!==void 0?i.icon:!1,label:i.label!==void 0?i.label:!0},super(t,t,i),this.menuStyle=n,this.options=i,this.cssClass="",this.options.label&&i.enableMnemonics){const r=this.action.label;if(r){const o=WO.exec(r);o&&(this.mnemonic=(o[1]?o[1]:o[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Es(()=>{this.element&&(this._register(ie(this.element,Le.MOUSE_UP,r=>{if(Rt.stop(r,!0),Kr){if(new So(Ue(this.element),r).rightButton)return;this.onClick(r)}else setTimeout(()=>{this.onClick(r)},0)})),this._register(ie(this.element,Le.CONTEXT_MENU,r=>{Rt.stop(r,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=Be(this.element,Ke("a.action-menu-item")),this._action.id===is.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=Be(this.item,Ke("span.menu-item-check"+Ct.asCSSSelector(Ae.menuSelection))),this.check.setAttribute("role","none"),this.label=Be(this.item,Ke("span.action-label")),this.options.label&&this.options.keybinding&&(Be(this.item,Ke("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)==null||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){_l(this.label);let t=ite(this.action.label);if(t){const i=mAe(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const n=WO.exec(t);if(n){t=Ra(t),dA.lastIndex=0;let r=dA.exec(t);for(;r&&r[1];)r=dA.exec(t);const o=a=>a.replace(/&amp;&amp;/g,"&amp;");r?this.label.append(lD(o(t.substr(0,r.index))," "),Ke("u",{"aria-hidden":"true"},r[3]),a_e(o(t.substr(r.index+r[0].length))," ")):this.label.textContent=o(t).trim(),(e=this.item)==null||e.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.textContent=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",r=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=n,this.item.style.outlineOffset=r),this.check&&(this.check.style.color=t??"")}}class Cq extends Gte{constructor(e,t,i,n,r){super(e,e,n,r),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new Pe),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:{horizontal:m2.Right,vertical:zO.Below},this.showScheduler=new Es(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Es(()=>{this.element&&!Gn(Kn(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=Be(this.item,Ke("span.submenu-indicator"+Ct.asCSSSelector(Ae.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(ie(this.element,Le.KEY_UP,t=>{const i=new si(t);(i.equals(17)||i.equals(3))&&(Rt.stop(t,!0),this.createSubmenu(!0))})),this._register(ie(this.element,Le.KEY_DOWN,t=>{const i=new si(t);Kn()===this.item&&(i.equals(17)||i.equals(3))&&Rt.stop(t,!0)})),this._register(ie(this.element,Le.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(ie(this.element,Le.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(ie(this.element,Le.FOCUS_OUT,t=>{this.element&&!Gn(Kn(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){Rt.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const r={top:0,left:0};return r.left=c_(e.width,t.width,{position:n.horizontal===m2.Right?0:1,offset:i.left,size:i.width}),r.left>=i.left&&r.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(r.left=i.left+10),i.top+=10,i.height=0),r.top=c_(e.height,t.height,{position:0,offset:i.top,size:0}),r.top+t.height===i.top&&r.top+i.height+t.height<=e.height&&(r.top+=i.height),r}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=Be(this.element,Ke("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=Ue(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.submenuContainer.style.zIndex="1",this.parentData.submenu=new X_(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new M4],this.submenuOptions,this.menuStyle);const n=this.element.getBoundingClientRect(),r={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},o=this.submenuContainer.getBoundingClientRect(),a=Ue(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new ku(a.innerWidth,a.innerHeight),ku.lift(o),r,this.expandDirection);this.submenuContainer.style.left=`${c-o.left}px`,this.submenuContainer.style.top=`${l-o.top}px`,this.submenuDisposables.add(ie(this.submenuContainer,Le.KEY_UP,h=>{new si(h).equals(15)&&(Rt.stop(h,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(ie(this.submenuContainer,Le.KEY_DOWN,h=>{new si(h).equals(15)&&Rt.stop(h,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)==null||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class yq extends T8{constructor(e,t,i,n){super(e,t,i),this.menuStyles=n}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function mAe(s){const e=WO,t=e.exec(s);if(!t)return s;const i=!t[1];return s.replace(e,i?"$2$3":"").trim()}function Sq(s){const e=NX()[s.id];return`.codicon-${s.id}:before { content: '\\${e.toString(16)}'; }`}function pAe(s,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${Sq(Ae.menuSelection)}
${Sq(Ae.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
	opacity: 0.7;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
			/* Fix for https://github.com/microsoft/vscode/issues/103170 */
			.monaco-menu .action-item .monaco-submenu {
				z-index: 1;
			}
		`;const i=s.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=s.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const r=s.scrollbarSliderHoverBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${r};
				}
			`);const o=s.scrollbarSliderActiveBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${o};
				}
			`)}return t}class _Ae{constructor(e,t,i,n){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=Kn();let i;const n=nn(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,layer:e.layer,render:r=>{var h;this.lastContainer=r;const o=e.getMenuClassName?e.getMenuClassName():"";o&&(r.className+=" "+o),this.options.blockMouse&&(this.block=r.appendChild(Ke(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(h=this.blockDisposable)==null||h.dispose(),this.blockDisposable=ie(this.block,Le.MOUSE_DOWN,d=>d.stopPropagation()));const a=new Pe,l=e.actionRunner||a.add(new am);l.onWillRun(d=>this.onActionRun(d,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new X_(r,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:d=>this.keybindingService.lookupKeybinding(d.id)},aAe),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=Ue(r);return a.add(ie(c,Le.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(ie(c,Le.MOUSE_DOWN,d=>{if(d.defaultPrevented)return;const g=new So(c,d);let p=g.target;if(!g.rightButton){for(;p;){if(p===r)return;p=p.parentElement}this.contextViewService.hideContextView(!0)}})),nc(a,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:r=>{var o,a,l;(o=e.onHide)==null||o.call(e,!!r),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)==null||a.dispose(),this.blockDisposable=null,this.lastContainer&&(Kn()===this.lastContainer||Gn(Kn(),this.lastContainer))&&((l=this.focusToReturn)==null||l.focus()),this.lastContainer=null}},n,!!n)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!OC(e.error)&&this.notificationService.error(e.error)}}var bAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Hp=function(s,e){return function(t,i){e(t,i,s)}};let UO=class extends le{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new _Ae(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,n,r,o){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=n,this.menuService=r,this.contextKeyService=o,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new Z),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new Z),this.onDidHideContextMenu=this._onDidHideContextMenu.event}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=jO.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{var i;(i=e.onHide)==null||i.call(e,t),this._onDidHideContextMenu.fire()}}),id.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};UO=bAe([Hp(0,ah),Hp(1,Ba),Hp(2,iy),Hp(3,rs),Hp(4,Em),Hp(5,Ot)],UO);var jO;(function(s){function e(i){return i&&i.menuId instanceof xn}function t(i,n,r){if(!e(i))return i;const{menuId:o,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{let c=[];if(o){const h=n.getMenuActions(o,l??r,a);c=hAe(h)}return i.getActions?is.join(i.getActions(),c):c}}}s.transform=t})(jO||(jO={}));var p2;(function(s){s[s.API=0]="API",s[s.USER=1]="USER"})(p2||(p2={}));var I8=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_2=function(s,e){return function(t,i){e(t,i,s)}};let $O=class{constructor(e){this._commandService=e}async open(e,t){if(!X6(e,tt.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=mt.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=wO(decodeURIComponent(e.query))}catch{try{i=wO(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};$O=I8([_2(0,Ao)],$O);let qO=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=mt.parse(e));const{selection:i,uri:n}=cIe(e);return e=n,e.scheme===tt.file&&(e=wbe(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t!=null&&t.fromUserGesture?p2.USER:p2.API,...t==null?void 0:t.editorOptions}},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0}};qO=I8([_2(0,In)],qO);let GO=class{constructor(e,t){this._openers=new Dr,this._validators=new Dr,this._resolvers=new Dr,this._resolvedUriTargets=new Ts(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new Dr,this._defaultExternalOpener={openExternal:async i=>(mz(i,tt.http,tt.https)?rZ(i):ni.location.href=i,!0)},this._openers.push({open:async(i,n)=>n!=null&&n.openExternal||mz(i,tt.mailto,tt.http,tt.https,tt.vsls)?(await this._doOpenExternal(i,n),!0):!1}),this._openers.push(new $O(t)),this._openers.push(new qO(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){if(!(t!=null&&t.skipValidation)){const i=typeof e=="string"?mt.parse(e):e,n=this._resolvedUriTargets.get(i)??e;for(const r of this._validators)if(!await r.shouldOpen(n,t))return!1}for(const i of this._openers)if(await i.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const n=await i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?mt.parse(e):e;let n;try{n=(await this.resolveExternalUri(i,t)).resolved}catch{n=i}let r;if(typeof e=="string"&&i.toString()===n.toString()?r=e:r=encodeURI(n.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(r,{sourceUri:i,preferredOpenerId:o},Io.None))return!0}return this._defaultExternalOpener.openExternal(r,{sourceUri:i},Io.None)}dispose(){this._validators.clear()}};GO=I8([_2(0,In),_2(1,Ao)],GO);const uy=gt("editorWorkerService");var bo;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(bo||(bo={}));(function(s){function e(l,c){return c-l}s.compare=e;const t=Object.create(null);t[s.Error]=v(1732,"Error"),t[s.Warning]=v(1733,"Warning"),t[s.Info]=v(1734,"Info");function i(l){return t[l]||""}s.toString=i;const n=Object.create(null);n[s.Error]=v(1735,"Errors"),n[s.Warning]=v(1736,"Warnings"),n[s.Info]=v(1737,"Infos");function r(l){return n[l]||""}s.toStringPlural=r;function o(l){switch(l){case Ji.Error:return s.Error;case Ji.Warning:return s.Warning;case Ji.Info:return s.Info;case Ji.Ignore:return s.Hint}}s.fromSeverity=o;function a(l){switch(l){case s.Error:return Ji.Error;case s.Warning:return Ji.Warning;case s.Info:return Ji.Info;case s.Hint:return Ji.Ignore}}s.toSeverity=a})(bo||(bo={}));var xq;(function(s){function t(n){return i(n,!0)}s.makeKey=t;function i(n,r){const o=[""];return n.source?o.push(n.source.replace("","\\")):o.push(""),n.code?typeof n.code=="string"?o.push(n.code.replace("","\\")):o.push(n.code.value.replace("","\\")):o.push(""),n.severity!==void 0&&n.severity!==null?o.push(bo.toString(n.severity)):o.push(""),n.message&&r?o.push(n.message.replace("","\\")):o.push(""),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(""),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(""),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(""),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(""),o.push(""),o.join("")}s.makeKeyOptionalMessage=i})(xq||(xq={}));const Pm=gt("markerService");var wAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Lq=function(s,e){return function(t,i){e(t,i,s)}};let KO=class extends le{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new Z),this._suppressedRanges=new Ts,this._markerDecorations=new Ts,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new vAe(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var i;const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===tt.inMemory||e.uri.scheme===tt.internal||e.uri.scheme===tt.vscode)&&((i=this._markerService)==null||i.read({resource:e.uri}).map(n=>n.owner).forEach(n=>this._markerService.remove(n,[e.uri])))}_updateDecorations(e){let t=this._markerService.read({resource:e.model.uri,take:500});const i=this._suppressedRanges.get(e.model.uri);i&&(t=t.filter(n=>!Dt.some(i,r=>G.areIntersectingOrTouching(r,n)))),e.update(t)&&this._onDidChangeMarker.fire(e.model)}};KO=wAe([Lq(0,mr),Lq(1,Pm)],KO);class vAe extends le{constructor(e){super(),this.model=e,this._map=new dbe,this._register(qe(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=Q2e(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const n=i.map(a=>this._map.get(a)),r=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),o=this.model.deltaDecorations(n,r);for(const a of i)this._map.delete(a);for(let a=0;a<o.length;a++)this._map.set(t[a],o[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=G.lift(t);if(t.severity===bo.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const r=e.getWordAtPosition(i.getStartPosition());r&&(i=new G(i.startLineNumber,r.startColumn,i.endLineNumber,r.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new G(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,r,o;switch(e.severity){case bo.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case bo.Info:t="squiggly-info",i=Mp(axe),n=10,o={color:Mp(Jve),position:1};break;case bo.Warning:t="squiggly-warning",i=Mp(oxe),n=20,o={color:Mp(eCe),position:1};break;case bo.Error:default:t="squiggly-error",i=Mp(rxe),n=30,o={color:Mp(tCe),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(r="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(r="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:mk.Right},minimap:o,zIndex:n,inlineClassName:r}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}var CAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Nx=function(s,e){return function(t,i){e(t,i,s)}},jp;function vf(s){return s.toString()}class yAe{constructor(e,t,i){this.model=e,this._modelEventListeners=new Pe,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(n=>i(e,n)))}dispose(){this._modelEventListeners.dispose()}}const SAe=Gr||_t?1:2;class xAe{constructor(e,t,i,n,r,o,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=r,this.sha1=o,this.versionId=a,this.alternativeVersionId=l}}var Fg;let YO=(Fg=class extends le{constructor(e,t,i,n){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=n,this._onModelAdded=this._register(new Z),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new Z),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new Z),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(r=>this._updateModelOptions(r))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var g;let i=_s.tabSize;e.editor&&typeof e.editor.tabSize<"u"&&(i=Cu(e.editor.tabSize,_s.tabSize,1,100));let n="tabSize";e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"&&(n=Cu(e.editor.indentSize,"tabSize",1,100));let r=_s.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(r=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let o=SAe;const a=e.eol;a===`\r
`?o=2:a===`
`&&(o=1);let l=_s.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=_s.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let h=_s.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(h=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let d=_s.bracketPairColorizationOptions;if((g=e.editor)!=null&&g.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"){const p=e.editor.bracketPairColorization;d={enabled:!!p.enabled,independentColorPoolPerBracketType:!!p.independentColorPoolPerBracketType}}return{isForSimpleWidget:t,tabSize:i,indentSize:n,insertSpaces:r,detectIndentation:c,defaultEOL:o,trimAutoWhitespace:l,largeFileOptimizations:h,bracketPairColorizationOptions:d}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:Na===3||Na===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const n=typeof e=="string"?e:e.languageId;let r=this._modelCreationOptionsByLanguageAndResource[n+t];if(!r){const o=this._configurationService.getValue("editor",{overrideIdentifier:n,resource:t}),a=this._getEOL(t,n);r=jp._readModelOptions({editor:o,eol:a},i),this._modelCreationOptionsByLanguageAndResource[n+t]=r}return r}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,r=i.length;n<r;n++){const o=i[n],a=this._models[o],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const h=t[l+c],d=this.getCreationOptions(l,c,a.model.isForSimpleWidget);jp._setModelOptionsForModel(a.model,d,h)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&$r(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(vf(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(vf(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(vf(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,n)=>i.time-n.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const r=this.getCreationOptions(t,i,n),o=this._instantiationService.createInstance(tO,e,t,r,i);if(i&&this._disposedModels.has(vf(i))){const c=this._removeDisposedModel(i),h=this._undoRedoService.getElements(i),d=this._getSHA1Computer(),g=d.canComputeSHA1(o)?d.computeSHA1(o)===c.sha1:!1;if(g||c.sharesUndoRedoStack){for(const p of h.past)xu(p)&&p.matchesResource(i)&&p.setModel(o);for(const p of h.future)xu(p)&&p.matchesResource(i)&&p.setModel(o);this._undoRedoService.setElementsValidFlag(i,!0,p=>xu(p)&&p.matchesResource(i)),g&&(o._overwriteVersionId(c.versionId),o._overwriteAlternativeVersionId(c.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=vf(o.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new yAe(o,c=>this._onWillDispose(c),(c,h)=>this._onDidChangeLanguage(c,h));return this._models[a]=l,l}createModel(e,t,i,n=!1){let r;return t?r=this._createModelData(e,t,i,n):r=this._createModelData(e,Aa,i,n),this._onModelAdded.fire(r.model),r.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const r=t[i];e.push(this._models[r].model)}return e}getModel(e){const t=vf(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===tt.file||e.scheme===tt.vscodeRemote||e.scheme===tt.vscodeUserData||e.scheme===tt.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=vf(e.uri),i=this._models[t],n=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let r=!1,o=0;if(n||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const h of c.past)xu(h)&&h.matchesResource(e.uri)&&(r=!0,o+=h.heapSize(e.uri),h.setModel(e.uri));for(const h of c.future)xu(h)&&h.matchesResource(e.uri)&&(r=!0,o+=h.heapSize(e.uri),h.setModel(e.uri))}}const a=jp.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(r)if(!n&&(o>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-o),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>xu(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new xAe(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),n,o,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!n){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,n=e.getLanguageId(),r=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),o=this.getCreationOptions(n,e.uri,e.isForSimpleWidget);jp._setModelOptionsForModel(e,o,r),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new QO}},jp=Fg,Fg.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024,Fg);YO=jp=CAe([Nx(0,yi),Nx(1,VZ),Nx(2,o8),Nx(3,It)],YO);const wE=class wE{canComputeSHA1(e){return e.getValueLength()<=wE.MAX_MODEL_SIZE}computeSHA1(e){const t=new x4,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}};wE.MAX_MODEL_SIZE=10*1024*1024;let QO=wE;var XO;(function(s){s[s.PRESERVE=0]="PRESERVE",s[s.LAST=1]="LAST"})(XO||(XO={}));const Kte={Quickaccess:"workbench.contributions.quickaccess"};class LAe{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),qe(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return x6([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}ss.add(Kte.Quickaccess,new LAe);var kAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},kq=function(s,e){return function(t,i){e(t,i,s)}};let ZO=class extends le{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=ss.as(Kte.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0,this._register(qe(()=>{var i;for(const n of this.mapProviderToDescriptor.values())rD(n)&&n.dispose();(i=this.visibleQuickAccess)==null||i.picker.dispose()}))}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var _,b;const[n,r]=this.getOrInstantiateProvider(e,i==null?void 0:i.enabledProviderPrefixes),o=this.visibleQuickAccess,a=o==null?void 0:o.descriptor;if(o&&r&&a===r){e!==r.prefix&&!(i!=null&&i.preserveValue)&&(o.picker.value=e),this.adjustValueSelection(o.picker,r,i);return}if(r&&!(i!=null&&i.preserveValue)){let C;if(o&&a&&a!==r){const x=o.value.substr(a.prefix.length);x&&(C=`${r.prefix}${x}`)}if(!C){const x=n==null?void 0:n.defaultFilterValue;x===XO.LAST?C=this.lastAcceptedPickerValues.get(r):typeof x=="string"&&(C=`${r.prefix}${x}`)}typeof C=="string"&&(e=C)}const l=(_=o==null?void 0:o.picker)==null?void 0:_.valueSelection,c=(b=o==null?void 0:o.picker)==null?void 0:b.value,h=new Pe,d=h.add(this.quickInputService.createQuickPick({useSeparators:!0}));d.value=e,this.adjustValueSelection(d,r,i),d.placeholder=(i==null?void 0:i.placeholder)??(r==null?void 0:r.placeholder),d.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,d.hideInput=!!d.quickNavigate&&!o,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(d.itemActivation=(i==null?void 0:i.itemActivation)??$l.SECOND),d.contextKey=r==null?void 0:r.contextKey,d.filterValue=C=>C.substring(r?r.prefix.length:0);let g;t&&(g=new uD,h.add(Se.once(d.onWillAccept)(C=>{C.veto(),d.hide()}))),h.add(this.registerPickerListeners(d,n,r,e,i));const p=h.add(new ym);if(n&&h.add(n.provide(d,p.token,i==null?void 0:i.providerOptions)),Se.once(d.onDidHide)(()=>{d.selectedItems.length===0&&p.cancel(),h.dispose(),g==null||g.complete(d.selectedItems.slice(0))}),d.show(),l&&c===e&&(d.valueSelection=l),t)return g==null?void 0:g.p}adjustValueSelection(e,t,i){let n;i!=null&&i.preserveValue?n=[e.value.length,e.value.length]:n=[(t==null?void 0:t.prefix.length)??0,e.value.length],e.valueSelection=n}registerPickerListeners(e,t,i,n,r){const o=new Pe,a=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return o.add(qe(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),o.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,r==null?void 0:r.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:r==null?void 0:r.enabledProviderPrefixes,preserveValue:!0,providerOptions:r==null?void 0:r.providerOptions}):a.value=l})),i&&o.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),o}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!(t!=null&&t.includes(i.prefix)))return[void 0,void 0];let n=this.mapProviderToDescriptor.get(i);return n||(n=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,n)),[n,i]}};ZO=kAe([kq(0,Om),kq(1,It)],ZO);const Yte={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};class nb extends Ec{get onChange(){return this._onChange.event}get onKeyDown(){return this._onKeyDown.event}constructor(e){super(),this._onChange=this._register(new Z),this._onKeyDown=this._register(new Z),this._opts=e,this._title=this._opts.title,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Ct.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._register(Sl().setupDelayedHover(this.domNode,()=>({content:this._title,style:1}),this._opts.hoverLifecycleOptions)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.setTitle(this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(this.enabled){if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)}})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...Ct.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...Ct.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1)),this.domNode.classList.remove("disabled")}disable(){this.domNode.setAttribute("aria-disabled",String(!0)),this.domNode.classList.add("disabled")}setTitle(e){this._title=e,this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}}const d9=class d9 extends Ec{constructor(e,t,i){super(),this.checkbox=e,this.domNode=t,this.styles=i,this._onChange=this._register(new Z),this.onChange=this._onChange.event,this.applyStyles()}get enabled(){return this.checkbox.enabled}enable(){this.checkbox.enable(),this.applyStyles(!0)}disable(){this.checkbox.disable(),this.applyStyles(!1)}setTitle(e){this.checkbox.setTitle(e)}applyStyles(e=this.enabled){this.domNode.style.color=(e?this.styles.checkboxForeground:this.styles.checkboxDisabledForeground)||"",this.domNode.style.backgroundColor=(e?this.styles.checkboxBackground:this.styles.checkboxDisabledBackground)||"",this.domNode.style.borderColor=(e?this.styles.checkboxBorder:this.styles.checkboxDisabledBackground)||"";const t=this.styles.size||18;this.domNode.style.width=this.domNode.style.height=this.domNode.style.fontSize=`${t}px`,this.domNode.style.fontSize=`${t-2}px`}};d9.CLASS_NAME="monaco-checkbox";let hC=d9;class Qte extends hC{constructor(e,t,i){const n=new nb({title:e,isChecked:t,icon:Ae.check,actionClassName:hC.CLASS_NAME,hoverLifecycleOptions:i.hoverLifecycleOptions,...Yte});super(n,n.domNode,i),this._register(n),this._register(this.checkbox.onChange(r=>{this.applyStyles(),this._onChange.fire(r)}))}get checked(){return this.checkbox.checked}set checked(e){this.checkbox.checked=e,this.applyStyles()}applyStyles(e){this.checkbox.checked?this.checkbox.setIcon(Ae.check):this.checkbox.setIcon(void 0),super.applyStyles(e)}}class Xte extends hC{constructor(e,t,i){let n;switch(t){case!0:n=Ae.check;break;case"mixed":n=Ae.dash;break;case!1:n=void 0;break}const r=new nb({title:e,isChecked:t===!0,icon:n,actionClassName:Qte.CLASS_NAME,hoverLifecycleOptions:i.hoverLifecycleOptions,...Yte});super(r,r.domNode,i),this._state=t,this._register(r),this._register(this.checkbox.onChange(o=>{this._state=this.checkbox.checked,this.applyStyles(),this._onChange.fire(o)}))}get checked(){return this._state}set checked(e){this._state!==e&&(this._state=e,this.checkbox.checked=e===!0,this.applyStyles())}applyStyles(e){switch(this._state){case!0:this.checkbox.setIcon(Ae.check);break;case"mixed":this.checkbox.setIcon(Ae.dash);break;case!1:this.checkbox.setIcon(void 0);break}super.applyStyles(e)}}var EAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class Zte{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}EAe([Vi],Zte.prototype,"toString",null);const DAe=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function TAe(s){const e=[];let t=0,i;for(;i=DAe.exec(s);){i.index-t>0&&e.push(s.substring(t,i.index));const[,n,r,,o]=i;o?e.push({label:n,href:r,title:o}):e.push({label:n,href:r}),t=i.index+i[0].length}return t<s.length&&e.push(s.substring(t)),new Zte(e)}const fA={},NAe=new rte("quick-input-button-icon-");function IAe(s){if(!s)return;let e;const t=s.dark.toString();return fA[t]?e=fA[t]:(e=NAe.nextId(),o5(`.${e}, .hc-light .${e}`,`background-image: ${vc(s.light||s.dark)}`),o5(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${vc(s.dark)}`),fA[t]=e),e}function Z_(s,e,t){let i=s.iconClass||IAe(s.iconPath);return s.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:s.tooltip||"",class:i,enabled:!0,run:t}}function RAe(s,e,t){Ds(e);const i=TAe(s);let n=0;for(const r of i.nodes)if(typeof r=="string")e.append(...Ig(r));else{let o=r.title;!o&&r.href.startsWith("command:")?o=v(1771,"Click to execute command '{0}'",r.href.substring(8)):o||(o=r.href);const a=Ke("a",{href:r.href,title:o,tabIndex:n++},r.label);a.style.textDecoration="underline";const l=p=>{x1e(p)&&Rt.stop(p,!0),t.callback(r.href)},c=t.disposables.add(new jt(a,Le.CLICK)).event,h=t.disposables.add(new jt(a,Le.KEY_DOWN)).event,d=Se.chain(h,p=>p.filter(_=>{const b=new si(_);return b.equals(10)||b.equals(3)}));t.disposables.add(fr.addTarget(a));const g=t.disposables.add(new jt(a,hi.Tap)).event;Se.any(c,g,d)(l,null,t.disposables),e.appendChild(a)}}var AAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Eq=function(s,e){return function(t,i){e(t,i,s)}};const Jte="inQuickInput",MAe=new He(Jte,!1,v(1748,"Whether keyboard focus is inside the quick input control")),JD=xt.has(Jte),OAe="quickInputAlignment",PAe=new He(OAe,"top",v(1749,"The alignment of the quick input")),dC="quickInputType",FAe=new He(dC,void 0,v(1750,"The type of the currently visible quick input")),eie="cursorAtEndOfQuickInputBox",BAe=new He(eie,!1,v(1751,"Whether the cursor in the quick input is at the end of the input box")),VAe=xt.has(eie),JO={iconClass:Ct.asClassName(Ae.quickInputBack),tooltip:v(1752,"Back")},vE=class vE extends le{constructor(e){super(),this.ui=e,this._visible=lt("visible",!1),this._widgetUpdated=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=vE.noPromptMessage,this._severity=Ji.Ignore,this.onDidTriggerButtonEmitter=this._register(new Z),this.onDidHideEmitter=this._register(new Z),this.onWillHideEmitter=this._register(new Z),this.onDisposeEmitter=this._register(new Z),this.visibleDisposables=this._register(new Pe),this.onDidHide=this.onDidHideEmitter.event}get visible(){return this._visible.get()}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!gc;this._ignoreFocusOut=e&&!gc,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===JO),this._rightButtons=e.filter(t=>t!==JO&&t.location!==u2.Inline),this._inlineButtons=e.filter(t=>t.location===u2.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this._visible.set(!0,void 0),this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=oC.Other){this._visible.set(!1,void 0),this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=oC.Other){this.onWillHideEmitter.fire({reason:e})}update(){var n;if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText="");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?Ds(this.ui.widget,this._widget):Ds(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new _c,this.busyDelay.setIfNotSet(()=>{this.visible&&(this.ui.progressBar.infinite(),this.ui.progressBar.getContainer().removeAttribute("aria-hidden"))},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.ui.progressBar.getContainer().setAttribute("aria-hidden","true"),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const r=this._leftButtons.map((l,c)=>Z_(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.leftActionBar.push(r,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const o=this._rightButtons.map((l,c)=>Z_(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.rightActionBar.push(o,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const a=this._inlineButtons.map((l,c)=>Z_(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.inlineActionBar.push(a,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const r=((n=this.toggles)==null?void 0:n.filter(a=>a instanceof nb))??[];this.ui.inputBox.toggles=r;const o=r.length*22;this.ui.countContainer.style.right=o>0?`${4+o}px`:"4px",this.ui.visibleCountContainer.style.right=o>0?`${4+o}px`:"4px"}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,Ds(this.ui.message),i&&RAe(i,this.ui.message,{callback:r=>{this.ui.linkOpenerDelegate(r)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?v(1754,"{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Ji.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}};vE.noPromptMessage=v(1753,"Press 'Enter' to confirm your input or 'Escape' to cancel");let fC=vE;const CE=class CE extends fC{constructor(e){super(e),this._value="",this.onDidChangeValueEmitter=this._register(new Z),this.onWillAcceptEmitter=this._register(new Z),this.onDidAcceptEmitter=this._register(new Z),this.onDidCustomEmitter=this._register(new Z),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=$l.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new Z),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new Z),this.onDidTriggerItemButtonEmitter=this._register(new Z),this.onDidTriggerSeparatorButtonEmitter=this._register(new Z),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new FC,this.type="quickPick",this.filterValue=t=>t,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event,this.noValidationMessage=void 0}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get prompt(){return this.noValidationMessage}set prompt(e){this.noValidationMessage=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?kIe:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get okLabel(){return this._okLabel??v(1756,"OK")}set okLabel(e){this._okLabel=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(ui.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&Sn(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany&&!e.some(i=>i.pickable===!1)){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&Sn(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(u7(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&Sn(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return ie(this.ui.container,Le.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new si(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const a=o.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage||!!this.prompt,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;!n&&i.inputBox&&(n=this.placeholder,this.title&&(n=n?`${n} - ${this.title}`:this.title),n||(n=CE.DEFAULT_ARIA_LABEL)),this.ui.list.ariaLabel!==n&&(this.ui.list.ariaLabel=n??null),this.ui.inputBox.ariaLabel!==n&&(this.ui.inputBox.ariaLabel=n??"input"),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case $l.NONE:this._itemActivation=$l.FIRST;break;case $l.SECOND:this.ui.list.focus(ui.Second),this._itemActivation=$l.FIRST;break;case $l.LAST:this.ui.list.focus(ui.Last),this._itemActivation=$l.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.ok.label=this.okLabel||"",this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(ui.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||(this.activeItems[0]&&!this._canSelectMany&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(e??!1))}};CE.DEFAULT_ARIA_LABEL=v(1755,"Type to narrow down results.");let Dw=CE,HAe=class extends fC{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new Z),this.onDidAcceptEmitter=this._register(new Z),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}get prompt(){return this._prompt}set prompt(e){this._prompt=e,this.noValidationMessage=e?v(1757,"{0} (Press 'Enter' to confirm or 'Escape' to cancel)",e):fC.noPromptMessage,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}accept(){this.onDidAcceptEmitter.fire()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password);let t=this.ariaLabel;!t&&e.inputBox&&(t=this.placeholder?this.title?`${this.placeholder} - ${this.title}`:this.placeholder:this.title?this.title:"input"),this.ui.inputBox.ariaLabel!==t&&(this.ui.inputBox.ariaLabel=t||"input")}},e3=class extends tC{constructor(e,t){super("mouse",void 0,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(nn(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};e3=AAe([Eq(0,yi),Eq(1,ty)],e3);me.white.toString(),me.white.toString();const WAe=Object.freeze({allowedTags:{override:["b","i","u","code","span"]},allowedAttributes:{override:["class"]}});class t3 extends le{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new Z),this._onDidEscape=this._register(new Z),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this.enabled=!t.disabled,this._register(fr.addTarget(this._element)),[Le.CLICK,hi.Tap].forEach(r=>{this._register(ie(this._element,r,o=>{if(!this.enabled){Rt.stop(o);return}this._onDidClick.fire(o)}))}),this._register(ie(this._element,Le.KEY_DOWN,r=>{const o=new si(r);let a=!1;this.enabled&&(o.equals(3)||o.equals(10))?(this._onDidClick.fire(r),a=!0):o.equals(9)&&(this._onDidEscape.fire(r),this._element.blur(),a=!0),a&&Rt.stop(o,!0)})),this._register(ie(this._element,Le.MOUSE_OVER,r=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(ie(this._element,Le.MOUSE_OUT,r=>{this.updateBackground(!1)})),this.focusTracker=this._register(C1(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of Ig(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var n;if(this._label===e||vw(this._label)&&vw(e)&&xTe(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(vw(e)){const r=x8(e,void 0,document.createElement("span"));r.dispose();const o=(n=r.element.querySelector("p"))==null?void 0:n.innerHTML;o?kte(t,o,WAe):Ds(t)}else this.options.supportIcons?Ds(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=jNe(e)),this.setTitle(i),this._setAriaLabel(),this._label=e}get label(){return this._label}_setAriaLabel(){typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):typeof this.options.title=="string"&&this._element.setAttribute("aria-label",this.options.title)}set icon(e){this._setAriaLabel();const t=Array.from(this._element.classList).filter(i=>i.startsWith("codicon-"));this._element.classList.remove(...t),this._element.classList.add(...Ct.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(Sl().setupManagedHover(this.options.hoverDelegate??jd("element"),this._element,e)):this._hover&&this._hover.update(e)}}class Dq extends le{constructor(e,t,i){super(),this.options=t,this.styles=i,this.count=0,this.hover=this._register(new Yn),this.element=Be(e,Ke(".monaco-count-badge")),this._register(qe(()=>e.removeChild(this.element))),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0),this.updateHover()}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.updateHover(),this.render()}updateHover(){this.titleFormat!==""&&!this.hover.value?this.hover.value=Sl().setupDelayedHoverAtMouse(this.element,()=>({content:g4(this.titleFormat,this.count),appearance:{compact:!0}})):this.titleFormat===""&&this.hover.value&&(this.hover.value=void 0)}render(){this.element.textContent=g4(this.countFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const Tq="done",Nq="active",gA="infinite",mA="infinite-long-running",Iq="discrete",yE=class yE extends le{constructor(e,t){super(),this.progressSignal=this._register(new Yn),this.workedVal=0,this.showDelayedScheduler=this._register(new Es(()=>sZ(this.element),0)),this.longRunningScheduler=this._register(new Es(()=>this.infiniteLongRunning(),yE.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(Nq,gA,mA,Iq),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(Tq),this.element.classList.contains(gA)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Iq,Tq,mA),this.element.classList.add(Nq,gA),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(mA)}getContainer(){return this.element}};yE.LONG_RUNNING_INFINITE_THRESHOLD=1e4;let i3=yE;const zAe=v(2,"Match Case"),UAe=v(3,"Match Whole Word"),jAe=v(4,"Use Regular Expression");class $Ae extends nb{constructor(e){super({icon:Ae.caseSensitive,title:zAe+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class qAe extends nb{constructor(e){super({icon:Ae.wholeWord,title:UAe+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class GAe extends nb{constructor(e){super({icon:Ae.regex,title:jAe+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}function KAe(s,e,t){const i=t??document.createElement("div");return i.textContent=s,i}function YAe(s,e,t){const i=t??document.createElement("div");return i.textContent="",tie(i,XAe(s),e==null?void 0:e.actionHandler,e==null?void 0:e.renderCodeSegments),i}class QAe{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function tie(s,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){const r=document.createElement("a");t.disposables.add(bs(r,"click",o=>{t.callback(String(e.index),o)})),n=r}else e.type===8?n=document.createElement("br"):e.type===1&&(n=s);n&&s!==n&&s.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(r=>{tie(n,r,t,i)})}function XAe(s,e){const t={type:1,children:[]};let i=0,n=t;const r=[],o=new QAe(s);for(;!o.eos();){let a=o.next();const l=a==="\\"&&n3(o.peek())!==0;if(l&&(a=o.next()),!l&&ZAe(a)&&a===o.peek()){o.advance(),n.type===2&&(n=r.pop());const c=n3(a);if(n.type===c||n.type===5&&c===6)n=r.pop();else{const h={type:c,children:[]};c===5&&(h.index=i,i++),n.children.push(h),r.push(n),n=h}}else if(a===`
`)n.type===2&&(n=r.pop()),n.children.push({type:8});else if(n.type!==2){const c={type:2,content:a};n.children.push(c),r.push(n),n=c}else n.content+=a}return n.type===2&&(n=r.pop()),t}function ZAe(s,e){return n3(s)!==0}function n3(s,e){switch(s){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return 0;default:return 0}}class JAe{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class eMe{constructor(e=new Set,t=10){this._history=e,this._limit=t,this._onChange(),this._history.onDidChange&&(this._disposable=this._history.onDidChange(()=>this._onChange()))}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new JAe(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;if(e.length>this._limit){const t=e.slice(e.length-this._limit);this._history.replace?this._history.replace(t):this._history=new Set(t)}}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}dispose(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0)}}const Wp=Ke;class tMe extends Ec{get onDidChange(){return this._onDidChange.event}get onDidHeightChange(){return this._onDidHeightChange.event}constructor(e,t,i){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this.hover=this._register(new Yn),this._onDidChange=this._register(new Z),this._onDidHeightChange=this._register(new Z),this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Be(e,Wp(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",r=Be(this.element,Wp(".ibwrapper"));if(this.input=Be(r,Wp(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Be(r,Wp("div.mirror")),this.mirror.innerText="",this.scrollableElement=new Fye(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Be(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));const o=this._register(new jt(e.ownerDocument,"selectionchange")),a=Se.filter(o.event,()=>{const l=e.ownerDocument.getSelection();return(l==null?void 0:l.anchorNode)===r});this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new ac(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover.value||(this.hover.value=this._register(Sl().setupDelayedHoverAtMouse(this.input,()=>({content:this.tooltip,appearance:{compact:!0}}))))}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:N4(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return c7(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const e=this.input.selectionStart;if(e===null)return null;const t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&$r(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Yu(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=l7(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=Be(n,Wp(".monaco-inputbox-container")),t();const r=Wp("span.monaco-inputbox-message");this.message.formatContent?YAe(this.message.content,void 0,r):KAe(this.message.content,void 0,r),r.classList.add(this.classForType(this.message.type));const o=this.stylesForType(this.message.type);return r.style.backgroundColor=o.background??"",r.style.color=o.foreground??"",r.style.border=o.border?`1px solid ${o.border}`:"",Be(e,r),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=v(9,"Error: {0}",this.message.content):this.message.type===2?i=v(10,"Warning: {0}",this.message.content):i=v(11,"Info: {0}",this.message.content),Vv(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText="",this.layout()}applyStyles(){const e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Yu(n,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=N4(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,r=t.value;i!==null&&n!==null&&(this.value=r.substr(0,i)+e+r.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){var e;this._hideMessage(),this.message=null,(e=this.actionbar)==null||e.dispose(),super.dispose()}}class iMe extends tMe{constructor(e,t,i){const n=v(12," or {0} for history",""),r=v(13," ({0} for history)","");super(e,t,i),this._onDidFocus=this._register(new Z),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Z),this.onDidBlur=this._onDidBlur.event,this.history=this._register(new eMe(i.history,100));const o=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){const a=this.placeholder.endsWith(")")?n:r,l=this.placeholder+a;i.showPlaceholderOnFocus&&!c7(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(c=>{c.target.textContent||o()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>o()),this.onblur(this.input,()=>{const a=l=>{if(this.placeholder.endsWith(l)){const c=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=c:this.setPlaceHolder(c),!0}else return!1};a(r)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",xk(this.value?this.value:v(14,"Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,xk(this.value))}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const nMe=v(1,"input");class sMe extends Ec{get onDidOptionChange(){return this._onDidOptionChange.event}get onKeyDown(){return this._onKeyDown.event}get onMouseDown(){return this._onMouseDown.event}get onCaseSensitiveKeyDown(){return this._onCaseSensitiveKeyDown.event}get onRegexKeyDown(){return this._onRegexKeyDown.event}constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new Yn),this.additionalToggles=[],this._onDidOptionChange=this._register(new Z),this._onKeyDown=this._register(new Z),this._onMouseDown=this._register(new Z),this._onInput=this._register(new Z),this._onKeyUp=this._register(new Z),this._onCaseSensitiveKeyDown=this._register(new Z),this._onRegexKeyDown=this._register(new Z),this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||nMe,this.showCommonFindToggles=!!i.showCommonFindToggles;const n=i.appendCaseSensitiveLabel||"",r=i.appendWholeWordsLabel||"",o=i.appendRegexLabel||"",a=!!i.flexibleHeight,l=!!i.flexibleWidth,c=i.flexibleMaxHeight;if(this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new iMe(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},showHistoryHint:i.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:i.inputBoxStyles,history:i.history})),this.showCommonFindToggles){const h=(i==null?void 0:i.hoverLifecycleOptions)||{groupId:"find-input"};this.regex=this._register(new GAe({appendTitle:o,isChecked:!1,hoverLifecycleOptions:h,...i.toggleStyles})),this._register(this.regex.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(g=>{this._onRegexKeyDown.fire(g)})),this.wholeWords=this._register(new qAe({appendTitle:r,isChecked:!1,hoverLifecycleOptions:h,...i.toggleStyles})),this._register(this.wholeWords.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new $Ae({appendTitle:n,isChecked:!1,hoverLifecycleOptions:h,...i.toggleStyles})),this._register(this.caseSensitive.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(g=>{this._onCaseSensitiveKeyDown.fire(g)}));const d=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,g=>{if(g.equals(15)||g.equals(17)||g.equals(9)){const p=d.indexOf(this.domNode.ownerDocument.activeElement);if(p>=0){let _=-1;g.equals(17)?_=(p+1)%d.length:g.equals(15)&&(p===0?_=d.length-1:_=p-1),g.equals(9)?(d[p].blur(),this.inputBox.focus()):_>=0&&d[_].focus(),Rt.stop(g,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i==null?void 0:i.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e==null||e.appendChild(this.domNode),this._register(ie(this.inputBox.inputElement,"compositionstart",h=>{this.imeSessionInProgress=!0})),this._register(ie(this.inputBox.inputElement,"compositionend",h=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){var e,t,i;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(e=this.regex)==null||e.enable(),(t=this.wholeWords)==null||t.enable(),(i=this.caseSensitive)==null||i.enable();for(const n of this.additionalToggles)n.enable()}disable(){var e,t,i;this.domNode.classList.add("disabled"),this.inputBox.disable(),(e=this.regex)==null||e.disable(),(t=this.wholeWords)==null||t.disable(),(i=this.caseSensitive)==null||i.disable();for(const n of this.additionalToggles)n.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new Pe;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){var t,i,n;e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(((t=this.caseSensitive)==null?void 0:t.width())??0)+(((i=this.wholeWords)==null?void 0:i.width())??0)+(((n=this.regex)==null?void 0:n.width())??0)+this.additionalToggles.reduce((r,o)=>r+o.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var e;return((e=this.caseSensitive)==null?void 0:e.checked)??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){var e;return((e=this.wholeWords)==null?void 0:e.checked)??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){var e;return((e=this.regex)==null?void 0:e.checked)??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){var e;(e=this.caseSensitive)==null||e.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}const rMe=Ke;class oMe extends le{constructor(e,t,i){super(),this.parent=e,this.onDidChange=r=>this.findInput.onDidChange(r),this.container=Be(this.parent,rMe(".quick-input-box")),this.findInput=this._register(new sMe(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const n=this.findInput.inputBox.inputElement;n.role="textbox",n.ariaHasPopup="menu",n.ariaAutoComplete="list"}get onKeyDown(){return this.findInput.onKeyDown}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}get ariaLabel(){return this.findInput.inputBox.inputElement.getAttribute("aria-label")||""}set ariaLabel(e){this.findInput.inputBox.inputElement.setAttribute("aria-label",e)}hasFocus(){return this.findInput.inputBox.hasFocus()}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.findInput.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===Ji.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===Ji.Info?1:e===Ji.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===Ji.Info?1:e===Ji.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class Ag extends le{constructor(e,t){super(),this.options=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.domNode=Be(e,Ke("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n,r){e||(e=""),n&&(e=Ag.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&$r(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render(r))}render(e){var n;const t=[];let i=0;for(const r of this.highlights){if(r.end===r.start)continue;if(i<r.start){const l=this.text.substring(i,r.start);e?t.push(...Ig(l)):t.push(l),i=r.start}const o=this.text.substring(i,r.end),a=Ke("span.highlight",void 0,...e?Ig(o):[o]);r.extraClasses&&a.classList.add(...r.extraClasses),t.push(a),i=r.end}if(i<this.text.length){const r=this.text.substring(i);e?t.push(...Ig(r)):t.push(r)}if(Ds(this.domNode,...t),!this.customHover&&this.title!==""){const r=((n=this.options)==null?void 0:n.hoverDelegate)??jd("mouse");this.customHover=this._register(Sl().setupManagedHover(r,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,(r,o)=>{n=r===`\r
`?-1:0,o+=i;for(const a of t)a.end<=o||(a.start>=o&&(a.start+=n),a.end>=o&&(a.end+=n));return i+=n,""})}}class y0{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||$r(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class s3 extends le{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new y0(Be(e,Ke(".monaco-icon-label")))),this.labelContainer=Be(this.domNode.element,Ke(".monaco-icon-label-container")),this.nameContainer=Be(this.labelContainer,Ke("span.monaco-icon-name-container")),t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=this._register(new cMe(this.nameContainer,!!t.supportIcons)):this.nameNode=new aMe(this.nameContainer),this.hoverDelegate=(t==null?void 0:t.hoverDelegate)??jd("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){var l;const n=["monaco-icon-label"],r=["monaco-icon-label-container"];let o="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.bold&&n.push("bold"),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&r.push("disabled"),i.title&&(typeof i.title=="string"?o+=i.title:o+=e));const a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i!=null&&i.iconPath){let c;if(!a||!nn(a)?(c=Ke(".monaco-icon-label-iconpath"),this.domNode.element.prepend(c)):c=a,Ct.isThemeIcon(i.iconPath)){const h=Ct.asClassName(i.iconPath);c.className=`monaco-icon-label-iconpath ${h}`,c.style.backgroundImage=""}else c.style.backgroundImage=vc(i==null?void 0:i.iconPath);c.style.backgroundRepeat="no-repeat",c.style.backgroundPosition="center",c.style.backgroundSize="contain"}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",o),this.labelContainer.classList.value="",this.labelContainer.classList.add(...r),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const c=this.getOrCreateDescriptionNode();if(c instanceof Ag){const h=(i==null?void 0:i.supportIcons)??((l=this.creationOptions)==null?void 0:l.supportIcons);c.set(t||"",i?i.descriptionMatches:void 0,void 0,i==null?void 0:i.labelEscapeNewLines,h),this.setupHover(c.element,i==null?void 0:i.descriptionTitle)}else c.textContent=t&&(i!=null&&i.labelEscapeNewLines)?Ag.escapeNewLines(t,[]):t||"",this.setupHover(c.element,(i==null?void 0:i.descriptionTitle)||""),c.empty=!t}if(i!=null&&i.suffix||this.suffixNode){const c=this.getOrCreateSuffixNode();c.textContent=(i==null?void 0:i.suffix)??""}}setupHover(e,t){var o;const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}let n=e;if((o=this.creationOptions)!=null&&o.hoverTargetOverride){if(!Gn(e,this.creationOptions.hoverTargetOverride))throw new Error("hoverTargetOverrride must be an ancestor of the htmlElement");n=this.creationOptions.hoverTargetOverride}const r=Sl().setupManagedHover(this.hoverDelegate,n,t);r&&this.customHovers.set(e,r)}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new y0(D1e(this.nameContainer,Ke("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new y0(Be(e.element,Ke("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){var e;if(!this.descriptionNode){const t=this._register(new y0(Be(this.labelContainer,Ke("span.monaco-icon-description-container"))));(e=this.creationOptions)!=null&&e.supportDescriptionHighlights?this.descriptionNode=this._register(new Ag(Be(t.element,Ke("span.label-description")))):this.descriptionNode=this._register(new y0(Be(t.element,Ke("span.label-description"))))}return this.descriptionNode}}class aMe{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&$r(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.textContent="",this.container.classList.remove("multiple"),this.singleLabel=Be(this.container,Ke("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.textContent="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],r=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;Be(this.container,Ke("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&Be(this.container,Ke("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function lMe(s,e,t){if(!t)return;let i=0;return s.map(n=>{const r={start:i,end:i+n.length},o=t.map(a=>Ss.intersect(r,a)).filter(a=>!Ss.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=r.end+e.length,o})}class cMe extends le{constructor(e,t){super(),this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label===e&&$r(this.options,t))return;this.label=e,this.options=t;const i=(t==null?void 0:t.supportIcons)??this.supportIcons;if(typeof e=="string")this.singleLabel||(this.container.textContent="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new Ag(Be(this.container,Ke("a.label-name",{id:t==null?void 0:t.domId}))))),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines,i);else{this.container.textContent="",this.container.classList.add("multiple"),this.singleLabel=void 0;const n=(t==null?void 0:t.separator)||"/",r=lMe(e,n,t==null?void 0:t.matches);for(let o=0;o<e.length;o++){const a=e[o],l=r?r[o]:void 0,c=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${o}`,h=Ke("a.label-name",{id:c,"data-icon-label-count":e.length,"data-icon-label-index":o,role:"treeitem"});this._register(new Ag(Be(this.container,h))).set(a,l,void 0,t==null?void 0:t.labelEscapeNewLines,i),o<e.length-1&&Be(h,Ke("span.label-separator",void 0,n))}}}}const Ix=Ke;class R8 extends le{constructor(e,t,i){super(),this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const n=this.options.keybindingLabelForeground;this.domNode=Be(e,Ix(".monaco-keybinding")),n&&(this.domNode.style.color=n),this.hover=this._register(Sl().setupManagedHover(jd("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}set(e,t){this.didEverRender&&this.keybinding===e&&R8.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let i=1;i<e.length;i++)Be(this.domNode,Ix("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[i],this.matches?this.matches.chordPart:null);const t=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(t),this.domNode.setAttribute("aria-label",t||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){_l(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const n=k8.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,!!(i!=null&&i.ctrlKey),n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,!!(i!=null&&i.shiftKey),n.separator),t.altKey&&this.renderKey(e,n.altKey,!!(i!=null&&i.altKey),n.separator),t.metaKey&&this.renderKey(e,n.metaKey,!!(i!=null&&i.metaKey),n.separator);const r=t.keyLabel;r&&this.renderKey(e,r,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,n){Be(e,this.createKeyElement(t,i?".highlight":"")),n&&Be(e,Ix("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){Be(e,this.createKeyElement(v(15,"Unbound")))}createKeyElement(e,t=""){const i=Ix("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&$r(e.firstPart,t.firstPart)&&$r(e.chordPart,t.chordPart)}}var ho;(function(s){s[s.Expanded=0]="Expanded",s[s.Collapsed=1]="Collapsed",s[s.PreserveOrExpanded=2]="PreserveOrExpanded",s[s.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(ho||(ho={}));var mg;(function(s){s[s.Unknown=0]="Unknown",s[s.Twistie=1]="Twistie",s[s.Element=2]="Element",s[s.Filter=3]="Filter"})(mg||(mg={}));class wo extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class A8{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function hy(s){return!!s&&s.visibility!==void 0}function mm(s){switch(s){case!0:return 1;case!1:return 0;default:return s}}function pA(s){return"collapsible"in s}class uMe{constructor(e,t,i={}){this.user=e,this.rootRef=[],this.eventBufferer=new FC,this._onDidSpliceModel=new Z,this.onDidSpliceModel=this._onDidSpliceModel.event,this._onDidSpliceRenderedNodes=new Z,this.onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event,this._onDidChangeCollapseState=new Z,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new Z,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this.refilterDelayer=new HC(WX),this.collapseByDefault=typeof i.collapseByDefault>"u"?!1:i.collapseByDefault,this.allowNonCollapsibleParents=i.allowNonCollapsibleParents??!1,this.filter=i.filter,this.autoExpandSingleChildren=typeof i.autoExpandSingleChildren>"u"?!1:i.autoExpandSingleChildren,this.root={parent:void 0,element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=Dt.empty(),n={}){if(e.length===0)throw new wo(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=Dt.empty(),r,o=r.diffDepth??0){const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,r);const l=[...n],c=t[t.length-1],h=new Tu({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+i)].map(b=>e.getId(b.element).toString())}).ComputeDiff(!1);if(h.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,r);const d=t.slice(0,-1),g=(b,C,x)=>{if(o>0)for(let S=0;S<x;S++)b--,C--,this.spliceSmart(e,[...d,b,0],Number.MAX_SAFE_INTEGER,l[C].children,r,o-1)};let p=Math.min(a.children.length,c+i),_=l.length;for(const b of h.changes.sort((C,x)=>x.originalStart-C.originalStart))g(p,_,p-(b.originalStart+b.originalLength)),p=b.originalStart,_=b.modifiedStart-c,this.spliceSimple([...d,p],b.originalLength,Dt.slice(l,_,_+b.modifiedLength),r);g(p,_,p)}spliceSimple(e,t,i=Dt.empty(),{onDidCreateNode:n,onDidDeleteNode:r,diffIdentityProvider:o}){const{parentNode:a,listIndex:l,revealed:c,visible:h}=this.getParentNodeWithListIndex(e),d=[],g=Dt.map(i,D=>this.createTreeNode(D,a,a.visible?1:0,c,d,n)),p=e[e.length-1];let _=0;for(let D=p;D>=0&&D<a.children.length;D--){const R=a.children[D];if(R.visible){_=R.visibleChildIndex;break}}const b=[];let C=0,x=0;for(const D of g)b.push(D),x+=D.renderNodeCount,D.visible&&(D.visibleChildIndex=_+C++);const S=GL(a.children,p,t,b);o?a.lastDiffIds?GL(a.lastDiffIds,p,t,b.map(D=>o.getId(D.element).toString())):a.lastDiffIds=a.children.map(D=>o.getId(D.element).toString()):a.lastDiffIds=void 0;let y=0;for(const D of S)D.visible&&y++;if(y!==0)for(let D=p+b.length;D<a.children.length;D++){const R=a.children[D];R.visible&&(R.visibleChildIndex-=y)}if(a.visibleChildrenCount+=C-y,S.length>0&&r){const D=R=>{r(R),R.children.forEach(D)};S.forEach(D)}if(c&&h){const D=S.reduce((R,N)=>R+(N.visible?N.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,x-D),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:D,elements:d})}this._onDidSpliceModel.fire({insertedNodes:b,deletedNodes:S});let k=a;for(;k;){if(k.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}k=k.parent}}rerender(e){if(e.length===0)throw new wo(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this._onDidSpliceRenderedNodes.fire({start:i,deleteCount:1,elements:[t]})}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);const r={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:r}=this.getTreeNodeWithListIndex(e),o=this._setListNodeCollapseState(i,n,r,t);if(i!==this.root&&this.autoExpandSingleChildren&&o&&!pA(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return o}_setListNodeCollapseState(e,t,i,n){const r=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!r)return r;const o=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=o-(t===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:t+1,deleteCount:l,elements:a.slice(1)}),r}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(pA(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!pA(t)&&t.recursive)for(const r of e.children)n=this._setNodeCollapseState(r,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:e,elements:t}),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,r,o){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&r.push(a);const c=e.children||Dt.empty(),h=n&&l!==0&&!a.collapsed;let d=0,g=1;for(const p of c){const _=this.createTreeNode(p,a,l,h,r,o);a.children.push(_),g+=_.renderNodeCount,_.visible&&(_.visibleChildIndex=d++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=d,a.visible=l===2?d>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=g):(a.renderNodeCount=0,n&&r.pop()),o==null||o(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),r===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const o=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||r!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,r,i,n&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=r===2?a:r===1,e.visibility=r),e.visible?e.collapsed||(e.renderNodeCount+=i.length-o):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):hy(i)?(e.filterData=i.data,mm(i.visibility)):(e.filterData=void 0,mm(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new wo(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:r}=this.getParentNodeWithListIndex(e),o=e[e.length-1];if(o<0||o>t.children.length)throw new wo(this.user,"Invalid tree location");const a=t.children[o];return{node:a,listIndex:i,revealed:n,visible:r&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,r=!0){const[o,...a]=e;if(o<0||o>t.children.length)throw new wo(this.user,"Invalid tree location");for(let l=0;l<o;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,r=r&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:r}:this.getParentNodeWithListIndex(a,t.children[o],i+1,n,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:qge(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class hMe extends oy{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function _A(s){return s instanceof oy?new hMe(s):s}class dMe{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=le.None,this.disposables=new Pe}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,_A(e),t)}onDragOver(e,t,i,n,r,o=!0){const a=this.dnd.onDragOver(_A(e),t&&t.element,i,n,r),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=C4(()=>{const p=this.modelProvider(),_=p.getNodeLocation(t);p.isCollapsed(_)&&p.setCollapsed(_,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!o){const p=typeof a=="boolean"?a:a.accept,_=typeof a=="boolean"?void 0:a.effect;return{accept:p,effect:_,feedback:[i]}}return a}if(a.bubble===1){const p=this.modelProvider(),_=p.getNodeLocation(t),b=p.getParentNodeLocation(_),C=p.getNode(b),x=b&&p.getListIndex(b);return this.onDragOver(e,C,x,n,r,!1)}const c=this.modelProvider(),h=c.getNodeLocation(t),d=c.getListIndex(h),g=c.getListRenderCount(h);return{...a,feedback:nr(d,d+g)}}drop(e,t,i,n,r){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(_A(e),t&&t.element,i,n,r)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function fMe(s,e,t){return t&&{...t,identityProvider:t.identityProvider&&{getId(i){return t.identityProvider.getId(i.element)}},dnd:t.dnd&&e.add(new dMe(s,t.dnd)),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent(i){return t.multipleSelectionController.isSelectionSingleChangeEvent({...i,element:i.element})},isSelectionRangeChangeEvent(i){return t.multipleSelectionController.isSelectionRangeChangeEvent({...i,element:i.element})}},accessibilityProvider:t.accessibilityProvider&&{...t.accessibilityProvider,getSetSize(i){const n=s(),r=n.getNodeLocation(i),o=n.getParentNodeLocation(r);return n.getNode(o).visibleChildrenCount},getPosInSet(i){return i.visibleChildIndex+1},isChecked:t.accessibilityProvider&&t.accessibilityProvider.isChecked?i=>t.accessibilityProvider.isChecked(i.element):void 0,getRole:t.accessibilityProvider&&t.accessibilityProvider.getRole?i=>t.accessibilityProvider.getRole(i.element):()=>"treeitem",getAriaLabel(i){return t.accessibilityProvider.getAriaLabel(i.element)},getWidgetAriaLabel(){return t.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:t.accessibilityProvider&&t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider&&t.accessibilityProvider.getAriaLevel?i=>t.accessibilityProvider.getAriaLevel(i.element):i=>i.depth,getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(i=>t.accessibilityProvider.getActiveDescendantId(i.element))},keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(i){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(i.element)}}}}class M8{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,n;(n=(i=this.delegate).setDynamicHeight)==null||n.call(i,e.element,t)}}var pm;(function(s){s.None="none",s.OnHover="onHover",s.Always="always"})(pm||(pm={}));class gMe{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new Pe,this.onDidChange=Se.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}const L_=class L_{constructor(e,t,i,n,r,o={}){var a;this.renderer=e,this.model=t,this.activeNodes=n,this.renderedIndentGuides=r,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=L_.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=le.None,this.disposables=new Pe,this.templateId=e.templateId,this.updateOptions(o),Se.map(i,l=>l.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(a=e.onDidChangeTwistieState)==null||a.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=xr(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,n]of this.renderedNodes)n.indentSize=L_.DefaultIndent+(i.depth-1)*this.indent,this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==pm.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){const i=new Pe;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=Be(e,Ke(".monaco-tl-row")),i=Be(t,Ke(".monaco-tl-indent")),n=Be(t,Ke(".monaco-tl-twistie")),r=Be(t,Ke(".monaco-tl-contents")),o=this.renderer.renderTemplate(r);return{container:e,indent:i,twistie:n,indentGuidesDisposable:le.None,indentSize:0,templateData:o}}renderElement(e,t,i,n){i.indentSize=L_.DefaultIndent+(e.depth-1)*this.indent,this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,{...n,indent:i.indentSize})}disposeElement(e,t,i,n){var r,o;i.indentGuidesDisposable.dispose(),(o=(r=this.renderer).disposeElement)==null||o.call(r,e,t,i.templateData,{...n,indent:i.indentSize}),typeof(n==null?void 0:n.height)=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){t.twistie.style.paddingLeft=`${t.indentSize}px`,t.indent.style.width=`${t.indentSize+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...Ct.asClassNameArray(Ae.treeItemExpanded));let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...Ct.asClassNameArray(Ae.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(_l(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new Pe;for(;;){const n=this.model.getNodeLocation(e),r=this.model.getParentNodeLocation(n);if(!r)break;const o=this.model.getNode(r),a=Ke(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(o)&&a.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(o,a),i.add(qe(()=>this.renderedIndentGuides.delete(o,a))),e=o}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set;e.forEach(i=>{const n=this.model.getNodeLocation(i);try{const r=this.model.getParentNodeLocation(n);i.collapsible&&i.children.length>0&&!i.collapsed?t.add(i):r&&t.add(this.model.getNode(r))}catch{}}),this.activeIndentNodes.forEach(i=>{t.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.remove("active"))}),t.forEach(i=>{this.activeIndentNodes.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),_n(this.disposables)}};L_.DefaultIndent=8;let r3=L_;function mMe(s,e){const t=e.toLowerCase().indexOf(s);let i;if(t>-1){i=[Number.MAX_SAFE_INTEGER,0];for(let n=s.length;n>0;n--)i.push(t+n-1)}return i}class iie{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set findMatchType(e){this._findMatchType=e}get findMatchType(){return this._findMatchType}set findMode(e){this._findMode=e}get findMode(){return this._findMode}constructor(e,t,i){this._keyboardNavigationLabelProvider=e,this._filter=t,this._defaultFindVisibility=i,this._totalCount=0,this._matchCount=0,this._findMatchType=ll.Fuzzy,this._findMode=vo.Highlight,this._pattern="",this._lowercasePattern="",this.disposables=new Pe}filter(e,t){let i=1;if(this._filter){const o=this._filter.filter(e,t);if(typeof o=="boolean"?i=o?1:0:hy(o)?i=mm(o.visibility):i=o,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Ng.Default,visibility:i};const n=this._keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(n)?n:[n];for(const o of r){const a=o&&o.toString();if(typeof a>"u")return{data:Ng.Default,visibility:i};let l;if(this._findMatchType===ll.Contiguous?l=mMe(this._lowercasePattern,a.toLowerCase()):l=tte(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0}),l)return this._matchCount++,r.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this._findMode===vo.Filter?typeof this._defaultFindVisibility=="number"?this._defaultFindVisibility:this._defaultFindVisibility?this._defaultFindVisibility(e):2:{data:Ng.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){_n(this.disposables)}}class pMe{constructor(e){this.stateMap=new Map(e.map(t=>[t.id,{...t}]))}get(e){const t=this.stateMap.get(e);if(t===void 0)throw new Error(`No state found for toggle id ${e}`);return t.isChecked}set(e,t){const i=this.stateMap.get(e);if(i===void 0)throw new Error(`No state found for toggle id ${e}`);return i.isChecked===t?!1:(i.isChecked=t,!0)}}var vo;(function(s){s[s.Highlight=0]="Highlight",s[s.Filter=1]="Filter"})(vo||(vo={}));var ll;(function(s){s[s.Fuzzy=0]="Fuzzy",s[s.Contiguous=1]="Contiguous"})(ll||(ll={}));var $h;(function(s){s.Mode="mode",s.MatchType="matchType"})($h||($h={}));class _Me{get pattern(){return this._pattern}get placeholder(){return this._placeholder}set placeholder(e){var t;this._placeholder=e,(t=this.widget)==null||t.setPlaceHolder(e)}constructor(e,t,i,n={}){this.tree=e,this.filter=t,this.contextViewProvider=i,this.options=n,this._pattern="",this._onDidChangePattern=new Z,this._onDidChangeOpenState=new Z,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new Pe,this.disposables=new Pe,this.toggles=new pMe(n.toggles??[]),this._placeholder=n.placeholder??v(20,"Type to search")}isOpened(){return!!this.widget}updateToggleState(e,t){var i;this.toggles.set(e,t),(i=this.widget)==null||i.setToggleState(e,t)}renderMessage(e,t){var i,n,r;e?this.tree.options.showNotFoundMessage??!0?(i=this.widget)==null||i.showMessage({type:2,content:t??v(21,"No results found.")}):(n=this.widget)==null||n.showMessage({type:2}):(r=this.widget)==null||r.clearMessage()}alertResults(e){Vv(e?v(23,"{0} results",e):v(22,"No results"))}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class nie extends _Me{get mode(){return this.toggles.get($h.Mode)?vo.Filter:vo.Highlight}set mode(e){if(e===this.mode)return;const t=e===vo.Filter;this.updateToggleState($h.Mode,t),this.placeholder=t?v(24,"Type to filter"):v(25,"Type to search"),this.filter.findMode=e,this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e)}get matchType(){return this.toggles.get($h.MatchType)?ll.Fuzzy:ll.Contiguous}set matchType(e){e!==this.matchType&&(this.updateToggleState($h.MatchType,e===ll.Fuzzy),this.filter.findMatchType=e,this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,n={}){const r=n.defaultFindMode??vo.Highlight,o=n.defaultFindMatchType??ll.Fuzzy,a=[{id:$h.Mode,icon:Ae.listFilter,title:v(26,"Filter"),isChecked:r===vo.Filter},{id:$h.MatchType,icon:Ae.searchFuzzy,title:v(27,"Fuzzy Match"),isChecked:o===ll.Fuzzy}];t.findMatchType=o,t.findMode=r,super(e,t,i,{...n,toggles:a}),this.filter=t,this._onDidChangeMode=new Z,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new Z,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this.disposables.add(this.tree.onDidChangeModel(()=>{this.isOpened()&&(this.pattern.length!==0&&this.tree.refilter(),this.render())})),this.disposables.add(this.tree.onWillRefilter(()=>this.filter.reset()))}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}shouldAllowFocus(e){return!this.isOpened()||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Ng.isDefault(e.filterData)}render(){const t=this.filter.matchCount===0&&this.filter.totalCount>0&&this.pattern.length>0;this.renderMessage(t),this.pattern.length&&this.alertResults(this.filter.matchCount)}}function bMe(s,e){return s.position===e.position&&sie(s,e)}function sie(s,e){return s.node.element===e.node.element&&s.startIndex===e.startIndex&&s.height===e.height&&s.endIndex===e.endIndex}class wMe{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return Sn(this.stickyNodes,e.stickyNodes,bMe)}contains(e){return this.stickyNodes.some(t=>t.node.element===e.element)}lastNodePartiallyVisible(){if(this.count===0)return!1;const e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!Sn(this.stickyNodes,e.stickyNodes,sie)||this.count===0)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class vMe{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){const r=e[n];if(r.position+r.height>i||n>=t)return e.slice(0,n)}return e}}class Rq extends le{constructor(e,t,i,n,r,o={}){super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=r,this.maxWidgetViewRatio=.4;const a=this.validateStickySettings(o);this.stickyScrollMaxItemCount=a.stickyScrollMaxItemCount,this.stickyScrollDelegate=o.stickyScrollDelegate??new vMe,this.paddingTop=o.paddingTop??0,this._widget=this._register(new CMe(i.getScrollableElement(),i,e,n,r,o.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this._register(t.onDidSpliceRenderedNodes(l=>{const c=this._widget.state;if(!c)return;if(l.deleteCount>0&&c.stickyNodes.some(g=>!this.model.has(this.model.getNodeLocation(g.node)))){this.update();return}c.stickyNodes.some(g=>{const p=this.model.getListIndex(this.model.getNodeLocation(g.node));return p>=l.start&&p<l.start+l.deleteCount&&c.contains(g.node)})&&this._widget.rerender()})),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(e===0?t=this.view.firstVisibleIndex:t=this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(this.paddingTop);if(!e||this.tree.scrollTop<=this.paddingTop){this._widget.setState(void 0);return}const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,n=0,r=this.getNextStickyNode(i,void 0,n);for(;r&&(t.push(r),n+=r.height,!(t.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(r),!i)));)r=this.getNextStickyNode(i,r.node,n);const o=this.constrainStickyNodes(t);return o.length?new wMe(o):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const n=this.getAncestorUnderPrevious(e,t);if(n&&!(n===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,i))))return this.createStickyScrollNode(n,i)}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),n=this.view.getElementTop(i),r=t;return this.view.scrollTop===n-r}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:n,endIndex:r}=this.getNodeRange(e),o=this.calculateStickyNodePosition(r,t,i);return{node:e,position:o,height:i,startIndex:n,endIndex:r}}getAncestorUnderPrevious(e,t=void 0){let i=e,n=this.getParentNode(i);for(;n;){if(n===t)return i;i=n,n=this.getParentNode(i)}if(t===void 0)return i}calculateStickyNodePosition(e,t,i){let n=this.view.getRelativeTop(e);if(n===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const c=this.treeDelegate.getHeight(this.view.element(e)),h=this.view.getRelativeTop(e+1);n=h?h-c/this.view.renderHeight:null}if(n===null)return t;const r=this.view.element(e),o=this.treeDelegate.getHeight(r),l=n*this.view.renderHeight+o;return t+i>l&&t<=l?l-i:t}constrainStickyNodes(e){if(e.length===0)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const n=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!n.length)return[];const r=n[n.length-1];if(n.length>this.stickyScrollMaxItemCount||r.position+r.height>t)throw new Error("stickyScrollDelegate violates constraints");return n}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");const n=this.model.getListRenderCount(t),r=i+n-1;return{startIndex:i,endIndex:r}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let n=0;for(let r=0;r<t.length&&r<this.stickyScrollMaxItemCount;r++)n+=this.treeDelegate.getHeight(t[r]);return n}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(e.paddingTop!==void 0&&(this.paddingTop=e.paddingTop),e.stickyScrollMaxItemCount!==void 0){const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}}validateStickySettings(e){let t=7;return typeof e.stickyScrollMaxItemCount=="number"&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}}class CMe{get state(){return this._previousState}constructor(e,t,i,n,r,o){this.view=t,this.tree=i,this.treeRenderers=n,this.treeDelegate=r,this.accessibilityProvider=o,this._previousElements=[],this._previousStateDisposables=new Pe,this._rootDomNode=Ke(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const a=Ke(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new yMe(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const n=e.stickyNodes[e.count-1];this._previousState&&e.animationStateChanged(this._previousState)?this._previousElements[this._previousState.count-1].style.top=`${n.position}px`:this.renderState(e),this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}renderState(e){this._previousStateDisposables.clear();const t=Array(e.count);for(let i=e.count-1;i>=0;i--){const n=e.stickyNodes[i],{element:r,disposable:o}=this.createElement(n,i,e.count);t[i]=r,this._rootDomNode.appendChild(r),this._previousStateDisposables.add(o)}this.stickyScrollFocus.updateElements(t,e),this._previousElements=t}rerender(){this._previousState&&this.renderState(this._previousState)}createElement(e,t,i){const n=e.startIndex,r=document.createElement("div");r.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(r.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(r.style.lineHeight=`${e.height}px`),r.classList.add("monaco-tree-sticky-row"),r.classList.add("monaco-list-row"),r.setAttribute("data-index",`${n}`),r.setAttribute("data-parity",n%2===0?"even":"odd"),r.setAttribute("id",this.view.getElementID(n));const o=this.setAccessibilityAttributes(r,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(g=>g.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let c=e.node;c===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(c=new Proxy(e.node,{}));const h=l.renderTemplate(r);l.renderElement(c,e.startIndex,h,{height:e.height});const d=qe(()=>{o.dispose(),l.disposeElement(c,e.startIndex,h,{height:e.height}),l.disposeTemplate(h),r.remove()});return{element:r,disposable:d}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return le.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");const r=this.accessibilityProvider.getAriaLabel(t),o=r&&typeof r!="string"?r:lC(r),a=vt(c=>{const h=c.readObservable(o);h?e.setAttribute("aria-label",h):e.removeAttribute("aria-label")});typeof r=="string"||r&&e.setAttribute("aria-label",r.get());const l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}}class yMe extends le{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new Z,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new Z,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(ie(this.container,"focus",()=>this.onFocus())),this._register(ie(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}handleContextMenu(e){const t=e.browserEvent.target;if(!cC(t)&&!Ew(t)){this.focusedLast()&&this.view.domFocus();return}if(!yu(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const o=this.state.stickyNodes.findIndex(a=>{var l;return a.node.element===((l=e.element)==null?void 0:l.element)});if(o===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(o);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const n=this.state.stickyNodes[this.focusedIndex].node.element,r=this.elements[this.focusedIndex];this._onContextMenu.fire({element:n,anchor:r,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){const t=e.browserEvent.target;!cC(t)&&!Ew(t)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&t.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const n=xr(i,0,t.count-1);this.setFocus(n)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],n=t.count>1?t.stickyNodes[t.count-2]:void 0,r=this.view.getElementTop(e),o=n?n.position+n.height+i.height:i.height;this.view.scrollTop=r-o}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function Rx(s){let e=mg.Unknown;return uR(s.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=mg.Twistie:uR(s.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=mg.Element:uR(s.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=mg.Filter),{browserEvent:s.browserEvent,element:s.element?s.element.element:null,target:e}}function SMe(s){const e=cC(s.browserEvent.target);return{element:s.element?s.element.element:null,browserEvent:s.browserEvent,anchor:s.anchor,isStickyScroll:e}}function lL(s,e){e(s),s.children.forEach(t=>lL(t,e))}class bA{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new Z,this.onDidChange=this._onDidChange.event}set(e,t){const i=t;!(i!=null&&i.__forceEvent)&&Sn(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=h=>l.delete(h);t.forEach(h=>lL(h,c)),this.set([...l.values()]);return}const i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>lL(l,n));const r=new Map,o=l=>r.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>lL(l,o));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const d=r.get(c);d&&d.visible&&a.push(d)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class xMe extends Hte{constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if(Pte(e.browserEvent.target)||gl(e.browserEvent.target)||P0(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,r=Ew(e.browserEvent.target);let o=!1;if(r?o=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?o=this.tree.expandOnlyOnTwistieClick(t.element):o=!!this.tree.expandOnlyOnTwistieClick,r)this.handleStickyScrollMouseEvent(e,t);else{if(o&&!n&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(t.collapsible&&(!r||n)){const a=this.tree.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),this.tree.toggleCollapsed(a,l),n){e.browserEvent.isHandledByList=!0;return}}r||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if(ARe(e.browserEvent.target)||MRe(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const n=this.list.indexOf(t),r=this.list.getElementTop(n),o=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=r-o,this.list.domFocus(),this.list.setFocus([n]),this.list.setSelection([n])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){const t=e.browserEvent.target;if(!cC(t)&&!Ew(t)){super.onMouseDown(e);return}}onContextMenu(e){const t=e.browserEvent.target;if(!cC(t)&&!Ew(t)){super.onContextMenu(e);return}}}class LMe extends xl{constructor(e,t,i,n,r,o,a,l){super(e,t,i,n,l),this.focusTrait=r,this.selectionTrait=o,this.anchorTrait=a}createMouseController(e){return new xMe(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const n=[],r=[];let o;i.forEach((a,l)=>{this.focusTrait.has(a)&&n.push(e+l),this.selectionTrait.has(a)&&r.push(e+l),this.anchorTrait.has(a)&&(o=e+l)}),n.length>0&&super.setFocus(Jg([...super.getFocus(),...n])),r.length>0&&super.setSelection(Jg([...super.getSelection(),...r])),typeof o=="number"&&super.setAnchor(o)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(n=>this.element(n)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(n=>this.element(n)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class rie{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Se.filter(Se.map(this.view.onMouseDblClick,Rx),e=>e.target!==mg.Filter)}get onMouseOver(){return Se.map(this.view.onMouseOver,Rx)}get onMouseOut(){return Se.map(this.view.onMouseOut,Rx)}get onContextMenu(){var e;return Se.any(Se.filter(Se.map(this.view.onContextMenu,SMe),t=>!t.isStickyScroll),((e=this.stickyScrollController)==null?void 0:e.onContextMenu)??Se.None)}get onPointer(){return Se.map(this.view.onPointer,Rx)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return Se.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.onDidChangeCollapseStateRelay.event}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,n,r={}){this._user=e,this._options=r,this.eventBufferer=new FC,this.onDidChangeFindOpenState=Se.None,this.onDidChangeStickyScrollFocused=Se.None,this.disposables=new Pe,this.onDidSwapModel=this.disposables.add(new Z),this.onDidChangeModelRelay=this.disposables.add(new i0),this.onDidSpliceModelRelay=this.disposables.add(new i0),this.onDidChangeCollapseStateRelay=this.disposables.add(new i0),this.onDidChangeRenderNodeCountRelay=this.disposables.add(new i0),this.onDidChangeActiveNodesRelay=this.disposables.add(new i0),this._onWillRefilter=new Z,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new Z,this.modelDisposables=new Pe,r.keyboardNavigationLabelProvider&&(r.findWidgetEnabled??!0)&&(this.findFilter=new iie(r.keyboardNavigationLabelProvider,r.filter,r.defaultFindVisibility),r={...r,filter:this.findFilter},this.disposables.add(this.findFilter)),this.model=this.createModel(e,r),this.treeDelegate=new M8(i);const o=this.disposables.add(new gMe(this.onDidChangeActiveNodesRelay.event)),a=new hZ;this.renderers=n.map(l=>new r3(l,this.model,this.onDidChangeCollapseStateRelay.event,o,a,r));for(const l of this.renderers)this.disposables.add(l);if(this.focus=new bA(()=>this.view.getFocusedElements()[0],r.identityProvider),this.selection=new bA(()=>this.view.getSelectedElements()[0],r.identityProvider),this.anchor=new bA(()=>this.view.getAnchorElement(),r.identityProvider),this.view=new LMe(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...fMe(()=>this.model,this.disposables,r),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),r.keyboardSupport!==!1){const l=Se.chain(this.view.onKeyDown,c=>c.filter(h=>!gl(h.target)).map(h=>new si(h)));Se.chain(l,c=>c.filter(h=>h.keyCode===15))(this.onLeftArrow,this,this.disposables),Se.chain(l,c=>c.filter(h=>h.keyCode===17))(this.onRightArrow,this,this.disposables),Se.chain(l,c=>c.filter(h=>h.keyCode===10))(this.onSpace,this,this.disposables)}if((r.findWidgetEnabled??!0)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider){const l={styles:r.findWidgetStyles,defaultFindMode:r.defaultFindMode,defaultFindMatchType:r.defaultFindMatchType,showNotFoundMessage:r.showNotFoundMessage};this.findController=this.disposables.add(new nie(this,this.findFilter,r.contextViewProvider,l)),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=Se.None,this.onDidChangeFindMatchType=Se.None;r.enableStickyScroll&&(this.stickyScrollController=new Rq(this,this.model,this.view,this.renderers,this.treeDelegate,r),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=bl(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===pm.Always)}updateOptions(e={}){var t;this._options={...this._options,...e};for(const i of this.renderers)i.updateOptions(e);this.view.updateOptions(this._options),(t=this.findController)==null||t.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===pm.Always)}get options(){return this._options}updateStickyScroll(e){var t;!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new Rq(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=Se.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),(t=this.stickyScrollController)==null||t.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){var e;(e=this.stickyScrollController)!=null&&e.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){this.view.layout(e,t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { opacity: 1; border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { opacity: 1; border-color: ${e.treeIndentGuidesStroke}; }`));const n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const r=Yu(e.listFocusAndSelectionOutline,Yu(e.listSelectionOutline,e.listFocusOutline??""));r&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(r=>this.model.getNode(r));this.selection.set(i,t);const n=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(r=>this.model.getNode(r));this.focus.set(i,t);const n=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=yu(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=yu(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=yu(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=yu(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>{var i;return((i=this.stickyScrollController)==null?void 0:i.height)??0})}focusLast(e,t=yu(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=yu(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{const n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const o=this.model.getParentNodeLocation(n);if(!o)return;const a=this.model.getListIndex(o);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;const[o]=this.view.getFocus(),a=o+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i),r=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,r)}setupModel(e){this.modelDisposables.clear(),this.modelDisposables.add(e.onDidSpliceRenderedNodes(({start:r,deleteCount:o,elements:a})=>this.view.splice(r,o,a)));const t=Se.forEach(e.onDidSpliceModel,r=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(r),this.selection.onDidModelSplice(r)})},this.modelDisposables);t(()=>null,null,this.modelDisposables);const i=this.modelDisposables.add(new Z),n=this.modelDisposables.add(new HC(0));this.modelDisposables.add(Se.any(t,this.focus.onDidChange,this.selection.onDidChange)(()=>{n.trigger(()=>{const r=new Set;for(const o of this.focus.getNodes())r.add(o);for(const o of this.selection.getNodes())r.add(o);i.fire([...r.values()])})})),this.onDidChangeActiveNodesRelay.input=i.event,this.onDidChangeModelRelay.input=Se.signal(e.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=e.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=e.onDidChangeRenderNodeCount,this.onDidSpliceModelRelay.input=e.onDidSpliceModel}dispose(){var e;_n(this.disposables),(e=this.stickyScrollController)==null||e.dispose(),this.view.dispose(),this.modelDisposables.dispose()}}const Aq=new lr(()=>{const s=KC.Collator(void 0,{numeric:!0,sensitivity:"base"}).value;return{collator:s,collatorIsNumeric:s.resolvedOptions().numeric}});new lr(()=>({collator:KC.Collator(void 0,{numeric:!0}).value}));new lr(()=>({collator:KC.Collator(void 0,{numeric:!0,sensitivity:"accent"}).value}));function kMe(s,e,t=!1){const i=s||"",n=e||"",r=Aq.value.collator.compare(i,n);return Aq.value.collatorIsNumeric&&r===0&&i!==n?i<n?-1:1:r}function EMe(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),r=DMe(s,e,t);if(r)return r;const o=i.endsWith(t),a=n.endsWith(t);if(o!==a)return o?-1:1;const l=kMe(i,n);return l!==0?l:i.localeCompare(n)}function DMe(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),r=i.startsWith(t),o=n.startsWith(t);if(r!==o)return r?-1:1;if(r&&o){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}class TMe{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:le.None}}renderElement(e,t,i,n){var l;if((l=i.disposable)==null||l.dispose(),!i.data)return;const r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,i.data,n);const o=new ym,a=r.resolve(e,o.token);i.disposable={dispose:()=>o.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(c=>this.renderer.renderElement(c,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class NMe{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function IMe(s,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new NMe(s,e.accessibilityProvider)}}class RMe{constructor(e,t,i,n,r={}){this.modelDisposables=new Pe;const o=()=>this.model,a=n.map(l=>new TMe(l,o));this.list=new xl(e,t,i,a,IMe(o,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Se.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return Se.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return Se.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this.modelDisposables.clear(),this._model=e,this.list.splice(0,this.list.length,nr(e.length)),this.modelDisposables.add(e.onDidIncrementLength(t=>this.list.splice(this.list.length,0,nr(this.list.length,t))))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose(),this.modelDisposables.dispose()}}var sb=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};const AMe=!1;var Mq;(function(s){s.North="north",s.South="south",s.East="east",s.West="west"})(Mq||(Mq={}));let MMe=4;const OMe=new Z;let PMe=300;const FMe=new Z;class O8{constructor(e){this.el=e,this.disposables=new Pe}get onPointerMove(){return this.disposables.add(new jt(Ue(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new jt(Ue(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}sb([Vi],O8.prototype,"onPointerMove",null);sb([Vi],O8.prototype,"onPointerUp",null);class P8{get onPointerMove(){return this.disposables.add(new jt(this.el,hi.Change)).event}get onPointerUp(){return this.disposables.add(new jt(this.el,hi.End)).event}constructor(e){this.el=e,this.disposables=new Pe}dispose(){this.disposables.dispose()}}sb([Vi],P8.prototype,"onPointerMove",null);sb([Vi],P8.prototype,"onPointerUp",null);class b2{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}sb([Vi],b2.prototype,"onPointerMove",null);sb([Vi],b2.prototype,"onPointerUp",null);const Oq="pointer-events-disabled";class qo extends le{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}get onDidStart(){return this._onDidStart.event}get onDidChange(){return this._onDidChange.event}get onDidReset(){return this._onDidReset.event}get onDidEnd(){return this._onDidEnd.event}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=Be(this.el,Ke(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(qe(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(ie(this._orthogonalStartDragHandle,"mouseenter",()=>qo.onMouseEnter(e))),this.orthogonalStartDragHandleDisposables.add(ie(this._orthogonalStartDragHandle,"mouseleave",()=>qo.onMouseLeave(e))))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=Be(this.el,Ke(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(qe(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(ie(this._orthogonalEndDragHandle,"mouseenter",()=>qo.onMouseEnter(e))),this.orthogonalEndDragHandleDisposables.add(ie(this._orthogonalEndDragHandle,"mouseleave",()=>qo.onMouseLeave(e))))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=PMe,this.hoverDelayer=this._register(new HC(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new Z),this._onDidStart=this._register(new Z),this._onDidChange=this._register(new Z),this._onDidReset=this._register(new Z),this._onDidEnd=this._register(new Z),this.orthogonalStartSashDisposables=this._register(new Pe),this.orthogonalStartDragHandleDisposables=this._register(new Pe),this.orthogonalEndSashDisposables=this._register(new Pe),this.orthogonalEndDragHandleDisposables=this._register(new Pe),this.linkedSash=void 0,this.el=Be(e,Ke(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),_t&&this.el.classList.add("mac"),this._register(ie(this.el,"mousedown",r=>this.onPointerStart(r,new O8(e)))),this._register(ie(this.el,"dblclick",r=>this.onPointerDoublePress(r))),this._register(ie(this.el,"mouseenter",()=>qo.onMouseEnter(this))),this._register(ie(this.el,"mouseleave",()=>qo.onMouseLeave(this))),this._register(fr.addTarget(this.el)),this._register(ie(this.el,hi.Start,r=>this.onPointerStart(r,new P8(this.el))));let n;this._register(ie(this.el,hi.Tap,r=>{if(n){clearTimeout(n),n=void 0,this.onPointerDoublePress(r);return}clearTimeout(n),n=setTimeout(()=>n=void 0,250)})),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=MMe,this._register(OMe.event(r=>{this.size=r,this.layout()}))),this._register(FMe.event(r=>this.hoverDelay=r)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",AMe),this.layout()}onPointerStart(e,t){Rt.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const _=this.getOrthogonalSash(e);_&&(i=!0,e.__orthogonalSashEvent=!0,_.onPointerStart(e,new b2(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new b2(t))),!this.state)return;const n=this.el.ownerDocument.getElementsByTagName("iframe");for(const _ of n)_.classList.add(Oq);const r=e.pageX,o=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:o,currentY:o,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=bl(this.el),h=()=>{let _="";i?_="all-scroll":this.orientation===1?this.state===1?_="s-resize":this.state===2?_="n-resize":_=_t?"row-resize":"ns-resize":this.state===1?_="e-resize":this.state===2?_="w-resize":_=_t?"col-resize":"ew-resize",c.textContent=`* { cursor: ${_} !important; }`},d=new Pe;h(),i||this.onDidEnablementChange.event(h,null,d);const g=_=>{Rt.stop(_,!1);const b={startX:r,currentX:_.pageX,startY:o,currentY:_.pageY,altKey:a};this._onDidChange.fire(b)},p=_=>{Rt.stop(_,!1),c.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),d.dispose();for(const b of n)b.classList.remove(Oq)};t.onPointerMove(g,null,d),t.onPointerUp(p,null,d),d.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&qo.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&qo.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){qo.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){const t=e.initialTarget??e.target;if(!(!t||!nn(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const BMe={separatorBorder:me.transparent};class oie{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){var i,n;if(e!==this.visible){e?(this.size=xr(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{(n=(i=this.view).setVisible)==null||n.call(i,e)}catch(r){console.error("Splitview: Failed to set visible view"),console.error(r)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}}class VMe extends oie{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class HMe extends oie{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var gu;(function(s){s[s.Idle=0]="Idle",s[s.Busy=1]="Busy"})(gu||(gu={}));var Pq;(function(s){s.Distribute={type:"distribute"};function e(n){return{type:"split",index:n}}s.Split=e;function t(n){return{type:"auto",index:n}}s.Auto=t;function i(n){return{type:"invisible",cachedVisibleSize:n}}s.Invisible=i})(Pq||(Pq={}));class WMe extends le{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=gu.Idle,this._onDidSashChange=this._register(new Z),this._onDidSashReset=this._register(new Z),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=Be(this.el,Ke(".sash-container")),this.viewContainer=Ke(".split-view-container"),this.scrollable=this._register(new eb({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>Ar(Ue(this.el),n)})),this.scrollableElement=this._register(new HD(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));const i=this._register(new jt(this.viewContainer,"scroll")).event;this._register(i(n=>{const r=this.scrollableElement.getScrollPosition(),o=Math.abs(this.viewContainer.scrollLeft-r.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-r.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(o!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:o,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),Be(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||BMe),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,r)=>{const o=yo(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,o,r,!0)}),this._contentSize=this.viewItems.reduce((n,r)=>n+r.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"?n+=a:e-=o.size}for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&n>0&&(o.size=xr(Math.round(a*e/n),o.minimumSize,o.maximumSize))}}else{const n=nr(this.viewItems.length),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,r,o)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const n=this.sashItems.findIndex(a=>a.sash===e),r=nc(ie(this.el.ownerDocument.body,"keydown",a=>o(this.sashDragState.current,a.altKey)),ie(this.el.ownerDocument.body,"keyup",()=>o(this.sashDragState.current,!1))),o=(a,l)=>{const c=this.viewItems.map(_=>_.size);let h=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){const b=this.viewItems[n];h=(b.minimumSize-b.size)/2,d=(b.maximumSize-b.size)/2}else{const b=this.viewItems[n+1];h=(b.size-b.maximumSize)/2,d=(b.size-b.minimumSize)/2}let g,p;if(!l){const _=nr(n,-1),b=nr(n+1,this.viewItems.length),C=_.reduce((A,M)=>A+(this.viewItems[M].minimumSize-c[M]),0),x=_.reduce((A,M)=>A+(this.viewItems[M].viewMaximumSize-c[M]),0),S=b.length===0?Number.POSITIVE_INFINITY:b.reduce((A,M)=>A+(c[M]-this.viewItems[M].minimumSize),0),y=b.length===0?Number.NEGATIVE_INFINITY:b.reduce((A,M)=>A+(c[M]-this.viewItems[M].viewMaximumSize),0),k=Math.max(C,y),D=Math.min(S,x),R=this.findFirstSnapIndex(_),N=this.findFirstSnapIndex(b);if(typeof R=="number"){const A=this.viewItems[R],M=Math.floor(A.viewMinimumSize/2);g={index:R,limitDelta:A.visible?k-M:k+M,size:A.size}}if(typeof N=="number"){const A=this.viewItems[N],M=Math.floor(A.viewMinimumSize/2);p={index:N,limitDelta:A.visible?D+M:D-M,size:A.size}}}this.sashDragState={start:a,current:a,index:n,sizes:c,minDelta:h,maxDelta:d,alt:l,snapBefore:g,snapAfter:p,disposable:r}};o(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:r,minDelta:o,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const h=e-i,d=this.resize(t,h,n,void 0,void 0,o,a,l,c);if(r){const g=t===this.sashItems.length-1,p=this.viewItems.map(y=>y.size),_=g?t:t+1,b=this.viewItems[_],C=b.size-b.maximumSize,x=b.size-b.minimumSize,S=g?t-1:t+1;this.resize(S,-d,p,void 0,void 0,C,x)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=xr(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==gu.Idle)throw new Error("Cant modify splitview");this.state=gu.Busy;try{const i=nr(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],r=i.filter(a=>this.viewItems[a].priority===2),o=this.viewItems[e];t=Math.round(t),t=xr(t,o.minimumSize,Math.min(o.maximumSize,this.size)),o.size=t,this.relayout(n,r)}finally{this.state=gu.Idle}}}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=xr(i,a.minimumSize,a.maximumSize);const n=nr(this.viewItems.length),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);this.relayout(r,o)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==gu.Idle)throw new Error("Cant modify splitview");this.state=gu.Busy;try{const r=Ke(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(i));const o=e.onDidChange(g=>this.onViewChange(h,g)),a=qe(()=>r.remove()),l=nc(o,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const h=this.orientation===0?new VMe(r,e,c,l):new HMe(r,e,c,l);if(this.viewItems.splice(i,0,h),this.viewItems.length>1){const g={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},p=this.orientation===0?new qo(this.sashContainer,{getHorizontalSashTop:A=>this.getSashPosition(A),getHorizontalSashWidth:this.getSashOrthogonalSize},{...g,orientation:1}):new qo(this.sashContainer,{getVerticalSashLeft:A=>this.getSashPosition(A),getVerticalSashHeight:this.getSashOrthogonalSize},{...g,orientation:0}),_=this.orientation===0?A=>({sash:p,start:A.startY,current:A.currentY,alt:A.altKey}):A=>({sash:p,start:A.startX,current:A.currentX,alt:A.altKey}),C=Se.map(p.onDidStart,_)(this.onSashStart,this),S=Se.map(p.onDidChange,_)(this.onSashChange,this),k=Se.map(p.onDidEnd,()=>this.sashItems.findIndex(A=>A.sash===p))(this.onSashEnd,this),D=p.onDidReset(()=>{const A=this.sashItems.findIndex(U=>U.sash===p),M=nr(A,-1),O=nr(A+1,this.viewItems.length),V=this.findFirstSnapIndex(M),H=this.findFirstSnapIndex(O);typeof V=="number"&&!this.viewItems[V].visible||typeof H=="number"&&!this.viewItems[H].visible||this._onDidSashReset.fire(A)}),R=nc(C,S,k,D,p),N={sash:p,disposable:R};this.sashItems.splice(i-1,0,N)}r.appendChild(e.element);let d;typeof t!="number"&&t.type==="split"&&(d=[t.index]),n||this.relayout([i],d),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=gu.Idle}}relayout(e,t){const i=this.viewItems.reduce((n,r)=>n+r.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(h=>h.size),n,r,o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const h=nr(e,-1),d=nr(e+1,this.viewItems.length);if(r)for(const N of r)QI(h,N),QI(d,N);if(n)for(const N of n)VS(h,N),VS(d,N);const g=h.map(N=>this.viewItems[N]),p=h.map(N=>i[N]),_=d.map(N=>this.viewItems[N]),b=d.map(N=>i[N]),C=h.reduce((N,A)=>N+(this.viewItems[A].minimumSize-i[A]),0),x=h.reduce((N,A)=>N+(this.viewItems[A].maximumSize-i[A]),0),S=d.length===0?Number.POSITIVE_INFINITY:d.reduce((N,A)=>N+(i[A]-this.viewItems[A].minimumSize),0),y=d.length===0?Number.NEGATIVE_INFINITY:d.reduce((N,A)=>N+(i[A]-this.viewItems[A].maximumSize),0),k=Math.max(C,y,o),D=Math.min(S,x,a);let R=!1;if(l){const N=this.viewItems[l.index],A=t>=l.limitDelta;R=A!==N.visible,N.setVisible(A,l.size)}if(!R&&c){const N=this.viewItems[c.index],A=t<c.limitDelta;R=A!==N.visible,N.setVisible(A,c.size)}if(R)return this.resize(e,t,i,n,r,o,a);t=xr(t,k,D);for(let N=0,A=t;N<g.length;N++){const M=g[N],O=xr(p[N]+A,M.minimumSize,M.maximumSize),V=O-p[N];A-=V,M.size=O}for(let N=0,A=t;N<_.length;N++){const M=_[N],O=xr(b[N]-A,M.minimumSize,M.maximumSize),V=O-b[N];A+=V,M.size=O}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const n=nr(this.viewItems.length-1,-1),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);for(const a of o)QI(n,a);for(const a of r)VS(n,a);typeof e=="number"&&VS(n,e);for(let a=0;i!==0&&a<n.length;a++){const l=this.viewItems[n[a]],c=xr(l.size+i,l.minimumSize,l.maximumSize),h=c-l.size;i-=h,l.size=c}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;const r=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const o=n.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],h=this.viewItems[l];a+=h.size;const d=!(t[l]&&o[l+1]),g=!(i[l]&&r[l+1]);if(d&&g){const p=nr(l,-1),_=nr(l+1,this.viewItems.length),b=this.findFirstSnapIndex(p),C=this.findFirstSnapIndex(_),x=typeof b=="number"&&!this.viewItems[b].visible,S=typeof C=="number"&&!this.viewItems[C].visible;x&&r[l]&&(a>0||this.startSnappingEnabled)?c.state=1:S&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else d&&!g?c.state=1:!d&&g?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){var e;(e=this.sashDragState)==null||e.disposable.dispose(),_n(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}}const SE=class SE{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=SE.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map(r=>[r.templateId,r]));this.renderers=[];for(const r of e){const o=n.get(r.templateId);if(!o)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(o)}}renderTemplate(e){const t=Be(e,Ke(".monaco-table-tr")),i=[],n=[];for(let o=0;o<this.columns.length;o++){const a=this.renderers[o],l=Be(t,Ke(".monaco-table-td",{"data-col-index":o}));l.style.width=`${this.getColumnSize(o)}px`,i.push(l),n.push(a.renderTemplate(l))}const r={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(r),r}renderElement(e,t,i,n){for(let r=0;r<this.columns.length;r++){const a=this.columns[r].project(e);this.renderers[r].renderElement(a,t,i.cellTemplateData[r],n)}}disposeElement(e,t,i,n){for(let r=0;r<this.columns.length;r++){const o=this.renderers[r];if(o.disposeElement){const l=this.columns[r].project(e);o.disposeElement(l,t,i.cellTemplateData[r],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);_l(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}};SE.TemplateId="row";let w2=SE;function zMe(s){return{getHeight(e){return s.getHeight(e)},getTemplateId(){return w2.TemplateId}}}class UMe extends le{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??Se.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new Z,this.onDidLayout=this._onDidLayout.event,this.element=Ke(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register(Sl().setupManagedHover(jd("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}const xE=class xE{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,n,r,o){this.virtualDelegate=i,this.columns=n,this.domId=`table_id_${++xE.InstanceCount}`,this.disposables=new Pe,this.cachedWidth=0,this.cachedHeight=0,this.domNode=Be(t,Ke(`.monaco-table.${this.domId}`));const a=n.map((h,d)=>this.disposables.add(new UMe(h,d))),l={size:a.reduce((h,d)=>h+d.column.weight,0),views:a.map(h=>({size:h.column.weight,view:h}))};this.splitview=this.disposables.add(new WMe(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new w2(n,r,h=>this.splitview.getViewSize(h));this.list=this.disposables.add(new xl(e,this.domNode,zMe(i),[c],o)),Se.any(...a.map(h=>h.onDidLayout))(([h,d])=>c.layoutColumn(h,d),null,this.disposables),this.splitview.onDidSashReset(h=>{const d=n.reduce((p,_)=>p+_.weight,0),g=n[h].weight/d*this.cachedWidth;this.splitview.resizeView(h,g)},null,this.disposables),this.styleElement=bl(this.domNode),this.style(HRe)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}};xE.InstanceCount=0;let o3=xE;class F8{constructor(e,t={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new uMe(e,null,t),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,t.sorter&&(this.sorter={compare(i,n){return t.sorter.compare(i.element,n.element)}}),this.identityProvider=t.identityProvider}setChildren(e,t=Dt.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=Dt.empty(),i){const n=new Set,r=new Set,o=l=>{var h;if(l.element===null)return;const c=l;if(n.add(c.element),this.nodes.set(c.element,c),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();r.add(d),this.nodesByIdentity.set(d,c)}(h=i.onDidCreateNode)==null||h.call(i,c)},a=l=>{var h;if(l.element===null)return;const c=l;if(n.has(c.element)||this.nodes.delete(c.element),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();r.has(d)||this.nodesByIdentity.delete(d)}(h=i.onDidDeleteNode)==null||h.call(i,c)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:o,onDidDeleteNode:a})}preserveCollapseState(e=Dt.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Dt.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const o=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(o)}if(!i){let o;return typeof t.collapsed>"u"?o=void 0:t.collapsed===ho.Collapsed||t.collapsed===ho.PreserveOrCollapsed?o=!0:t.collapsed===ho.Expanded||t.collapsed===ho.PreserveOrExpanded?o=!1:o=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:o}}const n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let r;return typeof t.collapsed>"u"||t.collapsed===ho.PreserveOrCollapsed||t.collapsed===ho.PreserveOrExpanded?r=i.collapsed:t.collapsed===ho.Collapsed?r=!0:t.collapsed===ho.Expanded?r=!1:r=!!t.collapsed,{...t,collapsible:n,collapsed:r,children:this.preserveCollapseState(t.children)}})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}resort(e=null,t=!0){if(!this.sorter)return;const i=this.getElementLocation(e),n=this.model.getNode(i);this._setChildren(i,this.resortChildren(n,t),{})}resortChildren(e,t,i=!0){let n=[...e.children];return(t||i)&&(n=n.sort(this.sorter.compare.bind(this.sorter))),Dt.map(n,r=>({element:r.element,collapsible:r.collapsible,collapsed:r.collapsed,children:this.resortChildren(r,t,!1)}))}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new wo(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new wo(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new wo(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new wo(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function cL(s){const e=[s.element],t=s.incompressible||!1;return{element:{elements:e,incompressible:t},children:Dt.map(Dt.from(s.children),cL),collapsible:s.collapsible,collapsed:s.collapsed}}function uL(s){const e=[s.element],t=s.incompressible||!1;let i,n;for(;[n,i]=Dt.consume(Dt.from(s.children),2),!(n.length!==1||n[0].incompressible);)s=n[0],e.push(s.element);return{element:{elements:e,incompressible:t},children:Dt.map(Dt.concat(n,i),uL),collapsible:s.collapsible,collapsed:s.collapsed}}function a3(s,e=0){let t;return e<s.element.elements.length-1?t=[a3(s,e+1)]:t=Dt.map(Dt.from(s.children),i=>a3(i,0)),e===0&&s.element.incompressible?{element:s.element.elements[e],children:t,incompressible:!0,collapsible:s.collapsible,collapsed:s.collapsed}:{element:s.element.elements[e],children:t,collapsible:s.collapsible,collapsed:s.collapsed}}function Fq(s){return a3(s,0)}function aie(s,e,t){return s.element===e?{...s,children:t}:{...s,children:Dt.map(Dt.from(s.children),i=>aie(i,e,t))}}const jMe=s=>({getId(e){return e.elements.map(t=>s.getId(t).toString()).join("\0")}});class $Me{get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new F8(e,t),this.enabled=typeof t.compressionEnabled>"u"?!0:t.compressionEnabled,this.identityProvider=t.identityProvider}setChildren(e,t=Dt.empty(),i){const n=i.diffIdentityProvider&&jMe(i.diffIdentityProvider);if(e===null){const _=Dt.map(t,this.enabled?uL:cL);this._setChildren(null,_,{diffIdentityProvider:n,diffDepth:1/0});return}const r=this.nodes.get(e);if(!r)throw new wo(this.user,"Unknown compressed tree node");const o=this.model.getNode(r),a=this.model.getParentNodeLocation(r),l=this.model.getNode(a),c=Fq(o),h=aie(c,e,t),d=(this.enabled?uL:cL)(h),g=i.diffIdentityProvider?((_,b)=>i.diffIdentityProvider.getId(_)===i.diffIdentityProvider.getId(b)):void 0;if(Sn(d.element.elements,o.element.elements,g)){this._setChildren(r,d.children||Dt.empty(),{diffIdentityProvider:n,diffDepth:1});return}const p=l.children.map(_=>_===o?d:_);this._setChildren(l.element,p,{diffIdentityProvider:n,diffDepth:o.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,n=Dt.map(i,Fq),r=Dt.map(n,e?uL:cL);this._setChildren(null,r,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const n=new Set,r=a=>{for(const l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},o=a=>{for(const l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:r,onDidDeleteNode:o})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}resort(e=null,t=!0){const i=this.getCompressedNode(e);this.model.resort(i,t)}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new wo(this.user,`Tree element not found: ${e}`);return t}}const qMe=s=>s[s.length-1];class B8{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new B8(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function GMe(s,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(s(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){const n=t.elements;for(let r=0;r<n.length-1;r++){const o=e.filter.filter(n[r],i);i=mm(hy(o)?o.visibility:o)}return e.filter.filter(n[n.length-1],i)}}}}class KMe{get onDidSpliceModel(){return Se.map(this.model.onDidSpliceModel,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidSpliceRenderedNodes(){return Se.map(this.model.onDidSpliceRenderedNodes,({start:e,deleteCount:t,elements:i})=>({start:e,deleteCount:t,elements:i.map(n=>this.nodeMapper.map(n))}))}get onDidChangeCollapseState(){return Se.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return Se.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t={}){this.rootRef=null,this.elementMapper=t.elementMapper||qMe;const i=n=>this.elementMapper(n.elements);this.nodeMapper=new A8(n=>new B8(i,n)),this.model=new $Me(e,GMe(i,t))}setChildren(e,t=Dt.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}resort(e=null,t=!0){return this.model.resort(e,t)}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var YMe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class V8 extends rie{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,n,r={}){super(e,t,i,n,r),this.user=e}setChildren(e,t=Dt.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}resort(e,t=!0){this.model.resort(e,t)}hasElement(e){return this.model.has(e)}createModel(e,t){return new F8(e,t)}}class lie{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t,i){this._compressedTreeNodeProvider=e,this.stickyScrollDelegate=t,this.renderer=i,this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let r=this.stickyScrollDelegate.getCompressedNode(e);r||(r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),r.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,i.data,n))}disposeElement(e,t,i,n){var r,o,a,l;i.compressedTreeNode?(o=(r=this.renderer).disposeCompressedElements)==null||o.call(r,i.compressedTreeNode,t,i.data,n):(l=(a=this.renderer).disposeElement)==null||l.call(a,e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){var i,n;return((n=(i=this.renderer).renderTwistie)==null?void 0:n.call(i,e,t))??!1}}YMe([Vi],lie.prototype,"compressedTreeNodeProvider",null);class QMe{constructor(e){this.modelProvider=e,this.compressedStickyNodes=new Map}getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){const r=e[n],o=r.position+r.height;if(n+1<e.length&&o+e[n+1].height>i||n>=t-1&&t<e.length){const l=e.slice(0,n),c=e.slice(n),h=this.compressStickyNodes(c);return[...l,h]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");const t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];const i=[];for(let c=0;c<e.length;c++){const h=e[c],d=t.getCompressedTreeNode(h.node.element);if(d.element){if(c!==0&&d.element.incompressible)break;i.push(...d.element.elements)}}if(i.length<2)return e[0];const n=e[e.length-1],r={elements:i,incompressible:!1},o={...n.node,children:[],element:r},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,o),l}}function XMe(s,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=s().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}class cie extends V8{constructor(e,t,i,n,r={}){const o=()=>this,a=new QMe(()=>this.model),l=n.map(c=>new lie(o,a,c));super(e,t,i,l,{...XMe(o,r),stickyScrollDelegate:a})}setChildren(e,t=Dt.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t){return new KMe(e,t)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}function wA(s){return{...s,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function l3(s,e){return e.parent?e.parent===s?!0:l3(s,e.parent):!1}function ZMe(s,e){return s===e||l3(s,e)||l3(e,s)}class H8{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new H8(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class JMe{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ct.asClassNameArray(Ae.treeItemLoading)),!0):(t.classList.remove(...Ct.asClassNameArray(Ae.treeItemLoading)),!1)}disposeElement(e,t,i,n){var r,o;(o=(r=this.renderer).disposeElement)==null||o.call(r,this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function Bq(s){return{browserEvent:s.browserEvent,elements:s.elements.map(e=>e.element)}}function Vq(s){return{browserEvent:s.browserEvent,element:s.element&&s.element.element,target:s.target}}class e4e extends oy{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function vA(s){return s instanceof oy?new e4e(s):s}class t4e{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,vA(e),t)}onDragOver(e,t,i,n,r,o=!0){return this.dnd.onDragOver(vA(e),t&&t.element,i,n,r)}drop(e,t,i,n,r){this.dnd.drop(vA(e),t&&t.element,i,n,r)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.dnd.dispose()}}class i4e extends iie{constructor(e,t,i){super(t,i),this.findProvider=e,this.isFindSessionActive=!1}filter(e,t){const i=super.filter(e,t);if(!this.isFindSessionActive||this.findMode===vo.Highlight||!this.findProvider.isVisible)return i;const n=hy(i)?i.visibility:i;return mm(n)===0?0:this.findProvider.isVisible(e)?i:0}}class n4e extends nie{constructor(e,t,i,n,r){super(e,i,n,r),this.findProvider=t,this.filter=i,this.activeSession=!1,this.asyncWorkInProgress=!1,this.disposables.add(qe(async()=>{var o,a;this.activeSession&&await((a=(o=this.findProvider).endSession)==null?void 0:a.call(o))}))}render(){if(this.asyncWorkInProgress||!this.activeFindMetadata)return;const e=this.activeFindMetadata.matchCount===0&&this.pattern.length>0;this.renderMessage(e),this.pattern.length&&this.alertResults(this.activeFindMetadata.matchCount)}shouldAllowFocus(e){return this.shouldFocusWhenNavigating(e)}shouldFocusWhenNavigating(e){var i;if(!this.activeSession||!this.activeFindMetadata)return!0;const t=(i=e.element)==null?void 0:i.element;return t&&this.activeFindMetadata.isMatch(t)?!0:!Ng.isDefault(e.filterData)}}function uie(s){return s&&{...s,collapseByDefault:!0,identityProvider:s.identityProvider&&{getId(e){return s.identityProvider.getId(e.element)}},dnd:s.dnd&&new t4e(s.dnd),multipleSelectionController:s.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return s.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return s.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:s.accessibilityProvider&&{...s.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:s.accessibilityProvider.getRole?e=>s.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:s.accessibilityProvider.isChecked?e=>{var t;return!!((t=s.accessibilityProvider)!=null&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return s.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return s.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:s.accessibilityProvider.getWidgetRole?()=>s.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:s.accessibilityProvider.getAriaLevel&&(e=>s.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:s.accessibilityProvider.getActiveDescendantId&&(e=>s.accessibilityProvider.getActiveDescendantId(e.element))},filter:s.filter&&{filter(e,t){return s.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:s.keyboardNavigationLabelProvider&&{...s.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return s.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof s.expandOnlyOnTwistieClick>"u"?void 0:typeof s.expandOnlyOnTwistieClick!="function"?s.expandOnlyOnTwistieClick:(e=>s.expandOnlyOnTwistieClick(e.element)),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof s.defaultFindVisibility=="number"?s.defaultFindVisibility:typeof s.defaultFindVisibility>"u"?2:s.defaultFindVisibility(e.element),stickyScrollDelegate:s.stickyScrollDelegate}}function c3(s,e){e(s),s.children.forEach(t=>c3(t,e))}class hie{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return Se.map(this.tree.onDidChangeFocus,Bq)}get onDidChangeSelection(){return Se.map(this.tree.onDidChangeSelection,Bq)}get onMouseDblClick(){return Se.map(this.tree.onMouseDblClick,Vq)}get onPointer(){return Se.map(this.tree.onPointer,Vq)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,n,r,o={}){this.user=e,this.dataSource=r,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new Z,this._onDidChangeNodeSlowState=new Z,this.nodeMapper=new A8(c=>new H8(c)),this.disposables=new Pe,this.identityProvider=o.identityProvider,this.autoExpandSingleChildren=typeof o.autoExpandSingleChildren>"u"?!1:o.autoExpandSingleChildren,this.sorter=o.sorter,this.getDefaultCollapseState=c=>o.collapseByDefault?o.collapseByDefault(c)?ho.PreserveOrCollapsed:ho.PreserveOrExpanded:void 0;let a=!1,l;if(o.findProvider&&(o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider&&(a=!0,l=new i4e(o.findProvider,o.keyboardNavigationLabelProvider,o.filter)),this.tree=this.createTree(e,t,i,n,{...o,findWidgetEnabled:!a,filter:l??o.filter}),this.root=wA({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables),a){const c={styles:o.findWidgetStyles,showNotFoundMessage:o.showNotFoundMessage,defaultFindMatchType:o.defaultFindMatchType,defaultFindMode:o.defaultFindMode};this.findController=this.disposables.add(new n4e(this.tree,o.findProvider,l,this.tree.options.contextViewProvider,c)),this.focusNavigationFilter=h=>this.findController.shouldFocusWhenNavigating(h),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindOpenState=this.tree.onDidChangeFindOpenState,this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType}createTree(e,t,i,n,r){const o=new M8(i),a=n.map(c=>new JMe(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=uie(r)||{};return new V8(e,t,o,a,l)}updateOptions(e={}){this.findController&&(e.defaultFindMode!==void 0&&(this.findController.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.findController.matchType=e.defaultFindMatchType)),this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.cancelAllRefreshPromises(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}cancelAllRefreshPromises(e=!1){this.refreshPromises.forEach(t=>t.cancel()),this.refreshPromises.clear(),e&&(this.subTreeRefreshPromises.forEach(t=>t.cancel()),this.subTreeRefreshPromises.clear())}async _updateChildren(e=this.root.element,t=!0,i=!1,n,r){if(typeof this.root.element>"u")throw new wo(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await Se.toPromise(this._onDidRender.event));const o=this.getDataNode(e);if(await this.refreshAndRenderNode(o,t,n,r),i)try{this.tree.rerender(o)}catch{}}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new wo(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await Se.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await i.refreshPromise,await Se.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await i.refreshPromise,await Se.toPromise(this._onDidRender.event)),n}setSelection(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){var i;const t=this.nodes.get(e===this.root.element?null:e);if(!t){const n=(i=this.identityProvider)==null?void 0:i.getId(e).toString();throw new wo(this.user,`Data tree node not found${n?`: ${n}`:""}`)}return t}async refreshAndRenderNode(e,t,i,n){this.disposables.isDisposed||(await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n))}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((r,o)=>{!n&&ZMe(o,e)&&(n=r.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){const n=v4(async()=>{const r=await this.doRefreshNode(e,t,i);e.stale=!1,await Lv.settled(r.map(o=>this.doRefreshSubTree(o,t,i)))});return e.refreshPromise=n,this.subTreeRefreshPromises.set(e,n),n.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)}),n}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(Dt.empty());else{const r=this.doGetChildren(e);if(oM(r))n=Promise.resolve(r);else{const o=v1(800);o.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=r.finally(()=>o.cancel())}}try{const r=await n;return this.setChildren(e,r,t,i)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),OC(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return oM(i)?this.processChildren(i):(t=v4(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch($t))}setChildren(e,t,i,n){const r=[...t];if(e.children.length===0&&r.length===0)return[];const o=new Map,a=new Map;for(const h of e.children)o.set(h.element,h),this.identityProvider&&a.set(h.id,{node:h,collapsed:this.tree.hasElement(h)&&this.tree.isCollapsed(h)});const l=[],c=r.map(h=>{const d=!!this.dataSource.hasChildren(h);if(!this.identityProvider){const b=wA({element:h,parent:e,hasChildren:d,defaultCollapseState:this.getDefaultCollapseState(h)});return d&&b.defaultCollapseState===ho.PreserveOrExpanded&&l.push(b),b}const g=this.identityProvider.getId(h).toString(),p=a.get(g);if(p){const b=p.node;return o.delete(b.element),this.nodes.delete(b.element),this.nodes.set(h,b),b.element=h,b.hasChildren=d,i?p.collapsed?(b.children.forEach(C=>c3(C,x=>this.nodes.delete(x.element))),b.children.splice(0,b.children.length),b.stale=!0):l.push(b):d&&!p.collapsed&&l.push(b),b}const _=wA({element:h,parent:e,id:g,hasChildren:d,defaultCollapseState:this.getDefaultCollapseState(h)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(g)>-1&&n.focus.push(_),n&&n.viewState.selection&&n.viewState.selection.indexOf(g)>-1&&n.selection.push(_),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(g)>-1||d&&_.defaultCollapseState===ho.PreserveOrExpanded)&&l.push(_),_});for(const h of o.values())c3(h,d=>this.nodes.delete(d.element));for(const h of c)this.nodes.set(h.element,h);return GL(e.children,0,e.children.length,c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].forceExpanded=!0,l.push(c[0])),l}render(e,t,i){const n=e.children.map(o=>this.asTreeElement(o,t)),r=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(o){return i.diffIdentityProvider.getId(o.element)}}};this.tree.setChildren(e===this.root?null:e,n,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?Dt.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class W8{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new W8(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class s4e{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ct.asClassNameArray(Ae.treeItemLoading)),!0):(t.classList.remove(...Ct.asClassNameArray(Ae.treeItemLoading)),!1)}disposeElement(e,t,i,n){var r,o;(o=(r=this.renderer).disposeElement)==null||o.call(r,this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){var r,o;(o=(r=this.renderer).disposeCompressedElements)==null||o.call(r,this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=_n(this.disposables)}}function r4e(s){const e=s&&uie(s);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return s.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}},stickyScrollDelegate:e.stickyScrollDelegate}}class o4e extends hie{constructor(e,t,i,n,r,o,a={}){super(e,t,i,r,o,a),this.compressionDelegate=n,this.compressibleNodeMapper=new A8(l=>new W8(l)),this.filter=a.filter}createTree(e,t,i,n,r){const o=new M8(i),a=n.map(c=>new s4e(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=r4e(r)||{};return new cie(e,t,o,a,l)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const n=p=>this.identityProvider.getId(p).toString(),r=p=>{const _=new Set;for(const b of p){const C=this.tree.getCompressedTreeNode(b===this.root?null:b);if(C.element)for(const x of C.element.elements)_.add(n(x.element))}return _},o=r(this.tree.getSelection()),a=r(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let c=!1;const h=this.getFocus();let d=!1;const g=p=>{const _=p.element;if(_)for(let b=0;b<_.elements.length;b++){const C=n(_.elements[b].element),x=_.elements[_.elements.length-1].element;o.has(C)&&l.indexOf(x)===-1&&(l.push(x),c=!0),a.has(C)&&h.indexOf(x)===-1&&(h.push(x),d=!0)}p.children.forEach(g)};g(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(l),d&&this.setFocus(h)}processChildren(e){return this.filter&&(e=Dt.filter(e,t=>{const i=this.filter.filter(t,1),n=a4e(i);if(n===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return n===1})),super.processChildren(e)}}function a4e(s){return typeof s=="boolean"?s?1:0:hy(s)?mm(s.visibility):mm(s)}class l4e extends rie{constructor(e,t,i,n,r,o={}){super(e,t,i,n,o),this.user=e,this.dataSource=r,this.identityProvider=o.identityProvider}createModel(e,t){return new F8(e,t)}}new He("isMac",_t,v(1684,"Whether the operating system is macOS"));new He("isLinux",Gr,v(1685,"Whether the operating system is Linux"));new He("isWindows",Rr,v(1686,"Whether the operating system is Windows"));new He("isWeb",oh,v(1687,"Whether the platform is a web browser"));new He("isMacNative",_t&&!oh,v(1688,"Whether the operating system is macOS on a non-browser platform"));new He("isIOS",gc,v(1689,"Whether the operating system is iOS"));new He("isMobile",uX,v(1690,"Whether the platform is a mobile web browser"));new He("isDevelopment",!1,!0);new He("productQualityType","",v(1691,"Quality type of VS Code"));const die="inputFocus",fie=new He(die,!1,v(1692,"Whether keyboard focus is inside an input box"));var dh=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},gi=function(s,e){return function(t,i){e(t,i,s)}};const Dc=gt("listService");class c4e{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new Pe,this.lists=[],this._lastFocusedWidget=void 0}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&((t=this._lastFocusedWidget)==null||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,(i=this._lastFocusedWidget)==null||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this.lists.some(n=>n.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),c7(e.getHTMLElement())&&this.setLastFocusedList(e),nc(e.onDidFocus(()=>this.setLastFocusedList(e)),qe(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(n=>n!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const gC=new He("listScrollAtBoundary","none");xt.or(gC.isEqualTo("top"),gC.isEqualTo("both"));xt.or(gC.isEqualTo("bottom"),gC.isEqualTo("both"));const gie=new He("listFocus",!0),mie=new He("treestickyScrollFocused",!1),eT=new He("listSupportsMultiselect",!0);xt.and(gie,xt.not(die),mie.negate());const z8=new He("listHasSelectionOrFocus",!1),U8=new He("listDoubleSelection",!1),j8=new He("listMultiSelection",!1),tT=new He("listSelectionNavigation",!1),u4e=new He("listSupportsFind",!0),h4e=new He("treeElementCanCollapse",!1),d4e=new He("treeElementHasParent",!1),f4e=new He("treeElementCanExpand",!1),g4e=new He("treeElementHasChild",!1),m4e=new He("treeFindOpen",!1),pie="listTypeNavigationMode",_ie="listAutomaticKeyboardNavigation";function iT(s,e){const t=s.createScoped(e.getHTMLElement());return gie.bindTo(t),t}function nT(s,e){const t=gC.bindTo(s),i=()=>{const n=e.scrollTop===0,r=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&r?t.set("both"):n?t.set("top"):r?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const Fm="workbench.list.multiSelectModifier",hL="workbench.list.openMode",aa="workbench.list.horizontalScrolling",$8="workbench.list.defaultFindMode",q8="workbench.list.typeNavigationMode",v2="workbench.list.keyboardNavigation",Cl="workbench.list.scrollByPage",G8="workbench.list.defaultFindMatchType",mC="workbench.tree.indent",C2="workbench.tree.renderIndentGuides",yl="workbench.list.smoothScrolling",Cc="workbench.list.mouseWheelScrollSensitivity",yc="workbench.list.fastScrollSensitivity",y2="workbench.tree.expandMode",S2="workbench.tree.enableStickyScroll",x2="workbench.tree.stickyScrollMaxItemCount";function Sc(s){return s.getValue(Fm)==="alt"}class p4e extends le{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Sc(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Fm)&&(this.useAltAsMultipleSelectionModifier=Sc(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:Bte(e)}isSelectionRangeChangeEvent(e){return Vte(e)}}function sT(s,e){const t=s.get(yi),i=s.get(rs),n=new Pe;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(o){return i.mightProducePrintableCharacter(o)}},smoothScrolling:!!t.getValue(yl),mouseWheelScrollSensitivity:t.getValue(Cc),fastScrollSensitivity:t.getValue(yc),multipleSelectionController:e.multipleSelectionController??n.add(new p4e(t)),keyboardNavigationEventFilter:w4e(i),scrollByPage:!!t.getValue(Cl)},n]}let Hq=class extends xl{constructor(e,t,i,n,r,o,a,l,c){const h=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(aa),[d,g]=c.invokeFunction(sT,r);super(e,t,i,n,{keyboardSupport:!1,...d,horizontalScrolling:h}),this.disposables.add(g),this.contextKeyService=iT(o,this),this.disposables.add(nT(this.contextKeyService,this)),this.listSupportsMultiSelect=eT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),tT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=z8.bindTo(this.contextKeyService),this.listDoubleSelection=U8.bindTo(this.contextKeyService),this.listMultiSelection=j8.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Sc(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const _=this.getSelection(),b=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(_.length>0||b.length>0),this.listMultiSelection.set(_.length>1),this.listDoubleSelection.set(_.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const _=this.getSelection(),b=this.getFocus();this.listHasSelectionOrFocus.set(_.length>0||b.length>0)})),this.disposables.add(l.onDidChangeConfiguration(_=>{_.affectsConfiguration(Fm)&&(this._useAltAsMultipleSelectionModifier=Sc(l));let b={};if(_.affectsConfiguration(aa)&&this.horizontalScrolling===void 0){const C=!!l.getValue(aa);b={...b,horizontalScrolling:C}}if(_.affectsConfiguration(Cl)){const C=!!l.getValue(Cl);b={...b,scrollByPage:C}}if(_.affectsConfiguration(yl)){const C=!!l.getValue(yl);b={...b,smoothScrolling:C}}if(_.affectsConfiguration(Cc)){const C=l.getValue(Cc);b={...b,mouseWheelScrollSensitivity:C}}if(_.affectsConfiguration(yc)){const C=l.getValue(yc);b={...b,fastScrollSensitivity:C}}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new bie(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?cy(e):ly)}};Hq=dh([gi(5,Ot),gi(6,Dc),gi(7,yi),gi(8,It)],Hq);let Wq=class extends RMe{constructor(e,t,i,n,r,o,a,l,c){const h=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(aa),[d,g]=c.invokeFunction(sT,r);super(e,t,i,n,{keyboardSupport:!1,...d,horizontalScrolling:h}),this.disposables=new Pe,this.disposables.add(g),this.contextKeyService=iT(o,this),this.disposables.add(nT(this.contextKeyService,this.widget)),this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=eT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),tT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this._useAltAsMultipleSelectionModifier=Sc(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(_=>{_.affectsConfiguration(Fm)&&(this._useAltAsMultipleSelectionModifier=Sc(l));let b={};if(_.affectsConfiguration(aa)&&this.horizontalScrolling===void 0){const C=!!l.getValue(aa);b={...b,horizontalScrolling:C}}if(_.affectsConfiguration(Cl)){const C=!!l.getValue(Cl);b={...b,scrollByPage:C}}if(_.affectsConfiguration(yl)){const C=!!l.getValue(yl);b={...b,smoothScrolling:C}}if(_.affectsConfiguration(Cc)){const C=l.getValue(Cc);b={...b,mouseWheelScrollSensitivity:C}}if(_.affectsConfiguration(yc)){const C=l.getValue(yc);b={...b,fastScrollSensitivity:C}}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new bie(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?cy(e):ly)}dispose(){this.disposables.dispose(),super.dispose()}};Wq=dh([gi(5,Ot),gi(6,Dc),gi(7,yi),gi(8,It)],Wq);let zq=class extends o3{constructor(e,t,i,n,r,o,a,l,c,h){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!c.getValue(aa),[g,p]=h.invokeFunction(sT,o);super(e,t,i,n,r,{keyboardSupport:!1,...g,horizontalScrolling:d}),this.disposables.add(p),this.contextKeyService=iT(a,this),this.disposables.add(nT(this.contextKeyService,this)),this.listSupportsMultiSelect=eT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),tT.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=z8.bindTo(this.contextKeyService),this.listDoubleSelection=U8.bindTo(this.contextKeyService),this.listMultiSelection=j8.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Sc(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const b=this.getSelection(),C=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(b.length>0||C.length>0),this.listMultiSelection.set(b.length>1),this.listDoubleSelection.set(b.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const b=this.getSelection(),C=this.getFocus();this.listHasSelectionOrFocus.set(b.length>0||C.length>0)})),this.disposables.add(c.onDidChangeConfiguration(b=>{b.affectsConfiguration(Fm)&&(this._useAltAsMultipleSelectionModifier=Sc(c));let C={};if(b.affectsConfiguration(aa)&&this.horizontalScrolling===void 0){const x=!!c.getValue(aa);C={...C,horizontalScrolling:x}}if(b.affectsConfiguration(Cl)){const x=!!c.getValue(Cl);C={...C,scrollByPage:x}}if(b.affectsConfiguration(yl)){const x=!!c.getValue(yl);C={...C,smoothScrolling:x}}if(b.affectsConfiguration(Cc)){const x=c.getValue(Cc);C={...C,mouseWheelScrollSensitivity:x}}if(b.affectsConfiguration(yc)){const x=c.getValue(yc);C={...C,fastScrollSensitivity:x}}Object.keys(C).length>0&&this.updateOptions(C)})),this.navigator=new _4e(this,{configurationService:c,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?cy(e):ly)}dispose(){this.disposables.dispose(),super.dispose()}};zq=dh([gi(6,Ot),gi(7,Dc),gi(8,yi),gi(9,It)],zq);class K8 extends le{constructor(e,t){super(),this.widget=e,this._onDidOpen=this._register(new Z),this.onDidOpen=this._onDidOpen.event,this._register(Se.filter(this.widget.onDidChangeSelection,i=>yu(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(hL))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(hL)&&(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(hL))!=="doubleClick")}))):this.openOnSingleClick=(t==null?void 0:t.openOnSingleClick)??!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,n=typeof t.pinned=="boolean"?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const n=t.button===1,r=!0,o=n,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const r=!1,o=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}_open(e,t,i,n,r){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:r})}}class bie extends K8{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class _4e extends K8{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class b4e extends K8{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function w4e(s){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=s.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let L2=class extends V8{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,r,o,a,l,c){const{options:h,getTypeNavigationMode:d,disposable:g}=o.invokeFunction(dy,r);super(e,t,i,n,h),this.disposables.add(g),this.internals=new _m(this,r,d,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};L2=dh([gi(5,It),gi(6,Ot),gi(7,Dc),gi(8,yi)],L2);let Uq=class extends cie{constructor(e,t,i,n,r,o,a,l,c){const{options:h,getTypeNavigationMode:d,disposable:g}=o.invokeFunction(dy,r);super(e,t,i,n,h),this.disposables.add(g),this.internals=new _m(this,r,d,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};Uq=dh([gi(5,It),gi(6,Ot),gi(7,Dc),gi(8,yi)],Uq);let jq=class extends l4e{constructor(e,t,i,n,r,o,a,l,c,h){const{options:d,getTypeNavigationMode:g,disposable:p}=a.invokeFunction(dy,o);super(e,t,i,n,r,d),this.disposables.add(p),this.internals=new _m(this,o,g,o.overrideStyles,l,c,h),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};jq=dh([gi(6,It),gi(7,Ot),gi(8,Dc),gi(9,yi)],jq);let $q=class extends hie{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,r,o,a,l,c,h){const{options:d,getTypeNavigationMode:g,disposable:p}=a.invokeFunction(dy,o);super(e,t,i,n,r,d),this.disposables.add(p),this.internals=new _m(this,o,g,o.overrideStyles,l,c,h),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};$q=dh([gi(6,It),gi(7,Ot),gi(8,Dc),gi(9,yi)],$q);let qq=class extends o4e{constructor(e,t,i,n,r,o,a,l,c,h,d){const{options:g,getTypeNavigationMode:p,disposable:_}=l.invokeFunction(dy,a);super(e,t,i,n,r,o,g),this.disposables.add(_),this.internals=new _m(this,a,p,a.overrideStyles,c,h,d),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};qq=dh([gi(7,It),gi(8,Ot),gi(9,Dc),gi(10,yi)],qq);function wie(s){const e=s.getValue($8);if(e==="highlight")return vo.Highlight;if(e==="filter")return vo.Filter;const t=s.getValue(v2);if(t==="simple"||t==="highlight")return vo.Highlight;if(t==="filter")return vo.Filter}function vie(s){const e=s.getValue(G8);if(e==="fuzzy")return ll.Fuzzy;if(e==="contiguous")return ll.Contiguous}function dy(s,e){const t=s.get(yi),i=s.get(iy),n=s.get(Ot),r=s.get(It),o=()=>{const g=n.getContextKeyValue(pie);if(g==="automatic")return Xl.Automatic;if(g==="trigger"||n.getContextKeyValue(_ie)===!1)return Xl.Trigger;const _=t.getValue(q8);if(_==="automatic")return Xl.Automatic;if(_==="trigger")return Xl.Trigger},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(aa),[l,c]=r.invokeFunction(sT,e),h=e.paddingBottom,d=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(C2);return{getTypeNavigationMode:o,disposable:c,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(mC)=="number"?t.getValue(mC):void 0,renderIndentGuides:d,smoothScrolling:!!t.getValue(yl),defaultFindMode:e.defaultFindMode??wie(t),defaultFindMatchType:e.defaultFindMatchType??vie(t),horizontalScrolling:a,scrollByPage:!!t.getValue(Cl),paddingBottom:h,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(y2)==="doubleClick",contextViewProvider:i,findWidgetStyles:sAe,enableStickyScroll:!!t.getValue(S2),stickyScrollMaxItemCount:Number(t.getValue(x2))}}}let _m=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,r,o,a){this.tree=e,this.disposables=[],this.contextKeyService=iT(r,e),this.disposables.push(nT(this.contextKeyService,e)),this.listSupportsMultiSelect=eT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),tT.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=u4e.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=z8.bindTo(this.contextKeyService),this.hasDoubleSelection=U8.bindTo(this.contextKeyService),this.hasMultiSelection=j8.bindTo(this.contextKeyService),this.treeElementCanCollapse=h4e.bindTo(this.contextKeyService),this.treeElementHasParent=d4e.bindTo(this.contextKeyService),this.treeElementCanExpand=f4e.bindTo(this.contextKeyService),this.treeElementHasChild=g4e.bindTo(this.contextKeyService),this.treeFindOpen=m4e.bindTo(this.contextKeyService),this.treeStickyScrollFocused=mie.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Sc(a),this.updateStyleOverrides(n);const c=()=>{const d=e.getFocus()[0];if(!d)return;const g=e.getNode(d);this.treeElementCanCollapse.set(g.collapsible&&!g.collapsed),this.treeElementHasParent.set(!!e.getParentElement(d)),this.treeElementCanExpand.set(g.collapsible&&g.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(d))},h=new Set;h.add(pie),h.add(_ie),this.disposables.push(this.contextKeyService,o.register(e),e.onDidChangeSelection(()=>{const d=e.getSelection(),g=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(d.length>0||g.length>0),this.hasMultiSelection.set(d.length>1),this.hasDoubleSelection.set(d.length===2)})}),e.onDidChangeFocus(()=>{const d=e.getSelection(),g=e.getFocus();this.hasSelectionOrFocus.set(d.length>0||g.length>0),c()}),e.onDidChangeCollapseState(c),e.onDidChangeModel(c),e.onDidChangeFindOpenState(d=>this.treeFindOpen.set(d)),e.onDidChangeStickyScrollFocused(d=>this.treeStickyScrollFocused.set(d)),a.onDidChangeConfiguration(d=>{let g={};if(d.affectsConfiguration(Fm)&&(this._useAltAsMultipleSelectionModifier=Sc(a)),d.affectsConfiguration(mC)){const p=a.getValue(mC);g={...g,indent:p}}if(d.affectsConfiguration(C2)&&t.renderIndentGuides===void 0){const p=a.getValue(C2);g={...g,renderIndentGuides:p}}if(d.affectsConfiguration(yl)){const p=!!a.getValue(yl);g={...g,smoothScrolling:p}}if(d.affectsConfiguration($8)||d.affectsConfiguration(v2)){const p=wie(a);g={...g,defaultFindMode:p}}if(d.affectsConfiguration(q8)||d.affectsConfiguration(v2)){const p=i();g={...g,typeNavigationMode:p}}if(d.affectsConfiguration(G8)){const p=vie(a);g={...g,defaultFindMatchType:p}}if(d.affectsConfiguration(aa)&&t.horizontalScrolling===void 0){const p=!!a.getValue(aa);g={...g,horizontalScrolling:p}}if(d.affectsConfiguration(Cl)){const p=!!a.getValue(Cl);g={...g,scrollByPage:p}}if(d.affectsConfiguration(y2)&&t.expandOnlyOnTwistieClick===void 0&&(g={...g,expandOnlyOnTwistieClick:a.getValue(y2)==="doubleClick"}),d.affectsConfiguration(S2)){const p=a.getValue(S2);g={...g,enableStickyScroll:p}}if(d.affectsConfiguration(x2)){const p=Math.max(1,a.getValue(x2));g={...g,stickyScrollMaxItemCount:p}}if(d.affectsConfiguration(Cc)){const p=a.getValue(Cc);g={...g,mouseWheelScrollSensitivity:p}}if(d.affectsConfiguration(yc)){const p=a.getValue(yc);g={...g,fastScrollSensitivity:p}}Object.keys(g).length>0&&e.updateOptions(g)}),this.contextKeyService.onDidChangeContext(d=>{d.affectsSome(h)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new b4e(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?cy(e):ly)}dispose(){this.disposables=_n(this.disposables)}};_m=dh([gi(4,Ot),gi(5,Dc),gi(6,yi)],_m);const v4e=ss.as(Dm.Configuration);v4e.registerConfiguration({id:"workbench",order:7,title:v(1705,"Workbench"),type:"object",properties:{[Fm]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[v(1706,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),v(1707,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:v(1708,"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[hL]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:v(1709,"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[aa]:{type:"boolean",default:!1,description:v(1710,"Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Cl]:{type:"boolean",default:!1,description:v(1711,"Controls whether clicks in the scrollbar scroll page by page.")},[mC]:{type:"number",default:8,minimum:4,maximum:40,description:v(1712,"Controls tree indentation in pixels.")},[C2]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:v(1713,"Controls whether the tree should render indent guides.")},[yl]:{type:"boolean",default:!1,description:v(1714,"Controls whether lists and trees have smooth scrolling.")},[Cc]:{type:"number",default:1,markdownDescription:v(1715,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[yc]:{type:"number",default:5,markdownDescription:v(1716,"Scrolling speed multiplier when pressing `Alt`.")},[$8]:{type:"string",enum:["highlight","filter"],enumDescriptions:[v(1717,"Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),v(1718,"Filter elements when searching.")],default:"highlight",description:v(1719,"Controls the default find mode for lists and trees in the workbench.")},[v2]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[v(1720,"Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),v(1721,"Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),v(1722,"Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:v(1723,"Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:v(1724,"Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[G8]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[v(1725,"Use fuzzy matching when searching."),v(1726,"Use contiguous matching when searching.")],default:"fuzzy",description:v(1727,"Controls the type of matching used when searching lists and trees in the workbench.")},[y2]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:v(1728,"Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[S2]:{type:"boolean",default:!0,description:v(1729,"Controls whether sticky scrolling is enabled in trees.")},[x2]:{type:"number",minimum:1,default:7,markdownDescription:v(1730,"Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[q8]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:v(1731,"Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var rT=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},u3=function(s,e){return function(t,i){e(t,i,s)}},h3;const Fl=Ke;class Cie{constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new lr(()=>{const n=i.label??"",r=fg(n).text.trim(),o=i.ariaLabel||[n,this.saneDescription,this.saneDetail].map(a=>nte(a)).filter(a=>!!a).join(", ");return{saneLabel:n,saneSortLabel:r,saneAriaLabel:o}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class ds extends Cie{constructor(e,t,i,n,r,o,a){var l,c,h;super(e,i,o),this.childIndex=t,this.fireButtonTriggered=n,this._onChecked=r,this.item=o,this._separator=a,this._checked=!1,this.onChecked=i?Se.map(Se.filter(this._onChecked.event,d=>d.element===this),d=>d.checked):Se.None,this._saneDetail=o.detail,this._labelHighlights=(l=o.highlights)==null?void 0:l.label,this._descriptionHighlights=(c=o.highlights)==null?void 0:c.description,this._detailHighlights=(h=o.highlights)==null?void 0:h.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var ql;(function(s){s[s.NONE=0]="NONE",s[s.MOUSE_HOVER=1]="MOUSE_HOVER",s[s.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(ql||(ql={}));class Tf extends Cie{constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=ql.NONE}}class C4e{getHeight(e){return e instanceof Tf?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof ds?k2.ID:E2.ID}}class y4e{getWidgetAriaLabel(){return v(1770,"Quick Input")}getAriaLabel(e){var t;return(t=e.separator)!=null&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof ds)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class yie{constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new Pe,t.toDisposeTemplate=new Pe,t.entry=Be(e,Fl(".quick-input-list-entry"));const i=Be(t.entry,Fl("label.quick-input-list-label"));t.outerLabel=i,t.checkbox=t.toDisposeTemplate.add(new Yn),t.toDisposeTemplate.add(bs(i,Le.CLICK,c=>{if(t.checkbox.value&&!c.defaultPrevented&&t.checkbox.value.enabled){const h=!t.checkbox.value.checked;t.checkbox.value.checked=h,t.element.checked=h}}));const n=Be(i,Fl(".quick-input-list-rows")),r=Be(n,Fl(".quick-input-list-row")),o=Be(n,Fl(".quick-input-list-row"));t.label=new s3(r,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=mD(t.label.element,Fl(".quick-input-list-icon"));const a=Be(r,Fl(".quick-input-list-entry-keybinding"));t.keybinding=new R8(a,Na),t.toDisposeTemplate.add(t.keybinding);const l=Be(o,Fl(".quick-input-list-label-meta"));return t.detail=new s3(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=Be(t.entry,Fl(".quick-input-list-separator")),t.actionBar=new ac(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}var Bg;let k2=(Bg=class extends yie{constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return h3.ID}ensureCheckbox(e,t){var n;if(!e.hasCheckbox){(n=t.checkbox.value)==null||n.domNode.remove(),t.checkbox.clear();return}let i=t.checkbox.value;i?i.setTitle(e.saneLabel):(i=new Qte(e.saneLabel,e.checked,{...N8,size:15}),t.checkbox.value=i,t.outerLabel.prepend(i.domNode)),e.checkboxDisabled?i.disable():i.enable(),i.checked=e.checked,t.toDisposeElement.add(e.onChecked(r=>i.checked=r)),t.toDisposeElement.add(i.onChange(()=>e.checked=i.checked))}renderElement(e,t,i){var g;const n=e.element;i.element=n,n.element=i.entry??void 0;const r=n.item;n.element.classList.toggle("not-pickable",n.item.pickable===!1),this.ensureCheckbox(n,i);const{labelHighlights:o,descriptionHighlights:a,detailHighlights:l}=n;if(r.iconPath){const p=Rm(this.themeService.getColorTheme().type)?r.iconPath.dark:r.iconPath.light??r.iconPath.dark,_=mt.revive(p);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=vc(_)}else i.icon.style.backgroundImage="",i.icon.className=r.iconClass?`quick-input-list-icon ${r.iconClass}`:"";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:Ra(n.saneDescription),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const h={matches:o||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(h.extraClasses=r.iconClasses,h.italic=r.italic,h.strikethrough=r.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,h),i.keybinding.set(r.keybinding),n.saneDetail){let p;n.saneTooltip||(p={markdown:{value:Ra(n.saneDetail),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:p,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";(g=n.separator)!=null&&g.label?(i.separator.textContent=n.separator.label,i.separator.style.display="",this.addItemWithSeparator(n)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!n.separator&&n.childIndex!==0);const d=r.buttons;d&&d.length?(i.actionBar.push(d.map((p,_)=>Z_(p,`id-${_}`,()=>n.fireButtonTriggered({button:p,item:n.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}},h3=Bg,Bg.ID="quickpickitem",Bg);k2=h3=rT([u3(1,Zr)],k2);const LE=class LE extends yie{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return LE.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const r=n.separator,{labelHighlights:o,descriptionHighlights:a}=n;i.icon.style.backgroundImage="",i.icon.className="";let l;!n.saneTooltip&&n.saneDescription&&(l={markdown:{value:Ra(n.saneDescription),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const c={matches:o||[],descriptionTitle:l,descriptionMatches:a||[],labelEscapeNewLines:!0};i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,c),i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const h=r.buttons;h&&h.length?(i.actionBar.push(h.map((d,g)=>Z_(d,`id-${g}`,()=>n.fireSeparatorButtonTriggered({button:d,separator:n.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(e,t,i){var n;this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||(n=e.element.element)==null||n.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}};LE.ID="quickpickseparator";let E2=LE,pC=class extends le{constructor(e,t,i,n,r,o){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=o,this._onKeyDown=new Z,this._onLeave=new Z,this.onLeave=this._onLeave.event,this._visibleCountObservable=lt("VisibleCount",0),this.onChangedVisibleCount=Se.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=lt("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=Se.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=lt("CheckedCount",0),this.onChangedCheckedCount=Se.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=fw({equalsFn:Sn},new Array),this.onChangedCheckedElements=Se.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new Z,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new Z,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new Z,this._elementCheckedEventBufferer=new FC,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new Pe),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=Be(this.parent,Fl(".quick-input-list")),this._separatorRenderer=new E2(t),this._itemRenderer=r.createInstance(k2,t),this._tree=this._register(r.createInstance(L2,"QuickInput",this._container,new C4e,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof Tf?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return x4e(a,l,c)}},accessibilityProvider:new y4e,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:pm.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=n,this._registerListeners()}get onDidChangeFocus(){return Se.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof ds).map(t=>t.item),this._store)}get onDidChangeSelection(){return Se.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof ds).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new si(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(ie(this._container,Le.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(ie(this._container,Le.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new zX(typeof this.hoverDelegate.delay=="function"?this.hoverDelegate.delay():this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{var i;if(Ez(t.browserEvent.target)){e.cancel();return}if(!(!Ez(t.browserEvent.relatedTarget)&&Gn(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)))try{await e.trigger(async()=>{t.element instanceof ds&&this.showHover(t.element)})}catch(n){if(!OC(n))throw n}})),this._register(this._tree.onMouseOut(t=>{var i;Gn(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const n=i===t;!!(i.focusInsideSeparator&ql.ACTIVE_ITEM)!==n&&(n?i.focusInsideSeparator|=ql.ACTIVE_ITEM:i.focusInsideSeparator&=~ql.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&ql.MOUSE_HOVER)||(i.focusInsideSeparator|=ql.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&ql.MOUSE_HOVER)&&(i.focusInsideSeparator&=~ql.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof ds);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof Tf&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&t.item.pickable!==!1&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,n,r)=>{let o;if(n.type==="separator"){if(!n.buttons)return i;t=new Tf(r,a=>this._onSeparatorButtonTriggered.fire(a),n),o=t}else{const a=r>0?e[r-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(l=a);const c=new ds(r,t!=null&&t.children?t.children.length:r,this._hasCheckboxes&&n.pickable!==!1,h=>this._onButtonTriggered.fire(h),this._elementChecked,n,l);if(this._itemElements.push(c),t)return t.children.push(c),i;o=c}return i.push(o),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),n=i==null?void 0:i.parentNode;if(i&&n){const r=i.nextSibling;i.remove(),n.insertBefore(i,r)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){var t;if(this._itemElements.length)switch(e===ui.Second&&this._itemElements.length<2&&(e=ui.First),e){case ui.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,i=>i.element instanceof ds);break;case ui.Second:{this._tree.scrollTop=0;let i=!1;this._tree.focusFirst(void 0,n=>n.element instanceof ds?i?!0:(i=!i,!1):!1);break}case ui.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,i=>i.element instanceof ds);break;case ui.Next:{const i=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,r=>r.element instanceof ds?(this._tree.reveal(r.element),!0):!1);const n=this._tree.getFocus();i.length&&i[0]===n[0]&&this._onLeave.fire();break}case ui.Previous:{const i=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,r=>{if(!(r.element instanceof ds))return!1;const o=this._tree.getParentElement(r.element);return o===null||o.children[0]!==r.element?this._tree.reveal(r.element):this._tree.reveal(o),!0});const n=this._tree.getFocus();i.length&&i[0]===n[0]&&this._onLeave.fire();break}case ui.NextPage:this._tree.focusNextPage(void 0,i=>i.element instanceof ds?(this._tree.reveal(i.element),!0):!1);break;case ui.PreviousPage:this._tree.focusPreviousPage(void 0,i=>{if(!(i.element instanceof ds))return!1;const n=this._tree.getParentElement(i.element);return n===null||n.children[0]!==i.element?this._tree.reveal(i.element):this._tree.reveal(n),!0});break;case ui.NextSeparator:{let i=!1;const n=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,o=>{if(i)return!0;if(o.element instanceof Tf)i=!0,this._separatorRenderer.isSeparatorVisible(o.element)?this._tree.reveal(o.element.children[0]):this._tree.reveal(o.element,0);else if(o.element instanceof ds){if(o.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),!0;if(o.element===this._elementTree[0])return this._tree.reveal(o.element,0),!0}return!1});const r=this._tree.getFocus()[0];n===r&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,o=>o.element instanceof ds));break}case ui.PreviousSeparator:{let i,n=!!((t=this._tree.getFocus()[0])!=null&&t.separator);this._tree.focusPrevious(void 0,!0,void 0,r=>{if(r.element instanceof Tf)n?i||(this._separatorRenderer.isSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element.children[0]):n=!0;else if(r.element instanceof ds&&!i){if(r.element.separator)this._itemRenderer.isItemWithSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element;else if(r.element===this._elementTree[0])return this._tree.reveal(r.element,0),!0}return!1}),i&&this._tree.setFocus([i]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const n=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=n&&n.type==="separator"&&!n.buttons?n:void 0)});else{let i;this._itemElements.forEach(n=>{let r;this.matchOnLabelMode==="fuzzy"?r=this.matchOnLabel?ww(e,fg(n.saneLabel))??void 0:void 0:r=this.matchOnLabel?S4e(t,fg(n.saneLabel))??void 0:void 0;const o=this.matchOnDescription?ww(e,fg(n.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?ww(e,fg(n.saneDetail||""))??void 0:void 0;if(r||o||a?(n.labelHighlights=r,n.descriptionHighlights=o,n.detailHighlights=a,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=n.item?!n.item.alwaysShow:!0),n.item?n.separator=void 0:n.separator&&(n.hidden=!0),!this.sortByLabel){const l=n.index&&this._inputElements[n.index-1]||void 0;(l==null?void 0:l.type)==="separator"&&!l.buttons&&(i=l),i&&!n.hidden&&(n.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof ds),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!(e!=null&&e.saneTooltip)||!(e instanceof ds))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new Pe;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof ds&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof Tf?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(n=>({element:n,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const r=e[i];if(!r.hidden&&r.item.pickable!==!1)if(r.checked)t=!0;else return!1}return t}_updateCheckedObservables(){tn(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){var t,i,n;this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.hoverDelegate).onDidHideHover)==null||i.call(t),(n=this._lastHover)==null||n.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:r=>{this.linkOpenerDelegate(r)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};rT([Vi],pC.prototype,"onDidChangeFocus",null);rT([Vi],pC.prototype,"onDidChangeSelection",null);pC=rT([u3(4,It),u3(5,Mo)],pC);function S4e(s,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return Gq(s,t);const n=lD(t," "),r=t.length-n.length,o=Gq(s,n);if(o)for(const a of o){const l=i[a.start+r]+r;a.start+=l,a.end+=l}return o}function Gq(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t!==-1?[{start:t,end:t+s.length}]:null}function x4e(s,e,t){const i=s.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:EMe(s.saneSortLabel,e.saneSortLabel,t)}function L4e(s,e={}){Hd.registerCommandAndKeybindingRule({weight:200,when:JD,metadata:{description:v(1758,"Used while in the context of any kind of quick input. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},...s,secondary:Y8(s.primary,s.secondary??[],e)})}function Lr(s,e={}){Hd.registerCommandAndKeybindingRule({weight:200,when:xt.and(xt.or(xt.equals(dC,"quickPick"),xt.equals(dC,"quickTree")),JD),metadata:{description:v(1759,"Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},...s,secondary:Y8(s.primary,s.secondary??[],e)})}const _C=_t?256:2048;function Y8(s,e,t={}){return t.withAltMod&&e.push(512+s),t.withCtrlMod&&(e.push(_C+s),t.withAltMod&&e.push(512+_C+s)),t.withCmdMod&&_t&&(e.push(2048+s),t.withCtrlMod&&e.push(2304+s),t.withAltMod&&(e.push(2560+s),t.withCtrlMod&&e.push(2816+s))),e}function fo(s,e){return t=>{const i=t.get(Om).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(s)}}Lr({id:"quickInput.pageNext",primary:12,handler:fo(ui.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Lr({id:"quickInput.pagePrevious",primary:11,handler:fo(ui.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Lr({id:"quickInput.first",primary:_C+14,handler:fo(ui.First)},{withAltMod:!0,withCmdMod:!0});Lr({id:"quickInput.last",primary:_C+13,handler:fo(ui.Last)},{withAltMod:!0,withCmdMod:!0});Lr({id:"quickInput.next",primary:18,handler:fo(ui.Next)},{withCtrlMod:!0});Lr({id:"quickInput.previous",primary:16,handler:fo(ui.Previous)},{withCtrlMod:!0});const Kq=v(1760,"If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),Yq=v(1761,"If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");_t?(Lr({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:fo(ui.NextSeparator,ui.Next),metadata:{description:Kq}}),Lr({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:fo(ui.NextSeparator)},{withCtrlMod:!0}),Lr({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:fo(ui.PreviousSeparator,ui.Previous),metadata:{description:Yq}}),Lr({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:fo(ui.PreviousSeparator)},{withCtrlMod:!0})):(Lr({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:fo(ui.NextSeparator,ui.Next),metadata:{description:Kq}}),Lr({id:"quickInput.nextSeparator",primary:2578,handler:fo(ui.NextSeparator)}),Lr({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:fo(ui.PreviousSeparator,ui.Previous),metadata:{description:Yq}}),Lr({id:"quickInput.previousSeparator",primary:2576,handler:fo(ui.PreviousSeparator)}));Hd.registerCommandAndKeybindingRule({id:"quickInput.accept",primary:3,weight:200,when:xt.and(xt.notEquals(dC,"quickWidget"),JD,xt.not("isComposing")),metadata:{description:v(1762,"Used while in the context of some quick input. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},handler:s=>{const e=s.get(Om).currentQuickInput;e==null||e.accept()},secondary:Y8(3,[],{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0})});Lr({id:"quickInput.acceptInBackground",when:xt.and(JD,xt.equals(dC,"quickPick"),xt.or(fie.negate(),VAe)),primary:17,weight:250,handler:s=>{const e=s.get(Om).currentQuickInput;e==null||e.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});L4e({id:"quickInput.hide",primary:9,handler:s=>{const e=s.get(Om).currentQuickInput;e==null||e.hide()}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Lr({id:"quickInput.toggleHover",primary:_C|10,handler:s=>{s.get(Om).toggleHover()}});var k4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},E4e=function(s,e){return function(t,i){e(t,i,s)}},d3;const S0=Ke;var Vg;let D2=(Vg=class extends le{constructor(e,t,i,n){super(),this._hoverDelegate=e,this._buttonTriggeredEmitter=t,this.onCheckedEvent=i,this._themeService=n,this.templateId=d3.ID}renderTemplate(e){const t=new Pe,i=Be(e,S0(".quick-input-tree-entry")),n=t.add(new Xte("",!1,{...N8,size:15}));i.appendChild(n.domNode);const r=Be(i,S0("label.quick-input-tree-label")),o=Be(r,S0(".quick-input-tree-rows")),a=Be(o,S0(".quick-input-tree-row")),l=mD(a,S0(".quick-input-tree-icon")),c=t.add(new s3(a,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this._hoverDelegate})),h=t.add(new ac(i,this._hoverDelegate?{hoverDelegate:this._hoverDelegate}:void 0));return h.domNode.classList.add("quick-input-tree-entry-action-bar"),{toDisposeTemplate:t,entry:i,checkbox:n,icon:l,label:c,actionBar:h,toDisposeElement:new Pe}}renderElement(e,t,i,n){const r=i.toDisposeElement,o=e.element;if(o.pickable===!1?i.checkbox.domNode.style.display="none":(i.checkbox.domNode.style.display="",i.checkbox.checked=o.checked??!1,r.add(Se.filter(this.onCheckedEvent,d=>d.item===o)(d=>i.checkbox.checked=d.checked)),o.disabled&&i.checkbox.disable()),o.iconPath){const d=Rm(this._themeService.getColorTheme().type)?o.iconPath.dark:o.iconPath.light??o.iconPath.dark,g=mt.revive(d);i.icon.className="quick-input-tree-icon",i.icon.style.backgroundImage=vc(g)}else i.icon.style.backgroundImage="",i.icon.className=o.iconClass?`quick-input-tree-icon ${o.iconClass}`:"";const{labelHighlights:a,descriptionHighlights:l}=e.filterData||{};let c;o.description&&(c={markdown:{value:Ra(o.description),supportThemeIcons:!0},markdownNotSupportedFallback:o.description}),i.label.setLabel(o.label,o.description,{matches:a,descriptionMatches:l,extraClasses:o.iconClasses,italic:o.italic,strikethrough:o.strikethrough,labelEscapeNewLines:!0,descriptionTitle:c});const h=o.buttons;h&&h.length?(i.actionBar.push(h.map((d,g)=>Z_(d,`tree-${g}`,()=>this._buttonTriggeredEmitter.fire({item:o,button:d}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i,n){i.toDisposeElement.clear(),i.actionBar.clear()}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}},d3=Vg,Vg.ID="quickInputTreeElement",Vg);D2=d3=k4e([E4e(3,Zr)],D2);class D4e{getHeight(e){return 22}getTemplateId(e){return D2.ID}}function T4e(s){var r;let e=!1,t=!1,i=!1;for(const o of s){switch((r=o.element)==null?void 0:r.checked){case"mixed":i=!0;break;case!0:e=!0;break;default:t=!0;break}if(e&&t&&i)break}return t?i||e?"mixed":!1:i?"mixed":e}class N4e{constructor(e){this.onCheckedEvent=e}getWidgetAriaLabel(){return v(1772,"Quick Tree")}getAriaLabel(e){return e.ariaLabel||[e.label,e.description].map(t=>nte(t)).filter(t=>!!t).join(", ")}getWidgetRole(){return"tree"}getRole(e){return"checkbox"}isChecked(e){return{get value(){return e.checked==="mixed"?"mixed":!!e.checked},onDidChange:t=>Se.filter(this.onCheckedEvent,i=>i.item===e)(i=>t())}}}class I4e{constructor(){this.filterValue="",this.matchOnLabel=!0,this.matchOnDescription=!1}filter(e,t){if(!this.filterValue||!(this.matchOnLabel||this.matchOnDescription))return e.children?{visibility:2,data:{}}:{visibility:1,data:{}};const i=this.matchOnLabel?ww(this.filterValue,fg(e.label))??void 0:void 0,n=this.matchOnDescription?ww(this.filterValue,fg(e.description||""))??void 0:void 0;return{visibility:t===1||i||n?1:e.children?2:0,data:{labelHighlights:i,descriptionHighlights:n}}}}class R4e extends le{constructor(){super(...arguments),this._sortByLabel=!0}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}compare(e,t){if(!this._sortByLabel)return 0;if(e.label<t.label)return-1;if(e.label>t.label)return 1;if(e.description&&t.description){if(e.description<t.description)return-1;if(e.description>t.description)return 1}else{if(e.description)return-1;if(t.description)return 1}return 0}}var A4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},M4e=function(s,e){return function(t,i){e(t,i,s)}};const O4e=Ke;let f3=class extends le{constructor(e,t,i){super(),this.instantiationService=i,this._onDidTriggerButton=this._register(new Z),this._onDidChangeCheckboxState=this._register(new Z),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidCheckedLeafItemsChange=this._register(new Z),this._onLeave=new Z,this.onLeave=this._onLeave.event,this._onDidAccept=this._register(new Z),this.onDidAccept=this._onDidAccept.event,this._container=Be(e,O4e(".quick-input-tree")),this._renderer=this._register(this.instantiationService.createInstance(D2,t,this._onDidTriggerButton,this.onDidChangeCheckboxState)),this._filter=this.instantiationService.createInstance(I4e),this._sorter=this._register(new R4e),this._tree=this._register(this.instantiationService.createInstance(L2,"QuickInputTree",this._container,new D4e,[this._renderer],{accessibilityProvider:new N4e(this.onDidChangeCheckboxState),horizontalScrolling:!1,multipleSelectionSupport:!1,findWidgetEnabled:!1,alwaysConsumeMouseWheel:!0,hideTwistiesOfChildlessElements:!0,renderIndentGuides:pm.None,expandOnDoubleClick:!0,expandOnlyOnTwistieClick:!0,disableExpandOnSpacebar:!0,sorter:this._sorter,filter:this._filter})),this.registerOnOpenListener()}get tree(){return this._tree}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get sortByLabel(){return this._sorter.sortByLabel}set sortByLabel(e){this._sorter.sortByLabel=e,this._tree.resort(null,!0)}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}updateFilterOptions(e){e.matchOnLabel!==void 0&&(this._filter.matchOnLabel=e.matchOnLabel),e.matchOnDescription!==void 0&&(this._filter.matchOnDescription=e.matchOnDescription),this._tree.refilter()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}registerOnOpenListener(){this._register(this._tree.onDidOpen(e=>{const t=e.element;if(!t||t.disabled)return;if(t.pickable===!1){this._tree.setFocus([t]),this._onDidAccept.fire();return}const i=t.checked!==!0;if((t.checked??!1)===i)return;t.checked=i,this._tree.rerender(t);const n=new Set,r=[...this._tree.getNode(t).children];for(;r.length;){const a=r.shift();a!=null&&a.element&&!n.has(a.element)&&(n.add(a.element),(a.element.checked??!1)!==t.checked&&(a.element.checked=t.checked,this._tree.rerender(a.element)),r.push(...a.children))}let o=this._tree.getParentElement(t);for(;o;){const a=[...this._tree.getNode(o).children],l=T4e(a);(o.checked??!1)!==l&&(o.checked=l,this._tree.rerender(o)),o=this._tree.getParentElement(o)}this._onDidChangeCheckboxState.fire({item:t,checked:t.checked??!1}),this._onDidCheckedLeafItemsChange.fire(this.getCheckedLeafItems())}))}getCheckedLeafItems(){const e=new Set,t=[...this._tree.getNode().children],i=new Array;for(;t.length;){const n=t.shift();!(n!=null&&n.element)||e.has(n.element)||n.element.checked&&(e.add(n.element),t.push(...n.children),n.element.children||i.push(n.element))}return i}};f3=A4e([M4e(2,It)],f3);var Sie=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},pg=function(s,e){return function(t,i){e(t,i,s)}},g3;const oo=Ke,CA="workbench.quickInput.viewState";var Hg;let m3=(Hg=class extends le{get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,n,r){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.storageService=r,this.enabled=!0,this.onDidAcceptEmitter=this._register(new Z),this.onDidCustomEmitter=this._register(new Z),this.onDidTriggerButtonEmitter=this._register(new Z),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new Z),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new Z),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=MAe.bindTo(n),this.quickInputTypeContext=FAe.bindTo(n),this.endOfQuickInputBoxContext=BAe.bindTo(n),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(Se.runAndSubscribe(zC,({window:o,disposables:a})=>this.registerKeyModsListeners(o,a),{window:ni,disposables:this._store})),this._register(f1e(o=>{this.ui&&Ue(this.ui.container)===o&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))})),this.viewState=this.loadViewState()}registerKeyModsListeners(e,t){const i=n=>{this.keyMods.ctrlCmd=n.ctrlKey||n.metaKey,this.keyMods.alt=n.altKey};for(const n of[Le.KEY_DOWN,Le.KEY_UP,Le.MOUSE_DOWN])t.add(ie(e,n,i,!0))}getUI(e){if(this.ui)return e&&Ue(this._container)!==Ue(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=Be(this._container,oo(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=bl(t),n=Be(t,oo(".quick-input-titlebar")),r=this._register(new ac(n,{hoverDelegate:this.options.hoverDelegate}));r.domNode.classList.add("quick-input-left-action-bar");const o=Be(n,oo(".quick-input-title")),a=this._register(new ac(n,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=Be(t,oo(".quick-input-header")),c=this._register(new Xte(v(1763,"Toggle all checkboxes"),!1,{...N8,size:15}));Be(l,c.domNode),this._register(c.onChange(()=>{const Y=c.checked;H.setAllVisibleChecked(Y===!0)})),this._register(ie(c.domNode,Le.CLICK,Y=>{(Y.x||Y.y)&&p.setFocus()}));const h=Be(l,oo(".quick-input-description")),d=Be(l,oo(".quick-input-and-message")),g=Be(d,oo(".quick-input-filter")),p=this._register(new oMe(g,this.styles.inputBox,this.styles.toggle));p.setAttribute("aria-describedby",`${this.idPrefix}message`);const _=Be(g,oo(".quick-input-visible-count"));_.setAttribute("aria-live","polite"),_.setAttribute("aria-atomic","true");const b=this._register(new Dq(_,{countFormat:v(1764,"{0} Results")},this.styles.countBadge)),C=Be(g,oo(".quick-input-count"));C.setAttribute("aria-live","polite");const x=this._register(new Dq(C,{countFormat:v(1765,"{0} Selected")},this.styles.countBadge)),S=this._register(new ac(l,{hoverDelegate:this.options.hoverDelegate}));S.domNode.classList.add("quick-input-inline-action-bar");const y=Be(l,oo(".quick-input-action")),k=this._register(new t3(y,this.styles.button));k.label=v(1766,"OK"),this._register(k.onDidClick(Y=>{this.onDidAcceptEmitter.fire()}));const D=Be(l,oo(".quick-input-action")),R=this._register(new t3(D,{...this.styles.button,supportIcons:!0}));R.label=v(1767,"Custom"),this._register(R.onDidClick(Y=>{this.onDidCustomEmitter.fire()}));const N=Be(d,oo(`#${this.idPrefix}message.quick-input-message`)),A=this._register(new i3(t,this.styles.progressBar));A.getContainer().classList.add("quick-input-progress");const M=Be(t,oo(".quick-input-html-widget"));M.tabIndex=-1;const O=Be(t,oo(".quick-input-description")),V=this.idPrefix+"list",H=this._register(this.instantiationService.createInstance(pC,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,V));p.setAttribute("aria-controls",V),this._register(H.onDidChangeFocus(()=>{p.hasFocus()&&p.setAttribute("aria-activedescendant",H.getActiveDescendant()??"")})),this._register(H.onChangedAllVisibleChecked(Y=>{c.checked=Y})),this._register(H.onChangedVisibleCount(Y=>{b.setCount(Y)})),this._register(H.onChangedCheckedCount(Y=>{PC(()=>x.setCount(Y))})),this._register(H.onLeave(()=>{setTimeout(()=>{this.controller&&(p.setFocus(),this.controller instanceof Dw&&this.controller.canSelectMany&&H.clearFocus())},0)}));const U=this._register(this.instantiationService.createInstance(f3,t,this.options.hoverDelegate));this._register(U.tree.onDidChangeFocus(()=>{p.hasFocus()&&p.setAttribute("aria-activedescendant",U.getActiveDescendant()??"")})),this._register(U.onLeave(()=>{setTimeout(()=>{this.controller&&(p.setFocus(),U.tree.setFocus([]))},0)})),this._register(U.onDidAccept(()=>{this.onDidAcceptEmitter.fire()})),this._register(U.tree.onDidChangeContentHeight(()=>this.updateLayout()));const X=C1(t);return this._register(X),this._register(ie(t,Le.FOCUS,Y=>{const q=this.getUI();if(Gn(Y.relatedTarget,q.inputContainer)){const ee=q.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==ee&&this.endOfQuickInputBoxContext.set(ee)}Gn(Y.relatedTarget,q.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=nn(Y.relatedTarget)?Y.relatedTarget:void 0)},!0)),this._register(X.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(oC.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(p.onKeyDown(Y=>{const q=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==q&&this.endOfQuickInputBoxContext.set(q),p.removeAttribute("aria-activedescendant")})),this._register(ie(t,Le.FOCUS,Y=>{p.setFocus()})),this.dndController=this._register(this.instantiationService.createInstance(p3,this._container,t,[{node:n,includeChildren:!0},{node:l,includeChildren:!1}],this.viewState)),this._register(vt(Y=>{var ee;const q=(ee=this.dndController)==null?void 0:ee.dndViewState.read(Y);q&&(q.top!==void 0&&q.left!==void 0?this.viewState={...this.viewState,top:q.top,left:q.left}:this.viewState=void 0,this.updateLayout(),q.done&&this.saveViewState(this.viewState))})),this.ui={container:t,styleSheet:i,leftActionBar:r,titleBar:n,title:o,description1:O,description2:h,widget:M,rightActionBar:a,inlineActionBar:S,checkAll:c,inputContainer:d,filterContainer:g,inputBox:p,visibleCountContainer:_,visibleCount:b,countContainer:C,count:x,okContainer:y,ok:k,message:N,customButtonContainer:D,customButton:R,list:H,tree:U,progressBar:A,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:Y=>this.show(Y),hide:()=>this.hide(),setVisibilities:Y=>this.setVisibilities(Y),setEnabled:Y=>this.setEnabled(Y),setContextKey:Y=>this.options.setContextKey(Y),linkOpenerDelegate:Y=>this.options.linkOpenerDelegate(Y)},this.updateStyles(),this.ui}reparentUI(e){var t;this.ui&&(this._container=e,Be(this._container,this.ui.container),(t=this.dndController)==null||t.reparentUI(this._container))}pick(e,t={},i=Io.None){return new Promise((n,r)=>{let o=h=>{var d;o=n,(d=t.onKeyMods)==null||d.call(t,a.keyMods),n(h)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const h=a.activeItems[0];h&&(o(h),a.hide())}}),a.onDidChangeActive(h=>{const d=h[0];d&&t.onDidFocus&&t.onDidFocus(d)}),a.onDidChangeSelection(h=>{if(!a.canSelectMany){const d=h[0];d&&(o(d),a.hide())}}),a.onDidTriggerItemButton(h=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...h,removeItem:()=>{const d=a.items.indexOf(h.item);if(d!==-1){const g=a.items.slice(),p=g.splice(d,1),_=a.activeItems.filter(C=>C!==p[0]),b=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=g,_&&(a.activeItems=_),a.keepScrollPosition=b}}})),a.onDidTriggerSeparatorButton(h=>{var d;return(d=t.onDidTriggerSeparatorButton)==null?void 0:d.call(t,h)}),a.onDidChangeValue(h=>{l&&!h&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{_n(c),o(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.prompt=t.prompt,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,t.sortByLabel!==void 0&&(a.sortByLabel=t.sortByLabel),a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([h,d])=>{l=d,a.busy=!1,a.items=h,a.canSelectMany&&(a.selectedItems=h.filter(g=>g.type!=="separator"&&g.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,h=>{r(h),a.hide()})})}setValidationOnInput(e,t){t&&ns(t)?(e.severity=Ji.Error,e.validationMessage=t):t&&!ns(t)?(e.severity=t.severity,e.validationMessage=t.content):(e.severity=Ji.Ignore,e.validationMessage=void 0)}input(e={},t=Io.None){return new Promise(i=>{if(t.isCancellationRequested){i(void 0);return}const n=this.createInputBox(),r=e.validateInput||(()=>Promise.resolve(void 0)),o=Se.debounce(n.onDidChangeValue,(h,d)=>d,100);let a=e.value||"",l=Promise.resolve(r(a));const c=[n,o(h=>{h!==a&&(l=Promise.resolve(r(h)),a=h),l.then(d=>{h===a&&this.setValidationOnInput(n,d)})}),n.onDidAccept(()=>{const h=n.value;h!==a&&(l=Promise.resolve(r(h)),a=h),l.then(d=>{!d||!ns(d)&&d.severity!==Ji.Error?(i(h),n.hide()):h===a&&this.setValidationOnInput(n,d)})}),t.onCancellationRequested(()=>{n.hide()}),n.onDidHide(()=>{_n(c),i(void 0)})];n.title=e.title,n.value=e.value||"",n.valueSelection=e.valueSelection,n.prompt=e.prompt,n.placeholder=e.placeHolder,n.password=!!e.password,n.ignoreFocusOut=!!e.ignoreFocusLost,n.show()})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new Dw(t)}createInputBox(){const e=this.getUI(!0);return new HAe(e)}show(e){var r;const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",Ds(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Ji.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),Ds(t.message),t.progressBar.stop(),t.progressBar.getContainer().setAttribute("aria-hidden","true"),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.tree.updateFilterOptions({matchOnDescription:!1,matchOnLabel:!0}),t.tree.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const n=this.options.backKeybindingLabel();JO.tooltip=n?v(1768,"Back ({0})",n):v(1769,"Back"),t.container.style.display="",this.updateLayout(),(r=this.dndController)==null||r.layoutContainer(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.domNode.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.tree.displayed=!!e.tree,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;const t=this.getUI();for(const i of t.leftActionBar.viewItems)i.action.enabled=e;for(const i of t.rightActionBar.viewItems)i.action.enabled=e;e?t.checkAll.enable():t.checkAll.disable(),t.inputBox.enabled=e,t.ok.enabled=e,t.list.enabled=e}}hide(e){var r;const t=this.controller;if(!t)return;t.willHide(e);const i=(r=this.ui)==null?void 0:r.container,n=i&&!tZ(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!n){let o=this.previousFocusElement;for(;o&&!o.offsetParent;)o=o.parentElement??void 0;o!=null&&o.offsetParent?(o.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}toggleHover(){this.isVisible()&&this.controller instanceof Dw&&this.getUI().list.toggleHover()}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){var e,t;if(this.ui&&this.isVisible()){const i=this.ui.container.style,n=Math.min(this.dimension.width*.62,g3.MAX_WIDTH);i.width=n+"px",i.top=`${(e=this.viewState)!=null&&e.top?Math.round(this.dimension.height*this.viewState.top):this.titleBarOffset}px`,i.left=`${Math.round(this.dimension.width*(((t=this.viewState)==null?void 0:t.left)??.5)-n/2)}px`,this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4),this.ui.tree.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:n,widgetShadow:r}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=r?`0 0 8px 2px ${r}`:"",this.ui.list.style(this.styles.list),this.ui.tree.tree.style(this.styles.list);const o=[];this.styles.pickerGroup.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}loadViewState(){try{const e=JSON.parse(this.storageService.get(CA,-1,"{}"));if(e.top!==void 0||e.left!==void 0)return e}catch{}}saveViewState(e){this.layoutService.activeContainer===this.layoutService.mainContainer&&(e!==void 0?this.storageService.store(CA,JSON.stringify(e),-1,1):this.storageService.remove(CA,-1))}},g3=Hg,Hg.MAX_WIDTH=600,Hg);m3=g3=Sie([pg(1,ch),pg(2,It),pg(3,Ot),pg(4,ry)],m3);let p3=class extends le{constructor(e,t,i,n,r,o,a){super(),this._container=e,this._quickInputContainer=t,this._quickInputDragAreas=i,this._layoutService=r,this.configurationService=a,this.dndViewState=lt(this,void 0),this._snapThreshold=20,this._snapLineHorizontalRatio=.25,this._quickInputAlignmentContext=PAe.bindTo(o);const l=uAe(this.configurationService)==="custom";this._controlsOnLeft=l&&JI===1,this._controlsOnRight=l&&(JI===3||JI===2),this._registerLayoutListener(),this.registerMouseListeners(),this.dndViewState.set({...n,done:!0},void 0)}reparentUI(e){this._container=e}layoutContainer(e=this._layoutService.activeContainerDimension){const t=this.dndViewState.get(),i=this._quickInputContainer.getBoundingClientRect();if(t!=null&&t.top&&(t!=null&&t.left)){const n=Math.round(t.left*100)/100,r=e.width,o=i.width,a=n*r-o/2;this._layout(t.top*e.height,a)}}_registerLayoutListener(){this._register(Se.filter(this._layoutService.onDidLayoutContainer,e=>e.container===this._container)(e=>this.layoutContainer(e.dimension)))}registerMouseListeners(){const e=this._quickInputContainer;this._register(kz(e,t=>{const i=new So(Ue(e),t);i.detail===2&&this._quickInputDragAreas.some(({node:n,includeChildren:r})=>r?Gn(i.target,n):i.target===n)&&this.dndViewState.set({top:void 0,left:void 0,done:!0},void 0)})),this._register(b1e(e,t=>{const i=Ue(this._layoutService.activeContainer),n=new So(i,t);if(!this._quickInputDragAreas.some(({node:d,includeChildren:g})=>g?Gn(n.target,d):n.target===d))return;const r=this._quickInputContainer.getBoundingClientRect(),o=n.browserEvent.clientX-r.left,a=n.browserEvent.clientY-r.top;let l=!1;const c=w1e(i,d=>{new So(i,d).preventDefault(),l||(l=!0),this._layout(d.clientY-a,d.clientX-o)}),h=kz(i,d=>{if(l){const g=this.dndViewState.get();this.dndViewState.set({top:g==null?void 0:g.top,left:g==null?void 0:g.left,done:!0},void 0)}c.dispose(),h.dispose()})}))}_layout(e,t){const i=this._getTopSnapValue(),n=this._getCenterYSnapValue(),r=this._getCenterXSnapValue();e=Math.max(0,Math.min(e,this._container.clientHeight-this._quickInputContainer.clientHeight)),e<this._layoutService.activeContainerOffset.top&&(this._controlsOnLeft?t=Math.max(t,80/_4(Kt())):this._controlsOnRight&&(t=Math.min(t,this._container.clientWidth-this._quickInputContainer.clientWidth-140/_4(Kt()))));const o=Math.abs(e-i)<this._snapThreshold;e=o?i:e;const a=Math.abs(e-n)<this._snapThreshold;e=a?n:e;const l=e/this._container.clientHeight;t=Math.max(0,Math.min(t,this._container.clientWidth-this._quickInputContainer.clientWidth));const c=Math.abs(t-r)<this._snapThreshold;t=c?r:t;const h=this._container.clientWidth,d=this._quickInputContainer.clientWidth,p=(t+d/2)/h;if(this.dndViewState.set({top:l,left:p,done:!1},void 0),c){if(o){this._quickInputAlignmentContext.set("top");return}else if(a){this._quickInputAlignmentContext.set("center");return}}this._quickInputAlignmentContext.set(void 0)}_getTopSnapValue(){return this._layoutService.activeContainerOffset.quickPickTop}_getCenterYSnapValue(){return Math.round(this._container.clientHeight*this._snapLineHorizontalRatio)}_getCenterXSnapValue(){return Math.round(this._container.clientWidth/2)-Math.round(this._quickInputContainer.clientWidth/2)}};p3=Sie([pg(4,ch),pg(5,Ot),pg(6,yi)],p3);var P4e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},x0=function(s,e){return function(t,i){e(t,i,s)}};let _3=class extends PSe{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(ZO))),this._quickAccess}constructor(e,t,i,n,r){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=n,this.configurationService=r,this._onShow=this._register(new Z),this._onHide=this._register(new Z),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:r=>this.setContextKey(r),linkOpenerDelegate:r=>{this.instantiationService.invokeFunction(o=>{o.get(GD).open(r,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(e3))},n=this._register(this.instantiationService.createInstance(m3,{...i,...t}));return n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(r=>{Ue(e.activeContainer)===Ue(n.container)&&n.layout(r,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{n.isVisible()||n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(n.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(n.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new He(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=Io.None){return this.controller.pick(e,t,i)}input(e={},t=Io.None){return this.controller.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}toggleHover(){this.hasController&&this.controller.toggleHover()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:De(xR),quickInputForeground:De(aye),quickInputTitleBackground:De(lye),widgetBorder:De(rJ),widgetShadow:De(QC)},inputBox:Ute,toggle:zte,countBadge:rAe,button:iAe,progressBar:nAe,keybindingLabel:tAe,list:cy({listBackground:xR,listFocusBackground:m5,listFocusForeground:g5,listInactiveFocusForeground:g5,listInactiveSelectionIconForeground:pJ,listInactiveFocusBackground:m5,listFocusOutline:rn,listInactiveFocusOutline:rn,treeStickyScrollBackground:xR}),pickerGroup:{pickerGroupBorder:De(cye),pickerGroupForeground:De(mJ)}}}};_3=P4e([x0(0,It),x0(1,Ot),x0(2,Zr),x0(3,ch),x0(4,yi)],_3);var xie=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Gf=function(s,e){return function(t,i){e(t,i,s)}};let b3=class extends _3{constructor(e,t,i,n,r,o){super(t,i,n,new lO(e.getContainerDomNode(),r),o),this.host=void 0;const a=bC.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return Se.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return Se.None},get onDidAddContainer(){return Se.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};b3=xie([Gf(1,It),Gf(2,Ot),Gf(3,Zr),Gf(4,In),Gf(5,yi)],b3);let w3=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(b3,e);this.mapEditorToService.set(e,t),wv(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=Io.None){return this.activeService.pick(e,t,i)}input(e,t){return this.activeService.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}toggleHover(){return this.activeService.toggleHover()}};w3=xie([Gf(0,It),Gf(1,In)],w3);const kE=class kE{static get(e){return e.getContribution(kE.ID)}constructor(e){this.editor=e,this.widget=new v3(this.editor)}dispose(){this.widget.dispose()}};kE.ID="editor.controller.quickInput";let bC=kE;const EE=class EE{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return EE.ID}getDomNode(){return this.domNode}getPosition(){return{preference:{top:0,left:0}}}dispose(){this.codeEditor.removeOverlayWidget(this)}};EE.ID="editor.contrib.quickInputWidget";let v3=EE;pZ(bC.ID,bC,4);class F4e{constructor(e,t,i,n,r){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=r}}function B4e(s){if(!s||!Array.isArray(s))return[];const e=[];let t=0;for(let i=0,n=s.length;i<n;i++){const r=s[i];let o=-1;if(typeof r.fontStyle=="string"){o=0;const c=r.fontStyle.split(" ");for(let h=0,d=c.length;h<d;h++)switch(c[h]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break;case"strikethrough":o=o|8;break}}let a=null;typeof r.foreground=="string"&&(a=r.foreground);let l=null;typeof r.background=="string"&&(l=r.background),e[t++]=new F4e(r.token||"",i,o,a,l)}return e}function V4e(s,e){s.sort((h,d)=>{const g=j4e(h.token,d.token);return g!==0?g:h.index-d.index});let t=0,i="000000",n="ffffff";for(;s.length>=1&&s[0].token==="";){const h=s.shift();h.fontStyle!==-1&&(t=h.fontStyle),h.foreground!==null&&(i=h.foreground),h.background!==null&&(n=h.background)}const r=new W4e;for(const h of e)r.getId(h);const o=r.getId(i),a=r.getId(n),l=new Q8(t,o,a),c=new X8(l);for(let h=0,d=s.length;h<d;h++){const g=s[h];c.insert(g.token,g.fontStyle,r.getId(g.foreground),r.getId(g.background))}return new Lie(r,c)}const H4e=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class W4e{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(H4e);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=me.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class Lie{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(B4e(e),t)}static createFromParsedTokenTheme(e,t){return V4e(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),r=U4e(t);i=(n.metadata|r<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const z4e=/\b(comment|string|regex|regexp)\b/;function U4e(s){const e=s.match(z4e);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function j4e(s,e){return s<e?-1:s>e?1:0}class Q8{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new Q8(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class X8{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const r=this._children.get(i);return typeof r<"u"?r.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const r=e.indexOf(".");let o,a;r===-1?(o=e,a=""):(o=e.substring(0,r),a=e.substring(r+1));let l=this._children.get(o);typeof l>"u"&&(l=new X8(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,n)}}function $4e(s){const e=[];for(let t=1,i=s.length;t<i;t++){const n=s[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const q4e={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Oa]:"#FFFFFE",[YC]:"#000000",[tJ]:"#E5EBF1",[JC]:"#D3D3D3",[ey]:"#939393",[iJ]:"#ADD6FF4D"}},G4e={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Oa]:"#1E1E1E",[YC]:"#D4D4D4",[tJ]:"#3A3D41",[JC]:"#404040",[ey]:"#707070",[iJ]:"#ADD6FF26"}},K4e={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Oa]:"#000000",[YC]:"#FFFFFF",[JC]:"#FFFFFF",[ey]:"#FFFFFF"}},Y4e={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Oa]:"#FFFFFF",[YC]:"#292929",[JC]:"#292929",[ey]:"#292929"}},Q4e={IconContribution:"base.contributions.icons"};var Qq;(function(s){function e(t,i){let n=t.defaults;for(;Ct.isThemeIcon(n);){const r=Bm.getIcon(n.id);if(!r)return;n=r.defaults}return n}s.getDefinition=e})(Qq||(Qq={}));var Xq;(function(s){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}s.toJSONObject=e;function t(i){const n=r=>ns(r)?r:void 0;if(i&&Array.isArray(i.src)&&i.src.every(r=>ns(r.format)&&ns(r.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(r=>({format:r.format,location:mt.parse(r.location)}))}}s.fromJSONObject=t})(Xq||(Xq={}));const X4e=/^([\w_-]+)$/,Z4e=v(2024,"The font ID must only contain letters, numbers, underscores and dashes.");class J4e extends le{constructor(){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:v(2025,"The id of the font to use. If not set, the font that is defined first is used."),pattern:X4e.source,patternErrorMessage:Z4e},fontCharacter:{type:"string",description:v(2026,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Ct.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const r=this.iconsById[e];if(r){if(i&&!r.description){r.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return r}const o={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(r,o)=>r.id.localeCompare(o.id),t=r=>{for(;Ct.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(const r of n.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|${Ct.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const r of n.filter(o=>!Ct.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|`);return i.join(`
`)}}const Bm=new J4e;ss.add(Q4e.IconContribution,Bm);function qd(s,e,t,i){return Bm.registerIcon(s,e,t,i)}function kie(){return Bm}function e5e(){const s=NX();for(const e in s){const t="\\"+s[e].toString(16);Bm.registerIcon(e,{fontCharacter:t})}}e5e();const Eie="vscode://schemas/icons",Die=ss.as(TD.JSONContribution);Die.registerSchema(Eie,Bm.getIconSchema());const Zq=new Es(()=>Die.notifySchemaChanged(Eie),200);Bm.onDidChange(()=>{Zq.isScheduled()||Zq.schedule()});qd("widget-close",Ae.close,v(2027,"Icon for the close action in widgets."));qd("goto-previous-location",Ae.arrowUp,v(2028,"Icon for goto previous editor location."));qd("goto-next-location",Ae.arrowDown,v(2029,"Icon for goto next editor location."));Ct.modify(Ae.sync,"spin");Ct.modify(Ae.loading,"spin");function t5e(s){const e=new Pe,t=e.add(new Z),i=kie();return e.add(i.onDidChange(()=>t.fire())),s&&e.add(s.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const n=s?s.getProductIconTheme():new Tie,r={},o=new uA,a=new uA;for(const l of i.getIcons()){const c=n.getIcon(l);if(!c)continue;const h=c.font,d=Vr`--vscode-icon-${Tx(l.id)}-font-family`,g=Vr`--vscode-icon-${Tx(l.id)}-content`;h?(r[h.id]=h.definition,a.push(Vr`${d}: ${Vh(h.id)};`,Vr`${g}: ${Vh(c.fontCharacter)};`),o.push(Vr`.codicon-${Tx(l.id)}:before { content: ${Vh(c.fontCharacter)}; font-family: ${Vh(h.id)}; }`)):(a.push(Vr`${g}: ${Vh(c.fontCharacter)}; ${d}: 'codicon';`),o.push(Vr`.codicon-${Tx(l.id)}:before { content: ${Vh(c.fontCharacter)}; }`))}for(const l in r){const c=r[l],h=c.weight?Vr`font-weight: ${_q(c.weight)};`:Vr``,d=c.style?Vr`font-style: ${_q(c.style)};`:Vr``,g=new uA;for(const p of c.src)g.push(Vr`${vc(p.location)} format(${Vh(p.format)})`);o.push(Vr`@font-face { src: ${g.join(", ")}; font-family: ${Vh(l)};${h}${d} font-display: block; }`)}return o.push(Vr`:root { ${a.join(" ")} }`),o.join(`
`)}}}class Tie{getIcon(e){const t=kie();let i=e.defaults;for(;Ct.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const ed="vs",Tw="vs-dark",J_="hc-black",e1="hc-light",Nie=ss.as(KZ.ColorContribution),i5e=ss.as(PJ.ThemingContribution);class Iie{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(dL(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,me.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=C3(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,me.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=Nie.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case ed:return na.LIGHT;case J_:return na.HIGH_CONTRAST_DARK;case e1:return na.HIGH_CONTRAST_LIGHT;default:return na.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const r=C3(this.themeData.base);e=r.rules,r.encodedTokensColors&&(t=r.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const r={token:""};i&&(r.foreground=i),n&&(r.background=n),e.push(r)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=Lie.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const r=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=_o.getForeground(r),a=_o.getFontStyle(r);return{foreground:o,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}get tokenColorMap(){return[]}}function dL(s){return s===ed||s===Tw||s===J_||s===e1}function C3(s){switch(s){case ed:return q4e;case Tw:return G4e;case J_:return K4e;case e1:return Y4e}}function Ax(s){const e=C3(s);return new Iie(s,e)}class n5e extends le{constructor(){super(),this._onColorThemeChange=this._register(new Z),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new Z),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new Tie,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(ed,Ax(ed)),this._knownThemes.set(Tw,Ax(Tw)),this._knownThemes.set(J_,Ax(J_)),this._knownThemes.set(e1,Ax(e1));const e=this._register(t5e(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(ed),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),VX(ni,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return I4(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=bl(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),le.None}_registerShadowDomContainer(e){const t=bl(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!dL(t.base)&&!dL(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new Iie(e,t)),dL(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(ed),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=ni.matchMedia("(forced-colors: active)").matches;if(e!==W_(this._theme.type)){let t;Rm(this._theme.type)?t=e?J_:Tw:t=e?e1:ed,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:o=>{t[o]||(e.push(o),t[o]=!0)}};i5e.getThemingParticipants().forEach(o=>o(this._theme,i,this._environment));const n=[];for(const o of Nie.getColors()){const a=this._theme.getColor(o.id,!0);a&&n.push(`${D7(o.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${n.join(`
`)} }`);const r=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule($4e(r)),i.addRule(".monaco-editor, .monaco-diff-editor, .monaco-component { forced-color-adjust: none; }"),this._themeCSS=e.join(`
`),this._updateCSS(),hn.setColorMap(r),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const Va=gt("themeService");var s5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yA=function(s,e){return function(t,i){e(t,i,s)}};let y3=class extends le{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new Z,this._onDidChangeReducedMotion=new Z,this._onDidChangeLinkUnderline=new Z,this._accessibilityModeEnabledContext=_ve.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),o.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const r=ni.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=r.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(r),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(ie(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("monaco-reduce-motion",i),this._layoutService.mainContainer.classList.toggle("monaco-enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};y3=s5e([yA(0,Ot),yA(1,ch),yA(2,yi)],y3);var oT=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lc=function(s,e){return function(t,i){e(t,i,s)}},$p,F0;let S3=class{constructor(e,t,i){this._commandService=e,this._keybindingService=t,this._hiddenStates=new x3(i)}createMenu(e,t,i){return new T2(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){const n=new T2(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),r=n.getActions(i);return n.dispose(),r}resetHiddenStates(e){this._hiddenStates.reset(e)}};S3=oT([lc(0,Ao),lc(1,rs),lc(2,ry)],S3);var Wg;let x3=(Wg=class{constructor(e){this._storageService=e,this._disposables=new Pe,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get($p._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,$p._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get($p._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){var r;const i=this._isHiddenByDefault(e,t),n=((r=this._data[e.id])==null?void 0:r.includes(t))??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const r=this._data[e.id];if(i)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){const o=r.indexOf(t);o>=0&&Gge(r,o),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store($p._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}},$p=Wg,Wg._key="menu.hiddenCommands",Wg);x3=$p=oT([lc(0,ry)],x3);class Nw{constructor(e,t){this._id=e,this._collectContextKeysForSubmenus=t,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=this._sort(y1.getMenuItems(this._id));let t;for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(Nw._fillInKbExprKeys(e.when,this._structureContextKeys),J0(e)){if(e.command.precondition&&Nw._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;Nw._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(y1.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}}let L3=F0=class extends Nw{constructor(e,t,i,n,r,o){super(e,i),this._hiddenStates=t,this._commandService=n,this._keybindingService=r,this._contextKeyService=o,this.refresh()}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[n,r]=i;let o;for(const a of r)if(this._contextKeyService.contextMatchesRules(a.when)){const l=J0(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=r5e(this._id,l?a.command:a,this._hiddenStates);if(l){const h=Rie(this._commandService,this._keybindingService,a.command.id,a.when);(o??(o=[])).push(new $u(a.command,a.alt,e,c,h,this._contextKeyService,this._commandService))}else{const h=new F0(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),d=is.join(...h.map(g=>g[1]));d.length>0&&(o??(o=[])).push(new P_(a,c,d))}}o&&o.length>0&&t.push([n,o])}return t}_sort(e){return e.sort(F0._compareMenuItems)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const r=e.order||0,o=t.order||0;return r<o?-1:r>o?1:F0._compareTitles(J0(e)?e.command.title:e.title,J0(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};L3=F0=oT([lc(3,Ao),lc(4,rs),lc(5,Ot)],L3);let T2=class{constructor(e,t,i,n,r,o){this._disposables=new Pe,this._menuInfo=new L3(e,t,i.emitEventsForSubmenuChanges,n,r,o);const a=new Es(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(y1.onDidChangeMenu(d=>{for(const g of this._menuInfo.allMenuIds)if(d.has(g)){a.schedule();break}}));const l=this._disposables.add(new Pe),c=d=>{let g=!1,p=!1,_=!1;for(const b of d)if(g=g||b.isStructuralChange,p=p||b.isEnablementChange,_=_||b.isToggleChange,g&&p&&_)break;return{menu:this,isStructuralChange:g,isEnablementChange:p,isToggleChange:_}},h=()=>{l.add(o.onDidChangeContext(d=>{const g=d.affectsSome(this._menuInfo.structureContextKeys),p=d.affectsSome(this._menuInfo.preconditionContextKeys),_=d.affectsSome(this._menuInfo.toggledContextKeys);(g||p||_)&&this._onDidChange.fire({menu:this,isStructuralChange:g,isEnablementChange:p,isToggleChange:_})})),l.add(t.onDidChange(d=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new fX({onWillAddFirstListener:h,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:c}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};T2=oT([lc(3,Ao),lc(4,rs),lc(5,Ot)],T2);function r5e(s,e,t){const i=obe(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,r=Sg({id:`hide/${s.id}/${i}`,label:v(1651,"Hide '{0}'",n),run(){t.updateHidden(s,i,!0)}}),o=Sg({id:`toggle/${s.id}/${i}`,label:n,get checked(){return!t.isHidden(s,i)},run(){t.updateHidden(s,i,!!this.checked)}});return{hide:r,toggle:o,get isHidden(){return!o.checked}}}function Rie(s,e,t,i=void 0,n=!0){return Sg({id:`configureKeybinding/${t}`,label:v(1652,"Configure Keybinding"),enabled:n,run(){const o=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;s.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(o?` +when:${o}`:""))}})}var o5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Jq=function(s,e){return function(t,i){e(t,i,s)}},k3;const eG="application/vnd.code.resources";var zg;let E3=(zg=class extends le{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(nm||HX)&&this.installWebKitWriteTextWorkaround(),this._register(Se.runAndSubscribe(zC,({window:i,disposables:n})=>{n.add(ie(i.document,"copy",()=>this.clearResourcesState()))},{window:ni,disposables:this._store}))}triggerPaste(){this.logService.trace("BrowserClipboardService#triggerPaste")}installWebKitWriteTextWorkaround(){const e=()=>{const t=new uD;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,Kt().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(Se.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(ie(t,"click",e)),i.add(ie(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.logService.trace("BrowserClipboardService#writeText called with type:",t," text.length:",e.length),this.clearResourcesState(),t){this.mapTextToType.set(t,e),this.logService.trace("BrowserClipboardService#writeText");return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return this.logService.trace("before navigator.clipboard.writeText"),await Kt().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){this.logService.trace("BrowserClipboardService#fallbackWriteText");const t=gD(),i=t.activeElement,n=t.body.appendChild(Ke("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),t.execCommand("copy"),nn(i)&&i.focus(),n.remove()}async readText(e){if(this.logService.trace("BrowserClipboardService#readText called with type:",e),e){const t=this.mapTextToType.get(e)||"";return this.logService.trace("BrowserClipboardService#readText text.length:",t.length),t}try{const t=await Kt().navigator.clipboard.readText();return this.logService.trace("BrowserClipboardService#readText text.length:",t.length),t}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}async readResources(){try{const t=await Kt().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${eG}`)){const n=await i.getType(`web ${eG}`);return JSON.parse(await n.text()).map(o=>mt.from(o))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return Z6(e.substring(0,k3.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}},k3=zg,zg.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,zg);E3=k3=o5e([Jq(0,ch),Jq(1,pr)],E3);const Z8=gt("clipboardService");var a5e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},l5e=function(s,e){return function(t,i){e(t,i,s)}};const Iw="data-keybinding-context";class J8{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}}const DE=class DE extends J8{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}};DE.INSTANCE=new DE;let P1=DE;const jw=class jw extends J8{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=kw.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const r=Array.from(this._values,([o])=>o);this._values.clear(),i.fire(new iG(r))}else{const r=[];for(const o of n.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(r.push(...Dt.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(r.push(a),this._values.delete(a))}i.fire(new iG(r))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(jw._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(jw._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}};jw._keyPrefix="config.";let D3=jw;class c5e{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class tG{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class iG{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class u5e{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function h5e(s,e){return s.allKeysContainedIn(new Set(Object.keys(e)))}class Aie extends le{get onDidChangeContext(){return this._onDidChangeContext.event}constructor(e){super(),this._onDidChangeContext=this._register(new vv({merge:t=>new u5e(t)})),this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new c5e(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new d5e(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new tG(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new tG(e))}getContext(e){return this._isDisposed?P1.INSTANCE:this.getContextValuesContainer(f5e(e))}dispose(){super.dispose(),this._isDisposed=!0}}let T3=class extends Aie{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0,this.inputFocusedContext=fie.bindTo(this);const t=this._register(new D3(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t),this._register(Se.runAndSubscribe(zC,({window:i,disposables:n})=>{const r=n.add(new Yn);n.add(ie(i,Le.FOCUS_IN,()=>{r.value=new Pe,this.updateInputContextKeys(i.document,r.value)},!0))},{window:ni,disposables:this._store}))}updateInputContextKeys(e,t){function i(){return!!e.activeElement&&gl(e.activeElement)}const n=i();if(this.inputFocusedContext.set(n),n){const r=t.add(C1(e.activeElement));Se.once(r.onDidBlur)(()=>{Kt().document===e&&this.inputFocusedContext.set(i()),r.dispose()},void 0,t)}}getContextValuesContainer(e){return this._isDisposed?P1.INSTANCE:this._contexts.get(e)||P1.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new J8(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};T3=a5e([l5e(0,yi)],T3);class d5e extends Aie{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new Yn),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(Iw)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(Iw,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;h5e(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(Iw),super.dispose())}getContextValuesContainer(e){return this._isDisposed?P1.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function f5e(s){for(;s;){if(s.hasAttribute(Iw)){const e=s.getAttribute(Iw);return e?parseInt(e,10):NaN}s=s.parentElement}return 0}function g5e(s,e,t){s.get(Ot).createKey(String(e),m5e(t))}function m5e(s){return oX(s,e=>{if(typeof e=="object"&&e.$mid===1)return mt.revive(e).toString();if(e instanceof mt)return e.toString()})}Or.registerCommand("_setContext",g5e);Or.registerCommand({id:"getContextKeyInfo",handler(){return[...He.all()].sort((s,e)=>s.key.localeCompare(e.key))},metadata:{description:v(1674,"A command that returns information about context keys"),args:[]}});Or.registerCommand("_generateContextKeyInfo",function(){const s=[],e=new Set;for(const t of He.all())e.has(t.key)||(e.add(t.key),s.push(t));s.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(s,void 0,2))});let p5e=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class nG{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new p5e(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this._findCycle(n,t);if(r)return r;t.delete(i)}}}const _5e=!1;class sG extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class N2{constructor(e=new ib,t=!1,i,n=_5e){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(It,this),this._globalGraph=n?(i==null?void 0:i._globalGraph)??new nG(r=>r):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,_n(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)rD(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,n=new class extends N2{dispose(){i._children.delete(n),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(n),t==null||t.add(n),n}invokeFunction(e,...t){this._throwIfDisposed();const i=Rw.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:o=>{if(n)throw QL("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a},getIfExists:o=>{if(n)throw QL("service accessor is only valid during the invocation of its target method");return this._getOrCreateServiceInstance(o,i)}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof Gl?(i=Rw.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Rw.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=hl.getServiceDependencies(e).sort((a,l)=>a.index-l.index),r=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),r.push(l)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(r))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof Gl)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Gl?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var l;const n=new nG(c=>c.id.toString());let r=0;const o=[{id:e,desc:t,_trace:i}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),n.lookupOrInsertNode(c),r++>1e3)throw new sG(n);for(const h of hl.getServiceDependencies(c.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(h.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${h.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(h.id)),d instanceof Gl){const g={id:h.id,desc:d,_trace:c._trace.branch(h.id,!0)};n.insertEdge(c,g),o.push(g)}}}}for(;;){const c=n.roots();if(c.length===0){if(!n.isEmpty())throw new sG(n);break}for(const{data:h}of c){if(this._getServiceInstanceOrDescriptor(h.id)instanceof Gl){const g=this._createServiceInstanceWithOwner(h.id,h.desc.ctor,h.desc.staticArguments,h.desc.supportsDelayedInstantiation,h._trace);this._setCreatedServiceInstance(h.id,g)}n.removeNode(h)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,r){if(this._services.get(e)instanceof Gl)return this._createServiceInstance(e,t,i,n,r,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,r);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,r,o){if(n){const a=new N2(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new A_e(()=>{const h=a._createInstance(t,i,r);for(const[d,g]of l){const p=h[d];if(typeof p=="function")for(const _ of g)_.disposable=p.apply(h,_.listener)}return l.clear(),o.add(h),h});return new Proxy(Object.create(null),{get(h,d){if(!c.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let _=l.get(d);return _||(_=new Dr,l.set(d,_)),(C,x,S)=>{if(c.isInitialized)return c.value[d](C,x,S);{const y={listener:[C,x,S],disposable:void 0},k=_.push(y);return qe(()=>{var R;k(),(R=y.disposable)==null||R.dispose()})}}}if(d in h)return h[d];const g=c.value;let p=g[d];return typeof p!="function"||(p=p.bind(g),h[d]=p),p},set(h,d,g){return c.value[d]=g,!0},getPrototypeOf(h){return t.prototype}})}else{const a=this._createInstance(t,i,r);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const uo=class uo{static traceInvocation(e,t){return e?new uo(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):uo._None}static traceCreation(e,t){return e?new uo(1,t.name):uo._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new uo(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;uo._totals+=e;let t=!1;function i(r,o){const a=[],l=new Array(r+1).join("	");for(const[c,h,d]of o._dep)if(h&&d){t=!0,a.push(`${l}CREATES -> ${c}`);const g=i(r+1,d);g&&a.push(g)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${uo._totals.toFixed(2)}ms)`];(e>2||t)&&uo.all.add(n.join(`
`))}};uo.all=new Set,uo._None=new class extends uo{constructor(){super(0,null)}stop(){}branch(){return this}},uo._totals=0;let Rw=uo;const b5e=new Set([tt.inMemory,tt.vscodeSourceControl,tt.walkThrough,tt.walkThroughSnippet,tt.vscodeChatCodeBlock,tt.vscodeTerminal]);class w5e{constructor(){this._byResource=new Ts,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let r=this._byOwner.get(t);r||(r=new Ts,this._byOwner.set(t,r)),r.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,n=!1;const r=this._byResource.get(e);r&&(i=r.delete(t));const o=this._byOwner.get(t);if(o&&(n=o.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){var t,i;return typeof e=="string"?((t=this._byOwner.get(e))==null?void 0:t.values())??Dt.empty():mt.isUri(e)?((i=this._byResource.get(e))==null?void 0:i.values())??Dt.empty():Dt.map(Dt.concat(...this._byOwner.values()),n=>n[1])}}class v5e{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new Ts,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(b5e.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===bo.Error?t.errors+=1:i===bo.Warning?t.warnings+=1:i===bo.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class Kf{constructor(){this._onMarkerChanged=new fX({delay:0,merge:Kf._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new w5e,this._stats=new v5e(this),this._filteredResources=new Ts}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(Qge(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const r of i){const o=Kf._toMarker(e,t,r);o&&n.push(o)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:h,endColumn:d,relatedInformation:g,tags:p,origin:_}=i;if(o)return l=l>0?l:1,c=c>0?c:1,h=h>=l?h:l,d=d>0?d:c,{resource:t,owner:e,code:n,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:h,endColumn:d,relatedInformation:g,tags:p,origin:_}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const r of n){const o=Dt.first(r);o&&(i.push(o.resource),this._data.delete(o.resource,e))}if(iD(t)){const r=new Ts;for(const{resource:o,marker:a}of t){const l=Kf._toMarker(e,o,a);if(!l)continue;const c=r.get(o);c?c.push(l):(r.set(o,[l]),i.push(o))}for(const[o,a]of r)this._data.set(o,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}_createFilteredMarker(e,t){const i=t.length===1?v(1738,'Problems are paused because: "{0}"',t[0]):v(1739,'Problems are paused because: "{0}" and {1} more',t[0],t.length-1);return{owner:"markersFilter",resource:e,severity:bo.Info,message:i,startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1}}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:r}=e;if((!r||r<0)&&(r=-1),t&&i){const o=e.ignoreResourceFilters?void 0:this._filteredResources.get(i);if(o!=null&&o.length)return[this._createFilteredMarker(i,o)];const a=this._data.get(i,t);if(!a)return[];const l=[];for(const c of a){if(r>0&&l.length===r)break;const h=e.ignoreResourceFilters?void 0:this._filteredResources.get(i);h!=null&&h.length?l.push(this._createFilteredMarker(i,h)):Kf._accept(c,n)&&l.push(c)}return l}else{const o=!t&&!i?this._data.values():this._data.values(i??t),a=[],l=new cbe;for(const c of o)for(const h of c){if(l.has(h.resource))continue;if(r>0&&a.length===r)break;const d=e.ignoreResourceFilters?void 0:this._filteredResources.get(h.resource);d!=null&&d.length?(a.push(this._createFilteredMarker(h.resource,d)),l.add(h.resource)):Kf._accept(h,n)&&a.push(h)}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new Ts;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}class C5e extends le{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=ts.createEmptyModel(e)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=ts.createEmptyModel(this.logService);const e=ss.as(Dm.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const n of e){const r=i[n],o=t[n];r!==void 0?this._configurationModel.setValue(n,r):o?this._configurationModel.setValue(n,vu(o.default)):this._configurationModel.removeValue(n)}}}const aT=gt("accessibilitySignalService"),nt=class nt{static register(e){return new nt(e.fileName)}constructor(e){this.fileName=e}};nt.error=nt.register({fileName:"error.mp3"}),nt.warning=nt.register({fileName:"warning.mp3"}),nt.success=nt.register({fileName:"success.mp3"}),nt.foldedArea=nt.register({fileName:"foldedAreas.mp3"}),nt.break=nt.register({fileName:"break.mp3"}),nt.quickFixes=nt.register({fileName:"quickFixes.mp3"}),nt.taskCompleted=nt.register({fileName:"taskCompleted.mp3"}),nt.taskFailed=nt.register({fileName:"taskFailed.mp3"}),nt.terminalBell=nt.register({fileName:"terminalBell.mp3"}),nt.diffLineInserted=nt.register({fileName:"diffLineInserted.mp3"}),nt.diffLineDeleted=nt.register({fileName:"diffLineDeleted.mp3"}),nt.diffLineModified=nt.register({fileName:"diffLineModified.mp3"}),nt.requestSent=nt.register({fileName:"requestSent.mp3"}),nt.responseReceived1=nt.register({fileName:"responseReceived1.mp3"}),nt.responseReceived2=nt.register({fileName:"responseReceived2.mp3"}),nt.responseReceived3=nt.register({fileName:"responseReceived3.mp3"}),nt.responseReceived4=nt.register({fileName:"responseReceived4.mp3"}),nt.clear=nt.register({fileName:"clear.mp3"}),nt.save=nt.register({fileName:"save.mp3"}),nt.format=nt.register({fileName:"format.mp3"}),nt.voiceRecordingStarted=nt.register({fileName:"voiceRecordingStarted.mp3"}),nt.voiceRecordingStopped=nt.register({fileName:"voiceRecordingStopped.mp3"}),nt.progress=nt.register({fileName:"progress.mp3"}),nt.chatEditModifiedFile=nt.register({fileName:"chatEditModifiedFile.mp3"}),nt.editsKept=nt.register({fileName:"editsKept.mp3"}),nt.editsUndone=nt.register({fileName:"editsUndone.mp3"}),nt.nextEditSuggestion=nt.register({fileName:"nextEditSuggestion.mp3"}),nt.terminalCommandSucceeded=nt.register({fileName:"terminalCommandSucceeded.mp3"}),nt.chatUserActionRequired=nt.register({fileName:"chatUserActionRequired.mp3"}),nt.codeActionTriggered=nt.register({fileName:"codeActionTriggered.mp3"}),nt.codeActionApplied=nt.register({fileName:"codeActionApplied.mp3"});let Gt=nt;class y5e{constructor(e){this.randomOneOf=e}}const Ye=class Ye{constructor(e,t,i,n,r,o,a=!1){this.sound=e,this.name=t,this.legacySoundSettingsKey=i,this.settingsKey=n,this.legacyAnnouncementSettingsKey=r,this.announcementMessage=o,this.managesOwnEnablement=a}static register(e){const t=new y5e("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new Ye(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage,e.managesOwnEnablement);return Ye._signals.add(i),i}};Ye._signals=new Set,Ye.errorAtPosition=Ye.register({name:v(1576,"Error at Position"),sound:Gt.error,announcementMessage:v(1577,"Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"}),Ye.warningAtPosition=Ye.register({name:v(1578,"Warning at Position"),sound:Gt.warning,announcementMessage:v(1579,"Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"}),Ye.errorOnLine=Ye.register({name:v(1580,"Error on Line"),sound:Gt.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:v(1581,"Error on Line"),settingsKey:"accessibility.signals.lineHasError"}),Ye.warningOnLine=Ye.register({name:v(1582,"Warning on Line"),sound:Gt.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:v(1583,"Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"}),Ye.foldedArea=Ye.register({name:v(1584,"Folded Area on Line"),sound:Gt.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:v(1585,"Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"}),Ye.break=Ye.register({name:v(1586,"Breakpoint on Line"),sound:Gt.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:v(1587,"Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"}),Ye.inlineSuggestion=Ye.register({name:v(1588,"Inline Suggestion on Line"),sound:Gt.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"}),Ye.nextEditSuggestion=Ye.register({name:v(1589,"Next Edit Suggestion on Line"),sound:Gt.nextEditSuggestion,legacySoundSettingsKey:"audioCues.nextEditSuggestion",settingsKey:"accessibility.signals.nextEditSuggestion",announcementMessage:v(1590,"Next Edit Suggestion")}),Ye.terminalQuickFix=Ye.register({name:v(1591,"Terminal Quick Fix"),sound:Gt.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:v(1592,"Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"}),Ye.onDebugBreak=Ye.register({name:v(1593,"Debugger Stopped on Breakpoint"),sound:Gt.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:v(1594,"Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"}),Ye.noInlayHints=Ye.register({name:v(1595,"No Inlay Hints on Line"),sound:Gt.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:v(1596,"No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"}),Ye.taskCompleted=Ye.register({name:v(1597,"Task Completed"),sound:Gt.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:v(1598,"Task Completed"),settingsKey:"accessibility.signals.taskCompleted"}),Ye.taskFailed=Ye.register({name:v(1599,"Task Failed"),sound:Gt.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:v(1600,"Task Failed"),settingsKey:"accessibility.signals.taskFailed"}),Ye.terminalCommandFailed=Ye.register({name:v(1601,"Terminal Command Failed"),sound:Gt.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:v(1602,"Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"}),Ye.terminalCommandSucceeded=Ye.register({name:v(1603,"Terminal Command Succeeded"),sound:Gt.terminalCommandSucceeded,announcementMessage:v(1604,"Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"}),Ye.terminalBell=Ye.register({name:v(1605,"Terminal Bell"),sound:Gt.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:v(1606,"Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"}),Ye.notebookCellCompleted=Ye.register({name:v(1607,"Notebook Cell Completed"),sound:Gt.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:v(1608,"Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"}),Ye.notebookCellFailed=Ye.register({name:v(1609,"Notebook Cell Failed"),sound:Gt.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:v(1610,"Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"}),Ye.diffLineInserted=Ye.register({name:v(1611,"Diff Line Inserted"),sound:Gt.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"}),Ye.diffLineDeleted=Ye.register({name:v(1612,"Diff Line Deleted"),sound:Gt.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"}),Ye.diffLineModified=Ye.register({name:v(1613,"Diff Line Modified"),sound:Gt.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"}),Ye.chatEditModifiedFile=Ye.register({name:v(1614,"Chat Edit Modified File"),sound:Gt.chatEditModifiedFile,announcementMessage:v(1615,"File Modified from Chat Edits"),settingsKey:"accessibility.signals.chatEditModifiedFile"}),Ye.chatRequestSent=Ye.register({name:v(1616,"Chat Request Sent"),sound:Gt.requestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:v(1617,"Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"}),Ye.chatResponseReceived=Ye.register({name:v(1618,"Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Gt.responseReceived1,Gt.responseReceived2,Gt.responseReceived3,Gt.responseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"}),Ye.codeActionTriggered=Ye.register({name:v(1619,"Code Action Request Triggered"),sound:Gt.codeActionTriggered,legacySoundSettingsKey:"audioCues.codeActionRequestTriggered",legacyAnnouncementSettingsKey:"accessibility.alert.codeActionRequestTriggered",announcementMessage:v(1620,"Code Action Request Triggered"),settingsKey:"accessibility.signals.codeActionTriggered"}),Ye.codeActionApplied=Ye.register({name:v(1621,"Code Action Applied"),legacySoundSettingsKey:"audioCues.codeActionApplied",sound:Gt.codeActionApplied,settingsKey:"accessibility.signals.codeActionApplied"}),Ye.progress=Ye.register({name:v(1622,"Progress"),sound:Gt.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:v(1623,"Progress"),settingsKey:"accessibility.signals.progress"}),Ye.clear=Ye.register({name:v(1624,"Clear"),sound:Gt.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:v(1625,"Clear"),settingsKey:"accessibility.signals.clear"}),Ye.save=Ye.register({name:v(1626,"Save"),sound:Gt.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:v(1627,"Save"),settingsKey:"accessibility.signals.save"}),Ye.format=Ye.register({name:v(1628,"Format"),sound:Gt.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:v(1629,"Format"),settingsKey:"accessibility.signals.format"}),Ye.voiceRecordingStarted=Ye.register({name:v(1630,"Voice Recording Started"),sound:Gt.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"}),Ye.voiceRecordingStopped=Ye.register({name:v(1631,"Voice Recording Stopped"),sound:Gt.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"}),Ye.editsKept=Ye.register({name:v(1632,"Edits Kept"),sound:Gt.editsKept,announcementMessage:v(1633,"Edits Kept"),settingsKey:"accessibility.signals.editsKept"}),Ye.editsUndone=Ye.register({name:v(1634,"Undo Edits"),sound:Gt.editsUndone,announcementMessage:v(1635,"Edits Undone"),settingsKey:"accessibility.signals.editsUndone"}),Ye.chatUserActionRequired=Ye.register({name:v(1636,"Chat User Action Required"),sound:Gt.chatUserActionRequired,announcementMessage:v(1637,"Chat User Action Required"),settingsKey:"accessibility.signals.chatUserActionRequired",managesOwnEnablement:!0});let Yl=Ye;class S5e extends le{constructor(e,t=[]){super(),this.logger=new Sbe([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const x5e=[];function L5e(){return x5e.slice(0)}class k5e{getParserClass(){throw new Error("not implemented in StandaloneTreeSitterLibraryService")}supportsLanguage(e,t){return!1}getLanguage(e,t,i){}getInjectionQueries(e,t){return null}getHighlightingQueries(e,t){return null}}const E5e=gt("dataChannelService");class D5e{getDataChannel(e){return{sendData:()=>{}}}}var Tc=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},en=function(s,e){return function(t,i){e(t,i,s)}};class T5e{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new Z}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let N3=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new Cme(new T5e(t))):Promise.reject(new Error("Model not found"))}};N3=Tc([en(0,mr)],N3);const TE=class TE{show(){return TE.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}};TE.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};let I3=TE;class N5e{withProgress(e,t,i){return t({report:()=>{}})}}class I5e{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class R5e{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),ni.confirm(i)}async prompt(e){var n;let t;if(this.doConfirm(e.message,e.detail)){const r=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&r.push(e.cancelButton),t=await((n=r[0])==null?void 0:n.run({checkboxChecked:!1}))}return{result:t}}async error(e,t){await this.prompt({type:Ji.Error,message:e,detail:t})}}const $w=class $w{info(e){return this.notify({severity:Ji.Info,message:e})}warn(e){return this.notify({severity:Ji.Warning,message:e})}error(e){return this.notify({severity:Ji.Error,message:e})}notify(e){switch(e.severity){case Ji.Error:console.error(e.message);break;case Ji.Warning:console.warn(e.message);break;default:console.log(e.message);break}return $w.NO_OP}prompt(e,t,i,n){return $w.NO_OP}status(e,t){return{close:()=>{}}}};$w.NO_OP=new yLe;let R3=$w,A3=class{constructor(e){this._onWillExecuteCommand=new Z,this._onDidExecuteCommand=new Z,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=Or.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};A3=Tc([en(0,It)],A3);let F1=class extends $Ie{constructor(e,t,i,n,r,o){super(e,t,i,n,r),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=p=>{const _=new Pe;_.add(ie(p,Le.KEY_DOWN,b=>{const C=new si(b);this._dispatch(C,C.target)&&(C.preventDefault(),C.stopPropagation())})),_.add(ie(p,Le.KEY_UP,b=>{const C=new si(b);this._singleModifierDispatch(C,C.target)&&C.preventDefault()})),this._domNodeListeners.push(new A5e(p,_))},l=p=>{for(let _=0;_<this._domNodeListeners.length;_++){const b=this._domNodeListeners[_];b.domNode===p&&(this._domNodeListeners.splice(_,1),b.dispose())}},c=p=>{p.getOption(70)||a(p.getContainerDomNode())},h=p=>{p.getOption(70)||l(p.getContainerDomNode())};this._register(o.onCodeEditorAdd(c)),this._register(o.onCodeEditorRemove(h)),o.listCodeEditors().forEach(c);const d=p=>{a(p.getContainerDomNode())},g=p=>{l(p.getContainerDomNode())};this._register(o.onDiffEditorAdd(d)),this._register(o.onDiffEditorRemove(g)),o.listDiffEditors().forEach(d)}addDynamicKeybinding(e,t,i,n){return nc(Or.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:b4(i.keybinding,Na),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),qe(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Hd.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new Lw(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return ni.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const r of e){const o=r.when||void 0,a=r.keybinding;if(!a)i[n++]=new aq(void 0,r.command,r.commandArgs,o,t,null,!1);else{const l=aC.resolveKeybinding(a,Na);for(const c of l)i[n++]=new aq(c,r.command,r.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new sm(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new aC([t],Na)}};F1=Tc([en(0,Ot),en(1,Ao),en(2,ah),en(3,Ba),en(4,pr),en(5,In)],F1);class A5e extends le{constructor(e,t){super(),this.domNode=e,this._register(t)}}function rG(s){return!!s&&typeof s=="object"&&(!s.overrideIdentifier||typeof s.overrideIdentifier=="string")&&(!s.resource||s.resource instanceof mt)}let I2=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new Z,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new C5e(e);this._configuration=new YD(t.reload(),ts.createEmptyModel(e),ts.createEmptyModel(e),ts.createEmptyModel(e),ts.createEmptyModel(e),ts.createEmptyModel(e),new Ts,ts.createEmptyModel(e),new Ts,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,n=rG(e)?e:rG(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[r,o]=n;this.getValue(r)!==o&&(this._configuration.updateValue(r,o),i.push(r))}if(i.length>0){const n=new WIe({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);n.source=8,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};I2=Tc([en(0,pr)],I2);let M3=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new Z,this.configurationService.onDidChangeConfiguration(n=>{this._onDidChangeConfiguration.fire({affectedKeys:n.affectedKeys,affectsConfiguration:(r,o)=>n.affectsConfiguration(o)})})}getValue(e,t,i){const n=J.isIPosition(t)?t:null,r=n?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,o=e?this.getLanguage(e,n):void 0;return typeof r>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:o}):this.configurationService.getValue(r,{resource:e,overrideIdentifier:o})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};M3=Tc([en(0,yi),en(1,mr),en(2,Qn)],M3);let O3=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:Gr||_t?`
`:`\r
`}};O3=Tc([en(0,yi)],O3);class M5e{publicLog2(){}}const qw=class qw{constructor(){const e=mt.from({scheme:qw.SCHEME,authority:"model",path:"/"});this.workspace={id:oRe,folders:[new sRe({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===qw.SCHEME?this.workspace.folders[0]:null}};qw.SCHEME="inmemory";let P3=qw;function R2(s,e,t){if(!e||!(s instanceof I2))return;const i=[];Object.keys(e).forEach(n=>{OIe(n)&&i.push([`editor.${n}`,e[n]]),t&&PIe(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&s.updateValues(i)}let F3=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:L8.convert(e),n=new Map;for(const a of i){if(!(a instanceof Rg))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=n.get(l);c||(c=[],n.set(l,c)),c.push(BIe.replaceMove(G.lift(a.textEdit.range),a.textEdit.text))}let r=0,o=0;for(const[a,l]of n)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),o+=1,r+=l.length;return{ariaSummary:g4(RO.bulkEditServiceSummary,r,o),isApplied:r>0}}};F3=Tc([en(0,mr)],F3);class O5e{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return m7(e)}}let B3=class extends vIe{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};B3=Tc([en(0,ch),en(1,In)],B3);class P5e{constructor(){this._neverEmitter=new Z,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class F5e extends MO{constructor(){super()}}class B5e extends S5e{constructor(){super(new ybe)}}let V3=class extends UO{constructor(e,t,i,n,r,o){super(e,t,i,n,r,o),this.configure({blockMouse:!1})}};V3=Tc([en(0,ah),en(1,Ba),en(2,iy),en(3,rs),en(4,Em),en(5,Ot)],V3);const V5e={esmModuleLocation:void 0,label:"editorWorkerService"};let H3=class extends Z4{constructor(e,t,i,n,r){super(V5e,e,t,i,n,r)}};H3=Tc([en(0,mr),en(1,y7),en(2,pr),en(3,kc),en(4,mi)],H3);class H5e{async playSignal(e,t){}}yt(pr,B5e,0);yt(yi,I2,0);yt(y7,M3,0);yt(VZ,O3,0);yt(nRe,P3,0);yt(XIe,O5e,0);yt(ah,M5e,0);yt(Pee,R5e,0);yt(Wee,I5e,0);yt(Ba,R3,0);yt(Pm,Kf,0);yt(Qn,F5e,0);yt(Va,n5e,0);yt(mr,YO,0);yt($Z,KO,0);yt(Ot,T3,0);yt(ZIe,N5e,0);yt(E8,I3,0);yt(ry,DIe,0);yt(uy,H3,0);yt(RIe,F3,0);yt(aRe,P5e,0);yt(pD,N3,0);yt(Mo,y3,0);yt(Dc,c4e,0);yt(Ao,A3,0);yt(rs,F1,0);yt(Om,w3,0);yt(iy,B3,0);yt(GD,GO,0);yt(Z8,E3,0);yt(uh,V3,0);yt(Em,S3,0);yt(aT,H5e,0);yt(s8,k5e,0);yt(vbe,kbe,0);yt(E5e,D5e,0);var Ge;(function(s){const e=new ib;for(const[l,c]of Qz())e.set(l,c);const t=new N2(e,!0);e.set(It,t);function i(l){n||o({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof Gl?t.invokeFunction(h=>h.get(l)):c}s.get=i;let n=!1;const r=new Z;function o(l){if(n)return t;n=!0;for(const[h,d]of Qz())e.get(h)||e.set(h,d);for(const h in l)if(l.hasOwnProperty(h)){const d=gt(h);e.get(d)instanceof Gl&&e.set(d,l[h])}const c=L5e();for(const h of c)try{t.createInstance(h)}catch(d){$t(d)}return r.fire(),t}s.initialize=o;function a(l){if(n)return l();const c=new Pe,h=c.add(r.event(()=>{h.dispose(),c.add(l())}));return c}s.withServices=a})(Ge||(Ge={}));function cu(s,e){return s}function ou(s,e,t,i=Is.ofCaller()){const n=s.bindTo(e),r=new Pe;return sc({debugName:()=>`Set Context Key "${s.key}"`},o=>{const a=t(o);return n.set(a),a},i).recomputeInitiallyAndOnChange(r),r}class A2{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new A2(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const r=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-r}return new A2(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,n,r){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=n,this._cursorPosition=r}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}}function W5e(s,e,t,i){if(s.length===0)return e;if(e.length===0)return s;const n=[];let r=0,o=0;for(;r<s.length&&o<e.length;){const a=s[r],l=e[o],c=t(a),h=t(l);c<h?(n.push(a),r++):c>h?(n.push(l),o++):(n.push(i(a,l)),r++,o++)}for(;r<s.length;)n.push(s[r]),r++;for(;o<e.length;)n.push(e[o]),o++;return n}function M2(s,e){const t=new Pe,i=s.createDecorationsCollection();return t.add(n7({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}function B0(s,e){return s.appendChild(e),qe(()=>{e.remove()})}function z5e(s,e){return s.prepend(e),qe(()=>{e.remove()})}class Mie extends le{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new qZ(e,t)),this._width=lt(this,this.elementSizeObserver.getWidth()),this._height=lt(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>tn(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function oG(s,e,t){let i=e.get(),n=i,r=i;const o=lt("animatedValue",i);let a=-1;const l=300;let c;t.add(Z1({changeTracker:{createChangeSummary:()=>({animate:!1}),handleChange:(d,g)=>(d.didChange(e)&&(g.animate=g.animate||d.change),!0)}},(d,g)=>{c!==void 0&&(s.cancelAnimationFrame(c),c=void 0),n=r,i=e.read(d),a=Date.now()-(g.animate?0:l),h()}));function h(){const d=Date.now()-a;r=Math.floor(U5e(d,n,i-n,l)),d<l?c=s.requestAnimationFrame(h):r=i,o.set(r,void 0)}return o}function U5e(s,e,t,i){return s===i?e+t:t*(-Math.pow(2,-10*s/i)+1)+e}class e9 extends le{constructor(e,t,i){super(),this._register(new W3(e,i)),this._register(Fd(i,{height:t.actualHeight,top:t.actualTop}))}}class d_{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=lt(this,void 0),this._actualHeight=lt(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}const NE=class NE{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${NE._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};NE._counter=0;let W3=NE;function Fd(s,e){return vt(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),s.style[i]=n})}function O2(s,e,t,i){const n=new Pe,r=[];return n.add(fl((o,a)=>{const l=e.read(o),c=new Map,h=new Map;t&&t(!0),s.changeViewZones(d=>{for(const g of r)d.removeZone(g),i==null||i.delete(g);r.length=0;for(const g of l){const p=d.addZone(g);g.setZoneId&&g.setZoneId(p),r.push(p),i==null||i.add(p),c.set(g,p)}}),t&&t(!1),a.add(Z1({changeTracker:{createChangeSummary(){return{zoneIds:[]}},handleChange(d,g){const p=h.get(d.changedObservable);return p!==void 0&&g.zoneIds.push(p),!0}}},(d,g)=>{for(const p of l)p.onChange&&(h.set(p.onChange,c.get(p)),p.onChange.read(d));t&&t(!0),s.changeViewZones(p=>{for(const _ of g.zoneIds)p.layoutZone(_)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),s.changeViewZones(o=>{for(const a of r)o.removeZone(a)}),i==null||i.clear(),t&&t(!1)}}),n}function aG(s,e){const t=pk(e,n=>n.original.startLineNumber<=s.lineNumber);if(!t)return G.fromPositions(s);if(t.original.endLineNumberExclusive<=s.lineNumber){const n=s.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return G.fromPositions(new J(n,s.column))}if(!t.innerChanges)return G.fromPositions(new J(t.modified.startLineNumber,1));const i=pk(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(s));if(!i){const n=s.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return G.fromPositions(new J(n,s.column))}if(i.originalRange.containsPosition(s))return i.modifiedRange;{const n=j5e(i.originalRange.getEndPosition(),s);return G.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function j5e(s,e){return s.lineNumber===e.lineNumber?new Yr(0,e.column-s.column):new Yr(e.lineNumber-s.lineNumber,e.column-1)}function $5e(s,e){let t;return s.filter(i=>{const n=e(i,t);return t=i,n})}class P2{static create(e,t=void 0){return new lG(e,e,t)}static createWithDisposable(e,t,i=void 0){const n=new Pe;return n.add(t),n.add(e),new lG(e,n,i)}}class lG extends P2{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new q5e(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class q5e extends P2{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var t9=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},i9=function(s,e){return function(t,i){e(t,i,s)}};const G5e=qd("diff-review-insert",Ae.add,v(97,"Icon for 'Insert' in accessible diff viewer.")),K5e=qd("diff-review-remove",Ae.remove,v(98,"Icon for 'Remove' in accessible diff viewer.")),Y5e=qd("diff-review-close",Ae.close,v(99,"Icon for 'Close' in accessible diff viewer."));var s1;let _g=(s1=class extends le{constructor(e,t,i,n,r,o,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=r,this._height=o,this._diffs=a,this._models=l,this._instantiationService=c,this._state=We(this,h=>{const d=this._visible.read(h);if(this._parentNode.style.visibility=d?"visible":"hidden",!d)return null;const g=h.store.add(this._instantiationService.createInstance(z3,this._diffs,this._models,this._setVisible,this._canClose)),p=h.store.add(this._instantiationService.createInstance(U3,this._parentNode,g,this._width,this._height,this._models));return{model:g,view:p}}).recomputeInitiallyAndOnChange(this._store)}next(){tn(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){tn(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){tn(e=>{this._setVisible(!1,e)})}},s1._ttPolicy=Wd("diffReview",{createHTML:e=>e}),s1);_g=t9([i9(8,It)],_g);let z3=class extends le{constructor(e,t,i,n,r){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=n,this._accessibilitySignalService=r,this._groups=lt(this,[]),this._currentGroupIdx=lt(this,0),this._currentElementIdx=lt(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((o,a)=>this._groups.read(a)[o]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((o,a)=>{var l;return(l=this.currentGroup.read(a))==null?void 0:l.lines[o]}),this._register(vt(o=>{const a=this._diffs.read(o);if(!a){this._groups.set([],void 0);return}const l=Q5e(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());tn(c=>{const h=this._models.getModifiedPosition();if(h){const d=l.findIndex(g=>(h==null?void 0:h.lineNumber)<g.range.modified.endLineNumberExclusive);d!==-1&&this._currentGroupIdx.set(d,c)}this._groups.set(l,c)})})),this._register(vt(o=>{const a=this.currentElement.read(o);(a==null?void 0:a.type)===or.Deleted?this._accessibilitySignalService.playSignal(Yl.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===or.Added&&this._accessibilitySignalService.playSignal(Yl.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(vt(o=>{const a=this.currentElement.read(o);if(a&&a.type!==or.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(G.fromPositions(new J(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||s7(t,n=>{this._currentGroupIdx.set(ze.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),n),this._currentElementIdx.set(0,n)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||tn(i=>{this._currentElementIdx.set(ze.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&tn(n=>{this._currentElementIdx.set(i,n)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===or.Deleted?this._models.originalReveal(G.fromPositions(new J(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==or.Header?G.fromPositions(new J(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};z3=t9([i9(4,aT)],z3);const L0=3;function Q5e(s,e,t){const i=[];for(const n of S6(s,(r,o)=>o.modified.startLineNumber-r.modified.endLineNumberExclusive<2*L0)){const r=[];r.push(new Z5e);const o=new Qe(Math.max(1,n[0].original.startLineNumber-L0),Math.min(n[n.length-1].original.endLineNumberExclusive+L0,e+1)),a=new Qe(Math.max(1,n[0].modified.startLineNumber-L0),Math.min(n[n.length-1].modified.endLineNumberExclusive+L0,t+1));iX(n,(h,d)=>{const g=new Qe(h?h.original.endLineNumberExclusive:o.startLineNumber,d?d.original.startLineNumber:o.endLineNumberExclusive),p=new Qe(h?h.modified.endLineNumberExclusive:a.startLineNumber,d?d.modified.startLineNumber:a.endLineNumberExclusive);g.forEach(_=>{r.push(new tOe(_,p.startLineNumber+(_-g.startLineNumber)))}),d&&(d.original.forEach(_=>{r.push(new J5e(d,_))}),d.modified.forEach(_=>{r.push(new eOe(d,_))}))});const l=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);i.push(new X5e(new Gs(l,c),r))}return i}var or;(function(s){s[s.Header=0]="Header",s[s.Unchanged=1]="Unchanged",s[s.Deleted=2]="Deleted",s[s.Added=3]="Added"})(or||(or={}));class X5e{constructor(e,t){this.range=e,this.lines=t}}class Z5e{constructor(){this.type=or.Header}}class J5e{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=or.Deleted,this.modifiedLineNumber=void 0}}class eOe{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=or.Added,this.originalLineNumber=void 0}}class tOe{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=or.Unchanged}}let U3=class extends le{constructor(e,t,i,n,r,o){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._models=r,this._languageService=o,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new ac(a)),this._register(vt(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(Sg({id:"diffreview.close",label:v(100,"Close"),class:"close-diff-review "+Ct.asClassName(Y5e),enabled:!0,run:async()=>t.close()}),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new F7(this._content,{})),Ds(this.domNode,this._scrollbar.getDomNode(),a),this._register(vt(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(qe(()=>{Ds(this.domNode)})),this._register(Fd(this.domNode,{width:this._width,height:this._height})),this._register(Fd(this._content,{width:this._width,height:this._height})),this._register(fl((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(bs(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",v(101,"Accessible Diff Viewer. Use arrow up and down to navigate.")),vs(n,i.get(59)),Ds(this._content,n);const r=this._models.getOriginalModel(),o=this._models.getModifiedModel();if(!r||!o)return;const a=r.getOptions(),l=o.getOptions(),c=i.get(75),h=this._model.currentGroup.get();for(const d of(h==null?void 0:h.lines)||[]){if(!h)break;let g;if(d.type===or.Header){const _=document.createElement("div");_.className="diff-review-row",_.setAttribute("role","listitem");const b=h.range,C=this._model.currentGroupIndex.get(),x=this._model.groups.get().length,S=R=>R===0?v(102,"no lines changed"):R===1?v(103,"1 line changed"):v(104,"{0} lines changed",R),y=S(b.original.length),k=S(b.modified.length);_.setAttribute("aria-label",v(105,"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",C+1,x,b.original.startLineNumber,y,b.modified.startLineNumber,k));const D=document.createElement("div");D.className="diff-review-cell diff-review-summary",D.appendChild(document.createTextNode(`${C+1}/${x}: @@ -${b.original.startLineNumber},${b.original.length} +${b.modified.startLineNumber},${b.modified.length} @@`)),_.appendChild(D),g=_}else g=this._createRow(d,c,this._width.get(),t,r,a,i,o,l);n.appendChild(g);const p=We(_=>this._model.currentElement.read(_)===d);e.add(vt(_=>{const b=p.read(_);g.tabIndex=b?0:-1,b&&g.focus()})),e.add(ie(g,"focus",()=>{this._model.goToLine(d)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,r,o,a,l,c){const h=n.get(165),d=h.glyphMarginWidth+h.lineNumbersWidth,g=a.get(165),p=10+g.glyphMarginWidth+g.lineNumbersWidth;let _="diff-review-row",b="";const C="diff-review-spacer";let x=null;switch(e.type){case or.Added:_="diff-review-row line-insert",b=" char-insert",x=G5e;break;case or.Deleted:_="diff-review-row line-delete",b=" char-delete",x=K5e;break}const S=document.createElement("div");S.style.minWidth=i+"px",S.className=_,S.setAttribute("role","listitem"),S.ariaLevel="";const y=document.createElement("div");y.className="diff-review-cell",y.style.height=`${t}px`,S.appendChild(y);const k=document.createElement("span");k.style.width=d+"px",k.style.minWidth=d+"px",k.className="diff-review-line-number"+b,e.originalLineNumber!==void 0?k.appendChild(document.createTextNode(String(e.originalLineNumber))):k.innerText="",y.appendChild(k);const D=document.createElement("span");D.style.width=p+"px",D.style.minWidth=p+"px",D.style.paddingRight="10px",D.className="diff-review-line-number"+b,e.modifiedLineNumber!==void 0?D.appendChild(document.createTextNode(String(e.modifiedLineNumber))):D.innerText="",y.appendChild(D);const R=document.createElement("span");if(R.className=C,x){const M=document.createElement("span");M.className=Ct.asClassName(x),M.innerText="",R.appendChild(M)}else R.innerText="";y.appendChild(R);let N;if(e.modifiedLineNumber!==void 0){let M=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);_g._ttPolicy&&(M=_g._ttPolicy.createHTML(M)),y.insertAdjacentHTML("beforeend",M),N=l.getLineContent(e.modifiedLineNumber)}else{let M=this._getLineHtml(r,n,o.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);_g._ttPolicy&&(M=_g._ttPolicy.createHTML(M)),y.insertAdjacentHTML("beforeend",M),N=r.getLineContent(e.originalLineNumber)}N.length===0&&(N=v(106,"blank"));let A="";switch(e.type){case or.Unchanged:e.originalLineNumber===e.modifiedLineNumber?A=v(107,"{0} unchanged line {1}",N,e.originalLineNumber):A=v(108,"{0} original line {1} modified line {2}",N,e.originalLineNumber,e.modifiedLineNumber);break;case or.Added:A=v(109,"+ {0} modified line {1}",N,e.modifiedLineNumber);break;case or.Deleted:A=v(110,"- {0} original line {1}",N,e.originalLineNumber);break}return S.setAttribute("aria-label",A),S}_getLineHtml(e,t,i,n,r){const o=e.getLineContent(n),a=t.get(59),l=t.get(117).verticalScrollbarSize,c=Rn.createEmpty(o,r),h=Ro.isBasicASCII(o,e.mightContainNonBasicASCII()),d=Ro.containsRTL(o,h,e.mightContainRTL());return AD(new Tm(a.isMonospace&&!t.get(40),a.canUseHalfwidthRightwardsArrow,o,!1,h,d,0,c,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(133),t.get(113),t.get(108),t.get(60)!==Nd.OFF,null,null,l)).html}};U3=t9([i9(5,Qn)],U3);class iOe{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}j("diffEditor.move.border","#8b8b8b9c",v(137,"The border color for text that got moved in the diff editor."));j("diffEditor.moveActive.border","#FFA500",v(138,"The active border color for text that got moved in the diff editor."));j("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},v(139,"The color of the shadow around unchanged region widgets."));const nOe=qd("diff-insert",Ae.add,v(140,"Line decoration for inserts in the diff editor.")),Oie=qd("diff-remove",Ae.remove,v(141,"Line decoration for removals in the diff editor.")),cG=Nn.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Ct.asClassName(nOe),marginClassName:"gutter-insert"}),uG=Nn.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Ct.asClassName(Oie),marginClassName:"gutter-delete"}),hG=Nn.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),dG=Nn.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),fG=Nn.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),sOe=Nn.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),rOe=Nn.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),j3=Nn.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),oOe=Nn.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),aOe=Nn.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var Pie=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$3=function(s,e){return function(t,i){e(t,i,s)}},Nf;const Fie=gt("diffProviderFactoryService");let q3=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance(G3,e)}};q3=Pie([$3(0,It)],q3);yt(Fie,q3,1);var Ug;let G3=(Ug=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new Z,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)==null||e.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new To(new Qe(1,2),new Qe(1,t.getLineCount()+1),[new Hr(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const r=JSON.stringify([e.uri.toString(),t.uri.toString()]),o=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=Nf.diffCache.get(r);if(a&&a.context===o)return a.result;const l=th.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),h=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:h,timedOut:(c==null?void 0:c.quitEarly)??!0,detectedMoves:i.computeMoves?(c==null?void 0:c.moves.length)??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return Nf.diffCache.size>10&&Nf.diffCache.delete(Nf.diffCache.keys().next().value),Nf.diffCache.set(r,{result:c,context:o}),c}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((i=this.diffAlgorithmOnDidChangeSubscription)==null||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}},Nf=Ug,Ug.diffCache=new Map,Ug);G3=Nf=Pie([$3(1,uy),$3(2,ah)],G3);function lOe(s,e,t,i){return e||(e=n=>n!=null),new Promise((n,r)=>{let o=!0,a=!1;const l=s.map(h=>({isFinished:e(h),error:!1,state:h})),c=vt(h=>{const{isFinished:d,error:g,state:p}=l.read(h);(d||g)&&(o?a=!0:c.dispose(),g?r(g===!0?p:g):n(p))});o=!1,a&&c.dispose()})}function Da(s,e,t=Is.ofCaller()){return new cOe(typeof s=="string"?s:new hr(s,void 0,void 0),e,t)}class cOe extends X1{constructor(e,t,i){super(i),this.event=t,this.handleEvent=()=>{tn(n=>{for(const r of this._observers)n.updateObserver(r,this),r.handleChange(this,void 0)},()=>this.debugName)},this.debugName=typeof e=="string"?e:e.getDebugName(this)??"Observable Signal From Event"}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}var uOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},hOe=function(s,e){return function(t,i){e(t,i,s)}};let K3=class extends le{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=lt(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=lt(this,void 0),this.diff=this._diff,this._unchangedRegions=lt(this,void 0),this.unchangedRegions=We(this,a=>{var l;return this._options.hideUnchangedRegions.read(a)?((l=this._unchangedRegions.read(a))==null?void 0:l.regions)??[]:(tn(c=>{var h;for(const d of((h=this._unchangedRegions.read(void 0))==null?void 0:h.regions)||[])d.collapseAll(c)}),[])}),this.movedTextToCompare=lt(this,void 0),this._activeMovedText=lt(this,void 0),this._hoveredMovedText=lt(this,void 0),this.activeMovedText=We(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new ym,this._diffProvider=We(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=Da("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(qe(()=>this._cancellationTokenSource.cancel()));const n=Zv("contentChangedSignal"),r=this._register(new Es(()=>n.trigger(void 0),200));this._register(vt(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(_=>_.isDragged.read(a)))return;const c=l.originalDecorationIds.map(_=>e.original.getDecorationRange(_)).map(_=>_?Qe.fromRangeInclusive(_):void 0),h=l.modifiedDecorationIds.map(_=>e.modified.getDecorationRange(_)).map(_=>_?Qe.fromRangeInclusive(_):void 0),d=l.regions.map((_,b)=>!c[b]||!h[b]?void 0:new ud(c[b].startLineNumber,h[b].startLineNumber,c[b].length,_.visibleLineCountTop.read(a),_.visibleLineCountBottom.read(a))).filter(Xo),g=[];let p=!1;for(const _ of S6(d,(b,C)=>b.getHiddenModifiedRange(a).endLineNumberExclusive===C.getHiddenModifiedRange(a).startLineNumber))if(_.length>1){p=!0;const b=_.reduce((x,S)=>x+S.lineCount,0),C=new ud(_[0].originalLineNumber,_[0].modifiedLineNumber,b,_[0].visibleLineCountTop.read(void 0),_[_.length-1].visibleLineCountBottom.read(void 0));g.push(C)}else g.push(_[0]);if(p){const _=e.original.deltaDecorations(l.originalDecorationIds,g.map(C=>({range:C.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=e.modified.deltaDecorations(l.modifiedDecorationIds,g.map(C=>({range:C.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));tn(C=>{this._unchangedRegions.set({regions:g,originalDecorationIds:_,modifiedDecorationIds:b},C)})}}));const o=(a,l,c)=>{const h=ud.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let d;const g=this._unchangedRegions.get();if(g){const C=g.originalDecorationIds.map(k=>e.original.getDecorationRange(k)).map(k=>k?Qe.fromRangeInclusive(k):void 0),x=g.modifiedDecorationIds.map(k=>e.modified.getDecorationRange(k)).map(k=>k?Qe.fromRangeInclusive(k):void 0);let y=$5e(g.regions.map((k,D)=>{if(!C[D]||!x[D])return;const R=C[D].length;return new ud(C[D].startLineNumber,x[D].startLineNumber,R,Math.min(k.visibleLineCountTop.get(),R),Math.min(k.visibleLineCountBottom.get(),R-k.visibleLineCountTop.get()))}).filter(Xo),(k,D)=>!D||k.modifiedLineNumber>=D.modifiedLineNumber+D.lineCount&&k.originalLineNumber>=D.originalLineNumber+D.lineCount).map(k=>new Gs(k.getHiddenOriginalRange(c),k.getHiddenModifiedRange(c)));y=Gs.clip(y,Qe.ofLength(1,e.original.getLineCount()),Qe.ofLength(1,e.modified.getLineCount())),d=Gs.inverse(y,e.original.getLineCount(),e.modified.getLineCount())}const p=[];if(d)for(const C of h){const x=d.filter(S=>S.original.intersectsStrict(C.originalUnchangedRange)&&S.modified.intersectsStrict(C.modifiedUnchangedRange));p.push(...C.setVisibleRanges(x,l))}else p.push(...h);const _=e.original.deltaDecorations((g==null?void 0:g.originalDecorationIds)||[],p.map(C=>({range:C.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=e.modified.deltaDecorations((g==null?void 0:g.modifiedDecorationIds)||[],p.map(C=>({range:C.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:p,originalDecorationIds:_,modifiedDecorationIds:b},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=Pu.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=Pu.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(fl(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),r.cancel(),n.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),this._isDiffUpToDate.set(!1,void 0);let h=[];l.add(e.original.onDidChangeContent(p=>{const _=Pu.fromModelContentChanges(p.changes);h=Qk(h,_)}));let d=[];l.add(e.modified.onDidChangeContent(p=>{const _=Pu.fromModelContentChanges(p.changes);d=Qk(d,_)}));let g=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(g=dOe(g,e.original,e.modified),g=(e.original,e.modified,void 0)??g,g=(e.original,e.modified,void 0)??g,tn(p=>{o(g,p),this._lastDiff=g;const _=n9.fromDiffResult(g);this._diff.set(_,p),this._isDiffUpToDate.set(!0,p);const b=this.movedTextToCompare.read(void 0);this.movedTextToCompare.set(b?this._lastDiff.moves.find(C=>C.lineRangeMapping.modified.intersect(b.lineRangeMapping.modified)):void 0,p)}))}))}ensureModifiedLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const n=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of n)if(a.getHiddenModifiedRange(void 0).contains(e)){a.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const n=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of n)if(a.getHiddenOriginalRange(void 0).contains(e)){a.showOriginalLine(e,t,i);return}}async waitForDiff(){await lOe(this.isDiffUpToDate,e=>e)}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e==null?void 0:e.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){var n;const t=(n=e.collapsedRegions)==null?void 0:n.map(r=>Qe.deserialize(r.range)),i=this._unchangedRegions.get();!i||!t||tn(r=>{for(const o of i.regions)for(const a of t)if(o.modifiedUnchangedRange.intersect(a)){o.setHiddenModifiedRange(a,r);break}})}};K3=uOe([hOe(2,Fie)],K3);function dOe(s,e,t){return{changes:s.changes.map(i=>new To(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>fOe(n,e,t)):void 0)),moves:s.moves,identical:s.identical,quitEarly:s.quitEarly}}function fOe(s,e,t){let i=s.originalRange,n=s.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new Hr(i,n)}class n9{static fromDiffResult(e){return new n9(e.changes.map(t=>new Bie(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class Bie{constructor(e){this.lineRangeMapping=e}}class ud{static fromDiffs(e,t,i,n,r){const o=To.inverse(e,t,i),a=[];for(const l of o){let c=l.original.startLineNumber,h=l.modified.startLineNumber,d=l.original.length;const g=c===1&&h===1,p=c+d===t+1&&h+d===i+1;(g||p)&&d>=r+n?(g&&!p&&(d-=r),p&&!g&&(c+=r,h+=r,d-=r),a.push(new ud(c,h,d,0,0))):d>=r*2+n&&(c+=r,h+=r,d-=r*2,a.push(new ud(c,h,d,0,0)))}return a}get originalUnchangedRange(){return Qe.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Qe.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,r){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=lt(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=lt(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=We(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=lt(this,void 0);const o=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(r,this.lineCount-n),0);WW(n===o),WW(r===a),this._visibleLineCountTop.set(o,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],n=new Jo(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let r=this.originalLineNumber,o=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of n.ranges){const h=l===n.ranges.length-1;l++;const d=(h?a:c.endLineNumberExclusive)-o,g=new ud(r,o,d,0,0);g.setHiddenModifiedRange(c,t),i.push(g),r=g.originalUnchangedRange.endLineNumberExclusive,o=g.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return Qe.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return Qe.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),r=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<r||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+r,i)}showOriginalLine(e,t,i){const n=e-this.originalLineNumber,r=this.originalLineNumber+this.lineCount-e;t===0&&n<r||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+r-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-r,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}function gOe(s){const{domNode:e,renderLinesResult:t,diffEntry:i,originalModel:n,clipboardService:r}=s,o=new Pe;return o.add(ie(e,"copy",a=>{a.preventDefault();const l=e.ownerDocument.getSelection();if(!l||l.rangeCount===0)return;const c=l.getRangeAt(0);if(!c||c.collapsed)return;const h=c.startContainer.nodeType===Node.TEXT_NODE?c.startContainer.parentElement:c.startContainer,d=c.endContainer.nodeType===Node.TEXT_NODE?c.endContainer.parentElement:c.endContainer;if(!h||!d)return;const g=t.getModelPositionAt(h,c.startOffset),p=t.getModelPositionAt(d,c.endOffset);if(!g||!p)return;const _=g.delta(i.original.startLineNumber-1),b=p.delta(i.original.startLineNumber-1),C=b.isBefore(_)?G.fromPositions(b,_):G.fromPositions(_,b),x=n.getValueInRange(C);r.writeText(x)})),o}class mOe extends le{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,n,r,o,a,l,c,h){super(),this._getViewZoneId=e,this._marginDomNode=t,this._deletedCodeDomNode=i,this._modifiedEditor=n,this._diff=r,this._editor=o,this._renderLinesResult=a,this._originalTextModel=l,this._contextMenuService=c,this._clipboardService=h,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Ct.asClassName(Ae.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(75);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let g=0;const p=n.getOption(144)&&!gc,_=(b,C,x)=>{this._contextMenuService.showContextMenu({domForShadowRoot:p?n.getDomNode()??void 0:void 0,getAnchor:()=>b,onHide:x,getActions:()=>{const S=[],y=r.modified.isEmpty;return S.push(new wd("diff.clipboard.copyDeletedContent",y?r.original.length>1?v(112,"Copy deleted lines"):v(113,"Copy deleted line"):r.original.length>1?v(114,"Copy changed lines"):v(115,"Copy changed line"),void 0,!0,async()=>{const D=this._originalTextModel.getValueInRange(r.original.toExclusiveRange());await this._clipboardService.writeText(D)})),r.original.length>1&&S.push(new wd("diff.clipboard.copyDeletedLineContent",y?v(116,"Copy deleted line ({0})",r.original.startLineNumber+g):v(117,"Copy changed line ({0})",r.original.startLineNumber+g),void 0,!0,async()=>{let D=this._originalTextModel.getLineContent(r.original.startLineNumber+g);D===""&&(D=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(D)})),n.getOption(104)||S.push(new wd("diff.inline.revertChange",v(118,"Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),S},autoSelectFirstItem:!0})};this._register(bs(this._diffActions,"mousedown",b=>{if(!b.leftButton)return;const{top:C,height:x}=ta(this._diffActions),S=Math.floor(d/3);b.preventDefault(),_({x:b.posx,y:C+x+S})})),this._register(n.onMouseMove(b=>{(b.target.type===8||b.target.type===5)&&b.target.detail.viewZoneId===this._getViewZoneId()?(g=this._updateLightBulbPosition(this._marginDomNode,b.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(gOe({domNode:this._deletedCodeDomNode,diffEntry:r,originalModel:this._originalTextModel,renderLinesResult:this._renderLinesResult,clipboardService:h}))}_updateLightBulbPosition(e,t,i){const{top:n}=ta(e),r=t-n,o=Math.floor(r/i),a=o*i;if(this._diffActions.style.top=`${a}px`,this._renderLinesResult.viewLineCounts){let l=0;for(let c=0;c<this._renderLinesResult.viewLineCounts.length;c++)if(l+=this._renderLinesResult.viewLineCounts[c],o<l)return c}return o}}const gG=Wd("diffEditorWidget",{createHTML:s=>s});function pOe(s,e,t,i,n=!1){vs(i,e.fontInfo);const r=t.length>0,o=new J1(1e4);let a=0,l=0;const c=[],h=[];for(let _=0;_<s.lineTokens.length;_++){const b=_+1,C=s.lineTokens[_],x=s.lineBreakData[_],S=ia.filter(t,b,1,Number.MAX_SAFE_INTEGER);if(x){let y=0;for(const k of x.breakOffsets){const D=C.sliceAndInflate(y,k,0),R=pG(l,D,ia.extractWrapped(S,y,k),r,s.mightContainNonBasicASCII,s.mightContainRTL,e,o,n);a=Math.max(a,R.maxCharWidth),h.push(new mG(R.output.characterMapping,R.output.containsForeignElements,y)),l++,y=k}c.push(x.breakOffsets.length)}else{c.push(1);const y=pG(l,C,S,r,s.mightContainNonBasicASCII,s.mightContainRTL,e,o,n);a=Math.max(a,y.maxCharWidth),h.push(new mG(y.output.characterMapping,y.output.containsForeignElements,0)),l++}}a+=e.scrollBeyondLastColumn;const d=o.build(),g=gG?gG.createHTML(d):d;i.innerHTML=g;const p=a*e.typicalHalfwidthCharacterWidth;return new bOe(l,p,c,h,s)}class _Oe{constructor(e,t=e.map(r=>null),i=!0,n=!0){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class Aw{static fromEditor(e){var r;const t=e.getOptions(),i=t.get(59),n=t.get(165);return new Aw(((r=e.getModel())==null?void 0:r.getOptions().tabSize)||0,i,t.get(40),i.typicalHalfwidthCharacterWidth,t.get(118),t.get(75),n.decorationsWidth,t.get(133),t.get(113),t.get(108),t.get(60),t.get(117).verticalScrollbarSize)}constructor(e,t,i,n,r,o,a,l,c,h,d,g,p=!0){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=r,this.lineHeight=o,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=h,this.fontLigatures=d,this.verticalScrollbarSize=g,this.setWidth=p}withSetWidth(e){return new Aw(this.tabSize,this.fontInfo,this.disableMonospaceOptimizations,this.typicalHalfwidthCharacterWidth,this.scrollBeyondLastColumn,this.lineHeight,this.lineDecorationsWidth,this.stopRenderingLineAfter,this.renderWhitespace,this.renderControlCharacters,this.fontLigatures,this.verticalScrollbarSize,e)}withScrollBeyondLastColumn(e){return new Aw(this.tabSize,this.fontInfo,this.disableMonospaceOptimizations,this.typicalHalfwidthCharacterWidth,e,this.lineHeight,this.lineDecorationsWidth,this.stopRenderingLineAfter,this.renderWhitespace,this.renderControlCharacters,this.fontLigatures,this.verticalScrollbarSize,this.setWidth)}}class bOe{constructor(e,t,i,n,r){this.heightInLines=e,this.minWidthInPx=t,this.viewLineCounts=i,this._renderOutputs=n,this._source=r}getModelPositionAt(e,t){let i=e;for(;i&&!i.classList.contains("view-line");)i=i.parentElement;if(!i)return;const n=i.parentElement;if(!n)return;const r=n.querySelectorAll(".view-line");let o=-1;for(let d=0;d<r.length;d++)if(r[d]===i){o=d;break}if(o===-1||o>=this._renderOutputs.length)return;let a=1,l=o;for(let d=0;d<this.viewLineCounts.length;d++){if(l<this.viewLineCounts[d]){a=d+1;break}l-=this.viewLineCounts[d]}if(a>this._source.lineTokens.length)return;const c=this._renderOutputs[o];if(!c)return;const h=zv(c.characterMapping,e,t)+c.offset;return new J(a,h)}}class mG extends yk{constructor(e,t,i){super(e,t),this.offset=i}}function pG(s,e,t,i,n,r,o,a,l){a.appendString('<div class="view-line'),!l&&!i&&a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(s*o.lineHeight)),o.setWidth?a.appendString('px;width:1000000px;">'):a.appendString('px;">');const c=e.getLineContent(),h=Ro.isBasicASCII(c,n),d=Ro.containsRTL(c,h,r),g=RD(new Tm(o.fontInfo.isMonospace&&!o.disableMonospaceOptimizations,o.fontInfo.canUseHalfwidthRightwardsArrow,c,!1,h,d,0,e,t,o.tabSize,0,o.fontInfo.spaceWidth,o.fontInfo.middotWidth,o.fontInfo.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==Nd.OFF,null,null,o.verticalScrollbarSize),a);a.appendString("</div>");const p=g.characterMapping.getHorizontalOffset(g.characterMapping.length);return{output:g,maxCharWidth:p}}var wOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_G=function(s,e){return function(t,i){e(t,i,s)}};let Y3=class extends le{constructor(e,t,i,n,r,o,a,l,c,h){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=n,this._diffEditorWidget=r,this._canIgnoreViewZoneUpdateEvent=o,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=h,this._originalTopPadding=lt(this,0),this._originalScrollOffset=lt(this,0),this._originalScrollOffsetAnimated=oG(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=lt(this,0),this._modifiedScrollOffset=lt(this,0),this._modifiedScrollOffsetAnimated=oG(this._targetWindow,this._modifiedScrollOffset,this._store);const d=lt("invalidateAlignmentsState",0),g=this._register(new Es(()=>{d.set(d.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(y=>{this._canIgnoreViewZoneUpdateEvent()||g.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(y=>{this._canIgnoreViewZoneUpdateEvent()||g.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(y=>{(y.hasChanged(166)||y.hasChanged(75))&&g.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(y=>{(y.hasChanged(166)||y.hasChanged(75))&&g.schedule()}));const p=this._diffModel.map(y=>y?Ii(this,y.model.original.onDidChangeTokens,()=>y.model.original.tokenization.backgroundTokenizationState===2):void 0).map((y,k)=>y==null?void 0:y.read(k)),_=We(y=>{const k=this._diffModel.read(y),D=k==null?void 0:k.diff.read(y);if(!k||!D)return null;d.read(y);const N=this._options.renderSideBySide.read(y);return bG(this._editors.original,this._editors.modified,D.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,N)}),b=We(y=>{var R;const k=(R=this._diffModel.read(y))==null?void 0:R.movedTextToCompare.read(y);if(!k)return null;d.read(y);const D=k.changes.map(N=>new Bie(N));return bG(this._editors.original,this._editors.modified,D,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function C(){const y=document.createElement("div");return y.className="diagonal-fill",y}const x=this._register(new Pe);this.viewZones=We(this,y=>{var oe,Ee,$,ce;x.clear();const k=_.read(y)||[],D=[],R=[],N=this._modifiedTopPadding.read(y);N>0&&R.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:N,showInHiddenAreas:!0,suppressMouseDown:!0});const A=this._originalTopPadding.read(y);A>0&&D.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:A,showInHiddenAreas:!0,suppressMouseDown:!0});const M=this._options.renderSideBySide.read(y),O=M||(oe=this._editors.modified._getViewModel())==null?void 0:oe.createLineBreaksComputer();if(O){const de=this._editors.original.getModel();for(const xe of k)if(xe.diff)for(let Re=xe.originalRange.startLineNumber;Re<xe.originalRange.endLineNumberExclusive;Re++){if(Re>de.getLineCount())return{orig:D,mod:R};O==null||O.addRequest(de.getLineContent(Re),null,null)}}const V=(O==null?void 0:O.finalize())??[];let H=0;const U=this._editors.modified.getOption(75),X=(Ee=this._diffModel.read(y))==null?void 0:Ee.movedTextToCompare.read(y),Y=(($=this._editors.original.getModel())==null?void 0:$.mightContainNonBasicASCII())??!1,q=((ce=this._editors.original.getModel())==null?void 0:ce.mightContainRTL())??!1,ee=Aw.fromEditor(this._editors.modified);for(const de of k)if(de.diff&&!M&&(!this._options.useTrueInlineDiffRendering.read(y)||!s9(de.diff))){if(!de.originalRange.isEmpty){p.read(y);const Re=document.createElement("div");Re.classList.add("view-lines","line-delete","line-delete-selectable","monaco-mouse-cursor-text");const Xe=this._editors.original.getModel();if(de.originalRange.endLineNumberExclusive-1>Xe.getLineCount())return{orig:D,mod:R};const ht=new _Oe(de.originalRange.mapToLineArray(li=>Xe.tokenization.getLineTokens(li)),de.originalRange.mapToLineArray(li=>V[H++]),Y,q),bi=[];for(const li of de.diff.innerChanges||[])bi.push(new bw(li.originalRange.delta(-(de.diff.original.startLineNumber-1)),j3.className,0));const qt=pOe(ht,ee,bi,Re),An=document.createElement("div");if(An.className="inline-deleted-margin-view-zone",vs(An,ee.fontInfo),this._options.renderIndicators.read(y))for(let li=0;li<qt.heightInLines;li++){const on=document.createElement("div");on.className=`delete-sign ${Ct.asClassName(Oie)}`,on.setAttribute("style",`position:absolute;top:${li*U}px;width:${ee.lineDecorationsWidth}px;height:${U}px;right:0;`),An.appendChild(on)}let vr;x.add(new mOe(()=>sX(vr),An,Re,this._editors.modified,de.diff,this._diffEditorWidget,qt,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let li=0;li<qt.viewLineCounts.length;li++){const on=qt.viewLineCounts[li];on>1&&D.push({afterLineNumber:de.originalRange.startLineNumber+li,domNode:C(),heightInPx:(on-1)*U,showInHiddenAreas:!0,suppressMouseDown:!0})}R.push({afterLineNumber:de.modifiedRange.startLineNumber-1,domNode:Re,heightInPx:qt.heightInLines*U,minWidthInPx:qt.minWidthInPx,marginDomNode:An,setZoneId(li){vr=li},showInHiddenAreas:!0,suppressMouseDown:!1})}const xe=document.createElement("div");xe.className="gutter-delete",D.push({afterLineNumber:de.originalRange.endLineNumberExclusive-1,domNode:C(),heightInPx:de.modifiedHeightInPx,marginDomNode:xe,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const xe=de.modifiedHeightInPx-de.originalHeightInPx;if(xe>0){if(X!=null&&X.lineRangeMapping.original.delta(-1).deltaLength(2).contains(de.originalRange.endLineNumberExclusive-1))continue;D.push({afterLineNumber:de.originalRange.endLineNumberExclusive-1,domNode:C(),heightInPx:xe,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Re=function(){const ht=document.createElement("div");return ht.className="arrow-revert-change "+Ct.asClassName(Ae.arrowRight),y.store.add(ie(ht,"mousedown",bi=>bi.stopPropagation())),y.store.add(ie(ht,"click",bi=>{bi.stopPropagation(),r.revert(de.diff)})),Ke("div",{},ht)};var ue=Re;if(X!=null&&X.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(de.modifiedRange.endLineNumberExclusive-1))continue;let Xe;de.diff&&de.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(y)&&(Xe=Re()),R.push({afterLineNumber:de.modifiedRange.endLineNumberExclusive-1,domNode:C(),heightInPx:-xe,marginDomNode:Xe,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const de of b.read(y)??[]){if(!(X!=null&&X.lineRangeMapping.original.intersect(de.originalRange))||!(X!=null&&X.lineRangeMapping.modified.intersect(de.modifiedRange)))continue;const xe=de.modifiedHeightInPx-de.originalHeightInPx;xe>0?D.push({afterLineNumber:de.originalRange.endLineNumberExclusive-1,domNode:C(),heightInPx:xe,showInHiddenAreas:!0,suppressMouseDown:!0}):R.push({afterLineNumber:de.modifiedRange.endLineNumberExclusive-1,domNode:C(),heightInPx:-xe,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:D,mod:R}});let S=!1;this._register(this._editors.original.onDidScrollChange(y=>{y.scrollLeftChanged&&!S&&(S=!0,this._editors.modified.setScrollLeft(y.scrollLeft),S=!1)})),this._register(this._editors.modified.onDidScrollChange(y=>{y.scrollLeftChanged&&!S&&(S=!0,this._editors.original.setScrollLeft(y.scrollLeft),S=!1)})),this._originalScrollTop=Ii(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=Ii(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(vt(y=>{const k=this._originalScrollTop.read(y)-(this._originalScrollOffsetAnimated.read(void 0)-this._modifiedScrollOffsetAnimated.read(y))-(this._originalTopPadding.read(void 0)-this._modifiedTopPadding.read(y));k!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(k,1)})),this._register(vt(y=>{const k=this._modifiedScrollTop.read(y)-(this._modifiedScrollOffsetAnimated.read(void 0)-this._originalScrollOffsetAnimated.read(y))-(this._modifiedTopPadding.read(void 0)-this._originalTopPadding.read(y));k!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(k,1)})),this._register(vt(y=>{var R;const k=(R=this._diffModel.read(y))==null?void 0:R.movedTextToCompare.read(y);let D=0;if(k){const N=this._editors.original.getTopForLineNumber(k.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.read(void 0);D=this._editors.modified.getTopForLineNumber(k.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.read(void 0)-N}D>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(D,void 0)):D<0?(this._modifiedTopPadding.set(-D,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.read(void 0)-D,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.read(void 0)+D,void 0,!0)}))}};Y3=wOe([_G(8,Z8),_G(9,uh)],Y3);function bG(s,e,t,i,n,r){const o=new eh(wG(s,i)),a=new eh(wG(e,n)),l=s.getOption(75),c=e.getOption(75),h=[];let d=0,g=0;function p(b,C){for(;;){let x=o.peek(),S=a.peek();if(x&&x.lineNumber>=b&&(x=void 0),S&&S.lineNumber>=C&&(S=void 0),!x&&!S)break;const y=x?x.lineNumber-d:Number.MAX_VALUE,k=S?S.lineNumber-g:Number.MAX_VALUE;y<k?(o.dequeue(),S={lineNumber:x.lineNumber-d+g,heightInPx:0}):y>k?(a.dequeue(),x={lineNumber:S.lineNumber-g+d,heightInPx:0}):(o.dequeue(),a.dequeue()),h.push({originalRange:Qe.ofLength(x.lineNumber,1),modifiedRange:Qe.ofLength(S.lineNumber,1),originalHeightInPx:l+x.heightInPx,modifiedHeightInPx:c+S.heightInPx,diff:void 0})}}for(const b of t){let k=function(D,R,N=!1){var H,U;if(D<y||R<S)return;if(x)x=!1;else if(!N&&(D===y||R===S))return;const A=new Qe(y,D),M=new Qe(S,R);if(A.isEmpty&&M.isEmpty)return;const O=((H=o.takeWhile(X=>X.lineNumber<D))==null?void 0:H.reduce((X,Y)=>X+Y.heightInPx,0))??0,V=((U=a.takeWhile(X=>X.lineNumber<R))==null?void 0:U.reduce((X,Y)=>X+Y.heightInPx,0))??0;h.push({originalRange:A,modifiedRange:M,originalHeightInPx:A.length*l+O,modifiedHeightInPx:M.length*c+V,diff:b.lineRangeMapping}),y=D,S=R};var _=k;const C=b.lineRangeMapping;p(C.original.startLineNumber,C.modified.startLineNumber);let x=!0,S=C.modified.startLineNumber,y=C.original.startLineNumber;if(r)for(const D of C.innerChanges||[]){D.originalRange.startColumn>1&&D.modifiedRange.startColumn>1&&k(D.originalRange.startLineNumber,D.modifiedRange.startLineNumber);const R=s.getModel(),N=D.originalRange.endLineNumber<=R.getLineCount()?R.getLineMaxColumn(D.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;D.originalRange.endColumn<N&&k(D.originalRange.endLineNumber,D.modifiedRange.endLineNumber)}k(C.original.endLineNumberExclusive,C.modified.endLineNumberExclusive,!0),d=C.original.endLineNumberExclusive,g=C.modified.endLineNumberExclusive}return p(Number.MAX_VALUE,Number.MAX_VALUE),h}function wG(s,e){const t=[],i=[],n=s.getOption(166).wrappingColumn!==-1,r=s._getViewModel().coordinatesConverter,o=s.getOption(75);if(n)for(let l=1;l<=s.getModel().getLineCount();l++){const c=r.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:o*(c-1)})}for(const l of s.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new J(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return W5e(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function s9(s){return s.innerChanges?s.innerChanges.every(e=>vG(e.modifiedRange)&&vG(e.originalRange)||e.originalRange.equalsRange(new G(1,1,1,1))):!1}function vG(s){return s.startLineNumber===s.endLineNumber}const Gw=class Gw extends le{constructor(e,t,i,n,r){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=r,this._originalScrollTop=Ii(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=Ii(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=Da("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=lt(this,0),this._modifiedViewZonesChangedSignal=Da("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=Da("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=We(this,h=>{var R;this._element.replaceChildren();const d=this._diffModel.read(h),g=(R=d==null?void 0:d.diff.read(h))==null?void 0:R.movedTexts;if(!g||g.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(h);const p=this._originalEditorLayoutInfo.read(h),_=this._modifiedEditorLayoutInfo.read(h);if(!p||!_){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(h),this._originalViewZonesChangedSignal.read(h);const b=g.map(N=>{function A(ee,ue){const oe=ue.getTopForLineNumber(ee.startLineNumber,!0),Ee=ue.getTopForLineNumber(ee.endLineNumberExclusive,!0);return(oe+Ee)/2}const M=A(N.lineRangeMapping.original,this._editors.original),O=this._originalScrollTop.read(h),V=A(N.lineRangeMapping.modified,this._editors.modified),H=this._modifiedScrollTop.read(h),U=M-O,X=V-H,Y=Math.min(M,V),q=Math.max(M,V);return{range:new ze(Y,q),from:U,to:X,fromWithoutScroll:M,toWithoutScroll:V,move:N}});b.sort(Zge(Do(N=>N.fromWithoutScroll>N.toWithoutScroll,Jge),Do(N=>N.fromWithoutScroll>N.toWithoutScroll?N.fromWithoutScroll:-N.toWithoutScroll,Uu)));const C=r9.compute(b.map(N=>N.range)),x=10,S=p.verticalScrollbarWidth,y=(C.getTrackCount()-1)*10+x*2,k=S+y+(_.contentLeft-Gw.movedCodeBlockPadding);let D=0;for(const N of b){const A=C.getTrack(D),M=S+x+A*10,O=15,V=15,H=k,U=_.glyphMarginWidth+_.lineNumbersWidth,X=18,Y=document.createElementNS("http://www.w3.org/2000/svg","rect");Y.classList.add("arrow-rectangle"),Y.setAttribute("x",`${H-U}`),Y.setAttribute("y",`${N.to-X/2}`),Y.setAttribute("width",`${U}`),Y.setAttribute("height",`${X}`),this._element.appendChild(Y);const q=document.createElementNS("http://www.w3.org/2000/svg","g"),ee=document.createElementNS("http://www.w3.org/2000/svg","path");ee.setAttribute("d",`M 0 ${N.from} L ${M} ${N.from} L ${M} ${N.to} L ${H-V} ${N.to}`),ee.setAttribute("fill","none"),q.appendChild(ee);const ue=document.createElementNS("http://www.w3.org/2000/svg","polygon");ue.classList.add("arrow"),h.store.add(vt(oe=>{ee.classList.toggle("currentMove",N.move===d.activeMovedText.read(oe)),ue.classList.toggle("currentMove",N.move===d.activeMovedText.read(oe))})),ue.setAttribute("points",`${H-V},${N.to-O/2} ${H},${N.to} ${H-V},${N.to+O/2}`),q.appendChild(ue),this._element.appendChild(q),D++}this.width.set(y,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(qe(()=>this._element.remove())),this._register(vt(h=>{const d=this._originalEditorLayoutInfo.read(h),g=this._modifiedEditorLayoutInfo.read(h);!d||!g||(this._element.style.left=`${d.width-d.verticalScrollbarWidth}px`,this._element.style.height=`${d.height}px`,this._element.style.width=`${d.verticalScrollbarWidth+d.contentLeft-Gw.movedCodeBlockPadding+this.width.read(h)}px`)})),this._register(fD(this._state));const o=We(h=>{const d=this._diffModel.read(h),g=d==null?void 0:d.diff.read(h);return g?g.movedTexts.map(p=>({move:p,original:new d_(lC(p.lineRangeMapping.original.startLineNumber-1),18),modified:new d_(lC(p.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(O2(this._editors.original,o.map(h=>h.map(d=>d.original)))),this._register(O2(this._editors.modified,o.map(h=>h.map(d=>d.modified)))),this._register(fl((h,d)=>{const g=o.read(h);for(const p of g)d.add(new CG(this._editors.original,p.original,p.move,"original",this._diffModel.get())),d.add(new CG(this._editors.modified,p.modified,p.move,"modified",this._diffModel.get()))}));const a=Da("original.onDidFocusEditorWidget",h=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>h(void 0),0))),l=Da("modified.onDidFocusEditorWidget",h=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>h(void 0),0)));let c="modified";this._register(Z1({changeTracker:{createChangeSummary:()=>{},handleChange:(h,d)=>(h.didChange(a)&&(c="original"),h.didChange(l)&&(c="modified"),!0)}},h=>{a.read(h),l.read(h);const d=this._diffModel.read(h);if(!d)return;const g=d.diff.read(h);let p;if(g&&c==="original"){const _=this._editors.originalCursor.read(h);_&&(p=g.movedTexts.find(b=>b.lineRangeMapping.original.contains(_.lineNumber)))}if(g&&c==="modified"){const _=this._editors.modifiedCursor.read(h);_&&(p=g.movedTexts.find(b=>b.lineRangeMapping.modified.contains(_.lineNumber)))}p!==d.movedTextToCompare.read(void 0)&&d.movedTextToCompare.set(void 0,void 0),d.setActiveMovedText(p)}))}};Gw.movedCodeBlockPadding=4;let t1=Gw;class r9{static compute(e){const t=[],i=[];for(const n of e){let r=t.findIndex(o=>!o.intersectsStrict(n));r===-1&&(t.length>=6?r=j0e(t,Do(a=>a.intersectWithRangeLength(n),Uu)):(r=t.length,t.push(new w7))),t[r].addRange(n),i.push(r)}return new r9(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class CG extends e9{constructor(e,t,i,n,r){const o=Et("div.diff-hidden-lines-widget");super(e,t,o.root),this._editor=e,this._move=i,this._kind=n,this._diffModel=r,this._nodes=Et("div.diff-moved-code-block",{style:{marginRight:"4px"}},[Et("div.text-content@textContent"),Et("div.action-bar@actionBar")]),o.root.appendChild(this._nodes.root);const a=Ii(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Fd(this._nodes.root,{paddingRight:a.map(g=>g.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?v(131,"Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):v(132,"Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?v(133,"Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):v(134,"Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new ac(this._nodes.actionBar,{highlightToggledItems:!0})),h=new wd("",l,"",!1);c.push(h,{icon:!1,label:!0});const d=new wd("","Compare",Ct.asClassName(Ae.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(vt(g=>{const p=this._diffModel.movedTextToCompare.read(g)===i;d.checked=p})),c.push(d,{icon:!1,label:!0})}}class vOe extends le{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=We(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return null;const l=this._diffModel.read(r).movedTextToCompare.read(r),c=this._options.renderIndicators.read(r),h=this._options.showEmptyDecorations.read(r),d=[],g=[];if(!l)for(const _ of a.mappings)if(_.lineRangeMapping.original.isEmpty||d.push({range:_.lineRangeMapping.original.toInclusiveRange(),options:c?uG:dG}),_.lineRangeMapping.modified.isEmpty||g.push({range:_.lineRangeMapping.modified.toInclusiveRange(),options:c?cG:hG}),_.lineRangeMapping.modified.isEmpty||_.lineRangeMapping.original.isEmpty)_.lineRangeMapping.original.isEmpty||d.push({range:_.lineRangeMapping.original.toInclusiveRange(),options:oOe}),_.lineRangeMapping.modified.isEmpty||g.push({range:_.lineRangeMapping.modified.toInclusiveRange(),options:sOe});else{const b=this._options.useTrueInlineDiffRendering.read(r)&&s9(_.lineRangeMapping);for(const C of _.lineRangeMapping.innerChanges||[])if(_.lineRangeMapping.original.contains(C.originalRange.startLineNumber)&&d.push({range:C.originalRange,options:C.originalRange.isEmpty()&&h?aOe:j3}),_.lineRangeMapping.modified.contains(C.modifiedRange.startLineNumber)&&g.push({range:C.modifiedRange,options:C.modifiedRange.isEmpty()&&h&&!b?rOe:fG}),b){const x=o.model.original.getValueInRange(C.originalRange);g.push({range:C.modifiedRange,options:{description:"deleted-text",before:{content:x,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const _ of l.changes){const b=_.original.toInclusiveRange();b&&d.push({range:b,options:c?uG:dG});const C=_.modified.toInclusiveRange();C&&g.push({range:C,options:c?cG:hG});for(const x of _.innerChanges||[])d.push({range:x.originalRange,options:j3}),g.push({range:x.modifiedRange,options:fG})}const p=this._diffModel.read(r).activeMovedText.read(r);for(const _ of a.movedTexts)d.push({range:_.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(_===p?" currentMove":""),blockPadding:[t1.movedCodeBlockPadding,0,t1.movedCodeBlockPadding,t1.movedCodeBlockPadding]}}),g.push({range:_.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(_===p?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:d,modifiedDecorations:g}}),this._register(M2(this._editors.original,this._decorations.map(r=>(r==null?void 0:r.originalDecorations)||[]))),this._register(M2(this._editors.modified,this._decorations.map(r=>(r==null?void 0:r.modifiedDecorations)||[])))}}class rl{static equals(e,t){return e.x===t.x&&e.y===t.y}constructor(e,t){this.x=e,this.y=t}add(e){return new rl(this.x+e.x,this.y+e.y)}deltaX(e){return new rl(this.x+e,this.y)}deltaY(e){return new rl(this.x,this.y+e)}toString(){return`(${this.x},${this.y})`}subtract(e){return new rl(this.x-e.x,this.y-e.y)}scale(e){return new rl(this.x*e,this.y*e)}mapComponents(e){return new rl(e(this.x),e(this.y))}isZero(){return this.x===0&&this.y===0}withThreshold(e){return this.mapComponents(t=>t>e?t-e:t<-e?t+e:0)}}function bg(s){return Q3.get(s)}const Gh=class Gh extends le{static get(e){let t=Gh._map.get(e);if(!t){t=new Gh(e),Gh._map.set(e,t);const i=e.onDidDispose(()=>{const n=Gh._map.get(e);n&&(Gh._map.delete(e),n.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new WC(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){var t;super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=lt(this,this.editor.getModel()),this.model=this._model,this.isReadonly=Ii(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(104)),this._versionId=fw({owner:this,lazy:!0},((t=this.editor.getModel())==null?void 0:t.getVersionId())??null),this.versionId=this._versionId,this._selections=fw({owner:this,equalsFn:D0(L4(Lt.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.positions=sc({owner:this,equalsFn:D0(L4(J.equals))},i=>{var n;return((n=this.selections.read(i))==null?void 0:n.map(r=>r.getStartPosition()))??null}),this.isFocused=Ii(this,i=>{const n=this.editor.onDidFocusEditorWidget(i),r=this.editor.onDidBlurEditorWidget(i);return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.hasWidgetFocus()),this.isTextFocused=Ii(this,i=>{const n=this.editor.onDidFocusEditorText(i),r=this.editor.onDidBlurEditorText(i);return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.hasTextFocus()),this.inComposition=Ii(this,i=>{const n=this.editor.onDidCompositionStart(()=>{i(void 0)}),r=this.editor.onDidCompositionEnd(()=>{i(void 0)});return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.inComposition),this.value=i7(this,i=>{var n;return this.versionId.read(i),((n=this.model.read(i))==null?void 0:n.getValue())??""},(i,n)=>{const r=this.model.get();r!==null&&i!==r.getValue()&&r.setValue(i)}),this.valueIsEmpty=We(this,i=>{var n;return this.versionId.read(i),((n=this.editor.getModel())==null?void 0:n.getValueLength())===0}),this.cursorSelection=sc({owner:this,equalsFn:D0(Lt.selectionsEqual)},i=>{var n;return((n=this.selections.read(i))==null?void 0:n[0])??null}),this.cursorPosition=sc({owner:this,equalsFn:J.equals},i=>{var n,r;return((r=(n=this.selections.read(i))==null?void 0:n[0])==null?void 0:r.getPosition())??null}),this.cursorLineNumber=We(this,i=>{var n;return((n=this.cursorPosition.read(i))==null?void 0:n.lineNumber)??null}),this.onDidType=Zv(this),this.onDidPaste=Zv(this),this.scrollTop=Ii(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=Ii(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=Ii(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(i=>i.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(i=>i.decorationsLeft),this.layoutInfoWidth=this.layoutInfo.map(i=>i.width),this.layoutInfoHeight=this.layoutInfo.map(i=>i.height),this.layoutInfoMinimap=this.layoutInfo.map(i=>i.minimap),this.layoutInfoVerticalScrollbarWidth=this.layoutInfo.map(i=>i.verticalScrollbarWidth),this.contentWidth=Ii(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this.contentHeight=Ii(this.editor.onDidContentSizeChange,()=>this.editor.getContentHeight()),this._widgetCounter=0,this.openedPeekWidgets=lt(this,0),this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidPaste(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidPaste.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{var n;this._beginUpdate();try{this._versionId.set(((n=this.editor.getModel())==null?void 0:n.getVersionId())??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this.domNode=We(i=>(this.model.read(i),this.editor.getDomNode()))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){var e;this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(((e=this.editor.getModel())==null?void 0:e.getVersionId())??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e,t=Is.ofCaller()){return Ii(this,i=>this.editor.onDidChangeConfiguration(n=>{n.hasChanged(e)&&i(void 0)}),()=>this.editor.getOption(e),t)}setDecorations(e){const t=new Pe,i=this.editor.createDecorationsCollection();return t.add(n7({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._widgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const n=vt(r=>{e.position.read(r),e.minContentWidthInPx.read(r),this.editor.layoutOverlayWidget(i)});return qe(()=>{n.dispose(),this.editor.removeOverlayWidget(i)})}createContentWidget(e){const t="observableContentWidget"+this._widgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow};this.editor.addContentWidget(i);const n=vt(r=>{e.position.read(r),this.editor.layoutContentWidget(i)});return qe(()=>{n.dispose(),this.editor.removeContentWidget(i)})}observeLineOffsetRange(e,t){const i=this.observePosition(e.map(r=>new J(r.startLineNumber,1)),t),n=this.observePosition(e.map(r=>new J(r.endLineNumberExclusive+1,1)),t);return We(r=>{var h;i.read(r),n.read(r);const o=e.read(r),a=(h=this.model.read(r))==null?void 0:h.getLineCount(),l=(typeof a<"u"&&o.startLineNumber>a?this.editor.getBottomForLineNumber(a):this.editor.getTopForLineNumber(o.startLineNumber))-this.scrollTop.read(r),c=o.isEmpty?l:this.editor.getBottomForLineNumber(o.endLineNumberExclusive-1)-this.scrollTop.read(r);return new ze(l,c)})}observePosition(e,t){let i=e.get();const n=fw({owner:this,debugName:()=>`topLeftOfPosition${i==null?void 0:i.toString()}`,equalsFn:D0(rl.equals)},new rl(0,0)),r="observablePositionWidget"+this._widgetCounter++,o=document.createElement("div"),a={getDomNode:()=>o,getPosition:()=>i?{preference:[0],position:e.get()}:null,getId:()=>r,allowEditorOverflow:!1,afterRender:(l,c)=>{const h=this._model.get();h&&i&&i.lineNumber>h.getLineCount()?n.set(new rl(0,this.editor.getBottomForLineNumber(h.getLineCount())-this.scrollTop.get()),void 0):n.set(c?new rl(c.left,c.top):null,void 0)}};return this.editor.addContentWidget(a),t.add(vt(l=>{i=e.read(l),this.editor.layoutContentWidget(a)})),t.add(qe(()=>{this.editor.removeContentWidget(a)})),n}isTargetHovered(e,t){const i=lt("isInjectedTextHovered",!1);return t.add(this.editor.onMouseMove(n=>{const r=e(n);i.set(r,void 0)})),t.add(this.editor.onMouseLeave(n=>{i.set(!1,void 0)})),i}observeLineHeightForPosition(e){return We(t=>{const i=e instanceof J?e:e.read(t);return i===null?null:(this.getOption(75).read(t),this.editor.getLineHeightForPosition(i))})}observeLineHeightForLine(e){return typeof e=="number"?this.observeLineHeightForPosition(new J(e,1)):We(t=>{const i=e.read(t);return i===null?null:this.observeLineHeightForPosition(new J(i,1)).read(t)})}observeLineHeightsForLineRange(e){return We(t=>{const i=e instanceof Qe?e:e.read(t),n=[];for(let r=i.startLineNumber;r<i.endLineNumberExclusive;r++)n.push(this.observeLineHeightForLine(r).read(t));return n})}};Gh._map=new Map;let Q3=Gh;var COe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yOe=function(s,e){return function(t,i){e(t,i,s)}},Qa,Vu;let wC=(Vu=class extends le{constructor(e,t,i,n,r,o,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=n,this._rootHeight=r,this._modifiedEditorLayoutInfo=o,this._themeService=a,this.width=Qa.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=Ii(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=We(g=>{const p=l.read(g),_=p.getColor(jve)||(p.getColor(zve)||l5).transparent(2),b=p.getColor($ve)||(p.getColor(Uve)||c5).transparent(2);return{insertColor:_,removeColor:b}}),h=Tt(document.createElement("div"));h.setClassName("diffViewport"),h.setPosition("absolute");const d=Et("div.diffOverview",{style:{position:"absolute",top:"0px",width:Qa.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(B0(d,h.domNode)),this._register(bs(d,Le.POINTER_DOWN,g=>{this._editors.modified.delegateVerticalScrollbarPointerDown(g)})),this._register(ie(d,Le.MOUSE_WHEEL,g=>{this._editors.modified.delegateScrollFromMouseWheelEvent(g)},{passive:!1})),this._register(B0(this._rootElement,d)),this._register(fl((g,p)=>{const _=this._diffModel.read(g),b=this._editors.original.createOverviewRuler("original diffOverviewRuler");b&&(p.add(b),p.add(B0(d,b.getDomNode())));const C=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(C&&(p.add(C),p.add(B0(d,C.getDomNode()))),!b||!C)return;const x=Da("viewZoneChanged",this._editors.original.onDidChangeViewZones),S=Da("viewZoneChanged",this._editors.modified.onDidChangeViewZones),y=Da("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),k=Da("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);p.add(vt(D=>{var V;x.read(D),S.read(D),y.read(D),k.read(D);const R=c.read(D),N=(V=_==null?void 0:_.diff.read(D))==null?void 0:V.mappings;function A(H,U,X){const Y=X._getViewModel();return Y?H.filter(q=>q.length>0).map(q=>{const ee=Y.coordinatesConverter.convertModelPositionToViewPosition(new J(q.startLineNumber,1)),ue=Y.coordinatesConverter.convertModelPositionToViewPosition(new J(q.endLineNumberExclusive,1)),oe=ue.lineNumber-ee.lineNumber;return new JJ(ee.lineNumber,ue.lineNumber,oe,U.toString())}):[]}const M=A((N||[]).map(H=>H.lineRangeMapping.original),R.removeColor,this._editors.original),O=A((N||[]).map(H=>H.lineRangeMapping.modified),R.insertColor,this._editors.modified);b==null||b.setZones(M),C==null||C.setZones(O)})),p.add(vt(D=>{const R=this._rootHeight.read(D),N=this._rootWidth.read(D),A=this._modifiedEditorLayoutInfo.read(D);if(A){const M=Qa.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Qa.ONE_OVERVIEW_WIDTH;b.setLayout({top:0,height:R,right:M+Qa.ONE_OVERVIEW_WIDTH,width:Qa.ONE_OVERVIEW_WIDTH}),C.setLayout({top:0,height:R,right:0,width:Qa.ONE_OVERVIEW_WIDTH});const O=this._editors.modifiedScrollTop.read(D),V=this._editors.modifiedScrollHeight.read(D),H=this._editors.modified.getOption(117),U=new R1(H.verticalHasArrows?H.arrowSize:0,H.verticalScrollbarSize,0,A.height,V,O);h.setTop(U.getSliderPosition()),h.setHeight(U.getSliderSize())}else h.setTop(0),h.setHeight(0);d.style.height=R+"px",d.style.left=N-Qa.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",h.setWidth(Qa.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}},Qa=Vu,Vu.ONE_OVERVIEW_WIDTH=15,Vu.ENTIRE_DIFF_OVERVIEW_WIDTH=Vu.ONE_OVERVIEW_WIDTH*2,Vu);wC=Qa=COe([yOe(6,Zr)],wC);var SOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},SA=function(s,e){return function(t,i){e(t,i,s)}};let X3=class extends le{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,n,r,o,a,l){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=n,this._createInnerEditor=r,this._contextKeyService=o,this._instantiationService=a,this._keybindingService=l,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new Z),this.modifiedScrollTop=Ii(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=Ii(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=bg(this.modified),this.originalObs=bg(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=Ii(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=sc({owner:this,equalsFn:J.equals},c=>{var h;return((h=this.modifiedSelections.read(c)[0])==null?void 0:h.getPosition())??new J(1,1)}),this.originalCursor=Ii(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new J(1,1)),this.isOriginalFocused=bg(this.original).isFocused,this.isModifiedFocused=bg(this.modified).isFocused,this.isFocused=We(this,c=>this.isOriginalFocused.read(c)||this.isModifiedFocused.read(c)),this._argCodeEditorWidgetOptions=null,this._register(Z1({changeTracker:{createChangeSummary:()=>({}),handleChange:(c,h)=>(c.didChange(i.editorOptions)&&Object.assign(h,c.change.changedOptions),!0)}},(c,h)=>{i.editorOptions.read(c),this._options.renderSideBySide.read(c),this.modified.updateOptions(this._adjustOptionsForRightHandSide(c,h)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(c,h))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t),r=this._contextKeyService.createKey("isInDiffLeftEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget(()=>r.set(!0))),this._register(n.onDidBlurEditorWidget(()=>r.set(!1))),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t),r=this._contextKeyService.createKey("isInDiffRightEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget(()=>r.set(!0))),this._register(n.onDidBlurEditorWidget(()=>r.set(!1))),n}_constructInnerEditor(e,t,i,n){const r=this._createInnerEditor(e,t,i,n);return this._register(r.onDidContentSizeChange(o=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+wC.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:o.contentHeightChanged,contentWidthChanged:o.contentWidthChanged})})),r}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=mo.revealHorizontalRightPadding.defaultValue+wC.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.allowVariableLineHeights=!1,t.allowVariableFonts=!1,t.allowVariableFontsInAccessibilityMode=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var i;e||(e="");const t=v(111," use {0} to open the accessibility help.",(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))==null?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};X3=SOe([SA(5,Ot),SA(6,It),SA(7,rs)],X3);class xOe{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=i7(this,i=>{const n=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(n,i)},(i,n)=>{const r=this.dimensions.width.get();this._sashRatio.set(i/r,n)}),this._sashRatio=lt(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,o=100;return i<=o*2?n:r<o?o:r>i-o?i-o:r}}class Vie extends le{constructor(e,t,i,n,r,o){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=n,this.sashLeft=r,this._resetSash=o,this._sash=this._register(new qo(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(vt(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register(vt(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}const IE=class IE extends le{constructor(){super(...arguments),this._id=++IE.idCounter,this._onDidDispose=this._register(new Z),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};IE.idCounter=0;let Z3=IE;function LOe(s,e){return s1e(s,(t,i)=>i??e(t))}var kOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},EOe=function(s,e){return function(t,i){e(t,i,s)}};let J3=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=lt(this,0),this._screenReaderMode=Ii(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=We(this,n=>this._options.read(n).renderSideBySide&&this._diffEditorWidth.read(n)<=this._options.read(n).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=We(this,n=>this._options.read(n).renderOverviewRuler),this.renderSideBySide=We(this,n=>this.compactMode.read(n)&&this.shouldRenderInlineViewInSmartMode.read(n)?!1:this._options.read(n).renderSideBySide&&!(this._options.read(n).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(n)&&!this._screenReaderMode.read(n))),this.readOnly=We(this,n=>this._options.read(n).readOnly),this.shouldRenderOldRevertArrows=We(this,n=>!(!this._options.read(n).renderMarginRevertIcon||!this.renderSideBySide.read(n)||this.readOnly.read(n)||this.shouldRenderGutterMenu.read(n))),this.shouldRenderGutterMenu=We(this,n=>this._options.read(n).renderGutterMenu),this.renderIndicators=We(this,n=>this._options.read(n).renderIndicators),this.enableSplitViewResizing=We(this,n=>this._options.read(n).enableSplitViewResizing),this.splitViewDefaultRatio=We(this,n=>this._options.read(n).splitViewDefaultRatio),this.ignoreTrimWhitespace=We(this,n=>this._options.read(n).ignoreTrimWhitespace),this.maxComputationTimeMs=We(this,n=>this._options.read(n).maxComputationTime),this.showMoves=We(this,n=>this._options.read(n).experimental.showMoves&&this.renderSideBySide.read(n)),this.isInEmbeddedEditor=We(this,n=>this._options.read(n).isInEmbeddedEditor),this.diffWordWrap=We(this,n=>this._options.read(n).diffWordWrap),this.originalEditable=We(this,n=>this._options.read(n).originalEditable),this.diffCodeLens=We(this,n=>this._options.read(n).diffCodeLens),this.accessibilityVerbose=We(this,n=>this._options.read(n).accessibilityVerbose),this.diffAlgorithm=We(this,n=>this._options.read(n).diffAlgorithm),this.showEmptyDecorations=We(this,n=>this._options.read(n).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=We(this,n=>this._options.read(n).onlyShowAccessibleDiffViewer),this.compactMode=We(this,n=>this._options.read(n).compactMode),this.trueInlineDiffRenderingEnabled=We(this,n=>this._options.read(n).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=We(this,n=>!this.renderSideBySide.read(n)&&this.trueInlineDiffRenderingEnabled.read(n)),this.hideUnchangedRegions=We(this,n=>this._options.read(n).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=We(this,n=>this._options.read(n).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=We(this,n=>this._options.read(n).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=We(this,n=>this._options.read(n).hideUnchangedRegions.minimumLineCount),this._model=lt(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,n=>LOe(this,r=>{const o=n==null?void 0:n.diff.read(r);return o?DOe(o,this.trueInlineDiffRenderingEnabled.read(r)):void 0})).flatten().map(this,n=>!!n),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...yG(e,us)};this._options=lt(this,i)}updateOptions(e){const t=yG(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};J3=kOe([EOe(1,Mo)],J3);function DOe(s,e){return s.mappings.every(t=>TOe(t.lineRangeMapping)||NOe(t.lineRangeMapping)||e&&s9(t.lineRangeMapping))}function TOe(s){return s.original.length===0}function NOe(s){return s.modified.length===0}function yG(s,e){var t,i,n,r,o,a,l,c;return{enableSplitViewResizing:Me(s.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:Fme(s.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:Me(s.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:Me(s.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:Cu(s.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:Cu(s.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:Me(s.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:Me(s.renderIndicators,e.renderIndicators),originalEditable:Me(s.originalEditable,e.originalEditable),diffCodeLens:Me(s.diffCodeLens,e.diffCodeLens),renderOverviewRuler:Me(s.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:di(s.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:di(s.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:Me(s.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:Me((t=s.experimental)==null?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:Me((i=s.experimental)==null?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:Me((n=s.experimental)==null?void 0:n.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:Me(((r=s.hideUnchangedRegions)==null?void 0:r.enabled)??((o=s.experimental)==null?void 0:o.collapseUnchangedRegions),e.hideUnchangedRegions.enabled),contextLineCount:Cu((a=s.hideUnchangedRegions)==null?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:Cu((l=s.hideUnchangedRegions)==null?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:Cu((c=s.hideUnchangedRegions)==null?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:Me(s.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:Me(s.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:Cu(s.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:Me(s.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:Me(s.renderGutterMenu,e.renderGutterMenu),compactMode:Me(s.compactMode,e.compactMode)}}const SG=24;class IOe extends le{get onDidChangeDropdownVisibility(){return this._onDidChangeDropdownVisibility.event}constructor(e,t,i={orientation:0}){if(super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new Tme),this.originalPrimaryActions=[],this.originalSecondaryActions=[],this.hiddenActions=[],this.disposables=this._register(new Pe),i.hoverDelegate=i.hoverDelegate??this._register(Mte()),this.options=i,this.toggleMenuAction=this._register(new vC(()=>{var n;return(n=this.toggleMenuActionViewItem)==null?void 0:n.show()},i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new ac(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,r)=>{if(n.id===vC.ID)return this.toggleMenuActionViewItem=new g2(n,{getActions:()=>this.toggleMenuAction.menuActions},t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Ct.asClassNameArray(i.moreIcon??Ae.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const o=i.actionViewItemProvider(n,r);if(o)return o}if(n instanceof _D){const o=new g2(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return o.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(o),this.disposables.add(this._onDidChangeDropdownVisibility.add(o.onDidChangeVisibility)),o}}})),this.options.responsive){this.element.classList.add("responsive");const n=new ResizeObserver(()=>{this.setToolbarMaxWidth(this.element.getBoundingClientRect().width)});n.observe(this.element),this._store.add(qe(()=>n.disconnect()))}}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){var t;this.actionBar.context=e,(t=this.toggleMenuActionViewItem)==null||t.setActionContext(e);for(const i of this.submenuActionViewItems)i.setActionContext(e)}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}setActions(e,t){this.clear(),this.originalPrimaryActions=e?e.slice(0):[],this.originalSecondaryActions=t?t.slice(0):[];const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.length>0&&this.options.trailingSeparator&&i.push(new is),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})}),this.options.responsive&&(this.hiddenActions.length=0,this.setToolbarMaxWidth(this.element.getBoundingClientRect().width))}getKeybindingLabel(e){var i,n;const t=(n=(i=this.options).getKeyBinding)==null?void 0:n.call(i,e);return(t==null?void 0:t.getLabel())??void 0}getItemsWidthResponsive(){return this.actionBar.length()*SG}setToolbarMaxWidth(e){if(this.actionBar.isEmpty()||this.getItemsWidthResponsive()<=e&&this.hiddenActions.length===0)return;if(this.getItemsWidthResponsive()>e)for(;this.getItemsWidthResponsive()>e&&this.actionBar.length()>0;){const i=this.originalPrimaryActions.length-this.hiddenActions.length-1;if(i<0)break;const n=Math.min(SG,this.getItemWidth(i)),r=this.originalPrimaryActions[i];this.hiddenActions.unshift({action:r,size:n}),this.actionBar.pull(i),this.originalSecondaryActions.length===0&&this.hiddenActions.length===1&&this.actionBar.push(this.toggleMenuAction,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(this.toggleMenuAction)})}else for(;this.hiddenActions.length>0;){const i=this.hiddenActions.shift();if(this.getItemsWidthResponsive()+i.size>e){this.hiddenActions.unshift(i);break}this.actionBar.push(i.action,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i.action),index:this.originalPrimaryActions.length-this.hiddenActions.length-1}),this.originalSecondaryActions.length===0&&this.hiddenActions.length===1&&(this.toggleMenuAction.menuActions=[],this.actionBar.pull(this.actionBar.length()-1))}const t=this.hiddenActions.map(i=>i.action);if(this.originalSecondaryActions.length>0||t.length>0){const i=this.originalSecondaryActions.slice(0);this.toggleMenuAction.menuActions=is.join(t,i)}}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}const RE=class RE extends wd{constructor(e,t){t=t||v(17,"More Actions..."),super(RE.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};RE.ID="toolbar.toggle.more";let vC=RE;const Hie=gt("IActionViewItemService");class ROe{constructor(){this._providers=new Map,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}lookUp(e,t){return this._providers.get(this._makeKey(e,t))}_makeKey(e,t){return`${e.id}/${t instanceof xn?t.id:t}`}}yt(Hie,ROe,1);var Wie=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},go=function(s,e){return function(t,i){e(t,i,s)}};let eP=class extends IOe{constructor(e,t,i,n,r,o,a,l){super(e,r,{getKeyBinding:h=>o.lookupKeybinding(h.id)??void 0,...t,allowContextMenu:!0,skipTelemetry:typeof(t==null?void 0:t.telemetrySource)=="string"}),this._options=t,this._menuService=i,this._contextKeyService=n,this._contextMenuService=r,this._keybindingService=o,this._commandService=a,this._sessionDisposables=this._store.add(new Pe);const c=t==null?void 0:t.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(h=>l.publicLog2("workbenchActionExecuted",{id:h.action.id,from:c})))}setActions(e,t=[],i){var h,d,g;this._sessionDisposables.clear();const n=e.slice(),r=t.slice(),o=[];let a=0;const l=[];let c=!1;if(((h=this._options)==null?void 0:h.hiddenItemStrategy)!==-1)for(let p=0;p<n.length;p++){const _=n[p];!(_ instanceof $u)&&!(_ instanceof P_)||_.hideActions&&(o.push(_.hideActions.toggle),_.hideActions.toggle.checked&&a++,_.hideActions.isHidden&&(c=!0,n[p]=void 0,((d=this._options)==null?void 0:d.hiddenItemStrategy)!==0&&(l[p]=_)))}if(((g=this._options)==null?void 0:g.overflowBehavior)!==void 0){const p=Nee(new Set(this._options.overflowBehavior.exempted),Dt.map(n,C=>C==null?void 0:C.id)),_=this._options.overflowBehavior.maxItems-p.size;let b=0;for(let C=0;C<n.length;C++){const x=n[C];x&&(b++,!p.has(x.id)&&b>=_&&(n[C]=void 0,l[C]=x))}}HW(n),HW(l),super.setActions(n,is.join(l,r)),(o.length>0||n.length>0)&&this._sessionDisposables.add(ie(this.getElement(),"contextmenu",p=>{var S,y,k,D,R;const _=new So(Ue(this.getElement()),p),b=this.getItemAction(_.target);if(!b)return;_.preventDefault(),_.stopPropagation();const C=[];if(b instanceof $u&&b.menuKeybinding)C.push(b.menuKeybinding);else if(!(b instanceof P_||b instanceof vC)){const N=!!this._keybindingService.lookupKeybinding(b.id);C.push(Rie(this._commandService,this._keybindingService,b.id,void 0,N))}if(o.length>0){let N=!1;if(a===1&&((S=this._options)==null?void 0:S.hiddenItemStrategy)===0){N=!0;for(let A=0;A<o.length;A++)if(o[A].checked){o[A]=Sg({id:b.id,label:b.label,checked:!0,enabled:!1,run(){}});break}}if(!N&&(b instanceof $u||b instanceof P_)){if(!b.hideActions)return;C.push(b.hideActions.hide)}else C.push(Sg({id:"label",label:v(1649,"Hide"),enabled:!1,run(){}}))}const x=is.join(C,o);(y=this._options)!=null&&y.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(x.push(new is),x.push(Sg({id:"resetThisMenu",label:v(1650,"Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),x.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>_,getActions:()=>x,menuId:(k=this._options)==null?void 0:k.contextMenu,menuActionOptions:{renderShortTitle:!0,...(D=this._options)==null?void 0:D.menuOptions},skipTelemetry:typeof((R=this._options)==null?void 0:R.telemetrySource)=="string",contextKeyService:this._contextKeyService})}))}};eP=Wie([go(2,Em),go(3,Ot),go(4,uh),go(5,rs),go(6,Ao),go(7,ah)],eP);let F2=class extends eP{get onDidChangeMenuItems(){return this._onDidChangeMenuItems.event}constructor(e,t,i,n,r,o,a,l,c,h,d){super(e,{resetMenu:t,...i,actionViewItemProvider:(_,b)=>{let C=h.lookUp(t,_ instanceof P_?_.item.submenu.id:_.id);C||(C=i==null?void 0:i.actionViewItemProvider);const x=C==null?void 0:C(_,b,d,Ue(e).vscodeWindowId);return x||qte(d,_,b)}},n,r,o,a,l,c),this._onDidChangeMenuItems=this._store.add(new Z);const g=this._store.add(n.createMenu(t,r,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:i==null?void 0:i.eventDebounceDelay})),p=()=>{var C,x,S;const{primary:_,secondary:b}=fAe(g.getActions(i==null?void 0:i.menuOptions),(C=i==null?void 0:i.toolbarOptions)==null?void 0:C.primaryGroup,(x=i==null?void 0:i.toolbarOptions)==null?void 0:x.shouldInlineSubmenu,(S=i==null?void 0:i.toolbarOptions)==null?void 0:S.useSeparatorsInPrimaryActions);e.classList.toggle("has-no-actions",_.length===0&&b.length===0),super.setActions(_,b)};this._store.add(g.onDidChange(()=>{p(),this._onDidChangeMenuItems.fire(this)})),this._store.add(h.onDidChange(_=>{_===t&&p()})),p()}setActions(){throw new $e("This toolbar is populated from a menu.")}};F2=Wie([go(3,Em),go(4,Ot),go(5,uh),go(6,rs),go(7,Ao),go(8,ah),go(9,Hie),go(10,It)],F2);class xG extends v7{constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}getLineLength(e){return this._textModel.getLineLength(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new Yr(e-1,t)}}class zie extends am{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class AOe extends le{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=Ii(this,this._editor.onDidScrollChange,o=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(o=>o===0),this.modelAttached=Ii(this,this._editor.onDidChangeModel,o=>this._editor.hasModel()),this.editorOnDidChangeViewZones=Da("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=Da("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=Zv("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const n=this._domNode.appendChild(Et("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),r=new ResizeObserver(()=>{tn(o=>{this.domNodeSizeChanged.trigger(o)})});r.observe(this._domNode),this._register(qe(()=>r.disconnect())),this._register(vt(o=>{n.className=this.isScrollTopZero.read(o)?"":"scroll-decoration"})),this._register(vt(o=>this.render(o)))}dispose(){super.dispose(),Ds(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),n=new Set(this.views.keys()),r=ze.ofStartAndLength(0,this._domNode.clientHeight);if(!r.isEmpty)for(const o of i){const a=new Qe(o.startLineNumber,o.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);tn(c=>{for(const h of l){if(!h.range.intersect(a))continue;n.delete(h.id);let d=this.views.get(h.id);if(d)d.item.set(h,c);else{const b=document.createElement("div");this._domNode.appendChild(b);const C=lt("item",h),x=this.itemProvider.createView(C,b);d=new MOe(C,x,b),this.views.set(h.id,d)}const g=h.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(h.range.startLineNumber,!0)-t:h.range.startLineNumber>1?this._editor.getBottomForLineNumber(h.range.startLineNumber-1,!1)-t:0,_=(h.range.endLineNumberExclusive===1?Math.max(g,this._editor.getTopForLineNumber(h.range.startLineNumber,!1)-t):Math.max(g,this._editor.getBottomForLineNumber(h.range.endLineNumberExclusive-1,!0)-t))-g;d.domNode.style.top=`${g}px`,d.domNode.style.height=`${_}px`,d.gutterItemView.layout(ze.ofStartAndLength(g,_),r)}})}for(const o of n){const a=this.views.get(o);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(o)}}}class MOe{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}var Uie=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},fL=function(s,e){return function(t,i){e(t,i,s)}};const xA=[],Mx=35;let tP=class extends le{constructor(e,t,i,n,r,o,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=n,this._sashLayout=r,this._boundarySashes=o,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(xn.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=Ii(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(d=>d.length>0),this._showSash=We(this,d=>this._options.renderSideBySide.read(d)&&this._hasActions.read(d)),this.width=We(this,d=>this._hasActions.read(d)?Mx:0),this.elements=Et("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:Mx+"px"}},[]),this._currentDiff=We(this,d=>{var b;const g=this._diffModel.read(d);if(!g)return;const p=(b=g.diff.read(d))==null?void 0:b.mappings,_=this._editors.modifiedCursor.read(d);if(_)return p==null?void 0:p.find(C=>C.lineRangeMapping.modified.contains(_.lineNumber))}),this._selectedDiffs=We(this,d=>{const g=this._diffModel.read(d),p=g==null?void 0:g.diff.read(d);if(!p)return xA;const _=this._editors.modifiedSelections.read(d);if(_.every(S=>S.isEmpty()))return xA;const b=new Jo(_.map(S=>Qe.fromRangeInclusive(S))),x=p.mappings.filter(S=>S.lineRangeMapping.innerChanges&&b.intersects(S.lineRangeMapping.modified)).map(S=>({mapping:S,rangeMappings:S.lineRangeMapping.innerChanges.filter(y=>_.some(k=>G.areIntersecting(y.modifiedRange,k)))}));return x.length===0||x.every(S=>S.rangeMappings.length===0)?xA:x}),this._register(z5e(e,this.elements.root)),this._register(ie(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Fd(this.elements.root,{display:this._hasActions.map(d=>d?"block":"none")})),Bl(this,d=>this._showSash.read(d)?new Vie(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,i7(this,p=>this._sashLayout.sashLeft.read(p)-Mx,(p,_)=>this._sashLayout.sashLeft.set(p+Mx,_)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);const h=We(this,d=>{const g=this._diffModel.read(d);if(!g)return[];const p=g.diff.read(d);if(!p)return[];const _=this._selectedDiffs.read(d);if(_.length>0){const C=To.fromRangeMappings(_.flatMap(x=>x.rangeMappings));return[new LG(C,!0,xn.DiffEditorSelectionToolbar,void 0,g.model.original.uri,g.model.modified.uri)]}const b=this._currentDiff.read(d);return p.mappings.map(C=>new LG(C.lineRangeMapping.withInnerChangesFromLineRanges(),C.lineRangeMapping===(b==null?void 0:b.lineRangeMapping),xn.DiffEditorHunkToolbar,void 0,g.model.original.uri,g.model.modified.uri))});this._register(new AOe(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(d,g)=>h.read(g),createView:(d,g)=>this._instantiationService.createInstance(iP,d,g,this)})),this._register(ie(this.elements.gutter,Le.MOUSE_WHEEL,d=>{this._editors.modified.getOption(117).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(d)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new xG(this._editors.modifiedModel.get()),n=new xG(this._editors.original.getModel());return new Av(t.map(a=>a.toTextEdit(i))).apply(n)}layout(e){this.elements.gutter.style.left=e+"px"}};tP=Uie([fL(6,It),fL(7,Ot),fL(8,Em)],tP);class LG{constructor(e,t,i,n,r,o){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=n,this.originalUri=r,this.modifiedUri=o}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let iP=class extends le{constructor(e,t,i,n){super(),this._item=e,this._elements=Et("div.gutterItem",{style:{height:"20px",width:"34px"}},[Et("div.background@background",{},[]),Et("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,o=>o.showAlways),this._menuId=this._item.map(this,o=>o.menuId),this._isSmall=lt(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const r=this._register(n.createInstance(tC,"element",{instantHover:!0},{position:{hoverPosition:1}}));this._register(B0(t,this._elements.root)),this._register(vt(o=>{const a=this._showAlways.read(o);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(fl((o,a)=>{this._elements.buttons.replaceChildren();const l=a.add(n.createInstance(F2,this._elements.buttons,this._menuId.read(o),{orientation:1,hoverDelegate:r,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(o)?1:3},hiddenItemStrategy:0,actionRunner:a.add(new zie(()=>{const c=this._item.read(void 0),h=c.mapping;return{mapping:h,originalWithModifiedChanges:i.computeStagedValue(h),originalUri:c.originalUri,modifiedUri:c.modifiedUri}})),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const n=e.length/2-i/2,r=i;let o=e.start+n;const a=ze.tryCreate(r,t.endExclusive-r-i),l=ze.tryCreate(e.start+r,e.endExclusive-i-r);l&&a&&l.start<l.endExclusive&&(o=a.clip(o),o=l.clip(o)),this._elements.buttons.style.top=`${o-e.start}px`}};iP=Uie([fL(3,It)],iP);var OOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},POe=function(s,e){return function(t,i){e(t,i,s)}},nP,xd;let sP=(xd=class extends le{static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=n,this._modifiedOutlineSource=Bl(this,l=>{const c=this._editors.modifiedModel.read(l),h=nP._breadcrumbsSourceFactory.read(l);return!c||!h?void 0:h(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();tn(h=>{for(const d of this._editors.original.getSelections()||[])c==null||c.ensureOriginalLineIsVisible(d.getStartPosition().lineNumber,0,h),c==null||c.ensureOriginalLineIsVisible(d.getEndPosition().lineNumber,0,h)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();tn(h=>{for(const d of this._editors.modified.getSelections()||[])c==null||c.ensureModifiedLineIsVisible(d.getStartPosition().lineNumber,0,h),c==null||c.ensureModifiedLineIsVisible(d.getEndPosition().lineNumber,0,h)})}));const r=this._diffModel.map((l,c)=>{var d;const h=(l==null?void 0:l.unchangedRegions.read(c))??[];return h.length===1&&h[0].modifiedLineNumber===1&&h[0].lineCount===((d=this._editors.modifiedModel.read(c))==null?void 0:d.getLineCount())?[]:h});this.viewZones=We(this,l=>{const c=this._modifiedOutlineSource.read(l);if(!c)return{origViewZones:[],modViewZones:[]};const h=[],d=[],g=this._options.renderSideBySide.read(l),p=this._options.compactMode.read(l),_=r.read(l);for(let b=0;b<_.length;b++){const C=_[b];if(!C.shouldHideControls(l)&&!(p&&(b===0||b===_.length-1)))if(p){{const x=We(this,y=>C.getHiddenOriginalRange(y).startLineNumber-1),S=new d_(x,12);h.push(S),l.store.add(new kG(this._editors.original,S,C,!g))}{const x=We(this,y=>C.getHiddenModifiedRange(y).startLineNumber-1),S=new d_(x,12);d.push(S),l.store.add(new kG(this._editors.modified,S,C))}}else{{const x=We(this,y=>C.getHiddenOriginalRange(y).startLineNumber-1),S=new d_(x,24);h.push(S),l.store.add(new EG(this._editors.original,S,C,C.originalUnchangedRange,!g,c,y=>this._diffModel.get().ensureModifiedLineIsVisible(y,2,void 0),this._options))}{const x=We(this,y=>C.getHiddenModifiedRange(y).startLineNumber-1),S=new d_(x,24);d.push(S),l.store.add(new EG(this._editors.modified,S,C,C.modifiedUnchangedRange,!1,c,y=>this._diffModel.get().ensureModifiedLineIsVisible(y,2,void 0),this._options))}}}return{origViewZones:h,modViewZones:d}});const o={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new ste(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(v(124,"Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Ct.asClassName(Ae.fold),zIndex:10001};this._register(M2(this._editors.original,We(this,l=>{const c=r.read(l),h=c.map(d=>({range:d.originalUnchangedRange.toInclusiveRange(),options:o}));for(const d of c)d.shouldHideControls(l)&&h.push({range:G.fromPositions(new J(d.originalLineNumber,1)),options:a});return h}))),this._register(M2(this._editors.modified,We(this,l=>{const c=r.read(l),h=c.map(d=>({range:d.modifiedUnchangedRange.toInclusiveRange(),options:o}));for(const d of c)d.shouldHideControls(l)&&h.push({range:Qe.ofLength(d.modifiedLineNumber,1).toInclusiveRange(),options:a});return h}))),this._register(vt(l=>{const c=r.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(h=>h.getHiddenOriginalRange(l).toInclusiveRange()).filter(Xo)),this._editors.modified.setHiddenAreas(c.map(h=>h.getHiddenModifiedRange(l).toInclusiveRange()).filter(Xo))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const h=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const g=d.unchangedRegions.get().find(p=>p.modifiedUnchangedRange.contains(h));if(!g)return;g.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const h=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const g=d.unchangedRegions.get().find(p=>p.originalUnchangedRange.contains(h));if(!g)return;g.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}},nP=xd,xd._breadcrumbsSourceFactory=lt(xd,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}})),xd);sP=nP=OOe([POe(3,It)],sP);class kG extends e9{constructor(e,t,i,n=!1){const r=Et("div.diff-hidden-lines-widget");super(e,t,r.root),this._unchangedRegion=i,this._hide=n,this._nodes=Et("div.diff-hidden-lines-compact",[Et("div.line-left",[]),Et("div.text@text",[]),Et("div.line-right",[])]),r.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(vt(o=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(o).length,l=v(125,"{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class EG extends e9{constructor(e,t,i,n,r,o,a,l){const c=Et("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=n,this._hide=r,this._modifiedOutlineSource=o,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=Et("div.diff-hidden-lines",[Et("div.top@top",{title:v(126,"Click or drag to show more above")}),Et("div.center@content",{style:{display:"flex"}},[Et("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[Ke("a",{title:v(127,"Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Ig("$(unfold)"))]),Et("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),Et("div.bottom@bottom",{title:v(128,"Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?Ds(this._nodes.first):this._register(Fd(this._nodes.first,{width:bg(this._editor).layoutInfoContentLeft})),this._register(vt(d=>{const g=this._unchangedRegion.visibleLineCountTop.read(d)+this._unchangedRegion.visibleLineCountBottom.read(d)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!g),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(d)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(d)>0),this._nodes.top.classList.toggle("canMoveBottom",!g);const p=this._unchangedRegion.isDragged.read(d),_=this._editor.getDomNode();_&&(_.classList.toggle("draggingUnchangedRegion",!!p),p==="top"?(_.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(d)>0),_.classList.toggle("canMoveBottom",!g)):p==="bottom"?(_.classList.toggle("canMoveTop",!g),_.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(d)>0)):(_.classList.toggle("canMoveTop",!1),_.classList.toggle("canMoveBottom",!1)))}));const h=this._editor;this._register(ie(this._nodes.top,"mousedown",d=>{if(d.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),d.preventDefault();const g=d.clientY;let p=!1;const _=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const b=Ue(this._nodes.top),C=ie(b,"mousemove",S=>{const k=S.clientY-g;p=p||Math.abs(k)>2;const D=Math.round(k/h.getOption(75)),R=Math.max(0,Math.min(_+D,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(R,void 0)}),x=ie(b,"mouseup",S=>{p||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),C.dispose(),x.dispose()})})),this._register(ie(this._nodes.bottom,"mousedown",d=>{if(d.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),d.preventDefault();const g=d.clientY;let p=!1;const _=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const b=Ue(this._nodes.bottom),C=ie(b,"mousemove",S=>{const k=S.clientY-g;p=p||Math.abs(k)>2;const D=Math.round(k/h.getOption(75)),R=Math.max(0,Math.min(_-D,this._unchangedRegion.getMaxVisibleLineCountBottom())),N=this._unchangedRegionRange.endLineNumberExclusive>h.getModel().getLineCount()?h.getContentHeight():h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(R,void 0);const A=this._unchangedRegionRange.endLineNumberExclusive>h.getModel().getLineCount()?h.getContentHeight():h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);h.setScrollTop(h.getScrollTop()+(A-N))}),x=ie(b,"mouseup",S=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!p){const y=h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const k=h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);h.setScrollTop(h.getScrollTop()+(k-y))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),C.dispose(),x.dispose()})})),this._register(vt(d=>{const g=[];if(!this._hide){const p=i.getHiddenModifiedRange(d).length,_=v(129,"{0} hidden lines",p),b=Ke("span",{title:v(130,"Double click to unfold")},_);b.addEventListener("dblclick",S=>{S.button===0&&(S.preventDefault(),this._unchangedRegion.showAll(void 0))}),g.push(b);const C=this._unchangedRegion.getHiddenModifiedRange(d),x=this._modifiedOutlineSource.getBreadcrumbItems(C,d);if(x.length>0){g.push(Ke("span",void 0,"|"));for(let S=0;S<x.length;S++){const y=x[S],k=bM.toIcon(y.kind),D=Et("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[sC(k),"",y.name,...S===x.length-1?[]:[sC(Ae.chevronRight)]]).root;g.push(D),D.onclick=()=>{this._revealModifiedHiddenLine(y.startLineNumber)}}}}Ds(this._nodes.others,...g)}))}}const LA=[];class FOe extends le{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=n,this._selectedDiffs=We(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return LA;const l=this._editors.modifiedSelections.read(r);if(l.every(g=>g.isEmpty()))return LA;const c=new Jo(l.map(g=>Qe.fromRangeInclusive(g))),d=a.mappings.filter(g=>g.lineRangeMapping.innerChanges&&c.intersects(g.lineRangeMapping.modified)).map(g=>({mapping:g,rangeMappings:g.lineRangeMapping.innerChanges.filter(p=>l.some(_=>G.areIntersecting(p.modifiedRange,_)))}));return d.length===0||d.every(g=>g.rangeMappings.length===0)?LA:d}),this._register(fl((r,o)=>{if(!this._options.shouldRenderOldRevertArrows.read(r))return;const a=this._diffModel.read(r),l=a==null?void 0:a.diff.read(r);if(!a||!l||a.movedTextToCompare.read(r))return;const c=[],h=this._selectedDiffs.read(r),d=new Set(h.map(g=>g.mapping));if(h.length>0){const g=this._editors.modifiedSelections.read(r),p=o.add(new B2(g[g.length-1].positionLineNumber,this._widget,h.flatMap(_=>_.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(p),c.push(p)}for(const g of l.mappings)if(!d.has(g)&&!g.lineRangeMapping.modified.isEmpty&&g.lineRangeMapping.innerChanges){const p=o.add(new B2(g.lineRangeMapping.modified.startLineNumber,this._widget,g.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(p),c.push(p)}o.add(qe(()=>{for(const g of c)this._editors.modified.removeGlyphMarginWidget(g)}))}))}}const AE=class AE extends le{getId(){return this._id}constructor(e,t,i,n){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=n,this._id=`revertButton${AE.counter++}`,this._domNode=Et("div.revertButton",{title:this._revertSelection?v(135,"Revert Selected Changes"):v(136,"Revert Change")},[sC(Ae.arrowRight)]).root,this._register(ie(this._domNode,Le.MOUSE_DOWN,r=>{r.button!==2&&(r.stopPropagation(),r.preventDefault())})),this._register(ie(this._domNode,Le.MOUSE_UP,r=>{r.stopPropagation(),r.preventDefault()})),this._register(ie(this._domNode,Le.CLICK,r=>{this._diffs instanceof Gs?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),r.stopPropagation(),r.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:Rd.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};AE.counter=0;let B2=AE;var BOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},k0=function(s,e){return function(t,i){e(t,i,s)}};let V2=class extends Z3{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,n,r,o,a,l){super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=r,this._codeEditorService=o,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=Et("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[Et("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),Et("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),Et("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(QX(this,void 0)),this._diffModel=We(this,k=>{var D;return(D=this._diffModelSrc.read(k))==null?void 0:D.object}),this.onDidChangeModel=Se.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new ib([Ot,this._contextKeyService]))),this._boundarySashes=lt(this,void 0),this._accessibleDiffViewerShouldBeVisible=lt(this,!1),this._accessibleDiffViewerVisible=We(this,k=>this._options.onlyShowAccessibleDiffViewer.read(k)?!0:this._accessibleDiffViewerShouldBeVisible.read(k)),this._movedBlocksLinesPart=lt(this,void 0),this._layoutInfo=We(this,k=>{var ee,ue;const D=this._rootSizeObserver.width.read(k),R=this._rootSizeObserver.height.read(k);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=R+"px";const N=this._sash.read(k),A=this._gutter.read(k),M=(A==null?void 0:A.width.read(k))??0,O=((ee=this._overviewRulerPart.read(k))==null?void 0:ee.width)??0;let V,H,U,X,Y;if(!!N){const oe=N.sashLeft.read(k),Ee=((ue=this._movedBlocksLinesPart.read(k))==null?void 0:ue.width.read(k))??0;V=0,H=oe-M-Ee,Y=oe-M,U=oe,X=D-U-O}else{Y=0;const oe=this._options.inlineViewHideOriginalLineNumbers.read(k);V=M,oe?H=0:H=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(k)),U=M+H,X=D-U-O}return this.elements.original.style.left=V+"px",this.elements.original.style.width=H+"px",this._editors.original.layout({width:H,height:R},!0),A==null||A.layout(Y),this.elements.modified.style.left=U+"px",this.elements.modified.style.width=X+"px",this._editors.modified.layout({width:X,height:R},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((k,D)=>k==null?void 0:k.diff.read(D)),this.onDidUpdateDiff=Se.fromObservableLight(this._diffValue),this._codeEditorService.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(qe(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new Mie(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(J3,t),this._register(vt(k=>{this._options.setWidth(this._rootSizeObserver.width.read(k))})),this._contextKeyService.createKey(Oe.isEmbeddedDiffEditor.key,!1),this._register(ou(Oe.isEmbeddedDiffEditor,this._contextKeyService,k=>this._options.isInEmbeddedEditor.read(k))),this._register(ou(Oe.comparingMovedCode,this._contextKeyService,k=>{var D;return!!((D=this._diffModel.read(k))!=null&&D.movedTextToCompare.read(k))})),this._register(ou(Oe.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,k=>this._options.couldShowInlineViewBecauseOfSize.read(k))),this._register(ou(Oe.diffEditorInlineMode,this._contextKeyService,k=>!this._options.renderSideBySide.read(k))),this._register(ou(Oe.hasChanges,this._contextKeyService,k=>{var D,R;return(((R=(D=this._diffModel.read(k))==null?void 0:D.diff.read(k))==null?void 0:R.mappings.length)??0)>0})),this._editors=this._register(this._instantiationService.createInstance(X3,this.elements.original,this.elements.modified,this._options,i,(k,D,R,N)=>this._createInnerEditor(k,D,R,N))),this._register(ou(Oe.diffEditorOriginalWritable,this._contextKeyService,k=>this._options.originalEditable.read(k))),this._register(ou(Oe.diffEditorModifiedWritable,this._contextKeyService,k=>!this._options.readOnly.read(k))),this._register(ou(Oe.diffEditorOriginalUri,this._contextKeyService,k=>{var D;return((D=this._diffModel.read(k))==null?void 0:D.model.original.uri.toString())??""})),this._register(ou(Oe.diffEditorModifiedUri,this._contextKeyService,k=>{var D;return((D=this._diffModel.read(k))==null?void 0:D.model.modified.uri.toString())??""})),this._overviewRulerPart=Bl(this,k=>this._options.renderOverviewRuler.read(k)?this._instantiationService.createInstance(cu(wC),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(D=>D.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((k,D)=>{var R;return k-(((R=this._overviewRulerPart.read(D))==null?void 0:R.width)??0)})};this._sashLayout=new xOe(this._options,c),this._sash=Bl(this,k=>{const D=this._options.renderSideBySide.read(k);return this.elements.root.classList.toggle("side-by-side",D),D?new Vie(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const h=Bl(this,k=>this._instantiationService.createInstance(cu(sP),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Bl(this,k=>this._instantiationService.createInstance(cu(vOe),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const d=new Set,g=new Set;let p=!1;const _=Bl(this,k=>this._instantiationService.createInstance(cu(Y3),Ue(this._domElement),this._editors,this._diffModel,this._options,this,()=>p||h.read(void 0).isUpdatingHiddenAreas,d,g)).recomputeInitiallyAndOnChange(this._store),b=We(this,k=>{const D=_.read(k).viewZones.read(k).orig,R=h.read(k).viewZones.read(k).origViewZones;return D.concat(R)}),C=We(this,k=>{const D=_.read(k).viewZones.read(k).mod,R=h.read(k).viewZones.read(k).modViewZones;return D.concat(R)});this._register(O2(this._editors.original,b,k=>{p=k},d));let x;this._register(O2(this._editors.modified,C,k=>{p=k,p?x=A2.capture(this._editors.modified):(x==null||x.restore(this._editors.modified),x=void 0)},g)),this._accessibleDiffViewer=Bl(this,k=>this._instantiationService.createInstance(cu(_g),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(D,R)=>this._accessibleDiffViewerShouldBeVisible.set(D,R),this._options.onlyShowAccessibleDiffViewer.map(D=>!D),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((D,R)=>{var N;return(N=D==null?void 0:D.diff.read(R))==null?void 0:N.mappings.map(A=>A.lineRangeMapping)}),new iOe(this._editors))).recomputeInitiallyAndOnChange(this._store);const S=this._accessibleDiffViewerVisible.map(k=>k?"hidden":"visible");this._register(Fd(this.elements.modified,{visibility:S})),this._register(Fd(this.elements.original,{visibility:S})),this._createDiffEditorContributions(),this._codeEditorService.addDiffEditor(this),this._register(qe(()=>{this._codeEditorService.removeDiffEditor(this)})),this._gutter=Bl(this,k=>this._options.shouldRenderGutterMenu.read(k)?this._instantiationService.createInstance(cu(tP),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(fD(this._layoutInfo)),Bl(this,k=>new(cu(t1))(this.elements.root,this._diffModel,this._layoutInfo.map(D=>D.originalEditor),this._layoutInfo.map(D=>D.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,k=>{this._movedBlocksLinesPart.set(k,void 0)}),this._register(Se.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,k=>this._handleCursorPositionChange(k,!0))),this._register(Se.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,k=>this._handleCursorPositionChange(k,!1)));const y=this._diffModel.map(this,(k,D)=>{if(k)return k.diff.read(D)===void 0&&!k.isDiffUpToDate.read(D)});this._register(fl((k,D)=>{if(y.read(k)===!0){const R=this._editorProgressService.show(!0,1e3);D.add(qe(()=>R.done()))}})),this._register(fl((k,D)=>{D.add(new(cu(FOe))(this._editors,this._diffModel,this._options,this))})),this._register(fl((k,D)=>{const R=this._diffModel.read(k);if(R)for(const N of[R.model.original,R.model.modified])D.add(N.onWillDispose(A=>{$t(new $e("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(vt(k=>{this._options.setModel(this._diffModel.read(k))}))}_createInnerEditor(e,t,i,n){return e.createInstance(i2,t,i,n)}_createDiffEditorContributions(){const e=F_.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){$t(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return ID.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var i;const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:(i=this._diffModel.get())==null?void 0:i.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())==null||t.restoreSerializedState(i.modelState))}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(K3,e,this._options)}getModel(){var e;return((e=this._diffModel.get())==null?void 0:e.model)??null}setModel(e){const t=e?"model"in e?P2.create(e).createNewRef(this):P2.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==(e==null?void 0:e.object)&&s7(t,n=>{var a;const r=e==null?void 0:e.object;Ii.batchEventsGlobally(n,()=>{this._editors.original.setModel(r?r.model.original:null),this._editors.modified.setModel(r?r.model.modified:null)});const o=(a=this._diffModelSrc.get())==null?void 0:a.createNewRef(this);this._diffModelSrc.set(e==null?void 0:e.createNewRef(this),n),setTimeout(()=>{o==null||o.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?VOe(e):null}getDiffComputationResult(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?{changes:this.getLineChanges(),changes2:e.mappings.map(i=>i.lineRangeMapping),identical:e.identical,quitEarly:e.quitEarly}:null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||(this._editors.modified.pushUndoStop(),this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}]),this._editors.modified.pushUndoStop())}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(n=>({range:n.modifiedRange,text:t.model.original.getValueInRange(n.originalRange)}));this._editors.modified.pushUndoStop(),this._editors.modified.executeEdits("diffEditor",i),this._editors.modified.pushUndoStop()}revertFocusedRangeMappings(){var l,c;const e=this._diffModel.get();if(!e||!e.isDiffUpToDate.get())return;const t=(c=(l=this._diffModel.get())==null?void 0:l.diff.get())==null?void 0:c.mappings;if(!t||t.length===0)return;const i=this._editors.modified;if(!i.hasTextFocus())return;const n=i.getPosition().lineNumber,r=i.getSelection(),o=Qe.fromRange(r||new G(n,0,n,0)),a=t.filter(h=>h.lineRangeMapping.modified.intersect(o));i.pushUndoStop(),i.executeEdits("diffEditor",a.map(h=>({range:h.lineRangeMapping.modified.toExclusiveRange(),text:e.model.original.getValueInRange(h.lineRangeMapping.original.toExclusiveRange())}))),i.pushUndoStop()}_goTo(e){this._editors.modified.setPosition(new J(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){var r,o;const t=(o=(r=this._diffModel.get())==null?void 0:r.diff.get())==null?void 0:o.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let n;e==="next"?this._editors.modified.getModel().getLineCount()===i?n=t[0]:n=t.find(l=>l.lineRangeMapping.modified.startLineNumber>i)??t[0]:n=pk(t,a=>a.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(n),n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(Yl.diffLineDeleted,{source:"diffEditor.goToDiff"}):n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(Yl.diffLineInserted,{source:"diffEditor.goToDiff"}):n&&this._accessibilitySignalService.playSignal(Yl.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{var i;const t=(i=e.diff.get())==null?void 0:i.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){var o,a;const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let n;const r=t.getSelection();if(r){const l=(a=(o=this._diffModel.get())==null?void 0:o.diff.get())==null?void 0:a.mappings.map(c=>e?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=aG(r.getStartPosition(),l),h=aG(r.getEndPosition(),l);n=G.plusRange(c,h)}}return{destination:i,destinationSelection:n}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&tn(i=>{for(const n of e)n.collapseAll(i)})}showAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&tn(i=>{for(const n of e)n.showAll(i)})}_handleCursorPositionChange(e,t){var i,n;if((e==null?void 0:e.reason)===3){const r=(n=(i=this._diffModel.get())==null?void 0:i.diff.get())==null?void 0:n.mappings.find(o=>t?o.lineRangeMapping.modified.contains(e.position.lineNumber):o.lineRangeMapping.original.contains(e.position.lineNumber));r!=null&&r.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(Yl.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):r!=null&&r.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(Yl.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):r&&this._accessibilitySignalService.playSignal(Yl.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};V2=BOe([k0(3,Ot),k0(4,It),k0(5,In),k0(6,aT),k0(7,E8)],V2);function VOe(s){return s.mappings.map(e=>{const t=e.lineRangeMapping;let i,n,r,o,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,o=0,a=void 0):(r=t.modified.startLineNumber,o=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:r,modifiedEndLineNumber:o,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}function HOe(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===ID.ICodeEditor:!1}var WOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},DG=function(s,e){return function(t,i){e(t,i,s)}},gL,jg;let rP=(jg=class{constructor(e,t){this._configurationService=e,this._languageService=t}async renderCodeBlock(e,t,i){var h;const n=HOe(i.context)?i.context:void 0;let r;e?r=this._languageService.getLanguageIdByLanguageName(e):n&&(r=(h=n.getModel())==null?void 0:h.getLanguageId()),r||(r=Aa);const o=await UEe(this._languageService,t,r),a=gL._ttpTokenizer?gL._ttpTokenizer.createHTML(o)??o:o,l=document.createElement("span");l.innerHTML=a;const c=l.querySelector(".monaco-tokenized-source");return nn(c)?(vs(c,this.getFontInfo(n)),l):document.createElement("span")}getFontInfo(e){return e?e.getOption(59):pve({fontFamily:this._configurationService.getValue("editor").fontFamily},1)}},gL=jg,jg._ttpTokenizer=Wd("tokenizeToString",{createHTML(e){return e}}),jg);rP=gL=WOe([DG(0,yi),DG(1,Qn)],rP);var o9=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ti=function(s,e){return function(t,i){e(t,i,s)}};let zOe=0,TG=!1;function UOe(s){if(!s){if(TG)return;TG=!0}cve(s||ni.document.body)}let H2=class extends i2{constructor(e,t,i,n,r,o,a,l,c,h,d,g,p,_){const b={...t};b.ariaLabel=b.ariaLabel||IO.editorViewAccessibleLabel,super(e,b,{},i,n,r,o,c,h,d,g,p),l instanceof F1?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,UOe(b.ariaContainerElement),bRe((C,x)=>i.createInstance(tC,C,{instantHover:x},{})),wRe(a),_.setDefaultCodeBlockRenderer(i.createInstance(rP))}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++zOe,r=xt.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,r),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),le.None;const t=e.id,i=e.label,n=xt.and(xt.equals("editorId",this.getId()),xt.deserialize(e.precondition)),r=e.keybindings,o=xt.and(n,xt.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(p,..._)=>Promise.resolve(e.run(this,..._)),h=new Pe,d=this.getId()+":"+t;if(h.add(Or.registerCommand(d,c)),a){const p={command:{id:d,title:i},when:n,group:a,order:l};h.add(y1.appendMenuItem(xn.EditorContext,p))}if(Array.isArray(r))for(const p of r)h.add(this._standaloneKeybindingService.addDynamicKeybinding(d,p,c,o));const g=new cee(d,i,i,void 0,n,(...p)=>Promise.resolve(e.run(this,...p)),this._contextKeyService);return this._actions.set(t,g),h.add(qe(()=>{this._actions.delete(t)})),h}_triggerCommand(e,t){if(this._codeEditorService instanceof n2)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};H2=o9([ti(2,It),ti(3,In),ti(4,Ao),ti(5,Ot),ti(6,ty),ti(7,rs),ti(8,Zr),ti(9,Ba),ti(10,Mo),ti(11,kc),ti(12,mi),ti(13,KD)],H2);let oP=class extends H2{constructor(e,t,i,n,r,o,a,l,c,h,d,g,p,_,b,C,x){const S={...t};R2(d,S,!1);const y=c.registerEditorContainer(e);typeof S.theme=="string"&&c.setTheme(S.theme),typeof S.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!S.autoDetectHighContrast);const k=S.model;delete S.model,super(e,S,i,n,r,o,a,l,c,h,g,b,C,x),this._configurationService=d,this._standaloneThemeService=c,this._register(y);let D;if(typeof k>"u"){const R=_.getLanguageIdByMimeType(S.language)||S.language||Aa;D=jie(p,_,S.value||"",R,void 0),this._ownsModel=!0}else D=k,this._ownsModel=!1;if(this._attachModel(D),D){const R={oldModelUrl:null,newModelUrl:D.uri};this._onDidChangeModel.fire(R)}}dispose(){super.dispose()}updateOptions(e){R2(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};oP=o9([ti(2,It),ti(3,In),ti(4,Ao),ti(5,Ot),ti(6,ty),ti(7,rs),ti(8,Va),ti(9,Ba),ti(10,yi),ti(11,Mo),ti(12,mr),ti(13,Qn),ti(14,kc),ti(15,mi),ti(16,KD)],oP);let aP=class extends V2{constructor(e,t,i,n,r,o,a,l,c,h,d,g){const p={...t};R2(l,p,!0);const _=o.registerEditorContainer(e);typeof p.theme=="string"&&o.setTheme(p.theme),typeof p.autoDetectHighContrast<"u"&&o.setAutoDetectHighContrast(!!p.autoDetectHighContrast),super(e,p,{},n,i,r,g,h),this._configurationService=l,this._standaloneThemeService=o,this._register(_)}dispose(){super.dispose()}updateOptions(e){R2(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(H2,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};aP=o9([ti(2,It),ti(3,Ot),ti(4,In),ti(5,Va),ti(6,Ba),ti(7,yi),ti(8,uh),ti(9,E8),ti(10,Z8),ti(11,aT)],aP);function jie(s,e,t,i,n){if(t=t||"",!i){const r=t.indexOf(`
`);let o=t;return r!==-1&&(o=t.substring(0,r)),NG(s,t,e.createByFilepathOrFirstLine(n||null,o),n)}return NG(s,t,e.createById(i),n)}function NG(s,e,t,i){return s.createModel(e,t,i)}j("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},v(142,"The background color of the diff editor's header"));j("multiDiffEditor.background",Oa,v(143,"The background color of the multi file diff editor"));j("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},v(144,"The border color of the multi file diff editor"));var jOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},IG=function(s,e){return function(t,i){e(t,i,s)}};class $Oe{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let lP=class extends le{constructor(e,t,i,n,r){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=lt(this,void 0),this._collapsed=We(this,l=>{var c;return(c=this._viewModel.read(l))==null?void 0:c.collapsed.read(l)}),this._editorContentHeight=lt(this,500),this.contentHeight=We(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=lt(this,0),this._modifiedWidth=lt(this,0),this._originalContentWidth=lt(this,0),this._originalWidth=lt(this,0),this.maxScroll=We(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),h=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>h?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:h,width:this._originalWidth.read(l)}}),this._elements=Et("div.multiDiffEntry",[Et("div.header@header",[Et("div.header-content",[Et("div.collapse-button@collapseButton"),Et("div.file-path",[Et("div.title.modified.show-file-icons@primaryPath",[]),Et("div.status.deleted@status",["R"]),Et("div.title.original.show-file-icons@secondaryPath",[])]),Et("div.actions@actions")])]),Et("div.editorParent",[Et("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(V2,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode,fixedOverflowWidgets:!0},{})),this.isModifedFocused=bg(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=bg(this.editor.getOriginalEditor()).isFocused,this.isFocused=We(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new Pe),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const o=new t3(this._elements.collapseButton,{});this._register(vt(l=>{o.element.className="",o.icon=this._collapsed.read(l)?Ae.chevronRight:Ae.chevronDown})),this._register(o.onDidClick(()=>{var l;(l=this._viewModel.get())==null||l.collapsed.set(!this._collapsed.get(),void 0)})),this._register(vt(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{T0(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register(vt(l=>{var h;const c=(h=this._viewModel.read(l))==null?void 0:h.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(r.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new ib([Ot,this._contextKeyService])));this._register(a.createInstance(F2,this._elements.actions,xn.MultiDiffEditorFileToolbar,{actionRunner:this._register(new zie(()=>{var l,c;return((l=this._viewModel.get())==null?void 0:l.modifiedUri)??((c=this._viewModel.get())==null?void 0:c.originalUri)})),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>qte(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(n){return{...n,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){T0(n=>{this._viewModel.set(void 0,n),this.editor.setDiffModel(null,n),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(T0(n=>{var c,h;(c=this._resourceLabel)==null||c.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let r=!1,o=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",r=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",o=!0),this._elements.status.classList.toggle("renamed",r),this._elements.status.classList.toggle("deleted",o),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,(h=this._resourceLabel2)==null||h.setUri(r?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,n),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,n=>{n||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[n,r]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(n,r)}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const r=e.length-this._headerHeight,o=Math.max(0,Math.min(n.start-e.start,r));this._elements.header.style.transform=`translateY(${o}px)`,T0(a=>{this.editor.layout({width:t-16-2,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",o>0||i>0),this._elements.header.classList.toggle("collapsed",o===r)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};lP=jOe([IG(3,It),IG(4,Ot)],lP);class qOe{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(n=>this._itemData.get(n).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var GOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},RG=function(s,e){return function(t,i){e(t,i,s)}};let cP=class extends le{constructor(e,t,i,n,r,o){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=r,this._parentInstantiationService=o,this._scrollableElements=Et("div.scrollContent",[Et("div@content",{style:{overflow:"hidden"}}),Et("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new eb({forceIntegerValues:!1,scheduleAtNextAnimationFrame:c=>Ar(Ue(this._element),c),smoothScrollDuration:100})),this._scrollableElement=this._register(new HD(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=Et("div.monaco-component.multiDiffEditor",{},[Et("div",{},[this._scrollableElement.getDomNode()]),Et("div.placeholder@placeholder",{},[Et("div")])]),this._sizeObserver=this._register(new Mie(this._element,void 0)),this._objectPool=this._register(new qOe(c=>{const h=this._instantiationService.createInstance(lP,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return h.setData(c),h})),this.scrollTop=Ii(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=Ii(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=We(this,c=>{const h=this._viewModel.read(c);if(!h)return{items:[],getItem:_=>{throw new $e}};const d=h.items.read(c),g=new Map;return{items:d.map(_=>{var x;const b=c.store.add(new YOe(_,this._objectPool,this.scrollLeft,S=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+S})})),C=(x=this._lastDocStates)==null?void 0:x[b.getKey()];return C&&tn(S=>{b.setViewState(C,S)}),g.set(_,b),b}),getItem:_=>g.get(_)}}),this._viewItems=this._viewItemsInfo.map(this,c=>c.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(c,h)=>c.reduce((d,g)=>d+g.contentHeight.read(h)+this._spaceBetweenPx,0)),this.activeControl=We(this,c=>{var g,p;const h=(g=this._viewModel.read(c))==null?void 0:g.activeDiffItem.read(c);return h?(p=this._viewItemsInfo.read(c).getItem(h).template.read(c))==null?void 0:p.editor:void 0}),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new ib([Ot,this._contextKeyService]))),this._contextKeyService.createKey(Oe.inMultiDiffEditor.key,!0),this._lastDocStates={},this._register(fl((c,h)=>{const d=this._viewModel.read(c);if(d&&d.contextKeys)for(const[g,p]of Object.entries(d.contextKeys)){const _=this._contextKeyService.createKey(g,void 0);_.set(p),h.add(qe(()=>_.reset()))}}));const a=this._parentContextKeyService.createKey(Oe.multiDiffEditorAllCollapsed.key,!1);this._register(vt(c=>{const h=this._viewModel.read(c);if(h){const d=h.items.read(c).every(g=>g.collapsed.read(c));a.set(d)}})),this._register(vt(c=>{const h=this._dimension.read(c);this._sizeObserver.observe(h)}));const l=We(c=>{if(this._viewItems.read(c).length>0)return;const d=this._viewModel.read(c);return!d||d.isLoading.read(c)?v(145,"Loading..."):v(146,"No Changed Files")});this._register(vt(c=>{const h=l.read(c);this._elements.placeholder.innerText=h??"",this._elements.placeholder.classList.toggle("visible",!!h)})),this._scrollableElements.content.style.position="relative",this._register(vt(c=>{const h=this._sizeObserver.height.read(c);this._scrollableElements.root.style.height=`${h}px`;const d=this._totalHeight.read(c);this._scrollableElements.content.style.height=`${d}px`;const g=this._sizeObserver.width.read(c);let p=g;const _=this._viewItems.read(c),b=MZ(_,Do(C=>C.maxScroll.read(c).maxScroll,Uu));if(b){const C=b.maxScroll.read(c);p=g+C.maxScroll}this._scrollableElement.setScrollDimensions({width:g,height:h,scrollHeight:d,scrollWidth:p})})),e.replaceChildren(this._elements.root),this._register(qe(()=>{e.replaceChildren()})),this._register(vt(c=>{const h=this._viewModel.read(c);if(h&&!h.isLoading.read(c)){if(h.items.read(c).length===0||h.activeDiffItem.read(c))return;this.goToNextChange()}})),this._register(this._register(vt(c=>{T0(h=>{this.render(c)})})))}reveal(e,t){var c;const i=this._viewItems.get(),n=i.findIndex(h=>{var d,g,p,_;return((d=h.viewModel.originalUri)==null?void 0:d.toString())===((g=e.original)==null?void 0:g.toString())&&((p=h.viewModel.modifiedUri)==null?void 0:p.toString())===((_=e.modified)==null?void 0:_.toString())});if(n===-1)throw new $e("Resource not found in diff editor");const r=i[n];this._viewModel.get().activeDiffItem.setCache(r.viewModel,void 0);let o=0;for(let h=0;h<n;h++)o+=i[h].contentHeight.get()+this._spaceBetweenPx;this._scrollableElement.setScrollPosition({scrollTop:o});const a=(c=r.template.get())==null?void 0:c.editor,l="original"in e?a==null?void 0:a.getOriginalEditor():a==null?void 0:a.getModifiedEditor();l&&(t!=null&&t.range)&&(l.revealRangeInCenter(t.range),KOe(l,t.range))}goToNextChange(){this._navigateToChange("next")}_navigateToChange(e){var l,c,h,d,g;const t=this._viewItems.get();if(t.length===0)return;const i=(l=this._viewModel.get())==null?void 0:l.activeDiffItem.get(),n=i?t.findIndex(p=>p.viewModel===i):-1;if(n===-1){this._goToFile(0,"first");return}const r=t[n];r.viewModel.collapsed.get()&&r.viewModel.collapsed.set(!1,void 0);const o=(c=r.template.get())==null?void 0:c.editor;if((d=(h=o==null?void 0:o.getDiffComputationResult())==null?void 0:h.changes2)!=null&&d.length){const p=((g=o.getModifiedEditor().getPosition())==null?void 0:g.lineNumber)||1,_=o.getDiffComputationResult().changes2;if(e==="next"?_.some(C=>C.modified.startLineNumber>p):_.some(C=>C.modified.endLineNumberExclusive<=p)){o.goToDiff(e);return}}const a=(n+(e==="next"?1:-1)+t.length)%t.length;this._goToFile(a,e==="next"?"first":"last")}_goToFile(e,t){var r,o,a;const i=this._viewItems.get()[e];i.viewModel.collapsed.get()&&i.viewModel.collapsed.set(!1,void 0),this.reveal({original:i.viewModel.originalUri,modified:i.viewModel.modifiedUri});const n=(r=i.template.get())==null?void 0:r.editor;if((a=(o=n==null?void 0:n.getDiffComputationResult())==null?void 0:o.changes2)!=null&&a.length)if(t==="first")n.revealFirstDiff();else{const l=n.getDiffComputationResult().changes2.at(-1),c=n.getModifiedEditor();c.setPosition({lineNumber:l.modified.startLineNumber,column:1}),c.revealLineInCenter(l.modified.startLineNumber)}n==null||n.focus()}render(e){const t=this.scrollTop.read(e);let i=0,n=0,r=0;const o=this._sizeObserver.height.read(e),a=ze.ofStartAndLength(t,o),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const h=c.contentHeight.read(e),d=Math.min(h,o),g=ze.ofStartAndLength(n,d),p=ze.ofStartAndLength(r,h);if(p.isBefore(a))i-=h-d,c.hide();else if(p.isAfter(a))c.hide();else{const _=Math.max(0,Math.min(a.start-p.start,h-d));i-=_;const b=ze.ofStartAndLength(t+i,o);c.render(g,_,l,b)}n+=d+this._spaceBetweenPx,r+=h+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};cP=GOe([RG(4,Ot),RG(5,It)],cP);function KOe(s,e){const t=s.getModel(),i=s.createDecorationsCollection([{range:e,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{s.getModel()===t&&i.clear()},350)}class YOe extends le{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register(QX(this,void 0)),this.contentHeight=We(this,r=>{var o,a;return((a=(o=this._templateRef.read(r))==null?void 0:o.object.contentHeight)==null?void 0:a.read(r))??this.viewModel.lastTemplateData.read(r).contentHeight}),this.maxScroll=We(this,r=>{var o;return((o=this._templateRef.read(r))==null?void 0:o.object.maxScroll.read(r))??{maxScroll:0,scrollWidth:0}}),this.template=We(this,r=>{var o;return(o=this._templateRef.read(r))==null?void 0:o.object}),this._isHidden=lt(this,!1),this._isFocused=We(this,r=>{var o;return((o=this.template.read(r))==null?void 0:o.isFocused.read(r))??!1}),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(vt(r=>{var a;const o=this._scrollLeft.read(r);(a=this._templateRef.read(r))==null||a.object.setScrollLeft(o)})),this._register(vt(r=>{const o=this._templateRef.read(r);!o||!this._isHidden.read(r)||o.object.isFocused.read(r)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){var e;return`VirtualViewItem(${(e=this.viewModel.documentDiffItem.modified)==null?void 0:e.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){var o;this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=(o=e.selections)==null?void 0:o.map(Lt.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const r=this._templateRef.get();r&&n&&r.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&tn(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let r=this._templateRef.get();if(!r){r=this._objectPool.getUnusedObj(new $Oe(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(r,void 0);const o=this.viewModel.lastTemplateData.get().selections;o&&r.object.editor.setSelections(o)}r.object.render(e,i,t,n)}}var QOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},XOe=function(s,e){return function(t,i){e(t,i,s)}};let uP=class extends le{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=lt(this,void 0),this._viewModel=lt(this,void 0),this._widgetImpl=We(this,n=>n.store.add(this._instantiationService.createInstance(cu(cP),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory))),this._register(fD(this._widgetImpl))}};uP=QOe([XOe(2,It)],uP);function ZOe(s,e,t){return Ge.initialize(t||{}).createInstance(oP,s,e)}function JOe(s){return Ge.get(In).onCodeEditorAdd(t=>{s(t)})}function e3e(s){return Ge.get(In).onDiffEditorAdd(t=>{s(t)})}function t3e(){return Ge.get(In).listCodeEditors()}function i3e(){return Ge.get(In).listDiffEditors()}function n3e(s,e,t){return Ge.initialize(t||{}).createInstance(aP,s,e)}function s3e(s,e){const t=Ge.initialize(e||{});return new uP(s,{},t)}function r3e(s){if(typeof s.id!="string"||typeof s.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return Or.registerCommand(s.id,s.run)}function o3e(s){if(typeof s.id!="string"||typeof s.label!="string"||typeof s.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=xt.deserialize(s.precondition),t=(n,...r)=>lm.runEditorCommand(n,r,e,(o,a,l)=>Promise.resolve(s.run(a,...l))),i=new Pe;if(i.add(Or.registerCommand(s.id,t)),s.contextMenuGroupId){const n={command:{id:s.id,title:s.label},when:e,group:s.contextMenuGroupId,order:s.contextMenuOrder||0};i.add(y1.appendMenuItem(xn.EditorContext,n))}if(Array.isArray(s.keybindings)){const n=Ge.get(rs);if(!(n instanceof F1))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const r=xt.and(e,xt.deserialize(s.keybindingContext));i.add(n.addDynamicKeybindings(s.keybindings.map(o=>({keybinding:o,command:s.id,when:r}))))}}return i}function a3e(s){return $ie([s])}function $ie(s){const e=Ge.get(rs);return e instanceof F1?e.addDynamicKeybindings(s.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:xt.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),le.None)}function l3e(s,e,t){const i=Ge.get(Qn),n=i.getLanguageIdByMimeType(e)||e;return jie(Ge.get(mr),i,s,n,t)}function c3e(s,e){const t=Ge.get(Qn),i=t.getLanguageIdByMimeType(e)||e||Aa;s.setLanguage(t.createById(i))}function u3e(s,e,t){s&&Ge.get(Pm).changeOne(e,s.uri,t)}function h3e(s){Ge.get(Pm).changeAll(s,[])}function d3e(s){return Ge.get(Pm).read(s)}function f3e(s){return Ge.get(Pm).onMarkerChanged(s)}function g3e(s){return Ge.get(mr).getModel(s)}function m3e(){return Ge.get(mr).getModels()}function p3e(s){return Ge.get(mr).onModelAdded(s)}function _3e(s){return Ge.get(mr).onModelRemoved(s)}function b3e(s){return Ge.get(mr).onModelLanguageChanged(t=>{s({model:t.model,oldLanguage:t.oldLanguageId})})}function w3e(s){return Owe(Ge.get(mr),s)}function v3e(s,e){const t=Ge.get(Qn),i=Ge.get(Va);return E7.colorizeElement(i,t,s,e).then(()=>{i.registerEditorContainer(s)})}function C3e(s,e,t){const i=Ge.get(Qn);return Ge.get(Va).registerEditorContainer(ni.document.body),E7.colorize(i,s,e,t)}function y3e(s,e,t=4){return Ge.get(Va).registerEditorContainer(ni.document.body),E7.colorizeModelLine(s,e,t)}function S3e(s){const e=hn.get(s);return e||{getInitialState:()=>Ov,tokenize:(t,i,n)=>HZ(s,n)}}function x3e(s,e){hn.getOrCreate(e);const t=S3e(e),i=K1(s),n=[];let r=t.getInitialState();for(let o=0,a=i.length;o<a;o++){const l=i[o],c=t.tokenize(l,!0,r);n[o]=c.tokens,r=c.endState}return n}function L3e(s,e){Ge.get(Va).defineTheme(s,e)}function k3e(s){Ge.get(Va).setTheme(s)}function E3e(){A4.clearAllFontInfos()}function D3e(s,e){return Or.registerCommand({id:s,handler:e})}function T3e(s){return Ge.get(GD).registerOpener({async open(t){return typeof t=="string"&&(t=mt.parse(t)),s.open(t)}})}function N3e(s){return Ge.get(In).registerCodeEditorOpenHandler(async(t,i,n)=>{var a;if(!i)return null;const r=(a=t.options)==null?void 0:a.selection;let o;return r&&typeof r.endLineNumber=="number"&&typeof r.endColumn=="number"?o=r:r&&(o={lineNumber:r.startLineNumber,column:r.startColumn}),await s.openCodeEditor(i,t.resource,o)?i:null})}function I3e(){return{create:ZOe,getEditors:t3e,getDiffEditors:i3e,onDidCreateEditor:JOe,onDidCreateDiffEditor:e3e,createDiffEditor:n3e,addCommand:r3e,addEditorAction:o3e,addKeybindingRule:a3e,addKeybindingRules:$ie,createModel:l3e,setModelLanguage:c3e,setModelMarkers:u3e,getModelMarkers:d3e,removeAllMarkers:h3e,onDidChangeMarkers:f3e,getModels:m3e,getModel:g3e,onDidCreateModel:p3e,onWillDisposeModel:_3e,onDidChangeModelLanguage:b3e,createWebWorker:w3e,colorizeElement:v3e,colorize:C3e,colorizeModelLine:y3e,tokenize:x3e,defineTheme:L3e,setTheme:k3e,remeasureFonts:E3e,registerCommand:D3e,registerLinkOpener:T3e,registerEditorOpener:N3e,AccessibilitySupport:vM,ContentWidgetPositionPreference:kM,CursorChangeReason:EM,DefaultEndOfLine:DM,EditorAutoIndentStrategy:NM,EditorOption:IM,EndOfLinePreference:RM,EndOfLineSequence:AM,MinimapPosition:$M,MinimapSectionHeaderStyle:qM,MouseTargetType:GM,OverlayWidgetPositionPreference:QM,OverviewRulerLane:XM,GlyphMarginLane:MM,RenderLineNumbersType:e4,RenderMinimap:t4,ScrollbarVisibility:n4,ScrollType:i4,TextEditorCursorBlinkingStyle:u4,TextEditorCursorStyle:h4,TrackedRangeStickiness:d4,WrappingIndent:f4,InjectedTextCursorStops:FM,PositionAffinity:JM,ShowLightbulbIconMode:r4,TextDirection:c4,ConfigurationChangedEvent:bX,BareFontInfo:tm,FontInfo:ZL,TextModelResolvedOptions:qx,FindMatch:Rv,ApplyUpdateResult:Y0,EditorZoom:Yh,createMultiFileDiffEditor:s3e,EditorType:ID,EditorOptions:mo}}function R3e(s,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!s(t))return!1;return!0}function Ox(s,e){return typeof s=="boolean"?s:e}function AG(s,e){return typeof s=="string"?s:e}function A3e(s){const e={};for(const t of s)e[t]=!0;return e}function MG(s,e=!1){e&&(s=s.map(function(i){return i.toLowerCase()}));const t=A3e(s);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function hP(s,e,t){e=e.replace(/@@/g,"");let i=0,n;do n=!1,e=e.replace(/@(\w+)/g,function(o,a){n=!0;let l="";if(typeof s[a]=="string")l=s[a];else if(s[a]&&s[a]instanceof RegExp)l=s[a].source;else throw s[a]===void 0?_i(s,"language definition does not contain attribute '"+a+"', used at: "+e):_i(s,"attribute reference '"+a+"' must be a string, used at: "+e);return Ff(l)?"":"(?:"+l+")"}),i++;while(n&&i<5);e=e.replace(/\x01/g,"@");const r=(s.ignoreCase?"i":"")+(s.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(tve(s,e,c),r)),l)}return new RegExp(e,r)}function M3e(s,e,t,i){if(i<0)return s;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function O3e(s,e,t,i){let n=-1,r=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(n=parseInt(o[3]),o[2]&&(n=n+100)),r=o[4]);let a="~",l=r;!r||r.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const h=MG(l.split("|"),s.ignoreCase);c=function(d){return a==="~"?h(d):!h(d)}}else if(a==="@"||a==="!@"){const h=s[l];if(!h)throw _i(s,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!R3e(function(g){return typeof g=="string"},h))throw _i(s,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const d=MG(h,s.ignoreCase);c=function(g){return a==="@"?d(g):!d(g)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const h=hP(s,"^"+l+"$",!1);c=function(d){return a==="~"?h.test(d):!h.test(d)}}else c=function(h,d,g,p){return hP(s,"^"+Qh(s,l,d,g,p)+"$",!1).test(h)};else if(l.indexOf("$")<0){const h=Gu(s,l);c=function(d){return a==="=="?d===h:d!==h}}else{const h=Gu(s,l);c=function(d,g,p,_,b){const C=Qh(s,h,g,p,_);return a==="=="?d===C:d!==C}}return n===-1?{name:t,value:i,test:function(h,d,g,p){return c(h,h,d,g,p)}}:{name:t,value:i,test:function(h,d,g,p){const _=M3e(h,d,g,n);return c(_||"",h,d,g,p)}}}function dP(s,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw _i(s,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw _i(s,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw _i(s,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!ive(s,Qh(s,n,"",[],""))))throw _i(s,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,s.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,r=t.length;n<r;n++)i[n]=dP(s,e,t[n]);return{group:i}}else if(t.cases){const i=[];let n=!1;for(const o in t.cases)if(t.cases.hasOwnProperty(o)){const a=dP(s,e,t.cases[o]);o==="@default"||o==="@"||o===""?i.push({test:void 0,value:a,name:o}):o==="@eos"?i.push({test:function(l,c,h,d){return d},value:a,name:o}):i.push(O3e(s,e,o,a)),n||(n=!ns(a)&&(a.hasEmbeddedEndInCases||["@pop","@popall"].includes(a.nextEmbedded||"")))}const r=s.defaultToken;return{hasEmbeddedEndInCases:n,test:function(o,a,l,c){for(const h of i)if(!h.test||h.test(o,a,l,c))return h.value;return r}}}else throw _i(s,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class P3e{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw _i(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=hP(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=dP(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function qie(s,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:s,includeLF:Ox(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:Ox(e.ignoreCase,!1),unicode:Ox(e.unicode,!1),tokenPostfix:AG(e.tokenPostfix,"."+s),defaultToken:AG(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=s,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(o,a,l){for(const c of l){let h=c.include;if(h){if(typeof h!="string")throw _i(t,"an 'include' attribute must be a string at: "+o);if(h[0]==="@"&&(h=h.substr(1)),!e.tokenizer[h])throw _i(t,"include target '"+h+"' is not defined at: "+o);n(o+"."+h,a,e.tokenizer[h])}else{const d=new P3e(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(d.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")d.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const g=c[1];g.next=c[2],d.setAction(i,g)}else throw _i(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else d.setAction(i,c[1]);else{if(!c.regex)throw _i(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(d.name=c.name),c.matchOnlyAtStart&&(d.matchOnlyAtLineStart=Ox(c.matchOnlyAtLineStart,!1)),d.setRegex(i,c.regex),d.setAction(i,c.action)}a.push(d)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw _i(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,n("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw _i(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(const o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw _i(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")r.push({token:a.token+t.tokenPostfix,open:Gu(t,a.open),close:Gu(t,a.close)});else throw _i(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=r,t.noThrow=!0,t}function F3e(s){S1.registerLanguage(s)}function B3e(){let s=[];return s=s.concat(S1.getLanguages()),s}function V3e(s){return Ge.get(Qn).languageIdCodec.encodeLanguageId(s)}function H3e(s,e){return Ge.withServices(()=>{const i=Ge.get(Qn).onDidRequestRichLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function W3e(s,e){return Ge.withServices(()=>{const i=Ge.get(Qn).onDidRequestBasicLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function z3e(s,e){if(!Ge.get(Qn).isRegisteredLanguageId(s))throw new Error(`Cannot set configuration for unknown language ${s}`);return Ge.get(kc).register(s,e,100)}class U3e{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return CC.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new aD(n.tokens,n.endState)}}class CC{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];let l=a.startIndex;r===0?l=0:l<n&&(l=n),i[r]=new yv(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const r=t.tokenize(i,n),o=CC._toClassicTokens(r.tokens,e);let a;return r.endState.equals(n)?a=n:a=r.endState,new V6(o,a)}tokenize(e,t,i){return CC.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,r=[];let o=0,a=0;for(let c=0,h=t.length;c<h;c++){const d=t[c],g=n.match(i,d.scopes)|1024;if(o>0&&r[o-1]===g)continue;let p=d.startIndex;c===0?p=0:p<a&&(p=a),r[o++]=p,r[o++]=g,a=p}const l=new Uint32Array(o);for(let c=0;c<o;c++)l[c]=r[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),r=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let o;return n.endState.equals(i)?o=i:o=n.endState,new aD(r,o)}}function j3e(s){return typeof s.getInitialState=="function"}function $3e(s){return"tokenizeEncoded"in s}function Gie(s){return s&&typeof s.then=="function"}function q3e(s){const e=Ge.get(Va);if(s){const t=[null];for(let i=1,n=s.length;i<n;i++)t[i]=me.fromHex(s[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function Kie(s,e){return $3e(e)?new U3e(s,e):new CC(s,e,Ge.get(Qn),Ge.get(Va))}function a9(s,e){const t=new e_e(async()=>{const i=await Promise.resolve(e.create());return i?j3e(i)?Kie(s,i):new Bv(Ge.get(Qn),Ge.get(Va),s,qie(s,i),Ge.get(yi)):null});return hn.registerFactory(s,t)}function G3e(s,e){if(!Ge.get(Qn).isRegisteredLanguageId(s))throw new Error(`Cannot set tokens provider for unknown language ${s}`);return Gie(e)?a9(s,{create:()=>e}):hn.register(s,Kie(s,e))}function K3e(s,e){const t=i=>new Bv(Ge.get(Qn),Ge.get(Va),s,qie(s,i),Ge.get(yi));return Gie(e)?a9(s,{create:()=>e}):hn.register(s,t(e))}function Y3e(s,e){return Ge.get(mi).referenceProvider.register(s,e)}function Q3e(s,e){return Ge.get(mi).renameProvider.register(s,e)}function X3e(s,e){return Ge.get(mi).newSymbolNamesProvider.register(s,e)}function Z3e(s,e){return Ge.get(mi).signatureHelpProvider.register(s,e)}function J3e(s,e){return Ge.get(mi).hoverProvider.register(s,{provideHover:async(i,n,r,o)=>{const a=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,r,o)).then(l=>{if(l)return!l.range&&a&&(l.range=new G(n.lineNumber,a.startColumn,n.lineNumber,a.endColumn)),l.range||(l.range=new G(n.lineNumber,n.column,n.lineNumber,n.column)),l})}})}function ePe(s,e){return Ge.get(mi).documentSymbolProvider.register(s,e)}function tPe(s,e){return Ge.get(mi).documentHighlightProvider.register(s,e)}function iPe(s,e){return Ge.get(mi).linkedEditingRangeProvider.register(s,e)}function nPe(s,e){return Ge.get(mi).definitionProvider.register(s,e)}function sPe(s,e){return Ge.get(mi).implementationProvider.register(s,e)}function rPe(s,e){return Ge.get(mi).typeDefinitionProvider.register(s,e)}function oPe(s,e){return Ge.get(mi).codeLensProvider.register(s,e)}function aPe(s,e,t){return Ge.get(mi).codeActionProvider.register(s,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(n,r,o,a)=>{const c=Ge.get(Pm).read({resource:n.uri}).filter(h=>G.areIntersectingOrTouching(h,r));return e.provideCodeActions(n,r,{markers:c,only:o.only,trigger:o.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function lPe(s,e){return Ge.get(mi).documentFormattingEditProvider.register(s,e)}function cPe(s,e){return Ge.get(mi).documentRangeFormattingEditProvider.register(s,e)}function uPe(s,e){return Ge.get(mi).onTypeFormattingEditProvider.register(s,e)}function hPe(s,e){return Ge.get(mi).linkProvider.register(s,e)}function dPe(s,e){return Ge.get(mi).completionProvider.register(s,e)}function fPe(s,e){return Ge.get(mi).colorProvider.register(s,e)}function gPe(s,e){return Ge.get(mi).foldingRangeProvider.register(s,e)}function mPe(s,e){return Ge.get(mi).declarationProvider.register(s,e)}function pPe(s,e){return Ge.get(mi).selectionRangeProvider.register(s,e)}function _Pe(s,e){return Ge.get(mi).documentSemanticTokensProvider.register(s,e)}function bPe(s,e){return Ge.get(mi).documentRangeSemanticTokensProvider.register(s,e)}function wPe(s,e){return Ge.get(mi).inlineCompletionsProvider.register(s,e)}function vPe(s,e){return Ge.get(mi).inlayHintsProvider.register(s,e)}function CPe(){return{register:F3e,getLanguages:B3e,onLanguage:H3e,onLanguageEncountered:W3e,getEncodedLanguageId:V3e,setLanguageConfiguration:z3e,setColorMap:q3e,registerTokensProviderFactory:a9,setTokensProvider:G3e,setMonarchTokensProvider:K3e,registerReferenceProvider:Y3e,registerRenameProvider:Q3e,registerNewSymbolNameProvider:X3e,registerCompletionItemProvider:dPe,registerSignatureHelpProvider:Z3e,registerHoverProvider:J3e,registerDocumentSymbolProvider:ePe,registerDocumentHighlightProvider:tPe,registerLinkedEditingRangeProvider:iPe,registerDefinitionProvider:nPe,registerImplementationProvider:sPe,registerTypeDefinitionProvider:rPe,registerCodeLensProvider:oPe,registerCodeActionProvider:aPe,registerDocumentFormattingEditProvider:lPe,registerDocumentRangeFormattingEditProvider:cPe,registerOnTypeFormattingEditProvider:uPe,registerLinkProvider:hPe,registerColorProvider:fPe,registerFoldingRangeProvider:gPe,registerDeclarationProvider:mPe,registerSelectionRangeProvider:pPe,registerDocumentSemanticTokensProvider:_Pe,registerDocumentRangeSemanticTokensProvider:bPe,registerInlineCompletionsProvider:wPe,registerInlayHintsProvider:vPe,DocumentHighlightKind:TM,CompletionItemKind:SM,CompletionItemTag:xM,CompletionItemInsertTextRule:yM,SymbolKind:a4,SymbolTag:l4,IndentAction:PM,CompletionTriggerKind:LM,SignatureHelpTriggerKind:o4,InlayHintKind:BM,InlineCompletionTriggerKind:WM,CodeActionTriggerType:CM,NewSymbolNameTag:KM,NewSymbolNameTriggerKind:YM,PartialAcceptTriggerKind:ZM,HoverVerbosityAction:OM,InlineCompletionEndOfLifeReasonKind:VM,InlineCompletionHintStyle:HM,FoldingRangeKind:wM,SelectedSuggestionInfo:Jpe,EditDeltaInfo:Xk}}const Yie=gt("IEditorCancelService"),Qie=new He("cancellableOperation",!1,v(939,"Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));yt(Yie,class{constructor(){this._tokens=new WeakMap}add(s,e){let t=this._tokens.get(s);t||(t=s.invokeWithinContext(n=>{const r=Qie.bindTo(n.get(Ot)),o=new Dr;return{key:r,tokens:o}}),this._tokens.set(s,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(s){const e=this._tokens.get(s);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);ot(new class extends lm{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:Qie})}runEditorCommand(s,e){s.get(Yie).cancel(e)}});class OG{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class yPe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(OG.toKey(e))}has(e){return this._set.has(OG.toKey(e))}}function SPe(s,e,t){const i=[],n=new yPe,r=s.ordered(t);for(const a of r)i.push(a),a.extensionId&&n.add(a.extensionId);const o=e.ordered(t);for(const a of o){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,h){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,h)}})}return i}const Kw=class Kw{static setFormatterSelector(e){return{dispose:Kw._selectors.unshift(e)}}static async select(e,t,i,n){if(e.length===0)return;const r=Dt.first(Kw._selectors);if(r)return await r(e,t,i,n)}};Kw._selectors=new Dr;let fP=Kw;async function xPe(s,e,t,i,n,r){const o=e.documentRangeFormattingEditProvider.ordered(t);for(const a of o){const l=await Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,n,r)).catch(k6);if(iD(l))return await s.computeMoreMinimalEdits(t.uri,l)}}async function LPe(s,e,t,i,n){const r=SPe(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const o of r){const a=await Promise.resolve(o.provideDocumentFormattingEdits(t,i,n)).catch(k6);if(iD(a))return await s.computeMoreMinimalEdits(t.uri,a)}}function kPe(s,e,t,i,n,r,o){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,n,r,o)).catch(k6).then(l=>s.computeMoreMinimalEdits(t.uri,l))}Or.registerCommand("_executeFormatRangeProvider",async function(s,...e){const[t,i,n]=e;_d(mt.isUri(t)),_d(G.isIRange(i));const r=s.get(pD),o=s.get(uy),a=s.get(mi),l=await r.createModelReference(t);try{return xPe(o,a,l.object.textEditorModel,G.lift(i),n,Io.None)}finally{l.dispose()}});Or.registerCommand("_executeFormatDocumentProvider",async function(s,...e){const[t,i]=e;_d(mt.isUri(t));const n=s.get(pD),r=s.get(uy),o=s.get(mi),a=await n.createModelReference(t);try{return LPe(r,o,a.object.textEditorModel,i,Io.None)}finally{a.dispose()}});Or.registerCommand("_executeFormatOnTypeProvider",async function(s,...e){const[t,i,n,r]=e;_d(mt.isUri(t)),_d(J.isIPosition(i)),_d(typeof n=="string");const o=s.get(pD),a=s.get(uy),l=s.get(mi),c=await o.createModelReference(t);try{return kPe(a,l,c.object.textEditorModel,J.lift(i),n,r,Io.None)}finally{c.dispose()}});mo.wrappingIndent.defaultValue=0;mo.glyphMargin.defaultValue=!1;mo.autoIndent.defaultValue=3;mo.overviewRulerLanes.defaultValue=2;fP.setFormatterSelector((s,e,t)=>Promise.resolve(s[0]));const wr=IX();wr.editor=I3e();wr.languages=CPe();const EPe=wr.CancellationTokenSource,DPe=wr.Emitter,TPe=wr.KeyCode,NPe=wr.KeyMod,IPe=wr.Position,Xie=wr.Range,W2=wr.Selection,Zie=wr.SelectionDirection,RPe=wr.MarkerSeverity,APe=wr.MarkerTag,MPe=wr.Uri,OPe=wr.Token,PPe=wr.editor,FPe=wr.languages,kA=K6(),i1=globalThis;(kA!=null&&kA.globalAPI||typeof i1.define=="function"&&i1.define.amd)&&(i1.monaco=wr);typeof i1.require<"u"&&typeof i1.require.config=="function"&&i1.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const BPe=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:EPe,Emitter:DPe,KeyCode:TPe,KeyMod:NPe,MarkerSeverity:RPe,MarkerTag:APe,Position:IPe,Range:Xie,Selection:W2,SelectionDirection:Zie,Token:OPe,Uri:MPe,editor:PPe,languages:FPe},Symbol.toStringTag,{value:"Module"}));function VPe(){return BPe}const EA=globalThis.MonacoEnvironment;EA!=null&&EA.globalAPI&&(globalThis.monaco=VPe());class HPe{constructor(e,t,i){this.start=e,this.end=t,this.direction=i}}const WPe=(s,e,t)=>{const i=s.getSelection();if(i!==null){const n=i.getStartPosition(),r=i.getEndPosition(),o=OL(t,e.getOffsetAt(n)),a=OL(t,e.getOffsetAt(r));return new HPe(o,a,i.getDirection())}return null},zPe=(s,e,t,i)=>{const n=PL(t.start,i),r=PL(t.end,i);if(n!==null&&r!==null&&n.type===e&&r.type===e){const o=s.getModel(),a=o.getPositionAt(n.index),l=o.getPositionAt(r.index);return W2.createWithDirection(a.lineNumber,a.column,l.lineNumber,l.column,t.direction)}return null};class UPe{constructor(e,t,i=new Set,n=null){this.doc=e.doc,this.ytext=e,this.monacoModel=t,this.editors=i,this.mux=jQ(),this._savedSelections=new Map,this._beforeTransaction=()=>{this.mux(()=>{this._savedSelections=new Map,i.forEach(r=>{if(r.getModel()===t){const o=WPe(r,t,e);o!==null&&this._savedSelections.set(r,o)}})})},this.doc.on("beforeAllTransactions",this._beforeTransaction),this._decorations=new Map,this._rerenderDecorations=()=>{i.forEach(r=>{if(n&&r.getModel()===t){const o=this._decorations.get(r)||[],a=[];n.getStates().forEach((l,c)=>{if(c!==this.doc.clientID&&l.selection!=null&&l.selection.anchor!=null&&l.selection.head!=null){const h=PL(l.selection.anchor,this.doc),d=PL(l.selection.head,this.doc);if(h!==null&&d!==null&&h.type===e&&d.type===e){let g,p,_,b;h.index<d.index?(g=t.getPositionAt(h.index),p=t.getPositionAt(d.index),_="yRemoteSelectionHead yRemoteSelectionHead-"+c,b=null):(g=t.getPositionAt(d.index),p=t.getPositionAt(h.index),_=null,b="yRemoteSelectionHead yRemoteSelectionHead-"+c),a.push({range:new Xie(g.lineNumber,g.column,p.lineNumber,p.column),options:{className:"yRemoteSelection yRemoteSelection-"+c,afterContentClassName:_,beforeContentClassName:b}})}}}),this._decorations.set(r,r.deltaDecorations(o,a))}else this._decorations.delete(r)})},this._ytextObserver=r=>{this.mux(()=>{let o=0;r.delta.forEach(a=>{if(a.retain!==void 0)o+=a.retain;else if(a.insert!==void 0){const l=t.getPositionAt(o),c=new W2(l.lineNumber,l.column,l.lineNumber,l.column),h=a.insert;t.applyEdits([{range:c,text:h}]),o+=h.length}else if(a.delete!==void 0){const l=t.getPositionAt(o),c=t.getPositionAt(o+a.delete),h=new W2(l.lineNumber,l.column,c.lineNumber,c.column);t.applyEdits([{range:h,text:""}])}else throw Ma()}),this._savedSelections.forEach((a,l)=>{const c=zPe(l,e,a,this.doc);c!==null&&l.setSelection(c)})}),this._rerenderDecorations()},e.observe(this._ytextObserver);{const r=e.toString();t.getValue()!==r&&t.setValue(r)}this._monacoChangeHandler=t.onDidChangeContent(r=>{this.mux(()=>{this.doc.transact(()=>{r.changes.sort((o,a)=>a.rangeOffset-o.rangeOffset).forEach(o=>{e.delete(o.rangeOffset,o.rangeLength),e.insert(o.rangeOffset,o.text)})},this)})}),this._monacoDisposeHandler=t.onWillDispose(()=>{this.destroy()}),n&&(i.forEach(r=>{r.onDidChangeCursorSelection(()=>{if(r.getModel()===t){const o=r.getSelection();if(o===null)return;let a=t.getOffsetAt(o.getStartPosition()),l=t.getOffsetAt(o.getEndPosition());if(o.getDirection()===Zie.RTL){const c=a;a=l,l=c}n.setLocalStateField("selection",{anchor:OL(e,a),head:OL(e,l)})}}),n.on("change",this._rerenderDecorations)}),this.awareness=n)}destroy(){this._monacoChangeHandler.dispose(),this._monacoDisposeHandler.dispose(),this.ytext.unobserve(this._ytextObserver),this.doc.off("beforeAllTransactions",this._beforeTransaction),this.awareness&&this.awareness.off("change",this._rerenderDecorations)}}const jPe=(s,e)=>{if(e)return"#9333ea";let t=0;for(let n=0;n<s.length;n++)t=s.charCodeAt(n)+((t<<5)-t);return`hsl(${t%360}, 70%, 50%)`},$Pe=({sessionCode:s,isTeacher:e,participantId:t,editorInstance:i,monacoInstance:n})=>{const r=Ne.useRef(null),o=Ne.useRef(null),a=Ne.useRef(null),[l,c]=Ne.useState(!1),[h,d]=Ne.useState(new Map),g=Ne.useCallback(_=>{if(r.current){const b=r.current.getText("monaco");r.current.transact(()=>{b.delete(0,b.length),b.insert(0,_)})}},[]),p=Ne.useCallback(()=>r.current?r.current.getText("monaco").toString():"",[]);return Ne.useEffect(()=>{if(!s||!i||!n)return;console.log("[Collab] Setting up collaborative editing for session:",s);const _=new j1;r.current=_;const b=new $ge(`python-tutoring-${s}`,_,{signaling:["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com"],password:s});o.current=b;const C=b.awareness,x=jPe(t,e);C.setLocalStateField("user",{name:e?" Teacher":" Student",color:x,isTeacher:e}),b.on("synced",({synced:D})=>{console.log("[Collab] Synced:",D),c(D)});const S=()=>{const D=C.getStates(),R=new Map;D.forEach((N,A)=>{N.user&&A!==C.clientID&&R.set(A,N.user)}),d(R)};C.on("change",S),S();const y=_.getText("monaco"),k=new UPe(y,i.getModel(),new Set([i]),C);return a.current=k,console.log("[Collab] Collaborative editing ready"),()=>{console.log("[Collab] Cleaning up collaborative editing"),k.destroy(),b.disconnect(),b.destroy(),_.destroy(),r.current=null,o.current=null,a.current=null,c(!1),d(new Map)}},[s,i,n,e,t]),{isConnected:l,collaborators:h,setText:g,getText:p}},qPe=({chapter:s,currentChallengeIndex:e,onNextChallenge:t,onPrevChallenge:i,onSelectChallenge:n,isLocked:r})=>{const o=s.challenges[e],{runCode:a,isRunning:l,clearOutput:c,output:h}=pP(),{isInSession:d,isTeacher:g,sessionCode:p,participantId:_,syncOutput:b}=RY(),[C,x]=Ne.useState((o==null?void 0:o.starterCode)||""),[S,y]=Ne.useState(!1),[k,D]=Ne.useState(!1),R=Ne.useRef(null),N=Ne.useRef(null),[A,M]=Ne.useState(!1),O=Ne.useRef(null),V=e===s.challenges.length-1,H=V&&s.challenges.length>5,{isConnected:U,collaborators:X,setText:Y}=$Pe({sessionCode:d?p:null,isTeacher:g,participantId:_,editorInstance:A?R.current:null,monacoInstance:A?N.current:null}),q=($,ce)=>{R.current=$,N.current=ce,M(!0),o!=null&&o.starterCode&&$.setValue(o.starterCode)};Ne.useEffect(()=>{if(o&&O.current!==o.id){O.current=o.id;const $=o.starterCode||"";x($),y(!1),D(!1),c(),d&&R.current?U?Y($):R.current.setValue($):R.current&&R.current.setValue($)}},[o==null?void 0:o.id,o==null?void 0:o.starterCode,c,d,U,Y]),Ne.useEffect(()=>{d&&!g&&h.length>0&&b(h)},[d,g,h,b]);const ee=Ne.useCallback(()=>{var ce;const $=((ce=R.current)==null?void 0:ce.getValue())||C;$.trim()&&a($,o.testCases)},[C,a,o]);Ne.useEffect(()=>{const $=ce=>{(ce.ctrlKey||ce.metaKey)&&ce.key==="Enter"&&(ce.preventDefault(),ee())};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[ee]);const ue=()=>{if(o){const $=o.starterCode||"";x($),c(),U?Y($):R.current&&R.current.setValue($)}},oe=Ne.useCallback($=>{x($||"")},[]),Ee=X.size;return K.jsxs("div",{className:"flex h-full w-full bg-[#1e1e1e] overflow-hidden",children:[K.jsxs("div",{className:"w-[380px] min-w-[320px] flex flex-col border-r border-[#3c3c3c] bg-[#252526] h-full",children:[K.jsxs("div",{className:"p-5 border-b border-[#3c3c3c] bg-gradient-to-r from-[#1e1e1e] to-[#252526]",children:[K.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[K.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:K.jsx("span",{className:"text-white font-bold text-sm",children:e+1})}),K.jsxs("div",{className:"flex-1 min-w-0",children:[K.jsx("h2",{className:"text-base font-semibold text-white truncate",children:s.title}),K.jsx("p",{className:"text-xs text-slate-400",children:s.description})]})]}),K.jsxs("div",{className:"mt-3",children:[K.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1.5",children:[K.jsx("span",{children:"Progress"}),K.jsxs("span",{className:"text-blue-400",children:[e+1," / ",s.challenges.length]})]}),K.jsx("div",{className:"h-1.5 bg-[#3c3c3c] rounded-full overflow-hidden",children:K.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full transition-all duration-500 ease-out",style:{width:`${(e+1)/s.challenges.length*100}%`}})})]})]}),K.jsxs("div",{className:"flex-1 overflow-y-auto",children:[K.jsxs("div",{className:"p-5",children:[H&&K.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-500/30 rounded-lg",children:[K.jsxs("div",{className:"flex items-center gap-2 text-amber-400 font-semibold text-sm",children:[K.jsx("span",{children:""}),K.jsx("span",{children:"FINAL ASSESSMENT"})]}),K.jsx("p",{className:"text-xs text-amber-200/70 mt-1",children:"Complete this challenge to master the chapter!"})]}),K.jsx("h3",{className:"text-lg font-bold text-white mb-3 leading-tight",children:(o==null?void 0:o.title)||`Challenge ${o==null?void 0:o.number}`}),K.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:K.jsx("p",{className:"text-slate-300 leading-relaxed text-sm",children:o==null?void 0:o.description})}),(o==null?void 0:o.hint)&&K.jsxs("div",{className:"mt-5",children:[K.jsxs("button",{onClick:()=>y(!S),className:"flex items-center gap-2 text-amber-400 hover:text-amber-300 text-sm font-medium transition-colors",children:[K.jsx("span",{className:"text-lg",children:S?"":""}),K.jsx("span",{children:S?"Hide Hint":"Need a hint?"})]}),S&&K.jsx("div",{className:"mt-3 p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg animate-fade-in",children:K.jsx("p",{className:"text-amber-200/90 text-sm leading-relaxed",children:o.hint})})]}),(o==null?void 0:o.solutionCode)&&K.jsxs("div",{className:"mt-4",children:[K.jsxs("button",{onClick:()=>D(!k),className:"flex items-center gap-2 text-purple-400 hover:text-purple-300 text-sm font-medium transition-colors",children:[K.jsx("span",{className:"text-lg",children:k?"":""}),K.jsx("span",{children:k?"Hide Solution":"Reveal Solution"})]}),k&&K.jsx("div",{className:"mt-3 p-4 bg-purple-500/10 border border-purple-500/20 rounded-lg animate-fade-in",children:K.jsx("pre",{className:"text-purple-200/90 text-xs font-mono overflow-x-auto whitespace-pre-wrap",children:o.solutionCode})})]})]}),K.jsx("div",{className:"px-5 pb-5",children:K.jsxs("div",{className:"p-4 bg-[#1e1e1e] rounded-lg border border-[#3c3c3c]",children:[K.jsx("h4",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"Quick Tips"}),K.jsxs("ul",{className:"space-y-2 text-xs text-slate-400",children:[K.jsxs("li",{className:"flex items-start gap-2",children:[K.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),K.jsxs("span",{children:["Press ",K.jsx("kbd",{className:"px-1.5 py-0.5 bg-[#3c3c3c] rounded text-white",children:"Ctrl"})," + ",K.jsx("kbd",{className:"px-1.5 py-0.5 bg-[#3c3c3c] rounded text-white",children:"Enter"})," to run"]})]}),K.jsxs("li",{className:"flex items-start gap-2",children:[K.jsx("span",{className:"text-blue-400 mt-0.5",children:""}),K.jsx("span",{children:"Your code auto-saves in the editor"})]}),K.jsxs("li",{className:"flex items-start gap-2",children:[K.jsx("span",{className:"text-amber-400 mt-0.5",children:""}),K.jsxs("span",{children:["Test with ",K.jsx("code",{className:"text-amber-200",children:"print()"})," statements"]})]})]})]})})]}),K.jsx("div",{className:"p-4 border-t border-[#3c3c3c] bg-[#1e1e1e]",children:K.jsxs("div",{className:"flex items-center justify-between gap-3",children:[K.jsx("button",{onClick:i,disabled:e===0,className:"px-4 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-[#3c3c3c] rounded-lg transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:" Previous"}),K.jsx("div",{className:"flex items-center gap-1.5 overflow-x-auto max-w-[140px] py-1",children:s.challenges.map(($,ce)=>K.jsx("button",{onClick:()=>n(ce),className:`w-2.5 h-2.5 rounded-full transition-all flex-shrink-0 ${ce===e?"bg-blue-500 scale-125":ce<e?"bg-emerald-500/60 hover:bg-emerald-400":"bg-[#3c3c3c] hover:bg-slate-500"}`,title:`Challenge ${ce+1}`},ce))}),K.jsx("button",{onClick:t,disabled:V,className:`px-4 py-2 text-sm font-medium rounded-lg transition-all ${V?"bg-emerald-600 text-white cursor-default":"text-slate-400 hover:text-white hover:bg-[#3c3c3c]"}`,children:V?" Complete":"Next "})]})})]}),K.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#1e1e1e]",children:[K.jsxs("div",{className:"h-12 bg-[#252526] border-b border-[#3c3c3c] flex items-center justify-between px-4",children:[K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#1e1e1e] rounded-md border border-[#3c3c3c]",children:[K.jsx("span",{className:"text-yellow-500 text-sm",children:""}),K.jsx("span",{className:"text-xs text-slate-300 font-mono",children:"main.py"})]}),K.jsx("button",{onClick:ue,className:"text-xs text-slate-500 hover:text-slate-300 transition-colors",title:"Reset to starter code",children:" Reset"})]}),K.jsxs("div",{className:"flex items-center gap-3",children:[d&&K.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-md border ${U?"bg-emerald-600/20 border-emerald-500/30":"bg-yellow-600/20 border-yellow-500/30"}`,children:[K.jsx("span",{className:`w-2 h-2 rounded-full ${U?"bg-emerald-400 animate-pulse":"bg-yellow-400"}`}),K.jsx("span",{className:`text-xs font-medium ${U?"text-emerald-400":"text-yellow-400"}`,children:U?` Live Collab ${Ee>0?`(${Ee+1})`:""}`:" Connecting..."})]}),K.jsx("span",{className:"text-xs text-slate-500",children:l?"Executing...":d?"Collaborative":"Ready"}),K.jsx("button",{onClick:ee,disabled:l,className:`flex items-center gap-2 px-5 py-2 rounded-lg text-sm font-bold transition-all shadow-lg ${l?"bg-slate-600 cursor-wait text-slate-300":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-400 hover:to-emerald-500 text-white"}`,children:l?K.jsxs(K.Fragment,{children:[K.jsx("span",{className:"animate-spin",children:""}),"Running..."]}):K.jsxs(K.Fragment,{children:[K.jsx("span",{children:""}),"Run Code"]})})]})]}),K.jsx("div",{className:"flex-1 relative min-h-0",children:K.jsx(Ioe,{height:"100%",defaultLanguage:"python",defaultValue:(o==null?void 0:o.starterCode)||"",onChange:oe,onMount:q,theme:"vs-dark",options:{minimap:{enabled:!1},fontSize:15,fontFamily:"'JetBrains Mono', 'Fira Code', Consolas, monospace",lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:4,padding:{top:16,bottom:16},cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",smoothScrolling:!0,renderLineHighlight:"all",bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0},readOnly:!1}})}),K.jsx("div",{className:"h-[35%] min-h-[180px] border-t border-[#3c3c3c]",children:K.jsx(Aoe,{})})]}),K.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; transform: translateY(-4px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
          animation: fade-in 0.2s ease-out;
        }
      `})]})},GPe=({chapters:s,unlockedMap:e,onUnlock:t,onLock:i,onClose:n})=>{const r=(a,l)=>{l?i(a):t(a)},o=Object.values(e).filter(Boolean).length;return K.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[100]",children:K.jsxs("div",{className:"bg-[#1e1e1e] border border-[#3c3c3c] rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] flex flex-col",children:[K.jsxs("div",{className:"px-6 py-4 border-b border-[#3c3c3c] flex items-center justify-between bg-gradient-to-r from-indigo-600/20 to-purple-600/20",children:[K.jsxs("div",{children:[K.jsx("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:" Teacher Control Panel"}),K.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[o," of ",s.length," chapters unlocked"]})]}),K.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-lg",children:K.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),K.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:K.jsx("div",{className:"space-y-2",children:s.map((a,l)=>{const c=e[a.id]||!1;return K.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border transition-all ${c?"bg-emerald-900/20 border-emerald-700/50":"bg-[#2d2d2d] border-[#3c3c3c]"}`,children:[K.jsxs("div",{className:"flex items-center gap-4",children:[K.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${c?"bg-emerald-600 text-white":"bg-[#3c3c3c] text-gray-400"}`,children:l+1}),K.jsxs("div",{children:[K.jsx("h3",{className:"font-semibold text-white",children:a.title}),K.jsx("p",{className:"text-sm text-gray-400",children:a.description}),K.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.challenges.length," challenges"]})]})]}),K.jsx("button",{onClick:()=>r(a.id,c),className:`px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ${c?"bg-red-600/20 text-red-400 hover:bg-red-600/30 border border-red-600/50":"bg-emerald-600 text-white hover:bg-emerald-500"}`,children:c?K.jsxs(K.Fragment,{children:[K.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Lock"]}):K.jsxs(K.Fragment,{children:[K.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})}),"Unlock"]})})]},a.id)})})}),K.jsx("div",{className:"px-6 py-4 border-t border-[#3c3c3c] bg-[#252526]",children:K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsxs("p",{className:"text-sm text-gray-400",children:[" Tip: Press ",K.jsx("kbd",{className:"px-2 py-1 bg-[#3c3c3c] rounded text-xs",children:"Ctrl+Shift+T"})," to toggle teacher mode"]}),K.jsx("button",{onClick:n,className:"px-4 py-2 bg-[#3c3c3c] text-white rounded-lg hover:bg-[#4c4c4c] transition-colors",children:"Done"})]})})]})})},KPe=({onSoloMode:s,onJoinSession:e,onCreateSession:t,isTeacherMode:i})=>{const[n,r]=Ne.useState("choose"),[o,a]=Ne.useState(""),[l,c]=Ne.useState(""),[h,d]=Ne.useState(""),[g,p]=Ne.useState(!1),_=async()=>{if(o.length!==6){d("Please enter a 6-character code");return}p(!0),d(""),await e(o.toUpperCase())||d("Session not found. Please check the code."),p(!1)},b=async()=>{p(!0),d("");try{const x=await t();c(x),r("create")}catch{d("Failed to create session")}p(!1)},C=()=>{navigator.clipboard.writeText(l)};return K.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-[#0a0a0f] via-[#1a1a2e] to-[#0a0a0f] flex items-center justify-center z-50",children:K.jsxs("div",{className:"bg-[#1e1e1e] border border-[#3c3c3c] rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[K.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-600/20 to-purple-600/20 border-b border-[#3c3c3c]",children:K.jsxs("div",{className:"flex items-center gap-3",children:[K.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:K.jsx("span",{className:"text-2xl",children:""})}),K.jsxs("div",{children:[K.jsx("h1",{className:"text-xl font-bold text-white",children:"Python Tutoring"}),K.jsx("p",{className:"text-sm text-slate-400",children:"Choose how you'd like to learn"})]})]})}),K.jsxs("div",{className:"p-6",children:[n==="choose"&&K.jsxs("div",{className:"space-y-4",children:[K.jsx("button",{onClick:s,className:"w-full p-5 bg-[#252526] hover:bg-[#2d2d2d] border border-[#3c3c3c] rounded-xl text-left transition-all group",children:K.jsxs("div",{className:"flex items-center gap-4",children:[K.jsx("div",{className:"w-12 h-12 bg-emerald-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:K.jsx("span",{className:"text-2xl",children:""})}),K.jsxs("div",{children:[K.jsx("h3",{className:"text-lg font-semibold text-white",children:"Practice on Your Own"}),K.jsx("p",{className:"text-sm text-slate-400",children:"Learn at your own pace, offline"})]})]})}),K.jsx("button",{onClick:()=>r("join"),className:"w-full p-5 bg-[#252526] hover:bg-[#2d2d2d] border border-[#3c3c3c] rounded-xl text-left transition-all group",children:K.jsxs("div",{className:"flex items-center gap-4",children:[K.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:K.jsx("span",{className:"text-2xl",children:""})}),K.jsxs("div",{children:[K.jsx("h3",{className:"text-lg font-semibold text-white",children:"Join a Session"}),K.jsx("p",{className:"text-sm text-slate-400",children:"Enter a code from your teacher"})]})]})}),i&&K.jsx("button",{onClick:b,disabled:g,className:"w-full p-5 bg-gradient-to-r from-indigo-600/20 to-purple-600/20 hover:from-indigo-600/30 hover:to-purple-600/30 border border-indigo-500/30 rounded-xl text-left transition-all group",children:K.jsxs("div",{className:"flex items-center gap-4",children:[K.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:K.jsx("span",{className:"text-2xl",children:""})}),K.jsxs("div",{children:[K.jsx("h3",{className:"text-lg font-semibold text-white",children:g?"Creating...":"Start a Teaching Session"}),K.jsx("p",{className:"text-sm text-slate-400",children:"Generate a code for students to join"})]})]})})]}),n==="join"&&K.jsxs("div",{className:"space-y-4",children:[K.jsx("button",{onClick:()=>{r("choose"),d("")},className:"text-slate-400 hover:text-white text-sm flex items-center gap-1 transition-colors",children:" Back"}),K.jsxs("div",{children:[K.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Enter Session Code"}),K.jsx("input",{type:"text",value:o,onChange:x=>a(x.target.value.toUpperCase().slice(0,6)),placeholder:"ABC123",className:"w-full px-4 py-4 bg-[#252526] border border-[#3c3c3c] rounded-xl text-white text-2xl font-mono tracking-[0.5em] text-center focus:outline-none focus:border-blue-500 transition-colors uppercase",autoFocus:!0})]}),h&&K.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 text-sm",children:h}),K.jsx("button",{onClick:_,disabled:g||o.length!==6,className:"w-full py-4 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-400 hover:to-blue-500 text-white font-semibold rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Joining...":"Join Session"})]}),n==="create"&&K.jsxs("div",{className:"space-y-4 text-center",children:[K.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto",children:K.jsx("span",{className:"text-3xl",children:""})}),K.jsx("h3",{className:"text-lg font-semibold text-white",children:"Session Created!"}),K.jsx("p",{className:"text-sm text-slate-400",children:"Share this code with your student:"}),K.jsxs("div",{className:"relative",children:[K.jsx("div",{className:"px-6 py-5 bg-[#252526] border border-[#3c3c3c] rounded-xl text-3xl font-mono tracking-[0.5em] text-emerald-400 text-center",children:l}),K.jsx("button",{onClick:C,className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 hover:bg-[#3c3c3c] rounded-lg transition-colors",title:"Copy to clipboard",children:K.jsx("span",{className:"text-lg",children:""})})]}),K.jsx("button",{onClick:s,className:"w-full py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-400 hover:to-emerald-500 text-white font-semibold rounded-xl transition-all",children:"Continue to Dashboard"})]})]}),K.jsx("div",{className:"px-6 py-4 bg-[#252526] border-t border-[#3c3c3c]",children:K.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Mr Stewart Python Tutoring"})})]})})},YPe=({sessionCode:s,isTeacher:e,participantCount:t,onLeave:i})=>{const n=()=>{navigator.clipboard.writeText(s)};return K.jsxs("div",{className:"h-8 bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-between px-4 text-white text-sm z-50 shadow-lg",children:[K.jsx("div",{className:"flex items-center gap-4",children:e?K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx("span",{className:"opacity-80",children:""}),K.jsx("span",{className:"font-medium",children:"Session:"}),K.jsx("button",{onClick:n,className:"px-2 py-0.5 bg-white/20 hover:bg-white/30 rounded font-mono tracking-wider transition-colors",title:"Click to copy",children:s})]}),K.jsx("div",{className:"h-4 w-px bg-white/30"}),K.jsxs("span",{className:"opacity-80",children:[t-1," student",t-1!==1?"s":""," connected"]})]}):K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),K.jsx("span",{children:"Connected to session"})]}),K.jsx("div",{className:"h-4 w-px bg-white/30"}),K.jsxs("span",{className:"opacity-80",children:["Code: ",s]})]})}),K.jsx("button",{onClick:i,className:"px-3 py-1 text-xs bg-white/10 hover:bg-white/20 rounded transition-colors",children:"Leave Session"})]})},qp=[{id:"first_functions",title:"Your First Functions",description:"Function Syntax, Parameters & Returns",explanation:`
      <p class="mb-4">Functions are reusable blocks of code. Every program you write should be organized into functions - this makes code easier to test, debug, and understand.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Defining Functions</h4>
      <p class="mb-2">Use <code>def</code> followed by the function name and parentheses. Parameters go inside the parentheses.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Type Hints</h4>
      <p class="mb-2">Type hints document what types your function expects: <code>def greet(name: str) -> str:</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Return vs Print</h4>
      <p class="mb-2"><code>return</code> sends a value back to the caller. <code>print</code> displays output but returns <code>None</code>.</p>
    `,exampleCode:`def add(a: int, b: int) -> int:
    """Add two numbers and return the result."""
    return a + b

def greet(name: str) -> str:
    """Return a greeting message."""
    return f"Hello, {name}!"

# Calling functions
result = add(5, 3)      # result = 8
message = greet("Alex") # message = "Hello, Alex!"`,challenges:[{id:"001",number:1,title:"Health Calculator",description:"Create a function `calculate_health` that takes `current_health` and `damage`. Return the remaining health.",hint:"Subtract damage from current_health.",starterCode:`def calculate_health(current_health: int, damage: int) -> int:
    # Your code here
    pass`,solutionCode:`def calculate_health(current_health: int, damage: int) -> int:
    """Calculate remaining health."""
    return current_health - damage`,testCases:[{input:"calculate_health(100, 25)",expected:"75"},{input:"calculate_health(50, 50)",expected:"0"},{input:"calculate_health(100, 0)",expected:"100"},{input:"calculate_health(75, 30)",expected:"45"},{input:"calculate_health(200, 150)",expected:"50"}]},{id:"002",number:2,title:"Double XP",description:"Create a function `double_xp` that takes `base_xp` and returns it multiplied by 2.",hint:"Return base_xp * 2.",starterCode:`def double_xp(base_xp: int) -> int:
    # Your code here
    pass`,solutionCode:`def double_xp(base_xp: int) -> int:
    """Double the XP."""
    return base_xp * 2`,testCases:[{input:"double_xp(50)",expected:"100"},{input:"double_xp(0)",expected:"0"},{input:"double_xp(125)",expected:"250"},{input:"double_xp(1)",expected:"2"},{input:"double_xp(999)",expected:"1998"}]},{id:"003",number:3,title:"Welcome Message",description:'Create a function `welcome_user` that takes a `username` (string) and returns the message "Welcome back, {username}!".',hint:'Use an f-string: f"Welcome back, {username}!"',starterCode:`def welcome_user(username: str) -> str:
    # Your code here
    pass`,solutionCode:`def welcome_user(username: str) -> str:
    """Return a welcome message."""
    return f"Welcome back, {username}!"`,testCases:[{input:"welcome_user('Sarah')",expected:"'Welcome back, Sarah!'"},{input:"welcome_user('Player1')",expected:"'Welcome back, Player1!'"},{input:"welcome_user('Dr. Python')",expected:"'Welcome back, Dr. Python!'"},{input:"welcome_user('Ada')",expected:"'Welcome back, Ada!'"},{input:"welcome_user('NeuralNinja')",expected:"'Welcome back, NeuralNinja!'"}]},{id:"004",number:4,title:"Total Score",description:"Create a function `total_trials` that takes three scores (`trial1`, `trial2`, `trial3`) and returns their sum.",hint:"Add all three numbers: trial1 + trial2 + trial3",starterCode:`def total_trials(trial1: int, trial2: int, trial3: int) -> int:
    # Your code here
    pass`,solutionCode:`def total_trials(trial1: int, trial2: int, trial3: int) -> int:
    """Sum three numbers."""
    return trial1 + trial2 + trial3`,testCases:[{input:"total_trials(85, 90, 88)",expected:"263"},{input:"total_trials(100, 100, 100)",expected:"300"},{input:"total_trials(0, 0, 0)",expected:"0"},{input:"total_trials(50, 75, 25)",expected:"150"},{input:"total_trials(33, 33, 34)",expected:"100"}]},{id:"005",number:5,title:"Format Name",description:'Create a function `format_author` that takes `first_name` and `last_name` and returns them as "Last, First".',hint:'Use an f-string: f"{last_name}, {first_name}"',starterCode:`def format_author(first_name: str, last_name: str) -> str:
    # Your code here
    pass`,solutionCode:`def format_author(first_name: str, last_name: str) -> str:
    """Format name as Last, First."""
    return f"{last_name}, {first_name}"`,testCases:[{input:"format_author('Ada', 'Lovelace')",expected:"'Lovelace, Ada'"},{input:"format_author('Alan', 'Turing')",expected:"'Turing, Alan'"},{input:"format_author('Marie', 'Curie')",expected:"'Curie, Marie'"},{input:"format_author('Santiago', 'Cajal')",expected:"'Cajal, Santiago'"},{input:"format_author('Rosalind', 'Franklin')",expected:"'Franklin, Rosalind'"}]},{id:"006",number:6,title:"Total Pixels",description:"Create a function `total_pixels` that takes `width` and `height` and returns the total number of pixels (width multiplied by height).",hint:"Multiply width * height.",starterCode:`def total_pixels(width: int, height: int) -> int:
    # Your code here
    pass`,solutionCode:`def total_pixels(width: int, height: int) -> int:
    """Calculate width * height."""
    return width * height`,testCases:[{input:"total_pixels(1920, 1080)",expected:"2073600"},{input:"total_pixels(100, 100)",expected:"10000"},{input:"total_pixels(640, 480)",expected:"307200"},{input:"total_pixels(1, 1)",expected:"1"},{input:"total_pixels(3840, 2160)",expected:"8294400"}]},{id:"007",number:7,title:"Average Duration",description:"Create a function `average_duration` that takes `song1` and `song2` (seconds) and returns the average duration as a float.",hint:"Add song1 + song2, then divide by 2.",starterCode:`def average_duration(song1: int, song2: int) -> float:
    # Your code here
    pass`,solutionCode:`def average_duration(song1: int, song2: int) -> float:
    """Calculate average of two numbers."""
    return (song1 + song2) / 2`,testCases:[{input:"average_duration(180, 240)",expected:"210.0"},{input:"average_duration(200, 200)",expected:"200.0"},{input:"average_duration(300, 100)",expected:"200.0"},{input:"average_duration(0, 120)",expected:"60.0"},{input:"average_duration(185, 215)",expected:"200.0"}]},{id:"008",number:8,title:"Cube Number",description:"Create a function `cube` that takes a number `n` and returns `n` cubed (n to the power of 3).",hint:"Use n ** 3 or n * n * n.",starterCode:`def cube(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def cube(n: int) -> int:
    """Calculate n cubed."""
    return n ** 3`,testCases:[{input:"cube(4)",expected:"64"},{input:"cube(2)",expected:"8"},{input:"cube(10)",expected:"1000"},{input:"cube(1)",expected:"1"},{input:"cube(5)",expected:"125"}]},{id:"009",number:9,title:"Log Entry",description:'Create a function `log_entry` that takes a `name` and a `day` number. Return a message: "Day {day}: Logged by {name}".',hint:'Use an f-string: f"Day {day}: Logged by {name}".',starterCode:`def log_entry(name: str, day: int) -> str:
    # Your code here
    pass`,solutionCode:`def log_entry(name: str, day: int) -> str:
    """Format a log entry."""
    return f"Day {day}: Logged by {name}"`,testCases:[{input:"log_entry('Chen', 5)",expected:"'Day 5: Logged by Chen'"},{input:"log_entry('Sarah', 1)",expected:"'Day 1: Logged by Sarah'"},{input:"log_entry('Team', 100)",expected:"'Day 100: Logged by Team'"},{input:"log_entry('AI', 42)",expected:"'Day 42: Logged by AI'"},{input:"log_entry('Prof', 365)",expected:"'Day 365: Logged by Prof'"}]},{id:"010",number:10,title:"Calculate Percentage",description:"Create a function `accuracy_rate` that takes `correct` and `total` samples. Return the percentage (correct / total * 100).",hint:"(correct / total) * 100.",starterCode:`def accuracy_rate(correct: int, total: int) -> float:
    # Your code here
    pass`,solutionCode:`def accuracy_rate(correct: int, total: int) -> float:
    """Calculate percentage."""
    return (correct / total) * 100`,testCases:[{input:"accuracy_rate(45, 50)",expected:"90.0"},{input:"accuracy_rate(100, 100)",expected:"100.0"},{input:"accuracy_rate(75, 100)",expected:"75.0"},{input:"accuracy_rate(1, 4)",expected:"25.0"},{input:"accuracy_rate(88, 100)",expected:"88.0"}]},{id:"011-assessment",number:11,title:"Unit Conversion Report",description:"Create a function `convert_and_report` that takes `km` (distance) and `celsius` (temperature). Convert them to miles (km * 0.621) and Fahrenheit ((c * 9/5) + 32). Return a string: 'Distance: X miles | Temp: Y F'. Round values to 1 decimal place.",hint:"Perform conversions. Use `round()`. Return combined string.",starterCode:`def convert_and_report(km: float, celsius: float) -> str:
    # Your code here
    pass`,solutionCode:`def convert_and_report(km: float, celsius: float) -> str:
    """Convert units and return report."""
    miles = round(km * 0.621, 1)
    fahrenheit = round((celsius * 9/5) + 32, 1)
    return f"Distance: {miles} miles | Temp: {fahrenheit} F"`,testCases:[{input:"convert_and_report(100, 0)",expected:"'Distance: 62.1 miles | Temp: 32.0 F'"},{input:"convert_and_report(10, 100)",expected:"'Distance: 6.2 miles | Temp: 212.0 F'"},{input:"convert_and_report(5, 20)",expected:"'Distance: 3.1 miles | Temp: 68.0 F'"},{input:"convert_and_report(0, -40)",expected:"'Distance: 0.0 miles | Temp: -40.0 F'"},{input:"convert_and_report(42.195, 25)",expected:"'Distance: 26.2 miles | Temp: 77.0 F'"}]}]},{id:"working_with_numbers",title:"Working with Numbers",description:"Arithmetic, Math Operations & Rounding",explanation:`
      <p class="mb-4">Python handles both integers (whole numbers) and floats (decimals). Understanding arithmetic operations is fundamental.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Basic Operators</h4>
      <p class="mb-2"><code>+</code> add, <code>-</code> subtract, <code>*</code> multiply, <code>/</code> divide, <code>**</code> power</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Integer Division & Modulo</h4>
      <p class="mb-2"><code>//</code> divides and rounds down to nearest integer. <code>%</code> gives the remainder.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Rounding</h4>
      <p class="mb-2"><code>round(number, decimals)</code> rounds to specified decimal places.</p>
    `,exampleCode:`def calculate_tip(bill: float, tip_percent: int) -> float:
    """Calculate tip amount for a restaurant bill."""
    tip = bill * (tip_percent / 100)
    return round(tip, 2)

def get_remainder(dividend: int, divisor: int) -> int:
    """Return the remainder when dividing two numbers."""
    return dividend % divisor

print(calculate_tip(85.50, 20))  # 17.1
print(get_remainder(17, 5))      # 2`,challenges:[{id:"011",number:1,title:"Temp Converter",description:"Create a function `celsius_to_fahrenheit` that converts Celsius to Fahrenheit using the formula: (celsius * 9/5) + 32.",hint:"Multiply by 9, divide by 5, then add 32.",starterCode:`def celsius_to_fahrenheit(celsius: float) -> float:
    # Your code here
    pass`,solutionCode:`def celsius_to_fahrenheit(celsius: float) -> float:
    """Convert Celsius to Fahrenheit."""
    return (celsius * 9/5) + 32`,testCases:[{input:"celsius_to_fahrenheit(0)",expected:"32.0"},{input:"celsius_to_fahrenheit(100)",expected:"212.0"},{input:"celsius_to_fahrenheit(-40)",expected:"-40.0"},{input:"celsius_to_fahrenheit(37)",expected:"98.6"},{input:"celsius_to_fahrenheit(25)",expected:"77.0"}]},{id:"012",number:2,title:"Reverse Converter",description:"Create a function `fahrenheit_to_celsius` that converts Fahrenheit to Celsius using formula: (fahrenheit - 32) * 5/9.",hint:"Subtract 32 first, then multiply by 5/9.",starterCode:`def fahrenheit_to_celsius(fahrenheit: float) -> float:
    # Your code here
    pass`,solutionCode:`def fahrenheit_to_celsius(fahrenheit: float) -> float:
    """Convert Fahrenheit to Celsius."""
    return (fahrenheit - 32) * 5/9`,testCases:[{input:"fahrenheit_to_celsius(32)",expected:"0.0"},{input:"fahrenheit_to_celsius(212)",expected:"100.0"},{input:"fahrenheit_to_celsius(-40)",expected:"-40.0"},{input:"fahrenheit_to_celsius(98.6)",expected:"37.0"},{input:"fahrenheit_to_celsius(68)",expected:"20.0"}]},{id:"013",number:3,title:"Split Bill",description:"Create a function `split_bill` that takes `total` and `num_people`. Return each person's share rounded to 2 decimal places.",hint:"Divide total by num_people. Use round(result, 2).",starterCode:`def split_bill(total: float, num_people: int) -> float:
    # Your code here
    pass`,solutionCode:`def split_bill(total: float, num_people: int) -> float:
    """Split a bill evenly among people."""
    return round(total / num_people, 2)`,testCases:[{input:"split_bill(100, 2)",expected:"50.0"},{input:"split_bill(47.50, 4)",expected:"11.88"},{input:"split_bill(10, 3)",expected:"3.33"},{input:"split_bill(123.45, 5)",expected:"24.69"},{input:"split_bill(75, 6)",expected:"12.5"}]},{id:"014",number:4,title:"Tip Calculator",description:"Create a function `calculate_tip` that takes `bill` and `tip_percent`. Return the tip amount rounded to 2 decimal places.",hint:"Tip = bill * (percent / 100). Round result to 2 decimals.",starterCode:`def calculate_tip(bill: float, tip_percent: int) -> float:
    # Your code here
    pass`,solutionCode:`def calculate_tip(bill: float, tip_percent: int) -> float:
    """Calculate tip amount from bill and percentage."""
    return round(bill * (tip_percent / 100), 2)`,testCases:[{input:"calculate_tip(100, 20)",expected:"20.0"},{input:"calculate_tip(85.50, 20)",expected:"17.1"},{input:"calculate_tip(50, 15)",expected:"7.5"},{input:"calculate_tip(42.50, 18)",expected:"7.65"},{input:"calculate_tip(100, 0)",expected:"0.0"}]},{id:"015",number:5,title:"Unit Converter",description:"Create a function `grams_to_ounces` that converts grams to ounces (1 gram = 0.03527 oz). Round to 2 decimal places.",hint:"Multiply grams by 0.03527. Round to 2 decimals.",starterCode:`def grams_to_ounces(grams: float) -> float:
    # Your code here
    pass`,solutionCode:`def grams_to_ounces(grams: float) -> float:
    """Convert grams to ounces."""
    return round(grams * 0.03527, 2)`,testCases:[{input:"grams_to_ounces(25)",expected:"0.88"},{input:"grams_to_ounces(100)",expected:"3.53"},{input:"grams_to_ounces(0)",expected:"0.0"},{input:"grams_to_ounces(500)",expected:"17.64"},{input:"grams_to_ounces(28.35)",expected:"1.0"}]},{id:"016",number:6,title:"Time Converter",description:"Create a function `minutes_to_seconds` that takes `minutes` and returns the number of seconds.",hint:"Multiply minutes by 60.",starterCode:`def minutes_to_seconds(minutes: int) -> int:
    # Your code here
    pass`,solutionCode:`def minutes_to_seconds(minutes: int) -> int:
    """Convert minutes to seconds."""
    return minutes * 60`,testCases:[{input:"minutes_to_seconds(1)",expected:"60"},{input:"minutes_to_seconds(90)",expected:"5400"},{input:"minutes_to_seconds(0)",expected:"0"},{input:"minutes_to_seconds(45)",expected:"2700"},{input:"minutes_to_seconds(120)",expected:"7200"}]},{id:"017",number:7,title:"Leftovers",description:"Create a function `remaining_samples` that takes `total` and `num_dishes`. Return how many samples are left over after even distribution.",hint:"Use the modulo operator: total % num_dishes.",starterCode:`def remaining_samples(total: int, num_dishes: int) -> int:
    # Your code here
    pass`,solutionCode:`def remaining_samples(total: int, num_dishes: int) -> int:
    """Return leftover samples."""
    return total % num_dishes`,testCases:[{input:"remaining_samples(17, 5)",expected:"2"},{input:"remaining_samples(20, 5)",expected:"0"},{input:"remaining_samples(100, 7)",expected:"2"},{input:"remaining_samples(7, 10)",expected:"7"},{input:"remaining_samples(15, 15)",expected:"0"}]},{id:"018",number:8,title:"Samples Per Dish",description:"Create a function `samples_per_dish` that takes `total` and `num_dishes`. Return how many full samples fit in each dish (integer division).",hint:"Use floor division: total // num_dishes.",starterCode:`def samples_per_dish(total: int, num_dishes: int) -> int:
    # Your code here
    pass`,solutionCode:`def samples_per_dish(total: int, num_dishes: int) -> int:
    """Return whole samples per dish."""
    return total // num_dishes`,testCases:[{input:"samples_per_dish(17, 5)",expected:"3"},{input:"samples_per_dish(20, 5)",expected:"4"},{input:"samples_per_dish(100, 7)",expected:"14"},{input:"samples_per_dish(5, 10)",expected:"0"},{input:"samples_per_dish(25, 5)",expected:"5"}]},{id:"019",number:9,title:"Circle Area",description:"Create a function `circular_area` that takes a `radius` and returns the area (pi * r^2). Use pi = 3.14159. Round to 2 decimal places.",hint:"Area = 3.14159 * (radius ** 2). Round carefully.",starterCode:`def circular_area(radius: float) -> float:
    # Your code here
    pass`,solutionCode:`def circular_area(radius: float) -> float:
    """Calculate area of a circle."""
    pi = 3.14159
    return round(pi * radius ** 2, 2)`,testCases:[{input:"circular_area(5)",expected:"78.54"},{input:"circular_area(1)",expected:"3.14"},{input:"circular_area(10)",expected:"314.16"},{input:"circular_area(0)",expected:"0.0"},{input:"circular_area(2.5)",expected:"19.63"}]},{id:"020",number:10,title:"Compound Interest",description:"Create a function `grant_growth` that calculates compound interest: principal * (1 + rate)^years. Round the result to 2 decimal places. `rate` is a decimal (e.g. 0.05).",hint:"Equation: principal * (1 + rate) ** years.",starterCode:`def grant_growth(principal: float, rate: float, years: int) -> float:
    # Your code here
    pass`,solutionCode:`def grant_growth(principal: float, rate: float, years: int) -> float:
    """Calculate compound growth."""
    return round(principal * (1 + rate) ** years, 2)`,testCases:[{input:"grant_growth(100000, 0.05, 5)",expected:"127628.16"},{input:"grant_growth(50000, 0.03, 10)",expected:"67195.82"},{input:"grant_growth(10000, 0.1, 2)",expected:"12100.0"},{input:"grant_growth(25000, 0, 5)",expected:"25000.0"},{input:"grant_growth(10000, 0.07, 3)",expected:"12250.43"}]}]},{id:"making_decisions",title:"Making Decisions",description:"If, Elif, Else & Comparisons",explanation:`
      <p class="mb-4">Programs make decisions using conditional statements. These let your code take different paths based on conditions.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Comparison Operators</h4>
      <p class="mb-2"><code>==</code> equal, <code>!=</code> not equal, <code><</code> less than, <code>></code> greater than, <code><=</code> less or equal, <code>>=</code> greater or equal</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Logical Operators</h4>
      <p class="mb-2"><code>and</code> both must be true, <code>or</code> either can be true, <code>not</code> inverts</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Early Return Pattern</h4>
      <p class="mb-2">Return as soon as you have an answer - keeps code flat and readable.</p>
    `,exampleCode:`def get_grade(score: int) -> str:
    """Return letter grade for a numeric score."""
    if score >= 90:
        return "A"
    if score >= 80:
        return "B"
    if score >= 70:
        return "C"
    if score >= 60:
        return "D"
    return "F"

def is_adult(age: int) -> bool:
    """Return True if age is 18 or older."""
    return age >= 18`,challenges:[{id:"021",number:1,title:"Check Positive",description:"Create a function `signal_detected` that takes `strength` and returns True if it is greater than 0.",hint:"Return strength > 0.",starterCode:`def signal_detected(strength: float) -> bool:
    # Your code here
    pass`,solutionCode:`def signal_detected(strength: float) -> bool:
    """Check if positive."""
    return strength > 0`,testCases:[{input:"signal_detected(0.5)",expected:"True"},{input:"signal_detected(-0.3)",expected:"False"},{input:"signal_detected(0)",expected:"False"},{input:"signal_detected(100)",expected:"True"},{input:"signal_detected(-50)",expected:"False"}]},{id:"022",number:2,title:"Is Even",description:"Create a function `has_boss` that returns True if `level` is even. Use the modulo operator.",hint:"Even means level % 2 == 0.",starterCode:`def has_boss(level: int) -> bool:
    # Your code here
    pass`,solutionCode:`def has_boss(level: int) -> bool:
    """Check if level is even."""
    return level % 2 == 0`,testCases:[{input:"has_boss(4)",expected:"True"},{input:"has_boss(7)",expected:"False"},{input:"has_boss(0)",expected:"True"},{input:"has_boss(100)",expected:"True"},{input:"has_boss(1)",expected:"False"}]},{id:"023",number:3,title:"Absolute Value",description:"Create a function `magnitude` that returns the absolute value of `n` without using abs(). If n is negative, return -n.",hint:"If n < 0, return -n. Else return n.",starterCode:`def magnitude(n: float) -> float:
    # Your code here
    pass`,solutionCode:`def magnitude(n: float) -> float:
    """Return absolute value manually."""
    if n < 0:
        return -n
    return n`,testCases:[{input:"magnitude(-5)",expected:"5"},{input:"magnitude(10)",expected:"10"},{input:"magnitude(0)",expected:"0"},{input:"magnitude(-100.5)",expected:"100.5"},{input:"magnitude(42)",expected:"42"}]},{id:"024",number:4,title:"Higher Score",description:"Create a function `higher_score` that takes `score_a` and `score_b`. Return the higher score.",hint:"If score_a > score_b, return score_a. Else return score_b.",starterCode:`def higher_score(score_a: int, score_b: int) -> int:
    # Your code here
    pass`,solutionCode:`def higher_score(score_a: int, score_b: int) -> int:
    """Return the higher score."""
    if score_a > score_b:
        return score_a
    return score_b`,testCases:[{input:"higher_score(100, 50)",expected:"100"},{input:"higher_score(25, 75)",expected:"75"},{input:"higher_score(50, 50)",expected:"50"},{input:"higher_score(0, 100)",expected:"100"},{input:"higher_score(999, 1)",expected:"999"}]},{id:"025",number:5,title:"Best of Three",description:"Create a function `best_of_three` that takes three trial results and returns the highest value.",hint:"Use `if` statements to find the maximum.",starterCode:`def best_of_three(trial1: float, trial2: float, trial3: float) -> float:
    # Your code here
    pass`,solutionCode:`def best_of_three(trial1: float, trial2: float, trial3: float) -> float:
    """Return the highest of three."""
    best = trial1
    if trial2 > best:
        best = trial2
    if trial3 > best:
        best = trial3
    return best`,testCases:[{input:"best_of_three(85, 90, 88)",expected:"90"},{input:"best_of_three(100, 50, 75)",expected:"100"},{input:"best_of_three(10, 20, 30)",expected:"30"},{input:"best_of_three(50, 50, 50)",expected:"50"},{input:"best_of_three(-5, -10, -1)",expected:"-1"}]},{id:"026",number:6,title:"Grade Converter",description:"Create a function `result_rating` that returns 'Excellent' (>=90), 'Good' (>=75), 'Acceptable' (>=60), or 'Poor' (<60).",hint:"Check scores from highest to lowest: >= 90, then >= 75, etc.",starterCode:`def result_rating(score: int) -> str:
    # Your code here
    pass`,solutionCode:`def result_rating(score: int) -> str:
    """Convert score to rating."""
    if score >= 90:
        return "Excellent"
    if score >= 75:
        return "Good"
    if score >= 60:
        return "Acceptable"
    return "Poor"`,testCases:[{input:"result_rating(95)",expected:"'Excellent'"},{input:"result_rating(82)",expected:"'Good'"},{input:"result_rating(68)",expected:"'Acceptable'"},{input:"result_rating(45)",expected:"'Poor'"},{input:"result_rating(90)",expected:"'Excellent'"}]},{id:"027",number:7,title:"Divisibility Check",description:"Create a function `protocol_status`. If `count` is divisible by 3 and 5: 'Optimal'. By 3 only: 'Valid'. By 5 only: 'Calibration Needed'. Otherwise: 'Standard'.",hint:"Check 'count % 3 == 0 and count % 5 == 0' first.",starterCode:`def protocol_status(sample_count: int) -> str:
    # Your code here
    pass`,solutionCode:`def protocol_status(sample_count: int) -> str:
    """Determine status based on divisibility."""
    if sample_count % 3 == 0 and sample_count % 5 == 0:
        return "Optimal"
    if sample_count % 3 == 0:
        return "Valid"
    if sample_count % 5 == 0:
        return "Calibration Needed"
    return "Standard"`,testCases:[{input:"protocol_status(15)",expected:"'Optimal'"},{input:"protocol_status(9)",expected:"'Valid'"},{input:"protocol_status(10)",expected:"'Calibration Needed'"},{input:"protocol_status(7)",expected:"'Standard'"},{input:"protocol_status(30)",expected:"'Optimal'"}]},{id:"028",number:8,title:"Registration Fee",description:"Create `registration_fee(type)`. 'student': 50, 'academic': 150, 'industry': 300. Any other type: 200.",hint:"Use if/elif/else to check the type string.",starterCode:`def registration_fee(attendee_type: str) -> int:
    # Your code here
    pass`,solutionCode:`def registration_fee(attendee_type: str) -> int:
    """Return registration fee."""
    if attendee_type == "student":
        return 50
    if attendee_type == "academic":
        return 150
    if attendee_type == "industry":
        return 300
    return 200`,testCases:[{input:"registration_fee('student')",expected:"50"},{input:"registration_fee('academic')",expected:"150"},{input:"registration_fee('industry')",expected:"300"},{input:"registration_fee('other')",expected:"200"},{input:"registration_fee('guest')",expected:"200"}]},{id:"029",number:9,title:"In Range",description:"Create a function `is_normal` that returns True if `value` is between `low` and `high` (inclusive).",hint:"Use chained comparison: low <= value <= high.",starterCode:`def is_normal(value: float, low: float, high: float) -> bool:
    # Your code here
    pass`,solutionCode:`def is_normal(value: float, low: float, high: float) -> bool:
    """Check if value is within range."""
    return low <= value <= high`,testCases:[{input:"is_normal(5, 1, 10)",expected:"True"},{input:"is_normal(0, 1, 10)",expected:"False"},{input:"is_normal(1, 1, 10)",expected:"True"},{input:"is_normal(10, 1, 10)",expected:"True"},{input:"is_normal(15, 1, 10)",expected:"False"}]},{id:"030",number:10,title:"Smart Dosage",description:"Create `calculate_dosage(weight, age)`. If weight < 10, return 'Consult specialist'. Otherwise base dose is weight * 5. If age < 12 or > 65, reduce base dose by 25%. Return formatted string 'Xmg' (1 decimal).",hint:"Handle weight < 10 first. Then calc base. Then check age modifiers. Finally return f-string.",starterCode:`def calculate_dosage(weight_kg: float, age: int) -> str:
    # Your code here
    pass`,solutionCode:`def calculate_dosage(weight_kg: float, age: int) -> str:
    """Calculate dosage with age adjustment."""
    if weight_kg < 10:
        return "Consult specialist"
    
    dose = weight_kg * 5
    
    if age < 12 or age > 65:
        dose = dose * 0.75
    
    return f"{round(dose, 1)}mg"`,testCases:[{input:"calculate_dosage(70, 30)",expected:"'350.0mg'"},{input:"calculate_dosage(70, 10)",expected:"'262.5mg'"},{input:"calculate_dosage(70, 70)",expected:"'262.5mg'"},{input:"calculate_dosage(8, 5)",expected:"'Consult specialist'"},{input:"calculate_dosage(50, 40)",expected:"'250.0mg'"}]}]},{id:"text_basics",title:"Text Processing Basics",description:"String Methods & Formatting",explanation:`
      <p class="mb-4">Strings are sequences of characters. Python provides powerful built-in methods for working with text.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Common String Methods</h4>
      <p class="mb-2"><code>.upper()</code>, <code>.lower()</code>, <code>.strip()</code>, <code>.replace()</code>, <code>.split()</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">String Properties</h4>
      <p class="mb-2"><code>len(s)</code> for length, <code>in</code> to check containment, indexing with <code>s[0]</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">f-Strings</h4>
      <p class="mb-2">f-strings embed expressions: <code>f"Hello {name}, you are {age} years old"</code></p>
    `,exampleCode:`def shout(text: str) -> str:
    """Return text in uppercase with exclamation."""
    return f"{text.upper()}!"

def clean_input(text: str) -> str:
    """Remove whitespace and convert to lowercase."""
    return text.strip().lower()

def get_initials(full_name: str) -> str:
    """Return initials from a full name."""
    parts = full_name.split()
    initials = ""
    for part in parts:
        initials += part[0].upper()
    return initials`,challenges:[{id:"033",number:1,title:"Uppercase Converter",description:"Create a function `alert_message` that takes a `message` string and returns it in all uppercase letters.",hint:"Use `message.upper()`.",starterCode:`def alert_message(message: str) -> str:
    # Your code here
    pass`,solutionCode:`def alert_message(message: str) -> str:
    """Convert message to uppercase."""
    return message.upper()`,testCases:[{input:"alert_message('warning')",expected:"'WARNING'"},{input:"alert_message('System Error')",expected:"'SYSTEM ERROR'"},{input:"alert_message('check results')",expected:"'CHECK RESULTS'"},{input:"alert_message('a')",expected:"'A'"},{input:"alert_message('')",expected:"''"}]},{id:"034",number:2,title:"Lowercase Converter",description:"Create a function `normalize_username` that takes a `username` string and returns it in all lowercase letters.",hint:"Use `username.lower()`.",starterCode:`def normalize_username(username: str) -> str:
    # Your code here
    pass`,solutionCode:`def normalize_username(username: str) -> str:
    """Convert username to lowercase."""
    return username.lower()`,testCases:[{input:"normalize_username('DrNeural')",expected:"'drneural'"},{input:"normalize_username('ADMIN')",expected:"'admin'"},{input:"normalize_username('User123')",expected:"'user123'"},{input:"normalize_username('test')",expected:"'test'"},{input:"normalize_username('ABC')",expected:"'abc'"}]},{id:"035",number:3,title:"String Length",description:"Create a function `password_length` that returns the number of characters in a `password` string.",hint:"Use `len(password)`.",starterCode:`def password_length(password: str) -> int:
    # Your code here
    pass`,solutionCode:`def password_length(password: str) -> int:
    """Return the length of a password."""
    return len(password)`,testCases:[{input:"password_length('secret123')",expected:"9"},{input:"password_length('')",expected:"0"},{input:"password_length('a')",expected:"1"},{input:"password_length('MySecureP@ss!')",expected:"13"},{input:"password_length('12345678')",expected:"8"}]},{id:"036",number:4,title:"First Letter",description:"Create a function `first_initial` that returns the first character of `name`.",hint:"Access index 0: `name[0]`.",starterCode:`def first_initial(name: str) -> str:
    # Your code here
    pass`,solutionCode:`def first_initial(name: str) -> str:
    """Return the first character of a name."""
    return name[0]`,testCases:[{input:"first_initial('Alice')",expected:"'A'"},{input:"first_initial('bob')",expected:"'b'"},{input:"first_initial('Neuroscience')",expected:"'N'"},{input:"first_initial('123')",expected:"'1'"},{input:"first_initial('X')",expected:"'X'"}]},{id:"037",number:5,title:"Last Letter",description:"Create a function `last_character` that returns the last character of `text`.",hint:"Use negative indexing: `text[-1]`.",starterCode:`def last_character(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def last_character(text: str) -> str:
    """Return the last character of text."""
    return text[-1]`,testCases:[{input:"last_character('data.csv')",expected:"'v'"},{input:"last_character('report')",expected:"'t'"},{input:"last_character('x')",expected:"'x'"},{input:"last_character('test123')",expected:"'3'"},{input:"last_character('Hello!')",expected:"'!'"}]},{id:"038",number:6,title:"Contains Keyword",description:"Create a function `contains_keyword` that takes `text` and `keyword`. Return True if the keyword is found inside the text.",hint:"Use the `in` operator: `keyword in text`.",starterCode:`def contains_keyword(text: str, keyword: str) -> bool:
    # Your code here
    pass`,solutionCode:`def contains_keyword(text: str, keyword: str) -> bool:
    """Check if keyword is in text."""
    return keyword in text`,testCases:[{input:"contains_keyword('neural networks are powerful', 'neural')",expected:"True"},{input:"contains_keyword('machine learning', 'deep')",expected:"False"},{input:"contains_keyword('data science', 'data')",expected:"True"},{input:"contains_keyword('Python programming', 'python')",expected:"False"},{input:"contains_keyword('AI research', 'AI')",expected:"True"}]},{id:"039",number:7,title:"Clean Input",description:"Create a function `clean_input` that strips whitespace from `text` and converts it to lowercase.",hint:"Use `.strip()` then `.lower()`.",starterCode:`def clean_input(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def clean_input(text: str) -> str:
    """Strip whitespace and convert to lowercase."""
    return text.strip().lower()`,testCases:[{input:"clean_input('  Hello  ')",expected:"'hello'"},{input:"clean_input('  EXPERIMENT  ')",expected:"'experiment'"},{input:"clean_input('Data')",expected:"'data'"},{input:"clean_input('   test   ')",expected:"'test'"},{input:"clean_input('already clean')",expected:"'already clean'"}]},{id:"040",number:8,title:"Repeat String",description:"Create a function `amplify_sequence` that repeats a `sequence` string `cycles` times.",hint:"Mulitply the string by the number: `sequence * cycles`.",starterCode:`def amplify_sequence(sequence: str, cycles: int) -> str:
    # Your code here
    pass`,solutionCode:`def amplify_sequence(sequence: str, cycles: int) -> str:
    """Repeat a DNA sequence multiple times."""
    return sequence * cycles`,testCases:[{input:"amplify_sequence('ATG', 3)",expected:"'ATGATGATG'"},{input:"amplify_sequence('GC', 4)",expected:"'GCGCGCGC'"},{input:"amplify_sequence('A', 5)",expected:"'AAAAA'"},{input:"amplify_sequence('TATA', 0)",expected:"''"},{input:"amplify_sequence('CAT', 2)",expected:"'CATCAT'"}]},{id:"041",number:9,title:"Replace Spaces",description:"Create a function `sanitize_filename` that replaces all spaces in `filename` with underscores.",hint:"Use `filename.replace(' ', '_')`.",starterCode:`def sanitize_filename(filename: str) -> str:
    # Your code here
    pass`,solutionCode:`def sanitize_filename(filename: str) -> str:
    """Replace spaces with underscores in filenames."""
    return filename.replace(" ", "_")`,testCases:[{input:"sanitize_filename('my file name')",expected:"'my_file_name'"},{input:"sanitize_filename('brain scan 001')",expected:"'brain_scan_001'"},{input:"sanitize_filename('noSpaces')",expected:"'noSpaces'"},{input:"sanitize_filename('a b c d')",expected:"'a_b_c_d'"},{input:"sanitize_filename(' leading')",expected:"'_leading'"}]},{id:"042",number:10,title:"Generate User ID",description:"Create a function `generate_user_id` that takes `first_name`, `last_name`, and `year`. Return a string in the format 'FIRST_LAST_YEAR'. Ensure names are uppercase and spaces are stripped.",hint:"Use `strip()`, `upper()`, and f-string formatting.",starterCode:`def generate_user_id(first_name: str, last_name: str, year: int) -> str:
    # Your code here
    pass`,solutionCode:`def generate_user_id(first_name: str, last_name: str, year: int) -> str:
    """Generate standardized user ID."""
    first = first_name.strip().upper()
    last = last_name.strip().upper()
    return f"{first}_{last}_{year}"`,testCases:[{input:"generate_user_id('John', 'Doe', 2024)",expected:"'JOHN_DOE_2024'"},{input:"generate_user_id('  Sarah ', 'Smith', 1999)",expected:"'SARAH_SMITH_1999'"},{input:"generate_user_id('alice', 'jones', 2000)",expected:"'ALICE_JONES_2000'"},{input:"generate_user_id('dr', 'who', 1963)",expected:"'DR_WHO_1963'"},{input:"generate_user_id(' Ai ', ' Bot ', 2050)",expected:"'AI_BOT_2050'"}]}]},{id:"for_loops",title:"For Loops",description:"Iterating with Range and Sequences",explanation:`
      <p class="mb-4">For loops repeat code a specific number of times or iterate through items in a sequence.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">range() Function</h4>
      <p class="mb-2"><code>range(stop)</code> - 0 to stop-1<br><code>range(start, stop)</code> - start to stop-1<br><code>range(start, stop, step)</code> - with custom step</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Iterating Strings</h4>
      <p class="mb-2"><code>for char in text:</code> loops through each character</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Accumulator Pattern</h4>
      <p class="mb-2">Start with initial value, update in each iteration, return final result.</p>
    `,exampleCode:`def sum_to_n(n: int) -> int:
    """Return sum of numbers from 1 to n."""
    total = 0
    for i in range(1, n + 1):
        total += i
    return total

def count_char(text: str, target: str) -> int:
    """Count occurrences of target character in text."""
    count = 0
    for char in text:
        if char == target:
            count += 1
    return count`,challenges:[{id:"043",number:1,title:"Sum N",description:"Create a function `total_score` that returns the sum of all integers from 1 to `n`.",hint:"Loop from 1 to n+1 and add to a total.",starterCode:`def total_score(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def total_score(n: int) -> int:
    """Sum all integers from 1 to n."""
    total = 0
    for i in range(1, n + 1):
        total += i
    return total`,testCases:[{input:"total_score(5)",expected:"15"},{input:"total_score(1)",expected:"1"},{input:"total_score(10)",expected:"55"},{input:"total_score(100)",expected:"5050"},{input:"total_score(3)",expected:"6"}]},{id:"044",number:2,title:"Factorial",description:"Create a function `factorial` that returns `n!`. If n is 0, return 1.",hint:"Start with result = 1. Loop and multiply.",starterCode:`def factorial(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def factorial(n: int) -> int:
    """Calculate n factorial."""
    if n == 0:
        return 1
    result = 1
    for i in range(1, n + 1):
        result *= i
    return result`,testCases:[{input:"factorial(5)",expected:"120"},{input:"factorial(3)",expected:"6"},{input:"factorial(0)",expected:"1"},{input:"factorial(1)",expected:"1"},{input:"factorial(7)",expected:"5040"}]},{id:"045",number:3,title:"Count Char",description:"Create a function `count_base` that counts the occurrences of `base` in `sequence`.",hint:"Loop through sequence and check if char == base.",starterCode:`def count_base(sequence: str, base: str) -> int:
    # Your code here
    pass`,solutionCode:`def count_base(sequence: str, base: str) -> int:
    """Count occurrences of base in DNA sequence."""
    count = 0
    for nucleotide in sequence:
        if nucleotide == base:
            count += 1
    return count`,testCases:[{input:"count_base('ATGCATGC', 'A')",expected:"2"},{input:"count_base('GGGGGG', 'G')",expected:"6"},{input:"count_base('ATCG', 'T')",expected:"1"},{input:"count_base('CCCC', 'A')",expected:"0"},{input:"count_base('AAAAAA', 'A')",expected:"6"}]},{id:"046",number:4,title:"Count Vowels",description:"Create a function `count_vowels` that counts vowels ('aeiou') in `text` (case-insensitive).",hint:"Check if `char` in 'aeiouAEIOU'.",starterCode:`def count_vowels(text: str) -> int:
    # Your code here
    pass`,solutionCode:`def count_vowels(text: str) -> int:
    """Count vowels in text (case insensitive)."""
    vowels = "aeiouAEIOU"
    count = 0
    for char in text:
        if char in vowels:
            count += 1
    return count`,testCases:[{input:"count_vowels('neuroscience')",expected:"6"},{input:"count_vowels('AEIOU')",expected:"5"},{input:"count_vowels('xyz')",expected:"0"},{input:"count_vowels('Python')",expected:"1"},{input:"count_vowels('')",expected:"0"}]},{id:"047",number:5,title:"Power Loop",description:"Create a function `exponential` that calculates `base`^`exponent` using a loop (no `**` operator).",hint:"Initialize `result = 1` and multiply by `base` `exponent` times.",starterCode:`def exponential(base: int, exponent: int) -> int:
    # Your code here
    pass`,solutionCode:`def exponential(base: int, exponent: int) -> int:
    """Calculate base to the power of exponent using a loop."""
    result = 1
    for _ in range(exponent):
        result *= base
    return result`,testCases:[{input:"exponential(2, 10)",expected:"1024"},{input:"exponential(3, 4)",expected:"81"},{input:"exponential(5, 0)",expected:"1"},{input:"exponential(10, 3)",expected:"1000"},{input:"exponential(2, 8)",expected:"256"}]},{id:"048",number:6,title:"Reverse Loop",description:"Create a function `reverse_sequence` that returns the reversed string using a loop.",hint:"Prepend chars: `result = char + result`.",starterCode:`def reverse_sequence(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def reverse_sequence(text: str) -> str:
    """Reverse a string using a loop."""
    result = ""
    for char in text:
        result = char + result
    return result`,testCases:[{input:"reverse_sequence('ATGC')",expected:"'CGTA'"},{input:"reverse_sequence('neural')",expected:"'laruen'"},{input:"reverse_sequence('a')",expected:"'a'"},{input:"reverse_sequence('12345')",expected:"'54321'"},{input:"reverse_sequence('')",expected:"''"}]},{id:"049",number:7,title:"Sum Evens",description:"Create a function `sum_even_samples` that sums even numbers from 2 to `n` (inclusive).",hint:"Use `range(2, n + 1, 2)`.",starterCode:`def sum_even_samples(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def sum_even_samples(n: int) -> int:
    """Sum all even numbers from 2 to n."""
    total = 0
    for i in range(2, n + 1, 2):
        total += i
    return total`,testCases:[{input:"sum_even_samples(10)",expected:"30"},{input:"sum_even_samples(6)",expected:"12"},{input:"sum_even_samples(2)",expected:"2"},{input:"sum_even_samples(100)",expected:"2550"},{input:"sum_even_samples(1)",expected:"0"}]},{id:"050",number:8,title:"Digit Product",description:"Create a function `digit_product` that returns the product of all digits in `n`.",hint:"Convert `n` to string, loop through digits, convert back to int and multiply.",starterCode:`def digit_product(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def digit_product(n: int) -> int:
    """Multiply all digits of a number."""
    result = 1
    for digit in str(n):
        result *= int(digit)
    return result`,testCases:[{input:"digit_product(234)",expected:"24"},{input:"digit_product(111)",expected:"1"},{input:"digit_product(502)",expected:"0"},{input:"digit_product(99)",expected:"81"},{input:"digit_product(5)",expected:"5"}]},{id:"051",number:9,title:"Word Count",description:"Create a function `word_count` that returns the number of words in `sentence`.",hint:"Use `sentence.split()`.",starterCode:`def word_count(sentence: str) -> int:
    # Your code here
    pass`,solutionCode:`def word_count(sentence: str) -> int:
    """Count words in a sentence."""
    if not sentence.strip():
        return 0
    return len(sentence.split())`,testCases:[{input:"word_count('neural network analysis')",expected:"3"},{input:"word_count('hello')",expected:"1"},{input:"word_count('')",expected:"0"},{input:"word_count('one two three four five')",expected:"5"},{input:"word_count('   ')",expected:"0"}]},{id:"052",number:10,title:"Pattern Generator",description:"Create a function `pattern_generator` that returns a string containing `character` repeated `n` times, then `n-1` times, down to 1 time, separated by newlines.",hint:"Loop range(n, 0, -1). Accumulate `character * i` + '\\n'. Strip trailing newline.",starterCode:`def pattern_generator(character: str, n: int) -> str:
    # Your code here
    pass`,solutionCode:`def pattern_generator(character: str, n: int) -> str:
    """Generate a descending pattern."""
    result = ""
    for i in range(n, 0, -1):
        result += (character * i)
        if i > 1:
            result += "\\n"
    return result`,testCases:[{input:"pattern_generator('*', 3)",expected:"'***\\n**\\n*'"},{input:"pattern_generator('#', 1)",expected:"'#'"},{input:"pattern_generator('A', 4)",expected:"'AAAA\\nAAA\\nAA\\nA'"},{input:"pattern_generator('!', 2)",expected:"'!!\\n!'"},{input:"pattern_generator('x', 5)",expected:"'xxxxx\\nxxxx\\nxxx\\nxx\\nx'"}]}]},{id:"while_loops",title:"While Loops & Validation",description:"Condition-Based Iteration",explanation:`
      <p class="mb-4">While loops continue until a condition becomes False. They're useful when you don't know exactly how many iterations you need.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Basic While Loop</h4>
      <p class="mb-2"><code>while condition:</code> - continues as long as condition is True</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Avoid Infinite Loops</h4>
      <p class="mb-2">Always ensure the condition will eventually become False!</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Common Patterns</h4>
      <p class="mb-2">Counting down, processing until a condition is met, number manipulation.</p>
    `,exampleCode:`def count_digits(n: int) -> int:
    """Count how many digits in a number."""
    if n == 0:
        return 1
    count = 0
    n = abs(n)
    while n > 0:
        count += 1
        n //= 10
    return count

def collatz_steps(n: int) -> int:
    """Count steps until n reaches 1 using Collatz sequence."""
    steps = 0
    while n != 1:
        if n % 2 == 0:
            n = n // 2
        else:
            n = 3 * n + 1
        steps += 1
    return steps`,challenges:[{id:"053",number:1,title:"Count Digits",description:"Create a function `digit_count` that returns the number of digits in `n`.",hint:"While `n > 0`, divide `n` by 10 and increment count. If `n` is 0, count is 1.",starterCode:`def digit_count(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def digit_count(n: int) -> int:
    """Count digits in a number."""
    if n == 0:
        return 1
    count = 0
    n = abs(n)
    while n > 0:
        count += 1
        n //= 10
    return count`,testCases:[{input:"digit_count(12345)",expected:"5"},{input:"digit_count(7)",expected:"1"},{input:"digit_count(0)",expected:"1"},{input:"digit_count(1000)",expected:"4"},{input:"digit_count(99)",expected:"2"}]},{id:"054",number:2,title:"Sum Digits",description:"Create a function `digit_sum` that returns the sum of all digits in `n`.",hint:"Use `n % 10` to get the last digit and `n //= 10` to remove it.",starterCode:`def digit_sum(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def digit_sum(n: int) -> int:
    """Sum all digits of a number."""
    total = 0
    n = abs(n)
    while n > 0:
        total += n % 10
        n //= 10
    return total`,testCases:[{input:"digit_sum(123)",expected:"6"},{input:"digit_sum(9999)",expected:"36"},{input:"digit_sum(101)",expected:"2"},{input:"digit_sum(5)",expected:"5"},{input:"digit_sum(0)",expected:"0"}]},{id:"055",number:3,title:"Reverse Number",description:"Create a function `reverse_number` that returns `n` with its digits reversed.",hint:"Multiply result by 10 and add the last digit of n.",starterCode:`def reverse_number(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def reverse_number(n: int) -> int:
    """Reverse the digits of a number."""
    reversed_n = 0
    while n > 0:
        reversed_n = reversed_n * 10 + (n % 10)
        n //= 10
    return reversed_n`,testCases:[{input:"reverse_number(1234)",expected:"4321"},{input:"reverse_number(100)",expected:"1"},{input:"reverse_number(5)",expected:"5"},{input:"reverse_number(9876)",expected:"6789"},{input:"reverse_number(12)",expected:"21"}]},{id:"056",number:4,title:"Palindrome Number",description:"Create a function `is_palindrome` that returns True if the integer `n` is a palindrome (reads same forwards and backwards).",hint:"Compare `n` with its reversed version.",starterCode:`def is_palindrome(n: int) -> bool:
    # Your code here
    pass`,solutionCode:`def is_palindrome(n: int) -> bool:
    """Check if number is a palindrome."""
    original = n
    reversed_n = 0
    while n > 0:
        reversed_n = reversed_n * 10 + (n % 10)
        n //= 10
    return original == reversed_n`,testCases:[{input:"is_palindrome(12321)",expected:"True"},{input:"is_palindrome(12345)",expected:"False"},{input:"is_palindrome(7)",expected:"True"},{input:"is_palindrome(11)",expected:"True"},{input:"is_palindrome(10)",expected:"False"}]},{id:"057",number:5,title:"GCD",description:"Create a function `find_gcd` that returns the Greatest Common Divisor of `a` and `b`.",hint:"Use Euclid's algorithm: while b != 0, (a, b) = (b, a % b).",starterCode:`def find_gcd(a: int, b: int) -> int:
    # Your code here
    pass`,solutionCode:`def find_gcd(a: int, b: int) -> int:
    """Find GCD using Euclid's algorithm."""
    while b != 0:
        a, b = b, a % b
    return a`,testCases:[{input:"find_gcd(48, 18)",expected:"6"},{input:"find_gcd(100, 25)",expected:"25"},{input:"find_gcd(17, 13)",expected:"1"},{input:"find_gcd(24, 36)",expected:"12"},{input:"find_gcd(7, 7)",expected:"7"}]},{id:"058",number:6,title:"Collatz Steps",description:"Create a function `collatz_steps` that returns the number of steps to reach 1. (If even, divide by 2; if odd, 3n+1).",hint:"While n != 1, update n and increment steps.",starterCode:`def collatz_steps(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def collatz_steps(n: int) -> int:
    """Count Collatz sequence steps to reach 1."""
    steps = 0
    while n != 1:
        if n % 2 == 0:
            n = n // 2
        else:
            n = 3 * n + 1
        steps += 1
    return steps`,testCases:[{input:"collatz_steps(1)",expected:"0"},{input:"collatz_steps(2)",expected:"1"},{input:"collatz_steps(10)",expected:"6"},{input:"collatz_steps(27)",expected:"111"},{input:"collatz_steps(6)",expected:"8"}]},{id:"059",number:7,title:"Is Prime",description:"Create a function `is_prime` that returns True if `n` is a prime number (divisible only by 1 and itself).",hint:"Check divisibility from 2 up to sqrt(n).",starterCode:`def is_prime(n: int) -> bool:
    # Your code here
    pass`,solutionCode:`def is_prime(n: int) -> bool:
    """Check if number is prime."""
    if n < 2:
        return False
    if n == 2:
        return True
    if n % 2 == 0:
        return False
    i = 3
    while i * i <= n:
        if n % i == 0:
            return False
        i += 2
    return True`,testCases:[{input:"is_prime(17)",expected:"True"},{input:"is_prime(4)",expected:"False"},{input:"is_prime(2)",expected:"True"},{input:"is_prime(1)",expected:"False"},{input:"is_prime(97)",expected:"True"}]},{id:"060",number:8,title:"Next Prime",description:"Create a function `next_prime` that returns the smallest prime number greater than `n`.",hint:"Start at n+1 and increment until you find a prime.",starterCode:`def next_prime(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def next_prime(n: int) -> int:
    """Find the next prime number after n."""
    def is_prime(num):
        if num < 2:
            return False
        for i in range(2, int(num ** 0.5) + 1):
            if num % i == 0:
                return False
        return True
    
    candidate = n + 1
    while not is_prime(candidate):
        candidate += 1
    return candidate`,testCases:[{input:"next_prime(10)",expected:"11"},{input:"next_prime(2)",expected:"3"},{input:"next_prime(13)",expected:"17"},{input:"next_prime(100)",expected:"101"},{input:"next_prime(0)",expected:"2"}]},{id:"061",number:9,title:"Digital Root",description:"Create a function `digital_root` that repeatedly sums the digits of `n` until a single digit remains.",hint:"Use nested loops: while n >= 10, sum its digits.",starterCode:`def digital_root(n: int) -> int:
    # Your code here
    pass`,solutionCode:`def digital_root(n: int) -> int:
    """Keep summing digits until single digit remains."""
    while n >= 10:
        total = 0
        while n > 0:
            total += n % 10
            n //= 10
        n = total
    return n`,testCases:[{input:"digital_root(9875)",expected:"2"},{input:"digital_root(16)",expected:"7"},{input:"digital_root(9)",expected:"9"},{input:"digital_root(12345)",expected:"6"},{input:"digital_root(999)",expected:"9"}]},{id:"062",number:10,title:"Decimal to Binary",description:"Create a function `to_binary` that converts a positive integer `n` to its binary string representation (without using `bin()`).",hint:"While n > 0: `bit = n % 2`, `result = str(bit) + result`, `n //= 2`. Handle n=0 case.",starterCode:`def to_binary(n: int) -> str:
    # Your code here
    pass`,solutionCode:`def to_binary(n: int) -> str:
    """Convert integer to binary string."""
    if n == 0:
        return "0"
    result = ""
    while n > 0:
        bit = n % 2
        result = str(bit) + result
        n //= 2
    return result`,testCases:[{input:"to_binary(10)",expected:"'1010'"},{input:"to_binary(0)",expected:"'0'"},{input:"to_binary(255)",expected:"'11111111'"},{input:"to_binary(1)",expected:"'1'"},{input:"to_binary(16)",expected:"'10000'"}]}]},{id:"lists_basics",title:"Lists: The Basics",description:"Creating and Accessing Lists",explanation:`
      <p class="mb-4">Lists store ordered collections of items. They're one of Python's most versatile data structures.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Creating Lists</h4>
      <p class="mb-2"><code>nums = [1, 2, 3]</code> or <code>empty = []</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Accessing Elements</h4>
      <p class="mb-2"><code>nums[0]</code> first element, <code>nums[-1]</code> last element</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Common Operations</h4>
      <p class="mb-2"><code>len()</code>, <code>in</code>, <code>.append()</code>, <code>.pop()</code></p>
    `,exampleCode:`def sum_list(numbers: list) -> int:
    """Return the sum of all numbers in the list."""
    total = 0
    for num in numbers:
        total += num
    return total

def find_max(numbers: list) -> int:
    """Find the largest number in a list."""
    if not numbers:
        return None
    largest = numbers[0]
    for num in numbers:
        if num > largest:
            largest = num
    return largest`,challenges:[{id:"063",number:1,title:"Sum List",description:"Create a function `sum_list` that returns the sum of all numbers in the list (without using `sum()`).",hint:"Initialize `total = 0`. Loop and add each number.",starterCode:`def sum_list(numbers: list) -> float:
    # Your code here
    pass`,solutionCode:`def sum_list(numbers: list) -> float:
    """Sum all numbers in a list."""
    total = 0
    for num in numbers:
        total += num
    return total`,testCases:[{input:"sum_list([1, 2, 3])",expected:"6"},{input:"sum_list([10, 20])",expected:"30"},{input:"sum_list([])",expected:"0"},{input:"sum_list([5])",expected:"5"},{input:"sum_list([-1, 1])",expected:"0"}]},{id:"064",number:2,title:"Average",description:"Create a function `average` that returns the arithmetic mean of numbers in the list. Check for empty list.",hint:"Sum divided by length. Return 0 if empty.",starterCode:`def average(numbers: list) -> float:
    # Your code here
    pass`,solutionCode:`def average(numbers: list) -> float:
    """Calculate average of numbers in a list."""
    if not numbers:
        return 0
    total = 0
    for num in numbers:
        total += num
    return total / len(numbers)`,testCases:[{input:"average([1, 2, 3])",expected:"2.0"},{input:"average([10, 20])",expected:"15.0"},{input:"average([])",expected:"0"},{input:"average([5, 5, 5, 5])",expected:"5.0"},{input:"average([0, 10])",expected:"5.0"}]},{id:"065",number:3,title:"Find Max",description:"Create a function `find_max` that returns the largest number in the list (without using `max()`).",hint:"Initialize `largest` with first element, loop and update if larger found.",starterCode:`def find_max(numbers: list) -> float:
    # Your code here
    pass`,solutionCode:`def find_max(numbers: list) -> float:
    """Find the maximum value in a list."""
    if not numbers:
        return None
    largest = numbers[0]
    for num in numbers:
        if num > largest:
            largest = num
    return largest`,testCases:[{input:"find_max([1, 5, 3])",expected:"5"},{input:"find_max([10, 2, 8])",expected:"10"},{input:"find_max([-5, -1, -10])",expected:"-1"},{input:"find_max([7, 7, 7])",expected:"7"},{input:"find_max([42])",expected:"42"}]},{id:"066",number:4,title:"Find Min",description:"Create a function `find_min` that returns the smallest number in the list (without using `min()`).",hint:"Initialize `smallest` with first element, loop and update if smaller found.",starterCode:`def find_min(numbers: list) -> float:
    # Your code here
    pass`,solutionCode:`def find_min(numbers: list) -> float:
    """Find the minimum value in a list."""
    if not numbers:
        return None
    smallest = numbers[0]
    for num in numbers:
        if num < smallest:
            smallest = num
    return smallest`,testCases:[{input:"find_min([1, 5, 3])",expected:"1"},{input:"find_min([10, 2, 8])",expected:"2"},{input:"find_min([-5, -1, -10])",expected:"-10"},{input:"find_min([7, 7, 7])",expected:"7"},{input:"find_min([42])",expected:"42"}]},{id:"067",number:5,title:"Count Occurrences",description:"Create a function `count_item` that returns how many times `target` appears in `items`.",hint:"Loop and increment counter when match found.",starterCode:`def count_item(items: list, target) -> int:
    # Your code here
    pass`,solutionCode:`def count_item(items: list, target) -> int:
    """Count occurrences of target in list."""
    count = 0
    for item in items:
        if item == target:
            count += 1
    return count`,testCases:[{input:"count_item([1, 2, 2, 3], 2)",expected:"2"},{input:"count_item(['a', 'b', 'a'], 'a')",expected:"2"},{input:"count_item([1, 2, 3], 4)",expected:"0"},{input:"count_item([], 5)",expected:"0"},{input:"count_item([7, 7, 7, 7], 7)",expected:"4"}]},{id:"068",number:6,title:"First and Last",description:"Create a function `first_and_last` that returns a list containing only the first and last elements.",hint:"Return `[items[0], items[-1]]`.",starterCode:`def first_and_last(items: list) -> list:
    # Your code here
    pass`,solutionCode:`def first_and_last(items: list) -> list:
    """Return first and last elements of a list."""
    if len(items) < 2:
        return items.copy()
    return [items[0], items[-1]]`,testCases:[{input:"first_and_last([1, 2, 3, 4])",expected:"[1, 4]"},{input:"first_and_last([1])",expected:"[1]"},{input:"first_and_last(['a', 'b'])",expected:"['a', 'b']"},{input:"first_and_last([])",expected:"[]"},{input:"first_and_last([5, 10, 15])",expected:"[5, 15]"}]},{id:"069",number:7,title:"Reverse List",description:"Create a function `reverse_list` that returns a new list with elements in reverse order (without using `.reverse()` or `[::-1]`).",hint:"Iterate backwards from `len(items)-1` to 0.",starterCode:`def reverse_list(items: list) -> list:
    # Your code here
    pass`,solutionCode:`def reverse_list(items: list) -> list:
    """Reverse a list without built-in methods."""
    result = []
    for i in range(len(items) - 1, -1, -1):
        result.append(items[i])
    return result`,testCases:[{input:"reverse_list([1, 2, 3])",expected:"[3, 2, 1]"},{input:"reverse_list(['a', 'b'])",expected:"['b', 'a']"},{input:"reverse_list([])",expected:"[]"},{input:"reverse_list([42])",expected:"[42]"},{input:"reverse_list([1, 2, 3, 4, 5])",expected:"[5, 4, 3, 2, 1]"}]},{id:"070",number:8,title:"Contains",description:"Create a function `contains` that returns True if `target` is in `items` (without using `in`).",hint:"Loop and return True if match found.",starterCode:`def contains(items: list, target) -> bool:
    # Your code here
    pass`,solutionCode:`def contains(items: list, target) -> bool:
    """Check if target is in list without using 'in'."""
    for item in items:
        if item == target:
            return True
    return False`,testCases:[{input:"contains([1, 2, 3], 2)",expected:"True"},{input:"contains(['a', 'b'], 'z')",expected:"False"},{input:"contains([], 1)",expected:"False"},{input:"contains([5, 5, 5], 5)",expected:"True"},{input:"contains(['hello', 'world'], 'world')",expected:"True"}]},{id:"071",number:9,title:"Find Index",description:"Create a function `find_index` that returns the index of the first occurrence of `target` (or -1 if not found).",hint:"Use `range(len(items))`.",starterCode:`def find_index(items: list, target) -> int:
    # Your code here
    pass`,solutionCode:`def find_index(items: list, target) -> int:
    """Find index of first occurrence of target."""
    for i in range(len(items)):
        if items[i] == target:
            return i
    return -1`,testCases:[{input:"find_index([10, 20, 30], 20)",expected:"1"},{input:"find_index(['a', 'b', 'c'], 'c')",expected:"2"},{input:"find_index([1, 2], 3)",expected:"-1"},{input:"find_index([5, 5, 5], 5)",expected:"0"},{input:"find_index([], 1)",expected:"-1"}]},{id:"072",number:10,title:"All Positive",description:"Create a function `all_positive` that returns True if all numbers in the list are positive (> 0). Empty list returns True.",hint:"If list is empty, return True. Return False if any number is <= 0.",starterCode:`def all_positive(numbers: list) -> bool:
    # Your code here
    pass`,solutionCode:`def all_positive(numbers: list) -> bool:
    """Check if all numbers are positive."""
    for num in numbers:
        if num <= 0:
            return False
    return True`,testCases:[{input:"all_positive([1, 2, 3])",expected:"True"},{input:"all_positive([1, -2, 3])",expected:"False"},{input:"all_positive([])",expected:"True"},{input:"all_positive([0])",expected:"False"},{input:"all_positive([0.001, 0.002])",expected:"True"}]}]},{id:"lists_transformation",title:"Transforming Lists",description:"Filtering, Mapping & Building New Lists",explanation:`
      <p class="mb-4">Often we need to create new lists based on existing ones - filtering items, transforming values, or combining data.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Filter Pattern</h4>
      <p class="mb-2">Create empty list, loop through original, add items that meet condition.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Map Pattern</h4>
      <p class="mb-2">Create empty list, loop through original, add transformed version of each item.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Slicing</h4>
      <p class="mb-2"><code>items[start:end]</code> - elements from start to end-1</p>
    `,exampleCode:`def filter_positive(numbers: list) -> list:
    """Return only positive numbers from the list."""
    result = []
    for num in numbers:
        if num > 0:
            result.append(num)
    return result

def double_all(numbers: list) -> list:
    """Return a new list with all numbers doubled."""
    result = []
    for num in numbers:
        result.append(num * 2)
    return result`,challenges:[{id:"073",number:1,title:"Filter Positive",description:"Create a function `filter_positive` that returns a new list containing only the positive numbers (greater than 0) from the input list.",hint:"Create result list. Loop through numbers, if num > 0, append to result.",starterCode:`def filter_positive(numbers: list) -> list:
    # Your code here
    pass`,solutionCode:`def filter_positive(numbers: list) -> list:
    """Filter to only positive numbers."""
    result = []
    for num in numbers:
        if num > 0:
            result.append(num)
    return result`,testCases:[{input:"filter_positive([1, -1, 2, -2])",expected:"[1, 2]"},{input:"filter_positive([-1, -2, -3])",expected:"[]"},{input:"filter_positive([])",expected:"[]"},{input:"filter_positive([0, 1, 2])",expected:"[1, 2]"},{input:"filter_positive([5])",expected:"[5]"}]},{id:"074",number:2,title:"Filter Even",description:"Create a function `filter_even` that returns a new list containing only the even numbers from the input list.",hint:"If `num % 2 == 0`, append to result.",starterCode:`def filter_even(numbers: list) -> list:
    # Your code here
    pass`,solutionCode:`def filter_even(numbers: list) -> list:
    """Filter to only even numbers."""
    result = []
    for num in numbers:
        if num % 2 == 0:
            result.append(num)
    return result`,testCases:[{input:"filter_even([1, 2, 3, 4])",expected:"[2, 4]"},{input:"filter_even([1, 3, 5])",expected:"[]"},{input:"filter_even([])",expected:"[]"},{input:"filter_even([0, 2, 4])",expected:"[0, 2, 4]"},{input:"filter_even([-2, -1, 0, 1, 2])",expected:"[-2, 0, 2]"}]},{id:"075",number:3,title:"Double All",description:"Create a function `double_all` that returns a new list where each number from the input list is multiplied by 2.",hint:"Loop through numbers, append `num * 2` to result.",starterCode:`def double_all(numbers: list) -> list:
    # Your code here
    pass`,solutionCode:`def double_all(numbers: list) -> list:
    """Double each number in the list."""
    result = []
    for num in numbers:
        result.append(num * 2)
    return result`,testCases:[{input:"double_all([1, 2, 3])",expected:"[2, 4, 6]"},{input:"double_all([0, -1])",expected:"[0, -2]"},{input:"double_all([])",expected:"[]"},{input:"double_all([0.5])",expected:"[1.0]"},{input:"double_all([10, 20, 30])",expected:"[20, 40, 60]"}]},{id:"076",number:4,title:"Square All",description:"Create a function `square_all` that returns a new list where each number from the input list is squared.",hint:"Append `num ** 2` to result.",starterCode:`def square_all(numbers: list) -> list:
    # Your code here
    pass`,solutionCode:`def square_all(numbers: list) -> list:
    """Square each number in the list."""
    result = []
    for num in numbers:
        result.append(num ** 2)
    return result`,testCases:[{input:"square_all([2, 3, 4])",expected:"[4, 9, 16]"},{input:"square_all([-2, 0])",expected:"[4, 0]"},{input:"square_all([])",expected:"[]"},{input:"square_all([1, 1, 1])",expected:"[1, 1, 1]"},{input:"square_all([10])",expected:"[100]"}]},{id:"077",number:5,title:"Filter Long Words",description:"Create a function `filter_long_words` that returns a list of words from the input that are at least `min_length` characters long.",hint:"If `len(word) >= min_length`, keep it.",starterCode:`def filter_long_words(words: list, min_length: int) -> list:
    # Your code here
    pass`,solutionCode:`def filter_long_words(words: list, min_length: int) -> list:
    """Filter words by minimum length."""
    result = []
    for word in words:
        if len(word) >= min_length:
            result.append(word)
    return result`,testCases:[{input:"filter_long_words(['a', 'big', 'word'], 3)",expected:"['big', 'word']"},{input:"filter_long_words(['hi', 'no'], 3)",expected:"[]"},{input:"filter_long_words([], 1)",expected:"[]"},{input:"filter_long_words(['neuroscience', 'brain'], 5)",expected:"['neuroscience', 'brain']"},{input:"filter_long_words(['cat', 'dog', 'elephant'], 4)",expected:"['elephant']"}]},{id:"078",number:6,title:"Remove Duplicates",description:"Create a function `remove_duplicates` that returns a new list with duplicate items removed, while preserving the original order.",hint:"Use a `seen` list. If item not in seen, append to seen and result.",starterCode:`def remove_duplicates(items: list) -> list:
    # Your code here
    pass`,solutionCode:`def remove_duplicates(items: list) -> list:
    """Remove duplicates while preserving order."""
    seen = []
    result = []
    for item in items:
        if item not in seen:
            seen.append(item)
            result.append(item)
    return result`,testCases:[{input:"remove_duplicates([1, 2, 2, 3, 1])",expected:"[1, 2, 3]"},{input:"remove_duplicates(['a', 'a', 'b'])",expected:"['a', 'b']"},{input:"remove_duplicates([])",expected:"[]"},{input:"remove_duplicates([5, 5, 5, 5])",expected:"[5]"},{input:"remove_duplicates([1, 2, 3])",expected:"[1, 2, 3]"}]},{id:"079",number:7,title:"Uppercase All",description:"Create a function `uppercase_all` that returns a new list with all strings converted to uppercase.",hint:"Append `word.upper()` to result.",starterCode:`def uppercase_all(words: list) -> list:
    # Your code here
    pass`,solutionCode:`def uppercase_all(words: list) -> list:
    """Convert all strings to uppercase."""
    result = []
    for word in words:
        result.append(word.upper())
    return result`,testCases:[{input:"uppercase_all(['hello', 'world'])",expected:"['HELLO', 'WORLD']"},{input:"uppercase_all(['a', 'B'])",expected:"['A', 'B']"},{input:"uppercase_all([])",expected:"[]"},{input:"uppercase_all(['MiXeD', 'CaSe'])",expected:"['MIXED', 'CASE']"},{input:"uppercase_all(['123'])",expected:"['123']"}]},{id:"080",number:8,title:"Get Lengths",description:"Create a function `get_lengths` that returns a new list containing the length of each string in the input list.",hint:"Append `len(word)` to result.",starterCode:`def get_lengths(words: list) -> list:
    # Your code here
    pass`,solutionCode:`def get_lengths(words: list) -> list:
    """Get length of each string in list."""
    result = []
    for word in words:
        result.append(len(word))
    return result`,testCases:[{input:"get_lengths(['a', 'bb', 'ccc'])",expected:"[1, 2, 3]"},{input:"get_lengths([])",expected:"[]"},{input:"get_lengths([''])",expected:"[0]"},{input:"get_lengths(['hello', 'world'])",expected:"[5, 5]"},{input:"get_lengths(['neuroscience'])",expected:"[12]"}]},{id:"081",number:9,title:"Filter by Index",description:"Create a function `filter_by_index` that returns a new list containing only elements at even indices (0, 2, 4...).",hint:"Use `range(0, len(items), 2)`.",starterCode:`def filter_by_index(items: list) -> list:
    # Your code here
    pass`,solutionCode:`def filter_by_index(items: list) -> list:
    """Return elements at even indices."""
    result = []
    for i in range(0, len(items), 2):
        result.append(items[i])
    return result`,testCases:[{input:"filter_by_index([0, 1, 2, 3, 4])",expected:"[0, 2, 4]"},{input:"filter_by_index(['a', 'b'])",expected:"['a']"},{input:"filter_by_index([])",expected:"[]"},{input:"filter_by_index([10])",expected:"[10]"},{input:"filter_by_index(['w', 'x', 'y', 'z'])",expected:"['w', 'y']"}]},{id:"082",number:10,title:"Running Sum",description:"Create a function `running_sum` that returns a new list where each element is the cumulative sum of numbers up to that point.",hint:"Maintain a `total` variable. For each number, add to `total` and append `total` to result.",starterCode:`def running_sum(numbers: list) -> list:
    # Your code here
    pass`,solutionCode:`def running_sum(numbers: list) -> list:
    """Calculate running sum of list."""
    result = []
    total = 0
    for num in numbers:
        total += num
        result.append(total)
    return result`,testCases:[{input:"running_sum([1, 2, 3])",expected:"[1, 3, 6]"},{input:"running_sum([1, -1, 1])",expected:"[1, 0, 1]"},{input:"running_sum([])",expected:"[]"},{input:"running_sum([5])",expected:"[5]"},{input:"running_sum([10, 10, 10, 10])",expected:"[10, 20, 30, 40]"}]}]},{id:"dictionaries",title:"Dictionaries",description:"Key-Value Data Structures",explanation:`
      <p class="mb-4">Dictionaries store data as key-value pairs, allowing fast lookup by key.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Creating Dictionaries</h4>
      <p class="mb-2"><code>person = {"name": "Alice", "age": 30}</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Accessing Values</h4>
      <p class="mb-2"><code>d[key]</code> raises error if missing, <code>d.get(key, default)</code> returns default if missing</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Iterating</h4>
      <p class="mb-2"><code>for key in d:</code> or <code>for key, value in d.items():</code></p>
    `,exampleCode:`def count_chars(text: str) -> dict:
    """Count occurrences of each character."""
    counts = {}
    for char in text:
        if char in counts:
            counts[char] += 1
        else:
            counts[char] = 1
    return counts

def get_values(data: dict, keys: list) -> list:
    """Return list of values for given keys."""
    result = []
    for key in keys:
        if key in data:
            result.append(data[key])
    return result`,challenges:[{id:"083",number:1,title:"Count Characters",description:"Create a function `count_chars` that returns a dictionary counting the frequency of each character in `text`.",hint:"Loop through chars. If char in dict, increment count; otherwise set to 1.",starterCode:`def count_chars(text: str) -> dict:
    # Your code here
    pass`,solutionCode:`def count_chars(text: str) -> dict:
    """Count character frequencies."""
    counts = {}
    for char in text:
        if char in counts:
            counts[char] += 1
        else:
            counts[char] = 1
    return counts`,testCases:[{input:"count_chars('hello')",expected:"{'h': 1, 'e': 1, 'l': 2, 'o': 1}"},{input:"count_chars('aa a')",expected:"{'a': 3, ' ': 1}"},{input:"count_chars('')",expected:"{}"},{input:"count_chars('aaa')",expected:"{'a': 3}"},{input:"count_chars('abc')",expected:"{'a': 1, 'b': 1, 'c': 1}"}]},{id:"084",number:2,title:"Count Words",description:"Create a function `count_words` that returns a dictionary counting the frequency of each word in `sentence` (case-insensitive).",hint:"Lowercase and split sentence. Count words.",starterCode:`def count_words(sentence: str) -> dict:
    # Your code here
    pass`,solutionCode:`def count_words(sentence: str) -> dict:
    """Count word frequencies in a sentence."""
    counts = {}
    words = sentence.lower().split()
    for word in words:
        if word in counts:
            counts[word] += 1
        else:
            counts[word] = 1
    return counts`,testCases:[{input:"count_words('Hello world hello')",expected:"{'hello': 2, 'world': 1}"},{input:"count_words('a a a')",expected:"{'a': 3}"},{input:"count_words('')",expected:"{}"},{input:"count_words('python')",expected:"{'python': 1}"},{input:"count_words('The the THE')",expected:"{'the': 3}"}]},{id:"085",number:3,title:"Invert Dictionary",description:"Create a function `invert_dict` that returns a new dictionary where keys and values are swapped.",hint:"Loop through `d.items()`, set `result[value] = key`.",starterCode:`def invert_dict(d: dict) -> dict:
    # Your code here
    pass`,solutionCode:`def invert_dict(d: dict) -> dict:
    """Swap keys and values in dictionary."""
    result = {}
    for key, value in d.items():
        result[value] = key
    return result`,testCases:[{input:"invert_dict({'a': 1, 'b': 2})",expected:"{1: 'a', 2: 'b'}"},{input:"invert_dict({})",expected:"{}"},{input:"invert_dict({'k': 'v'})",expected:"{'v': 'k'}"},{input:"invert_dict({'x': 10})",expected:"{10: 'x'}"},{input:"invert_dict({1: 'one', 2: 'two'})",expected:"{'one': 1, 'two': 2}"}]},{id:"086",number:4,title:"Merge Dictionaries",description:"Create a function `merge_dicts` that returns a new dictionary merging `d1` and `d2`, with `d2` values taking precedence.",hint:"Copy `d1` then update with `d2`.",starterCode:`def merge_dicts(d1: dict, d2: dict) -> dict:
    # Your code here
    pass`,solutionCode:`def merge_dicts(d1: dict, d2: dict) -> dict:
    """Merge two dictionaries, second takes precedence."""
    result = {}
    for key, value in d1.items():
        result[key] = value
    for key, value in d2.items():
        result[key] = value
    return result`,testCases:[{input:"merge_dicts({'a': 1}, {'b': 2})",expected:"{'a': 1, 'b': 2}"},{input:"merge_dicts({'a': 1}, {'a': 2})",expected:"{'a': 2}"},{input:"merge_dicts({}, {'a': 1})",expected:"{'a': 1}"},{input:"merge_dicts({'x': 1, 'y': 2}, {'y': 3, 'z': 4})",expected:"{'x': 1, 'y': 3, 'z': 4}"},{input:"merge_dicts({}, {})",expected:"{}"}]},{id:"087",number:5,title:"Dict from Lists",description:"Create a function `dict_from_lists` that returns a dictionary where keys come from `keys` list and values from `values` list.",hint:"Loop by index, pair `keys[i]` with `values[i]`.",starterCode:`def dict_from_lists(keys: list, values: list) -> dict:
    # Your code here
    pass`,solutionCode:`def dict_from_lists(keys: list, values: list) -> dict:
    """Create dictionary from parallel lists."""
    result = {}
    for i in range(len(keys)):
        result[keys[i]] = values[i]
    return result`,testCases:[{input:"dict_from_lists(['a', 'b'], [1, 2])",expected:"{'a': 1, 'b': 2}"},{input:"dict_from_lists([], [])",expected:"{}"},{input:"dict_from_lists(['name'], ['Alice'])",expected:"{'name': 'Alice'}"},{input:"dict_from_lists(['x', 'y', 'z'], [10, 20, 30])",expected:"{'x': 10, 'y': 20, 'z': 30}"},{input:"dict_from_lists(['key'], [None])",expected:"{'key': None}"}]},{id:"088",number:6,title:"Filter Dictionary",description:"Create a function `filter_dict` that returns a new dictionary containing only entries where the value is at least `min_value`.",hint:"If `value >= min_value`, add to result.",starterCode:`def filter_dict(d: dict, min_value: float) -> dict:
    # Your code here
    pass`,solutionCode:`def filter_dict(d: dict, min_value: float) -> dict:
    """Filter dictionary by minimum value."""
    result = {}
    for key, value in d.items():
        if value >= min_value:
            result[key] = value
    return result`,testCases:[{input:"filter_dict({'a': 1, 'b': 2, 'c': 3}, 2)",expected:"{'b': 2, 'c': 3}"},{input:"filter_dict({'a': 1}, 5)",expected:"{}"},{input:"filter_dict({}, 0)",expected:"{}"},{input:"filter_dict({'x': 10, 'y': 20}, 10)",expected:"{'x': 10, 'y': 20}"},{input:"filter_dict({'a': -5, 'b': 5}, 0)",expected:"{'b': 5}"}]},{id:"089",number:7,title:"Safe Value Access",description:"Create a function `get_value_safely` that returns the value for `key` in `d`, or `default` if the key is missing.",hint:"If `key` in `d`, return `d[key]`, else return `default`.",starterCode:`def get_value_safely(d: dict, key: str, default):
    # Your code here
    pass`,solutionCode:`def get_value_safely(d: dict, key: str, default):
    """Get value with fallback default."""
    if key in d:
        return d[key]
    return default`,testCases:[{input:"get_value_safely({'a': 1}, 'a', 0)",expected:"1"},{input:"get_value_safely({'a': 1}, 'b', 0)",expected:"0"},{input:"get_value_safely({}, 'x', 'none')",expected:"'none'"},{input:"get_value_safely({'key': 'value'}, 'key', 'default')",expected:"'value'"},{input:"get_value_safely({'num': 42}, 'missing', -1)",expected:"-1"}]},{id:"090",number:8,title:"Group by Length",description:"Create a function `group_by_length` that returns a dictionary grouping words by their length (len -> [words]).",hint:"Initialize list if key missing, then append word.",starterCode:`def group_by_length(words: list) -> dict:
    # Your code here
    pass`,solutionCode:`def group_by_length(words: list) -> dict:
    """Group words by their length."""
    result = {}
    for word in words:
        length = len(word)
        if length not in result:
            result[length] = []
        result[length].append(word)
    return result`,testCases:[{input:"group_by_length(['a', 'bb', 'c'])",expected:"{1: ['a', 'c'], 2: ['bb']}"},{input:"group_by_length(['hi', 'no'])",expected:"{2: ['hi', 'no']}"},{input:"group_by_length([])",expected:"{}"},{input:"group_by_length(['one', 'two', 'six'])",expected:"{3: ['one', 'two', 'six']}"},{input:"group_by_length(['a'])",expected:"{1: ['a']}"}]},{id:"091",number:9,title:"Most Common Character",description:"Create a function `most_common` that returns the character with the highest frequency in `text`.",hint:"Count chars, then find key with max value.",starterCode:`def most_common(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def most_common(text: str) -> str:
    """Find the most frequently occurring character."""
    counts = {}
    for char in text:
        if char in counts:
            counts[char] += 1
        else:
            counts[char] = 1
    max_char = ''
    max_count = 0
    for char, count in counts.items():
        if count > max_count:
            max_char = char
            max_count = count
    return max_char`,testCases:[{input:"most_common('banana')",expected:"'a'"},{input:"most_common('aaabb')",expected:"'a'"},{input:"most_common('x')",expected:"'x'"},{input:"most_common('aabb')",expected:"'a'"},{input:"most_common('hello')",expected:"'l'"}]},{id:"092",number:10,title:"Sum Values",description:"Create a function `sum_values` that returns the sum of all values in the dictionary.",hint:"Iterate `d.values()` and sum them.",starterCode:`def sum_values(d: dict) -> float:
    # Your code here
    pass`,solutionCode:`def sum_values(d: dict) -> float:
    """Sum all values in a dictionary."""
    total = 0
    for value in d.values():
        total += value
    return total`,testCases:[{input:"sum_values({'a': 10, 'b': 20})",expected:"30"},{input:"sum_values({'a': -5, 'b': 5})",expected:"0"},{input:"sum_values({})",expected:"0"},{input:"sum_values({'score': 100})",expected:"100"},{input:"sum_values({'x': 1, 'y': 2, 'z': 3})",expected:"6"}]}]},{id:"string_mastery",title:"String Mastery",description:"Advanced String Operations",explanation:`
      <p class="mb-4">Mastering strings means combining multiple operations and handling edge cases.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Slicing</h4>
      <p class="mb-2"><code>s[start:end]</code>, <code>s[:end]</code>, <code>s[start:]</code>, <code>s[::-1]</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">String Methods</h4>
      <p class="mb-2"><code>.startswith()</code>, <code>.endswith()</code>, <code>.isalpha()</code>, <code>.isdigit()</code>, <code>.join()</code></p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Building Strings</h4>
      <p class="mb-2">Concatenate with <code>+</code> or join a list of strings.</p>
    `,exampleCode:`def is_palindrome(text: str) -> bool:
    """Check if text is a palindrome (ignoring case and spaces)."""
    cleaned = text.lower().replace(" ", "")
    return cleaned == cleaned[::-1]

def extract_numbers(text: str) -> str:
    """Extract only the digits from a string."""
    result = ""
    for char in text:
        if char.isdigit():
            result += char
    return result`,challenges:[{id:"093",number:1,title:"Palindrome Detector",description:"Create a function `is_palindrome` that returns `True` if `text` is a palindrome (reading the same forwards and backwards), ignoring case and spaces.",hint:"Clean string (lower case, remove spaces), then compare with its reverse.",starterCode:`def is_palindrome(text: str) -> bool:
    # Your code here
    pass`,solutionCode:`def is_palindrome(text: str) -> bool:
    """Check if text is a palindrome."""
    cleaned = text.lower().replace(" ", "")
    return cleaned == cleaned[::-1]`,testCases:[{input:"is_palindrome('Racecar')",expected:"True"},{input:"is_palindrome('Hello')",expected:"False"},{input:"is_palindrome('A man a plan a canal Panama')",expected:"True"},{input:"is_palindrome('Level')",expected:"True"},{input:"is_palindrome('Python')",expected:"False"}]},{id:"094",number:2,title:"Remove Vowels",description:"Create a function `remove_vowels` that returns a new string with all vowels (a, e, i, o, u) removed from `text`.",hint:"Iterate chars, append to result if not a vowel.",starterCode:`def remove_vowels(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def remove_vowels(text: str) -> str:
    """Remove all vowels from text."""
    vowels = "aeiouAEIOU"
    result = ""
    for char in text:
        if char not in vowels:
            result += char
    return result`,testCases:[{input:"remove_vowels('Hello')",expected:"'Hll'"},{input:"remove_vowels('AEIOU')",expected:"''"},{input:"remove_vowels('BCDFGH')",expected:"'BCDFGH'"},{input:"remove_vowels('Python Programming')",expected:"'Pythn Prgrmmng'"},{input:"remove_vowels('')",expected:"''"}]},{id:"095",number:3,title:"Title Case",description:"Create a function `capitalize_words` that returns `sentence` with the first letter of each word capitalized.",hint:"Split words, capitalize each, then join.",starterCode:`def capitalize_words(sentence: str) -> str:
    # Your code here
    pass`,solutionCode:`def capitalize_words(sentence: str) -> str:
    """Capitalize first letter of each word."""
    words = sentence.split()
    result = []
    for word in words:
        result.append(word.capitalize())
    return " ".join(result)`,testCases:[{input:"capitalize_words('hello world')",expected:"'Hello World'"},{input:"capitalize_words('this is python')",expected:"'This Is Python'"},{input:"capitalize_words('ALREADY CAPS')",expected:"'Already Caps'"},{input:"capitalize_words('')",expected:"''"},{input:"capitalize_words('a')",expected:"'A'"}]},{id:"096",number:4,title:"Extract Digits",description:"Create a function `extract_digits` that returns a string containing only the numeric digits from `text`.",hint:"If `char.isdigit()`, append to result.",starterCode:`def extract_digits(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def extract_digits(text: str) -> str:
    """Extract only digits from text."""
    result = ""
    for char in text:
        if char.isdigit():
            result += char
    return result`,testCases:[{input:"extract_digits('abc123def456')",expected:"'123456'"},{input:"extract_digits('Price: $19.99')",expected:"'1999'"},{input:"extract_digits('No digits')",expected:"''"},{input:"extract_digits('2024-12-09')",expected:"'20241209'"},{input:"extract_digits('123')",expected:"'123'"}]},{id:"097",number:5,title:"Mask String",description:"Create a function `mask_string` that masks all but the last 4 characters of `text` with '*', unless length <= 4 (then mask all).",hint:"Use string slicing and multiplication.",starterCode:`def mask_string(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def mask_string(text: str) -> str:
    """Mask all but last 4 characters."""
    if len(text) <= 4:
        return "*" * len(text)
    return "*" * (len(text) - 4) + text[-4:]`,testCases:[{input:"mask_string('1234567890')",expected:"'******7890'"},{input:"mask_string('123')",expected:"'***'"},{input:"mask_string('1234')",expected:"'****'"},{input:"mask_string('password12345')",expected:"'*********2345'"},{input:"mask_string('')",expected:"''"}]},{id:"098",number:6,title:"Anagram Checker",description:"Create a function `is_anagram` that returns `True` if `s1` and `s2` are anagrams (contain same letters), ignoring case and spaces.",hint:"Clean strings, then compare sorted characters.",starterCode:`def is_anagram(s1: str, s2: str) -> bool:
    # Your code here
    pass`,solutionCode:`def is_anagram(s1: str, s2: str) -> bool:
    """Check if two strings are anagrams."""
    clean1 = s1.lower().replace(" ", "")
    clean2 = s2.lower().replace(" ", "")
    return sorted(clean1) == sorted(clean2)`,testCases:[{input:"is_anagram('Listen', 'Silent')",expected:"True"},{input:"is_anagram('hello', 'world')",expected:"False"},{input:"is_anagram('rail safety', 'fairy tales')",expected:"True"},{input:"is_anagram('Python', 'typhon')",expected:"True"},{input:"is_anagram('abc', 'abcd')",expected:"False"}]},{id:"099",number:7,title:"Longest Word",description:"Create a function `longest_word` that returns the longest word in `sentence`.",hint:"Split sentence. Track longest word found so far.",starterCode:`def longest_word(sentence: str) -> str:
    # Your code here
    pass`,solutionCode:`def longest_word(sentence: str) -> str:
    """Find the longest word in a sentence."""
    words = sentence.split()
    if not words:
        return ""
    longest = words[0]
    for word in words:
        if len(word) > len(longest):
            longest = word
    return longest`,testCases:[{input:"longest_word('This is a test')",expected:"'test'"},{input:"longest_word('Python is amazing')",expected:"'amazing'"},{input:"longest_word('')",expected:"''"},{input:"longest_word('I love programming')",expected:"'programming'"},{input:"longest_word('cat hat bat')",expected:"'cat'"}]},{id:"100",number:8,title:"Run-Length Encoding",description:"Create a function `compress_string` that returns a compressed string using run-length encoding (e.g., 'a2b3'), but only if shorter than original.",hint:"Iterate chars, counting consecutive runs. Append char+count.",starterCode:`def compress_string(text: str) -> str:
    # Your code here
    pass`,solutionCode:`def compress_string(text: str) -> str:
    """Compress string using run-length encoding."""
    if not text:
        return text
    
    result = ""
    current = text[0]
    count = 1
    
    for i in range(1, len(text)):
        if text[i] == current:
            count += 1
        else:
            result += current + str(count)
            current = text[i]
            count = 1
    result += current + str(count)
    
    if len(result) < len(text):
        return result
    return text`,testCases:[{input:"compress_string('aabcccccaaa')",expected:"'a2b1c5a3'"},{input:"compress_string('abcdef')",expected:"'abcdef'"},{input:"compress_string('aaaa')",expected:"'a4'"},{input:"compress_string('')",expected:"''"},{input:"compress_string('aabbcc')",expected:"'aabbcc'"}]}]},{id:"combining_structures",title:"Combining Data Structures",description:"Lists of Dicts, Nested Data",explanation:`
      <p class="mb-4">Real-world data often involves nested structures - lists containing dictionaries, dictionaries containing lists, etc.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">List of Dictionaries</h4>
      <p class="mb-2">Common pattern for tabular data like records or rows.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Nested Access</h4>
      <p class="mb-2"><code>data[0]["name"]</code> - first item's name field</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Processing Nested Data</h4>
      <p class="mb-2">Often requires nested loops or multiple steps.</p>
    `,exampleCode:`def get_names(people: list) -> list:
    """Extract all names from list of person dictionaries."""
    names = []
    for person in people:
        names.append(person["name"])
    return names

def total_price(cart: list) -> float:
    """Calculate total from shopping cart items."""
    total = 0
    for item in cart:
        total += item["price"] * item["quantity"]
    return total`,challenges:[{id:"101",number:1,title:"Get Names",description:"Create a function `get_names` that returns a list of 'name' values from a list of dictionaries.",hint:"Loop through people, append `person['name']` to list.",starterCode:`def get_names(people: list) -> list:
    # Your code here
    pass`,solutionCode:`def get_names(people: list) -> list:
    """Extract names from list of person dicts."""
    names = []
    for person in people:
        names.append(person["name"])
    return names`,testCases:[{input:"get_names([{'name': 'Alice'}, {'name': 'Bob'}])",expected:"['Alice', 'Bob']"},{input:"get_names([])",expected:"[]"},{input:"get_names([{'name': 'Solo'}])",expected:"['Solo']"},{input:"get_names([{'name': 'A', 'age': 20}, {'name': 'B', 'age': 30}])",expected:"['A', 'B']"},{input:"get_names([{'name': ''}])",expected:"['']"}]},{id:"102",number:2,title:"Filter by Key",description:"Create a function `filter_by_key` that returns a new list containing only items where `item[key]` equals `value`.",hint:"Loop items. If `item.get(key) == value`, add to result.",starterCode:`def filter_by_key(items: list, key: str, value) -> list:
    # Your code here
    pass`,solutionCode:`def filter_by_key(items: list, key: str, value) -> list:
    """Filter list of dicts by key-value match."""
    result = []
    for item in items:
        if item.get(key) == value:
            result.append(item)
    return result`,testCases:[{input:"filter_by_key([{'id': 1, 'type': 'A'}, {'id': 2, 'type': 'B'}, {'id': 3, 'type': 'A'}], 'type', 'A')",expected:"[{'id': 1, 'type': 'A'}, {'id': 3, 'type': 'A'}]"},{input:"filter_by_key([], 'type', 'A')",expected:"[]"},{input:"filter_by_key([{'x': 1}], 'x', 1)",expected:"[{'x': 1}]"},{input:"filter_by_key([{'x': 1}], 'y', 1)",expected:"[]"},{input:"filter_by_key([{'a': None}], 'a', None)",expected:"[{'a': None}]"}]},{id:"103",number:3,title:"Cart Total",description:"Create a function `cart_total` that returns the total cost (price * quantity) of all items in `cart`.",hint:"Sum `item['price'] * item['quantity']` for each item.",starterCode:`def cart_total(cart: list) -> float:
    # Your code here
    pass`,solutionCode:`def cart_total(cart: list) -> float:
    """Calculate total cost of shopping cart."""
    total = 0
    for item in cart:
        total += item["price"] * item["quantity"]
    return total`,testCases:[{input:"cart_total([{'price': 10, 'quantity': 2}, {'price': 5, 'quantity': 1}])",expected:"25"},{input:"cart_total([])",expected:"0"},{input:"cart_total([{'price': 99.99, 'quantity': 1}])",expected:"99.99"},{input:"cart_total([{'price': 0, 'quantity': 100}])",expected:"0"},{input:"cart_total([{'price': 1, 'quantity': 1}, {'price': 1, 'quantity': 1}])",expected:"2"}]},{id:"104",number:4,title:"Average by Key",description:"Create a function `average_by_key` that returns the average value of `key` across all items (return 0 if empty).",hint:"Sum `item[key]` for all items, divide by count.",starterCode:`def average_by_key(items: list, key: str) -> float:
    # Your code here
    pass`,solutionCode:`def average_by_key(items: list, key: str) -> float:
    """Calculate average of a specific key across dicts."""
    if not items:
        return 0
    total = 0
    for item in items:
        total += item[key]
    return total / len(items)`,testCases:[{input:"average_by_key([{'score': 10}, {'score': 20}], 'score')",expected:"15.0"},{input:"average_by_key([], 'score')",expected:"0"},{input:"average_by_key([{'val': 100}], 'val')",expected:"100.0"},{input:"average_by_key([{'x': 1}, {'x': 2}, {'x': 3}], 'x')",expected:"2.0"},{input:"average_by_key([{'n': 0}, {'n': 0}], 'n')",expected:"0.0"}]},{id:"105",number:5,title:"Find by ID",description:"Create a function `find_by_id` that returns the dictionary with the matching `id`, or `None` if not found.",hint:"Loop items. If `item['id'] == target_id`, return item.",starterCode:`def find_by_id(items: list, target_id: int) -> dict:
    # Your code here
    pass`,solutionCode:`def find_by_id(items: list, target_id: int) -> dict:
    """Find dict by id value."""
    for item in items:
        if item.get("id") == target_id:
            return item
    return None`,testCases:[{input:"find_by_id([{'id': 1, 'name': 'A'}, {'id': 2, 'name': 'B'}], 2)",expected:"{'id': 2, 'name': 'B'}"},{input:"find_by_id([{'id': 1}], 3)",expected:"None"},{input:"find_by_id([], 1)",expected:"None"},{input:"find_by_id([{'id': 0}], 0)",expected:"{'id': 0}"},{input:"find_by_id([{'id': 1}, {'id': 1}], 1)",expected:"{'id': 1}"}]},{id:"106",number:6,title:"Group by Key",description:"Create a function `group_by_key` that returns a dictionary where keys are values of the specified `key` and dictionary values are lists of matching items.",hint:"Initialize list if value not in result, then append item.",starterCode:`def group_by_key(items: list, key: str) -> dict:
    # Your code here
    pass`,solutionCode:`def group_by_key(items: list, key: str) -> dict:
    """Group items by the value of a specific key."""
    result = {}
    for item in items:
        value = item.get(key)
        if value not in result:
            result[value] = []
        result[value].append(item)
    return result`,testCases:[{input:"group_by_key([{'type': 'A', 'val': 1}, {'type': 'B', 'val': 2}, {'type': 'A', 'val': 3}], 'type')",expected:"{'A': [{'type': 'A', 'val': 1}, {'type': 'A', 'val': 3}], 'B': [{'type': 'B', 'val': 2}]}"},{input:"group_by_key([], 'type')",expected:"{}"},{input:"group_by_key([{'x': 1}], 'x')",expected:"{1: [{'x': 1}]}"},{input:"group_by_key([{'a': 1}, {'a': 1}], 'a')",expected:"{1: [{'a': 1}, {'a': 1}]}"},{input:"group_by_key([{'k': 'v'}], 'missing')",expected:"{None: [{'k': 'v'}]}"}]},{id:"107",number:7,title:"Flatten List",description:"Create a function `flatten` that returns a single list containing all elements from the nested list of lists.",hint:"Loop sublists, then loop items in sublist and append to result.",starterCode:`def flatten(nested: list) -> list:
    # Your code here
    pass`,solutionCode:`def flatten(nested: list) -> list:
    """Flatten a list of lists."""
    result = []
    for sublist in nested:
        for item in sublist:
            result.append(item)
    return result`,testCases:[{input:"flatten([[1, 2], [3, 4]])",expected:"[1, 2, 3, 4]"},{input:"flatten([[], [1]])",expected:"[1]"},{input:"flatten([])",expected:"[]"},{input:"flatten([[1], [2], [3]])",expected:"[1, 2, 3]"},{input:"flatten([['a', 'b'], ['c']])",expected:"['a', 'b', 'c']"}]},{id:"108",number:8,title:"Sort by Key",description:"Create a function `sort_by_key` that returns a new list of items sorted by `key` (ascending). Implement your own sort.",hint:"Use Bubble Sort. Compare `items[j][key]` and `items[j+1][key]`.",starterCode:`def sort_by_key(items: list, key: str) -> list:
    # Your code here
    pass`,solutionCode:`def sort_by_key(items: list, key: str) -> list:
    """Sort list of dicts by a specific key."""
    # Simple bubble sort implementation
    result = items.copy()
    n = len(result)
    for i in range(n):
        for j in range(0, n - i - 1):
            if result[j][key] > result[j + 1][key]:
                result[j], result[j + 1] = result[j + 1], result[j]
    return result`,testCases:[{input:"sort_by_key([{'val': 3}, {'val': 1}, {'val': 2}], 'val')",expected:"[{'val': 1}, {'val': 2}, {'val': 3}]"},{input:"sort_by_key([], 'val')",expected:"[]"},{input:"sort_by_key([{'x': 5}], 'x')",expected:"[{'x': 5}]"},{input:"sort_by_key([{'n': 2}, {'n': 2}], 'n')",expected:"[{'n': 2}, {'n': 2}]"},{input:"sort_by_key([{'a': 1}, {'a': 0}], 'a')",expected:"[{'a': 0}, {'a': 1}]"}]}]},{id:"capstone",title:"Capstone Challenges",description:"Put Everything Together",explanation:`
      <p class="mb-4">These challenges combine everything you've learned. They require functions, loops, conditionals, lists, dictionaries, and string manipulation.</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Problem-Solving Approach</h4>
      <p class="mb-2">1. Understand the problem fully<br>2. Work through examples by hand<br>3. Plan your approach<br>4. Code it step by step<br>5. Test with edge cases</p>
      
      <h4 class="font-bold text-slate-800 mt-4 mb-2">Tips</h4>
      <p class="mb-2">Break complex problems into smaller functions. Test each piece before combining.</p>
    `,exampleCode:`def validate_password(password: str) -> dict:
    """Check password strength and return validation results."""
    results = {
        "valid": True,
        "errors": []
    }
    
    if len(password) < 8:
        results["errors"].append("Must be at least 8 characters")
        results["valid"] = False
    
    has_upper = False
    for char in password:
        if char.isupper():
            has_upper = True
            break
    
    if not has_upper:
        results["errors"].append("Must contain uppercase letter")
        results["valid"] = False
    
    return results`,challenges:[{id:"109",number:1,title:"Password Strength",description:"Create a function `validate_password` that returns a dictionary checking if `password` meets strength rules (length >= 8, uppercase, lowercase, digit).",hint:"Check rules individually. Append errors to list if rules fail.",starterCode:`def validate_password(password: str) -> dict:
    # Your code here
    pass`,solutionCode:`def validate_password(password: str) -> dict:
    """Validate password strength."""
    errors = []
    
    if len(password) < 8:
        errors.append("Must be at least 8 characters")
    
    has_upper = False
    has_lower = False
    has_digit = False
    
    for char in password:
        if char.isupper():
            has_upper = True
        if char.islower():
            has_lower = True
        if char.isdigit():
            has_digit = True
    
    if not has_upper:
        errors.append("Must contain uppercase letter")
    if not has_lower:
        errors.append("Must contain lowercase letter")
    if not has_digit:
        errors.append("Must contain a digit")
    
    return {"valid": len(errors) == 0, "errors": errors}`,testCases:[{input:"validate_password('ValidPass1')",expected:"{'valid': True, 'errors': []}"},{input:"validate_password('short')",expected:"{'valid': False, 'errors': ['Must be at least 8 characters', 'Must contain uppercase letter', 'Must contain a digit']}"},{input:"validate_password('alllowercase1')",expected:"{'valid': False, 'errors': ['Must contain uppercase letter']}"},{input:"validate_password('ALLUPPERCASE1')",expected:"{'valid': False, 'errors': ['Must contain lowercase letter']}"},{input:"validate_password('NoDigitsHere')",expected:"{'valid': False, 'errors': ['Must contain a digit']}"}]},{id:"110",number:2,title:"Format Duration",description:"Create a function `format_duration` that returns a human-readable string (e.g., '1 hour, 5 minutes') from a number of `seconds`.",hint:"Calculate hours, minutes, seconds. Join non-zero parts with ', '.",starterCode:`def format_duration(seconds: int) -> str:
    # Your code here
    pass`,solutionCode:`def format_duration(seconds: int) -> str:
    """Format seconds as human-readable duration."""
    if seconds == 0:
        return "0 seconds"
    
    hours = seconds // 3600
    minutes = (seconds % 3600) // 60
    secs = seconds % 60
    
    parts = []
    if hours > 0:
        parts.append(f"{hours} hour" + ("s" if hours > 1 else ""))
    if minutes > 0:
        parts.append(f"{minutes} minute" + ("s" if minutes > 1 else ""))
    if secs > 0:
        parts.append(f"{secs} second" + ("s" if secs > 1 else ""))
    
    return ", ".join(parts)`,testCases:[{input:"format_duration(3665)",expected:"'1 hour, 1 minute, 5 seconds'"},{input:"format_duration(62)",expected:"'1 minute, 2 seconds'"},{input:"format_duration(0)",expected:"'0 seconds'"},{input:"format_duration(3600)",expected:"'1 hour'"},{input:"format_duration(7201)",expected:"'2 hours, 1 second'"}]},{id:"111",number:3,title:"Grade Statistics",description:"Create a function `calculate_grade_stats` that returns a dictionary with 'average', 'highest', 'lowest', and 'passing' stats from a list of student records.",hint:"Iterate records to find min, max, sum, and count passing.",starterCode:`def calculate_grade_stats(students: list) -> dict:
    # Your code here
    pass`,solutionCode:`def calculate_grade_stats(students: list) -> dict:
    """Calculate statistics from student grades."""
    if not students:
        return {"average": 0, "highest": 0, "lowest": 0, "passing": 0}
    
    scores = [s["score"] for s in students]
    
    total = 0
    highest = scores[0]
    lowest = scores[0]
    passing = 0
    
    for score in scores:
        total += score
        if score > highest:
            highest = score
        if score < lowest:
            lowest = score
        if score >= 60:
            passing += 1
    
    return {
        "average": total / len(scores),
        "highest": highest,
        "lowest": lowest,
        "passing": passing
    }`,testCases:[{input:"calculate_grade_stats([{'name': 'A', 'score': 80}, {'name': 'B', 'score': 60}, {'name': 'C', 'score': 40}])",expected:"{'average': 60.0, 'highest': 80, 'lowest': 40, 'passing': 2}"},{input:"calculate_grade_stats([])",expected:"{'average': 0, 'highest': 0, 'lowest': 0, 'passing': 0}"},{input:"calculate_grade_stats([{'name': 'X', 'score': 100}])",expected:"{'average': 100.0, 'highest': 100, 'lowest': 100, 'passing': 1}"},{input:"calculate_grade_stats([{'name': 'A', 'score': 59}, {'name': 'B', 'score': 60}])",expected:"{'average': 59.5, 'highest': 60, 'lowest': 59, 'passing': 1}"},{input:"calculate_grade_stats([{'name': 'Z', 'score': 0}])",expected:"{'average': 0.0, 'highest': 0, 'lowest': 0, 'passing': 0}"}]},{id:"112",number:4,title:"Word Frequency",description:"Create a function `word_frequency` that returns a list of the top 5 most common words in `text` as `[word, count]` pairs.",hint:"Count words in dictionary, convert to list, sort descending, return top 5.",starterCode:`def word_frequency(text: str) -> list:
    # Your code here
    pass`,solutionCode:`def word_frequency(text: str) -> list:
    """Find top 5 most common words."""
    # Count words
    counts = {}
    words = text.lower().split()
    for word in words:
        if word in counts:
            counts[word] += 1
        else:
            counts[word] = 1
    
    # Convert to list of tuples and sort
    items = list(counts.items())
    
    # Simple bubble sort by count (descending)
    n = len(items)
    for i in range(n):
        for j in range(0, n - i - 1):
            if items[j][1] < items[j + 1][1]:
                items[j], items[j + 1] = items[j + 1], items[j]
    
    return items[:5]`,testCases:[{input:"word_frequency('a b a c b a')",expected:"[['a', 3], ['b', 2], ['c', 1]]"},{input:"word_frequency('')",expected:"[]"},{input:"word_frequency('one one two')",expected:"[['one', 2], ['two', 1]]"},{input:"word_frequency('word')",expected:"[['word', 1]]"},{input:"word_frequency('a a a a a b b b c c')",expected:"[['a', 5], ['b', 3], ['c', 2]]"}]},{id:"113",number:5,title:"Valid Brackets",description:"Create a function `valid_brackets` that returns `True` if the brackets in string `s` are properly matched and nested.",hint:"Use a stack. Push opening brackets, pop matching closing brackets.",starterCode:`def valid_brackets(s: str) -> bool:
    # Your code here
    pass`,solutionCode:`def valid_brackets(s: str) -> bool:
    """Check if brackets are properly matched."""
    stack = []
    pairs = {")": "(", "}": "{", "]": "["}
    
    for char in s:
        if char in "({[":
            stack.append(char)
        elif char in ")}]":
            if not stack:
                return False
            if stack[-1] != pairs[char]:
                return False
            stack.pop()
    
    return len(stack) == 0`,testCases:[{input:"valid_brackets('()[]{}')",expected:"True"},{input:"valid_brackets('([)]')",expected:"False"},{input:"valid_brackets('[')",expected:"False"},{input:"valid_brackets('')",expected:"True"},{input:"valid_brackets('((()))')",expected:"True"}]},{id:"114",number:6,title:"Merge Sorted Lists",description:"Create a function `merge_sorted` that returns a single sorted list by merging two already sorted lists `list1` and `list2`.",hint:"Use pointers. Compare items from both lists, append smaller item to result.",starterCode:`def merge_sorted(list1: list, list2: list) -> list:
    # Your code here
    pass`,solutionCode:`def merge_sorted(list1: list, list2: list) -> list:
    """Merge two sorted lists into one sorted list."""
    result = []
    i = 0
    j = 0
    
    while i < len(list1) and j < len(list2):
        if list1[i] <= list2[j]:
            result.append(list1[i])
            i += 1
        else:
            result.append(list2[j])
            j += 1
    
    # Add remaining elements
    while i < len(list1):
        result.append(list1[i])
        i += 1
    while j < len(list2):
        result.append(list2[j])
        j += 1
    
    return result`,testCases:[{input:"merge_sorted([1, 3, 5], [2, 4, 6])",expected:"[1, 2, 3, 4, 5, 6]"},{input:"merge_sorted([1, 2], [])",expected:"[1, 2]"},{input:"merge_sorted([], [])",expected:"[]"},{input:"merge_sorted([1], [2])",expected:"[1, 2]"},{input:"merge_sorted([1, 1], [1, 1])",expected:"[1, 1, 1, 1]"}]},{id:"115",number:7,title:"Caesar Cipher",description:"Create a function `caesar_cipher` that returns `text` encrypted by shifting each letter by `shift` positions.",hint:"Shift char code: `(ord(c) - base + shift) % 26 + base`.",starterCode:`def caesar_cipher(text: str, shift: int) -> str:
    # Your code here
    pass`,solutionCode:`def caesar_cipher(text: str, shift: int) -> str:
    """Apply Caesar cipher to text."""
    result = ""
    for char in text:
        if char.isalpha():
            # Determine base (a or A)
            base = ord('a') if char.islower() else ord('A')
            # Shift and wrap around
            shifted = (ord(char) - base + shift) % 26 + base
            result += chr(shifted)
        else:
            result += char
    return result`,testCases:[{input:"caesar_cipher('abc', 1)",expected:"'bcd'"},{input:"caesar_cipher('xyz', 1)",expected:"'yza'"},{input:"caesar_cipher('Hello, World!', 1)",expected:"'Ifmmp, Xpsme!'"},{input:"caesar_cipher('abc', 0)",expected:"'abc'"},{input:"caesar_cipher('a', 26)",expected:"'a'"}]},{id:"116",number:8,title:"Calculate Invoice",description:"Create a function `calculate_invoice` that returns a dictionary with 'subtotal', 'total_discount', and 'grand_total' from a list of items.",hint:"Iterate items. Add to subtotal. If discount info present, add to total discount.",starterCode:`def calculate_invoice(items: list) -> dict:
    # Your code here
    pass`,solutionCode:`def calculate_invoice(items: list) -> dict:
    """Calculate invoice totals with discounts."""
    subtotal = 0
    total_discount = 0
    
    for item in items:
        line_total = item["quantity"] * item["unit_price"]
        subtotal += line_total
        
        if "discount" in item:
            discount = line_total * (item["discount"] / 100)
            total_discount += discount
    
    grand_total = subtotal - total_discount
    
    return {
        "subtotal": round(subtotal, 2),
        "total_discount": round(total_discount, 2),
        "grand_total": round(grand_total, 2)
    }`,testCases:[{input:"calculate_invoice([{'quantity': 2, 'unit_price': 10}, {'quantity': 1, 'unit_price': 20, 'discount': 10}])",expected:"{'subtotal': 40.0, 'total_discount': 2.0, 'grand_total': 38.0}"},{input:"calculate_invoice([])",expected:"{'subtotal': 0, 'total_discount': 0, 'grand_total': 0}"},{input:"calculate_invoice([{'quantity': 1, 'unit_price': 100, 'discount': 50}])",expected:"{'subtotal': 100.0, 'total_discount': 50.0, 'grand_total': 50.0}"},{input:"calculate_invoice([{'quantity': 5, 'unit_price': 10}])",expected:"{'subtotal': 50.0, 'total_discount': 0, 'grand_total': 50.0}"},{input:"calculate_invoice([{'quantity': 3, 'unit_price': 33.33}])",expected:"{'subtotal': 99.99, 'total_discount': 0, 'grand_total': 99.99}"}]}]}],QPe=({studentName:s="Student",onFinish:e})=>{const[t,i]=Ne.useState([]),n=Ne.useRef(null),{isReady:r,loadingMessage:o}=pP(),[a,l]=Ne.useState(0);return Ne.useEffect(()=>{const c=[{text:"BIOS DATE 01/01/24 15:23:42 VER 1.0.2",delay:100},{text:"CPU: QUANTUM-XYZ 64-BIT PROCESSOR",delay:200},{text:"CHECKING MEMORY: 64512K OK",delay:400},{text:"",delay:500},{text:"DETECTING PRIMARY MASTER ... QUANTUM DRIVE C:",delay:800},{text:"DETECTING PRIMARY SLAVE  ... NONE",delay:900},{text:"",delay:1e3},{text:"LOADING SYSTEM COMPONENTS:",delay:1200}];let h=[];return c.forEach((d,g)=>{const p=setTimeout(()=>{i(_=>[..._,d.text]),g===c.length-1&&l(1)},d.delay);h.push(p)}),()=>h.forEach(clearTimeout)},[]),Ne.useEffect(()=>{a===1&&i(c=>c[c.length-1]!==`> ${o}`?[...c,`> ${o}`]:c)},[o,a]),Ne.useEffect(()=>{r&&a>=1&&(async()=>(i(h=>[...h,"",`WELCOME ${s.toUpperCase()}`,"SYSTEM READY."]),await new Promise(h=>setTimeout(h,1500)),e()))()},[r,a,e,s]),Ne.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[t]),K.jsxs("div",{className:"fixed inset-0 bg-black text-green-500 font-mono p-10 flex flex-col items-start justify-start overflow-hidden z-[100]",children:[K.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-2",ref:n,children:[t.map((c,h)=>K.jsx("div",{className:"typewriter-line min-h-[1.5rem] break-words",children:c&&!c.startsWith("BIOS")&&!c.startsWith("CPU")&&!c.startsWith("CHECK")&&!c.startsWith("DETECT")&&!c.startsWith("LOAD")&&!c.startsWith("WELC")&&!c.startsWith("SYS")&&!c.startsWith(">")?K.jsxs(K.Fragment,{children:[K.jsx("span",{className:"mr-2",children:">"}),c]}):c},h)),K.jsx("div",{className:"animate-pulse",children:"_"})]}),K.jsx("div",{className:"absolute bottom-10 right-10 text-xs text-green-700",children:"STEVEN STEWART TUTORING // SYSTEM BOOT // PYTHON 3.11.0"}),K.jsx("style",{children:`
        .typewriter-line {
          animation: fadeIn 0.1s ease-out;
        }
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
      `})]})},Jie="python_tutoring_unlocked_chapters",XPe=()=>qp.reduce((s,e,t)=>({...s,[e.id]:t<3}),{}),PG=()=>{try{const s=localStorage.getItem(Jie);if(s)return JSON.parse(s)}catch(s){console.error(s)}return XPe()},FG=s=>{try{localStorage.setItem(Jie,JSON.stringify(s))}catch(e){console.error(e)}},ZPe=()=>{const{isInSession:s,isTeacher:e,sessionCode:t,participants:i,sessionUnlockedChapters:n,createSession:r,joinSession:o,leaveSession:a,unlockChapter:l,lockChapter:c}=RY(),[h,d]=Ne.useState(qp[0].id),[g,p]=Ne.useState(0),[_,b]=Ne.useState(!0),[C,x]=Ne.useState(!1),[S,y]=Ne.useState(PG),[k,D]=Ne.useState(!1),[R,N]=Ne.useState(!1),A=Ne.useMemo(()=>s?n:S,[s,n,S]),M=qp.find(oe=>oe.id===h)||qp[0],O=Ne.useMemo(()=>!A[M.id],[A,M.id]);Ne.useEffect(()=>{p(0)},[h]);const V=oe=>{if(s&&e)l(oe);else{const Ee={...S,[oe]:!0};y(Ee),FG(Ee)}},H=oe=>{if(s&&e)c(oe);else{const Ee={...S,[oe]:!1};y(Ee),FG(Ee)}},U=oe=>{!A[oe]&&!k||d(oe)};Ne.useEffect(()=>{const oe=Ee=>{Ee.ctrlKey&&Ee.shiftKey&&Ee.key==="T"&&D($=>{const ce=!$;return N(!!ce),ce})};return window.addEventListener("keydown",oe),()=>window.removeEventListener("keydown",oe)},[]);const X=()=>{b(!1),x(!0)},Y=()=>{x(!1)},q=async oe=>{const Ee=await o(oe);return Ee&&x(!1),Ee},ee=async()=>await r(),ue=async()=>{await a(),y(PG())};return _?K.jsx(QPe,{studentName:"Python Learner",onFinish:X}):C?K.jsx(KPe,{onSoloMode:Y,onJoinSession:q,onCreateSession:ee,isTeacherMode:k}):K.jsxs("div",{className:"flex flex-col h-screen overflow-hidden bg-[#1e1e1e]",children:[s&&t&&K.jsx(YPe,{sessionCode:t,isTeacher:e,participantCount:Object.keys(i).length,onLeave:ue}),k&&!s&&K.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-xs font-bold text-center py-1.5 shadow-lg flex items-center justify-center gap-4",children:[K.jsx("span",{children:" TEACHER MODE"}),K.jsx("button",{onClick:()=>x(!0),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded-md transition-colors",children:"Start Session"}),K.jsx("button",{onClick:()=>N(!0),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded-md transition-colors",children:"Control Panel"}),K.jsx("span",{className:"text-white/70",children:"(Ctrl+Shift+T to toggle)"})]}),K.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[K.jsx(yre,{chapters:qp,currentChapterId:h,onSelectChapter:U,unlockedMap:A,enforceLocksForStudent:!k}),K.jsx("main",{className:"flex-1 h-full overflow-hidden relative",children:K.jsx(qPe,{chapter:M,currentChallengeIndex:g,onNextChallenge:()=>p(oe=>Math.min(oe+1,M.challenges.length-1)),onPrevChallenge:()=>p(oe=>Math.max(oe-1,0)),onSelectChallenge:p,isLocked:O})})]}),k&&R&&K.jsx(GPe,{chapters:qp,unlockedMap:A,onUnlock:V,onLock:H,onClose:()=>N(!1)})]})};function JPe(){return K.jsx(Phe,{children:K.jsx(Roe,{children:K.jsx(ZPe,{})})})}const ene=document.getElementById("root");if(!ene)throw new Error("Could not find root element to mount to");const e6e=Cre.createRoot(ene);e6e.render(K.jsx(hd.StrictMode,{children:K.jsx(JPe,{})}));
